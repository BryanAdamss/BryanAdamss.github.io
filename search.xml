<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[vue-router-analysis-part3]]></title>
    <url>%2F2020%2F12%2F06%2Fvue-router-analysis-part3%2F</url>
    <content type="text"><![CDATA[vue-router æºç è§£æ | 6k å­— | å¤šå›¾é¢„è­¦ - ã€ä¸‹ã€‘ å„ä½å¥½ï¼Œæˆ‘æ˜¯å…‰è¾‰ ğŸ˜ æœ¬ç¯‡æ˜¯vue-routeræºç è§£æçš„ä¸‹ç¯‡ï¼Œå³æ”¶å°¾ç¯‡ æœ¬ç¯‡ä¸»è¦ä»‹ç»äº†ä¸‹é¢å‡ ç‚¹ ä»‹ç»äº†vue-routeræ˜¯å¦‚ä½•å¤„ç†æ»šåŠ¨çš„ viewã€linkç»„ä»¶éƒ½æ€ä¹ˆå®ç°çš„ï¼Ÿ è·¯ç”±å˜åŒ–åˆæ˜¯æ€ä¹ˆè§¦å‘é‡æ–°æ¸²æŸ“çš„ç­‰ç­‰ å¦å¤–è¿˜æ˜¯è¦è¯´ä¸€ä¸‹ ç¬¬ä¸€æ¬¡åšæºç è§£æï¼Œè‚¯å®šæœ‰å¾ˆå¤šé”™è¯¯æˆ–ç†è§£ä¸åˆ°ä½çš„åœ°æ–¹ï¼Œæ¬¢è¿æŒ‡æ­£ ğŸ¤ é¡¹ç›®åœ°å€ https://github.com/BryanAdamss/vue-router-for-analysis å¦‚æœè§‰å¾—å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè®°å¾—ç»™æˆ‘ä¸€ä¸ªstarâœ¨ uml å›¾æºæ–‡ä»¶ https://github.com/BryanAdamss/vue-router-for-analysis/blob/dev/vue-router.EAP å…³è”æ–‡ç« é“¾æ¥ vue-router æºç è§£æ | 1.3w å­— | å¤šå›¾é¢„è­¦ - ã€ä¸Šã€‘ vue-router æºç è§£æ | 1.5w å­— | å¤šå›¾é¢„è­¦ - ã€ä¸­ã€‘ vue-router æºç è§£æ | 6k å­— - ã€ä¸‹ã€‘ æ»šåŠ¨å¤„ç† æˆ‘ä»¬çŸ¥é“vue-routerå¯ä»¥å¤„ç†ä¸€äº›æ»šåŠ¨è¡Œä¸ºï¼Œä¾‹å¦‚è®°å½•é¡µé¢æ»šåŠ¨ä½ç½®ï¼Œç„¶ååœ¨åˆ‡æ¢è·¯ç”±æ—¶æ»šåˆ°é¡¶éƒ¨æˆ–ä¿æŒåŸå…ˆä½ç½®ï¼› https://router.vuejs.org/zh/guide/advanced/scroll-behavior.html#æ»šåŠ¨è¡Œä¸º å®ƒä¸»è¦æ¥æ”¶ä¸€ä¸ªscrollBehaviorå‚æ•°ï¼ŒscrollBehavioræœ‰ä»¥ä¸‹ç©æ³• 1234567891011121314151617181920212223242526272829303132const router = new VueRouter(&#123; routes: [...], scrollBehavior (to, from, savedPosition) &#123; // return æœŸæœ›æ»šåŠ¨åˆ°å“ªä¸ªçš„ä½ç½® &#125;&#125;)// æ»šåŠ¨åˆ°æŒ‡å®šåæ ‡scrollBehavior (to, from, savedPosition) &#123; return &#123; x: 0, y: 0 &#125;&#125;// æ»šåŠ¨åˆ°æŒ‡å®šé¡µé¢é”šç‚¹scrollBehavior (to, from, savedPosition) &#123; if (to.hash) &#123; return &#123; selector: to.hash &#125; &#125;&#125;// v2.8.0+ å¼‚æ­¥æ»šåŠ¨scrollBehavior (to, from, savedPosition) &#123; return new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; resolve(&#123; x: 0, y: 0 &#125;) &#125;, 500) &#125; )&#125; æ—¢æ”¯æŒæ»šåŠ¨åˆ°æŒ‡å®šä½ç½®ï¼Œä¹Ÿå¯ä»¥æ»šåŠ¨é¡µé¢æŸä¸ªé¡µé¢é”šç‚¹ä½ç½®å’Œå¼‚æ­¥æ»šåŠ¨ é‚£å®ƒæ˜¯å¦‚ä½•åšåˆ°å‘¢?å…·ä½“çš„é€»è¾‘åˆæ˜¯æ€æ ·çš„å‘¢ï¼Ÿ æˆ‘ä»¬å‰é¢éƒ½çŸ¥é“HTML5Historyåœ¨åˆå§‹åŒ–æ—¶å’ŒHashHistoryåœ¨setupListeneræ—¶éƒ½ä¼šè°ƒç”¨setupScrollå‡½æ•°ï¼Œåˆå§‹åŒ–æ»šåŠ¨ç›¸å…³çš„é€»è¾‘ å¹¶åœ¨popstateæˆ–hashchangeäº‹ä»¶è§¦å‘è·¯ç”±è·³è½¬æ—¶ï¼Œè°ƒç”¨handleScrollå¤„ç†æ»šåŠ¨è¡Œä¸º 12345678910111213141516171819202122232425262728293031// src/history/hash.js setupListeners () &#123; const router = this.router const expectScroll = router.options.scrollBehavior const supportsScroll = supportsPushState &amp;&amp; expectScroll // è‹¥æ”¯æŒscroll,åˆå§‹åŒ–scrollç›¸å…³é€»è¾‘ if (supportsScroll) &#123; setupScroll() &#125; // æ·»åŠ äº‹ä»¶ç›‘å¬ window.addEventListener( supportsPushState ? 'popstate' : 'hashchange', // ä¼˜å…ˆä½¿ç”¨popstate () =&gt; &#123; const current = this.current if (!ensureSlash()) &#123; return &#125; this.transitionTo(getHash(), route =&gt; &#123; if (supportsScroll) &#123; handleScroll(this.router, /* to*/route, /* from*/current, true) &#125; // ä¸æ”¯æŒpushStateï¼Œç›´æ¥æ›¿æ¢è®°å½• if (!supportsPushState) &#123; replaceHash(route.fullPath) &#125; &#125;) &#125; ) &#125; æˆ‘ä»¬å…ˆçœ‹æ»šåŠ¨çš„åˆå§‹åŒ– setupScroll ä»£ç ä½äºsrc/util/scroll.js 12345678910111213141516171819202122// åˆå§‹åŒ–æ»šåŠ¨ç›¸å…³é€»è¾‘export function setupScroll() &#123; // Fix for #1585 for Firefox // Fix for #2195 Add optional third attribute to workaround a bug in safari https://bugs.webkit.org/show_bug.cgi?id=182678 // Fix for #2774 Support for apps loaded from Windows file shares not mapped to network drives: replaced location.origin with // window.location.protocol + '//' + window.location.host // location.host contains the port and location.hostname doesn't const protocolAndPath = window.location.protocol + '//' + window.location.host const absolutePath = window.location.href.replace(protocolAndPath, '') // preserve existing history state as it could be overriden by the user // æ‹·è´ä¸€ä»½stateï¼Œé˜²æ­¢ç”¨æˆ·è¦†ç›– const stateCopy = extend(&#123;&#125;, window.history.state) stateCopy.key = getStateKey() // è¯­æ³•å®šä¹‰:history.replaceState(stateObj, title[, url]); window.history.replaceState(stateCopy, '', absolutePath) // ç›‘å¬popstate(åªèƒ½é€šè¿‡æµè§ˆå™¨çš„ å‰è¿›/åé€€ æŒ‰é’®è§¦å‘)ï¼Œä¿å­˜æ»šåŠ¨ä½ç½®ï¼Œæ›´æ–°stateKey window.addEventListener('popstate', (e) =&gt; &#123; saveScrollPosition() if (e.state &amp;&amp; e.state.key) &#123; setStateKey(e.state.key) &#125; &#125;)&#125; å¯ä»¥çœ‹åˆ°å…¶åˆ©ç”¨History APIçš„æ¥å®Œæˆä½ç½®çš„ä¿å­˜ https://developer.mozilla.org/zh-CN/docs/Web/API/History/replaceState åœ¨popstateæ—¶è®°å½•æ»šåŠ¨ä½ç½®å¹¶æ›´æ–°çŠ¶æ€objçš„key è¿™ä¸ªkeyæ˜¯ç”¨æ¥åœ¨stateä¸­æ ‡è¯†æ¯ä¸ªè·¯ç”±ç”¨çš„ å¯ä»¥çœ‹ä¸‹keyçš„å­˜å– 123456789101112131415161718192021// src/util/state-key.js// use User Timing api (if present) for more accurate key precisionconst Time = inBrowser &amp;&amp; window.performance &amp;&amp; window.performance.now ? window.performance : Date// ç”Ÿæˆå”¯ä¸€keyï¼Œç”¨æ¥åœ¨stateä¸­æ ‡è¯†æ¯ä¸ªè·¯ç”±export function genStateKey(): string &#123; return Time.now().toFixed(3)&#125;let _key: string = genStateKey()export function getStateKey() &#123; return _key&#125;export function setStateKey(key: string) &#123; return (_key = key)&#125; å¯ä»¥çœ‹åˆ°å£°æ˜äº†ä¸€ä¸ª_keyï¼Œå…¶æ˜¯ä¸€ä¸ªä¸‰ä½çš„æ—¶é—´æˆ³ï¼Œæ›´æ–°å’Œè¯»å–éƒ½æ˜¯æ“ä½œè¿™ä¸€ä¸ª_key setupScrollæ—¶ï¼Œé¦–å…ˆæ‹·è´äº†å½“å‰çš„stateï¼Œå¹¶ä¸ºå…¶ç”Ÿæˆä¸€ä¸ªå”¯ä¸€key é€šè¿‡replaceStateå°†æ·»åŠ äº†keyçš„stateä¿å­˜åˆ°å½“å‰è·¯ç”±çš„absolutePathä¸Š ç„¶åç›‘å¬popstateäº‹ä»¶ï¼Œå…¶åªèƒ½é€šè¿‡æµè§ˆå™¨çš„ å‰è¿›/åé€€ æŒ‰é’®è§¦å‘ è§¦å‘åä¼šä¿å­˜å½“å‰ä½ç½®ï¼Œå¹¶æ›´æ–°_key è¿™æ ·å°±å¯ä»¥åœ¨è·¯ç”±å‘ç”Ÿå˜åŒ–è§¦å‘popstateæ—¶ï¼Œä¿å­˜å½“å‰ä½ç½®å¹¶è®¾ç½®å”¯ä¸€_key çœ‹ä¸‹å…¶æ˜¯å¦‚ä½•å­˜å–ä½ç½®ä¿¡æ¯çš„ 123456789101112// src/util/scroll.jsconst positionStore = Object.create(null) // ä¿å­˜é¡µé¢æ»šåŠ¨ä½ç½®export function saveScrollPosition() &#123; const key = getStateKey() if (key) &#123; positionStore[key] = &#123; x: window.pageXOffset, y: window.pageYOffset, &#125; &#125;&#125; å…¶åˆ©ç”¨positionStoreå¯¹è±¡é…åˆå”¯ä¸€çš„_keyæ¥å­˜å–ä½ç½® åœ¨handleScrollæ—¶å°±å¯ä»¥é€šè¿‡_keyå–å‡ºä¹‹å‰ä¿å­˜çš„ä½ç½® handleScroll å¤„ç†æ»šåŠ¨çš„ä»£ç ä½äºsrc/util/scroll.js 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253export function handleScroll ( router: Router, to: Route, from: Route, isPop: boolean// æ˜¯å¦popstateï¼Œåªæœ‰æµè§ˆå™¨çš„ å‰è¿›/åé€€ æŒ‰é’®æ‰ä¼šè§¦å‘ï¼Œä¹Ÿåªæœ‰popstateæ—¶ï¼Œæ‰ä¼šä¿å­˜æ»šåŠ¨ä½ç½®) &#123; if (!router.app) &#123; return &#125; const behavior = router.options.scrollBehavior if (!behavior) &#123; return &#125; if (process.env.NODE_ENV !== 'production') &#123; assert(typeof behavior === 'function', `scrollBehavior must be a function`) &#125; // wait until re-render finishes before scrolling // é‡æ–°æ¸²æŸ“ç»“æŸï¼Œå†å¤„ç†æ»šåŠ¨ router.app.$nextTick(() =&gt; &#123; const position = getScrollPosition() // è·å–ä¹‹å‰ä¿å­˜çš„æ»šåŠ¨ä½ç½® // https://router.vuejs.org/zh/guide/advanced/scroll-behavior.html#%E6%BB%9A%E5%8A%A8%E8%A1%8C%E4%B8%BA const shouldScroll = behavior.call( router, to, from, isPop ? position : null // ç¬¬ä¸‰ä¸ªå‚æ•° savedPosition å½“ä¸”ä»…å½“ popstate å¯¼èˆª (é€šè¿‡æµè§ˆå™¨çš„ å‰è¿›/åé€€ æŒ‰é’®è§¦å‘) æ—¶æ‰å¯ç”¨ã€‚,æ‰€ä»¥æ˜¯popstateæ—¶ï¼Œæ‰æœ‰savedPosition ) // è¿”å›ä¸€ä¸ªfalsyå€¼æ—¶ï¼Œä»£è¡¨ä¸éœ€è¦æ»šåŠ¨ if (!shouldScroll) &#123; return &#125; // v.2.8.0æ”¯æŒå¼‚æ­¥æ»šåŠ¨ // https://router.vuejs.org/zh/guide/advanced/scroll-behavior.html#%E5%BC%82%E6%AD%A5%E6%BB%9A%E5%8A%A8 if (typeof shouldScroll.then === 'function') &#123; shouldScroll .then(shouldScroll =&gt; &#123; scrollToPosition((shouldScroll: any), position) &#125;) .catch(err =&gt; &#123; if (process.env.NODE_ENV !== 'production') &#123; assert(false, err.toString()) &#125; &#125;) &#125; else &#123; scrollToPosition(shouldScroll, position) &#125; &#125;)&#125; åœ¨$nextTickä¸­è°ƒç”¨getScrollPositionè·å–ä¹‹å‰ä¿å­˜å¥½çš„ä½ç½® å†è°ƒç”¨æˆ‘ä»¬ä¼ å…¥çš„scrollBehavioræŸ¥çœ‹å…¶è¿”å›å€¼æ¥ç¡®å®šæ˜¯å¦éœ€è¦è¿›è¡Œæ»šåŠ¨ è¿˜åˆ¤æ–­äº†ä¸€æ³¢æ˜¯å¦æ˜¯å¼‚æ­¥æ»šåŠ¨ è‹¥æ˜¯ï¼Œåˆ™ç­‰å¾…å…¶resolvedå†è°ƒç”¨scrollToPosition å¦åˆ™ç›´æ¥è°ƒç”¨scrollToPosition getScrollPositionã€scrollToPositionä»£ç å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233343536373839// src/util/scroll.js// è·å–ä¿å­˜çš„æ»šåŠ¨ä½ç½®function getScrollPosition(): ?Object &#123; const key = getStateKey() // å–å”¯ä¸€key if (key) &#123; return positionStore[key] // å–ä½ç½® &#125;&#125;// æ»šåŠ¨åˆ°æŒ‡å®šä½ç½®ï¼Œæ”¯æŒæ»šåŠ¨åˆ°ç‰¹å®šå…ƒç´ // https://router.vuejs.org/zh/guide/advanced/scroll-behavior.html#%E6%BB%9A%E5%8A%A8%E8%A1%8C%E4%B8%BAfunction scrollToPosition(shouldScroll, position) &#123; const isObject = typeof shouldScroll === 'object' // æ»šåŠ¨åˆ°ç‰¹å®šdom if (isObject &amp;&amp; typeof shouldScroll.selector === 'string') &#123; // getElementById would still fail if the selector contains a more complicated query like #main[data-attr] // but at the same time, it doesn't make much sense to select an element with an id and an extra selector const el = hashStartsWithNumberRE.test(shouldScroll.selector) // $flow-disable-line ? document.getElementById(shouldScroll.selector.slice(1)) // $flow-disable-line : document.querySelector(shouldScroll.selector) if (el) &#123; let offset = shouldScroll.offset &amp;&amp; typeof shouldScroll.offset === 'object' ? shouldScroll.offset : &#123;&#125; offset = normalizeOffset(offset) position = getElementPosition(el, offset) &#125; else if (isValidPosition(shouldScroll)) &#123; position = normalizePosition(shouldScroll) &#125; &#125; else if (isObject &amp;&amp; isValidPosition(shouldScroll)) &#123; // ç›´æ¥æ»šåŠ¨åˆ°æŒ‡å®šä½ç½® position = normalizePosition(shouldScroll) &#125; if (position) &#123; window.scrollTo(position.x, position.y) &#125;&#125; è·å–æ»šåŠ¨ä½ç½®ï¼Œæ˜¯åˆ©ç”¨_keyä»positionStoreä¸Šè¯»å–ä¹‹å‰ä¿å­˜çš„ä½ç½®ä¿¡æ¯ scrollToPositionçš„é€»è¾‘å¾ˆæ¸…æ™°ï¼Œå…¶å¤„ç†äº†æ»šåŠ¨åˆ°æŒ‡å®šdomå’Œç›´æ¥æ»šåŠ¨åˆ°ç‰¹å®šä½ç½®çš„åœºæ™¯ å°ç»“ vue-routerå¤„ç†æ»šåŠ¨ä¸»è¦åˆ©ç”¨äº†History APIå¯ä»¥ä¿å­˜çŠ¶æ€çš„ç‰¹æ€§å®ç° åœ¨è·¯ç”±è¿›å…¥å‰ä¿å­˜æ»šåŠ¨ä½ç½®ï¼Œå¹¶åœ¨ä¸‹æ¬¡è·¯ç”±å˜åŒ–æ—¶ï¼Œå°è¯•å–å›ä¹‹å‰ä½ç½®ï¼Œåœ¨$nextTickä¸­çœŸæ­£çš„å¤„ç†æ»šåŠ¨ å…¶æ”¯æŒæ»šåŠ¨åˆ°æŒ‡å®šä½ç½®ã€æŒ‡å®š DOMã€å¼‚æ­¥æ»šåŠ¨ç­‰åœºæ™¯ view ç»„ä»¶ vue-routerå†…ç½®äº†router-viewã€router-linkä¸¤ä¸ªç»„ä»¶ å‰è€…è´Ÿè´£åœ¨åŒ¹é…åˆ°è·¯ç”±è®°å½•åå°†å¯¹åº”è·¯ç”±ç»„ä»¶æ¸²æŸ“å‡ºæ¥ åè€…æ”¯æŒç”¨æˆ·åœ¨å…·æœ‰è·¯ç”±åŠŸèƒ½çš„åº”ç”¨ä¸­ (ç‚¹å‡») å¯¼èˆª æˆ‘ä»¬å…ˆæ¥çœ‹router-viewç»„ä»¶ router-view router-viewçš„ä¸»è¦èŒè´£å°±æ˜¯å°†è·¯ç”±ç»„ä»¶æ¸²æŸ“å‡ºæ¥ å®šä¹‰ä½äºsrc/components/view.js 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104// src/components/view.jsexport default &#123; name: 'RouterView', functional: true, // å‡½æ•°å¼ç»„ä»¶ï¼Œæ²¡æœ‰thisï¼›https://cn.vuejs.org/v2/guide/render-function.html#å‡½æ•°å¼ç»„ä»¶ props: &#123; name: &#123; type: String, default: 'default', &#125;, &#125;, // _ä¸ºhå³createElementï¼Œä½†router-viewæ²¡æœ‰ä½¿ç”¨è‡ªèº«çš„hï¼Œè€Œæ˜¯ä½¿ç”¨äº†çˆ¶èŠ‚ç‚¹çš„h render(/* h*/ _, /* context*/ &#123; props, children, parent, data &#125;) &#123; // used by devtools to display a router-view badge data.routerView = true // æ ‡è¯†å½“å‰ç»„ä»¶ä¸ºrouter-view // directly use parent context's createElement() function // so that components rendered by router-view can resolve named slots const h = parent.$createElement // ä½¿ç”¨çˆ¶èŠ‚ç‚¹çš„æ¸²æŸ“å‡½æ•° const name = props.name // å‘½åè§†å›¾ const route = parent.$route // ä¾èµ–çˆ¶èŠ‚ç‚¹çš„$routeï¼Œè€Œåœ¨install.jsä¸­æˆ‘ä»¬çŸ¥é“,æ‰€æœ‰ç»„ä»¶è®¿é—®åˆ°çš„$routeå…¶å®éƒ½æ˜¯_routerRoot._routeï¼Œå³Vueæ ¹å®ä¾‹ä¸Šçš„_routeï¼›å½“è·¯ç”±è¢«ç¡®è®¤åï¼Œè°ƒç”¨updateRouteæ—¶ï¼Œä¼šæ›´æ–°_routerRoot._routeï¼Œè¿›è€Œå¯¼è‡´router-viewç»„ä»¶é‡æ–°æ¸²æŸ“ // ç¼“å­˜ const cache = parent._routerViewCache || (parent._routerViewCache = &#123;&#125;) // determine current view depth, also check to see if the tree // has been toggled inactive but kept-alive. let depth = 0 // å½“å‰router-viewåµŒå¥—æ·±åº¦ let inactive = false // æ˜¯å¦è¢«keep-aliveåŒ…è£¹å¹¶å¤„äºéæ¿€æ´»çŠ¶æ€ // å‘ä¸ŠæŸ¥æ‰¾ï¼Œè®¡ç®—depthã€inactive // å½“parentæŒ‡å‘Vueæ ¹å®ä¾‹ç»“æŸå¾ªç¯ while (parent &amp;&amp; parent._routerRoot !== parent) &#123; const vnodeData = parent.$vnode ? parent.$vnode.data : &#123;&#125; if (vnodeData.routerView) &#123; depth++ &#125; // å¤„ç†keep-alive // keep-aliveç»„ä»¶ä¼šæ·»åŠ keepAlive=trueæ ‡è¯† // https://github.com/vuejs/vue/blob/52719ccab8fccffbdf497b96d3731dc86f04c1ce/src/core/components/keep-alive.js#L120 if (vnodeData.keepAlive &amp;&amp; parent._directInactive &amp;&amp; parent._inactive) &#123; inactive = true &#125; parent = parent.$parent &#125; data.routerViewDepth = depth // render previous view if the tree is inactive and kept-alive // å¦‚æœå½“å‰ç»„ä»¶æ ‘è¢«keep-aliveåŒ…è£¹ï¼Œä¸”å¤„äºéæ¿€æ´»çŠ¶æ€ï¼Œåˆ™æ¸²æŸ“ä¹‹å‰ä¿å­˜çš„è§†å›¾ if (inactive) &#123; const cachedData = cache[name] const cachedComponent = cachedData &amp;&amp; cachedData.component // æ‰¾åˆ°ç¼“å­˜çš„ç»„ä»¶ if (cachedComponent) &#123; // #2301 // pass props // ä¼ é€’ç¼“å­˜çš„props if (cachedData.configProps) &#123; fillPropsinData( cachedComponent, data, cachedData.route, cachedData.configProps ) &#125; return h(cachedComponent, data, children) &#125; else &#123; // æœªæ‰¾åˆ°ç¼“å­˜çš„ç»„ä»¶ // render previous empty view return h() &#125; &#125; // é€šè¿‡depthè·å–åŒ¹é…çš„route record // ç”±äºformatMatchæ˜¯é€šè¿‡unshiftæ·»åŠ çˆ¶route recordçš„ // æ‰€ä»¥route.matched[depth]æ­£å¥½èƒ½å–åˆ°åŒ¹é…çš„route record const matched = route.matched[depth] const component = matched &amp;&amp; matched.components[name] // å–å‡ºè·¯ç”±ç»„ä»¶ // render empty node if no matched route or no config component // æ‰¾ä¸åˆ°ï¼Œæ¸²æŸ“ç©ºç»„ä»¶ if (!matched || !component) &#123; cache[name] = null return h() &#125; // cache component // ç¼“å­˜ç»„ä»¶ cache[name] = &#123; component &#125; // attach instance registration hook // this will be called in the instance's injected lifecycle hooks // ä¸ºè·¯ç”±è®°å½•ç»‘å®šè·¯ç”±ç»„ä»¶ï¼Œåœ¨æ‰€æœ‰ç»„ä»¶çš„beforeCreateã€destoryed hookä¸­è°ƒç”¨ï¼Œè§install.jsä¸­çš„registerInstanceæ–¹æ³• // æ­¤æ–¹æ³•åªåœ¨router-viewä¸Šå®šä¹‰äº† // vmï¼Œvaléƒ½ä¸ºè·¯ç”±ç»„ä»¶å®ä¾‹ // å¦‚ä¸‹ // matched.instances:&#123; // default:VueComp, // hd:VueComp2, // bd:VueComp3 // &#125; data.registerRouteInstance = (vm, val) =&gt; &#123; // val could be undefined for unregistration const current = matched.instances[name] if ( (val &amp;&amp; current !== vm) || // ç»‘å®š (!val &amp;&amp; current === vm) ) &#123; // è‹¥valä¸å­˜åœ¨ï¼Œåˆ™å¯è§†ä¸ºè§£ç»‘ matched.instances[name] = val &#125; &#125; // also register instance in prepatch hook // in case the same component instance is reused across different routes // å½“ç›¸åŒç»„ä»¶åœ¨ä¸åŒè·¯ç”±é—´å¤ç”¨æ—¶ï¼Œä¹Ÿéœ€è¦ä¸ºrouter-viewç»‘å®šè·¯ç”±ç»„ä»¶ ;(data.hook || (data.hook = &#123;&#125;)).prepatch = (_, vnode) =&gt; &#123; matched.instances[name] = vnode.componentInstance &#125; // register instance in init hook // in case kept-alive component be actived when routes changed // keep-aliveç»„ä»¶è¢«æ¿€æ´»æ—¶ï¼Œéœ€è¦ä¸ºrouter-viewæ³¨å†Œè·¯ç”±ç»„ä»¶ data.hook.init = (vnode) =&gt; &#123; if ( vnode.data.keepAlive &amp;&amp; vnode.componentInstance &amp;&amp; vnode.componentInstance !== matched.instances[name] ) &#123; matched.instances[name] = vnode.componentInstance &#125; &#125; // route recordè®¾ç½®äº†è·¯ç”±ä¼ å‚ï¼›åŠ¨æ€è·¯ç”±ä¼ å‚ï¼›https://router.vuejs.org/zh/guide/essentials/passing-props. const configProps = matched.props &amp;&amp; matched.props[name] // save route and configProps in cachce // å¦‚æœè®¾ç½®äº†è·¯ç”±ä¼ å‚ï¼Œåˆ™ç¼“å­˜èµ·æ¥ï¼Œå¹¶å°†å¡«å……props if (configProps) &#123; extend(cache[name], &#123; route, configProps, &#125;) fillPropsinData(component, data, route, configProps) &#125; return h(component, data, children) &#125;,&#125; å…¶è¢«å®šä¹‰æˆä¸€ä¸ªå‡½æ•°å¼ç»„ä»¶ï¼Œè¿™ä»£è¡¨å®ƒæ²¡æœ‰çŠ¶æ€å’Œå®ä¾‹(this ä¸Šä¸‹æ–‡)ï¼Œåªæ¥æ”¶äº†nameæ¥åšå‘½åè§†å›¾ æˆ‘ä»¬é‡ç‚¹çœ‹ä¸‹renderæ–¹æ³• ç”±äºå…¶æ˜¯ä¸€ä¸ªå‡½æ•°å¼ç»„ä»¶ï¼Œæ‰€ä»¥å¾ˆå¤šæ“ä½œæ˜¯å€ŸåŠ©çˆ¶èŠ‚ç‚¹æ¥å®Œæˆçš„ ä¸ºäº†æ”¯æŒè§£æå‘½åæ’æ§½ï¼Œå…¶æ²¡æœ‰ä½¿ç”¨è‡ªå·±çš„createElementæ–¹æ³•ï¼Œè€Œæ˜¯ä½¿ç”¨çˆ¶èŠ‚ç‚¹çš„createElementæ–¹æ³• ç”±äºæ²¡æœ‰ this ä¸Šä¸‹æ–‡ï¼Œæ— æ³•é€šè¿‡this.$routeè·å¾—å½“å‰è·¯ç”±å¯¹è±¡ï¼Œå¹²è„†å°±ç›´æ¥ä½¿ç”¨çˆ¶èŠ‚ç‚¹çš„$route å¯ä»¥çœ‹åˆ°æ·»åŠ äº†ä¸€ä¸ªæ ‡å¿—é‡routerViewï¼Œä¸»è¦ç”¨æ¥åœ¨vue-devtoolsä¸­æ ‡è¯†viewç»„ä»¶å’Œåœ¨æŸ¥æ‰¾æ·±åº¦æ—¶ç”¨ ç„¶åå£°æ˜äº†ä¸€ä¸ªç¼“å­˜å¯¹è±¡_routerViewCacheå¹¶èµ‹å€¼ç»™cacheå˜é‡ï¼Œç”¨æ¥åœ¨keep-aliveæ¿€æ´»æ—¶å¿«é€Ÿå–å‡ºè¢«ç¼“å­˜çš„è·¯ç”±ç»„ä»¶ å¼€å§‹ä»å½“å‰èŠ‚ç‚¹å¾€ä¸ŠæŸ¥æ‰¾Vueæ ¹å®ä¾‹ï¼Œåœ¨æŸ¥æ‰¾çš„è¿‡ç¨‹ä¸­è®¡ç®—å‡ºviewç»„ä»¶çš„æ·±åº¦ä»¥åŠæ˜¯å¦è¢«kepp-aliveåŒ…è£¹å¹¶å¤„äºinativeçŠ¶æ€ depthä¸»è¦ç”¨æ¥è·å–å½“å‰viewå¯¹åº”çš„è·¯ç”±è®°å½• å‰é¢è¯´è¿‡ï¼Œvue-routeræ˜¯æ”¯æŒåµŒå¥—è·¯ç”±çš„ï¼Œå¯¹åº”çš„viewä¹Ÿæ˜¯å¯ä»¥åµŒå¥—çš„ è€Œä¸”åœ¨åŒ¹é…è·¯ç”±è®°å½•æ—¶ï¼Œæœ‰ä¸‹é¢çš„é€»è¾‘ï¼Œå½“ä¸€ä¸ªè·¯ç”±è®°å½•åŒ¹é…äº†ï¼Œå¦‚æœå…¶è¿˜æœ‰çˆ¶è·¯ç”±è®°å½•ï¼Œåˆ™çˆ¶è·¯ç”±è®°å½•è‚¯å®šä¹Ÿæ˜¯åŒ¹é…çš„ï¼Œå…¶ä¼šä¸€ç›´å‘ä¸ŠæŸ¥æ‰¾ï¼Œæ‰¾åˆ°ä¸€ä¸ªçˆ¶è®°å½•ï¼Œå°±é€šè¿‡unshiftå¡å…¥route.matchedæ•°ç»„ä¸­çš„ï¼Œæ‰€ä»¥çˆ¶è®°å½•è‚¯å®šåœ¨å‰ï¼Œå­è®°å½•åœ¨åï¼Œå½“å‰ç²¾å‡†åŒ¹é…çš„è®°å½•åœ¨æœ€å è§src/util/route.js formatMatchæ–¹æ³• depthçš„è®¡ç®—åœ¨é‡åˆ°çˆ¶viewç»„ä»¶æ—¶ï¼Œè‡ªå¢ 1ï¼Œé€šè¿‡ä¸æ–­å‘ä¸ŠæŸ¥æ‰¾ï¼Œä¸æ–­è‡ªå¢depthï¼Œç›´åˆ°æ‰¾åˆ°Vueæ ¹å®ä¾‹æ‰åœæ­¢ åœæ­¢æ—¶route.matched[depth]å€¼å°±æ˜¯å½“å‰viewå¯¹åº”çš„è·¯ç”±è®°å½• æœ‰äº†è·¯ç”±è®°å½•ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»ä¸Šå–å‡ºå¯¹åº”çš„è·¯ç”±ç»„ä»¶å®ä¾‹ï¼Œç„¶åæ¸²æŸ“å³å¯ å…³äºè·¯ç”±è®°å½•å’Œè·¯ç”±ç»„ä»¶å®ä¾‹æ˜¯å¦‚ä½•ç»‘å®šçš„ï¼Œæˆ‘ä»¬ä¸‹é¢ä¼šè®² æˆ‘ä»¬å…ˆçœ‹éinactiveçŠ¶æ€æ˜¯å¦‚ä½•æ¸²æŸ“è·¯ç”±ç»„ä»¶å®ä¾‹çš„ é€šè¿‡route.matched[depth]å–å‡ºå½“å‰viewåŒ¹é…çš„è·¯ç”±è®°å½• ç„¶åå†å–å‡ºå¯¹åº”çš„è·¯ç”±ç»„ä»¶å®ä¾‹ å¦‚æœè·¯ç”±è®°å½•å’Œè·¯ç”±ç»„ä»¶å®ä¾‹æœ‰ä¸€ä¸ªä¸å­˜åœ¨ï¼Œåˆ™æ¸²æŸ“ç©ºç»“ç‚¹ï¼Œå¹¶é‡ç½®cache[name]å€¼ å¦‚æœéƒ½èƒ½æ‰¾åˆ°ï¼Œåˆ™å…ˆæŠŠç»„ä»¶å®ä¾‹ç¼“å­˜ä¸‹æ¥ å¦‚æœæœ‰é…ç½®åŠ¨æ€è·¯ç”±å‚æ•°ï¼Œåˆ™æŠŠè·¯ç”±å‚æ•°ç¼“å­˜åˆ°è·¯ç”±ç»„ä»¶å®ä¾‹ä¸Šï¼Œå¹¶è°ƒç”¨fillPropsinDataå¡«å……props è°ƒç”¨hæ¸²æŸ“å¯¹åº”çš„è·¯ç”±ç»„ä»¶å®ä¾‹å³å¯ å½“ç»„ä»¶å¤„äºinactiveçŠ¶æ€æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»cacheä¸­å–å‡ºä¹‹å‰ç¼“å­˜çš„è·¯ç”±ç»„ä»¶å®ä¾‹å’Œè·¯ç”±å‚æ•°ï¼Œç„¶åæ¸²æŸ“å°±å¯ä»¥äº† ä¸»æµç¨‹å¦‚ä¸Šï¼Œä½†è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„ç‚¹æ²¡æ è·¯ç”±è®°å½•å’Œè·¯ç”±ç»„ä»¶å®ä¾‹æ˜¯å¦‚ä½•ç»‘å®šçš„ï¼Ÿ ç›¸ä¿¡ä½ å·²ç»æ³¨æ„åˆ°data.registerRouteInstanceæ–¹æ³•ï¼Œæ²¡é”™ï¼Œä»–å°±æ˜¯ç”¨æ¥ä¸ºè·¯ç”±è®°å½•ç»‘å®šè·¯ç”±ç»„ä»¶å®ä¾‹çš„ registerInstance æˆ‘ä»¬å…ˆçœ‹ä¸‹è°ƒç”¨çš„åœ°æ–¹ ä¸»è¦åœ¨src/install.jsçš„å…¨å±€æ··å…¥ä¸­ 1234567891011121314151617export function install(Vue)&#123;...// æ³¨å†Œå…¨å±€æ··å…¥ Vue.mixin(&#123; beforeCreate () &#123; ... // ä¸ºrouter-viewç»„ä»¶å…³è”è·¯ç”±ç»„ä»¶ registerInstance(this, this) &#125;, destroyed () &#123; // destroyed hookè§¦å‘æ—¶ï¼Œå–æ¶ˆrouter-viewå’Œè·¯ç”±ç»„ä»¶çš„å…³è” registerInstance(this) &#125; &#125;)&#125; å¯ä»¥çœ‹åˆ°å…¶åœ¨å…¨å±€æ··å…¥çš„beforeCreateã€destroyedé’©å­ä¸­éƒ½æœ‰è¢«è°ƒç”¨ å‰è€…ä¼ å…¥äº†ä¸¤ä¸ª vm å®ä¾‹ï¼Œåè€…åªä¼ å…¥äº†ä¸€ä¸ª vm å®ä¾‹ æˆ‘ä»¬çœ‹ä¸‹å®ç°ï¼Œä»£ç ä¹Ÿä½äºsrc/install.jsä¸­ 1234567// ä¸ºè·¯ç”±è®°å½•ã€router-viewå…³è”è·¯ç”±ç»„ä»¶const registerInstance = (vm, callVal) =&gt; &#123; let i = vm.$options._parentVnode // è°ƒç”¨vm.$options._parentVnode.data.registerRouteInstanceæ–¹æ³• // è€Œè¿™ä¸ªæ–¹æ³•åªåœ¨router-viewç»„ä»¶ä¸­å­˜åœ¨ï¼Œrouter-viewç»„ä»¶å®šä¹‰åœ¨(../components/view.js @71è¡Œ) // æ‰€ä»¥ï¼Œå¦‚æœvmçš„çˆ¶èŠ‚ç‚¹ä¸ºrouter-viewï¼Œåˆ™ä¸ºrouter-viewå…³è”å½“å‰vmï¼Œå³å°†å½“å‰vmåšä¸ºrouter-viewçš„è·¯ç”±ç»„ä»¶ if (isDef(i) &amp;&amp; isDef((i = i.data)) &amp;&amp; isDef((i = i.registerRouteInstance))) &#123; i(vm, callVal) &#125;&#125; å¯ä»¥çœ‹åˆ°å…¶æ¥æ”¶ä¸€ä¸ªvmå®ä¾‹å’ŒcallValåšä¸ºå…¥å‚ ç„¶åå–äº†vmçš„çˆ¶èŠ‚ç‚¹åšä¸º i çš„åˆå€¼ æ¥ç€ä¸€æ­¥ä¸€æ­¥ç»™ièµ‹å€¼ï¼ŒåŒæ—¶åˆ¤æ–­iæ˜¯å¦å®šä¹‰ åˆ°æœ€åï¼Œiçš„å€¼ä¸ºvm.$options._parentVnode.data.registerRouteInstance ç„¶åå°†ä¸¤ä¸ªå…¥å‚ä¼ å…¥iä¸­è°ƒç”¨ æ³¨æ„ï¼Œè¿™æ—¶çš„ i æ˜¯ vm çˆ¶èŠ‚ç‚¹ä¸Šçš„æ–¹æ³•ï¼Œå¹¶ä¸æ˜¯ vm ä¸Šçš„æ–¹æ³• æˆ‘ä»¬å…¨å±€æ£€ç´¢ä¸‹registerRouteInstanceå…³é”®å­—ï¼Œå‘ç°å…¶åªè¢«å®šä¹‰åœ¨äº†view.jsä¸­ï¼Œä¹Ÿå°±æ˜¯router-viewç»„ä»¶ä¸­ ç»“åˆä¸Šé¢ä¸€æ¡ï¼Œi å³registerRouteInstanceæ˜¯vmçˆ¶èŠ‚ç‚¹ä¸Šçš„æ–¹æ³•ï¼Œè€Œåªæœ‰router-viewç»„ä»¶å®šä¹‰äº†registerRouteInstance æ‰€ä»¥ï¼Œåªæœ‰å½“vmæ˜¯router-viewçš„å­èŠ‚ç‚¹æ—¶ï¼ŒregisterRouteInstanceæ–¹æ³•æ‰ä¼šè¢«è°ƒç”¨ i(vm, callVal)å¯ä»¥è¡¨è¾¾ä¸ºvm._parentVnode.registerRouteInstance(vm,vm) çœ‹ä¸‹registerRouteInstanceçš„å®ç° 12345678910111213141516171819202122// src/components/view.js ...// ä¸ºè·¯ç”±è®°å½•ç»‘å®šè·¯ç”±ç»„ä»¶ï¼Œåœ¨æ‰€æœ‰ç»„ä»¶çš„beforeCreateã€destoryed hookä¸­è°ƒç”¨ï¼Œè§install.jsä¸­çš„registerInstanceæ–¹æ³• // æ­¤æ–¹æ³•åªåœ¨router-viewä¸Šå®šä¹‰äº† // vmï¼Œvaléƒ½ä¸ºè·¯ç”±ç»„ä»¶å®ä¾‹ // å¦‚ä¸‹ // matched.instances:&#123; // default:VueComp, // hd:VueComp2, // bd:VueComp3 // &#125; data.registerRouteInstance = (vm, val) =&gt; &#123; // val could be undefined for unregistration const current = matched.instances[name] if ( (val &amp;&amp; current !== vm) || // ç»‘å®š (!val &amp;&amp; current === vm) // è‹¥valä¸å­˜åœ¨ï¼Œåˆ™å¯è§†ä¸ºè§£ç»‘ ) &#123; matched.instances[name] = val &#125; &#125; matchedä¿å­˜çš„æ˜¯å½“å‰åŒ¹é…åˆ°çš„è·¯ç”±è®°å½•ï¼Œnameæ˜¯å‘½åè§†å›¾å å¦‚æœvalå­˜åœ¨ï¼Œå¹¶ä¸”å½“å‰è·¯ç”±ç»„ä»¶å’Œä¼ å…¥çš„ä¸åŒï¼Œé‡æ–°èµ‹å€¼ å¦‚æœvalä¸å­˜åœ¨ï¼Œä¸”å½“å‰è·¯ç”±ç»„ä»¶å’Œä¼ å…¥çš„ç›¸åŒï¼Œä¹Ÿé‡æ–°èµ‹å€¼ï¼Œä½†æ˜¯æ­¤æ—¶ val ä¸ºundefinedï¼Œç›¸å½“äºè§£ç»‘ å¯ä»¥çœ‹åˆ°å‚æ•°æ•°é‡ä¸åŒï¼Œä¸€ä¸ªå‡½æ•°å®ç°äº†ç»‘å®šå’Œè§£ç»‘çš„åŒé‡æ“ä½œ é€šè¿‡è¿™ä¸ªæ–¹æ³•å°±å®Œæˆäº†è·¯ç”±è®°å½•å’Œè·¯ç”±ç»„ä»¶å®ä¾‹çš„ç»‘å®šä¸è§£ç»‘æ“ä½œ è¿™æ ·å°±å¯ä»¥åœ¨viewç»„ä»¶renderæ—¶ï¼Œé€šè¿‡route.matched[depth].components[name]å–åˆ°è·¯ç”±ç»„ä»¶è¿›è¡Œæ¸²æŸ“ è¿˜æœ‰äº›åœºæ™¯ä¹Ÿéœ€è¦è¿›è¡Œç»‘å®š å½“ç›¸åŒç»„ä»¶åœ¨ä¸åŒè·¯ç”±é—´å¤ç”¨æ—¶ï¼Œéœ€è¦ä¸ºè·¯ç”±è®°å½•ç»‘å®šè·¯ç”±ç»„ä»¶ keep-aliveç»„ä»¶è¢«æ¿€æ´»æ—¶ï¼Œéœ€è¦ä¸ºè·¯ç”±è®°å½•ç»‘å®šè·¯ç”±ç»„ä»¶ å°ç»“ router-viewæ˜¯ä¸€ä¸ªå‡½æ•°å¼ç»„ä»¶ï¼Œæœ‰æ—¶éœ€è¦å€ŸåŠ©çˆ¶èŠ‚ç‚¹çš„èƒ½åŠ›ï¼Œä¾‹å¦‚ä½¿ç”¨çˆ¶èŠ‚ç‚¹çš„æ¸²æŸ“å‡½æ•°æ¥è§£æå‘½åæ’æ§½ é€šè¿‡routerViewæ¥æ ‡è¯†viewç»„ä»¶ï¼Œæ–¹ä¾¿vue-devtoolsè¯†åˆ«å‡ºviewç»„ä»¶å’Œç¡®å®šviewç»„ä»¶æ·±åº¦ é€šè¿‡å‘ä¸ŠæŸ¥æ‰¾ï¼Œç¡®å®šå½“å‰viewçš„æ·±åº¦depthï¼Œé€šè¿‡depthå–åˆ°å¯¹åº”çš„è·¯ç”±è®°å½• å†å–å‡ºé€šè¿‡registerInstanceç»‘å®šçš„è·¯ç”±ç»„ä»¶å®ä¾‹ å¦‚æœæœ‰åŠ¨æ€è·¯ç”±å‚æ•°ï¼Œåˆ™å…ˆå¡«å……propsç„¶åå†æ¸²æŸ“ å¦‚æœviewè¢«keep-aliveåŒ…è£¹å¹¶ä¸”å¤„äºinactiveçŠ¶æ€ï¼Œåˆ™ä»ç¼“å­˜ä¸­å–å‡ºè·¯ç”±ç»„ä»¶å®ä¾‹å¹¶æ¸²æŸ“ å¦‚ä½•è§¦å‘é‡æ–°æ¸²æŸ“ åœ¨å¯¼èˆªè§£æçš„ç« èŠ‚ï¼Œæˆ‘ä»¬æè¿‡ï¼Œå¯¼èˆªè§£ææˆåŠŸå ä¼šè°ƒç”¨updateRouteæ–¹æ³•ï¼Œé‡æ–°ä¸ºå…¨å±€çš„_routerRoot._routeå³$routeèµ‹å€¼ 12345678910// src/history/base.js// æ›´æ–°è·¯ç”±ï¼Œè§¦å‘afterEaché’©å­ updateRoute (route: Route) &#123; const prev = this.current this.current = route// æ›´æ–°current this.cb &amp;&amp; this.cb(route) // è°ƒç”¨updateRouteå›è°ƒï¼Œå›è°ƒä¸­ä¼šé‡æ–°ä¸º_routerRoot._routeèµ‹å€¼ï¼Œè¿›è€Œè§¦å‘router-viewçš„é‡æ–°æ¸²æŸ“ ... &#125; åœ¨viewç»„ä»¶ä¸­ï¼Œä¼šä½¿ç”¨$parent.$routeå³å…¨å±€çš„_routerRoot._route 12345678910 // src/components/view.js... render (/* h*/_, /* context*/&#123; props, children, parent, data &#125;) &#123; ... const route = parent.$route // ä¾èµ–çˆ¶èŠ‚ç‚¹çš„$routeï¼Œè€Œåœ¨install.jsä¸­æˆ‘ä»¬çŸ¥é“,æ‰€æœ‰ç»„ä»¶è®¿é—®åˆ°çš„$routeå…¶å®éƒ½æ˜¯_routerRoot._routeï¼Œå³Vueæ ¹å®ä¾‹ä¸Šçš„_routeï¼›å½“è·¯ç”±è¢«ç¡®è®¤åï¼Œè°ƒç”¨updateRouteæ—¶ï¼Œä¼šæ›´æ–°_routerRoot._routeï¼Œè¿›è€Œå¯¼è‡´router-viewç»„ä»¶é‡æ–°æ¸²æŸ“ ... &#125; è€Œåœ¨install.jsçš„å…¨å±€æ··å…¥ä¸­ï¼Œå°†_routeå®šä¹‰ä¸ºå“åº”å¼çš„ï¼Œä¾èµ–äº†_routeçš„åœ°æ–¹ï¼Œåœ¨_routeå‘ç”Ÿå˜åŒ–æ—¶ï¼Œéƒ½ä¼šé‡æ–°æ¸²æŸ“ 12345678910// src/install.js // æ³¨å†Œå…¨å±€æ··å…¥ Vue.mixin(&#123; beforeCreate () &#123; ... // å“åº”å¼å®šä¹‰_routeå±æ€§ï¼Œä¿è¯_routeå‘ç”Ÿå˜åŒ–æ—¶ï¼Œç»„ä»¶(router-view)ä¼šé‡æ–°æ¸²æŸ“ Vue.util.defineReactive(this, '_route', this._router.history.current) &#125; &#125;) è¿™æ ·å°±å®Œæˆäº†æ¸²æŸ“çš„é—­ç¯,viewä¾èµ–$route,å¯¼èˆªè§£ææˆåŠŸæ›´æ–°$routeï¼Œè§¦å‘viewæ¸²æŸ“ çœ‹å®Œäº†viewç»„ä»¶ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹å¦å¤–ä¸€ä¸ªç»„ä»¶router-link link ç»„ä»¶ router-linkç»„ä»¶è¢«å®šä¹‰åœ¨src/components/link.jsä¸­ ä¸»è¦ç”¨æ¥æ”¯æŒç”¨æˆ·åœ¨å…·æœ‰è·¯ç”±åŠŸèƒ½çš„åº”ç”¨ä¸­ (ç‚¹å‡») å¯¼èˆª router-link123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192/* @flow */import &#123; createRoute, isSameRoute, isIncludedRoute &#125; from '../util/route'import &#123; extend &#125; from '../util/misc'import &#123; normalizeLocation &#125; from '../util/location'import &#123; warn &#125; from '../util/warn'// work around weird flow bugconst toTypes: Array&lt;Function&gt; = [String, Object]const eventTypes: Array&lt;Function&gt; = [String, Array]const noop = () =&gt; &#123;&#125;export default &#123; name: 'RouterLink', props: &#123; to: &#123; type: toTypes, // string | Location required: true, &#125;, tag: &#123; type: String, default: 'a', // é»˜è®¤aæ ‡ç­¾ &#125;, exact: Boolean, // æ˜¯å¦ç²¾ç¡®åŒ¹é… append: Boolean, // æ˜¯å¦è¿½åŠ  replace: Boolean, // ä¸ºtrueï¼Œè°ƒç”¨router.replaceå¦åˆ™è°ƒç”¨router.push activeClass: String, // æ¿€æ´»çš„ç±»å exactActiveClass: String, // ç²¾ç¡®åŒ¹é…çš„ç±»å ariaCurrentValue: &#123; // æ— éšœç¢åŒ– type: String, default: 'page', &#125;, event: &#123; type: eventTypes, // è§¦å‘å¯¼èˆªçš„äº‹ä»¶ default: 'click', &#125;, &#125;, render(h: Function) &#123; const router = this.$router const current = this.$route const &#123; location, route, href &#125; = router.resolve( this.to, current, this.append ) // è§£æç›®æ ‡ä½ç½® const classes = &#123;&#125; const globalActiveClass = router.options.linkActiveClass const globalExactActiveClass = router.options.linkExactActiveClass // Support global empty active class const activeClassFallback = globalActiveClass == null ? 'router-link-active' : globalActiveClass const exactActiveClassFallback = globalExactActiveClass == null ? 'router-link-exact-active' : globalExactActiveClass const activeClass = this.activeClass == null ? activeClassFallback : this.activeClass const exactActiveClass = this.exactActiveClass == null ? exactActiveClassFallback : this.exactActiveClass // ç›®æ ‡routeï¼Œç”¨æ¥æ¯”è¾ƒæ˜¯å¦å’Œå½“å‰routeæ˜¯ç›¸åŒroute const compareTarget = route.redirectedFrom ? createRoute(null, normalizeLocation(route.redirectedFrom), null, router) : route classes[exactActiveClass] = isSameRoute(current, compareTarget) classes[activeClass] = this.exact ? classes[exactActiveClass] : isIncludedRoute(current, compareTarget) // éç²¾å‡†åŒ¹é…æ—¶ï¼Œåˆ¤æ–­ç›®æ ‡route pathæ˜¯å¦åŒ…å«å½“å‰route path const ariaCurrentValue = classes[exactActiveClass] ? this.ariaCurrentValue : null // äº‹ä»¶å¤„ç† const handler = (e) =&gt; &#123; if (guardEvent(e)) &#123; if (this.replace) &#123; router.replace(location, noop) &#125; else &#123; router.push(location, noop) &#125; &#125; &#125; const on = &#123; click: guardEvent &#125; if (Array.isArray(this.event)) &#123; this.event.forEach((e) =&gt; &#123; on[e] = handler &#125;) &#125; else &#123; on[this.event] = handler &#125; const data: any = &#123; class: classes &#125; // è¯»å–ä½œç”¨åŸŸæ’æ§½ const scopedSlot = !this.$scopedSlots.$hasNormal &amp;&amp; this.$scopedSlots.default &amp;&amp; this.$scopedSlots.default(&#123; href, route, navigate: handler, isActive: classes[activeClass], isExactActive: classes[exactActiveClass], &#125;) if (scopedSlot) &#123; // ä½œç”¨åŸŸæ’æ§½ä»…æœ‰ä¸€ä¸ªå­å…ƒç´  if (scopedSlot.length === 1) &#123; return scopedSlot[0] &#125; else if (scopedSlot.length &gt; 1 || !scopedSlot.length) &#123; // ä½œç”¨åŸŸæ’æ§½æä¾›å¤šä¸ªåä»£æˆ–æœªæä¾›åï¼Œç»™äºˆæç¤º if (process.env.NODE_ENV !== 'production') &#123; warn( false, `RouterLink with to="$&#123;this.to&#125;" is trying to use a scoped slot but it didn't provide exactly one child. Wrapping the content with a span element.` ) &#125; // æœ‰å¤šä¸ªåä»£æ—¶ï¼Œåœ¨å¤–å±‚ç”¨ä¸€ä¸ªspanåŒ…è£¹ return scopedSlot.length === 0 ? h() : h('span', &#123;&#125;, scopedSlot) &#125; &#125; // tagä¸ºa if (this.tag === 'a') &#123; data.on = on data.attrs = &#123; href, 'aria-current': ariaCurrentValue &#125; &#125; else &#123; // tagä¸ä¸ºaï¼Œåˆ™æ‰¾åä»£é¦–ä¸ªaç»‘å®šäº‹ä»¶ // find the first &lt;a&gt; child and apply listener and href const a = findAnchor(this.$slots.default) if (a) &#123; // in case the &lt;a&gt; is a static node a.isStatic = false const aData = (a.data = extend(&#123;&#125;, a.data)) aData.on = aData.on || &#123;&#125; // transform existing events in both objects into arrays so we can push later // aä¸Šå¯èƒ½è¿˜ç»‘å®šæœ‰å…¶ä»–äº‹ä»¶ï¼Œéœ€è¦å…¼å®¹ for (const event in aData.on) &#123; const handler = aData.on[event] if (event in on) &#123; aData.on[event] = Array.isArray(handler) ? handler : [handler] &#125; &#125; // append new listeners for router-link // ç»‘å®šå…¶ä»–äº‹ä»¶å¤„ç†å™¨ for (const event in on) &#123; if (event in aData.on) &#123; // on[event] is always a function aData.on[event].push(on[event]) &#125; else &#123; aData.on[event] = handler &#125; &#125; const aAttrs = (a.data.attrs = extend(&#123;&#125;, a.data.attrs)) aAttrs.href = href aAttrs['aria-current'] = ariaCurrentValue &#125; else &#123; // doesn't have &lt;a&gt; child, apply listener to self // æ²¡æ‰¾åˆ°ï¼Œåˆ™ç»™å½“å‰å…ƒç´ ç»‘å®šäº‹ä»¶ data.on = on &#125; &#125; return h(this.tag, data, this.$slots.default) &#125;,&#125;// ç‰¹æ®Šåœºæ™¯ï¼Œç‚¹å‡»ä¸åšè·³è½¬å“åº”function guardEvent(e) &#123; // don't redirect with control keys if (e.metaKey || e.altKey || e.ctrlKey || e.shiftKey) return // don't redirect when preventDefault called if (e.defaultPrevented) return // don't redirect on right click if (e.button !== undefined &amp;&amp; e.button !== 0) return // don't redirect if `target="_blank"` if (e.currentTarget &amp;&amp; e.currentTarget.getAttribute) &#123; const target = e.currentTarget.getAttribute('target') if (/\b_blank\b/i.test(target)) return &#125; // this may be a Weex event which doesn't have this method if (e.preventDefault) &#123; e.preventDefault() &#125; return true&#125;// é€’å½’æŸ¥æ‰¾åä»£aæ ‡ç­¾function findAnchor(children) &#123; if (children) &#123; let child for (let i = 0; i &lt; children.length; i++) &#123; child = children[i] if (child.tag === 'a') &#123; return child &#125; if (child.children &amp;&amp; (child = findAnchor(child.children))) &#123; return child &#125; &#125; &#125;&#125; å…¶å®ç°å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ç»„ä»¶ï¼Œå®ç°äº†ç‚¹å‡»æ—¶è·³è½¬åˆ°toå¯¹åº”çš„è·¯ç”±åŠŸèƒ½ ç”±äºæ”¯æŒç‚¹å‡»æ—¶éœ€è¦æ ‡è¯†æ ·å¼ç±»ã€ç²¾å‡†åŒ¹é…exactåœºæ™¯ï¼Œæ‰€ä»¥é€šè¿‡sameRouteã€isIncludedRouteæ¥å®ç°æ ·å¼ç±»çš„æ ‡è¯†å’Œç²¾å‡†åŒ¹é…æ ‡è¯† åœ¨ç‚¹å‡»æ—¶ï¼Œå±è”½äº†éƒ¨åˆ†ç‰¹æ®Šåœºæ™¯ï¼Œå¦‚ç‚¹å‡»æ—¶åŒæ—¶æŒ‰ä¸‹ctrlã€altã€shiftç­‰control keysæ—¶ï¼Œä¸åšè·³è½¬ çœ‹å®Œç»„ä»¶åï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹routerè¿˜ç»™æˆ‘ä»¬æä¾›å“ªäº›å®ä¾‹æ–¹æ³• å®ä¾‹å±æ€§ã€æ–¹æ³• routerå¯¹å¤–æš´éœ²äº†å¾ˆå¤šå±æ€§å’Œæ–¹æ³• è¿™äº›å±æ€§å’Œæ–¹æ³•åœ¨å‰é¢çš„æºç éƒ¨åˆ†ä¹Ÿéƒ½æœ‰ç”¨è¿‡ å®ä¾‹å±æ€§ router.app é…ç½®äº† router çš„ Vue æ ¹å®ä¾‹ router.mode è·¯ç”±ä½¿ç”¨çš„æ¨¡å¼ router.currentRoute å½“å‰è·¯ç”±å¯¹è±¡ï¼Œç­‰åŒäºthis.$route å®ä¾‹æ–¹æ³• ç”¨æ³¨å†Œå…¨å±€å¯¼èˆªå®ˆå« router.beforeEach router.beforeResolve router.afterEach ç¼–ç¨‹å¼å¯¼èˆªç›¸å…³ router.push router.replace router.go router.back router.forward æœåŠ¡ç«¯æ¸²æŸ“ç›¸å…³ router.getMatchedComponents è¿”å›ç›®æ ‡ä½ç½®æˆ–æ˜¯å½“å‰è·¯ç”±åŒ¹é…çš„ç»„ä»¶æ•°ç»„ (æ˜¯æ•°ç»„çš„å®šä¹‰/æ„é€ ç±»ï¼Œä¸æ˜¯å®ä¾‹) router.onReady è¯¥æ–¹æ³•æŠŠä¸€ä¸ªå›è°ƒæ’é˜Ÿï¼Œåœ¨è·¯ç”±å®Œæˆåˆå§‹å¯¼èˆªæ—¶è°ƒç”¨ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥è§£ææ‰€æœ‰çš„å¼‚æ­¥è¿›å…¥é’©å­å’Œè·¯ç”±åˆå§‹åŒ–ç›¸å…³è”çš„å¼‚æ­¥ç»„ä»¶ router.onError æ³¨å†Œä¸€ä¸ªå›è°ƒï¼Œè¯¥å›è°ƒä¼šåœ¨è·¯ç”±å¯¼èˆªè¿‡ç¨‹ä¸­å‡ºé”™æ—¶è¢«è°ƒç”¨ åŠ¨æ€è·¯ç”± router.addRoutes åŠ¨æ€æ·»åŠ è·¯ç”±è§„åˆ™ è§£æ router.resolve - ä¼ å…¥ä¸€ä¸ªå¯¹è±¡ï¼Œå°è¯•è§£æå¹¶è¿”å›ä¸€ä¸ªç›®æ ‡ä½ç½® æ€»ç»“ è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†vue-router@2çš„æ‰€æœ‰æºç åˆ†æ ğŸ‰ å¦‚æœæ‚¨è§‰å¾—è¿˜å¯ä»¥ï¼Œè®°å¾—å¸®æˆ‘ç‚¹ä¸ªèµ ğŸ‘ å‚è€ƒ https://github.com/dwqs/blog/issues/53 https://github.com/dwqs/blog/issues/54 https://github.com/dwqs/blog/issues/55 https://github.com/vuejs/vue-router/issues/2184#issuecomment-393484643 https://juejin.im/post/5e456513f265da573c0c6d4b https://juejin.im/post/584040e1ac502e006cbedb23 https://juejin.im/post/5df0ada0f265da33d56d1a2f https://juejin.im/post/5dbed0bef265da4cff701f68 https://www.jianshu.com/p/29e8214d0bee https://ustbhuangyi.github.io/vue-analysis/v2/vue-router/ https://blog.liuyunzhuge.com/2020/04/08/vue-router æºç ï¼šcreate-matcher/ PS åé¢è¿˜ä¼šä»‹ç»å…¶ä½™éƒ¨åˆ†ï¼Œå¦‚æœè§‰å¾—è¿˜è¡Œï¼Œå¯ä»¥ç»™ä¸ªèµå“¦ âœ¨ ä¸ªäººgithubï¼Œä¹Ÿæ€»ç»“äº†ä¸€äº›ä¸œè¥¿ï¼Œæ¬¢è¿ star åŸºäº canvas çš„ç»˜å›¾æ¿drawing-board å‰ç«¯å…¥é—¨ demoã€æœ€ä½³å®è·µé›†åˆ fe-awesome-demos ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆåˆ«åçš„vue-cli-pluginhttps://www.npmjs.com/package/vue-cli-plugin-auto-alias npm åŒ… vue-cli-plugin-auto-alias @bryanadamss/drawing-board @bryanadamss/num2chn ant-color-converter äº¤æµ å¦‚æœæœ‰é—®é¢˜ï¼Œå¯ä»¥åŠ å¾®ä¿¡äº¤æµï¼Œå…±åŒæˆé•¿ï¼Œå…±åŒè¿›æ­¥~]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>vue-router</tag>
        <tag>æºç è§£æ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[x5-video-summary]]></title>
    <url>%2F2020%2F12%2F01%2Fx5-video-summary%2F</url>
    <content type="text"><![CDATA[android x5 å†…æ ¸ webview åŒå±‚æ’­æ”¾è¸©å‘ æœ€è¿‘åœ¨åšæ··åˆAPPçš„è§†é¢‘æ’­æ”¾ï¼Œæ˜¯åŸºäºx5 å†…æ ¸çš„ï¼Œè¸©äº†ä¸å°‘å‘ï¼Œç‰¹æ­¤è®°å½•ä¸‹ã€‚ ä»‹ç» å¾®ä¿¡ã€qq ç­‰ä½¿ç”¨çš„éƒ½æ˜¯x5å†…æ ¸ webview è…¾è®¯æä¾›äº†å¯¹åº”çš„tbs sdkä½¿ç”¨x5å†…æ ¸ tbs sdkæä¾›äº†å¯¹x5 å†…æ ¸ webviewçš„å°è£… tbs sdkå¹¶æœªå†…ç½®x5å†…æ ¸ï¼Œè€Œæ˜¯é€šè¿‡è¿œç¨‹ä¸‹å‘çš„å½¢å¼ä¸‹è½½çš„ è‹¥ä¸‹è½½å¤±è´¥ï¼Œä¼šå¯ç”¨androidè‡ªå¸¦çš„webview x5 å†…æ ¸ä¼šåœ¨é¦–æ¬¡åŠ è½½webviewæ—¶å°è¯•ä¸‹è½½ x5å†…æ ¸æœ‰è‡ªå·±çš„ä¸‹å‘ç°åº¦è§„åˆ™ https://x5.tencent.com/docs/version_plan.html é»˜è®¤æƒ…å†µä¸‹ï¼Œx5 å†…æ ¸åªä¼šåœ¨wifiä¸‹è¿›è¡Œä¸‹è½½å’Œæ›´æ–° éwifiåœºæ™¯éœ€è¦è®¾ç½®QbSdk.setDownloadWithoutWifi(true) ## åŒå±‚æ’­æ”¾è§£é‡Š æ­£å¸¸æƒ…å†µä¸‹ï¼ŒH5 videoæ’­æ”¾æ—¶æ‹¥æœ‰æœ€é«˜å±‚çº§ï¼Œæ— æ³•åœ¨å…¶ä¸Šè¦†ç›–ä»»ä½•å›¾å±‚ é€šè¿‡x5çš„åŒå±‚æ’­æ”¾ï¼Œå¯ä»¥å®ç°åœ¨videoä¸Šè¦†ç›–å…¶å®ƒå›¾å±‚ ä¾‹å¦‚ï¼šå¼¹å¹•ã€è‡ªå®šä¹‰çš„æ§åˆ¶å±‚ç­‰ å¦‚ä½•å¼€å¯ H5videoæ·»åŠ x5-video-player-type=&#39;h5-page&#39;å±æ€§å³å¯ ä¸è¦ä¸x5-playsinlineåŒæ—¶å­˜åœ¨ï¼Œå¯ä»¥ä¸disablepictureinpictureã€playsinlineã€webkit-playsinlineã€x-webkit-airplay=&quot;allow&quot;ç­‰å…±å­˜ å› ä¸ºx5-playsinlineæ˜¯æŒ‡å®šnativeæ’­æ”¾ï¼Œå…¶ä¼˜å…ˆçº§å¤§äºh5-page éœ€è¦webviewå¼€å¯ç¡¬ä»¶åŠ é€Ÿ AndroidManifest.xmlä¸­æ·»åŠ android:hardwareAccelerated=&quot;true&quot; å¸¸è§é—®é¢˜è§†é¢‘æœ‰å£°éŸ³æ— ç”»é¢ æ£€æŸ¥æ˜¯å¦å¼€å¯ç¡¬ä»¶åŠ é€Ÿ æ£€æŸ¥è§†é¢‘è§£ç åº“æ˜¯å¦ä¸‹è½½æˆåŠŸ æ£€æŸ¥ç½‘ç»œæƒ…å†µ æ£€æŸ¥æ˜¯å¦å­˜åœ¨ç½‘ç»œé»‘/ç™½åå•æœºåˆ¶ è§†é¢‘ç¼–ç æ˜¯å¦æœ‰é—®é¢˜ï¼ˆéƒ¨åˆ†é aoc h.264 æ ¼å¼çš„ mp4 ä¼šå­˜åœ¨æ­¤é—®é¢˜ï¼Œè½¬æ¢ä¸º aoc h.264 æ ¼å¼å³å¯è§£å†³ï¼‰ ç‚¹å‡»å…¨å±å¡æ­» æ£€æŸ¥webviewçš„standardFullScreençš„å€¼æ˜¯å¦ä¸ºtrueï¼Œå¹¶ä¸”æ²¡æœ‰å®ç°WebChromeClientçš„onShowCustomViewæ–¹æ³• è‹¥ä½¿ç”¨åŒå±‚æ’­æ”¾ï¼Œç‚¹å‡»å…¨å±åï¼Œåˆ™ä¼šè¿›å…¥nativeçš„å…¨å±æ’­æ”¾å™¨ï¼Œå¯èƒ½å­˜åœ¨ä¸éœ€è¦çš„åŠŸèƒ½ï¼Œä¾‹å¦‚åˆ†äº«ï¼›æ­¤éƒ¨åˆ†æ— æ³•è‡ªå®šä¹‰ è§£å†³æ–¹æ³•ï¼š å¯ä½¿ç”¨cssæ¨¡æ‹Ÿå…¨å±ï¼ˆè®¾ç½®å®½é«˜100%ï¼‰è§„é¿æ­¤é—®é¢˜ ç‰¹æ®Šåœºæ™¯ï¼Œå¯å±è”½å…¨å±æŒ‰é’® video::-webkit-media-controls-fullscreen-button { display: none; } æœªæ’­æ”¾æ—¶ï¼Œå¿«é€Ÿç‚¹å‡»è§†é¢‘å·¦ä¾§ã€å³ä¾§åŒºåŸŸå¿«è¿›æ—¶ï¼Œæ’­æ”¾æŒ‰é’®å›¾æ ‡ä¼šä¸¢å¤± å¼€å¯åŒå±‚æ’­æ”¾ï¼Œå¹¶åœ¨å…¶ä¹‹ä¸Šæ·»åŠ é€æ˜è’™å±‚ï¼Œç‚¹å‡»æ—¶éšè—è’™å±‚å¹¶æ’­æ”¾è§†é¢‘ å¦‚ä½•æŸ¥çœ‹å½“å‰webviewä½¿ç”¨çš„x5 å†…æ ¸ç‰ˆæœ¬ åŸç”Ÿå¯è°ƒç”¨QbSdk.getTbsVersionè·å–å†…æ ¸ç‰ˆæœ¬å· H5åˆ™å¯è¿›å…¥webviewï¼Œè·³è½¬http://soft.imtt.qq.com/browser/tes/feedback.htmlï¼Œé¡µé¢æ˜¾ç¤ºçš„é000000æ•°å­—å³ä¸ºå†…æ ¸ç‰ˆæœ¬ H5å¯æ£€æŸ¥navigator.userAgentå­—ç¬¦ä¸²ä¸­TBS/åé¢çš„ 6 ä½æ•°å­— å¦‚ä½•è°ƒè¯•ã€å‡çº§ X5 å†…æ ¸ç‰ˆæœ¬ è®¿é—®http://debugtbs.qq.comï¼Œè¿›å…¥x5å†…æ ¸è°ƒè¯•é¡µé¢ æ£€æµ‹æ˜¯å¦å®‰è£…x5 å†…æ ¸ æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬ å¯åœ¨çº¿å‡çº§x5 å†…æ ¸ç‰ˆæœ¬ å®‰è£…æœ¬åœ°x5 å†…æ ¸ å¼€å¯å†…ç½®vconsole å‚è€ƒèµ„æ–™ æ–‡æ¡£ https://x5.tencent.com/docs/access.html å¦‚ä½•åŠ è½½ X5 å†…æ ¸ç±» https://x5.tencent.com/tbs/technical.html#/list/sdk/916172a5-f14e-40ed-9915-eaf74e9acba8/%E5%8A%A0%E8%BD%BDX5%E5%86%85%E6%A0%B8%E7%B1%BB æ¥å…¥æ–‡æ¡£ https://x5.tencent.com/tbs/guide/sdkInit.html SDKæ¥å…¥é—®é¢˜ https://x5.tencent.com/tbs/technical.html#/sdk PS åé¢è¿˜ä¼šä»‹ç»å…¶ä½™éƒ¨åˆ†ï¼Œå¦‚æœè§‰å¾—è¿˜è¡Œï¼Œå¯ä»¥ç»™ä¸ªèµå“¦ âœ¨ ä¸ªäººgithubhttps://github.com/BryanAdamssï¼Œä¹Ÿæ€»ç»“äº†ä¸€äº›ä¸œè¥¿ï¼Œæ¬¢è¿ star åŸºäº canvas çš„ç»˜å›¾æ¿drawing-board å‰ç«¯å…¥é—¨ demoã€æœ€ä½³å®è·µé›†åˆ fe-awesome-demos ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆåˆ«åçš„vue-cli-pluginhttps://www.npmjs.com/package/vue-cli-plugin-auto-alias]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>x5</tag>
        <tag>tbs</tag>
        <tag>video</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vue-router-analysis-part2]]></title>
    <url>%2F2020%2F12%2F01%2Fvue-router-analysis-part2%2F</url>
    <content type="text"><![CDATA[vue-router æºç è§£æ | 1.5w å­— | å¤šå›¾é¢„è­¦ - ã€ä¸­ã€‘ å„ä½å¥½ï¼Œæˆ‘æ˜¯å…‰è¾‰ ğŸ˜ æœ¬ç¯‡æ˜¯vue-routeræºç è§£æçš„ä¸­ç¯‡ï¼Œä¹Ÿæ˜¯æ ¸å¿ƒç¯‡ æœ¬ç¯‡ä¸»è¦ä»‹ç»äº†ä¸‹é¢å‡ ç‚¹ ä»‹ç»äº†vue-routeræ˜¯å¦‚ä½•åšè·¯ç”±åŒ¹é…çš„ ä»¥åŠå…¶ç›¸å…³çš„å®ˆå«ã€é’©å­æ˜¯å¦‚ä½•è§¦å‘çš„ å¼‚æ­¥ç»„ä»¶åˆæ˜¯å¦‚ä½•å¤„ç†çš„ç­‰ç­‰ è™½ç„¶çœ‹ç€çŸ¥è¯†ç‚¹å¾ˆå°‘ï¼Œä½†å†…å®¹å´ä¸€ç‚¹éƒ½ä¸å°‘ å¦å¤–è¿˜æ˜¯è¦è¯´ä¸€ä¸‹ ç¬¬ä¸€æ¬¡åšæºç è§£æï¼Œè‚¯å®šæœ‰å¾ˆå¤šé”™è¯¯æˆ–ç†è§£ä¸åˆ°ä½çš„åœ°æ–¹ï¼Œæ¬¢è¿æŒ‡æ­£ ğŸ¤ é¡¹ç›®åœ°å€ https://github.com/BryanAdamss/vue-router-for-analysis å¦‚æœè§‰å¾—å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè®°å¾—ç»™æˆ‘ä¸€ä¸ªstarâœ¨ uml å›¾æºæ–‡ä»¶ https://github.com/BryanAdamss/vue-router-for-analysis/blob/dev/vue-router.EAP å…³è”æ–‡ç« é“¾æ¥ vue-routeræºç è§£æ | 1.3wå­— | å¤šå›¾é¢„è­¦ - ã€ä¸Šã€‘ vue-router æºç è§£æ | 1.5w å­— | å¤šå›¾é¢„è­¦ - ã€ä¸­ã€‘ vue-router æºç è§£æ | 6k å­— - ã€ä¸‹ã€‘ è·¯ç”±è·³è½¬ å‰é¢ä»‹ç»è¿‡ï¼Œè¦å®ç°è·¯ç”±çš„è·³è½¬ï¼Œé¦–å…ˆå¾—ä»è·¯ç”±æ˜ å°„è¡¨ä¸­æ‰¾åˆ°ä¸åœ°å€åŒ¹é…çš„è·¯ç”±å¯¹è±¡ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¹‹ä¸ºè·¯ç”±åŒ¹é…ï¼Œæ‰¾åˆ°åŒ¹é…çš„è·¯ç”±åï¼Œç„¶åå†è§£æè·³è½¬ æ‰€ä»¥å®ç°è·¯ç”±è·³è½¬æœ‰ä¸¤ä¸ªå…³é”®æ­¥éª¤ï¼šè·¯ç”±åŒ¹é…ã€å¯¼èˆªè§£æ VueRouterå°†ä¸Šè¿°ä¸¤ä¸ªå…³é”®æ­¥éª¤å°è£…åˆ°transitionToæ–¹æ³•ä¸­äº† æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹transitionToçš„å®ç° transitionTo å‰é¢ä»‹ç»è¿‡ï¼ŒtransitionToæ–¹æ³•å®šä¹‰åœ¨åŸºç±»Historyä¸Šçš„ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546// src/history/base.js...// çˆ¶ç±»export class History &#123; ... // è·¯ç”±è·³è½¬ transitionTo ( location: RawLocation, // åŸå§‹locationï¼Œä¸€ä¸ªurlæˆ–è€…æ˜¯ä¸€ä¸ªLocation interface(è‡ªå®šä¹‰å½¢çŠ¶ï¼Œåœ¨types/router.d.tsä¸­å®šä¹‰) onComplete?: Function, // è·³è½¬æˆåŠŸå›è°ƒ onAbort?: Function// è·³è½¬å¤±è´¥å›è°ƒ ) &#123; const route = this.router.match(location, this.current) // ä¼ å…¥éœ€è¦è·³è½¬çš„locationå’Œå½“å‰è·¯ç”±å¯¹è±¡ï¼Œè¿”å›toçš„Route // ç¡®è®¤è·³è½¬ this.confirmTransition( route, () =&gt; &#123; // onCompleteï¼Œå®Œæˆ this.updateRoute(route) // æ›´æ–°routeï¼Œä¼šè§¦å‘afterEaché’©å­ onComplete &amp;&amp; onComplete(route) // è°ƒç”¨onCompleteå›è°ƒ this.ensureURL() // fire ready cbs once // è§¦å‘readyå›è°ƒ if (!this.ready) &#123; this.ready = true this.readyCbs.forEach(cb =&gt; &#123; cb(route) &#125;) &#125; &#125;, err =&gt; &#123; // onAbortï¼ŒæŠ¥é”™ï¼ˆå–æ¶ˆï¼‰ if (onAbort) &#123; onAbort(err) &#125; // è§¦å‘errorå›è°ƒ if (err &amp;&amp; !this.ready) &#123; this.ready = true this.readyErrorCbs.forEach(cb =&gt; &#123; cb(err) &#125;) &#125; &#125; ) &#125;&#125; åœ¨setupListenersç« èŠ‚ä¹Ÿä»‹ç»è¿‡transitionToçš„æ–¹æ³•ç­¾å æ¥æ”¶ä¸‰ä¸ªå‚æ•° locationä¸ºRawLocationç±»å‹ï¼Œä»£è¡¨éœ€è¦è§£æçš„åœ°å€ onCompleteæ˜¯è·³è½¬æˆåŠŸå›è°ƒï¼Œåœ¨è·¯ç”±è·³è½¬æˆåŠŸæ—¶è°ƒç”¨ onAbortæ˜¯è·³è½¬å¤±è´¥(å–æ¶ˆ)å›è°ƒï¼Œåœ¨è·¯ç”±è¢«å–æ¶ˆæ—¶è°ƒç”¨ çœ‹ä¸‹å†…éƒ¨é€»è¾‘ è°ƒç”¨routerå®ä¾‹çš„matchæ–¹æ³•ï¼Œä»è·¯ç”±æ˜ å°„è¡¨ä¸­å–åˆ°å°†è¦è·³è½¬åˆ°çš„è·¯ç”±å¯¹è±¡routeï¼›è¿™å…¶å®å°±æ˜¯è·¯ç”±åŒ¹é…è¿‡ç¨‹ï¼› æ‹¿åˆ°å°†è¦è·³è½¬çš„routeåï¼Œè°ƒç”¨confirmTransitionå®Œæˆrouteçš„è§£æè·³è½¬ï¼Œå¹¶åœ¨è·³è½¬æˆåŠŸã€å–æ¶ˆæ—¶è°ƒç”¨å¯¹åº”å›è°ƒæ–¹æ³•ï¼›è¿™æ˜¯å¯¼èˆªè§£æè¿‡ç¨‹ æˆåŠŸæ—¶ï¼Œè°ƒç”¨updateRouteè§¦å‘é‡æ–°æ¸²æŸ“ï¼Œç„¶åè§¦å‘ç›¸å…³å›è°ƒï¼›å…³äºæ¸²æŸ“ï¼Œæˆ‘ä»¬åé¢ç« èŠ‚ä¼šè®² å–æ¶ˆ(å¤±è´¥)æ—¶ï¼Œè§¦å‘ç›¸å…³å›è°ƒ é‚£æˆ‘ä»¬ä¸‹é¢å…ˆçœ‹ä¸‹è·¯ç”±åŒ¹é…è¿‡ç¨‹ è·¯ç”±åŒ¹é… transitionToä¸­ä¼šè°ƒç”¨routerå®ä¾‹çš„matchæ–¹æ³•å®ç°è·¯ç”±åŒ¹é… 123456789101112131415161718192021// src/index.jsexport default class VueRouter &#123; ... constructor (options: RouterOptions = &#123;&#125;) &#123; this.matcher = createMatcher(options.routes || [], this) ... &#125; // è·å–åŒ¹é…çš„è·¯ç”±å¯¹è±¡ match ( raw: RawLocation, current?: Route, redirectedFrom?: Location ): Route &#123; return this.matcher.match(raw, current, redirectedFrom) &#125;&#125; routerå®ä¾‹çš„matchæ–¹æ³•ï¼Œåˆè°ƒç”¨çš„åŒ¹é…å™¨çš„matchæ–¹æ³•ï¼Œå°†å‚æ•°ç›´æ¥é€ä¼ è¿‡å» å…³äºåŒ¹é…çš„åˆ›å»ºå¯ä»¥çœ‹ä¹‹å‰çš„åˆ›å»ºåŒ¹é…å™¨ç« èŠ‚ æˆ‘ä»¬ç»§ç»­çœ‹åŒ¹é…å™¨çš„matchæ–¹æ³• 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273// src/create-matcher.js...export function createMatcher ( routes: Array&lt;RouteConfig&gt;, // è·¯ç”±é…ç½®åˆ—è¡¨ router: VueRouter // VueRouterå®ä¾‹): Matcher &#123; ... // ä¼ å…¥location,è¿”å›åŒ¹é…çš„Routeå¯¹è±¡ function match ( raw: RawLocation, currentRoute?: Route, redirectedFrom?: Location ): Route &#123; // è·å–æ ¼å¼åŒ–åçš„locationï¼Œç”±äºé—­åŒ…ç‰¹æ€§ï¼Œæ‰€ä»¥æ­¤å¤„èƒ½è®¿é—®åˆ°routerå®ä¾‹ const location = normalizeLocation(raw, currentRoute, false, router) const &#123; name &#125; = location // é€šè¿‡nameåŒ¹é… if (name) &#123; const record = nameMap[name] if (process.env.NODE_ENV !== 'production') &#123; // æœªæ‰¾åˆ°è­¦å‘Š warn(record, `Route with name '$&#123;name&#125;' does not exist`) &#125; // æœªæ‰¾åˆ°è·¯ç”±è®°å½•ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªç©ºRouteè¿”å› if (!record) return _createRoute(null, location) // è·å–åŠ¨æ€è·¯ç”±å‚æ•°å const paramNames = record.regex.keys .filter(key =&gt; !key.optional) .map(key =&gt; key.name) if (typeof location.params !== 'object') &#123; location.params = &#123;&#125; &#125; // æå–å½“å‰Routeä¸­ç¬¦åˆåŠ¨æ€è·¯ç”±å‚æ•°åçš„å€¼èµ‹å€¼ç»™location if (currentRoute &amp;&amp; typeof currentRoute.params === 'object') &#123; for (const key in currentRoute.params) &#123; if (!(key in location.params) &amp;&amp; paramNames.indexOf(key) &gt; -1) &#123; location.params[key] = currentRoute.params[key] &#125; &#125; &#125; // å¡«å……params location.path = fillParams(record.path, location.params, `named route "$&#123;name&#125;"`) // åˆ›å»ºroute return _createRoute(record, location, redirectedFrom) &#125; else if (location.path) &#123; location.params = &#123;&#125; // éå†pathListï¼Œæ‰¾åˆ°èƒ½åŒ¹é…åˆ°çš„è®°å½•ï¼Œç„¶åç”ŸæˆRoute for (let i = 0; i &lt; pathList.length; i++) &#123; const path = pathList[i] const record = pathMap[path] if (matchRoute(record.regex, location.path, location.params)) &#123; // æ‰¾åˆ°åŒ¹é…çš„è·¯ç”±è®°å½•åï¼Œç”Ÿæˆå¯¹åº”Route return _createRoute(record, location, redirectedFrom) &#125; &#125; &#125; // no match return _createRoute(null, location) &#125; &#125; ç”±äºrouter.matchæ˜¯å°†å‚æ•°é€ä¼ è¿‡æ¥çš„ï¼Œæ‰€ä»¥äºŒè€…çš„ç­¾åä¸€æ¨¡ä¸€æ · rawæ˜¯RawLocationç±»å‹ï¼Œæ˜¯éœ€è¦è¿›è¡Œè·¯ç”±åŒ¹é…çš„åœ°å€ currentRouteæ˜¯å½“å‰è·¯ç”±å¯¹è±¡ redirectedFromä»£è¡¨ä»å“ªä¸ªåœ°å€é‡å®šå‘è¿‡æ¥çš„ æˆ‘ä»¬çœ‹ä¸‹matchæ–¹æ³•é€»è¾‘ é¦–å…ˆå®ƒå¯¹ä¼ å…¥çš„rawåœ°å€ï¼Œè¿›è¡Œäº†æ ¼å¼åŒ–(è§„èŒƒåŒ–) ç„¶åå–å‡ºæ ¼å¼åŒ–åœ°å€ä¸­çš„name nameå­˜åœ¨ï¼Œåˆ¤æ–­æ˜¯å¦èƒ½é€šè¿‡nameåœ¨nameMapä¸­æ‰¾åˆ°å¯¹åº”çš„è·¯ç”±è®°å½•RouteRecord æ— æ³•æ‰¾åˆ°ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°routeå¯¹è±¡è¿”å› å¯ä»¥æ‰¾åˆ°ï¼Œåˆ™å¡«å……paramsï¼Œå¹¶ä½¿ç”¨æ­¤è·¯ç”±è®°å½•åˆ›å»ºä¸€ä¸ªæ–°çš„Routeå¯¹è±¡è¿”å› nameä¸å­˜åœ¨ï¼Œåˆ™åˆ¤æ–­pathæ˜¯å¦å­˜åœ¨ å­˜åœ¨ï¼Œåˆ™åˆ©ç”¨pathListã€pathMapè°ƒç”¨matchRouteåˆ¤æ–­æ˜¯å¦åŒ¹é…ï¼Œè¿›è€Œæ‰¾åˆ°åŒ¹é…çš„è·¯ç”±è®°å½•ï¼Œç„¶åä½¿ç”¨æ­¤è·¯ç”±è®°å½•åˆ›å»ºæ–°routeå¯¹è±¡è¿”å› nameã€pathéƒ½ä¸å­˜åœ¨ åˆ™ç›´æ¥åˆ›å»ºä¸€ä¸ªæ–°routeå¯¹è±¡è¿”å› æ´»åŠ¨å›¾å¦‚ä¸‹ match.png æˆ‘ä»¬æå–ä¸€ä¸‹ä¸Šè¿°æµç¨‹çš„å…³é”®è¯ åœ°å€æ ¼å¼åŒ–normalizeLocationã€åœ°å€æ˜¯å¦åŒ¹é…åˆ¤æ–­matchRouteã€å¡«å……å‚æ•°fillParamsã€åˆ›å»ºè·¯ç”±å¯¹è±¡_createRoute åœ°å€æ ¼å¼åŒ– normalizeLocation æˆ‘ä»¬çœ‹ä¸‹ä¸ºä½•éœ€è¦å¯¹åœ°å€åšæ ¼å¼åŒ– æˆ‘ä»¬çŸ¥é“VueRouteå®šä¹‰çš„åœ°å€æ˜¯RawLocationç±»å‹çš„ï¼Œè€Œå®ƒæ˜¯è”åˆç±»å‹çš„ï¼Œæ”¯æŒstringå’ŒLocationç±»å‹ 1234567891011121314// flow/declarations.jsdeclare type Location = &#123; _normalized?: boolean name?: string path?: string hash?: string query?: Dictionary&lt;string&gt; params?: Dictionary&lt;string&gt; append?: boolean replace?: boolean&#125;declare type RawLocation = string | Location æ‰€ä»¥ä¸‹é¢çš„åœ°å€éƒ½æ˜¯åˆæ³•çš„ $router.pushæ–¹æ³•çš„å‚æ•°ä¹Ÿæ˜¯çš„RawLocationç±»å‹ï¼Œæ‰€ä»¥ä½¿ç”¨$router.pushæ¥ä¸¾ä¾‹ 1234567891011121314// å­—ç¬¦ä¸²å½¢å¼this.$router.push('home') // ç›¸å¯¹this.$router.push('/home') // ç»å¯¹// Location å¯¹è±¡å½¢å¼this.$router.push(&#123; path: 'home' &#125;)this.$router.push(&#123; path: '/home' &#125;)this.$router.push(&#123; path: '/home', query: &#123; test: 3 &#125; &#125;) // æºå¸¦qsthis.$router.push(&#123; name: 'home' &#125;) // å‘½åè·¯ç”±this.$router.push(&#123; name: 'detail', params: &#123; id: 1 &#125; &#125;) // å‘½å+å¸¦å‚this.$router.push(&#123; params: &#123; id: 1 &#125; &#125;) // ä»…å¸¦å‚ï¼Œé’ˆå¯¹ä»…æœ‰å‚æ•°å˜åŒ–çš„ç›¸å¯¹è·³è½¬ï¼›ç›¸å¯¹å‚æ•°è·³è½¬ å¯ä»¥çœ‹åˆ°VueRouteréœ€è¦å…¼å®¹ä¸Šé¢æ‰€æœ‰æƒ…å†µï¼Œä¸ºäº†æ–¹ä¾¿å¤„ç†ï¼Œéœ€è¦å¯¹åœ°å€åšæ ¼å¼åŒ– çœ‹ä¸‹å®ç°é€»è¾‘ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566// src/util/location.js// æ ¼å¼åŒ–locationexport function normalizeLocation( raw: RawLocation, // åŸå§‹locationï¼Œä¸€ä¸ªstringï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªå·²ç»æ ¼å¼åŒ–åçš„location current: ?Route, // å½“å‰è·¯ç”±å¯¹è±¡ append: ?boolean, // æ˜¯å¦æ˜¯è¿½åŠ æ¨¡å¼ router: ?VueRouter // VueRouterå®ä¾‹): Location &#123; let next: Location = typeof raw === 'string' ? &#123; path: raw &#125; : raw // named target // å·²ç»æ ¼å¼åŒ–è¿‡ï¼Œç›´æ¥è¿”å› if (next._normalized) &#123; return next &#125; else if (next.name) &#123; // å¤„ç†å‘½åå½¢å¼ï¼Œä¾‹å¦‚&#123;name:'Home',params:&#123;id:3&#125;&#125; next = extend(&#123;&#125;, raw) const params = next.params if (params &amp;&amp; typeof params === 'object') &#123; next.params = extend(&#123;&#125;, params) &#125; return next &#125; // relative params // å¤„ç†&#123;params:&#123;id:1&#125;&#125;ç›¸å¯¹å‚æ•°å½¢å¼è·³è½¬ if (!next.path &amp;&amp; next.params &amp;&amp; current) &#123; next = extend(&#123;&#125;, next) next._normalized = true const params: any = extend(extend(&#123;&#125;, current.params), next.params) // æå–å½“å‰routeçš„å­—æ®µåšä¸ºnextçš„å­—æ®µï¼Œå› ä¸ºç›¸å¯¹å‚æ•°å½¢å¼ï¼Œåªæœ‰paramsï¼Œå¿…é¡»å€ŸåŠ©currentæå–ä¸€äº›å­—æ®µ if (current.name) &#123; // å‘½åå½¢å¼ next.name = current.name next.params = params &#125; else if (current.matched.length) &#123; // pathå½¢å¼ï¼Œä»åŒ¹é…è®°å½•ä¸­æå–å‡ºå½“å‰pathå¹¶å¡«å……å‚æ•° const rawPath = current.matched[current.matched.length - 1].path next.path = fillParams(rawPath, params, `path $&#123;current.path&#125;`) &#125; else if (process.env.NODE_ENV !== 'production') &#123; warn(false, `relative params navigation requires a current route.`) &#125; return next &#125; // å¤„ç†pathå½¢å¼è·³è½¬ï¼Œä¾‹å¦‚&#123;path:'/test',query:&#123;test:3&#125;&#125; // è§£æpath const parsedPath = parsePath(next.path || '') const basePath = (current &amp;&amp; current.path) || '/' const path = parsedPath.path ? resolvePath(parsedPath.path, basePath, append || next.append) : basePath // è§£æquery const query = resolveQuery( parsedPath.query, next.query, // é¢å¤–éœ€è¦è¿½åŠ çš„qs router &amp;&amp; router.options.parseQuery // æ”¯æŒä¼ å…¥è‡ªå®šä¹‰è§£æqueryçš„æ–¹æ³• ) // è§£æhash let hash = next.hash || parsedPath.hash if (hash &amp;&amp; hash.charAt(0) !== '#') &#123; hash = `#$&#123;hash&#125;` &#125; return &#123; _normalized: true, // æ ‡è¯†å·²ç»æ ¼å¼åŒ–è¿‡ path, query, hash, &#125;&#125; é¦–å…ˆå°†stringç±»å‹çš„è½¬æ¢ä¸ºå¯¹è±¡å½¢å¼ï¼Œæ–¹ä¾¿åé¢ç»Ÿä¸€å¤„ç† å¦‚æœå‘ç°åœ°å€å·²ç»åšè¿‡æ ¼å¼åŒ–å¤„ç†ï¼Œåˆ™ç›´æ¥è¿”å› å†åˆ¤æ–­æ˜¯å¦æ˜¯å‘½åè·¯ç”± è‹¥æ˜¯ï¼Œåˆ™æ‹·è´åŸå§‹åœ°å€rawï¼Œæ‹·è´paramsï¼Œç›´æ¥è¿”å› å¤„ç†äº†ä»…æºå¸¦å‚æ•°çš„ç›¸å¯¹è·¯ç”±(ç›¸å¯¹å‚æ•°)è·³è½¬ï¼Œå°±æ˜¯this.$router.push({params:{id:1}})å½¢å¼ å¯¹è¿™ç§åœ°å€çš„å®šä¹‰æ˜¯æ²¡æœ‰pathã€ä»…æœ‰paramså¹¶ä¸”å½“å‰è·¯ç”±å¯¹è±¡å­˜åœ¨ ä¸»è¦å¤„ç†é€»è¾‘æ˜¯ å…ˆåˆå¹¶params è‹¥æ˜¯å‘½åè·¯ç”±ï¼Œåˆ™ä½¿ç”¨current.nameåšä¸ºnext.nameï¼Œå¹¶èµ‹å€¼params éå‘½åè·¯ç”±ï¼Œä»å½“å‰è·¯ç”±å¯¹è±¡ä¸­æ‰¾åˆ°åŒ¹é…çš„è·¯ç”±è®°å½•ï¼Œå¹¶å–å‡ºè·¯ç”±è®°å½•ä¸Šçš„pathåšä¸ºnext.pathï¼Œç„¶åå¡«å……params è¿”å›å¤„ç†å¥½çš„åœ°å€ ç”±äºè¿™ä¸­è·³è½¬æ–¹å¼ï¼Œä»…æœ‰paramsï¼Œæ‰€ä»¥å¿…é¡»ä»å½“å‰è·¯ç”±å¯¹è±¡currentä¸Šè·å–å¯ç”¨å­—æ®µ(pathã€name)ï¼Œåšä¸ºè‡ªèº«å€¼ï¼Œç„¶åè·³è½¬ å¤„ç†é€šè¿‡pathè·³è½¬çš„æ–¹å¼ è°ƒç”¨parsePathä»pathä¸­è§£æå‡ºpathã€queryã€hash ç„¶åä»¥current.pathä¸ºbasePathï¼Œè§£æ(resolve)å‡ºæœ€ç»ˆpath å¯¹queryè¿›è¡Œåˆå¹¶æ“ä½œ å¯¹hashè¿›è¡Œå‰è¿½åŠ #æ“ä½œ è¿”å›å¸¦æœ‰_normalized:trueæ ‡è¯†çš„Locationå¯¹è±¡ ç»è¿‡ä¸Šé¢ä¸€ç•ªå¤„ç†ï¼Œæ— è®ºä¼ å…¥ä½•ç§åœ°å€ï¼Œéƒ½è¿”å›ä¸€ä¸ªå¸¦æœ‰_normalized:trueæ ‡è¯†çš„Locationç±»å‹çš„å¯¹è±¡ normalize-location.png åœ°å€æ˜¯å¦åŒ¹é…åˆ¤æ–­ matchRoute æˆ‘ä»¬çŸ¥é“VueRouteræ˜¯æ”¯æŒåŠ¨æ€è·¯ç”±åŒ¹é…çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º dynamic-route.png æˆ‘ä»¬åœ¨ä¸Šç¯‡çš„ç”Ÿæˆè·¯ç”±è®°å½•ç« èŠ‚ä¹Ÿä»‹ç»è¿‡ï¼ŒVueRouteråœ¨ç”Ÿæˆè·¯ç”±è®°å½•æ—¶ï¼Œä¼šé€šè¿‡path-to-regexpåŒ…ç”Ÿæˆä¸€ä¸ªæ­£åˆ™æ‰©å±•å¯¹è±¡å¹¶èµ‹å€¼åˆ°è·¯ç”±è®°å½•çš„regexå­—æ®µä¸Šï¼Œç”¨äºåç»­çš„åŠ¨æ€è·¯ç”±å‚æ•°çš„è·å– ä¸»è¦çš„é€»è¾‘æ˜¯æä¾›ä¸€ä¸ªåŠ¨æ€è·¯ç”±user/:idå’Œä¸€ä¸ªåœ°å€/user/345ï¼Œé€šè¿‡path-to-regexpå°±èƒ½ç”Ÿæˆä¸€ä¸ªå¯¹è±¡{id:345}æ¥è¡¨è¾¾å‚æ•°çš„æ˜ å°„å…³ç³» æ˜¯ä¸€ä¸ªå€ŸåŠ©åŠ¨æ€è·¯ç”±ï¼Œä» url ä¸Šæå–å‚æ•°çš„è¿‡ç¨‹ï¼›/user/345-&gt;{id:345} å…·ä½“ä¾‹å­å¯æŸ¥çœ‹ç”Ÿæˆè·¯ç”±è®°å½•ç« èŠ‚ ä¸Šè¿°æå–å‚æ•°çš„é€»è¾‘æ˜¯åœ¨matchRouteå®ç°çš„ matchRouteä½äºsrc/create-matcher.js 12345678910111213141516171819202122232425// src/create-matcher.js// æ£€æŸ¥pathæ˜¯å¦èƒ½é€šè¿‡regexçš„åŒ¹é…ï¼Œå¹¶å¯¹paramså¯¹è±¡æ­£ç¡®èµ‹å€¼function matchRoute(regex: RouteRegExp, path: string, params: Object): boolean &#123; const m = path.match(regex) if (!m) &#123; // æ— æ³•åŒ¹é…ä¸Š return false &#125; else if (!params) &#123; // ç¬¦åˆæ­£åˆ™ &amp;&amp; paramsä¸å­˜åœ¨ï¼Œåˆ™è¡¨ç¤ºå¯ä»¥åŒ¹é… return true &#125; // ç¬¦åˆæ­£åˆ™ &amp;&amp; paramså­˜åœ¨ï¼Œéœ€è¦å¯¹paramsè¿›è¡Œæ­£ç¡®èµ‹å€¼ // path-to-regexpä¼šå°†æ¯ä¸ªåŠ¨æ€è·¯ç”±æ ‡è®°å¤„å¤„ç†æˆæ­£åˆ™çš„ä¸€ä¸ªç»„ï¼Œæ‰€ä»¥iä»1å¼€å§‹ // å‚è€ƒhttps://www.npmjs.com/package/path-to-regexp // const keys = []; // const regexp = pathToRegexp("/foo/:bar", keys); // regexp = /^\/foo\/([^\/]+?)\/?$/i // :barå°±è¢«å¤„ç†æˆæ­£åˆ™çš„ä¸€ä¸ªç»„äº† // keys = [&#123; name: 'bar', prefix: '/', suffix: '', pattern: '[^\\/#\\?]+?', modifier: '' &#125;] for (let i = 1, len = m.length; i &lt; len; ++i) &#123; const key = regex.keys[i - 1] // regex.keysè¿”å›åŒ¹é…åˆ°çš„ const val = typeof m[i] === 'string' ? decodeURIComponent(m[i]) : m[i] if (key) &#123; // Fix #1994: using * with props: true generates a param named 0 params[key.name || 'pathMatch'] = val &#125; &#125; return truee&#125; é€šè¿‡æ–¹æ³•ç­¾åï¼Œå¯ä»¥çŸ¥é“å®ƒè¿”å›ä¸€ä¸ªbooleanå€¼ï¼Œè¿™ä¸ªå€¼ä»£è¡¨ä¼ å…¥çš„pathæ˜¯å¦èƒ½é€šè¿‡regexçš„åŒ¹é…ï¼›è™½ç„¶è¿”å›ä¸€ä¸ªbooleanå€¼ï¼Œä½†æ˜¯å…¶å†…éƒ¨è¿˜åšäº†ä»¶å¾ˆé‡è¦çš„äº‹ï¼Œä»pathä¸Šæå–åŠ¨æ€è·¯ç”±å‚æ•°å€¼ï¼Œæˆ‘ä»¬çœ‹ä¸‹å®Œæ•´é€»è¾‘ é¦–å…ˆè°ƒç”¨path.match(regex) ä¸èƒ½åŒ¹é…ç›´æ¥è¿”å›false å¯ä»¥åŒ¹é…ä¸”æ— paramsï¼Œè¿”å›true å‰©ä¸‹çš„å°±åªæœ‰ä¸€ç§æƒ…å†µï¼Œå¯ä»¥åŒ¹é…ä¸”paramså­˜åœ¨ï¼Œæ­¤æ—¶éœ€è¦å¯¹paramsè¿›è¡Œæ­£ç¡®èµ‹å€¼ æ•´ä¸ªèµ‹å€¼ï¼Œä¸»è¦æ˜¯éå†path.match(regex)è¿”å›å€¼å¹¶å–å‡ºregexä¸­å­˜å‚¨çš„keyï¼Œç„¶åä¾æ¬¡èµ‹å€¼ï¼Œå…³äºç»†èŠ‚å¯ä»¥å‚è€ƒä¸Šé¢çš„æ³¨é‡Šï¼› å…³äºregexã€path-to-regexpï¼Œå¯ä»¥å‚è€ƒç”Ÿæˆè·¯ç”±è®°å½•ç« èŠ‚å’Œhttps://www.npmjs.com/package/path-to-regexp è¿˜æœ‰ä¸€ä¸ªç‚¹ï¼Œèµ‹å€¼æ—¶çš„pathMatchæ˜¯ä»€ä¹ˆï¼Ÿ è¿™å…¶å®æ˜¯è·Ÿé€šé…ç¬¦å³*æœ‰å…³çš„ VueRouterå…³äºé€šé…ç¬¦çš„ç‰¹æ®Šå¤„ç†å¯ä»¥çœ‹https://router.vuejs.org/zh/guide/essentials/dynamic-matching.html#æ•è·æ‰€æœ‰è·¯ç”±æˆ–-404-not-found-è·¯ç”± å³pathMatchä¼šä»£è¡¨é€šé…ç¬¦åŒ¹é…åˆ°çš„è·¯å¾„ å®˜æ–¹ä¾‹å­å¦‚ä¸‹ 123456789101112131415&#123; // ä¼šåŒ¹é…æ‰€æœ‰è·¯å¾„ path: '*'&#125;&#123; // ä¼šåŒ¹é…ä»¥ `/user-` å¼€å¤´çš„ä»»æ„è·¯å¾„ path: '/user-*'&#125;// ç»™å‡ºä¸€ä¸ªè·¯ç”± &#123; path: '/user-*' &#125;this.$router.push('/user-admin')this.$route.params.pathMatch // 'admin'// ç»™å‡ºä¸€ä¸ªè·¯ç”± &#123; path: '*' &#125;this.$router.push('/non-existing')this.$route.params.pathMatch // '/non-existing' match-route.png å¡«å……å‚æ•° fillParams fillParamså¯ä»¥çœ‹åšæ˜¯matchRouteçš„é€†æ“ä½œï¼Œæ˜¯ä¸€ä¸ªå€ŸåŠ©åŠ¨æ€è·¯å¾„ï¼Œä½¿ç”¨å‚æ•°ç”Ÿæˆ url çš„è¿‡ç¨‹ï¼›å³/user/:id+{id:345}-&gt;/user/345 å¯ä»¥çœ‹ä¸‹å®ƒçš„å®ç° 123456789101112131415161718192021222324252627282930313233343536// src/util/params.js// ç¼“å­˜const regexpCompileCache: &#123; [key: string]: Function&#125; = Object.create(null)// å¡«å……åŠ¨æ€è·¯ç”±å‚æ•°export function fillParams( path: string, params: ?Object, routeMsg: string): string &#123; params = params || &#123;&#125; try &#123; // compileä¸»è¦ç”¨æ¥é€†è§£æï¼Œhttps://www.npmjs.com/package/path-to-regexp#compile-reverse-path-to-regexp const filler = regexpCompileCache[path] || (regexpCompileCache[path] = Regexp.compile(path)) // ä¿®å¤https://github.com/vuejs/vue-router/issues/2505#issuecomment-442353151 // Fix #2505 resolving asterisk routes &#123; name: 'not-found', params: &#123; pathMatch: '/not-found' &#125;&#125; // and fix #3106 so that you can work with location descriptor object having params.pathMatch equal to empty string if (typeof params.pathMatch === 'string') params[0] = params.pathMatch // è¿”å›é€†è§£æåçš„è·¯å¾„ return filler(params, &#123; pretty: true &#125;) &#125; catch (e) &#123; if (process.env.NODE_ENV !== 'production') &#123; // Fix #3072 no warn if `pathMatch` is string warn( typeof params.pathMatch === 'string', `missing param for $&#123;routeMsg&#125;: $&#123;e.message&#125;` ) &#125; return '' &#125; finally &#123; // delete the 0 if it was added delete params[0] &#125;&#125; å¯ä»¥çœ‹åˆ°æ•´ä¸ªé€†è§£æé€»è¾‘æ˜¯å€ŸåŠ©Regexp.compileç»“åˆregexpCompileCacheå®ç°çš„ Regexp.compileæ¥æ”¶ä¸€ä¸ªåŠ¨æ€è·¯ç”±pathï¼Œè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå¯ç”¨è¿™ä¸ªå‡½æ•°åšé€†è§£æï¼› Regexp.compileä¾‹å­å¦‚ä¸‹ 1234// https://www.npmjs.com/package/path-to-regexp#compile-reverse-path-to-regexpconst toPath = compile('/user/:id')toPath(&#123; id: 123 &#125;) //=&gt; "/user/123" å¯ä»¥çœ‹åˆ°é¦–å…ˆå¯¹Regexp.compileè¿”å›çš„å‡½æ•°åšäº†ç¼“å­˜ ç„¶åå°†matchRouteä¸­æ·»åŠ çš„pathMatchèµ‹å€¼ç»™params[0] è°ƒç”¨Regexp.compileè¿”å›å‡½æ•°ï¼Œä»¥paramsä¸ºå…¥å‚ï¼Œé€†è§£æurlå¹¶è¿”å› åˆ é™¤æ·»åŠ çš„params[0] fill-params.png åˆ›å»ºè·¯ç”±å¯¹è±¡_createRoute ä¸Šé¢æ— è®ºæ˜¯normalizeLocationã€matchRouteã€fillParamséƒ½æ˜¯é’ˆå¯¹ä¼ å…¥çš„åœ°å€åšä¸€äº›æ“ä½œï¼› è€Œmatchæ–¹æ³•çš„ä½œç”¨æ˜¯æ‰¾åˆ°ä¸åœ°å€åŒ¹é…çš„è·¯ç”±å¯¹è±¡ï¼Œè€Œè¿™ä¸ªä¸»è¦æ˜¯ç”±_createRouteæ–¹æ³•å®ç° ä»å‘½åä¸Šå¯ä»¥çœ‹å‡ºï¼Œè¿™æ˜¯ä¸ªå†…éƒ¨æ–¹æ³• 123456789101112131415161718//src/create-matcher.js createMatcheræ–¹æ³•å†…function _createRoute( record: ?RouteRecord, location: Location, redirectedFrom?: Location): Route &#123; // è·¯ç”±è®°å½•è¢«æ ‡è®°ä¸ºé‡å®šå‘ if (record &amp;&amp; record.redirect) &#123; return redirect(record, redirectedFrom || location) &#125; // è·¯ç”±è®°å½•è¢«æ ‡è®°ä¸ºåˆ«åè·¯ç”±ï¼Œè§create-route-map.js if (record &amp;&amp; record.matchAs) &#123; return alias(record, location, record.matchAs) &#125; // æ­£å¸¸è·¯ç”±è®°å½• return createRoute(record, location, redirectedFrom, router)&#125; å¯ä»¥çœ‹åˆ°å®ƒæ¥æ”¶ä¸‰ä¸ªå‚æ•° recordç”¨æ¥ç”ŸæˆRouteå¯¹è±¡çš„ç›®æ ‡è·¯ç”±è®°å½• locationç›®æ ‡åœ°å€ redirectedFromé‡å®šå‘çš„æ¥æºåœ°å€ï¼Œè¿™ä¸ªå‚æ•°åªåœ¨å‘ç”Ÿé‡å®šå‘æ—¶æ‰ä¼šæœ‰å€¼ æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨æ–°å¢è·¯ç”±è®°å½•æ—¶ï¼Œä¼šå¯¹ä¸åŒç±»å‹çš„è®°å½•æ·»åŠ ä¸Šä¸åŒçš„æ ‡è®°å­—æ®µ å¦‚ä¸ºé‡å®šå‘è·¯æœ‰è®°å½•æ·»åŠ redirectå­—æ®µ ä¸ºåˆ«åè·¯ç”±æ·»åŠ matchAså­—æ®µ å…·ä½“å¯çœ‹å‰é¢çš„ç”Ÿæˆè·¯ç”±è®°å½•ç« èŠ‚ å¯ä»¥çœ‹åˆ°é’ˆå¯¹ä¸åŒçš„è·¯ç”±è®°å½•ç±»å‹è°ƒç”¨äº†ä¸åŒæ–¹æ³• é‡å®šå‘è·¯ç”±è°ƒç”¨redirectæ–¹æ³• åˆ«åè·¯ç”±è°ƒç”¨aliasæ–¹æ³• å…¶ä½™çš„è°ƒç”¨createRouteæ–¹æ³• æ´»åŠ¨å›¾å¦‚ä¸‹ create-route-inner.png å…¶å®redirectã€aliasæ–¹æ³•å†…éƒ¨ä¹Ÿè°ƒç”¨äº†createRouteæ–¹æ³• æ‰€ä»¥æˆ‘ä»¬å…ˆçœ‹createRouteæ–¹æ³•å®ç° createRoute createRouteä½äºsrc/util/route.js 123456789101112131415161718192021222324252627282930313233// src/util/route.js// ç”ŸæˆRouteexport function createRoute( record: ?RouteRecord, location: Location, redirectedFrom?: ?Location, router?: VueRouter): Route &#123; const stringifyQuery = router &amp;&amp; router.options.stringifyQuery // æ”¯æŒä¼ å…¥è‡ªå®šä¹‰åºåˆ—åŒ–qsæ–¹æ³• let query: any = location.query || &#123;&#125; try &#123; query = clone(query) // location.queryä¸ºå¼•ç”¨å€¼ï¼Œé¿å…ç›¸äº’å½±å“ï¼Œè¿›è¡Œæ·±æ‹·è´ &#125; catch (e) &#123;&#125; // ç”ŸæˆRoute const route: Route = &#123; name: location.name || (record &amp;&amp; record.name), meta: (record &amp;&amp; record.meta) || &#123;&#125;, path: location.path || '/', hash: location.hash || '', query, params: location.params || &#123;&#125;, fullPath: getFullPath(location, stringifyQuery), // å®Œæ•´path matched: record ? formatMatch(record) : [], // è·å–æ‰€æœ‰åŒ¹é…çš„è·¯ç”±è®°å½• &#125; // å¦‚æœæ˜¯ä»å…¶å®ƒè·¯ç”±å¯¹é‡å®šå‘è¿‡æ¥çš„ï¼Œåˆ™éœ€è¦è®°å½•é‡å®šå‘ä¹‹å‰çš„åœ°å€ if (redirectedFrom) &#123; route.redirectedFrom = getFullPath(redirectedFrom, stringifyQuery) &#125; // é˜²æ­¢ç¯¡æ”¹ return Object.freeze(route)&#125; ç”±äºVueRouteræ”¯æŒä¼ å…¥è‡ªå®šä¹‰åºåˆ—åŒ–queryStringæ–¹æ³•ï¼Œæ‰€ä»¥ç¬¬ä¸€æ­¥å…ˆè·å–åºåˆ—åŒ–queryStringçš„æ–¹æ³• ç„¶åå¯¹queryåšäº†ä¸€ä¸ªæ·±æ‹·è´ï¼Œé¿å…ç›¸äº’å½±å“ æ¥ä¸‹æ¥å°±æ˜¯ç”Ÿæˆæ–°Route å¯¹è±¡ å¦‚æœæ˜¯ä»å…¶ä»–è·¯ç”±é‡å®šå‘è¿‡æ¥çš„ï¼Œåˆ™ç”Ÿæˆå®Œæ•´çš„é‡å®šå‘æ¥æºåœ°å€ï¼Œå¹¶èµ‹å€¼ç»™æ–°ç”Ÿæˆçš„Routeå¯¹è±¡ æœ€åè°ƒç”¨Object.freezeå†»ç»“æ–°Route å¯¹è±¡ï¼Œå› ä¸ºRouteå¯¹è±¡æ˜¯immutableçš„ æ•´ä¸ªæµç¨‹å¦‚ä¸‹ create-route.png å¯ä»¥çœ‹åˆ°ç”ŸæˆRouteæ—¶ï¼Œä¼šè°ƒç”¨getFullPathç”Ÿæˆå®Œæ•´fullPath 1234567// src/util/route.js// è·å–å®Œæ•´pathfunction getFullPath(&#123; path, query = &#123;&#125;, hash = '' &#125;, _stringifyQuery): string &#123; const stringify = _stringifyQuery || stringifyQuery return (path || '/') + stringify(query) + hash&#125; å¯ä»¥çœ‹åˆ°getFullPathæ˜¯åœ¨pathåé¢è¿½åŠ äº†qså’Œhash å¦å¤–ç”ŸæˆRouteæ—¶ï¼Œè¿˜ä¼šè°ƒç”¨formatMatchæ¥è·å–æ‰€æœ‰å…³è”çš„è·¯ç”±è®°å½• ä¸»è¦é€šè¿‡å‘ä¸ŠæŸ¥æ‰¾çš„å½¢å¼æ‰¾åˆ°æ‰€æœ‰å…³è”çš„è·¯ç”±è®°å½• 123456789101112// src/util/route.js// æ ¼å¼åŒ–åŒ¹é…çš„è·¯ç”±è®°å½•ï¼Œå½“ä¸€ä¸ªè·¯ç”±è®°å½•åŒ¹é…äº†ï¼Œå¦‚æœå…¶è¿˜æœ‰çˆ¶è·¯ç”±è®°å½•ï¼Œåˆ™çˆ¶è·¯ç”±è®°å½•è‚¯å®šä¹Ÿæ˜¯åŒ¹é…çš„// /foo/bar åŒ¹é…äº†ï¼Œåˆ™å…¶çˆ¶è·¯ç”±å¯¹è±¡ /foo è‚¯å®šä¹ŸåŒ¹é…äº†function formatMatch(record: ?RouteRecord): Array&lt;RouteRecord&gt; &#123; const res = [] while (record) &#123; res.unshift(record) // é˜Ÿåˆ—å¤´æ·»åŠ ï¼Œæ‰€ä»¥çˆ¶recordæ°¸è¿œåœ¨å‰é¢ï¼Œå½“å‰recordæ°¸è¿œåœ¨æœ€åï¼›åœ¨router-viewç»„ä»¶ä¸­è·å–åŒ¹é…çš„route recordæ—¶ä¼šç”¨åˆ° record = record.parent &#125; return res&#125; éš¾é“ä¸€æ¡Routeä¸æ˜¯å¯¹åº”(å…³è”)ä¸€ä¸ªè·¯ç”±å¯¹è±¡å—ï¼Ÿ å…¶å®åœ¨æœ¯è¯­è¡¨ä»‹ç»Routeè·¯ç”±å¯¹è±¡æ—¶ï¼Œä¹Ÿæœ‰æ‰€æåŠï¼Œä¸€ä¸ªRouteè·¯ç”±å¯¹è±¡å¯èƒ½ä¼šå…³è”å¤šä¸ªRouteRecordè·¯ç”±è®°å½•å¯¹è±¡ è¿™æ˜¯å› ä¸ºå­˜åœ¨åµŒå¥—è·¯ç”±çš„æƒ…å†µï¼Œå½“å­è·¯ç”±è®°å½•è¢«åŒ¹é…åˆ°æ—¶ï¼Œå…¶å®ä»£è¡¨ç€çˆ¶è·¯ç”±è®°å½•ä¹Ÿä¸€å®šè¢«åŒ¹é…åˆ°äº†ï¼Œçœ‹ä¸‹é¢ä¾‹å­ 12345678// å½“æœ‰ä¸‹é¢çš„è·¯ç”±è§„åˆ™routes: [ &#123; path: '/parent', component: Parent, children: [&#123; path: 'foo', component: Foo &#125;], &#125;,] è®¿é—®/parent/fooæ—¶ï¼ŒåŒ¹é…åˆ°çš„è·¯ç”±è®°å½•æœ‰ä¸¤ä¸ª match-demo-record.png è€Œä¸”ç²¾å‡†åŒ¹é…åˆ°è·¯ç”±è®°å½•ä¸€å®šæ˜¯æœ€åä¸€ä¸ªï¼Œæ‰€ä»¥åé¢ä¼šçœ‹åˆ°ç”¨route.matched[route.matched.length - 1]æ¥è·å–å½“å‰routeå¯¹åº”çš„ç²¾å‡†åŒ¹é…çš„RouteRecord çœ‹å®ŒcreateRouteçš„å®ç°ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹aliasçš„å®ç° åˆ›å»ºåˆ«åè·¯ç”±å¯¹è±¡ alias aliasä½äºsrc/create-matcher.js 12345678910111213141516171819202122232425262728// src/create-matcher.js// åˆ›å»ºåˆ«åRoutefunction alias( record: RouteRecord, location: Location, matchAs: string): Route &#123; // è·å–åˆ«åçš„å®Œæ•´è·¯å¾„ const aliasedPath = fillParams( matchAs, location.params, `aliased route with path "$&#123;matchAs&#125;"` ) // è·å–åˆ«ååŒ¹é…çš„åŸå§‹Route const aliasedMatch = match(&#123; _normalized: true, path: aliasedPath, &#125;) if (aliasedMatch) &#123; const matched = aliasedMatch.matched const aliasedRecord = matched[matched.length - 1] // æ‰¾åˆ°æ‰€æœ‰åŒ¹é…çš„è·¯ç”±è®°å½•çš„æœ€åä¸€ä¸ªï¼Œå³å½“å‰åŒ¹é…çš„è·¯ç”±è®°å½•ï¼Œé€»è¾‘è§route.js formatMatchæ–¹æ³• location.params = aliasedMatch.params return _createRoute(aliasedRecord, location) &#125; return _createRoute(null, location)&#125; é€»è¾‘å¦‚ä¸‹ å…ˆæ‹¿matchAså¾—åˆ°aliasedPathï¼Œ ç„¶åæ‹¿aliasedPathèµ°ä¸€ématchå¾—åˆ°aliasedMatchè·¯ç”±å¯¹è±¡ aliasedMatchå¦‚æœå­˜åœ¨ï¼Œæ‹¿aliasedMatchç²¾å‡†åŒ¹é…çš„è·¯ç”±è®°å½•å¯¹è±¡å’Œlocationï¼Œç”Ÿæˆè·¯ç”±å¯¹è±¡è¿”å› ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„è·¯ç”±å¯¹è±¡è¿”å› å¯èƒ½æœ‰ç‚¹ç»•ï¼Œæˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ å‰é¢æˆ‘ä»¬çŸ¥é“ï¼Œ/aè®¾ç½®äº†åˆ«å/bæ—¶ï¼Œä¼šç”Ÿæˆä¸¤æ¡è·¯ç”±è®°å½•ï¼Œä¸”/bçš„è·¯ç”±è®°å½•ä¸Šçš„matchAsä¸º/a å¿˜è®°çš„å¯ä»¥çœ‹å‰é¢çš„ç”Ÿæˆåˆ«åè·¯ç”±è®°å½•ç« èŠ‚ æ­¤å¤„ä¼ å…¥çš„aliasçš„matchAså°±ç›¸å½“äº/aï¼Œå…ˆæ‹¿matchAså³/aå¾—åˆ°å¡«å……è¿‡paramsçš„è·¯å¾„ å†ä»¥æ­¤è·¯å¾„è°ƒç”¨matchæ‰¾åˆ°åŒ¹é…çš„è·¯ç”±å¯¹è±¡ï¼Œè®°ä¸ºrouteA å‰é¢ä¹Ÿæè¿‡ï¼Œè·¯ç”±å¯¹è±¡ä¼šå…³è”è·¯ç”±è®°å½•ï¼Œæ‰€ä»¥ä»routeAä¸­å¯ä»¥å¾—åˆ°ç²¾å‡†åŒ¹é…çš„è·¯ç”±è®°å½•routeRecordA æ‹¿æ­¤è·¯ç”±è®°å½•å’Œ/bçš„locationå»ç”Ÿæˆè·¯ç”±å¯¹è±¡å¹¶è¿”å› è¿™æ ·å°±å®ç°äº†å®˜ç½‘ä¸Šè¯´çš„/a çš„åˆ«åæ˜¯ /bï¼Œæ„å‘³ç€ï¼Œå½“ç”¨æˆ·è®¿é—® /b æ—¶ï¼ŒURL ä¼šä¿æŒä¸º /bï¼Œä½†æ˜¯è·¯ç”±åŒ¹é…åˆ™ä¸º /aï¼Œå°±åƒç”¨æˆ·è®¿é—® /a ä¸€æ ·ã€‚æ•ˆæœ æ´»åŠ¨å›¾å¦‚ä¸‹ alias.png æˆ‘ä»¬å†æ¥çœ‹çœ‹redirectçš„å®ç° åˆ›å»ºé‡å®šå‘è·¯ç”±å¯¹è±¡ redirect æˆ‘ä»¬å…ˆçœ‹ä¸‹record.redirectå¯èƒ½çš„å‡ ç§æƒ…å†µï¼›https://router.vuejs.org/zh/guide/essentials/redirect-and-alias.html#é‡å®šå‘ å­—ç¬¦ä¸²{redirect:&#39;/&#39;} å¯¹è±¡{redirect:{path:&#39;/test&#39;}}ã€{redirect:{name:&#39;Test&#39;}} ä¹Ÿæ”¯æŒä¼ å…¥å‡½æ•°{redirect:to=&gt;{ return {name:&#39;Test&#39;}}} æˆ‘ä»¬å…ˆçœ‹è¿™ä¸ªredirectæ–¹æ³•çš„å…¥å£ 12345// src/create-matcher.js _createRouteæ–¹æ³•å†…éƒ¨if (record &amp;&amp; record.redirect) &#123; return redirect(record, redirectedFrom || location)&#125; ç”±äºå­˜åœ¨å¤šæ¬¡é‡å®šå‘çš„åœºæ™¯ï¼Œæ‰€ä»¥éœ€è¦ä¿ç•™é¦–æ¬¡è§¦å‘é‡å®šå‘çš„åœ°å€å³redirectedFrom /a -&gt; /b -&gt; /cï¼Œåœ¨/cä¸­éœ€è¦ä¿ç•™é¦–æ¬¡è§¦å‘é‡å®šå‘çš„åœ°å€å³/a å¤šæ¬¡é‡å®šå‘ï¼Œå¦‚ä½•ä¿ç•™é¦–æ¬¡è§¦å‘é‡å®šå‘çš„åœ°å€å‘¢ï¼Ÿ åœ¨ç¬¬ä¸€æ¬¡é‡å®šå‘æ—¶ï¼ŒredirectedFromæ²¡æœ‰å€¼ åœ¨redirectæ–¹æ³•å†…éƒ¨ä¼šå°†locationåšä¸ºredirectedFromå‚æ•°è°ƒç”¨matchæ–¹æ³•ï¼Œmatchå¦‚æœå‘ç°ä»ç„¶éœ€è¦é‡å®šå‘ï¼Œåˆ™ä¼šç»§ç»­è°ƒç”¨redirectï¼Œæ­¤æ—¶redirectedFromæ˜¯æœ‰å€¼çš„ï¼Œå°±æ˜¯é¦–æ¬¡ä¼ å…¥çš„locationï¼Œä¾æ¬¡å¾ªç¯ï¼Œè¿™æ ·å°±å®Œæˆäº†åˆå§‹åœ°å€çš„ä¼ é€’ å¯ä»¥çœ‹ä¸‹ä¸‹é¢çš„ä¾‹å­ 123456789101112;[ &#123; path: '/foo', component: Foo &#125;, &#123; path: '/baz', component: Baz, redirect: '/foo' &#125;, // named redirect &#123; path: '/named-redirect', redirect: '/baz' &#125;,]// src/create-matcher.js _createRouteæ–¹æ³•å†…éƒ¨if (record &amp;&amp; record.redirect) &#123; console.count('redirect count:') // ç»Ÿè®¡è°ƒç”¨æ¬¡æ•° console.log('record:', record, 'redirectedFrom:', redirectedFrom) // æ‰“å°é‡å®šå‘åˆå§‹æ¥æºåœ°å€ return redirect(record, redirectedFrom || location)&#125; å½“æˆ‘ä»¬è®¿é—®/named-redirectè·¯ç”±æ—¶(è§¦å‘è·¯ç”±è·³è½¬)ï¼Œä¼šé‡å®šå‘åˆ°/bazï¼Œ/bazåˆä¼šé‡å®šå‘åˆ°/fooï¼Œæœ€ç»ˆå±•ç¤ºFooç»„ä»¶ï¼›æ‰€ä»¥ï¼Œredirectæ–¹æ³•åº”è¯¥ä¼šè¢«è°ƒç”¨ä¸¤æ¬¡ï¼› æˆ‘ä»¬å¯ä»¥çœ‹ä¸‹ä¸Šé¢ä¾‹å­çš„è¾“å‡º redirect-demo.png ä¼šå‘ç°redirectæ–¹æ³•è¢«è°ƒç”¨äº†å››æ¬¡ï¼Œå‰ä¸¤æ¬¡æ˜¯è·¯ç”±è·³è½¬å¯¼è‡´çš„redirectè°ƒç”¨ï¼Œåä¸¤æ¬¡åˆ™æ˜¯ç»„ä»¶æ¸²æŸ“æ—¶ï¼Œéœ€è¦è§£æè·¯ç”±ä»è€Œè§¦å‘çš„redirectè°ƒç”¨ï¼› å¯ä»¥å¯¹æ¯”ä¸‹è°ƒç”¨æ ˆ redirect-stack-1.png redirect-stack-2.png å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ã€ç¬¬äºŒæ¬¡çš„redirectæ˜¯ç”±transitionToè§¦å‘çš„ redirect-stack-3.png redirect-stack-4.png è€Œç¬¬ä¸‰ã€ç¬¬å››æ¬¡éƒ½æ˜¯ç»„ä»¶æ¸²æŸ“renderè°ƒç”¨resolveè§¦å‘çš„ ä¸ºä½•ç»„ä»¶æ¸²æŸ“æ—¶éœ€è¦è§£æè·¯ç”±ï¼Œè¿™ä¸ªæˆ‘ä»¬åœ¨åé¢ç»„ä»¶ç›¸å…³ç« èŠ‚è§£é‡Š å¯ä»¥çœ‹åˆ°ç¬¬ä¸€æ¬¡è°ƒç”¨redirectæ˜¯ä»/named-redirecté‡å®šå‘åˆ°/bazï¼Œæ­¤æ—¶redirectFromæ˜¯æ²¡æœ‰å€¼çš„ è€Œç¬¬äºŒæ¬¡è°ƒç”¨æ˜¯ä»/bazé‡å®šå‘åˆ°/fooï¼Œæ­¤æ—¶redirectFromå°±æ˜¯è§¦å‘ç¬¬ä¸€æ¬¡é‡å®šå‘çš„åœ°å€/named-redirect è€Œä¸”æœ€ç»ˆçš„$routeä¸Šä¹Ÿä¼šæœ‰ä¸ªredirectFromä¿ç•™äº†è§¦å‘ç¬¬ä¸€æ¬¡é‡å®šå‘çš„åœ°å€ ä¸Šé¢æˆ‘ä»¬åªæ˜¯çœ‹äº†redirectFromçš„æ„ä¹‰ï¼Œä¸‹é¢æˆ‘ä»¬çœ‹çœ‹redirectçš„å…·ä½“å®ç° 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576// src/create-matcher.js createMatcheræ–¹æ³•å†…// åˆ›å»ºé‡å®šå‘Routefunction redirect( record: RouteRecord, // è§¦å‘é‡å®šå‘çš„è·¯ç”±è®°å½•(éœ€è¦è¿›è¡Œé‡å®šå‘çš„è·¯ç”±è®°å½•ï¼ŒåŒ…å«redirect) location: Location // è§¦å‘é‡å®šå‘çš„åˆå§‹åœ°å€()): Route &#123; const originalRedirect = record.redirect let redirect = typeof originalRedirect === 'function' // redirectæ”¯æŒä¼ å…¥å‡½æ•°;https://router.vuejs.org/zh/guide/essentials/redirect-and-alias.html#é‡å®šå‘ ? originalRedirect(createRoute(record, location, null, router)) : originalRedirect // redirectè¿”å›çš„æ˜¯ä¸€ä¸ªè·¯å¾„pathï¼Œå¦‚'/bar' if (typeof redirect === 'string') &#123; redirect = &#123; path: redirect &#125; &#125; // originalRedirectå‡½æ•°è¿”å›ä¸€ä¸ªéstringã€éobjectçš„å€¼æ—¶ï¼Œç»™äºˆè­¦å‘Šï¼Œå¹¶åˆ›å»ºä¸€ä¸ªç©ºRoute if (!redirect || typeof redirect !== 'object') &#123; if (process.env.NODE_ENV !== 'production') &#123; warn(false, `invalid redirect option: $&#123;JSON.stringify(redirect)&#125;`) &#125; return _createRoute(null, location) &#125; // åˆ°è¿™ä¸€æ­¥ï¼Œredirectä¸€å®šæ˜¯ä¸ªobject const re: Object = redirect const &#123; name, path &#125; = re let &#123; query, hash, params &#125; = location query = re.hasOwnProperty('query') ? re.query : query hash = re.hasOwnProperty('hash') ? re.hash : hash params = re.hasOwnProperty('params') ? re.params : params // é‡å®šå‘æ˜¯å‘½åè·¯ç”±å½¢å¼ if (name) &#123; // resolved named direct const targetRecord = nameMap[name] // æœªæ‰¾åˆ°å‘½åè·¯ç”±è­¦å‘Š if (process.env.NODE_ENV !== 'production') &#123; assert(targetRecord, `redirect failed: named route "$&#123;name&#125;" not found.`) &#125; return match( &#123; _normalized: true, name, query, hash, params, &#125;, undefined, location ) &#125; else if (path) &#123; // é‡å®šå‘æ˜¯pathå½¢å¼ // 1. resolve relative redirectï¼Œè§£æå‡ºå®Œæ•´è·¯å¾„ const rawPath = resolveRecordPath(path, record) // 2. resolve paramsï¼Œå¡«å……params const resolvedPath = fillParams( rawPath, params, `redirect route with path "$&#123;rawPath&#125;"` ) // 3. rematch with existing query and hashï¼Œé‡æ–°åŒ¹é… return match( &#123; _normalized: true, path: resolvedPath, query, hash, &#125;, undefined, location ) &#125; else &#123; if (process.env.NODE_ENV !== 'production') &#123; warn(false, `invalid redirect option: $&#123;JSON.stringify(redirect)&#125;`) &#125; return _createRoute(null, location) &#125;&#125; å¯ä»¥çœ‹åˆ°é¦–å…ˆå¯¹record.redirectè¿›è¡Œè§„èŒƒåŒ–ï¼Œç»Ÿä¸€ç”Ÿæˆä¸€ä¸ªredirectå¯¹è±¡(é‡å®šå‘ç›®æ ‡) ä¸ºä»€ä¹ˆè¦è¿›è¡Œè§„èŒƒåŒ–ï¼Œå‰é¢ä¹Ÿæè¿‡ï¼Œredirectæ”¯æŒå­—ç¬¦ä¸²ã€å¯¹è±¡ã€å‡½æ•°ç±»å‹ï¼Œæ‰€ä»¥éœ€è¦è§„èŒƒåŒ–ï¼Œæ–¹ä¾¿åé¢ç»Ÿä¸€å¤„ç† æ¥ä¸‹æ¥ä¼šä¼˜å…ˆå–redirectçš„query hash paramså€¼æ¥åšmatchï¼Œä¸å­˜åœ¨æ—¶æ‰ä¼šå–åˆå§‹åœ°å€locationçš„query hash params æ¥ä¸‹æ¥ä¼šåˆ¤æ–­é‡å®šå‘ç›®æ ‡æ˜¯å‘½åå½¢å¼è¿˜æ˜¯pathå½¢å¼ å‘½åå½¢å¼ å…ˆåˆ¤æ–­nameMapä¸­æœ‰æ²¡æœ‰ç›®æ ‡è·¯ç”±è®°å½•ï¼Œæ²¡æœ‰åˆ™ä¸­æ–­ï¼Œå¹¶ç»™äºˆæç¤ºï¼› å†é‡èµ°matchæµç¨‹ï¼Œå¹¶å°†locationåšä¸ºredirectedFromä¼ å…¥ï¼Œè¿™æ ·å°±å®Œæˆäº†redirectedFromçš„ä¼ é€’é—­ç¯ matché‡Œé¢ä¼šç»§ç»­åˆ¤æ–­æ˜¯å¦æœ‰é‡å®šå‘ï¼Œè¿™æ ·å°±è¦†ç›–äº†å¤šé‡é‡å®šå‘çš„åœºæ™¯ path å½¢å¼ æ‹¿pathåŒ¹é…ï¼Œéœ€è¦è·å–å®Œæ•´è·¯å¾„ï¼Œæ‰€ä»¥å…ˆä»recordæ‹¿å‡ºåŸå§‹è·¯å¾„rawPathå¹¶å¡«å……å‰é¢è§£æå‡ºçš„paramså¾—å‡ºå®Œæ•´åœ°å€ å†æ‹¿å®Œæ•´åœ°å€é‡èµ°matchæµç¨‹ï¼ŒåŒæ—¶ä¹Ÿå°†locationåšä¸ºredirectedFromä¼ å…¥ï¼Œå®ŒæˆredirectedFromçš„ä¼ é€’é—­ç¯ matché‡Œé¢ä¼šç»§ç»­åˆ¤æ–­æ˜¯å¦æœ‰é‡å®šå‘ï¼Œè¿™æ ·å°±è¦†ç›–äº†å¤šé‡é‡å®šå‘çš„åœºæ™¯ å¦‚æœæ—¢ä¸æ˜¯å‘½åå½¢å¼ä¹Ÿä¸æ˜¯pathå½¢å¼ï¼Œåˆ™ç›´æ¥åˆ›å»ºä¸€ä¸ªæ–°è·¯ç”±å¯¹è±¡è¿”å› æµç¨‹å¦‚ä¸‹ redirect-full.png å°ç»“ è·¯ç”±åŒ¹é…çš„è¿‡ç¨‹ï¼Œå…¶å®å°±æ˜¯æ‹¿åœ°å€RawLocationç”Ÿæˆè·¯ç”±å¯¹è±¡Routeçš„è¿‡ç¨‹ï¼Œè¿™ä¸­é—´è·¯ç”±è®°å½•RouteRecordèµ·ä¸­é—´æ¡¥æ¢çš„ä½œç”¨ï¼Œå› ä¸ºè·¯ç”±è®°å½•ä¸Šä¿å­˜äº†ç”Ÿæˆè·¯ç”±å¯¹è±¡çš„é‡è¦ä¿¡æ¯ï¼›æ‰€ä»¥æµç¨‹åº”è¯¥æ˜¯æ‹¿åœ°å€ä»è·¯ç”±æ˜ å°„è¡¨ä¸­æ‰¾åˆ°å¯¹åº”çš„è·¯ç”±è®°å½•ï¼Œç„¶åæ‹¿è·¯ç”±è®°å½•ç”Ÿæˆè·¯ç”±å¯¹è±¡ ä¸Šè¿°åŒ¹é…é€»è¾‘ä¸»è¦ç”±matchå‡½æ•°å®ç°çš„ï¼Œå…³é”®é€»è¾‘åŒ…å«åœ°å€æ ¼å¼åŒ–normalizeLocationã€åœ°å€æ˜¯å¦åŒ¹é…åˆ¤æ–­matchRouteã€å¡«å……å‚æ•°fillParamsã€åˆ›å»ºè·¯ç”±å¯¹è±¡_createRoute åœ¨normalizeLocationæ—¶ï¼Œä¼šå¯¹rawLocationè¿›è¡Œè§„èŒƒåŒ–ï¼Œæ–¹ä¾¿åç»­å¤„ç† åœ¨matchRouteæ—¶ï¼Œä¼šå€ŸåŠ©path-to-regexpæ£€æµ‹åœ°å€æ˜¯å¦åŒ¹é…å¹¶æå–å‡ºparams fillParamså¯ä»¥çœ‹åšæ˜¯æå–paramsçš„é€†å‘æ“ä½œï¼Œä¸»è¦ç”¨æ¥å¯¹åœ°å€ä¸­çš„åŠ¨æ€éƒ¨åˆ†è¿›è¡Œå¡«å…… åœ¨_createRouteæ—¶ï¼Œä¼šåˆ†åˆ«å¤„ç†åˆ«åã€é‡å®šå‘ã€å¤šé‡é‡å®šå‘ç­‰åœºæ™¯ ç»è¿‡ä¸Šè¿°æµç¨‹ï¼Œå°±å¯ä»¥æ‹¿åˆ°RawLocationå¯¹åº”çš„Route æ‹¿åˆ°Routeï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œå¯¼èˆªçš„è§£æ å¯¼èˆªè§£æ(ç¡®è®¤)æµç¨‹ å‰é¢æè¿‡åœ¨transitionToæ–¹æ³•ä¸­ï¼Œè°ƒç”¨å®Œmatchæ–¹æ³•å¾—åˆ°ç›®æ ‡Routeåï¼Œå°±ä¼šè°ƒç”¨confirmTransitionæ–¹æ³•æ¥åšå¯¼èˆªè§£æ æˆ‘ä»¬çŸ¥é“vue-routeråœ¨è·¯ç”±è·³è½¬æ—¶ï¼Œä¼šæŒ‰é¡ºåºè§¦å‘å„ç§é’©å­ã€å®ˆå«å‡½æ•°ï¼Œä¾‹å¦‚beforeRouteLeaveã€beforeRouteEnterç­‰ç­‰ï¼› é¦–å…ˆè¿™äº›é’©å­ã€å®ˆå«æœ‰çš„æ˜¯å®šä¹‰åœ¨vue-routerå®ä¾‹ä¸Šçš„ï¼Œæœ‰çš„æ˜¯è·¯ç”±ç‹¬äº«çš„ï¼Œæœ‰çš„æ˜¯ä½äº.vueç»„ä»¶ä¸­çš„ï¼Œæ‰€ä»¥ç¬¬ä¸€æ­¥å¿…é¡»æŠ½å‡ºè¿™äº›é’©å­ã€å®ˆå«å‡½æ•°ç»Ÿä¸€å¤„ç† å…¶æ¬¡è¿™äº›é’©å­ã€å®ˆå«æ˜¯æŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œçš„ï¼Œæ‰€ä»¥éœ€è¦è®¾è®¡ä¸€ä¸ªé˜Ÿåˆ—å’Œè¿­ä»£å™¨æ¥ä¿è¯é¡ºåºæ‰§è¡Œ æœ€åè¿˜æœ‰ä¸€äº›ç‰¹æ®Šåœºæ™¯éœ€è¦å¤„ç†ï¼Œä¾‹å¦‚å¼‚æ­¥è·¯ç”±ç»„ä»¶å¦‚ä½•ä¿è¯é¡ºåºæ‰§è¡Œ ä¸Šè¿°çš„ç›¸å…³é€»è¾‘å°è£…åœ¨confirmTransitionä¸­ confirmTransitionæ–¹æ³•è¢«å®šä¹‰åœ¨src/base.jsä¸­ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126// src/base.js Historyç±»ä¸­// ç¡®è®¤è·¯ç”±è·³è½¬confirmTransition (/* to*/route: Route, onComplete: Function, onAbort?: Function) &#123; const current = this.current /* from */ // å–æ¶ˆ const abort = err =&gt; &#123; // after merging https://github.com/vuejs/vue-router/pull/2771 we // When the user navigates through history through back/forward buttons // we do not want to throw the error. We only throw it if directly calling // push/replace. That's why it's not included in isError if (!isExtendedError(NavigationDuplicated, err) &amp;&amp; isError(err)) &#123; if (this.errorCbs.length) &#123; this.errorCbs.forEach(cb =&gt; &#123; cb(err) &#125;) &#125; else &#123; warn(false, 'uncaught error during route navigation:') console.error(err) &#125; &#125; onAbort &amp;&amp; onAbort(err) &#125; // ç›¸åŒRouteï¼ŒæŠ¥é‡å¤é”™è¯¯ if ( isSameRoute(route, current) &amp;&amp; // in the case the route map has been dynamically appended to // é˜²æ­¢route map è¢«åŠ¨æ€æ”¹å˜äº† route.matched.length === current.matched.length ) &#123; // ensureURLç”±å­ç±»å®ç°ï¼Œä¸»è¦æ ¹æ®ä¼ å‚ç¡®å®šæ˜¯æ·»åŠ è¿˜æ˜¯æ›¿æ¢ä¸€ä¸ªè®°å½• this.ensureURL() // æ›¿æ¢å½“å‰å†å²è®°å½• return abort(new NavigationDuplicated(route)) &#125; // å¯¹æ¯”å‰årouteçš„RouteRecordï¼Œæ‰¾å‡ºéœ€è¦æ›´æ–°ã€å¤±æ´»ã€æ¿€æ´»çš„çš„è·¯ç”±è®°å½• const &#123; updated, deactivated, activated &#125; = resolveQueue( this.current.matched, route.matched ) // ç”Ÿæˆéœ€è¦æ‰§è¡Œçš„å®ˆå«ã€é’©å­é˜Ÿåˆ— const queue: Array&lt;?NavigationGuard&gt; = [].concat( // in-component leave guards extractLeaveGuards(deactivated), // æå–è·¯ç”±ç»„ä»¶ä¸­æ‰€æœ‰beforeRouteLeaveå®ˆå« // global before hooks this.router.beforeHooks, // å…¨å±€çš„beforeEachå®ˆå« // in-component update hooks extractUpdateHooks(updated), // æå–è·¯ç”±ç»„ä»¶ä¸­æ‰€æœ‰beforeRouteUpdateå®ˆå« // in-config enter guards activated.map(m =&gt; m.beforeEnter), // è·¯ç”±ç‹¬äº«çš„beforeEnterå®ˆå« // async components resolveAsyncComponents(activated)// è§£æå¼‚æ­¥ç»„ä»¶ ) this.pending = route // è®°å½•å°†è¦è·³è½¬çš„routeï¼Œæ–¹ä¾¿å–æ¶ˆå¯¹æ¯”ç”¨ // è¿­ä»£å‡½æ•° const iterator = (hook: NavigationGuard, next) =&gt; &#123; if (this.pending !== route) &#123; // å½“å‘ç°toå‘ç”Ÿå˜åŒ–ï¼Œåˆ™ä»£è¡¨éœ€è¦å–æ¶ˆ return abort() &#125; try &#123; hook(/* to*/route, /* from*/current, /* next*/(to: any) =&gt; &#123; if (to === false || isError(to)) &#123; // next(false) -&gt; abort navigation, ensure current URL // next(false) -&gt; å–æ¶ˆè·³è½¬ï¼Œæ·»åŠ ä¸€ä¸ªæ–°å†å²è®°å½•(ä½†ç”±äºurlåœ°å€æœªå‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥å¹¶æœªæ·»åŠ è®°å½•) this.ensureURL(true) abort(to) &#125; else if ( typeof to === 'string' || // next('/') (typeof to === 'object' &amp;&amp; (typeof to.path === 'string' || typeof to.name === 'string')) // next(&#123;path:'/'&#125;)æˆ–next(&#123;name:'Home'&#125;) ) &#123; // next('/') or next(&#123; path: '/' &#125;) -&gt; redirect abort() // å–æ¶ˆå½“å‰ if (typeof to === 'object' &amp;&amp; to.replace) &#123; // è°ƒç”¨å­ç±»æ–¹æ³•çš„æ›¿æ¢è®°å½• this.replace(to) &#125; else &#123; // è°ƒç”¨å­ç±»æ–¹æ³•çš„æ·»åŠ è®°å½• this.push(to) &#125; &#125; else &#123; // confirm transition and pass on the value // next() next(to) &#125; &#125;) &#125; catch (e) &#123; abort(e) &#125; &#125; // æ‰§è¡Œé˜Ÿåˆ— runQueue(queue, iterator, /* æ‰§è¡Œç»“æŸå›è°ƒ*/() =&gt; &#123; const postEnterCbs = [] // ä¿å­˜beforeRouteEnterä¸­ä¼ ç»™nextçš„å›è°ƒå‡½æ•° const isValid = () =&gt; this.current === route // è¡¨ç¤ºè·³è½¬ç»“æŸ // wait until async components are resolved before // extracting in-component enter guards const enterGuards = extractEnterGuards(activated, postEnterCbs, isValid) // ç­‰å¾…å¼‚æ­¥ç»„ä»¶è§£æå®Œï¼Œå†æŠ½å–ç»„ä»¶å†…çš„beforeRouteEnterå®ˆå« const queue = enterGuards.concat(this.router.resolveHooks)// beforeResolve hooks runQueue(queue, iterator, /* æ‰§è¡Œç»“æŸå›è°ƒ*/() =&gt; &#123; if (this.pending !== route) &#123; return abort() &#125; this.pending = null onComplete(route) // æ‰§è¡ŒonCompleteå›è°ƒï¼ŒonCompleteä¸­ä¼šè°ƒç”¨updateRouteæ–¹æ³•ï¼Œå†…éƒ¨ä¼šè§¦å‘afterEaché’©å­ if (this.router.app) &#123; this.router.app.$nextTick(() =&gt; &#123; // è°ƒç”¨ beforeRouteEnter å®ˆå«ä¸­ä¼ ç»™ next çš„å›è°ƒå‡½æ•° // next(vm=&gt;xxx) postEnterCbs.forEach(cb =&gt; &#123; cb() &#125;) &#125;) &#125; &#125;) &#125;)&#125; æˆ‘ä»¬å¯ä»¥å…ˆçœ‹ä¸‹æ–¹æ³•ç­¾å routeç›®æ ‡è·¯ç”±å¯¹è±¡ï¼Œéœ€è¦è§£æçš„ç›®æ ‡ï¼Œå¯ä»¥ç†è§£ä¸ºè·¯ç”±è·³è½¬æ—¶çš„toå¯¹è±¡ï¼Œè€Œcurrentåˆ™å¯ä»¥ç†è§£ä¸ºfromå¯¹è±¡ã€‚ onCompleteè·³è½¬å®Œæˆçš„å›è°ƒ onAbortå–æ¶ˆã€é”™è¯¯çš„å›è°ƒ çœ‹ä¸‹ä¸»è¦é€»è¾‘ é¦–å…ˆå¤„ç†äº†é‡å¤è·³è½¬çš„é—®é¢˜ ç„¶åé€šè¿‡å¯¹æ¯”æ‰¾å‡ºéœ€è¦æ›´æ–°ã€å¤±æ´»ã€æ¿€æ´»çš„è·¯ç”±è®°å½• ä»ä¸Šè¿°ä¸‰ç§è·¯ç”±è®°å½•ä¸­æŠ½å–å‡ºå¯¹åº”é’©å­ã€å®ˆå«å‡½æ•° å°†é’©å­åŠå®ˆå«å‡½æ•°æ”¾å…¥é˜Ÿåˆ—ä¸­å¹¶æ‰§è¡Œ æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¾æ¬¡çœ‹ä¸‹ç›¸å…³é€»è¾‘ åˆ¤æ–­é‡å¤è·³è½¬ åœ¨åˆ¤æ–­é‡å¤è·³è½¬å‰å®šä¹‰äº†abortæ–¹æ³•ï¼Œå®ƒä¸»è¦å¯¹onAbortæ–¹æ³•åšäº†ä¸€å±‚åŒ…è£…ï¼›è¿™ä¸ªæ–¹æ³•åœ¨å¯¼èˆªå‘ç”Ÿå–æ¶ˆæ—¶ä¼šè¢«è°ƒç”¨åˆ° å®ƒæ¥æ”¶ä¸€ä¸ªerrå‚æ•°ï¼Œå¦‚æœæœ‰æ³¨å†Œé”™è¯¯å›è°ƒå¹¶ä¸”errä¸ºéNavigationDuplicatedé”™è¯¯åˆ™éå†errorCbsåˆ—è¡¨æ‰§è¡Œå…¶ä¸­çš„é”™è¯¯å›è°ƒ æœ€åè°ƒç”¨onAbortå›è°ƒå¹¶ä¼ å…¥errå‚æ•°äº¤ç»™å¤–éƒ¨å¤„ç† æ¥ä¸‹æ¥åˆ¤æ–­äº†æ˜¯å¦é‡å¤è·³è½¬ï¼Œä¸»è¦åˆ©ç”¨isSameRouteæ£€æµ‹äº†å½“å‰è·¯ç”±å¯¹è±¡å’Œç›®æ ‡è·¯ç”±å¯¹è±¡æ˜¯å¦ç›¸åŒï¼Œè‹¥ç›¸åŒä¸”äºŒè€…åŒ¹é…åˆ°è·¯ç”±è®°å½•æ•°é‡ç›¸åŒï¼Œåˆ™è§†ä¸ºé‡å¤è·³è½¬ï¼Œæ­¤æ—¶è°ƒç”¨abortæ–¹æ³•å¹¶ä¼ å…¥NavigationDuplicatedé”™è¯¯å¹¶ç»ˆæ­¢æµç¨‹ isSameRouteä¸»è¦åˆ¤æ–­äº†pathã€nameã€hashã€queryã€paramsç­‰å…³é”®ä¿¡æ¯æ˜¯å¦ç›¸åŒï¼Œè‹¥ç›¸åŒåˆ™è§†ä¸ºç›¸åŒè·¯ç”±å¯¹è±¡ 12345678910111213141516171819202122232425262728// src/util/route.js// æ˜¯å¦ç›¸åŒrouteexport function isSameRoute(a: Route, b: ?Route): boolean &#123; if (b === START) &#123; return a === b &#125; else if (!b) &#123; return false &#125; else if (a.path &amp;&amp; b.path) &#123; // pathéƒ½å­˜åœ¨ï¼Œæ¯”è¾ƒpathã€hashã€queryæ˜¯å¦ç›¸åŒ return ( a.path.replace(trailingSlashRE, '') === b.path.replace(trailingSlashRE, '') &amp;&amp; a.hash === b.hash &amp;&amp; isObjectEqual(a.query, b.query) ) &#125; else if (a.name &amp;&amp; b.name) &#123; // nameéƒ½å­˜åœ¨ï¼Œæ¯”è¾ƒnameã€hashã€queryã€paramsæ˜¯å¦ç›¸åŒ return ( a.name === b.name &amp;&amp; a.hash === b.hash &amp;&amp; isObjectEqual(a.query, b.query) &amp;&amp; isObjectEqual(a.params, b.params) ) &#125; else &#123; return false &#125;&#125; æ³¨æ„ï¼Œåœ¨ç¡®å®šæ˜¯é‡å¤è·³è½¬åï¼Œä»ç„¶ä¼šè°ƒç”¨å­ç±»çš„ensureURLæ–¹æ³•æ¥æ›´æ–°url å¯¹æ¯”æ‰¾å‡ºéœ€è¦æ›´æ–°ã€å¤±æ´»ã€æ¿€æ´»çš„è·¯ç”±è®°å½• åˆ¤æ–­å®Œé‡å¤è·³è½¬åï¼Œå°±éœ€è¦å¯¹æ¯”fromã€toè·¯ç”±å¯¹è±¡ï¼Œæ‰¾å‡ºå“ªäº›è·¯ç”±è®°å½•éœ€è¦æ›´æ–°ï¼Œå“ªäº›å¤±æ´»ã€å“ªäº›éœ€è¦æ¿€æ´»ï¼Œç”¨æ¥åç»­æŠ½å–é’©å­ã€å®ˆå«å‡½æ•° 123456// src/history/base.js confirmTransitionæ–¹æ³•ä¸­// å¯¹æ¯”å‰årouteçš„RouteRecordï¼Œæ‰¾å‡ºéœ€è¦æ›´æ–°ã€å¤±æ´»ã€æ¿€æ´»çš„çš„è·¯ç”±è®°å½•const &#123; updated, deactivated, activated &#125; = resolveQueue( this.current.matched, route.matched) å¯ä»¥çœ‹åˆ°é€»è¾‘å°è£…åœ¨äº†resolveQueueæ–¹æ³•ä¸­ï¼Œä¼ å…¥äº†å½“å‰å’Œç›®æ ‡è·¯ç”±å¯¹è±¡çš„è®°å½•åˆ—è¡¨ï¼Œä»è¿”å›å€¼ä¸­è§£æ„å‡ºäº†updated, deactivated, activated çœ‹ä¸‹resolveQueueå®ç° 1234567891011121314151617181920212223// å¯¹æ¯”currenã€nextçš„è·¯ç”±è®°å½•åˆ—è¡¨ï¼Œæ‰¾å‡ºéœ€è¦æ›´æ–°ã€å¤±æ´»ã€æ¿€æ´»çš„è·¯ç”±è®°å½•function resolveQueue( current: Array&lt;RouteRecord&gt;, next: Array&lt;RouteRecord&gt;): &#123; updated: Array&lt;RouteRecord&gt; activated: Array&lt;RouteRecord&gt; deactivated: Array&lt;RouteRecord&gt;&#125; &#123; let i const max = Math.max(current.length, next.length) // æ‰¾åˆ°é¦–ä¸ªä¸ç›¸ç­‰çš„è·¯ç”±è®°å½•ç´¢å¼• for (i = 0; i &lt; max; i++) &#123; if (current[i] !== next[i]) &#123; break &#125; &#125; // eg // current:[1,2,3] // next:[1,2,3,4,5] // iä¸º3 // éœ€è¦æ›´æ–°çš„ä¸º[1,2,3] // éœ€è¦æ¿€æ´»çš„ä¸º[4,5] // éœ€è¦å¤±æ´»çš„ä¸º[] return &#123; updated: next.slice(0, i), // ç´¢å¼•å·¦ä¾§æ˜¯éœ€è¦æ›´æ–°çš„ activated: next.slice(i), // ç´¢å¼•å³ä¾§æ˜¯éœ€è¦æ¿€æ´»çš„ deactivated: current.slice(i), // å½“å‰ç´¢å¼•å³ä¾§æ˜¯éœ€è¦å¤±æ´»çš„ &#125;&#125; é€»è¾‘å¾ˆç®€å• é¦–å…ˆæ‰¾å‡ºcurrentå’Œnextåˆ—è¡¨é•¿åº¦çš„æœ€å¤§å€¼ï¼Œ ç„¶åä»¥æ­¤ä¸ºå¾ªç¯æœ€å¤§æ¬¡æ•°å¾ªç¯æ‰¾å‡ºé¦–ä¸ªä¸ç›¸ç­‰çš„è·¯ç”±è®°å½•ç´¢å¼• ä»¥æ­¤ç´¢å¼•ä¸ºåˆ†ç•Œçº¿ï¼Œnextåˆ—è¡¨å½“å‰ç´¢å¼•å·¦ä¾§ä¸ºéœ€è¦æ›´æ–°çš„è·¯ç”±è®°å½•ã€ç´¢å¼•åŠç´¢å¼•å³ä¾§çš„ä¸ºéœ€è¦æ¿€æ´»çš„è·¯ç”±è®°å½• currentåˆ—è¡¨ç´¢å¼•åŠå³ä¾§æ˜¯éœ€è¦å¤±æ´»çš„è·¯ç”±è®°å½• ä¸¾ä¾‹ currentä¸º:[1,2,3]ã€nextä¸º[1,2,3,4,5]ï¼Œå½“å‰è·¯ç”±å¯¹è±¡åŒ…å«1ã€2ã€3ä¸‰ä¸ªè·¯ç”±è®°å½•ï¼Œç›®æ ‡è·¯ç”±å¯¹è±¡åŒ…å«1ã€2ã€3ã€4ã€5äº”ä¸ªè·¯ç”±è®°å½• è®¡ç®—åmaxä¸º5 å¾ªç¯ï¼Œå‘ç°é¦–ä¸ªä¸ç›¸ç­‰çš„ç´¢å¼•ä¸º3 æ‰€ä»¥éœ€è¦æ›´æ–°çš„ä¸ºnext.slice(0,3)å³1ã€2ã€3 éœ€è¦æ¿€æ´»çš„ä¸ºnext.slice(3)å³4ã€5 éœ€è¦å¤±æ´»çš„ä¸ºcurrent.slice(3)ï¼Œæ²¡æœ‰éœ€è¦å¤±æ´»çš„ æ‰¾å‡ºäº†éœ€è¦æ›´æ–°ã€æ¿€æ´»ã€å¤±æ´»çš„è·¯ç”±è®°å½•ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»ä¸­æŠ½å–å‡ºå¯¹åº”çš„é’©å­ã€å®ˆå«å‡½æ•° æŠ½å–é’©å­ã€å®ˆå«å‡½æ•°ã€è§£æå¼‚æ­¥ç»„ä»¶ é¦–å…ˆæˆ‘ä»¬æ¢³ç†ä¸‹vue-routeræœ‰å“ªäº›é’©å­ã€å®ˆå«å‡½æ•° router.beforeEachå…¨å±€å‰ç½®å®ˆå« router.beforeResolveå…¨å±€è§£æå®ˆå«(v2.5.0 æ–°å¢) router.afterEachå…¨å±€åç½®é’©å­ RouteConfig.beforeEnterè·¯ç”±ç‹¬äº«çš„å®ˆå« vm.beforeRouteEntervue ç»„ä»¶å†…è·¯ç”±è¿›å…¥å®ˆå« vm.beforeRouteUpdatevue ç»„ä»¶å†…è·¯ç”±æ›´æ–°å®ˆå«(v2.2 æ–°å¢) vm.beforeRouteLeavevue ç»„ä»¶å†…è·¯ç”±ç¦»å¼€å®ˆå« å¯ä»¥çœ‹åˆ°æœ‰äº›æ˜¯å®šä¹‰VueRouterå®ä¾‹ä¸Šçš„ï¼Œæœ‰äº›æ˜¯å®šä¹‰åœ¨é…ç½®è§„åˆ™RouteConfigä¸Šçš„ï¼Œæœ‰äº›æ˜¯å®šä¹‰åœ¨RouteComponentè·¯ç”±ç»„ä»¶ä¸Šçš„ å‰ä¸¤è€…çš„é’©å­ã€å®ˆå«æ˜¯å¾ˆå®¹æ˜“è·å–åˆ°çš„ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨Historyç±»ä¸­æŒæœ‰äº†VueRouterå®ä¾‹ï¼Œå¾ˆå®¹æ˜“è®¿é—®åˆ°è¿™äº›å®ˆå«ã€é’©å­å¹¶ä¸”å‡ ä¹ä¸éœ€è¦åšé¢å¤–å¤„ç†å°±å¯ä»¥ç›´æ¥æ‰§è¡Œï¼› å”¯ä¸€ä¸å¥½å¤„ç†çš„æ˜¯å®šä¹‰åœ¨RouteComponentè·¯ç”±ç»„ä»¶ä¸­çš„å®ˆå«å‡½æ•°ï¼Œéœ€è¦å€ŸåŠ©RouteRecordæ‹¿åˆ°æ‰€æœ‰RouteComponentè·¯ç”±ç»„ä»¶å¹¶ä»ä¸­æŠ½å–å‡ºå¯¹åº”å®ˆå«ï¼Œæœ€åè¿˜è¦ä¸ºå…¶ç»‘å®šä¸Šä¸‹æ–‡ï¼Œä¿è¯æ‰§è¡Œç»“æœæ­£ç¡®ï¼› ä¸ŠèŠ‚ï¼Œæˆ‘ä»¬å·²ç»æ‹¿åˆ°éœ€è¦æ›´æ–°ã€æ¿€æ´»ã€å¤±æ´»çš„RouteRecordè·¯ç”±è®°å½•ï¼Œæˆ‘ä»¬çœ‹ä¸‹åˆ†åˆ«è¦ä»ä¸­æŠ½å–å‡ºå“ªäº›å®ˆå« deactivatedä¸­æŠ½å–beforeRouteLeave updatedä¸­æŠ½å–beforeRouteUpdate activatedä¸­æŠ½å–beforeRouteEnterï¼Œè¿™é‡Œå­˜åœ¨ä¸€ä¸ªç‰¹æ®Šåœºæ™¯ï¼Œå°±æ˜¯å¼‚æ­¥è·¯ç”±ç»„ä»¶ï¼Œéœ€è¦ç­‰å¾…å¼‚æ­¥è·¯ç”±ç»„ä»¶è§£æå®Œæˆåï¼Œæ‰èƒ½æŠ½å–beforeRouteEnterå®ˆå«ï¼Œè¿™ä¸ªåé¢ä¼šè®² æˆ‘ä»¬å…ˆçœ‹ä¸‹æŠ½å–çš„å…¥å£ä»£ç  12345678910// src/history/base.js confirmTransitionæ–¹æ³•å†…// ç”Ÿæˆéœ€è¦æ‰§è¡Œçš„å®ˆå«ã€é’©å­é˜Ÿåˆ—const queue: Array&lt;?NavigationGuard&gt; = [].concat( // in-component leave guards extractLeaveGuards(deactivated), // æå–è·¯ç”±ç»„ä»¶ä¸­æ‰€æœ‰beforeRouteLeaveå®ˆå« // global before hooks this.router.beforeHooks, // å…¨å±€çš„beforeEachå®ˆå« // in-component update hooks extractUpdateHooks(updated), // æå–è·¯ç”±ç»„ä»¶ä¸­æ‰€æœ‰beforeRouteUpdateå®ˆå« // in-config enter guards activated.map((m) =&gt; m.beforeEnter), // è·¯ç”±ç‹¬äº«çš„beforeEnterå®ˆå« // async components resolveAsyncComponents(activated) // è§£æå¼‚æ­¥ç»„ä»¶) å¯ä»¥çœ‹åˆ°å®šä¹‰äº†ä¸€ä¸ªé˜Ÿåˆ—queue ä¾æ¬¡åšäº†ä¸‹é¢çš„äº‹ æŠ½å–äº†deactivatedä¸­çš„beforeRouteLeaveå®ˆå« è·å–äº†VueRouterå®ä¾‹ä¸Šå®šä¹‰çš„beforeEachå®ˆå« beforeEachå®ˆå«æ˜¯ç›´æ¥å®šä¹‰åœ¨VueRouterå®ä¾‹ä¸Šçš„ ä»updatedä¸­æŠ½å–äº†beforeRouteUpdateå®ˆå« ä»activatedä¸­è·å–äº†è·¯ç”±ç‹¬äº«çš„beforeEnterå®ˆå« beforeEnterå®ˆå«æœ€åˆæ˜¯å®šä¹‰åœ¨RouteConfigä¸Šçš„ï¼Œåé¢åˆä¼ é€’ç»™è·¯ç”±è®°å½•ï¼Œæ‰€ä»¥åœ¨è·¯ç”±è®°å½•ä¸Šèƒ½ç›´æ¥è·å–åˆ° è§£æactivatedä¸­çš„å¼‚æ­¥è·¯ç”±ç»„ä»¶ è·¯ç”±ç»„ä»¶æ”¯æŒimport()åŠ¨æ€å¯¼å…¥ï¼Œæ‰€ä»¥è¿™é‡Œè¦å¤„ç† æˆ‘ä»¬å…ˆçœ‹æ–¹æ³•åå¾ˆç±»ä¼¼çš„extractLeaveGuardså’ŒextractUpdateHooks extractLeaveGuardsã€extractUpdateHooks äºŒè€…éƒ½ä½äºsrc/base.js 12345678910// src/base.js// ä¼ å…¥è·¯ç”±è®°å½•åˆ—è¡¨ï¼Œæå–å‡ºbeforeRouteLeaveå®ˆå«å¹¶é€†åºè¾“å‡ºfunction extractLeaveGuards(deactivated: Array&lt;RouteRecord&gt;): Array&lt;?Function&gt; &#123; return extractGuards(deactivated, 'beforeRouteLeave', bindGuard, true)&#125;// ä¼ å…¥è·¯ç”±è®°å½•åˆ—è¡¨ï¼Œæå–å‡ºbeforeRouteUpdateé’©å­function extractUpdateHooks(updated: Array&lt;RouteRecord&gt;): Array&lt;?Function&gt; &#123; return extractGuards(updated, 'beforeRouteUpdate', bindGuard)&#125; å¯ä»¥çœ‹åˆ°äºŒè€…å†…éƒ¨éƒ½è°ƒç”¨äº†extractGuardsï¼Œå‰è€…å¤šä¼ äº†ä¸€ä¸ªå‚æ•°true æˆ‘ä»¬å†çœ‹ä¸‹extractGuards 123456789101112131415161718192021222324// src/base.js// æå–å®ˆå«function extractGuards( records: Array&lt;RouteRecord&gt;, name: string, // è¦æå–çš„å®ˆå«å bind: Function, // ç»‘å®šå®ˆå«ä¸Šä¸‹æ–‡å‡½æ•° reverse?: boolean // æ˜¯å¦éœ€è¦é€†åº): Array&lt;?Function&gt; &#123; const guards = flatMapComponents(records, ( def /*è·¯ç”±ç»„ä»¶å®šä¹‰*/, instance /*router-viewå®ä¾‹*/, match /*è·¯ç”±è®°å½•*/, key /*è§†å›¾å*/ ) =&gt; &#123; const guard = extractGuard(def, name) // æå–å‡ºè·¯ç”±ç»„ä»¶ä¸­çš„å®ˆå«å‡½æ•° // ä¸ºå®ˆå«ç»‘å®šä¸Šä¸‹æ–‡ if (guard) &#123; return Array.isArray(guard) ? guard.map((guard) =&gt; bind(guard, instance, match, key)) : bind(guard, instance, match, key) &#125; &#125;) // æ‰å¹³åŒ– + é€†åº return flatten(reverse ? guards.reverse() : guards)&#125; çœ‹ä¸‹æ–¹æ³•ç­¾å æ¥æ”¶ä¸€ä¸ªè·¯ç”±è®°å½•æ•°ç»„records å³extractLeaveGuardsä¸­ä¼ å…¥çš„deactivatedè·¯ç”±è®°å½•æ•°ç»„ï¼›extractUpdateHooksä¸­ä¼ å…¥çš„updatedè·¯ç”±è®°å½•æ•°ç»„ æ¥æ”¶ä¸€ä¸ªéœ€è¦æå–çš„å®ˆå«åname beforeRouteLeaveå’ŒbeforeRouteUpdateå­—ç¬¦ä¸² ä¸€ä¸ªç»‘å®šå®ˆå«ä¸Šä¸‹çš„å‡½æ•°bind extractLeaveGuardsã€extractUpdateHooksä¼ é€’çš„éƒ½æ˜¯bindGuardæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æˆ‘ä»¬åœ¨ä¸‹é¢è§£æ ä»¥åŠä¸€ä¸ªæ˜¯å¦éœ€è¦é€†åºè¾“å‡ºçš„reverseå¸ƒå°”å€¼ï¼›å¯é€‰å‚æ•°ï¼› extractLeaveGuardsä¼ é€’çš„æ˜¯trueï¼Œä»£è¡¨è¿”å›çš„æ•°ç»„(å®ˆå«å‡½æ•°æ•°ç»„)éœ€è¦é€†åºè¾“å‡ºï¼› è¿”å›ä¸€ä¸ªitemæ˜¯Functionçš„æ•°ç»„ çœ‹ä¸‹å†…éƒ¨é€»è¾‘ è°ƒç”¨flatMapComponentsä¼ å…¥recordså’Œä¸€ä¸ªæ¥æ”¶def, instance, match, keyå‚æ•°çš„ç®­å¤´å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªguardså®ˆå«æ•°ç»„ ç„¶åæ ¹æ®reverseæ¥å†³å®šæ˜¯å¦å¯¹guardsæ•°ç»„åšé€†åºå¤„ç† ä¸ºä½•éœ€è¦é€†åº? åœ¨createRouteç« èŠ‚ä¹Ÿæè¿‡ï¼Œåœ¨ä¿å­˜è·¯ç”±è®°å½•æ—¶æ˜¯é€†åºçš„ï¼Œç²¾å‡†åŒ¹é…çš„è·¯ç”±è®°å½•åœ¨æ•°ç»„æœ€å(length - 1ä½ç½®)ï¼Œçˆ¶è®°å½•åœ¨å‰ éƒ¨åˆ†å®ˆå«å‡½æ•°éœ€è¦é€†åºé€†åºæ‰§è¡Œï¼Œä¾‹å¦‚beforeRouteLeaveï¼Œå®ƒéœ€è¦å…ˆåœ¨ç²¾å‡†åŒ¹é…çš„è·¯ç”±ç»„ä»¶ä¸Šè°ƒç”¨ï¼Œå†åœ¨çˆ¶ç»„ä»¶ä¸Šè°ƒç”¨ æœ€åè°ƒç”¨flattenå°†guardsæ‰å¹³åŒ– å…ˆçœ‹ä¸‹flatMapComponentså®ç° 1234567891011121314151617181920// src/util/resolve-components.js// æ‰å¹³åŒ–è·¯ç”±è®°å½•ä¸­çš„è·¯ç”±ç»„ä»¶export function flatMapComponents( matched: Array&lt;RouteRecord&gt;, // è·¯ç”±è®°å½•æ•°ç»„ fn: Function // å›è°ƒå‡½æ•°): Array&lt;?Function&gt; &#123; return flatten( matched.map((m) =&gt; &#123; return Object.keys(m.components).map((key) =&gt; fn( m.components[key], // å‘½åè§†å›¾å¯¹åº”çš„è·¯ç”±ç»„ä»¶å®šä¹‰ï¼›ä¸€èˆ¬å¯¹åº”fnçš„å…¥å‚def m.instances[key], // router-viewå®ä¾‹ï¼›ä¸€èˆ¬å¯¹åº”fnçš„å…¥å‚_æˆ–instance m, // åŒ¹é…çš„è·¯ç”±è®°å½•ï¼›ä¸€èˆ¬å¯¹åº”fnçš„å…¥å‚match key // å‘½åè§†å›¾çš„keyï¼›ä¸€èˆ¬å¯¹åº”fnçš„å…¥å‚key ) ) &#125;) )&#125; å¯ä»¥çœ‹åˆ°å…¶æ¥æ”¶ä¸€ä¸ªè·¯ç”±è®°å½•æ•°ç»„matchedå’Œä¸€ä¸ªå‡½æ•°fnï¼Œè¿”å›ä¸€ä¸ªç»è¿‡flattenå¤„ç†çš„æ•°ç»„ matchedå°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„records fnå°±æ˜¯æ¥æ”¶def, instance, match, keyå‚æ•°çš„ç®­å¤´å‡½æ•° è¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯éå†è·¯ç”±è®°å½•ä¸­çš„æ¯ä¸ªè·¯ç”±ç»„ä»¶å¹¶ç”¨å…¶åšå…¥å‚ä¾æ¬¡è°ƒç”¨å¤–éƒ¨å‡½æ•°fnï¼Œè¿”å›ç»“æœç”±fnå‡½æ•°å†³å®šï¼Œæœ€åå°†ç»“æœæ•°ç»„æ‰å¹³åŒ–è¾“å‡º åœ¨è§£æå¼‚æ­¥ç»„ä»¶æ—¶ä¹Ÿä¼šç”¨åˆ°æ­¤æ–¹æ³• å…¶ä¼šå¯¹ä¼ å…¥çš„recordsè°ƒç”¨mapæ–¹æ³•ï¼Œå¹¶éå†æ¯ä¸ªrecordä¸Šå®šä¹‰çš„componentså­—æ®µï¼Œå¹¶å¯¹componentså†æ¬¡è¿›è¡Œmapéå†ï¼Œç„¶åè°ƒç”¨ä¼ å…¥çš„fnï¼Œmapç»“æœå°±æ˜¯fnè¿”å›çš„ç»“æœ componentså­—æ®µæ˜¯å®šä¹‰å‘½åè§†å›¾ç”¨çš„ï¼Œé•¿ä¸‹é¢è¿™æ ·ï¼Œkey ä¸ºè§†å›¾åï¼Œvalue ä¸ºå¯¹åº”è·¯ç”±ç»„ä»¶ 12345components: &#123; default: Foo, a: Bar, b: Baz&#125; æ‰€ä»¥ä¼ å…¥çš„ fnï¼Œå³æ¥æ”¶def, instance, match, keyå‚æ•°çš„ç®­å¤´å‡½æ•°çš„å››ä¸ªå‚æ•°åˆ†åˆ«ä¸º defå¯¹åº”m.components[key]å³è·¯ç”±ç»„ä»¶å®šä¹‰(Fooã€Barã€Baz) instanceå¯¹åº”m.instances[key]æ˜¯router-viewç»„ä»¶å®ä¾‹ï¼Œå…³äºè·¯ç”±è®°å½•å’Œroute-viewæ˜¯å¦‚ä½•å…³è”çš„ï¼Œä¼šåœ¨ä»‹ç»viewç»„ä»¶æ—¶è§£æ må¯¹åº”çš„å°±æ˜¯å½“å‰éå†åˆ°çš„è·¯ç”±è®°å½• keyæ˜¯å½“å‰éå†åˆ°çš„è§†å›¾å å¤§ä½“é€»è¾‘å¦‚ä¸‹ flat-map-components.png æˆ‘ä»¬çœ‹ä¸‹ç®­å¤´å‡½æ•°å†…éƒ¨çš„é€»è¾‘ 12345678910111213const guards = flatMapComponents(records, ( def /*è·¯ç”±ç»„ä»¶å®šä¹‰*/, instance /*router-viewå®ä¾‹*/, match /*è·¯ç”±è®°å½•*/, key /*è§†å›¾å*/) =&gt; &#123; const guard = extractGuard(def, name) // æå–å‡ºè·¯ç”±ç»„ä»¶ä¸­çš„å®ˆå«å‡½æ•° // ä¸ºå®ˆå«ç»‘å®šä¸Šä¸‹æ–‡ if (guard) &#123; return Array.isArray(guard) ? guard.map((guard) =&gt; bind(guard, instance, match, key)) : bind(guard, instance, match, key) &#125;&#125;) é¦–å…ˆè°ƒç”¨extractGuardä»è·¯ç”±ç»„ä»¶å®šä¹‰ä¸­ç›´æ¥æŠ½å–å‡ºå¯¹åº”nameçš„å®ˆå«å‡½æ•° æ¥ä¸‹æ¥è°ƒç”¨ä¼ å…¥extractGuardsçš„bindæ–¹æ³•ä¸ºå®ˆå«ç»‘å®šä¸Šä¸‹æ–‡ æˆ‘ä»¬çœ‹ä¸‹extractGuardå®ç° 12345678910111213// src/base.js// æå–å•ä¸ªå®ˆå«function extractGuard( def: Object | Function, key: string): NavigationGuard | Array&lt;NavigationGuard&gt; &#123; if (typeof def !== 'function') &#123; // extend now so that global mixins are applied. def = _Vue.extend(def) &#125; return def.options[key]&#125; ä¸»è¦æœ‰ä¸¤ä¸ªé€»è¾‘ è°ƒç”¨extendä»¥åº”ç”¨å…¨å±€ mixins è¿”å›å¯¹åº”å®ˆå«å‡½æ•° æå–å®Œå•ä¸ªå®ˆå«åï¼Œå°±éœ€è¦è°ƒç”¨ä¼ å…¥çš„bindæ–¹æ³•å¯¹å…¶ç»‘å®šä¸Šä¸‹æ–‡ï¼› bindæ–¹æ³•å…¶å®æ˜¯bindGuard 12345678910// src/history/base.js// å°†å®ˆå«çš„ä¸Šä¸‹æ–‡ç»‘å®šåˆ°vueå®ä¾‹(è·¯ç”±ç»„ä»¶)function bindGuard(guard: NavigationGuard, instance: ?_Vue): ?NavigationGuard &#123; if (instance) &#123; return function /*å·²ç»ç»‘å®šè¿‡ä¸Šä¸‹æ–‡çš„å®ˆå«å‡½æ•°*/ boundRouteGuard() &#123; return guard.apply(instance, arguments) &#125; &#125;&#125; ç»è¿‡ä¸Šé¢çš„ä¸Šä¸‹æ–‡ç»‘å®šï¼Œä»è·¯ç”±ç»„ä»¶ä¸­æŠ½å–å‡ºçš„å®ˆå«å‡½æ•°å°±åˆå›æ¥åˆ°è·¯ç”±ç»„ä»¶ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œäº†ï¼Œè¿™æ ·å°±ä¿è¯äº†å®ˆå«å‡½æ•°æ— è®ºåœ¨ä½•å¤„è¢«è°ƒç”¨ï¼Œéƒ½èƒ½è¿”å›æ­£ç¡®çš„ç»“æœ å°ç»“ extractGuardsä¸»è¦å®Œæˆäº†ä»è·¯ç”±ç»„ä»¶ä¸­æŠ½å–å®ˆå«å‡½æ•°å¹¶ä¸ºå…¶ç»‘å®šä¸Šä¸‹æ–‡çš„å·¥ä½œ extract-guards.png æ¥ä¸‹æ¥æˆ‘ä»¬è¦å¯¹æ¿€æ´»çš„è·¯ç”±è®°å½•è¿›è¡Œå¼‚æ­¥ç»„ä»¶çš„è§£æ ä¸»è¦é€šè¿‡resolveAsyncComponentsæ–¹æ³•å®ç°çš„ resolveAsyncComponents åœ¨çœ‹å¦‚ä½•è§£æå¼‚æ­¥ç»„ä»¶å‰ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸‹vueä¸­çš„å¼‚æ­¥ç»„ä»¶é•¿ä»€ä¹ˆæ ·ï¼Ÿ 12345678910111213141516171819202122232425262728293031323334353637383940414243// https://cn.vuejs.org/v2/guide/components-dynamic-async.html#å¼‚æ­¥ç»„ä»¶// æ¥æ”¶resolve,rejectVue.component('async-example', function (resolve, reject) &#123; setTimeout(function () &#123; // å‘ `resolve` å›è°ƒä¼ é€’ç»„ä»¶å®šä¹‰ resolve(&#123; template: '&lt;div&gt;I am async!&lt;/div&gt;', &#125;) &#125;, 1000)&#125;)// ç»“åˆrequireä½¿ç”¨Vue.component('async-webpack-example', function (resolve) &#123; // è¿™ä¸ªç‰¹æ®Šçš„ `require` è¯­æ³•å°†ä¼šå‘Šè¯‰ webpack // è‡ªåŠ¨å°†ä½ çš„æ„å»ºä»£ç åˆ‡å‰²æˆå¤šä¸ªåŒ…ï¼Œè¿™äº›åŒ… // ä¼šé€šè¿‡ Ajax è¯·æ±‚åŠ è½½ require(['./my-async-component'], resolve)&#125;)// ç»“åˆimport()ä½¿ç”¨Vue.component( 'async-webpack-example', // è¿™ä¸ªåŠ¨æ€å¯¼å…¥ä¼šè¿”å›ä¸€ä¸ª `Promise` å¯¹è±¡ã€‚ () =&gt; import('./my-async-component'))// å±€éƒ¨æ³¨å†Œnew Vue(&#123; // ... components: &#123; 'my-component': () =&gt; import('./my-async-component'), &#125;,&#125;)// å¸¦æœ‰åŠ è½½çŠ¶æ€const AsyncComponent = () =&gt; (&#123; // éœ€è¦åŠ è½½çš„ç»„ä»¶ (åº”è¯¥æ˜¯ä¸€ä¸ª `Promise` å¯¹è±¡) component: import('./MyComponent.vue'), // å¼‚æ­¥ç»„ä»¶åŠ è½½æ—¶ä½¿ç”¨çš„ç»„ä»¶ loading: LoadingComponent, // åŠ è½½å¤±è´¥æ—¶ä½¿ç”¨çš„ç»„ä»¶ error: ErrorComponent, // å±•ç¤ºåŠ è½½æ—¶ç»„ä»¶çš„å»¶æ—¶æ—¶é—´ã€‚é»˜è®¤å€¼æ˜¯ 200 (æ¯«ç§’) delay: 200, // å¦‚æœæä¾›äº†è¶…æ—¶æ—¶é—´ä¸”ç»„ä»¶åŠ è½½ä¹Ÿè¶…æ—¶äº†ï¼Œ // åˆ™ä½¿ç”¨åŠ è½½å¤±è´¥æ—¶ä½¿ç”¨çš„ç»„ä»¶ã€‚é»˜è®¤å€¼æ˜¯ï¼š`Infinity` timeout: 3000,&#125;) æ–‡æ¡£å¯¹å¼‚æ­¥ç»„ä»¶çš„æè¿°æ˜¯Vue å…è®¸ä½ ä»¥ä¸€ä¸ªå·¥å‚å‡½æ•°çš„æ–¹å¼å®šä¹‰ä½ çš„ç»„ä»¶ï¼Œè¿™ä¸ªå·¥å‚å‡½æ•°ä¼šå¼‚æ­¥è§£æä½ çš„ç»„ä»¶å®šä¹‰ å¯ä»¥ç†è§£ä¸ºï¼šå¼‚æ­¥ç»„ä»¶æ˜¯ä¸€ä¸ªå·¥å‚å‡½æ•°ï¼Œå‡½æ•°å†…resolveã€rejectç»„ä»¶çš„å®šä¹‰ã€è¿”å›ä¸€ä¸ªPromiseã€è¿”å›ä¸€ä¸ªå¸¦æœ‰ç‰¹å®šæ ‡è¯†å­—æ®µçš„å¯¹è±¡ è§£æè·¯ç”±è®°å½•ä¸­çš„å¼‚æ­¥ç»„ä»¶ä»£ç ä½äºsrc/util/resolve-components.js 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374// src/util/resolve-components.js// è§£æå¼‚æ­¥ç»„ä»¶ï¼Œè¿”å›ä¸€ä¸ªæ¥æ”¶to, from, nextå‚æ•°çš„å‡½æ•°export function resolveAsyncComponents(matched: Array&lt;RouteRecord&gt;): Function &#123; return (to, from, next) =&gt; &#123; let hasAsync = false let pending = 0 let error = null flatMapComponents(matched, ( /*è·¯ç”±ç»„ä»¶å®šä¹‰*/ def, /*router-viewå®ä¾‹*/ _, /*è·¯ç”±è®°å½•*/ match, /*è§†å›¾å*/ key ) =&gt; &#123; // if it's a function and doesn't have cid attached, // assume it's an async component resolve function. // we are not using Vue's default async resolving mechanism because // we want to halt the navigation until the incoming component has been // resolved. // def.cidä¸ºå®ä¾‹æ„é€ å‡½æ•°æ ‡è¯†ï¼›https://github.com/vuejs/vue/search?q=cid&amp;unscoped_q=cid // ç»„ä»¶çš„å®šä¹‰æ˜¯å‡½æ•°ä¸”ç»„ä»¶cidè¿˜æœªè®¾ç½®ï¼Œåˆ™è®¤ä¸ºå…¶æ˜¯ä¸€ä¸ªå¼‚æ­¥ç»„ä»¶ if (typeof def === 'function' &amp;&amp; def.cid === undefined) &#123; hasAsync = true pending++ // è§£æ const resolve = once((resolvedDef) =&gt; &#123; // åŠ è½½åçš„ç»„ä»¶å®šä¹‰æ˜¯ä¸€ä¸ªesm if (isESModule(resolvedDef)) &#123; resolvedDef = resolvedDef.default &#125; // save resolved on async factory in case it's used elsewhere // ä¿ç•™å¼‚æ­¥ç»„ä»¶å·¥å‚å‡½æ•°ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨ def.resolved = typeof resolvedDef === 'function' ? resolvedDef : _Vue.extend(resolvedDef) match.components[key] = resolvedDef // æ›¿æ¢è·¯ç”±è®°å½•çš„å‘½åè§†å›¾ä¸­çš„ç»„ä»¶ pending-- if (pending &lt;= 0) &#123; // æ‰€æœ‰å¼‚æ­¥ç»„ä»¶åŠ è½½å®Œ next() &#125; &#125;) // æŠ¥é”™ const reject = once((reason) =&gt; &#123; const msg = `Failed to resolve async component $&#123;key&#125;: $&#123;reason&#125;` process.env.NODE_ENV !== 'production' &amp;&amp; warn(false, msg) if (!error) &#123; error = isError(reason) ? reason : new Error(msg) next(error) &#125; &#125;) // å¼‚æ­¥ç»„ä»¶ï¼Œhttps://cn.vuejs.org/v2/guide/components-dynamic-async.html#å¼‚æ­¥ç»„ä»¶ let res try &#123; res = def(resolve, reject) // è¿”å›promise &#125; catch (e) &#123; reject(e) &#125; if (res) &#123; if (typeof res.then === 'function') &#123; res.then(resolve, reject) &#125; else &#123; // new syntax in Vue 2.3 // å¤„ç†åŠ è½½çŠ¶æ€ï¼Œè¿”å›ä¸€ä¸ªåŒ…å¯¹è±¡ï¼›https://cn.vuejs.org/v2/guide/components-dynamic-async.html#å¤„ç†åŠ è½½çŠ¶æ€ const comp = res.component // æ˜¯é€šè¿‡import()åŠ è½½ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªpromise if (comp &amp;&amp; typeof comp.then === 'function') &#123; comp.then(resolve, reject) &#125; &#125; &#125; &#125; &#125;) // æ²¡æœ‰å¼‚æ­¥ç»„ä»¶ï¼Œç›´æ¥next if (!hasAsync) next() &#125;&#125; å¯ä»¥çœ‹åˆ°å…¶æ¥æ”¶ä¸€ä¸ªè·¯ç”±è®°å½•æ•°ç»„matchedï¼Œè¿”å›ä¸€ä¸ªæ¥æ”¶fromã€toã€nextçš„å‡½æ•°ï¼Œå†…éƒ¨æ˜¯å¼‚æ­¥ç»„ä»¶çš„è§£æé€»è¾‘ resolveAsyncComponentsè¢«è°ƒç”¨æ—¶å¹¶ä¸ä¼šæ‰§è¡Œè§£æå¼‚æ­¥ç»„ä»¶çš„é€»è¾‘ï¼Œå› ä¸ºå…¶åªä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›çš„å‡½æ•°ä¼šåœ¨è¿è¡Œé˜Ÿåˆ—æ—¶æ‰ä¼šè¢«è°ƒç”¨ï¼Œè¿™æ—¶æ‰ä¼šè§£æå¼‚æ­¥ç»„ä»¶ é˜Ÿåˆ—çš„è¿è¡Œï¼Œæˆ‘ä»¬åé¢å†çœ‹ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸‹è¿”å›çš„å‡½æ•°å†…éƒ¨æ˜¯ä»€ä¹ˆé€»è¾‘ å®šä¹‰äº†ä¸€ä¸ªæ˜¯å¦æœ‰å¼‚æ­¥ç»„ä»¶çš„æ ‡è¯†å­—æ®µhasAsyncã€ä»¥åŠå½“å‰å¾…è§£æçš„å¼‚æ­¥ç»„ä»¶æ•°é‡pending ç„¶åè°ƒç”¨äº†flatMapComponentsæ‹¿åˆ°recordsä¸­çš„æ‰€æœ‰è·¯ç”±ç»„ä»¶ï¼Œå¹¶ä¾æ¬¡è°ƒç”¨ä¼ å…¥çš„å›è°ƒæ–¹æ³• å›è°ƒæ–¹æ³•ä¼šæ¥æ”¶åˆ°è¢«éå†çš„è·¯ç”±ç»„ä»¶ï¼Œæ­¤æ—¶éœ€è¦åˆ¤æ–­è¿™ä¸ªè·¯ç”±ç»„ä»¶æ˜¯å¦æ˜¯å¼‚æ­¥ç»„ä»¶ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å¼€å§‹å¼‚æ­¥ç»„ä»¶çš„è§£æï¼Œå¦åˆ™è·³è¿‡ å¦‚æœéå†ç»“æŸå‘ç°hasAsyncä»ç„¶ä¸ºfalseï¼Œä»£è¡¨æ²¡æœ‰å¼‚æ­¥ç»„ä»¶ç›´æ¥next()è¿›è¡Œä¸‹ä¸€æ­¥å³å¯ å¦‚ä½•ç¡®å®šæŸä¸ªç»„ä»¶æ˜¯å¦æ˜¯å¼‚æ­¥ç»„ä»¶å‘¢ï¼Ÿ å‰é¢æˆ‘ä»¬è¯´è¿‡ï¼Œåœ¨vueä¸­å¼‚æ­¥ç»„ä»¶ä¸€å®šæ˜¯ä¸ªå·¥å‚å‡½æ•°ï¼Œå†…éƒ¨ä¼šè°ƒç”¨resoveã€rejectæˆ–è¿”å›Promiseæˆ–è¿”å›ç‰¹å®šæ ¼å¼å¯¹è±¡ï¼Œæ€»ä¹‹ä»–è‚¯å®šæ˜¯ä¸ªå‡½æ•° å…¶æ¬¡vueä¸­æ¯ä¸ªå®ä¾‹éƒ½ä¼šæœ‰ä¸ªå”¯ä¸€æ ‡è¯†cidï¼Œå¦‚æœæœ‰cidå°±ä»£è¡¨å·²ç»ç”Ÿæˆç›¸åº”å®ä¾‹ï¼Œæ‰€ä»¥å¼‚æ­¥ç»„ä»¶çš„cidä¸€å®šä¸ºundefined æ‰€ä»¥åˆ¤æ–­æ˜¯å¦æ˜¯å¼‚æ­¥ç»„ä»¶çš„ä¾æ®å°±æ˜¯ å‡½æ•° &amp;&amp; cid === &#39;undefined&#39; å¦‚æœåˆ¤æ–­æ˜¯å¼‚æ­¥ç»„ä»¶ï¼Œåˆ™å°†hasAsyncç½®ä¸ºtrueå¹¶è®©pendingè‡ªå¢ï¼Œä»£è¡¨æœ‰å‘ç°å¼‚æ­¥ç»„ä»¶ï¼Œåœ¨è§£æå®Œç»„ä»¶åpendingè‡ªå‡ï¼Œå½“pending&lt;=0åˆ™ä»£è¡¨å¼‚æ­¥ç»„ä»¶è§£æç»“æŸï¼Œå¯ä»¥è°ƒç”¨nextè¿›è¡Œä¸‹ä¸€æ­¥ å‰é¢æè¿‡ï¼Œvueçš„å¼‚æ­¥ç»„ä»¶å·¥å‚å‡½æ•°ä¼šæ¥æ”¶resolveã€rejectä¸¤ä¸ªæ–¹æ³•å¹¶åœ¨ä»æœåŠ¡å™¨å¾—åˆ°ç»„ä»¶å®šä¹‰åè¢«è°ƒç”¨ï¼› åœ¨æ¥æ”¶åˆ°æœåŠ¡å™¨è¿”å›å¼‚æ­¥ç»„ä»¶çš„å®šä¹‰æ—¶ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•ä¼šè¢«ä¼ å…¥å¼‚æ­¥ç»„ä»¶å·¥å‚å‡½æ•° ç”±äºå¼‚æ­¥ç»„ä»¶å·¥å‚å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªPromiseå‡½æ•°æˆ–ç‰¹å®šæ ¼å¼çš„å¯¹è±¡ï¼Œæ‰€ä»¥ä¼šæœ‰ä¸‹é¢æƒ…å†µ å¦‚æœæ˜¯è¿”å›Promiseï¼Œåˆ™å°†è¿™ä¸¤æ–¹æ³•å†ä¼ å…¥è¿”å›çš„Promise.thenä¸­ å¦‚æœè¿”å›ç‰¹å®šæ ¼å¼å¯¹è±¡ï¼Œåˆ™æ‰¾åˆ°componentå­—æ®µï¼Œå¹¶å°†è¿™ä¸¤æ–¹æ³•å†ä¼ å…¥component.thenä¸­ ç”±äºresolveã€rejectå·²ç»è¢«onceåŒ…è£…ï¼Œå³ä½¿ä¼ å…¥å¤šæ¬¡ï¼Œä¹Ÿåªä¼šè¢«æ‰§è¡Œä¸€æ¬¡ æˆ‘ä»¬çœ‹ä¸‹resolveã€rejectæ–¹æ³• ä»–ä»¬éƒ½è¢«ä¸€ä¸ªonceæ–¹æ³•åŒ…è£¹ä»¥ä¿è¯åªä¼šè¢«æ‰§è¡Œä¸€æ¬¡ reject ç›´æ¥æŠ›å‡ºä¸€ä¸ªé”™è¯¯å¹¶è°ƒç”¨nextä¼ é€’åˆ°ä¸‹ä¸€æµç¨‹ resolve å…ˆåˆ¤æ–­ä¸‹æ˜¯å¦æ˜¯esmï¼Œè‹¥æ˜¯ï¼Œåˆ™å–å…¶.defaultå­—æ®µæ¥è·å–ç»„ä»¶å®šä¹‰ æ‹¿åˆ°ç»„ä»¶å®šä¹‰åï¼Œä¼šå…ˆä¿ç•™å¼‚æ­¥ç»„ä»¶å·¥å‚å‡½æ•°ï¼Œæ–¹ä¾¿åç»­ä½¿ç”¨ ç„¶åæ›¿æ¢è·¯ç”±è®°å½•çš„å‘½åè§†å›¾ä¸­çš„å¯¹åº”ç»„ä»¶ï¼Œè¿™å°±å®Œæˆäº†ç»„ä»¶çš„è§£æå¹¶ç»‘å®šåˆ°è·¯ç”±è®°å½•ä¸Š å†æ¬¡é‡ç”³ä¸Šé¢æåˆ°çš„é€»è¾‘éƒ½æ˜¯resolveAsyncComponentsè¿”å›çš„å‡½æ•°é€»è¾‘ï¼Œè¿™ä¸ªå‡½æ•°é€»è¾‘ä¼šç­‰åˆ°é˜Ÿåˆ—è¢«æ‰§è¡Œæ—¶æ‰å®é™…è°ƒç”¨ è‡³æ­¤ï¼Œæˆ‘ä»¬çš„é˜Ÿåˆ—queueå·²ç»åŒ…å«äº†æŠ½å–å‡ºæ¥çš„å®ˆå«ã€é’©å­ã€åŒ…å«è§£æå¼‚æ­¥ç»„ä»¶é€»è¾‘çš„å‡½æ•° é˜Ÿåˆ—å·²ç»æ„å»ºå®Œæˆï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•æ‰§è¡Œçš„ å®ˆå«é˜Ÿåˆ—çš„æ‰§è¡Œ é˜Ÿåˆ—çš„æ‰§è¡Œæ˜¯é€šè¿‡runQueueã€iteratorç›¸äº’é…åˆæ¥å®ç°çš„ runQueue runQueueæ–¹æ³•ä½äºsrc/util/async.js 123456789101112131415161718192021222324252627282930313233// src/util/async.js/* @flow */// é˜Ÿåˆ—æ‰§è¡Œå‡½æ•°// queue éœ€è¦æ‰§è¡Œçš„é˜Ÿåˆ—// fn è¿­ä»£å‡½æ•°// cb å›è°ƒå‡½æ•°export function runQueue( queue: Array&lt;?NavigationGuard&gt;, fn: Function, cb: Function) &#123; const step = (index) =&gt; &#123; // å…¨éƒ¨æ‰§è¡Œå®Œï¼Œæ‰§è¡Œå›è°ƒ if (index &gt;= queue.length) &#123; cb() &#125; else &#123; // å­˜åœ¨ï¼Œæ‰§è¡Œè¿­ä»£å‡½æ•° if (queue[index]) &#123; fn( queue[index], /* next*/ () =&gt; &#123; step(index + 1) &#125; ) &#125; else &#123; // å¦åˆ™ï¼Œè·³åˆ°ä¸‹ä¸ªæ‰§è¡Œ step(index + 1) &#125; &#125; &#125; step(0)&#125; å¯ä»¥çœ‹åˆ°å®ƒæ¥æ”¶ä¸€ä¸ªé˜Ÿåˆ—queueã€ä¸€ä¸ªè¿­ä»£å‡½æ•°fnã€ä¸€ä¸ªæ‰§è¡Œå®Œæ¯•çš„å›è°ƒå‡½æ•°cb å†…éƒ¨æ˜¯ä¸€ä¸ªé€’å½’çš„å®ç° å®šä¹‰äº†ä¸€ä¸ªstepå‡½æ•°å¹¶æ¥æ”¶ä¸€ä¸ªæ ‡è¯†é˜Ÿåˆ—æ‰§è¡Œæ­¥éª¤çš„index å¿…é¡»é€šè¿‡æ‰‹åŠ¨è°ƒç”¨stepæ‰èƒ½è·³åˆ°ä¸‹ä¸€ä¸ªé˜Ÿåˆ—é¡¹çš„æ‰§è¡Œ åœ¨è§£æç»„ä»¶æ—¶ä¼šç”¨åˆ° å½“indexå¤§äºç­‰äºé˜Ÿåˆ—çš„é•¿åº¦æ—¶(é€’å½’çš„ç»“æŸæ¡ä»¶)ï¼Œä»£è¡¨é˜Ÿåˆ—é¡¹å…¨æ‰§è¡Œå®Œæ¯•ï¼Œå¯ä»¥è°ƒç”¨cb å¦åˆ™ï¼Œè‹¥è¿˜æœ‰é˜Ÿåˆ—é¡¹ï¼Œåˆ™ç»§ç»­è°ƒç”¨è¿­ä»£å‡½æ•°fnå¹¶ä¼ å…¥é˜Ÿåˆ—é¡¹å’Œè·³è½¬ä¸‹ä¸ªé˜Ÿåˆ—é¡¹çš„step(index + 1)å‡½æ•° è‹¥æ— é˜Ÿåˆ—é¡¹äº†ï¼Œåˆ™ç›´æ¥è·³åˆ°ä¸‹ä¸ªé˜Ÿåˆ—é¡¹çš„æ‰§è¡Œ é€’å½’é€šè¿‡step(0)æ¥æ¿€æ´» iterator è¿­ä»£å™¨ç›¸å…³ä»£ç å¥½ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344// src/history/base.js// è¿­ä»£å‡½æ•°const iterator = (hook: NavigationGuard, next) =&gt; &#123; if (this.pending !== route) &#123; // å½“å‘ç°toå‘ç”Ÿå˜åŒ–ï¼Œåˆ™ä»£è¡¨éœ€è¦å–æ¶ˆ return abort() &#125; try &#123; hook( /* to*/ route, /* from*/ current, /* next*/ (to: any) =&gt; &#123; if (to === false || isError(to)) &#123; // next(false) -&gt; abort navigation, ensure current URL // next(false) -&gt; å–æ¶ˆè·³è½¬ï¼Œæ·»åŠ ä¸€ä¸ªæ–°å†å²è®°å½•(ä½†ç”±äºurlåœ°å€æœªå‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥å¹¶æœªæ·»åŠ è®°å½•) this.ensureURL(true) abort(to) &#125; else if ( typeof to === 'string' || // next('/') (typeof to === 'object' &amp;&amp; (typeof to.path === 'string' || typeof to.name === 'string')) ) &#123; // next(&#123;path:'/'&#125;)æˆ–next(&#123;name:'Home'&#125;) // next('/') or next(&#123; path: '/' &#125;) -&gt; redirect abort() // å–æ¶ˆå½“å‰ if (typeof to === 'object' &amp;&amp; to.replace) &#123; // è°ƒç”¨å­ç±»æ–¹æ³•çš„æ›¿æ¢è®°å½• this.replace(to) &#125; else &#123; // è°ƒç”¨å­ç±»æ–¹æ³•çš„æ·»åŠ è®°å½• this.push(to) &#125; &#125; else &#123; // confirm transition and pass on the value // next() next(to) &#125; &#125; ) &#125; catch (e) &#123; abort(e) &#125;&#125; å¯ä»¥çœ‹åˆ°å…¶æ¥æ”¶ä¸€ä¸ªhookä¹Ÿå°±æ˜¯å®ˆå«é˜Ÿåˆ—ä¸­çš„å®ˆå«ã€é’©å­å‡½æ•°å’Œnextå‡½æ•°(runQueueä¼ é€’è¿‡æ¥çš„stepå‡½æ•°) å½“åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œè·¯ç”±å‘ç”Ÿå˜åŒ–ï¼Œä¼šç«‹å³å–æ¶ˆ ç„¶åå°è¯•è°ƒç”¨hookï¼Œå¹¶ä¼ å…¥ç›®æ ‡è·¯ç”±å¯¹è±¡ã€å½“å‰è·¯ç”±å¯¹è±¡ã€ä»¥åŠä¸€ä¸ªæ¥æ”¶toçš„ç®­å¤´å‡½æ•° å…¶å®è¿™ä¸‰ä¸ªå‚æ•°å°±å¯¹åº”å®ˆå«ä¼šæ¥æ”¶åˆ°çš„fromã€toã€nextä¸‰ä¸ªå‚æ•° 123router.beforeEach((to, from, next) =&gt; &#123; // ...&#125;) æˆ‘ä»¬çŸ¥é“å®ˆå«çš„nextæ˜¯ä¸€ä¸ªfunctionï¼Œå¹¶èƒ½æ¥æ”¶ä¸‹é¢å‡ ç§å‚æ•°ä»¥æ»¡è¶³ä¸åŒçš„è·¯ç”±è·³è½¬éœ€æ±‚ next(): è¿›è¡Œç®¡é“ä¸­çš„ä¸‹ä¸€ä¸ªé’©å­ã€‚ next(false): ä¸­æ–­å½“å‰çš„å¯¼èˆªã€‚ next(&#39;/&#39;) æˆ–è€… next({ path: &#39;/&#39; }): è·³è½¬åˆ°ä¸€ä¸ªä¸åŒçš„åœ°å€ã€‚å½“å‰çš„å¯¼èˆªè¢«ä¸­æ–­ï¼Œç„¶åè¿›è¡Œä¸€ä¸ªæ–°çš„å¯¼èˆªã€‚ä½ å¯ä»¥å‘ next ä¼ é€’ä»»æ„ä½ç½®å¯¹è±¡ï¼Œä¸”å…è®¸è®¾ç½®è¯¸å¦‚ replace: trueã€name: â€˜homeâ€™ ä¹‹ç±»çš„é€‰é¡¹ä»¥åŠä»»ä½•ç”¨åœ¨ router-link çš„ to prop æˆ– router.push ä¸­çš„é€‰é¡¹ã€‚ next(error): (2.4.0+) å¦‚æœä¼ å…¥ next çš„å‚æ•°æ˜¯ä¸€ä¸ª Error å®ä¾‹ï¼Œåˆ™å¯¼èˆªä¼šè¢«ç»ˆæ­¢ä¸”è¯¥é”™è¯¯ä¼šè¢«ä¼ é€’ç»™ router.onError() æ³¨å†Œè¿‡çš„å›è°ƒã€‚ ä¸Šé¢æ¥æ”¶toçš„ç®­å¤´å‡½æ•°å°±å¤„ç†äº†ä¸Šè¿°å‡ ç§åœºæ™¯ é˜Ÿåˆ—ä¸­çš„æ¯ä¸€é¡¹éƒ½ä¼šåœ¨iteratorä¸­è¢«è°ƒç”¨ä¸€æ¬¡å¹¶é€šè¿‡next()åˆ°è·³è½¬åˆ°ä¸‹ä¸€ä¸ªé˜Ÿåˆ—é¡¹çš„æ‰§è¡Œ äº†è§£äº†runQueueã€iteratoråï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹é˜Ÿåˆ—å®é™…æ‰§è¡Œçš„ä»£ç æ˜¯ä»€ä¹ˆæ ·çš„ é˜Ÿåˆ—æ‰§è¡Œ é˜Ÿåˆ—æ‰§è¡Œçš„å®Œæ•´ä»£ç å¦‚ä¸‹ 123456789101112131415161718192021222324252627282930313233// src/history/base.js// æ‰§è¡Œé˜Ÿåˆ—runQueue( queue, iterator, /* æ‰§è¡Œç»“æŸå›è°ƒ*/ () =&gt; &#123; const postEnterCbs = [] // ä¿å­˜beforeRouteEnterä¸­ä¼ ç»™nextçš„å›è°ƒå‡½æ•° const isValid = () =&gt; this.current === route // è¡¨ç¤ºè·³è½¬ç»“æŸ // wait until async components are resolved before // extracting in-component enter guards const enterGuards = extractEnterGuards(activated, postEnterCbs, isValid) // ç­‰å¾…å¼‚æ­¥ç»„ä»¶è§£æå®Œï¼Œå†æŠ½å–ç»„ä»¶å†…çš„beforeRouteEnterå®ˆå« const queue = enterGuards.concat(this.router.resolveHooks) // beforeResolve hooks runQueue( queue, iterator, /* æ‰§è¡Œç»“æŸå›è°ƒ*/ () =&gt; &#123; if (this.pending !== route) &#123; return abort() &#125; this.pending = null onComplete(route) // æ‰§è¡ŒonCompleteå›è°ƒï¼ŒonCompleteä¸­ä¼šè°ƒç”¨updateRouteæ–¹æ³•ï¼Œå†…éƒ¨ä¼šè§¦å‘afterEaché’©å­ if (this.router.app) &#123; this.router.app.$nextTick(() =&gt; &#123; // è°ƒç”¨ beforeRouteEnter å®ˆå«ä¸­ä¼ ç»™ next çš„å›è°ƒå‡½æ•° // next(vm=&gt;xxx) postEnterCbs.forEach((cb) =&gt; &#123; cb() &#125;) &#125;) &#125; &#125; ) &#125;) å¯ä»¥çœ‹åˆ°ï¼Œä¼ å…¥äº†é˜Ÿåˆ—queueã€è¿­ä»£å™¨iteratorä»¥åŠä¸€ä¸ªå…¨éƒ¨æ‰§è¡Œç»“æŸçš„å›è°ƒå‡½æ•° å…ˆå›é¡¾ä¸‹queueé˜Ÿåˆ—ä¸­æœ‰å“ªäº›å…ƒç´  beforeRouteLeaveå®ˆå« å…¨å±€çš„beforeEachå®ˆå« beforeRouteUpdateå®ˆå« beforeEnterå®ˆå« ä»¥åŠä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œæ‰§è¡Œåä¼šè¿”å›è§£æå¼‚æ­¥ç»„ä»¶çš„å‡½æ•° é˜Ÿåˆ—ä¸­çš„å‡½æ•°ä¼šåœ¨é˜Ÿåˆ—æ‰§è¡Œæ—¶ä¾æ¬¡åœ¨iteratorä¸­è¢«è°ƒç”¨ å‰é¢å‡ ä¸ªéƒ½æ˜¯å·²ç»æå–å‡ºæ¥çš„å®ˆå«å‡½æ•°ï¼Œå¯ä»¥åŒæ­¥æ‰§è¡Œ ä½†æ˜¯æœ€åä¸€ä¸ªé«˜é˜¶å‡½æ•°æ‰§è¡Œåï¼Œä¼šè¿”å›ä¸€ä¸ªè§£æå¼‚æ­¥ç»„ä»¶çš„å‡½æ•° å…¶å€ŸåŠ©é—­åŒ…çš„ç‰¹æ€§ï¼Œèƒ½è®¿é—®ä»iteratorä¸­ä¼ å…¥çš„fromã€toã€next ç„¶ååœ¨è§£æå®Œå¼‚æ­¥ç»„ä»¶åè°ƒç”¨nextï¼Œè¿›å…¥é˜Ÿåˆ—ä¸‹ä¸€é¡¹çš„æ‰§è¡Œ è¿™æ ·å°±èƒ½ä¿è¯ï¼Œå³ä½¿é˜Ÿåˆ—ä¸­æœ‰å¼‚æ­¥å‡½æ•°ï¼Œä¹Ÿèƒ½é¡ºåºåœ°å°†é˜Ÿåˆ—æ‰§è¡Œå®Œ åœ¨æ•´ä¸ªå®ˆå«é˜Ÿåˆ—æ‰§è¡Œå®Œåï¼Œå°±ä¼šæ‰§è¡Œç»“æŸå›è°ƒ æ‰§è¡Œç»“æŸå›è°ƒæ—¶ï¼Œæ­¤æ—¶å¼‚æ­¥ç»„ä»¶å·²ç»å…¨éƒ¨è§£æå®Œæ¯•ï¼Œå°±å¯ä»¥æŠ½å–beforeRouteEnteräº† æŠ½å– beforeRouteEnter æŠ½å–beforeRouteEnterå’Œå…¶å®ƒå®ˆå«ç¨å¾®æœ‰ç‚¹ä¸åŒ å› ä¸ºbeforeRouteEnteræ‰€åœ¨çš„ç»„ä»¶å¯èƒ½æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥beforeRouteEnterå¿…é¡»ç­‰åˆ°å¼‚æ­¥ç»„ä»¶è§£æå®Œæ¯•æ‰èƒ½å¼€å§‹æŠ½å– è¿˜æœ‰ä¸€ä¸ªä¸åŒï¼Œå°±æ˜¯åœ¨è·¯ç”±è¿‡æ¸¡åŠ¨ç”»ä¸ºout-inæ—¶ï¼Œå¼‚æ­¥ç»„ä»¶å¯èƒ½å·²ç»è§£æå®Œæ¯•äº†ï¼Œä½†æ˜¯router-viewå®ä¾‹å¯èƒ½è¿˜æœªæ³¨å†Œï¼Œæ­¤æ—¶æ˜¯ä¸èƒ½è°ƒç”¨beforeRouteEnterçš„ï¼›å…·ä½“è§issue #750 å› ä¸ºbeforeRouteEnteræ”¯æŒä¼ ä¸€ä¸ªå›è°ƒç»™nextæ¥è®¿é—®ç»„ä»¶å®ä¾‹ï¼Œå°±åƒä¸‹é¢è¿™æ · 1234beforeRouteEnter (to, from, next) &#123; next(/*postEnterCb*/vm =&gt; &#123; // é€šè¿‡ `vm` è®¿é—®ç»„ä»¶å®ä¾‹ &#125;)&#125; è€Œè¿™ä¸ªvmæ˜¯ä¿å­˜åœ¨router-viewå®ä¾‹ä¸Šçš„ï¼Œæ‰€ä»¥éœ€è¦ç­‰åˆ°router-viewå®ä¾‹å­˜åœ¨æ—¶ï¼Œæ‰èƒ½è°ƒç”¨å›è°ƒ æˆ‘ä»¬çœ‹ä¸‹ä»£ç å®ç° 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576//src/history/base.js...const postEnterCbs = [] // ä¿å­˜beforeRouteEnterä¸­ä¼ ç»™nextçš„å›è°ƒå‡½æ•°const isValid = () =&gt; this.current === route // è¡¨ç¤ºè·³è½¬ç»“æŸ// wait until async components are resolved before// extracting in-component enter guardsconst enterGuards = extractEnterGuards(activated, postEnterCbs, isValid) // ç­‰å¾…å¼‚æ­¥ç»„ä»¶è§£æå®Œï¼Œå†æŠ½å–ç»„ä»¶å†…çš„beforeRouteEnterå®ˆå«...// æå–ç»„ä»¶çš„beforeRouteEnterå®ˆå«function extractEnterGuards ( activated: Array&lt;RouteRecord&gt;, cbs: Array&lt;Function&gt;, // postEnterCbs isValid: () =&gt; boolean): Array&lt;?Function&gt; &#123; return extractGuards( activated, 'beforeRouteEnter', (guard, _, match, key) =&gt; &#123; /* ç»‘å®šbeforeRouteEnterçš„æ‰§è¡Œä¸Šä¸‹æ–‡ */ return bindEnterGuard(guard, match, key, cbs, isValid) &#125; )&#125;// ç»‘å®šbeforeRouteEnterçš„æ‰§è¡Œä¸Šä¸‹æ–‡function bindEnterGuard ( guard: NavigationGuard, match: RouteRecord, key: string, cbs: Array&lt;Function&gt;, // postEnterCbs isValid: () =&gt; boolean): NavigationGuard &#123; // å¯¹ç»„ä»¶å†…çš„beforeRouteEnterè¿›è¡Œäº†åŒ…è£… return function routeEnterGuard (to, from, next) &#123; // è°ƒç”¨ç»„ä»¶å†…beforeRouteEnterå®ˆå« return guard(to, from, /* beforeRouteEnter nextå‡½æ•°ï¼›cbä¸ºnextä¸­å›è°ƒ*/cb =&gt; &#123; if (typeof cb === 'function') &#123; cbs.push(() =&gt; &#123; // #750 // if a router-view is wrapped with an out-in transition, // the instance may not have been registered at this time. // we will need to poll for registration until current route // is no longer valid. // å¦‚æœrouter-viewè¢«out-in transitionåŒ…è£¹ // åœ¨ç¡®è®¤è·¯ç”±ï¼Œå‡†å¤‡è°ƒç”¨beforeRouteEnterå®ˆå«æ—¶ï¼Œrouter-viewå®ä¾‹å¯èƒ½è¿˜ä¸å­˜åœ¨ // ä½†æ˜¯æ­¤æ—¶this.currentå·²ç»ä¸ºto // æ‰€ä»¥å¿…é¡»è½®è¯¢è°ƒç”¨cbç›´åˆ°instanceå­˜åœ¨ poll(cb, match.instances, key, isValid) &#125;) &#125; // è¿­ä»£å™¨ä¸‹æ­¥ next(cb) &#125;) &#125;&#125;// è½®è¯¢è°ƒç”¨cbfunction poll ( cb: any, /* cbä¸ºbeforeRouteEnter nextä¸­å›è°ƒ*/ // somehow flow cannot infer this is a function instances: Object, key: string, isValid: () =&gt; boolean) &#123; if ( instances[key] &amp;&amp; !instances[key]._isBeingDestroyed // do not reuse being destroyed instance ) &#123; cb(instances[key]) &#125; else if (isValid()) &#123; setTimeout(() =&gt; &#123; poll(cb, instances, key, isValid) &#125;, 16) &#125;&#125; å¯ä»¥çœ‹åˆ°åœ¨è°ƒç”¨extractEnterGuardså‰ åœ¨å¤–å±‚å£°æ˜äº†ä¸€ä¸ªpostEnterCbsæ•°ç»„ ç”¨æ¥ä¿å­˜beforeRouteEnterä¸­ä¼ ç»™nextçš„å›è°ƒå‡½æ•°ï¼Œæˆ‘ä»¬ç§°ä¸ºpostEnterCbï¼Œä¹Ÿå°±æ˜¯è¿›å…¥åçš„å›è°ƒ ä»¥åŠä¸€ä¸ªåˆ¤æ–­è·³è½¬æ˜¯å¦ç»“æŸçš„isValidå‡½æ•° isValidå‡½æ•°ä¼šè¢«ä¼ å…¥extractEnterGuardsä¸­ extractEnterGuardsä¸­é€šè¿‡é«˜é˜¶å‡½æ•°å½¢å¼è¿”å›ä¸€ä¸ªåŒ…è£…äº†beforeRouteEnterçš„å…·åå‡½æ•°routeEnterGuardï¼Œå…¶ä¼šåœ¨æ‰§è¡Œé˜Ÿåˆ—æ—¶è¢«è°ƒç”¨ï¼Œå¹¶æ‰§è¡ŒçœŸæ­£çš„beforeRouteEnterå®ˆå«guard guardåœ¨è¢«æ‰§è¡Œæ—¶ï¼Œä¼šæ¥æ”¶fromã€toä»¥åŠä¸€ä¸ªè¢«â€™æ”¹é€ â€™è¿‡çš„nextï¼Œå…¶æ¥æ”¶ä¸€ä¸ªpostEnterCb è¿™ä¸ªpostEnterCbå¯èƒ½åœ¨å°†æ¥éœ€è¦è®¿é—®vm æ‰€ä»¥å°†postEnterCbç”¨pollæ–¹æ³•åŒ…è£¹å¡å…¥åœ¨å¤–é¢å®šä¹‰å¥½çš„postEnterCbsæ•°ç»„ä¸­ pollæ–¹æ³•ä¸»è¦æ˜¯ç”¨æ¥è§£å†³å‰é¢æåˆ°çš„issue #750çš„ï¼Œå®ƒä¼šä¸€ç›´è½®è¯¢ï¼Œç›´åˆ°router-viewå®ä¾‹å­˜åœ¨æ—¶ï¼Œå†è°ƒç”¨postEnterCbå¹¶ä¼ å…¥æŒ‚è½½åˆ°router-viewä¸Šçš„ç»„ä»¶å®ä¾‹ è¿™æ ·å°±å®ç°äº†nextä¸­èƒ½è®¿é—®åˆ°ç»„ä»¶å®ä¾‹çš„é€»è¾‘ æŠ½å–å®ŒbeforeRouteEnterå®ˆå«å’Œå…¶ä¸­çš„postEnterCbsåï¼Œåˆåœ¨queueåæ‹¼æ¥äº†beforeResolveå®ˆå« 12const enterGuards = extractEnterGuards(activated, postEnterCbs, isValid) // ç­‰å¾…å¼‚æ­¥ç»„ä»¶è§£æå®Œï¼Œå†æŠ½å–ç»„ä»¶å†…çš„beforeRouteEnterå®ˆå«const queue = enterGuards.concat(this.router.resolveHooks) // beforeResolve hooks æ­¤æ—¶queueä¸­æ˜¯routeEnterGuardå‡½æ•°åŠresolveHook ç„¶åæ‰§è¡Œæ­¤é˜Ÿåˆ—ï¼Œé˜Ÿåˆ—ä¸­çš„routerEnterGuardå’ŒresolveHookä¼šæ‰§è¡Œ 1234567891011121314151617181920runQueue( queue, iterator, /* æ‰§è¡Œç»“æŸå›è°ƒ*/ () =&gt; &#123; if (this.pending !== route) &#123; return abort() &#125; this.pending = null onComplete(route) // æ‰§è¡ŒonCompleteå›è°ƒï¼ŒonCompleteä¸­ä¼šè°ƒç”¨updateRouteæ–¹æ³•ï¼Œå†…éƒ¨ä¼šè§¦å‘afterEaché’©å­ if (this.router.app) &#123; this.router.app.$nextTick(() =&gt; &#123; // è°ƒç”¨ beforeRouteEnter å®ˆå«ä¸­ä¼ ç»™ next çš„å›è°ƒå‡½æ•° // next(vm=&gt;xxx) postEnterCbs.forEach((cb) =&gt; &#123; cb() &#125;) &#125;) &#125; &#125;) æ‰§è¡Œçš„é€»è¾‘å’Œä¹‹å‰ç±»ä¼¼ï¼ŒbeforeRouteEnterå’ŒbeforeResolveä¼šè¢«ä¾æ¬¡è°ƒç”¨ï¼Œç„¶åæ‰§è¡Œé˜Ÿåˆ—ç»“æŸå›è°ƒ é˜Ÿåˆ—ç»“æŸå›è°ƒä¸­ä¼šè°ƒç”¨onCompleteå¹¶ä¼ å…¥ç›®æ ‡Routeå¹¶åœ¨$nextTickä¸­éå†ä¹‹å‰ä¿å­˜çš„postEnterCbsï¼Œå³ä¼ å…¥nextçš„å›è°ƒ æ­¤å¤„çš„onCompleteæ˜¯ç¡®è®¤è·¯ç”±æ—¶(confirmTransition)ä¼ å…¥çš„ 123456789101112131415161718192021// src/history/base.js transitionToæ–¹æ³•ä¸­ this.confirmTransition( route, () =&gt; &#123; // onCompleteï¼Œå®Œæˆ this.updateRoute(route) // æ›´æ–°routeï¼Œä¼šè§¦å‘afterEaché’©å­ onComplete &amp;&amp; onComplete(route) // è°ƒç”¨onCompleteå›è°ƒ this.ensureURL() // fire ready cbs once // è§¦å‘readyå›è°ƒ if (!this.ready) &#123; this.ready = true this.readyCbs.forEach(cb =&gt; &#123; cb(route) &#125;) &#125; &#125;, // onAbortå›è°ƒ err=&gt;&#123;...&#125; ) å¯ä»¥çœ‹åˆ°å…¶è°ƒç”¨updateRouteæ¥æ›´æ–°routeï¼Œè¿™ä¼šè§¦å‘afterEaché’©å­ è°ƒç”¨ensureURLæ›´æ–° url å¹¶è°ƒç”¨ä¼ å…¥transitionToçš„onCompleteå‡½æ•°ï¼Œä¸»è¦ç”¨æ¥åœ¨vue-routeråˆå§‹åŒ–æ—¶ä¸ºhashæ¨¡å¼åšåˆå§‹åŒ–ç»‘å®š(setupHashListener) æœ€åè§¦å‘é€šè¿‡onReadyæ³¨å†Œçš„readyCbså›è°ƒ 1234567891011// src/history/base.js // æ›´æ–°è·¯ç”±ï¼Œè§¦å‘afterEaché’©å­ updateRoute (route: Route) &#123; const prev = this.current this.current = route// æ›´æ–°current this.cb &amp;&amp; this.cb(route) // è°ƒç”¨updateRouteå›è°ƒï¼Œå›è°ƒä¸­ä¼šé‡æ–°ä¸º_routerRoot._routeèµ‹å€¼ï¼Œè¿›è€Œè§¦å‘router-viewçš„é‡æ–°æ¸²æŸ“ this.router.afterHooks.forEach(hook =&gt; &#123; // è§¦å‘afterEachç‹—å­ hook &amp;&amp; hook(/* to*/route, /* from*/prev) &#125;) &#125; updateRouteä¼šè°ƒç”¨Historyä¸Šé€šè¿‡listenæ–¹æ³•æ³¨å†Œçš„æ›´æ–°å›è°ƒï¼Œè§¦å‘roter-viewçš„é‡æ–°æ¸²æŸ“ è¿™äº›æ›´æ–°å›è°ƒæ˜¯åœ¨vue-routeråˆå§‹åŒ–æ—¶æ³¨å†Œçš„ 123456// src/index.js inithistory.listen((route) =&gt; &#123; this.apps.forEach((app) =&gt; &#123; app._route = route // æ›´æ–°route &#125;)&#125;) ç„¶åæ‰§è¡Œæ‰€æœ‰afterEaché’©å­ è‡³æ­¤ä¸€æ¬¡å®Œæ•´çš„è·¯ç”±è·³è½¬å®Œæˆï¼Œç›¸åº”çš„å®ˆå«åŠé’©å­ä¹Ÿè§¦å‘å®Œæˆ æ€»ç»“ æ•´ä¸ªå¯¼èˆªçš„è§£æ(ç¡®è®¤)ï¼Œå…¶å®å°±æ˜¯ä»ä¸åŒçŠ¶æ€çš„è·¯ç”±è®°å½•ä¸­æŠ½å–å‡ºå¯¹åº”çš„å®ˆå«åŠé’©å­ ç„¶åç»„æˆé˜Ÿåˆ—ï¼Œä½¿ç”¨runQueueã€iteratorå·§å¦™çš„å®Œæˆå®ˆå«çš„æ‰§è¡Œ å¹¶åœ¨å…¶ä¸­å¤„ç†äº†å¼‚æ­¥ç»„ä»¶çš„è§£æã€postEnterCbä¸­å®ä¾‹è·å–çš„é—®é¢˜ æ•´ä¸ªå®ˆå«ã€é’©å­çš„æ‰§è¡Œæµç¨‹å¦‚ä¸‹ å¯¼èˆªè¢«è§¦å‘ã€‚ åœ¨å¤±æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteLeave å®ˆå«ã€‚ è°ƒç”¨å…¨å±€çš„ beforeEach å®ˆå«ã€‚ åœ¨é‡ç”¨çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteUpdate å®ˆå« (2.2+)ã€‚ åœ¨è·¯ç”±é…ç½®é‡Œè°ƒç”¨ beforeEnterã€‚ è§£æå¼‚æ­¥è·¯ç”±ç»„ä»¶ã€‚ åœ¨è¢«æ¿€æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteEnterã€‚ è°ƒç”¨å…¨å±€çš„ beforeResolve å®ˆå« (2.5+)ã€‚ å¯¼èˆªè¢«ç¡®è®¤ã€‚ è°ƒç”¨å…¨å±€çš„ afterEach é’©å­ã€‚ è§¦å‘ DOM æ›´æ–°ã€‚ ç”¨åˆ›å»ºå¥½çš„å®ä¾‹è°ƒç”¨ beforeRouteEnter å®ˆå«ä¸­ä¼ ç»™ next çš„å›è°ƒå‡½æ•°ã€‚ å‚è€ƒ https://github.com/dwqs/blog/issues/53 https://github.com/dwqs/blog/issues/54 https://github.com/dwqs/blog/issues/55 https://github.com/vuejs/vue-router/issues/2184#issuecomment-393484643 https://juejin.im/post/5e456513f265da573c0c6d4b https://juejin.im/post/584040e1ac502e006cbedb23 https://juejin.im/post/5df0ada0f265da33d56d1a2f https://juejin.im/post/5dbed0bef265da4cff701f68 https://www.jianshu.com/p/29e8214d0bee https://ustbhuangyi.github.io/vue-analysis/v2/vue-router/ https://blog.liuyunzhuge.com/2020/04/08/vue-router æºç ï¼šcreate-matcher/ PS åé¢è¿˜ä¼šä»‹ç»å…¶ä½™éƒ¨åˆ†ï¼Œå¦‚æœè§‰å¾—è¿˜è¡Œï¼Œå¯ä»¥ç»™ä¸ªèµå“¦ âœ¨ ä¸ªäººgithubï¼Œä¹Ÿæ€»ç»“äº†ä¸€äº›ä¸œè¥¿ï¼Œæ¬¢è¿ star åŸºäº canvas çš„ç»˜å›¾æ¿drawing-board å‰ç«¯å…¥é—¨ demoã€æœ€ä½³å®è·µé›†åˆ fe-awesome-demos ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆåˆ«åçš„vue-cli-pluginhttps://www.npmjs.com/package/vue-cli-plugin-auto-alias npm åŒ… vue-cli-plugin-auto-alias @bryanadamss/drawing-board @bryanadamss/num2chn ant-color-converter äº¤æµ å¦‚æœæœ‰é—®é¢˜ï¼Œå¯ä»¥åŠ å¾®ä¿¡äº¤æµï¼Œå…±åŒæˆé•¿ï¼Œå…±åŒè¿›æ­¥~]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>vue-router</tag>
        <tag>æºç è§£æ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vue-cli-mode]]></title>
    <url>%2F2020%2F06%2F22%2Fvue-cli-mode%2F</url>
    <content type="text"><![CDATA[vue-cli4 modeã€NODE_ENVã€webpack mode æœ€è¿‘ä½¿ç”¨vue-cli4åˆå§‹åŒ–äº†ä¸€ä¸ªé¡¹ç›®ï¼Œå¯¹å…¶ä¸­modeã€NODE_ENVã€webpack modeçš„å…³ç³»æœ‰ç‚¹è¿· æ‰€ä»¥èŠ±äº†ç‚¹æ—¶é—´æ•´ç†äº†ä¸‹ vue-cli4 ç¯å¢ƒå˜é‡å£°æ˜ç¯å¢ƒå˜é‡ vue-cliå¯é€šè¿‡.envå‰ç¼€çš„ç¯å¢ƒæ–‡ä»¶æ¥å£°æ˜ç¯å¢ƒå˜é‡ 123# .envFoo=BarVUE_APP_TITLE=æ ‡é¢˜ è¢«è½½å…¥çš„å˜é‡å°†ä¼šå¯¹vue-cli-serviceçš„æ‰€æœ‰å‘½ä»¤ã€æ’ä»¶å’Œä¾èµ–å¯ç”¨ å®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨çš„ç¯å¢ƒå˜é‡ åœ¨å®¢æˆ·ç«¯(src/ç›®å½•ä¸‹)å¯ä»¥ä½¿ç”¨process.env.XXXæ¥å¼•ç”¨ç¯å¢ƒå˜é‡ï¼Œä¸»è¦æœ‰ä¸‹é¢çš„å˜é‡å¯ä»¥å¼•ç”¨ ç¯å¢ƒæ–‡ä»¶ä¸­ä»¥VUE_APP_å¼€å¤´çš„ç¯å¢ƒå˜é‡ NODE_ENV ï¼Œ ä¼šæ˜¯ developmentã€production æˆ– test ä¸­çš„ä¸€ä¸ª BASE_URLï¼Œä¼šå’Œ vue.config.js ä¸­çš„ publicPath é€‰é¡¹ç›¸ç¬¦ vue-cli modeé»˜è®¤ mode modeå¯ä»¥ç†è§£ä¸ºvue-cliè¿è¡Œçš„ä¸€ä¸ªç¯å¢ƒï¼Œä¸€ä¸ªæ ‡å¿—é‡ï¼›å†…éƒ¨çš„æ’ä»¶ä¾èµ–æ­¤å˜é‡æ¥å†³å®šæ˜¯å¦å¯ç”¨ vue-cli modeé»˜è®¤åªä¼šæœ‰developmentã€productionã€testä¸‰ç§å–å€¼ development ä¼šåœ¨è°ƒç”¨vue-cli-service serveå‘½ä»¤æ—¶ï¼Œmodeè¢«è®¾ç½®ä¸ºdevelopment production ä¼šåœ¨è°ƒç”¨vue-cli-service build å’Œvue-cli-service test:e2eå‘½ä»¤æ—¶ï¼Œmodeè¢«è®¾ç½®ä¸ºproduction test ä¼šåœ¨è°ƒç”¨vue-cli-service test:unitå‘½ä»¤æ—¶ï¼Œmodeè¢«è®¾ç½®ä¸ºtest æ¯ä¸ªæ¨¡å¼éƒ½ä¼šå°†NODE_ENV çš„å€¼è®¾ç½®ä¸ºæ¨¡å¼çš„åç§°â€”â€”æ¯”å¦‚åœ¨ development æ¨¡å¼ä¸‹ NODE_ENV çš„å€¼ä¼šè¢«è®¾ç½®ä¸ºdevelopment è¦†ç›–ã€è‡ªå®šä¹‰ mode å¯ä»¥ä½¿ç”¨vue-cli-service xxx --mode customæ¥è¦†ç›–åŸæœ‰mode(è‡ªå®šä¹‰ mode) vue-cli mode å’Œç¯å¢ƒæ–‡ä»¶çš„å…³ç³» å½“æŒ‡å®šäº†modeæ—¶(æ— è®ºæ˜¯å‘½ä»¤é»˜è®¤å€¼è¿˜æ˜¯--mode è‡ªå®šä¹‰çš„) ä¼šå»é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰¾åˆ°.env.[mode]æ–‡ä»¶ï¼Œè¯»å–å¹¶è®¾ç½®å…¶ä¸­çš„ç¯å¢ƒå˜é‡ å¦‚æœmodeçš„å€¼æ˜¯é™¤developmentã€productionã€testä»¥å¤–çš„å€¼ï¼Œåˆ™éœ€è¦åœ¨ç¯å¢ƒæ–‡ä»¶ä¸­æ‰‹åŠ¨æŒ‡å®šNODE_ENVå€¼ï¼Œè¿™æ ·vue-cliå†…éƒ¨çš„æ’ä»¶æ‰çŸ¥é“éœ€è¦å·¥ä½œåœ¨å“ªç§ç¯å¢ƒä¸‹ ä¾‹å­ vue-cli-service build --mode stagingï¼Œä½¿ç”¨--modeè¦†ç›–äº†é»˜è®¤çš„productionæ¨¡å¼ï¼Œåˆ™éœ€è¦åœ¨.env.stagingç¯å¢ƒæ–‡ä»¶ä¸­æ‰‹åŠ¨æŒ‡å®šNODE_ENV 123# .env.stagingNODE_ENV=productionVUE_APP_TITLE=My App (staging) vue-cli modeå’ŒNODE_ENVåŠwebpack modeä¸‰è€…é—´æ˜¯å¦‚ä½•äº’åŠ¨ï¼Œä¸‹é¢ä¼šè§£é‡Š vue-cli modeã€NODE_ENVã€webpack mode ä¸‰è€…çš„å…³ç³»webpack mode webpack ä» 4 å¼€å§‹ï¼Œæ”¯æŒmodeé€‰é¡¹ï¼Œæ ¹æ®modeè‡ªåŠ¨å¼€å¯ä¸€äº›æ’ä»¶å’Œä¼˜åŒ– modeçš„å¯é€‰å€¼æœ‰ development å‘ŠçŸ¥webpackå¯ç”¨ NamedChunksPlugin å’Œ NamedModulesPlugin production å‘ŠçŸ¥webpackå¯ç”¨ FlagDependencyUsagePluginã€ FlagIncludedChunksPlugin ã€ModuleConcatenationPluginã€NoEmitOnErrorsPluginã€OccurrenceOrderPluginã€SideEffectsFlagPluginã€UglifyJsPlugin å¯ç”¨å‹ç¼©ã€ä¼˜åŒ– vue-cliå†…éƒ¨ä¼šä½¿ç”¨åˆ°webpackï¼Œæ‰€ä»¥ä¹Ÿéœ€è¦è®¾ç½®webpack mode ä¸‰è€…å…³ç³» é¦–å…ˆåœ¨vue-cliä¸­NODE_ENVé»˜è®¤è¢«è®¾ç½®ä¸ºdevelopmentï¼Œé™¤évue-cli modeä¸ºproductionæˆ–è€…test å…¶æ¬¡ï¼Œç¯å¢ƒæ–‡ä»¶ä¸­çš„NODE_ENVå…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§ï¼Œå³å¦‚æœç¯å¢ƒæ–‡ä»¶ä¸­ä¹Ÿæœ‰è®¾ç½®NODE_ENVï¼Œåˆ™ä¼šè¦†ç›–ä¸Šä¸€æ­¥çš„NODE_ENV æœ€åwebpack modeæ˜¯æ ¹æ®ä¸Šä¸€æ­¥çš„NODE_ENVå€¼æ¥ç¡®å®šçš„ï¼Œåªè¦å€¼ä¸æ˜¯productionï¼Œåˆ™webpackéƒ½ä¼šè¿è¡Œåœ¨developmentæ¨¡å¼ ä¾‹å­ 1 vue-cli-service serve modeåˆå§‹ä¸ºdevelopmentï¼ŒNODE_ENVåˆå§‹ä¸ºdevelopment .env.development 1NODE_ENV=production # è¢«è¦†ç›–ä¸ºproduction NODE_ENVæœ€ç»ˆä¸ºproductionï¼Œæ‰€ä»¥webpack modeæœ€ç»ˆä¸ºproductionï¼Œä¼šå¯ç”¨å‹ç¼©ã€ä¼˜åŒ–ç­‰è¡Œä¸º ä¾‹å­ 2 vue-cli-service build --mode staging é€šè¿‡cliå‚æ•°è¦†ç›–é»˜è®¤modeï¼Œæ­¤æ—¶modeä¸ºstaging .env.staging 123# æœªè®¾ç½®NODE_ENVVUE_APP_TITLE=æ ‡é¢˜ ç”±äºä½¿ç”¨äº†è‡ªå®šä¹‰modeã€ç¯å¢ƒæ–‡ä»¶ä¸­åˆæ²¡æœ‰è®¾ç½®NODE_ENVï¼Œå¯¼è‡´NODE_ENVä¸ºé»˜è®¤å€¼developmentã€æ‰€ä»¥webpack modeä¸ºdevelopmentï¼Œå¹¶ä¸ä¼šå¯ç”¨å‹ç¼©ç­‰è¡Œä¸º ä¾‹å­ 3 vue-cli-service build --mode staging é€šè¿‡cliå‚æ•°è¦†ç›–é»˜è®¤modeï¼Œæ­¤æ—¶modeä¸ºstaging .env.staging 12NODE_ENV=production # è®¾ç½®NODE_ENVVUE_APP_TITLE=æ ‡é¢˜ ç¯å¢ƒæ–‡ä»¶ä¸­è®¾ç½®äº†NODE_ENV=productionï¼Œæ‰€ä»¥webpack modeä¸ºproduction ä¾‹å­ 4 vue-cli-service build --mode staging é€šè¿‡cliå‚æ•°è¦†ç›–é»˜è®¤modeï¼Œæ­¤æ—¶modeä¸ºstaging .env.staging 12NODE_ENV=staging # è®¾ç½®NODE_ENVä¸ºéproductionã€developmentã€testçš„å€¼VUE_APP_TITLE=æ ‡é¢˜ ç¯å¢ƒæ–‡ä»¶ä¸­è®¾ç½®äº†NODE_ENV=stagingï¼Œæ‰€ä»¥webpack modeä¼šè¿è¡Œåœ¨é»˜è®¤developmentç¯å¢ƒä¸‹ å‚è€ƒ https://github.com/vuejs/vue-cli/blob/dev/packages/%40vue/cli-service/lib/Service.js#L111 https://github.com/vuejs/vue-cli/issues/4699 https://github.com/vuejs/vue-cli/issues/4743]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>vue-cli</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vue-router-analysis-part1]]></title>
    <url>%2F2020%2F04%2F27%2Fvue-router-analysis-part1%2F</url>
    <content type="text"><![CDATA[vue-router æºç è§£æ | 1.3w å­— | å¤šå›¾é¢„è­¦ - ã€ä¸Šã€‘ å„ä½å¥½ï¼Œæˆ‘æ˜¯å…‰è¾‰ ğŸ˜ vue-routeræ˜¯æ¯ä¸ªvueå¼€å‘è€…éƒ½ä¼šæ¥è§¦åˆ°çš„ä¸€ä¸ªæ’ä»¶ æœ¬ç€è¿½æœ¬æº¯æºçš„ç†å¿µï¼Œæˆ‘å¼€å¯äº†vue-routeræºç åˆ†æä¹‹è·¯ ğŸ˜‚ å¤©å¤©åŠ ç­ï¼Œæ‰€ä»¥å‰å‰ååèŠ±äº†å¥½å‡ ä¸ªæœˆæ—¶é—´ æ—¶é—´æ‹–çš„å¾ˆé•¿ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨æ€è·¯ä¸è¿è´¯çš„æƒ…å†µï¼Œè¿˜æœ›è§è°… ğŸ¤£ ç”±äºæ˜é‡‘å­—æ•°é™åˆ¶ï¼Œæ‰€ä»¥åˆ†ä¸ºä¸Šä¸­ä¸‹ä¸‰ç¯‡æ¥ä»‹ç» ä¸Šç¯‡å³æœ¬ç¯‡ï¼Œä¸»è¦ä»‹ç»äº†å‰ç«¯è·¯ç”±çš„è®¾è®¡æ€è·¯åŠå®ç°åŸºæœ¬åŸåˆ™ã€vue-routerçš„ç›¸å…³æœ¯è¯­ã€ç›®å½•ç»“æ„ã€å®‰è£…ã€å®ä¾‹åŒ–ã€åˆå§‹åŒ–ç›¸å…³å®ç° ä¸­ç¯‡ä»‹ç»äº†å…¶æ ¸å¿ƒç‰¹æ€§è·¯ç”±åŒ¹é…ã€å¯¼èˆªå®ˆå«è§¦å‘çš„æœºåˆ¶ ä¸‹ç¯‡ä¸ºæ”¶å°¾ç¯‡ï¼Œä»‹ç»äº†ä¸€äº›éæ ¸å¿ƒç‰¹æ€§ï¼Œå¦‚æ»šåŠ¨å¤„ç†ã€view,linkç»„ä»¶çš„å®ç° ç¬¬ä¸€æ¬¡åšæºç è§£æï¼Œè‚¯å®šæœ‰å¾ˆå¤šé”™è¯¯æˆ–ç†è§£ä¸åˆ°ä½çš„åœ°æ–¹ï¼Œæ¬¢è¿æŒ‡æ­£ ğŸ¤ é¡¹ç›®åœ°å€ https://github.com/BryanAdamss/vue-router-for-analysis å¦‚æœè§‰å¾—å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè®°å¾—ç»™æˆ‘ä¸€ä¸ªstarâœ¨ uml å›¾æºæ–‡ä»¶ https://github.com/BryanAdamss/vue-router-for-analysis/blob/dev/vue-router.EAP å…³è”æ–‡ç« é“¾æ¥ vue-router æºç è§£æ | 1.3w å­— | å¤šå›¾é¢„è­¦ - ã€ä¸Šã€‘ vue-router æºç è§£æ | 1.5w å­— | å¤šå›¾é¢„è­¦ - ã€ä¸­ã€‘ vue-router æºç è§£æ | 6k å­— - ã€ä¸‹ã€‘ è®¾è®¡æ€è·¯ åœ¨è§£ævue-routerè¿™ä¸ªè·¯ç”±åº“å‰ï¼Œæˆ‘ä»¬è¦äº†è§£ä»€ä¹ˆæ˜¯è·¯ç”±ï¼Œä»€ä¹ˆæ˜¯å‰ç«¯è·¯ç”±ï¼Ÿå®ç°å‰ç«¯è·¯ç”±çš„å¸¸è§„å¥—è·¯æ˜¯ä»€ä¹ˆï¼Ÿ ä»€ä¹ˆæ˜¯å‰ç«¯è·¯ç”± å…³äºè·¯ç”±çš„å®šä¹‰ï¼Œç»´åŸºæ˜¯è¿™æ ·å®šä¹‰çš„ï¼›è·¯ç”±ï¼ˆroutingï¼‰å°±æ˜¯é€šè¿‡äº’è”çš„ç½‘ç»œæŠŠä¿¡æ¯ä»æºåœ°å€ä¼ è¾“åˆ°ç›®çš„åœ°å€çš„æ´»åŠ¨ã€‚è·¯ç”±å‘ç”Ÿåœ¨OSIç½‘ç»œå‚è€ƒæ¨¡å‹ä¸­çš„ç¬¬ä¸‰å±‚å³ç½‘ç»œå±‚ã€‚è·¯ç”±å¼•å¯¼åˆ†ç»„è½¬é€ï¼Œç»è¿‡ä¸€äº›ä¸­é—´çš„èŠ‚ç‚¹åï¼Œåˆ°å®ƒä»¬æœ€åçš„ç›®çš„åœ°ã€‚ä½œæˆç¡¬ä»¶çš„è¯ï¼Œåˆ™ç§°ä¸ºè·¯ç”±å™¨ã€‚è·¯ç”±é€šå¸¸æ ¹æ®è·¯ç”±è¡¨â€”â€”ä¸€ä¸ªå­˜å‚¨åˆ°å„ä¸ªç›®çš„åœ°çš„æœ€ä½³è·¯å¾„çš„è¡¨â€”â€”æ¥å¼•å¯¼åˆ†ç»„è½¬é€ ä¸Šé¢çš„å®šä¹‰å¯èƒ½å¾ˆå®˜æ–¹ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æŠ½å‡ºä¸€äº›é‡ç‚¹ è·¯ç”±æ˜¯ä¸€ç§æ´»åŠ¨ï¼Œè´Ÿè´£å°†ä¿¡æ¯ä»æºåœ°å€ä¼ è¾“åˆ°ç›®çš„åœ°å€ï¼› è¦å®Œæˆè¿™æ ·ä¸€ä¸ªæ´»åŠ¨éœ€è¦ä¸€ä¸ªå¾ˆé‡è¦çš„ä¸œè¥¿è·¯ç”±è¡¨-æºåœ°å€å’Œç›®æ ‡åœ°å€çš„æ˜ å°„è¡¨ åœ¨webåå°å¼€å‘ä¸­ï¼Œâ€œrouteâ€æ˜¯æŒ‡æ ¹æ®urlåˆ†é…åˆ°å¯¹åº”çš„å¤„ç†ç¨‹åºã€‚ï¼›å¼•ç”¨è‡ªhttps://www.zhihu.com/question/46767015@è´ºå¸ˆä¿Š ç”¨æˆ·è¾“å…¥ä¸€ä¸ª urlï¼Œæµè§ˆå™¨ä¼ é€’ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯åŒ¹é…æ˜ å°„è¡¨ï¼Œæ‰¾åˆ°å¯¹åº”çš„å¤„ç†ç¨‹åºï¼Œè¿”å›å¯¹åº”çš„èµ„æº(é¡µé¢ or å…¶å®ƒ)ï¼› å¯¹äºå‰ç«¯æ¥è¯´ï¼Œè·¯ç”±æ¦‚å¿µçš„å‡ºç°æ˜¯ä¼´éšç€spaå‡ºç°çš„ï¼›åœ¨spaå‡ºç°ä¹‹å‰ï¼Œé¡µé¢çš„è·³è½¬(å¯¼èˆª)éƒ½æ˜¯é€šè¿‡æœåŠ¡ç«¯æ§åˆ¶çš„ï¼Œå¹¶ä¸”è·³è½¬å­˜åœ¨ä¸€ä¸ªæ˜æ˜¾ç™½å±è·³è½¬è¿‡ç¨‹ï¼›spaå‡ºç°åï¼Œä¸ºäº†æ›´å¥½çš„ä½“éªŒï¼Œå°±æ²¡æœ‰å†è®©æœåŠ¡ç«¯æ§åˆ¶è·³è½¬äº†ï¼Œäºæ˜¯å‰ç«¯è·¯ç”±å‡ºç°äº†ï¼Œå‰ç«¯å¯ä»¥è‡ªç”±æ§åˆ¶ç»„ä»¶çš„æ¸²æŸ“ï¼Œæ¥æ¨¡æ‹Ÿé¡µé¢è·³è½¬ å°ç»“ æœåŠ¡ç«¯è·¯ç”±æ ¹æ®urlåˆ†é…å¯¹åº”å¤„ç†ç¨‹åºï¼Œè¿”å›é¡µé¢ã€æ¥å£è¿”å› å‰ç«¯è·¯ç”±æ˜¯é€šè¿‡jsæ ¹æ®urlè¿”å›å¯¹å¯¹åº”ç»„ä»¶ å¦‚ä½•å®ç°å‰ç«¯è·¯ç”± çœ‹äº†ä¸Šé¢çš„å®šä¹‰ï¼Œè¦å®ç°è·¯ç”±ï¼Œéœ€è¦ä¸€ä¸ªå¾ˆé‡è¦çš„ä¸œè¥¿-è·¯ç”±æ˜ å°„è¡¨ï¼› æœåŠ¡ç«¯åšè·¯ç”±é¡µé¢è·³è½¬æ—¶ï¼Œæ˜ å°„è¡¨çš„åæ˜ çš„æ˜¯urlå’Œé¡µé¢çš„å…³ç³» ç°åœ¨å‰ç«¯åŸºæœ¬èµ°æ¨¡å—åŒ–äº†ï¼Œæ‰€ä»¥å‰ç«¯çš„è·¯ç”±æ˜ å°„è¡¨åæ˜ çš„æ˜¯urlå’Œç»„ä»¶çš„å…³ç³» å°±åƒä¸‹é¢çš„ä¼ªä»£ç ä¸€æ · 12345678910111213// ä½¿ç”¨es6 mapconst routeMap = new Map([ ['/', é¦–é¡µç»„ä»¶], ['/bar', Barç»„ä»¶], ['/bar/foo', Fooç»„ä»¶],])// ä½ ä¹Ÿå¯ä»¥ç”¨å¯¹è±¡å­—é¢é‡const routeMap = &#123; '/': é¦–é¡µç»„ä»¶, '/bar': Barç»„ä»¶, '/bar/foo': Fooç»„ä»¶,&#125; æœ‰äº†æ˜ å°„è¡¨ï¼Œæˆ‘ä»¬å°±çŸ¥é“urlå’Œç»„ä»¶çš„æ˜ å°„å…³ç³»ï¼› ä½†æ˜¯ï¼Œæ˜ å°„è¡¨ç»´æŠ¤çš„åªæ˜¯ä¸€ä¸ªå…³ç³»ï¼Œå¹¶ä¸èƒ½å¸®æˆ‘ä»¬å®Œæˆï¼Œè®¿é—®/barï¼Œè¿”å›Barç»„ä»¶è¿™æ ·ä¸€ä¸ªæµç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªåŒ¹é…å™¨ï¼Œæ¥å¸®æˆ‘ä»¬å®Œæˆä»urlåˆ°ç»„ä»¶çš„åŒ¹é…å·¥ä½œï¼› æ˜¯ä¸æ˜¯æœ‰äº†è·¯ç”±æ˜ å°„è¡¨å’ŒåŒ¹é…å™¨å°±å¯ä»¥å®ç°å‰ç«¯è·¯ç”±äº†å‘¢ï¼Ÿ æˆ‘ä»¬çš„spaæ˜¯è¿è¡Œåœ¨æµè§ˆå™¨ç¯å¢ƒä¸­çš„ï¼Œæµè§ˆå™¨æ˜¯æœ‰å‰è¿›ã€è¿”å›åŠŸèƒ½çš„ï¼Œéœ€è¦æˆ‘ä»¬è®°å½•è®¿é—®è¿‡çš„urlï¼› æˆ‘ä»¬çŸ¥é“ï¼Œè¦å®ç°è¿™ç§ç±»ä¼¼æ’¤é”€ã€æ¢å¤çš„åŠŸèƒ½ï¼Œè‚¯å®šéœ€è¦ä½¿ç”¨åˆ°ä¸€ç§æ•°æ®ç»“æ„-æ ˆ(stack)ï¼›æ¯è®¿é—®ä¸€ä¸ªurlï¼Œå°†urlï¼Œpushåˆ°æ ˆä¸­ï¼Œè¿”å›æ—¶ï¼Œæ‰§è¡Œpopå³å¯æ‹¿åˆ°ä¸Šä¸€æ¬¡è®¿é—®çš„url å¥½åœ¨æµè§ˆå™¨å¹³å°ï¼Œå·²ç»ç»™æˆ‘ä»¬æä¾›äº†è¿™æ ·çš„æ ˆï¼Œæ— éœ€æˆ‘ä»¬è‡ªå·±å®ç°ï¼Œæˆ‘ä»¬åªéœ€è¦å»è°ƒç”¨å®ƒçš„æ¥å£window.historyå®ç°åŠŸèƒ½å³å¯ ç”»äº†ä¸ªå›¾ï¼Œæè¿°äº†ä¸‹ä¸‰è€…åä½œå…³ç³» sequence.png å½“æˆ‘ä»¬è®¿é—®æŸä¸ª url æ—¶ï¼Œå¦‚/fooï¼ŒåŒ¹é…å™¨ä¼šæ‹¿ç€/fooå»è·¯ç”±æ˜ å°„è¡¨ä¸­å»æŸ¥æ‰¾å¯¹åº”çš„ç»„ä»¶ï¼Œå¹¶å°†ç»„ä»¶è¿”å›æ¸²æŸ“ï¼ŒåŒæ—¶å°†è®¿é—®è®°å½•æ¨å…¥å†å²æ ˆä¸­ å½“æˆ‘ä»¬é€šè¿‡å‰è¿›/åé€€å»è®¿é—®æŸä¸ªurlæ—¶ï¼Œä¼šå…ˆä»å†å²æ ˆä¸­æ‰¾åˆ°å¯¹åº”urlï¼Œç„¶ååŒ¹é…å™¨æ‹¿urlå»æ‰¾ç»„ä»¶ï¼Œå¹¶è¿”å›æ¸²æŸ“ï¼›åªä¸è¿‡ï¼Œè¿™æ˜¯é€šè¿‡å‰è¿›/åé€€å®ç°è®¿é—®çš„ï¼Œæ‰€ä»¥ä¸éœ€è¦å†æ¨å…¥å†å²æ ˆäº† æ€»ç»“ è¦å®ç°ä¸€ä¸ªå‰ç«¯è·¯ç”±ï¼Œéœ€è¦ä¸‰ä¸ªéƒ¨åˆ† è·¯ç”±æ˜ å°„è¡¨ ä¸€ä¸ªèƒ½è¡¨è¾¾urlå’Œç»„ä»¶å…³ç³»çš„æ˜ å°„è¡¨ï¼Œå¯ä»¥ä½¿ç”¨Mapã€å¯¹è±¡å­—é¢é‡æ¥å®ç° åŒ¹é…å™¨ è´Ÿè´£åœ¨è®¿é—®urlæ—¶ï¼Œè¿›è¡ŒåŒ¹é…ï¼Œæ‰¾å‡ºå¯¹åº”çš„ç»„ä»¶ å†å²è®°å½•æ ˆ æµè§ˆå™¨å¹³å°ï¼Œå·²ç»åŸç”Ÿæ”¯æŒï¼Œæ— éœ€å®ç°ï¼Œç›´æ¥è°ƒç”¨æ¥å£ ç°åœ¨ä¸ç”¨çº ç»“ä»–ä»¬çš„å…·ä½“å®ç°ï¼Œä½ åªéœ€è¦çŸ¥é“æœ‰è¿™ä¸‰ä¸ªä¸œè¥¿ï¼Œå¹¶ä¸”ä»–ä»¬å¤§æ¦‚æ˜¯å¦‚ä½•åä½œçš„å°±å¯ä»¥äº†ï¼› åé¢æˆ‘ä»¬å°†ä¸€èµ·çœ‹çœ‹vue-routerå¦‚ä½•åˆ©ç”¨ä»–ä»¬å®ç°å‰ç«¯è·¯ç”±çš„ æœ¯è¯­ åœ¨åˆ†ævue-routeræºç å‰ï¼Œæˆ‘ä»¬å…ˆäº†è§£ä¸‹vue-routerä¸­å¸¸å‡ºç°çš„ä¸€äº›æ¦‚å¿µæœ¯è¯­ï¼Œå¦‚æœç†è§£èµ·æ¥åƒåŠ›ï¼Œå¯ä»¥å…ˆè·³è¿‡ï¼Œåé¢é‡åˆ°ï¼Œå†å›æ¥çœ‹ï¼› è·¯ç”±è§„åˆ™ã€é…ç½®å¯¹è±¡(RouteConfig) è·¯ç”±çš„é…ç½®é¡¹ï¼Œç”¨æ¥æè¿°è·¯ç”± ä¸‹å›¾çº¢æ¡†é‡Œé¢æ ‡å‡ºæ¥çš„éƒ½æ˜¯è·¯ç”±é…ç½®å¯¹è±¡ route-config.png å› ä¸ºvue-routeræ˜¯æ”¯æŒåµŒå¥—è·¯ç”±çš„ï¼Œæ‰€ä»¥é…ç½®å¯¹è±¡ä¹Ÿæ˜¯å¯ä»¥ç›¸äº’åµŒå¥—çš„ å®Œæ•´çš„å½¢çŠ¶å¦‚ä¸‹ 12345678910111213141516interface RouteConfig = &#123; path: string, component?: Component,// è·¯ç”±ç»„ä»¶ name?: string, // å‘½åè·¯ç”± components?: &#123; [name: string]: Component &#125;, // å‘½åè§†å›¾ç»„ä»¶ redirect?: string | Location | Function, props?: boolean | Object | Function, alias?: string | Array&lt;string&gt;, children?: Array&lt;RouteConfig&gt;, // åµŒå¥—è·¯ç”± beforeEnter?: (to: Route, from: Route, next: Function) =&gt; void, meta?: any, // 2.6.0+ caseSensitive?: boolean, // åŒ¹é…è§„åˆ™æ˜¯å¦å¤§å°å†™æ•æ„Ÿï¼Ÿ(é»˜è®¤å€¼ï¼šfalse) pathToRegexpOptions?: Object // ç¼–è¯‘æ­£åˆ™çš„é€‰é¡¹&#125; è·¯ç”±è®°å½•(RouteRecord) æ¯ä¸€æ¡è·¯ç”±è§„åˆ™éƒ½ä¼šç”Ÿæˆä¸€æ¡è·¯ç”±è®°å½•ï¼›åµŒå¥—ã€åˆ«åè·¯ç”±ä¹Ÿéƒ½ä¼šç”Ÿæˆä¸€æ¡è·¯ç”±è®°å½•ï¼›æ˜¯è·¯ç”±æ˜ å°„è¡¨çš„ç»„æˆéƒ¨åˆ† 12345678910111213141516171819const record: RouteRecord = &#123; path: normalizedPath, regex: compileRouteRegex(normalizedPath, pathToRegexpOptions), // åˆ©ç”¨path-to-regexpåŒ…ç”Ÿæˆç”¨æ¥åŒ¹é…pathçš„å¢å¼ºæ­£åˆ™å¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥åŒ¹é…åŠ¨æ€è·¯ç”± components: route.components || &#123; default: route.component &#125;, // ä¿å­˜è·¯ç”±ç»„ä»¶ï¼Œæ”¯æŒå‘½åè§†å›¾https://router.vuejs.org/zh/guide/essentials/named-views.html#å‘½åè§†å›¾ instances: &#123;&#125;, // ä¿å­˜æ¯ä¸ªå‘½årouter-viewéœ€è¦æ¸²æŸ“çš„è·¯ç”±ç»„ä»¶ name, parent, matchAs, redirect: route.redirect, // é‡å®šå‘çš„è·¯ç”±é…ç½®å¯¹è±¡ beforeEnter: route.beforeEnter, // è·¯ç”±ç‹¬äº«çš„å®ˆå« meta: route.meta || &#123;&#125;, // å…ƒä¿¡æ¯ // åŠ¨æ€è·¯ç”±ä¼ å‚ï¼›https://router.vuejs.org/zh/guide/essentials/passing-props.html#è·¯ç”±ç»„ä»¶ä¼ å‚ props: route.props == null ? &#123;&#125; : route.components // å‘½åè§†å›¾çš„ä¼ å‚è§„åˆ™éœ€è¦ä½¿ç”¨route.propsæŒ‡å®šçš„è§„åˆ™ ? route.props : &#123; default: route.props &#125;,&#125; è·¯ç”±å¯¹è±¡(Route) Routeè¡¨ç¤ºå½“å‰æ¿€æ´»çš„è·¯ç”±çš„çŠ¶æ€ä¿¡æ¯ï¼ŒåŒ…å«äº†å½“å‰ URL è§£æå¾—åˆ°çš„ä¿¡æ¯ï¼Œè¿˜æœ‰ URL åŒ¹é…åˆ°çš„è·¯ç”±è®°å½•ä»¬ (route records)ã€‚ https://router.vuejs.org/zh/api/#è·¯ç”±å¯¹è±¡ æ³¨æ„ï¼Œè¿™è¯´æ˜ä¸€ä¸ªRouteå¯ä»¥å…³è”å¤šä¸ªRouteRecord é€šè¿‡this.$routeè®¿é—®åˆ°çš„å°±æ˜¯Routeå¯¹è±¡ route.png è·¯ç”±å¯¹è±¡æ˜¯ä¸å¯å˜ (immutable) çš„ï¼Œæ¯æ¬¡æˆåŠŸçš„å¯¼èˆªåéƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„å¯¹è±¡ ä½ç½®(Location) å®ƒå¹¶ä¸æ˜¯window.locationçš„å¼•ç”¨ï¼Œvue-routeråœ¨å†…éƒ¨å®šä¹‰äº†ä¸€ä¸ªLocationï¼Œæ˜¯ä¸€ä¸ªç”¨æ¥æè¿°ç›®æ ‡ä½ç½®çš„å¯¹è±¡ï¼› $router.push/replaceã€router-linkçš„toæ¥æ”¶çš„å°±æ˜¯Locationå¯¹è±¡ https://router.vuejs.org/zh/api/#to vue-routerå†…éƒ¨å¯ä»¥å°†ä¸€ä¸ªurl stringè½¬æ¢æˆLocationå¯¹è±¡ï¼Œæ‰€ä»¥ç¡®åˆ‡çš„è¯´$router.push/replaceã€router-linkçš„toæ¥æ”¶çš„éƒ½æ˜¯ä¸€ä¸ªRawLocationå¯¹è±¡ RawLocationå¯¹è±¡æ˜¯Stringå’ŒLocationçš„è”åˆç±»å‹ 1234567891011export type RawLocation = string | Locationexport interface Location &#123; name?: string path?: string hash?: string query?: Dictionary&lt;string | (string | null)[] | null | undefined&gt; params?: Dictionary&lt;string&gt; append?: boolean replace?: boolean&#125; è·¯ç”±ç»„ä»¶(RouteComponent) å½“è·¯ç”±æˆåŠŸåŒ¹é…æ—¶ï¼Œå°±éœ€è¦åœ¨router-viewæ¸²æŸ“ä¸€ä¸ªç»„ä»¶ï¼Œè¿™ä¸ªéœ€è¦è¢«æ¸²æŸ“çš„ç»„ä»¶å°±æ˜¯è·¯ç”±ç»„ä»¶ RouteConfigä¸­componentã€componentsä¸­å®šä¹‰çš„vueç»„ä»¶å°±æ˜¯è·¯ç”±ç»„ä»¶ è·¯ç”±ç»„ä»¶çš„ç‰¹æ®Šæ€§ æ‹¥æœ‰åªåœ¨è·¯ç”±ç»„ä»¶ä¸­ç”Ÿæ•ˆçš„å®ˆå«(beforeRouteEnter ã€beforeRouteUpdateã€beforeRouteLeave) ä½ æ˜¯å¦è·Ÿæˆ‘ä¸€æ ·ï¼Œæ›¾ç»åœ¨ç»„ä»¶ä¸­è°ƒç”¨beforeRouteEnterå‘ç°æ²¡æœ‰ç”Ÿæ•ˆï¼Œé‚£æ˜¯å› ä¸ºè¿™ä¸ªå®ˆå«åªèƒ½åœ¨è·¯ç”±ç»„ä»¶ä¸­è¢«è°ƒç”¨ï¼Œåœ¨æ‰€æœ‰éè·¯ç”±ç»„ä»¶ä¸­éƒ½ä¸ä¼šè¢«è°ƒç”¨ï¼ŒåŒ…æ‹¬è·¯ç”±ç»„ä»¶çš„åä»£ç»„ä»¶ï¼›ä½ å¦‚æœæƒ³åœ¨è·¯ç”±ç»„ä»¶ä¸­å®ç°beforeRouteEnterç±»ä¼¼å®ˆå«ç›‘å¬æ•ˆæœï¼Œå¯ä»¥é€šè¿‡watch $routeæ¥æ‰‹åŠ¨åˆ¤æ–­ çº¢æ¡†æ ‡è®°å‡ºæ¥çš„æ˜¯è·¯ç”±ç»„ä»¶ route-component.png çœ‹å®Œä¸Šé¢çš„æœ¯è¯­ï¼Œä½ å¯èƒ½è¿˜æ˜¯äº‘é‡Œé›¾é‡Œçš„ï¼Œæ²¡äº‹ï¼Œåé¢ä¼šè¯¦è§£ï¼Œç°åœ¨ä½ åªéœ€è¦æœ‰ä¸ªå¤§æ¦‚äº†è§£å³å¯; ç¯å¢ƒ vue-routerç‰ˆæœ¬:v3.1.6 nodeç‰ˆæœ¬:v8.17.0 åˆ†æä»“åº“åœ°å€:https://github.com/BryanAdamss/vue-router-for-analysis åˆ’é‡ç‚¹ æ³¨æ„æŸ¥çœ‹commitè®°å½•ï¼Œcommitè®°å½•äº†æˆ‘æ•´ä¸ªåˆ†æçš„æµç¨‹ å¦‚æœä½ è§‰å¾—è¿˜å¯ä»¥ï¼Œä¸è¦å¿˜è®°starã€forkğŸ¤ ç›®å½•ç»“æ„ é¦–å…ˆæˆ‘ä»¬å°†vue-routerä»“åº“cloneä¸‹æ¥ï¼Œçœ‹ä¸‹ç›®å½•ç»“æ„å¤§æ¦‚æ˜¯ä»€ä¹ˆæ ·çš„ git clone git@github.com:BryanAdamss/vue-router-for-analysis.git ç›®å½• å¯ä»¥çœ‹åˆ°ä¼šæœ‰å¦‚ä¸‹ç›®å½• directory.png åˆ«çœ‹ç›®å½•å¤šä¹ˆå¤šï¼Œå…¶å®æˆ‘å·²ç»ç»™ä½ åˆ’äº†é‡ç‚¹ æˆ‘ä»¬å…¶å®åªéœ€è¦å…³æ³¨ä¸‹é¢å‡ ä¸ªç›®å½•æˆ–æ–‡ä»¶ examples è¿™é‡Œé¢å­˜æ”¾äº†å®˜æ–¹ç²¾å¿ƒå‡†å¤‡çš„æ¡ˆä¾‹ ä¸ä»…å‘Šè¯‰ä½ vue-routeræœ‰å“ªäº›åŸºç¡€ç‰¹æ€§ï¼Œè¿˜ä¼šå‘Šè¯‰ä½ æ€ä¹ˆåº”å¯¹ä¸€äº›å¤æ‚åœºæ™¯ï¼Œä¾‹å¦‚æƒé™æ§åˆ¶ã€åŠ¨æ€æ·»åŠ è·¯ç”±ç­‰ï¼›æ€»ä¹‹ï¼Œå€¼å¾—ä½ å»ä¸€æ¢ç©¶ç«Ÿï¼› examples.png å¦å¤–ï¼Œæˆ‘ä»¬åœ¨åˆ†ææºç çš„æ—¶å€™ï¼Œè¿˜å¯ä»¥åˆ©ç”¨è¿™äº›ä¾‹å­è¿›è¡Œè°ƒè¯• åœ¨æºç ä½ æƒ³è°ƒè¯•å¤„æ·»åŠ debuggeræ–­ç‚¹æ ‡è¯†ï¼Œç„¶åå¯åŠ¨ä¾‹å­npm run devï¼Œæ‰“å¼€localhost:8080å³å¯ srcç›®å½• è¿™æ˜¯vue-routeræºç å­˜æ”¾çš„ç›®å½•ï¼Œæ˜¯æˆ‘ä»¬éœ€è¦é‡ç‚¹å…³æ³¨çš„åœ°æ–¹ src.png æ¡å‡ ä¸ªé‡è¦ç›®å½•å…ˆè¯´ä¸‹ componentsç›®å½•æ˜¯å­˜æ”¾å†…ç½®ç»„ä»¶router-linkã€router-viewçš„ historyæ˜¯å­˜æ”¾æ ¸å¿ƒhistoryç±»çš„åœ°æ–¹ utilä¸­å­˜æ”¾çš„æ˜¯ä¸€äº›è¾…åŠ©å‡½æ•° index.jsæ˜¯vue-routerçš„å…¥å£æ–‡ä»¶ï¼Œä¹Ÿæ˜¯vue-routerç±»å®šä¹‰çš„åœ°æ–¹ install.jsæ˜¯å®‰è£…é€»è¾‘æ‰€åœ¨æ–‡ä»¶ flow/declarations.js å®ƒæ˜¯vue-routerçš„ flow ç±»å‹å£°æ˜æ–‡ä»¶ï¼Œé€šè¿‡å®ƒæˆ‘ä»¬èƒ½çŸ¥é“vue-routerä¸­å‡ ä¸ªæ ¸å¿ƒç±»(å¯¹è±¡)æ˜¯é•¿ä»€ä¹ˆæ ·çš„ å®ƒé‡Œé¢ï¼Œå¤§æ¦‚é•¿è¿™æ · declarations.png åŸºç¡€ä¾‹å­ æˆ‘ä»¬ä»æœ€åŸºç¡€çš„ä¾‹å­å¼€å§‹çœ‹ 12345678910111213141516171819202122232425262728293031323334353637383940import Vue from 'vue'import VueRouter from 'vue-router'// 1. Use plugin.// å®‰è£…æ’ä»¶Vue.use(VueRouter)// 2. Define route components// å®šä¹‰è·¯ç”±ç»„ä»¶const Home = &#123; template: '&lt;div&gt;home&lt;/div&gt;' &#125;const Foo = &#123; template: '&lt;div&gt;foo&lt;/div&gt;' &#125;const Bar = &#123; template: '&lt;div&gt;bar&lt;/div&gt;' &#125;// 3. Create the router// å®ä¾‹åŒ–vue-routerconst router = new VueRouter(&#123; mode: 'history', routes: [ &#123; path: '/', component: Home &#125;, &#123; path: '/foo', component: Foo &#125;, &#123; path: '/bar', component: Bar &#125;, ],&#125;)// 4. Create and mount root instance.new Vue(&#123; router, // æ³¨å…¥routerå®ä¾‹ template: ` &lt;div id="app"&gt; &lt;h1&gt;Basic&lt;/h1&gt; &lt;ul&gt; &lt;li&gt;&lt;router-link to="/"&gt;/&lt;/router-link&gt;&lt;/li&gt; &lt;li&gt;&lt;router-link to="/foo"&gt;/foo&lt;/router-link&gt;&lt;/li&gt; &lt;li&gt;&lt;router-link to="/bar"&gt;/bar&lt;/router-link&gt;&lt;/li&gt; &lt;/ul&gt; &lt;router-view class="view"&gt;&lt;/router-view&gt; &lt;/div&gt; `,&#125;).$mount('#app') å¯ä»¥çœ‹åˆ°ï¼Œé¦–å…ˆä½¿ç”¨vueçš„æ’ä»¶è¯­æ³•å®‰è£…äº†vue-routerï¼› ç„¶åæˆ‘ä»¬å†å®ä¾‹åŒ–VueRouterï¼› æœ€åæˆ‘ä»¬å°†VueRouterçš„å®ä¾‹æ³¨å…¥åˆ°Vue è¿™å…¶å®å°±æ¶‰åŠåˆ°ä¸‰ä¸ªæ ¸å¿ƒæµç¨‹ï¼šå®‰è£…ã€å®ä¾‹åŒ–ã€åˆå§‹åŒ– æˆ‘ä»¬å…ˆä»è¿™ä¸‰ä¸ªæµç¨‹è®²èµ· å®‰è£…æµç¨‹ æˆ‘ä»¬çŸ¥é“ï¼Œåªè¦æ˜¯vue pluginï¼Œè‚¯å®šéƒ½ä¼šæœ‰ä¸€ä¸ªinstallæ–¹æ³•; https://cn.vuejs.org/v2/guide/plugins.html#å¼€å‘æ’ä»¶ ä¸Šé¢ä¹Ÿæåˆ°vue-routerçš„å…¥å£æ–‡ä»¶åœ¨src/index.jsä¸­ï¼Œé‚£æˆ‘ä»¬å»index.jsä¸­æ‰¾æ‰¾installæ–¹æ³• 1234567891011121314151617181920// src/index.js/* @flow */import &#123; install &#125; from './install' // å¯¼å…¥å®‰è£…æ–¹æ³•...// VueRouterç±»export default class VueRouter &#123; ... &#125;...VueRouter.install = install // æŒ‚è½½å®‰è£…æ–¹æ³•ï¼ŒVue.useæ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨installæ–¹æ³•VueRouter.version = '__VERSION__'// æµè§ˆå™¨ç¯å¢ƒï¼Œè‡ªåŠ¨å®‰è£…VueRouterif (inBrowser &amp;&amp; window.Vue) &#123; window.Vue.use(VueRouter)&#125; å¯ä»¥çœ‹åˆ°ï¼Œå¼€å¤´å¯¼å…¥äº†installæ–¹æ³•ï¼Œå¹¶å°†å…¶åšä¸ºé™æ€æ–¹æ³•ç›´æ¥æŒ‚è½½åˆ°VueRouterä¸Šï¼Œè¿™æ ·ï¼Œåœ¨Vue.use(VueRouter)æ—¶ï¼Œinstallæ–¹æ³•å°±ä¼šè¢«è°ƒç”¨ï¼› å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœåœ¨æµè§ˆå™¨ç¯å¢ƒï¼Œå¹¶ä¸”é€šè¿‡scriptæ ‡ç­¾çš„å½¢å¼å¼•å…¥Vueæ—¶(ä¼šåœ¨windowä¸ŠæŒ‚è½½Vueå…¨å±€å˜é‡)ï¼Œä¼šå°è¯•è‡ªåŠ¨ä½¿ç”¨VueRouter æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹çœ‹install.jsä¸­æ˜¯ä»€ä¹ˆ install.js installæ–¹æ³•å¹¶ä¸é•¿ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566import View from './components/view'import Link from './components/link'export let _Vue // ç”¨æ¥é¿å…å°†Vueåšä¸ºä¾èµ–æ‰“åŒ…è¿›æ¥// installæ–¹æ³•export function install(Vue) &#123; if (install.installed &amp;&amp; _Vue === Vue) return // é¿å…é‡å¤å®‰è£… install.installed = true _Vue = Vue // ä¿ç•™Vueå¼•ç”¨ const isDef = (v) =&gt; v !== undefined // ä¸ºrouter-viewç»„ä»¶å…³è”è·¯ç”±ç»„ä»¶ const registerInstance = (vm, callVal) =&gt; &#123; let i = vm.$options._parentVnode // è°ƒç”¨vm.$options._parentVnode.data.registerRouteInstanceæ–¹æ³• // è€Œè¿™ä¸ªæ–¹æ³•åªåœ¨router-viewç»„ä»¶ä¸­å­˜åœ¨ï¼Œrouter-viewç»„ä»¶å®šä¹‰åœ¨(../components/view.js @71è¡Œ) // æ‰€ä»¥ï¼Œå¦‚æœvmçš„çˆ¶èŠ‚ç‚¹ä¸ºrouter-viewï¼Œåˆ™ä¸ºrouter-viewå…³è”å½“å‰vmï¼Œå³å°†å½“å‰vmåšä¸ºrouter-viewçš„è·¯ç”±ç»„ä»¶ if ( isDef(i) &amp;&amp; isDef((i = i.data)) &amp;&amp; isDef((i = i.registerRouteInstance)) ) &#123; i(vm, callVal) &#125; &#125; // æ³¨å†Œå…¨å±€æ··å…¥ Vue.mixin(&#123; beforeCreate() &#123; // this === new Vue(&#123;router:router&#125;) === Vueæ ¹å®ä¾‹ // åˆ¤æ–­æ˜¯å¦ä½¿ç”¨äº†vue-routeræ’ä»¶ if (isDef(this.$options.router)) &#123; // åœ¨Vueæ ¹å®ä¾‹ä¸Šä¿å­˜ä¸€äº›ä¿¡æ¯ this._routerRoot = this // ä¿å­˜æŒ‚è½½VueRouterçš„Vueå®ä¾‹ï¼Œæ­¤å¤„ä¸ºæ ¹å®ä¾‹ this._router = this.$options.router // ä¿å­˜VueRouterå®ä¾‹ï¼Œthis.$options.routerä»…å­˜åœ¨äºVueæ ¹å®ä¾‹ä¸Šï¼Œå…¶å®ƒVueç»„ä»¶ä¸åŒ…å«æ­¤å±æ€§ï¼Œæ‰€ä»¥ä¸‹é¢çš„åˆå§‹åŒ–ï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡ // beforeCreate hookè¢«è§¦å‘æ—¶ï¼Œè°ƒç”¨ this._router.init(this) // åˆå§‹åŒ–VueRouterå®ä¾‹ï¼Œå¹¶ä¼ å…¥Vueæ ¹å®ä¾‹ // å“åº”å¼å®šä¹‰_routeå±æ€§ï¼Œä¿è¯_routeå‘ç”Ÿå˜åŒ–æ—¶ï¼Œç»„ä»¶(router-view)ä¼šé‡æ–°æ¸²æŸ“ Vue.util.defineReactive(this, '_route', this._router.history.current) &#125; else &#123; // å›æº¯æŸ¥æ‰¾_routerRoot this._routerRoot = (this.$parent &amp;&amp; this.$parent._routerRoot) || this &#125; // ä¸ºrouter-viewç»„ä»¶å…³è”è·¯ç”±ç»„ä»¶ registerInstance(this, this) &#125;, destroyed() &#123; // destroyed hookè§¦å‘æ—¶ï¼Œå–æ¶ˆrouter-viewå’Œè·¯ç”±ç»„ä»¶çš„å…³è” registerInstance(this) &#125;, &#125;) // åœ¨åŸå‹ä¸Šæ³¨å…¥$routerã€$routeå±æ€§ï¼Œæ–¹ä¾¿å¿«æ·è®¿é—® Object.defineProperty(Vue.prototype, '$router', &#123; get() &#123; return this._routerRoot._router &#125;, &#125;) Object.defineProperty(Vue.prototype, '$route', &#123; // æ¯ä¸ªç»„ä»¶è®¿é—®åˆ°çš„$routeï¼Œå…¶å®æœ€åè®¿é—®çš„éƒ½æ˜¯Vueæ ¹å®ä¾‹çš„_route get() &#123; return this._routerRoot._route &#125;, &#125;) // æ³¨å†Œrouter-viewã€router-linkå…¨å±€ç»„ä»¶ Vue.component('RouterView', View) Vue.component('RouterLink', Link) const strats = Vue.config.optionMergeStrategies // use the same hook merging strategy for route hooks strats.beforeRouteEnter = strats.beforeRouteLeave = strats.beforeRouteUpdate = strats.created&#125; å¯ä»¥çœ‹åˆ°ï¼Œinstallæ–¹æ³•å¹²äº†ä¸‹é¢å‡ ä»¶äº‹ é¿å…é‡å¤å®‰è£… é€šè¿‡æ·»åŠ installedæ ‡è¯†æ¥åˆ¤æ–­æ˜¯å¦é‡å¤å®‰è£… ä¿ç•™Vueå¼•ç”¨ï¼Œé¿å…å°†Vueåšä¸ºä¾èµ–æ‰“åŒ… installæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œä¼šå°†Vueåšä¸ºå‚æ•°ä¼ å…¥ï¼ŒVueä¼šè¢«èµ‹å€¼ç»™äº‹å…ˆå®šä¹‰å¥½çš„_Vueå˜é‡ åœ¨å…¶å®ƒæ¨¡å—ä¸­ï¼Œå¯ä»¥å¯¼å…¥è¿™ä¸ª_Vueï¼Œè¿™æ ·æ—¢èƒ½è®¿é—®åˆ°Vueï¼Œåˆé¿å…äº†å°†Vueåšä¸ºä¾èµ–æ‰“åŒ… è¿™æ˜¯ä¸€ä¸ªæ’ä»¶å¼€å‘å®ç”¨å°æŠ€å·§ æ³¨å†Œäº†ä¸€ä¸ªå…¨å±€æ··å…¥ è¿™ä¸ªæ··å…¥å°†å½±å“æ³¨å†Œä¹‹åæ‰€æœ‰åˆ›å»ºçš„æ¯ä¸ª Vue å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯åé¢æ¯ä¸ªVueå®ä¾‹éƒ½ä¼šæ‰§è¡Œæ··å…¥ä¸­çš„ä»£ç  æˆ‘ä»¬çœ‹ä¸‹æ··å…¥ä¸­çš„ä»£ç  123456789101112131415161718192021222324// æ³¨å†Œå…¨å±€æ··å…¥Vue.mixin(&#123; beforeCreate() &#123; // this === new Vue(&#123;router:router&#125;) === Vueæ ¹å®ä¾‹ // åˆ¤æ–­æ˜¯å¦ä½¿ç”¨äº†vue-routeræ’ä»¶ if (isDef(this.$options.router)) &#123; // åœ¨Vueæ ¹å®ä¾‹ä¸Šä¿å­˜ä¸€äº›ä¿¡æ¯ this._routerRoot = this // ä¿å­˜æŒ‚è½½VueRouterçš„Vueå®ä¾‹ï¼Œæ­¤å¤„ä¸ºæ ¹å®ä¾‹ this._router = this.$options.router // ä¿å­˜VueRouterå®ä¾‹ï¼Œthis.$options.routerä»…å­˜åœ¨äºVueæ ¹å®ä¾‹ä¸Šï¼Œå…¶å®ƒVueç»„ä»¶ä¸åŒ…å«æ­¤å±æ€§ï¼Œæ‰€ä»¥ä¸‹é¢çš„åˆå§‹åŒ–ï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡ // beforeCreate hookè¢«è§¦å‘æ—¶ï¼Œè°ƒç”¨ this._router.init(this) // åˆå§‹åŒ–VueRouterå®ä¾‹ï¼Œå¹¶ä¼ å…¥Vueæ ¹å®ä¾‹ // å“åº”å¼å®šä¹‰_routeå±æ€§ï¼Œä¿è¯_routeå‘ç”Ÿå˜åŒ–æ—¶ï¼Œç»„ä»¶(router-view)ä¼šé‡æ–°æ¸²æŸ“ Vue.util.defineReactive(this, '_route', this._router.history.current) &#125; else &#123; // å›æº¯æŸ¥æ‰¾_routerRoot this._routerRoot = (this.$parent &amp;&amp; this.$parent._routerRoot) || this &#125; // ä¸ºrouter-viewç»„ä»¶å…³è”è·¯ç”±ç»„ä»¶ registerInstance(this, this) &#125;, destroyed() &#123; // destroyed hookè§¦å‘æ—¶ï¼Œå–æ¶ˆrouter-viewå’Œè·¯ç”±ç»„ä»¶çš„å…³è” registerInstance(this) &#125;,&#125;) å®ƒæ³¨å†Œäº†ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸé’©å­beforeCreateå’Œdestroyedï¼› æ³¨æ„ åœ¨è¿™ä¸¤ä¸ªé’©å­ä¸­ï¼Œthisæ˜¯æŒ‡å‘å½“æ—¶æ­£åœ¨è°ƒç”¨é’©å­çš„vueå®ä¾‹ï¼› è¿™ä¸¤ä¸ªé’©å­ä¸­çš„é€»è¾‘ï¼Œåœ¨å®‰è£…æµç¨‹ä¸­æ˜¯ä¸ä¼šè¢«æ‰§è¡Œçš„ï¼Œåªæœ‰åœ¨ç»„ä»¶å®ä¾‹åŒ–æ—¶æ‰§è¡Œåˆ°é’©å­æ—¶æ‰ä¼šè¢«è°ƒç”¨ æˆ‘ä»¬å…ˆçœ‹beforeCreateé’©å­ å®ƒå…ˆåˆ¤æ–­äº†this.$options.routeræ˜¯å¦å­˜åœ¨ï¼Œæˆ‘ä»¬åœ¨new Vue({router})æ—¶ï¼Œrouterå·²ç»è¢«ä¿å­˜åˆ°åˆ°Vueæ ¹å®ä¾‹çš„$optionsä¸Šï¼Œè€Œå…¶å®ƒVueå®ä¾‹çš„$optionsä¸Šæ˜¯æ²¡æœ‰routerçš„ æ‰€ä»¥ifä¸­çš„è¯­å¥åªåœ¨this === new Vue({router})æ—¶ï¼Œæ‰ä¼šè¢«æ‰§è¡Œï¼Œç”±äºVueæ ¹å®ä¾‹åªæœ‰ä¸€ä¸ªï¼Œæ‰€ä»¥è¿™ä¸ªé€»è¾‘åªä¼šè¢«æ‰§è¡Œä¸€æ¬¡ æˆ‘ä»¬å¯ä»¥åœ¨ifä¸­æ‰“å°thiså¹¶ç»“åˆè°ƒè¯•å·¥å…·çœ‹çœ‹ root-instance.png çš„ç¡®ï¼Œifä¸­çš„é€»è¾‘åªæ‰§è¡Œäº†ä¸€æ¬¡ï¼Œå¹¶ä¸”thiså°±æ˜¯æŒ‡å‘Vueæ ¹å®ä¾‹ æˆ‘ä»¬çœ‹ä¸‹ifä¸­å…·ä½“å¹²äº†ä»€ä¹ˆ åœ¨æ ¹å®ä¾‹ä¸Šä¿å­˜äº†_routerRootï¼Œç”¨æ¥æ ‡è¯†routeræŒ‚è½½çš„Vueå®ä¾‹ åœ¨æ ¹å®ä¾‹ä¸Šä¿å­˜äº†VueRouterå®ä¾‹(router) å¯¹routerè¿›è¡Œäº†åˆå§‹åŒ–(init) routeråˆå§‹åŒ–é€»è¾‘æˆ‘ä»¬åé¢ç»†çœ‹ åœ¨æ ¹å®ä¾‹ä¸Šï¼Œå“åº”å¼å®šä¹‰äº†_routeå±æ€§ ä¿è¯_routeå˜åŒ–æ—¶ï¼Œrouter-viewä¼šé‡æ–°æ¸²æŸ“ï¼Œè¿™ä¸ªæˆ‘ä»¬åé¢åœ¨router-viewç»„ä»¶ä¸­ä¼šç»†è®² æˆ‘ä»¬å†çœ‹ä¸‹elseä¸­å…·ä½“å¹²äº†å•¥ ä¸»è¦æ˜¯ä¸ºæ¯ä¸ªç»„ä»¶å®šä¹‰_routerRootï¼Œé‡‡ç”¨çš„æ˜¯é€å±‚å‘ä¸Šçš„å›æº¯æŸ¥æ‰¾æ–¹å¼ æˆ‘ä»¬çœ‹åˆ°è¿˜æœ‰ä¸ªregisterInstanceæ–¹æ³•ï¼Œå®ƒåœ¨beforeCreateã€destroyedéƒ½æœ‰è¢«è°ƒç”¨ï¼Œåªæ˜¯å‚æ•°ä¸ªæ•°ä¸ä¸€æ · åœ¨beforeCreateä¸­ä¼ å…¥äº†ä¸¤ä¸ªå‚æ•°ï¼Œä¸”éƒ½æ˜¯thiså³å½“å‰vueå®ä¾‹ï¼Œè€Œåœ¨destroyedä¸­åªä¼ å…¥äº†ä¸€ä¸ªvueå®ä¾‹ æˆ‘ä»¬åœ¨è®²router-viewæ—¶ä¼šç»†è®²ï¼Œä½ åªéœ€è¦çŸ¥é“å®ƒæ˜¯ç”¨æ¥ä¸ºrouter-viewç»„ä»¶å…³è”æˆ–è§£ç»‘è·¯ç”±ç»„ä»¶ç”¨çš„å³å¯ ä¼ å…¥ä¸¤ä¸ªå‚æ•°å³å…³è”ï¼Œä¼ å…¥ä¸€ä¸ªå‚æ•°å³è§£ç»‘ æ·»åŠ å®ä¾‹å±æ€§ã€æ–¹æ³• åœ¨VueåŸå‹ä¸Šæ³¨å…¥$routerã€$routeå±æ€§ï¼Œæ–¹ä¾¿åœ¨vueå®ä¾‹ä¸­é€šè¿‡this.$routerã€this.$routeå¿«æ·è®¿é—® æ³¨å†Œ router-viewã€router-link å…¨å±€ç»„ä»¶ é€šè¿‡Vue.componentè¯­æ³•æ³¨å†Œäº†router-viewå’Œrouter-linkä¸¤ä¸ªå…¨å±€ç»„ä»¶ è®¾ç½®è·¯ç”±ç»„ä»¶å®ˆå«çš„åˆå¹¶ç­–ç•¥ è®¾ç½®è·¯ç”±ç»„ä»¶çš„beforeRouteEnterã€beforeRouteLeaveã€beforeRouteUpdateå®ˆå«çš„åˆå¹¶ç­–ç•¥ æ€»ç»“ æˆ‘ä»¬ç”¨ä¸€å¼ å›¾ï¼Œæ€»ç»“ä¸€ä¸‹å®‰è£…æµç¨‹ install.png å®ä¾‹åŒ–æµç¨‹ çœ‹å®Œå®‰è£…æµç¨‹ï¼Œæˆ‘ä»¬ç´§æ¥ç€æ¥çœ‹ä¸‹VueRouterçš„å®ä¾‹åŒ–è¿‡ç¨‹ è¿™ä¸€èŠ‚ï¼Œé‡ç‚¹å…³æ³¨å®ä¾‹åŒ–è¿‡ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬åªçœ‹constructorä¸­çš„æ ¸å¿ƒé€»è¾‘ VueRouter çš„æ„é€ å‡½æ•° æˆ‘ä»¬æ‰“å¼€src/index.jsçœ‹ä¸‹VueRouteræ„é€ å‡½æ•° 12345678910111213141516171819202122232425262728293031323334353637383940// src/index.jsexport default class VueRouter &#123; constructor(options: RouterOptions = &#123;&#125;) &#123; this.app = null // ä¿å­˜æŒ‚è½½å®ä¾‹ this.apps = [] // VueRouteræ”¯æŒå¤šå®ä¾‹ this.options = options this.beforeHooks = [] // æ¥æ”¶ beforeEach hook this.resolveHooks = [] // æ¥æ”¶ beforeResolve hook this.afterHooks = [] // æ¥æ”¶ afterEach hook this.matcher = createMatcher(options.routes || [], this) // åˆ›å»ºè·¯ç”±matcherå¯¹è±¡ï¼Œä¼ å…¥routesè·¯ç”±é…ç½®åˆ—è¡¨åŠVueRouterå®ä¾‹ let mode = options.mode || 'hash' this.fallback = mode === 'history' &amp;&amp; !supportsPushState &amp;&amp; options.fallback !== false // æ˜¯å¦å›é€€ if (this.fallback) &#123; mode = 'hash' &#125; // éæµè§ˆå™¨ç¯å¢ƒï¼Œå¼ºåˆ¶ä½¿ç”¨abstractæ¨¡å¼ if (!inBrowser) &#123; mode = 'abstract' &#125; this.mode = mode // æ ¹æ®ä¸åŒmodeï¼Œå®ä¾‹åŒ–ä¸åŒhistoryå®ä¾‹ switch (mode) &#123; case 'history': this.history = new HTML5History(this, options.base) break case 'hash': this.history = new HashHistory(this, options.base, this.fallback) break case 'abstract': this.history = new AbstractHistory(this, options.base) break default: if (process.env.NODE_ENV !== 'production') &#123; assert(false, `invalid mode: $&#123;mode&#125;`) &#125; &#125; &#125;&#125; æ„é€ å‡½æ•°ä¸»è¦å¹²äº†ä¸‹é¢å‡ ä»¶äº‹ æ¥æ”¶ RouterOptions å¯ä»¥çœ‹åˆ°ï¼Œæ„é€ å‡½æ•°æ¥æ”¶ä¸€ä¸ªoptionsé€‰é¡¹å¯¹è±¡ï¼Œå®ƒçš„ç±»å‹æ˜¯RouterOptionsï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹RouterOptions æ‰“å¼€flow/declarations.js 123456789101112131415161718// flow/declarations.jsdeclare type RouterOptions = &#123; routes?: Array&lt;RouteConfig&gt;, // è·¯ç”±é…ç½®è§„åˆ™åˆ—è¡¨ mode?: string, // è·¯ç”±æ¨¡å¼ fallback?: boolean, // æ˜¯å¦å¯ç”¨å›é€€ base?: string, // baseåœ°å€ linkActiveClass?: string, // router-linkæ¿€æ´»æ—¶ç±»å linkExactActiveClass?: string, // router-linkç²¾å‡†æ¿€æ´»æ—¶ç±»å parseQuery?: (query: string) =&gt; Object, // è‡ªå®šä¹‰è§£æqsçš„æ–¹æ³• stringifyQuery?: (query: Object) =&gt; string, // è‡ªå®šä¹‰åºåˆ—åŒ–qsçš„æ–¹æ³• scrollBehavior?: ( // æ§åˆ¶æ»šåŠ¨è¡Œä¸º to: Route, from: Route, savedPosition: ?Position ) =&gt; PositionResult | Promise&lt;PositionResult&gt;,&#125; RouterOptionså®šä¹‰äº†VueRouteræ‰€èƒ½æ¥æ”¶çš„æ‰€æœ‰é€‰é¡¹ï¼› https://router.vuejs.org/zh/api/#router-æ„å»ºé€‰é¡¹ æˆ‘ä»¬é‡ç‚¹å…³æ³¨ä¸€ä¸‹ä¸‹é¢çš„å‡ ä¸ªé€‰é¡¹å€¼ routesæ˜¯è·¯ç”±é…ç½®è§„åˆ™åˆ—è¡¨ï¼Œè¿™ä¸ªä¸»è¦ç”¨æ¥åç»­ç”Ÿæˆè·¯ç”±æ˜ å°„è¡¨çš„ï¼› å®ƒæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸€é¡¹éƒ½æ˜¯ä¸€ä¸ªè·¯ç”±é…ç½®è§„åˆ™(RouteConfig)ï¼Œå…³äºRouteConfigï¼Œå¯ä»¥å›çœ‹æœ¯è¯­é‚£ä¸€èŠ‚ï¼› modeã€fallbackæ˜¯è·Ÿè·¯ç”±æ¨¡å¼ç›¸å…³çš„ åé¢ä¼šè¯¦ç»†è®²VueRouterçš„è·¯ç”±æ¨¡å¼ å±æ€§èµ‹åˆå€¼ å¯¹ä¸€äº›å±æ€§èµ‹äºˆäº†åˆå€¼ï¼Œä¾‹å¦‚ï¼Œå¯¹æ¥æ”¶å…¨å±€å¯¼èˆªå®ˆå«(beforeEachã€beforeResolveã€afterEach)çš„æ•°ç»„åšäº†åˆå§‹åŒ– åˆ›å»º matcher é€šè¿‡createMatcherç”Ÿæˆäº†matcher è¿™ä¸ªmatcherå¯¹è±¡å°±æ˜¯æœ€åˆèŠçš„åŒ¹é…å™¨ï¼Œè´Ÿè´£ url åŒ¹é…ï¼Œå®ƒæ¥æ”¶äº†routeså’Œrouterå®ä¾‹ï¼›createMatcheré‡Œé¢ä¸å…‰åˆ›å»ºäº†matcherï¼Œè¿˜åˆ›å»ºäº†è·¯ç”±æ˜ å°„è¡¨RouteMapï¼Œæˆ‘ä»¬åé¢ç»†çœ‹ ç¡®å®šè·¯ç”±æ¨¡å¼ ä¸‰ç§è·¯ç”±æ¨¡å¼æˆ‘ä»¬åé¢ç»†è®² ç°åœ¨åªéœ€è¦çŸ¥é“VueRouteræ˜¯å¦‚ä½•ç¡®å®šè·¯ç”±æ¨¡å¼çš„ VueRouterä¼šæ ¹æ®options.modeã€options.fallbackã€supportsPushStateã€inBrowseræ¥ç¡®å®šæœ€ç»ˆçš„è·¯ç”±æ¨¡å¼ å…ˆç¡®å®šfallbackï¼Œfallbackåªæœ‰åœ¨ç”¨æˆ·è®¾ç½®äº†mode:historyå¹¶ä¸”å½“å‰ç¯å¢ƒä¸æ”¯æŒpushStateä¸”ç”¨æˆ·ä¸»åŠ¨å£°æ˜äº†éœ€è¦å›é€€ï¼Œæ­¤æ—¶fallbackæ‰ä¸ºtrue å½“fallbackä¸ºtrueæ—¶ä¼šä½¿ç”¨hashæ¨¡å¼ï¼› å¦‚æœæœ€åå‘ç°å¤„äºéæµè§ˆå™¨ç¯å¢ƒï¼Œåˆ™ä¼šå¼ºåˆ¶ä½¿ç”¨abstractæ¨¡å¼ route-mode.png inBrowserå’ŒsupportsPushStateçš„å®ç°éƒ½å¾ˆç®€å• 123456789101112131415161718// src/util/dom.jsexport const inBrowser = typeof window !== 'undefined' // ç›´æ¥åˆ¤æ–­windowæ˜¯å¦å­˜åœ¨ï¼Œæ¥ç¡®å®šæ˜¯å¦åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­// src/util/push-state.jsexport const supportsPushState = inBrowser &amp;&amp; // æµè§ˆå™¨ç¯å¢ƒ (function () &#123; const ua = window.navigator.userAgent if ( (ua.indexOf('Android 2.') !== -1 || ua.indexOf('Android 4.0') !== -1) &amp;&amp; ua.indexOf('Mobile Safari') !== -1 &amp;&amp; ua.indexOf('Chrome') === -1 &amp;&amp; ua.indexOf('Windows Phone') === -1 ) &#123; return false // ç‰¹æ®Šæµè§ˆå™¨ç›´æ¥ä¸æ”¯æŒ &#125; return window.history &amp;&amp; typeof window.history.pushState === 'function' // åˆ¤æ–­æ˜¯å¦æ”¯æŒpushState &#125;)() æ ¹æ®è·¯ç”±æ¨¡å¼ç”Ÿæˆä¸åŒçš„ History å®ä¾‹ æ ¹æ®ä¸Šä¸€æ­¥çš„è·¯ç”±æ¨¡å¼ç”Ÿæˆä¸åŒçš„Historyå®ä¾‹ï¼Œå…³äºè·¯ç”±æ¨¡å¼ã€Historyå®ä¾‹åé¢å†è®² å°ç»“ VueRouterçš„æ„é€ å‡½æ•°ä¸»è¦å¹²äº†ä¸‹é¢å‡ ä»¶äº‹ æ¥æ”¶ä¸€ä¸ªRouterOptions ç„¶åå¯¹ä¸€äº›å±æ€§èµ‹äº†åˆå€¼ ç”Ÿæˆäº†matcheråŒ¹é…å™¨ ç¡®å®šè·¯ç”±æ¨¡å¼ æ ¹æ®ä¸åŒè·¯ç”±æ¨¡å¼ç”Ÿæˆä¸åŒHistoryå®ä¾‹ åˆ›å»ºåŒ¹é…å™¨ æˆ‘ä»¬æ¥ç»†çœ‹ä¸€ä¸‹createMatcheré‡Œé¢çš„å®ç° createMatcherçš„å®ç°åœ¨src/create-matcher.jsä¸­ 123456789101112131415161718192021222324252627282930313233343536 // src/create-matcher.js...// Matcherç±»å‹export type Matcher = &#123; match: (raw: RawLocation, current?: Route, redirectedFrom?: Location) =&gt; Route; // åŒ¹é…æ–¹æ³• addRoutes: (routes: Array&lt;RouteConfig&gt;) =&gt; void; // æ·»åŠ Routeæ–¹æ³•&#125;;// Matcherå·¥å‚å‡½æ•°export function createMatcher ( routes: Array&lt;RouteConfig&gt;, // è·¯ç”±é…ç½®åˆ—è¡¨ router: VueRouter // VueRouterå®ä¾‹): Matcher &#123; const &#123; pathList, pathMap, nameMap &#125; = createRouteMap(routes) // åˆ›å»ºè·¯ç”±æ˜ å°„è¡¨ // æ·»åŠ è·¯ç”± function addRoutes (routes) &#123; // ç”±äºä¼ å…¥pathList, pathMap, nameMapäº†ï¼Œæ‰€ä»¥createRouteMapæ–¹æ³•ä¼šæ‰§è¡Œæ·»åŠ é€»è¾‘ createRouteMap(routes, pathList, pathMap, nameMap) &#125; // ä¼ å…¥location,è¿”å›åŒ¹é…çš„Routeå¯¹è±¡ function match ( raw: RawLocation, currentRoute?: Route, redirectedFrom?: Location ): Route &#123; ... &#125; // è¿”å›Matcherå¯¹è±¡ï¼Œæš´éœ²matchã€addRoutesæ–¹æ³• return &#123; match, addRoutes &#125;&#125; å¯ä»¥çœ‹åˆ°ï¼ŒcreateMatcheræ–¹æ³•æ¥æ”¶ä¸€ä¸ªè·¯ç”±é…ç½®è§„åˆ™åˆ—è¡¨å’Œrouterå®ä¾‹ï¼Œè¿”å›ä¸€ä¸ªMatcherå¯¹è±¡ Matcherå¯¹è±¡åŒ…å«ä¸€ä¸ªç”¨äºåŒ¹é…çš„matchæ–¹æ³•å’Œä¸€ä¸ªåŠ¨æ€æ·»åŠ è·¯ç”±çš„addRoutesæ–¹æ³•ï¼› è€Œè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½å£°æ˜åœ¨createMatcherå†…éƒ¨ï¼Œç”±äºé—­åŒ…ç‰¹æ€§ï¼Œå®ƒèƒ½è®¿é—®åˆ°createMatcherä½œç”¨åŸŸçš„æ‰€æœ‰å˜é‡ å°ç»“ æˆ‘ä»¬æ€»ç»“ä¸‹createMatcherçš„é€»è¾‘ create-matcher.png æˆ‘ä»¬å¯ä»¥çœ‹åˆ°createMatcherå’ŒaddRoutesæ–¹æ³•ä¸­éƒ½è°ƒç”¨äº†createRouteMapæ–¹æ³•ï¼ŒäºŒè€…åªæ˜¯ä¼ é€’çš„å‚æ•°ä¸åŒï¼Œä»æ–¹æ³•åçœ‹ï¼Œè¿™ä¸ªæ–¹æ³•è‚¯å®šå’Œè·¯ç”±è¡¨RouteMapæœ‰å…³ æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹çœ‹createRouteMapçš„å®ç° createRouteMap createRouteMapæ–¹æ³•ä½äºsrc/create-route-map.jsä¸­ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950// åˆ›å»ºè·¯ç”±æ˜ å°„mapã€æ·»åŠ è·¯ç”±è®°å½•export function createRouteMap( routes: Array&lt;RouteConfig&gt;, // è·¯ç”±é…ç½®åˆ—è¡¨ oldPathList?: Array&lt;string&gt;, // æ—§pathList oldPathMap?: Dictionary&lt;RouteRecord&gt;, // æ—§pathMap oldNameMap?: Dictionary&lt;RouteRecord&gt; // æ—§nameMap): &#123; pathList: Array&lt;string&gt; pathMap: Dictionary&lt;RouteRecord&gt; nameMap: Dictionary&lt;RouteRecord&gt;&#125; &#123; // è‹¥æ—§çš„è·¯ç”±ç›¸å…³æ˜ å°„åˆ—è¡¨åŠmapå­˜åœ¨ï¼Œåˆ™ä½¿ç”¨æ—§çš„åˆå§‹åŒ–ï¼ˆå€Ÿæ­¤å®ç°æ·»åŠ è·¯ç”±åŠŸèƒ½ï¼‰ // the path list is used to control path matching priority const pathList: Array&lt;string&gt; = oldPathList || [] // $flow-disable-line const pathMap: Dictionary&lt;RouteRecord&gt; = oldPathMap || Object.create(null) // $flow-disable-line const nameMap: Dictionary&lt;RouteRecord&gt; = oldNameMap || Object.create(null) // éå†è·¯ç”±é…ç½®å¯¹è±¡ï¼Œç”Ÿæˆ/æ·»åŠ è·¯ç”±è®°å½• routes.forEach((route) =&gt; &#123; addRouteRecord(pathList, pathMap, nameMap, route) &#125;) // ensure wildcard routes are always at the end // ç¡®ä¿path:*æ°¸è¿œåœ¨åœ¨æœ€å for (let i = 0, l = pathList.length; i &lt; l; i++) &#123; if (pathList[i] === '*') &#123; pathList.push(pathList.splice(i, 1)[0]) l-- i-- &#125; &#125; // å¼€å‘ç¯å¢ƒï¼Œæç¤ºéåµŒå¥—è·¯ç”±çš„pathå¿…é¡»ä»¥/æˆ–è€…*å¼€å¤´ if (process.env.NODE_ENV === 'development') &#123; // warn if routes do not include leading slashes const found = pathList // check for missing leading slash .filter( (path) =&gt; path &amp;&amp; path.charAt(0) !== '*' &amp;&amp; path.charAt(0) !== '/' ) if (found.length &gt; 0) &#123; const pathNames = found.map((path) =&gt; `- $&#123;path&#125;`).join('\n') warn( false, `Non-nested routes must include a leading slash character. Fix the following routes: \n$&#123;pathNames&#125;` ) &#125; &#125; return &#123; pathList, pathMap, nameMap, &#125;&#125; å¯ä»¥çœ‹åˆ°createRouteMapè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒåŒ…å«pathListã€pathMapå’ŒnameMap pathListä¸­å­˜å‚¨äº†routesä¸­çš„æ‰€æœ‰path pathMapç»´æŠ¤çš„æ˜¯pathå’Œè·¯ç”±è®°å½•RouteRecordçš„æ˜ å°„ nameMapç»´æŠ¤çš„æ˜¯nameå’Œè·¯ç”±è®°å½•RouteRecordçš„æ˜ å°„ å› ä¸ºVueRouteræ”¯æŒå‘½åè·¯ç”± åä¸¤è€…ï¼Œéƒ½æ˜¯ä¸ºäº†å¿«é€Ÿæ‰¾åˆ°å¯¹åº”çš„è·¯ç”±è®°å½• å¯ä»¥çœ‹ä¸‹ä½¿ç”¨ä¸‹é¢çš„routesè°ƒç”¨createRouteMapä¼šè¿”å›ä»€ä¹ˆ 1234567891011121314;[ &#123; path: '/', component: Home &#125;, &#123; path: '/foo', component: Foo, children: [ &#123; path: 'child', component: FooChild, &#125;, ], &#125;, &#123; path: '/bar/:dynamic', component: Bar &#125;,] route-map-obj.png ç”±äºæ²¡æœ‰å‘½åè·¯ç”±ï¼Œæ‰€ä»¥nameMapä¸ºç©º pathListå­˜å‚¨äº†æ‰€æœ‰pathï¼Œæœ‰ä¸ªä¸ºç©ºï¼Œå…¶å®æ˜¯/ï¼Œåœ¨normalizePathæ—¶è¢«åˆ é™¤äº† pathMapè®°å½•äº†æ¯ä¸ªpathå’Œå¯¹åº”RouteRecordçš„æ˜ å°„å…³ç³» å°ç»“ VueRouterçš„è·¯ç”±æ˜ å°„è¡¨ç”±ä¸‰éƒ¨åˆ†ç»„æˆ:pathListã€pathMapã€nameMapï¼›åä¸¤è€…æ˜¯ç”¨æ¥å¿«é€ŸæŸ¥æ‰¾çš„ createRouteMapçš„é€»è¾‘ å…ˆåˆ¤æ–­è·¯ç”±ç›¸å…³æ˜ å°„è¡¨æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œè‹¥å­˜åœ¨åˆ™ä½¿ç”¨ï¼Œå¦åˆ™æ–°å»ºï¼› è¿™å°±å®ç°äº†createRouteMapåˆ›å»º/æ–°å¢çš„åŒé‡åŠŸèƒ½ ç„¶åéå†routesï¼Œä¾æ¬¡ä¸ºæ¯ä¸ªrouteè°ƒç”¨addRouteRecordç”Ÿæˆä¸€ä¸ªRouteRecordå¹¶æ›´æ–°pathListã€pathMapå’ŒnameMap ç”±äºpathListåœ¨åç»­é€»è¾‘ä¼šç”¨æ¥éå†åŒ¹é…ï¼Œä¸ºäº†æ€§èƒ½ï¼Œæ‰€ä»¥éœ€è¦å°†path:*æ”¾ç½®åˆ°pathListçš„æœ€å æœ€åæ£€æŸ¥éåµŒå¥—è·¯ç”±çš„pathæ˜¯å¦æ˜¯ä»¥/æˆ–è€…*å¼€å¤´ ç”¨å›¾æ€»ç»“å¦‚ä¸‹ create-route-map-sequence.png æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹çœ‹è·¯ç”±è®°å½•æ˜¯å¦‚ä½•ç”Ÿæˆçš„ addRouteRecord è¿™ä¸ªæ–¹æ³•ä¸»è¦æ˜¯åˆ›å»ºè·¯ç”±è®°å½•å¹¶æ›´æ–°è·¯ç”±æ˜ å°„è¡¨ ä½äºsrc/create-route-map.js 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132// src/create-route-map.js// æ·»åŠ è·¯ç”±è®°å½•ï¼Œæ›´æ–°pathListã€pathMapã€nameMapfunction addRouteRecord( pathList: Array&lt;string&gt;, pathMap: Dictionary&lt;RouteRecord&gt;, nameMap: Dictionary&lt;RouteRecord&gt;, route: RouteConfig, parent?: RouteRecord, // çˆ¶è·¯ç”±æ—¶è®°å½• matchAs?: string // å¤„ç†åˆ«åè·¯ç”±æ—¶ä½¿ç”¨) &#123; const &#123; path, name &#125; = route if (process.env.NODE_ENV !== 'production') &#123; // route.pathä¸èƒ½ä¸ºç©º assert(path != null, `"path" is required in a route configuration.`) // route.componentä¸èƒ½ä¸ºstring assert( typeof route.component !== 'string', `route config "component" for path: $&#123;String( path || name )&#125; cannot be a ` + `string id. Use an actual component instead.` ) &#125; const pathToRegexpOptions: PathToRegexpOptions = route.pathToRegexpOptions || &#123;&#125; // ç”Ÿæˆæ ¼å¼åŒ–åçš„path(å­è·¯ç”±ä¼šæ‹¼æ¥ä¸Šçˆ¶è·¯ç”±çš„path) const normalizedPath = normalizePath(path, parent, pathToRegexpOptions.strict) // åŒ¹é…è§„åˆ™æ˜¯å¦å¤§å°å†™æ•æ„Ÿï¼Ÿ(é»˜è®¤å€¼ï¼šfalse) if (typeof route.caseSensitive === 'boolean') &#123; pathToRegexpOptions.sensitive = route.caseSensitive &#125; // ç”Ÿæˆä¸€æ¡è·¯ç”±è®°å½• const record: RouteRecord = &#123; path: normalizedPath, regex: compileRouteRegex(normalizedPath, pathToRegexpOptions), // åˆ©ç”¨path-to-regexpåŒ…ç”Ÿæˆç”¨æ¥åŒ¹é…pathçš„å¢å¼ºæ­£åˆ™å¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥åŒ¹é…åŠ¨æ€è·¯ç”± components: route.components || &#123; default: route.component &#125;, // ä¿å­˜è·¯ç”±ç»„ä»¶ï¼Œæ”¯æŒå‘½åè§†å›¾https://router.vuejs.org/zh/guide/essentials/named-views.html#å‘½åè§†å›¾ instances: &#123;&#125;, // ä¿å­˜router-viewå®ä¾‹ name, parent, matchAs, redirect: route.redirect, // é‡å®šå‘çš„è·¯ç”±é…ç½®å¯¹è±¡ beforeEnter: route.beforeEnter, // è·¯ç”±ç‹¬äº«çš„å®ˆå« meta: route.meta || &#123;&#125;, // å…ƒä¿¡æ¯ // åŠ¨æ€è·¯ç”±ä¼ å‚ï¼›https://router.vuejs.org/zh/guide/essentials/passing-props.html#è·¯ç”±ç»„ä»¶ä¼ å‚ props: route.props == null ? &#123;&#125; : route.components // å‘½åè§†å›¾çš„ä¼ å‚è§„åˆ™éœ€è¦ä½¿ç”¨route.propsæŒ‡å®šçš„è§„åˆ™ ? route.props : &#123; default: route.props &#125;, &#125; // å¤„ç†æœ‰å­è·¯ç”±æƒ…å†µ if (route.children) &#123; // Warn if route is named, does not redirect and has a default child route. // If users navigate to this route by name, the default child will // not be rendered (GH Issue #629) // https://github.com/vuejs/vue-router/issues/629 // å‘½åè·¯ç”± &amp;&amp; æœªä½¿ç”¨é‡å®šå‘ &amp;&amp; å­è·¯ç”±é…ç½®å¯¹è±¡pathä¸º''æˆ–/æ—¶ï¼Œä½¿ç”¨çˆ¶è·¯ç”±çš„nameè·³è½¬æ—¶ï¼Œå­è·¯ç”±å°†ä¸ä¼šè¢«æ¸²æŸ“ if (process.env.NODE_ENV !== 'production') &#123; if ( route.name &amp;&amp; !route.redirect &amp;&amp; route.children.some((child) =&gt; /^\/?$/.test(child.path)) ) &#123; warn( false, `Named Route '$&#123;route.name&#125;' has a default child route. ` + `When navigating to this named route (:to="&#123;name: '$&#123;route.name&#125;'"), ` + `the default child route will not be rendered. Remove the name from ` + `this route and use the name of the default child route for named ` + `links instead.` ) &#125; &#125; // éå†ç”Ÿæˆå­è·¯ç”±è®°å½• route.children.forEach((child) =&gt; &#123; const childMatchAs = matchAs // matchAsè‹¥æœ‰å€¼ï¼Œä»£è¡¨å½“å‰è·¯ç”±æ˜¯åˆ«åè·¯ç”±ï¼Œåˆ™éœ€è¦å•ç‹¬ç”Ÿæˆåˆ«åè·¯ç”±çš„å­è·¯ç”±ï¼Œè·¯å¾„å‰ç¼€éœ€ä½¿ç”¨matchAs ? cleanPath(`$&#123;matchAs&#125;/$&#123;child.path&#125;`) : undefined addRouteRecord(pathList, pathMap, nameMap, child, record, childMatchAs) &#125;) &#125; // è‹¥pathMapä¸­ä¸å­˜åœ¨å½“å‰è·¯å¾„ï¼Œåˆ™æ›´æ–°pathListå’ŒpathMap if (!pathMap[record.path]) &#123; pathList.push(record.path) pathMap[record.path] = record &#125; // å¤„ç†åˆ«åï¼›https://router.vuejs.org/zh/guide/essentials/redirect-and-alias.html#%E5%88%AB%E5%90%8D if (route.alias !== undefined) &#123; const aliases = Array.isArray(route.alias) ? route.alias : [route.alias] // aliasæ”¯æŒstringï¼Œå’ŒArray&lt;String&gt; for (let i = 0; i &lt; aliases.length; ++i) &#123; const alias = aliases[i] if (process.env.NODE_ENV !== 'production' &amp;&amp; alias === path) &#123; // aliasçš„å€¼å’Œpathé‡å¤ï¼Œéœ€è¦ç»™æç¤º warn( false, `Found an alias with the same value as the path: "$&#123;path&#125;". You have to remove that alias. It will be ignored in development.` ) // skip in dev to make it work continue &#125; // ç”Ÿæˆåˆ«åè·¯ç”±é…ç½®å¯¹è±¡ const aliasRoute = &#123; path: alias, children: route.children, &#125; // æ·»åŠ åˆ«åè·¯ç”±è®°å½• addRouteRecord( pathList, pathMap, nameMap, aliasRoute, // åˆ«åè·¯ç”± parent, // å½“å‰è·¯ç”±çš„çˆ¶è·¯ç”±ï¼Œå› ä¸ºæ˜¯ç»™å½“å‰è·¯ç”±å–äº†ä¸ªåˆ«åï¼Œæ‰€ä»¥äºŒè€…å…¶å®æ˜¯æœ‰åŒä¸ªçˆ¶è·¯ç”±çš„ record.path || '/' // matchAsï¼Œç”¨æ¥ç”Ÿæˆåˆ«åè·¯ç”±çš„å­è·¯ç”±ï¼› ) // ! æ€»ç»“ï¼šå½“å‰è·¯ç”±è®¾ç½®äº†aliasåï¼Œä¼šå•ç‹¬ä¸ºå½“å‰è·¯ç”±åŠå…¶æ‰€æœ‰å­è·¯ç”±ç”Ÿæˆè·¯ç”±è®°å½•ï¼Œä¸”å­è·¯ç”±çš„pathå‰ç¼€ä¸ºmatchAs(å³åˆ«åè·¯ç”±çš„path) &#125; &#125; // å¤„ç†å‘½åè·¯ç”± if (name) &#123; // æ›´æ–°nameMap if (!nameMap[name]) &#123; nameMap[name] = record &#125; else if (process.env.NODE_ENV !== 'production' &amp;&amp; !matchAs) &#123; // è·¯ç”±é‡åè­¦å‘Š warn( false, `Duplicate named routes definition: ` + `&#123; name: "$&#123;name&#125;", path: "$&#123;record.path&#125;" &#125;` ) &#125; &#125;&#125; çœ‹ä¸‹é€»è¾‘ æ£€æŸ¥äº†è·¯ç”±è§„åˆ™ä¸­çš„pathå’Œcomponent ç”Ÿæˆpath-to-regexpçš„é€‰é¡¹pathToRegexpOptions æ ¼å¼åŒ–pathï¼Œå¦‚æœæ˜¯åµŒå¥—è·¯ç”±ï¼Œåˆ™ä¼šè¿½åŠ ä¸Šçˆ¶è·¯ç”±çš„path ç”Ÿæˆè·¯ç”±è®°å½• å¤„ç†åµŒå¥—è·¯ç”±ï¼Œé€’å½’ç”Ÿæˆå­è·¯ç”±è®°å½• æ›´æ–°pathListã€pathMap å¤„ç†åˆ«åè·¯ç”±ï¼Œç”Ÿæˆåˆ«åè·¯ç”±è®°å½• å¤„ç†å‘½åè·¯ç”±ï¼Œæ›´æ–°nameMap æˆ‘ä»¬æ¥çœ‹ä¸‹å‡ ä¸ªæ ¸å¿ƒé€»è¾‘ ç”Ÿæˆè·¯ç”±è®°å½• è·¯ç”±è®°å½•è®°å½•äº†è·¯ç”±çš„æ ¸å¿ƒä¿¡æ¯ 12345678910111213141516171819const record: RouteRecord = &#123; path: normalizedPath, // è§„èŒƒåŒ–åçš„è·¯å¾„ regex: compileRouteRegex(normalizedPath, pathToRegexpOptions), // åˆ©ç”¨path-to-regexpåŒ…ç”Ÿæˆç”¨æ¥åŒ¹é…pathçš„å¢å¼ºæ­£åˆ™å¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥åŒ¹é…åŠ¨æ€è·¯ç”± components: route.components || &#123; default: route.component &#125;, // ä¿å­˜è·¯ç”±ç»„ä»¶ï¼Œæ”¯æŒå‘½åè§†å›¾https://router.vuejs.org/zh/guide/essentials/named-views.html#å‘½åè§†å›¾ instances: &#123;&#125;, // ä¿å­˜router-viewå®ä¾‹ name, parent, // çˆ¶è·¯ç”±è®°å½• matchAs, // åˆ«åè·¯ç”±éœ€è¦ä½¿ç”¨ redirect: route.redirect, // é‡å®šå‘çš„è·¯ç”±é…ç½®å¯¹è±¡ beforeEnter: route.beforeEnter, // è·¯ç”±ç‹¬äº«çš„å®ˆå« meta: route.meta || &#123;&#125;, // å…ƒä¿¡æ¯ // åŠ¨æ€è·¯ç”±ä¼ å‚ï¼›https://router.vuejs.org/zh/guide/essentials/passing-props.html#è·¯ç”±ç»„ä»¶ä¼ å‚ props: route.props == null ? &#123;&#125; : route.components // å‘½åè§†å›¾çš„ä¼ å‚è§„åˆ™éœ€è¦ä½¿ç”¨route.propsæŒ‡å®šçš„è§„åˆ™ ? route.props : &#123; default: route.props &#125;,&#125; è·¯ç”±è®°å½•æœ‰ä¸ªregexå­—æ®µï¼Œå®ƒæ˜¯ä¸€ä¸ªå¢å¼ºçš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œå®ƒæ˜¯å®ç°åŠ¨æ€è·¯ç”±åŒ¹é…çš„å…³é”® regexæ˜¯é€šè¿‡compileRouteRegexæ–¹æ³•è¿”å›çš„ï¼Œå®ƒé‡Œé¢è°ƒç”¨äº†path-to-regexp 123456789101112131415161718192021222324import Regexp from 'path-to-regexp'...// ä½¿ç”¨path-to-regexpåŒ…ï¼Œç”Ÿæˆrouteå¯¹åº”çš„æ­£åˆ™ï¼Œå¯ä»¥ç”¨æ¥ç”ŸæˆåŠ¨æ€è·¯ç”±éœ€è¦çš„æ­£åˆ™è¡¨è¾¾å¼function compileRouteRegex ( path: string, pathToRegexpOptions: PathToRegexpOptions): RouteRegExp &#123; const regex = Regexp(path, [], pathToRegexpOptions) if (process.env.NODE_ENV !== 'production') &#123; const keys: any = Object.create(null) regex.keys.forEach(key =&gt; &#123; // é‡å¤keyæµ¸è† warn( !keys[key.name], `Duplicate param keys in route with path: "$&#123;path&#125;"` ) keys[key.name] = true &#125;) &#125; return regex&#125; æˆ‘ä»¬çœ‹ä¸‹path-to-regexpæ˜¯å¦‚ä½•ä½¿ç”¨çš„ å®˜ç½‘æ˜¯:https://www.npmjs.com/package/path-to-regexp Regexp æ¥æ”¶ä¸‰ä¸ªå‚æ•°pathï¼Œkeysï¼Œoptionsï¼›pathä¸ºéœ€è¦è½¬æ¢ä¸ºæ­£åˆ™çš„è·¯å¾„ï¼Œkeysï¼Œæ˜¯ç”¨æ¥æ¥æ”¶åœ¨pathä¸­æ‰¾åˆ°çš„keyï¼Œå¯ä»¥ä¼ å…¥ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨è¿”å›å€¼ä¸Šçš„keyså±æ€§ï¼Œoptionsä¸ºé€‰é¡¹ 12345const pathToRegexp = require('path-to-regexp')const regexp = pathToRegexp('/foo/:bar') // regexp = /^\/foo\/([^\/]+?)\/?$/i// :barè¢«å¤„ç†æˆæ­£åˆ™çš„ä¸€ä¸ªç»„äº†ï¼Œå½“æ­£åˆ™è¢«æ‰§è¡Œæ—¶ï¼Œå°±å¯ä»¥é€šè¿‡ç»„å–åˆ°barå¯¹åº”çš„å€¼console.log(regexp.keys) // keys = [&#123; name: 'bar', prefix: '/', suffix: '', pattern: '[^\\/#\\?]+?', modifier: '' &#125;] é€šè¿‡ä¸‹é¢çš„ä¾‹å­ï¼Œå°±å¯ä»¥çŸ¥é“åŠ¨æ€è·¯ç”±è·å–å‚æ•°å€¼æ˜¯å¦‚ä½•å®ç°çš„ 123456789// test.jsconst pathToRegexp = require('path-to-regexp')const regexp = pathToRegexp('/foo/:bar')console.log(regexp.keys) // è®°å½•äº†keyä¿¡æ¯const m = '/foo/test'.match(regexp) // æ­£åˆ™çš„ç»„è®°å½•äº†valueä¿¡æ¯console.log('key:', regexp.keys[0].name, ',value:', m[1]) path-to-regex-demo.png ç”ŸæˆåµŒå¥—è·¯ç”±è®°å½• æˆ‘ä»¬çŸ¥é“vue-routeræ˜¯æ”¯æŒåµŒå¥—è·¯ç”±çš„ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹æ˜¯å¦‚ä½•ç”ŸæˆåµŒå¥—è·¯ç”±è®°å½•çš„ 1234567891011121314151617181920212223242526272829303132// src/create-route-map// å¤„ç†æœ‰å­è·¯ç”±æƒ…å†µif (route.children) &#123; // Warn if route is named, does not redirect and has a default child route. // If users navigate to this route by name, the default child will // not be rendered (GH Issue #629) // https://github.com/vuejs/vue-router/issues/629 // å‘½åè·¯ç”± &amp;&amp; æœªä½¿ç”¨é‡å®šå‘ &amp;&amp; å­è·¯ç”±é…ç½®å¯¹è±¡pathä¸º''æˆ–/æ—¶ï¼Œä½¿ç”¨çˆ¶è·¯ç”±çš„nameè·³è½¬æ—¶ï¼Œå­è·¯ç”±å°†ä¸ä¼šè¢«æ¸²æŸ“ if (process.env.NODE_ENV !== 'production') &#123; if ( route.name &amp;&amp; !route.redirect &amp;&amp; route.children.some((child) =&gt; /^\/?$/.test(child.path)) ) &#123; warn( false, `Named Route '$&#123;route.name&#125;' has a default child route. ` + `When navigating to this named route (:to="&#123;name: '$&#123;route.name&#125;'"), ` + `the default child route will not be rendered. Remove the name from ` + `this route and use the name of the default child route for named ` + `links instead.` ) &#125; &#125; // éå†ç”Ÿæˆå­è·¯ç”±è®°å½• route.children.forEach((child) =&gt; &#123; const childMatchAs = matchAs // matchAsè‹¥æœ‰å€¼ï¼Œä»£è¡¨å½“å‰è·¯ç”±æ˜¯åˆ«åè·¯ç”±ï¼Œåˆ™éœ€è¦å•ç‹¬ç”Ÿæˆåˆ«åè·¯ç”±çš„å­è·¯ç”±ï¼Œè·¯å¾„å‰ç¼€éœ€ä½¿ç”¨matchAs ? cleanPath(`$&#123;matchAs&#125;/$&#123;child.path&#125;`) : undefined addRouteRecord(pathList, pathMap, nameMap, child, record, childMatchAs) &#125;)&#125; é¦–å…ˆé’ˆå¯¹#629é—®é¢˜åšå‡ºäº†è­¦å‘Šæç¤º #629é—®é¢˜ä¸»è¦æ˜¯ å½“ä¸€ä¸ªè·¯ç”±æ˜¯ å‘½åè·¯ç”± &amp;&amp; æœªä½¿ç”¨é‡å®šå‘ &amp;&amp; å­è·¯ç”±é…ç½®å¯¹è±¡pathä¸º&#39;&#39;æˆ–/æ—¶ï¼Œä½¿ç”¨çˆ¶è·¯ç”±çš„nameè·³è½¬æ—¶ï¼Œå­è·¯ç”±å°†ä¸ä¼šè¢«æ¸²æŸ“ ç„¶åéå†å­è·¯ç”±è§„åˆ™åˆ—è¡¨ï¼Œç”Ÿæˆå­è·¯ç”±è®°å½• è¿™é‡Œé¢è¿˜å¤„ç†äº†åˆ«åè·¯ç”±çš„å­è·¯ç”±æƒ…å†µ éå†æ—¶å¦‚æœå‘ç°çˆ¶è·¯ç”±è¢«æ ‡è®°ä¸ºåˆ«åè·¯ç”±ï¼Œåˆ™å­è·¯ç”±çš„pathå‰é¢éœ€è¦åŠ ä¸Šçˆ¶è·¯ç”±çš„pathï¼Œç„¶åå†ç”Ÿæˆè®°å½• æˆ‘ä»¬å¯ä»¥çœ‹ä¸‹ä¸‹é¢çš„åµŒå¥—è·¯ç”±ï¼Œç”Ÿæˆçš„è·¯ç”±æ˜ å°„è¡¨é•¿ä»€ä¹ˆæ · 1234567;[ &#123; path: '/parent', component: Parent, children: [&#123; path: 'foo', component: Foo &#125;], &#125;,] nested-route.png å¯ä»¥çœ‹åˆ°ï¼Œå­è·¯ç”±çš„pathä¼šå‰è¿½åŠ ä¸Šçˆ¶è·¯ç”±çš„path ç”Ÿæˆåˆ«åè·¯ç”±è®°å½• VueRouteræ”¯æŒç»™è·¯ç”±è®¾ç½®åˆ«åï¼›/a çš„åˆ«åæ˜¯ /bï¼Œæ„å‘³ç€ï¼Œå½“ç”¨æˆ·è®¿é—® /b æ—¶ï¼ŒURL ä¼šä¿æŒä¸º /bï¼Œä½†æ˜¯è·¯ç”±åŒ¹é…åˆ™ä¸º /aï¼Œå°±åƒç”¨æˆ·è®¿é—® /a ä¸€æ · æˆ‘ä»¬æ¥çœ‹çœ‹æ¤’å¦‚ä½•ç”Ÿæˆåˆ«åè·¯ç”±è®°å½•çš„ 123456789101112131415161718192021222324252627282930// src/create-route-map.jsif (route.alias !== undefined) &#123; const aliases = Array.isArray(route.alias) ? route.alias : [route.alias] // aliasæ”¯æŒstringï¼Œå’ŒArray&lt;String&gt; for (let i = 0; i &lt; aliases.length; ++i) &#123; const alias = aliases[i] if (process.env.NODE_ENV !== 'production' &amp;&amp; alias === path) &#123; // aliasçš„å€¼å’Œpathé‡å¤ï¼Œéœ€è¦ç»™æç¤º warn( false, `Found an alias with the same value as the path: "$&#123;path&#125;". You have to remove that alias. It will be ignored in development.` ) // skip in dev to make it work continue &#125; // ç”Ÿæˆåˆ«åè·¯ç”±é…ç½®å¯¹è±¡ const aliasRoute = &#123; path: alias, children: route.children, &#125; // æ·»åŠ åˆ«åè·¯ç”±è®°å½• addRouteRecord( pathList, pathMap, nameMap, aliasRoute, // åˆ«åè·¯ç”± parent, // å½“å‰è·¯ç”±çš„çˆ¶è·¯ç”±ï¼Œå› ä¸ºæ˜¯ç»™å½“å‰è·¯ç”±å–äº†ä¸ªåˆ«åï¼Œæ‰€ä»¥äºŒè€…å…¶å®æ˜¯æœ‰åŒä¸ªçˆ¶è·¯ç”±çš„ record.path || '/' // matchAsï¼Œç”¨æ¥ç”Ÿæˆåˆ«åè·¯ç”±çš„å­è·¯ç”±ï¼› ) // ! æ€»ç»“ï¼šå½“å‰è·¯ç”±è®¾ç½®äº†aliasåï¼Œä¼šå•ç‹¬ä¸ºå½“å‰è·¯ç”±åŠå…¶æ‰€æœ‰å­è·¯ç”±ç”Ÿæˆè·¯ç”±è®°å½•ï¼Œä¸”å­è·¯ç”±çš„pathå‰ç¼€ä¸ºmatchAs(å³åˆ«åè·¯ç”±çš„path) &#125;&#125; åˆ«åæ˜¯æ”¯æŒå•åˆ«åå’Œå¤šåˆ«åçš„ï¼Œå³route.aliasæ”¯æŒä¼ å…¥/fooæˆ–[&#39;/foo&#39;,&#39;/bar&#39;]ï¼Œæ‰€ä»¥å…ˆå¯¹è¿™ä¸¤ç§æƒ…å†µåšäº†å½’ä¸€å¤„ç†ï¼Œç»Ÿä¸€å¤„ç†æˆæ•°ç»„ ç„¶åéå†è¿™ä¸ªæ•°ç»„ï¼Œå…ˆæ£€æŸ¥åˆ«åå’Œpathæ˜¯å¦é‡å¤ï¼Œç„¶åå•ç‹¬ä¸ºåˆ«åè·¯ç”±ç”Ÿæˆä¸€ä»½é…ç½®ä¼ å…¥ï¼Œæœ€åè°ƒç”¨addRouteRecordç”Ÿæˆåˆ«åè·¯ç”±è®°å½• æ³¨æ„æ­¤å¤„è¿˜é€šè¿‡matchAså¤„ç†äº†åˆ«åè·¯ç”±ç”Ÿæˆå­è·¯ç”±çš„åœºæ™¯ï¼Œä¸»è¦é€šè¿‡è®¾ç½®matchAsä¸ºrecord.path || &#39;/&#39;ï¼Œç„¶ååœ¨ç”Ÿæˆå­è·¯ç”±è®°å½•æ—¶ï¼Œä¼šæ ¹æ®matchAsç”Ÿæˆåˆ«åè·¯ç”±è®°å½•çš„å­è®°å½•ï¼Œå…·ä½“å¯çœ‹ä¸Šé¢çš„åµŒå¥—è·¯ç”±ç« èŠ‚ æˆ‘ä»¬çœ‹çœ‹ï¼Œåˆ«åè·¯ç”±ç”Ÿæˆçš„çš„è·¯ç”±æ˜ å°„è¡¨é•¿ä»€ä¹ˆæ · 1234567891011;[ &#123; path: '/root', component: Root, alias: '/root-alias' &#125;, &#123; path: '/home', component: Home, children: [ &#123; path: 'bar', component: Bar, alias: 'bar-alias' &#125;, &#123; path: 'baz', component: Baz, alias: ['/baz', 'baz-alias'] &#125;, ], &#125;,] alias-route.png å¯ä»¥çœ‹åˆ°ä¸ºåˆ«åè·¯ç”±å’Œåˆ«åè·¯ç”±çš„å­è·¯ç”±éƒ½å•ç‹¬ç”Ÿæˆäº†ä¸€æ¡è·¯ç”±è®°å½• å°ç»“ è·¯ç”±è®°å½•æ˜¯è·¯ç”±æ˜ å°„è¡¨çš„é‡è¦ç»„æˆéƒ¨åˆ† è·¯ç”±è®°å½•ä¸­çš„regexæ˜¯å¤„ç†åŠ¨æ€è·¯ç”±ä¼ å‚çš„å…³é”®å­—æ®µï¼Œä¸»è¦æ˜¯å€ŸåŠ©path-to-regexpå®ç°çš„ ç”Ÿæˆè·¯ç”±è®°å½•ä¸»è¦è€ƒè™‘äº†ä¸‹é¢å‡ ç§è·¯ç”±è®°å½•çš„ç”Ÿæˆ åµŒå¥—è·¯ç”± å­è·¯ç”±å•ç‹¬ç”Ÿæˆä¸€æ¡è·¯ç”±è®°å½• åˆ«åè·¯ç”±åŠåˆ«åè·¯ç”±å­è·¯ç”± åˆ«åè·¯ç”±åŠå…¶å­è·¯ç”±åˆ†åˆ«ä¼šç”Ÿæˆä¸€æ¡è·¯ç”±è®°å½• å‘½åè·¯ç”± ç”Ÿæˆè·¯ç”±è®°å½•çš„æ•´ä¸ªæµç¨‹å¦‚ä¸‹å›¾æ‰€ç¤º add-route-record.png è‡³æ­¤æˆ‘ä»¬å·²ç»åˆ†æå®Œäº†VueRouterå®ä¾‹åŒ–ä¸­åˆ›å»ºåŒ¹é…å™¨(ç”Ÿæˆè·¯ç”±æ˜ å°„è¡¨)ç›¸å…³é€»è¾‘ ä¸‹é¢æˆ‘ä»¬å°†çœ‹çœ‹æ ¹æ®è·¯ç”±æ¨¡å¼ç”ŸæˆHistoryå®ä¾‹çš„ç›¸å…³é€»è¾‘ è·¯ç”±æ¨¡å¼ å‰ç«¯è·¯ç”±ä¸€ä¸ªå¾ˆé‡è¦çš„ç‰¹æ€§æ˜¯è¦å®ç°æ— åˆ·æ–°åˆ‡æ¢é¡µé¢ å³ url æ”¹å˜ï¼Œé¡µé¢ä¸åˆ·æ–°å®ç°é¡µé¢çš„è·³è½¬ è¦å®ç°è¿™ä¸€ç‚¹ï¼Œæœ‰ä¸¤ç§æ–¹æ¡ˆ ä¸€ç§hash+hashChangeï¼Œå¦ä¸€ç§åˆ©ç”¨History APIçš„pushState+popState å‰è€…ä¸»è¦åˆ©ç”¨hashæ”¹å˜æ—¶é¡µé¢ä¸ä¼šåˆ·æ–°å¹¶ä¼šè§¦å‘hashChangeè¿™ä¸ªç‰¹æ€§æ¥å®ç°å‰ç«¯è·¯ç”± åè€…å……åˆ†åˆ©ç”¨äº†HTML5 History APIçš„pushStateæ–¹æ³•å’ŒpopStateäº‹ä»¶æ¥å®ç°å‰ç«¯è·¯ç”± äºŒè€…æ¯”è¾ƒ å‰è€… å…¼å®¹æ€§å¥½ï¼ŒhashChangeæ”¯æŒåˆ° IE8 urlä¸­ä¼šæºå¸¦/#/ï¼Œä¸ç¾è§‚ ä¸éœ€è¦æœåŠ¡ç«¯æ”¹é€  åè€… å…¼å®¹åˆ° IE10 urlè·Ÿæ­£å¸¸urlä¸€æ · ç”±äºå…¶urlè·Ÿæ­£å¸¸urlä¸€æ ·ï¼Œæ‰€ä»¥åœ¨åˆ·æ–°æ—¶ï¼Œä¼šä»¥æ­¤urlä¸ºé“¾æ¥è¯·æ±‚æœåŠ¡ç«¯é¡µé¢ï¼Œè€ŒæœåŠ¡ç«¯æ˜¯æ²¡æœ‰è¿™ä¸ªé¡µé¢çš„ï¼Œä¼š 404ï¼Œå› æ­¤éœ€è¦æœåŠ¡ç«¯é…åˆå°†æ‰€æœ‰è¯·æ±‚é‡å®šå‘åˆ°é¦–é¡µï¼Œå°†æ•´ä¸ªè·¯ç”±çš„æ§åˆ¶äº¤ç»™å‰ç«¯è·¯ç”± VueRouteræ”¯æŒä¸‰ç§è·¯ç”±æ¨¡å¼ï¼Œåˆ†åˆ«ä¸ºhashã€historyã€abstract hashæ¨¡å¼å°±æ˜¯ç¬¬ä¸€ç§æ–¹æ¡ˆçš„å®ç° historyæ¨¡å¼æ˜¯ç¬¬äºŒç§æ–¹æ¡ˆçš„å®ç° abstractæ¨¡å¼æ˜¯ç”¨åœ¨éæµè§ˆå™¨ç¯å¢ƒçš„ï¼Œä¸»è¦ç”¨äºSSR æ ¸å¿ƒç±» VueRouterçš„ä¸‰ç§è·¯ç”±æ¨¡å¼ï¼Œä¸»è¦ç”±ä¸‹é¢çš„ä¸‰ä¸ªæ ¸å¿ƒç±»å®ç° History åŸºç¡€ç±» ä½äºsrc/history/base.js HTML5History ç”¨äºæ”¯æŒpushStateçš„æµè§ˆå™¨ src/history/html5.js HashHistory ç”¨äºä¸æ”¯æŒpushStateçš„æµè§ˆå™¨ src/history/hash.js AbstractHistory ç”¨äºéæµè§ˆå™¨ç¯å¢ƒ(æœåŠ¡ç«¯æ¸²æŸ“) src/history/abstract.js é€šè¿‡ä¸‹é¢è¿™å¼ å›¾ï¼Œå¯ä»¥äº†è§£åˆ°ä»–ä»¬ä¹‹é—´çš„å…³ç³» route-mode-class.png HTML5Historyã€HashHistoryã€AbstractHistoryä¸‰è€…éƒ½æ˜¯ç»§æ‰¿äºåŸºç¡€ç±»Historyï¼› ä¸‰è€…ä¸å…‰èƒ½è®¿é—®Historyç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œä»–ä»¬è¿˜éƒ½å®ç°äº†åŸºç¡€ç±»ä¸­å£°æ˜çš„éœ€è¦å­ç±»å®ç°çš„ 5 ä¸ªæ¥å£(goã€pushã€replaceã€ensureURLã€getCurrentLocation) ç”±äºHashHistoryç›‘å¬hashChangeçš„ç‰¹æ®Šæ€§ï¼Œæ‰€ä»¥ä¼šå•ç‹¬å¤šä¸€ä¸ªsetupListenersæ–¹æ³• AbstractHistoryç”±äºéœ€è¦åœ¨éæµè§ˆå™¨ç¯å¢ƒä½¿ç”¨ï¼Œæ²¡æœ‰å†å²è®°å½•æ ˆï¼Œæ‰€ä»¥åªèƒ½é€šè¿‡indexã€stackæ¥æ¨¡æ‹Ÿ å‰é¢æˆ‘ä»¬åˆ†æVueRouterå®ä¾‹åŒ–è¿‡ç¨‹æ—¶ï¼ŒçŸ¥é“VueRouterä¼šåœ¨ç¡®å®šå®Œè·¯ç”±æ¨¡å¼åï¼Œä¼šå®ä¾‹åŒ–ä¸åŒçš„Historyå®ä¾‹ é‚£æˆ‘ä»¬æ¥çœ‹çœ‹ä¸åŒHistoryçš„å®ä¾‹åŒ–è¿‡ç¨‹ History ç±» å®ƒæ˜¯çˆ¶ç±»(åŸºç±»)ï¼Œå…¶å®ƒç±»éƒ½æ˜¯ç»§æ‰¿å®ƒçš„ ä»£ç ä½äºsrc/history/base.js 12345678910111213141516171819202122232425262728293031323334353637// src/history/base.js// çˆ¶ç±»export class History &#123; router: Router base: string current: Route pending: ?Route cb: (r: Route) =&gt; void ready: boolean readyCbs: Array&lt;Function&gt; readyErrorCbs: Array&lt;Function&gt; errorCbs: Array&lt;Function&gt; // implemented by sub-classes // éœ€è¦å­ç±»(HTML5Historyã€HashHistory)å®ç°çš„æ–¹æ³• +go: (n: number) =&gt; void +push: (loc: RawLocation) =&gt; void +replace: (loc: RawLocation) =&gt; void +ensureURL: (push?: boolean) =&gt; void +getCurrentLocation: () =&gt; string constructor (router: Router, base: ?string) &#123; this.router = router // æ ¼å¼åŒ–baseï¼Œä¿è¯baseæ˜¯ä»¥/å¼€å¤´ this.base = normalizeBase(base) // start with a route object that stands for "nowhere" this.current = START // å½“å‰æŒ‡å‘çš„routeå¯¹è±¡ï¼Œé»˜è®¤ä¸ºSTARTï¼›å³from this.pending = null // è®°å½•å°†è¦è·³è½¬çš„routeï¼›å³to this.ready = false this.readyCbs = [] this.readyErrorCbs = [] this.errorCbs = [] &#125; ...&#125; å¯ä»¥çœ‹åˆ°ï¼Œæ„é€ å‡½æ•°ä¸­ä¸»è¦å¹²äº†ä¸‹é¢å‡ ä»¶äº‹ ä¿å­˜äº†routerå®ä¾‹ è§„èŒƒåŒ–äº†baseï¼Œç¡®ä¿baseæ˜¯ä»¥/å¼€å¤´ åˆå§‹åŒ–äº†å½“å‰è·¯ç”±æŒ‡å‘ï¼Œé»˜è®¤åªæƒ³STARTåˆå§‹è·¯ç”±ï¼›åœ¨è·¯ç”±è·³è½¬æ—¶ï¼Œthis.currentä»£è¡¨çš„æ˜¯from åˆå§‹åŒ–äº†è·¯ç”±è·³è½¬æ—¶çš„ä¸‹ä¸ªè·¯ç”±ï¼Œé»˜è®¤ä¸ºnullï¼›åœ¨è·¯ç”±è·³è½¬æ—¶ï¼Œthis.pendingä»£è¡¨çš„æ˜¯to åˆå§‹åŒ–äº†ä¸€äº›å›è°ƒç›¸å…³çš„å±æ€§ STARTå®šä¹‰åœ¨src/utils/route.jsä¸­ 12345// src/utils/route.js// åˆå§‹è·¯ç”±export const START = createRoute(null, &#123; path: '/',&#125;) Historyç±»çš„å®ä¾‹åŒ–è¿‡ç¨‹å¦‚ä¸‹ history.png HTML5History ç±» æˆ‘ä»¬å†çœ‹çœ‹HTML5Historyç±»,å®ƒæ˜¯ç»§æ‰¿è‡ªHistoryç±» ä½äºsrc/history/html5.js 1234567891011121314151617181920212223242526272829303132export class HTML5History extends History &#123; constructor(router: Router, base: ?string) &#123; // åˆå§‹åŒ–çˆ¶ç±»History super(router, base) // æ£€æµ‹æ˜¯å¦éœ€è¦æ”¯æŒscroll const expectScroll = router.options.scrollBehavior const supportsScroll = supportsPushState &amp;&amp; expectScroll // è‹¥æ”¯æŒscroll,åˆå§‹åŒ–scrollç›¸å…³é€»è¾‘ if (supportsScroll) &#123; setupScroll() &#125; // è·å–åˆå§‹location const initLocation = getLocation(this.base) // ç›‘å¬popstateäº‹ä»¶ window.addEventListener('popstate', (e) =&gt; &#123; const current = this.current // Avoiding first `popstate` event dispatched in some browsers but first // history route not updated since async guard at the same time. // æŸäº›æµè§ˆå™¨ï¼Œä¼šåœ¨æ‰“å¼€é¡µé¢æ—¶è§¦å‘ä¸€æ¬¡popstate // æ­¤æ—¶å¦‚æœåˆå§‹è·¯ç”±æ˜¯å¼‚æ­¥è·¯ç”±,å°±ä¼šå‡ºç°`popstate`å…ˆè§¦å‘,åˆå§‹è·¯ç”±åè§£æå®Œæˆï¼Œè¿›è€Œå¯¼è‡´routeæœªæ›´æ–° // æ‰€ä»¥éœ€è¦é¿å… const location = getLocation(this.base) if (this.current === START &amp;&amp; location === initLocation) &#123; return &#125; // è·¯ç”±åœ°å€å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è·³è½¬ï¼Œå¹¶åœ¨è·³è½¬åå¤„ç†æ»šåŠ¨ this.transitionTo(location, (route) =&gt; &#123; if (supportsScroll) &#123; handleScroll(router, route, current, true) &#125; &#125;) &#125;) &#125;&#125; å¯ä»¥çœ‹åˆ°å…¶æ˜¯ç»§æ‰¿äºHistoryç±»ï¼Œæ‰€ä»¥åœ¨æ„é€ å‡½æ•°ä¸­è°ƒç”¨äº†çˆ¶ç±»æ„é€ å‡½æ•°(super(router,base)) æ£€æŸ¥äº†æ˜¯å¦éœ€è¦æ”¯æŒæ»šåŠ¨è¡Œä¸ºï¼Œå¦‚æœæ”¯æŒï¼Œåˆ™åˆå§‹åŒ–æ»šåŠ¨ç›¸å…³é€»è¾‘ ç›‘å¬äº†popstateäº‹ä»¶ï¼Œå¹¶åœ¨popstateè§¦å‘æ—¶ï¼Œè°ƒç”¨transitionToæ–¹æ³•å®ç°è·³è½¬ æ³¨æ„è¿™é‡Œå¤„ç†äº†ä¸€ä¸ªå¼‚å¸¸åœºæ™¯ æŸäº›æµè§ˆå™¨ä¸‹ï¼Œæ‰“å¼€é¡µé¢ä¼šè§¦å‘ä¸€æ¬¡popstateï¼Œæ­¤æ—¶å¦‚æœè·¯ç”±ç»„ä»¶æ˜¯å¼‚æ­¥çš„ï¼Œå°±ä¼šå‡ºç°popstateäº‹ä»¶è§¦å‘äº†ï¼Œä½†å¼‚æ­¥ç»„ä»¶è¿˜æ²¡è§£æå®Œæˆï¼Œæœ€åå¯¼è‡´routeæ²¡æœ‰æ›´æ–° æ‰€ä»¥å¯¹è¿™ç§æƒ…å†µåšäº†å±è”½ å…³äºæ»šåŠ¨å’Œè·¯ç”±è·³è½¬åé¢æœ‰ä¸“é—¨ç« èŠ‚ä¼šè®² HTML5Historyç±»çš„å®ä¾‹åŒ–è¿‡ç¨‹å¦‚ä¸‹ h5history.png HashHistory ç±» ä½äºsrc/history/hash.js 123456789101112// src/history/hash.jsexport class HashHistory extends History &#123; constructor(router: Router, base: ?string, fallback: boolean) &#123; // å®ä¾‹åŒ–çˆ¶ç±» super(router, base) // check history fallback deeplinking // fallbackåªæœ‰åœ¨æŒ‡æ˜äº†modeä¸ºhistoryï¼Œä½†æ˜¯æµè§ˆå™¨åˆä¸æ”¯æŒpopstateï¼Œç”¨æˆ·æ‰‹åŠ¨æŒ‡æ˜äº†fallbackä¸ºtrueæ—¶ï¼Œæ‰ä¸ºtrueï¼Œå…¶å®ƒæƒ…å†µä¸ºfalse // å¦‚æœéœ€è¦å›é€€ï¼Œåˆ™å°†urlæ¢ä¸ºhashæ¨¡å¼(/#å¼€å¤´) // this.baseæ¥è‡ªçˆ¶ç±» if (fallback &amp;&amp; checkFallback(this.base)) &#123; return &#125; ensureSlash() &#125;&#125; å®ƒç»§æ‰¿äºHistoryï¼Œæ‰€ä»¥ä¹Ÿè°ƒç”¨äº†super(router,base) æ£€æŸ¥äº†fallbackï¼Œçœ‹æ˜¯å¦éœ€è¦å›é€€ï¼Œå‰é¢è¯´è¿‡ï¼Œä¼ å…¥çš„fallbackåªæœ‰åœ¨ç”¨æˆ·è®¾ç½®äº†historyä¸”åˆä¸æ”¯æŒpushStateå¹¶ä¸”å¯ç”¨äº†å›é€€æ—¶æ‰ä¸ºtrue æ‰€ä»¥ï¼Œæ­¤æ—¶ï¼Œéœ€è¦å°†historyæ¨¡å¼çš„urlæ›¿æ¢æˆhashæ¨¡å¼ï¼Œå³æ·»åŠ ä¸Š#ï¼Œè¿™ä¸ªé€»è¾‘æ˜¯ç”±checkFallbackå®ç°çš„ å¦‚æœä¸æ˜¯fallbackï¼Œåˆ™ç›´æ¥è°ƒç”¨ensureSlashï¼Œç¡®ä¿urlæ˜¯ä»¥/å¼€å¤´çš„ æˆ‘ä»¬çœ‹ä¸‹checkFallbackã€ensureSlashå®ç° 12345678910111213141516171819202122232425262728293031323334// src/history/hash.js/** * æ£€æŸ¥å›é€€ï¼Œå°†urlè½¬æ¢ä¸ºhashæ¨¡å¼(æ·»åŠ /#) */function checkFallback(base) &#123; const location = getLocation(base) // åœ°å€ä¸ä»¥/#å¼€å¤´ï¼Œåˆ™æ·»åŠ ä¹‹ if (!/^\/#/.test(location)) &#123; window.location.replace(cleanPath(base + '/#' + location)) // è¿™ä¸€æ­¥å®ç°äº†urlæ›¿æ¢ return true &#125;&#125;/** * ç¡®ä¿urlæ˜¯ä»¥/å¼€å¤´ */function ensureSlash(): boolean &#123; const path = getHash() if (path.charAt(0) === '/') &#123; return true &#125; replaceHash('/' + path) return false&#125;// æ›¿æ¢hashè®°å½•function replaceHash(path) &#123; // æ”¯æŒpushStateï¼Œåˆ™ä¼˜å…ˆä½¿ç”¨replaceState if (supportsPushState) &#123; replaceState(getUrl(path)) &#125; else &#123; window.location.replace(getUrl(path)) &#125;&#125; æ˜¯ä¸æ˜¯å‘ç°HashHistoryå°‘äº†æ»šåŠ¨æ”¯æŒå’Œç›‘å¬hashChangeç›¸å…³é€»è¾‘ï¼Œè¿™æ˜¯å› ä¸ºhashChangeå­˜åœ¨ä¸€äº›ç‰¹æ®Šåœºæ™¯ï¼Œéœ€è¦ç­‰åˆ°mountsåæ‰èƒ½ç›‘å¬ è¿™ä¸€å—çš„é€»è¾‘å…¨æ”¾åœ¨äº†setupListenersæ–¹æ³•ä¸­ï¼ŒsetupListenersä¼šåœ¨VueRouterè°ƒç”¨initæ—¶è¢«è°ƒç”¨ï¼Œè¿™ä¸ªæˆ‘ä»¬åœ¨åˆå§‹åŒ–ç« èŠ‚å†çœ‹ HashHistoryç±»çš„å®ä¾‹åŒ–è¿‡ç¨‹å¦‚ä¸‹ hash-history.png AbstractHistory ç±» AbstractHistoryæ˜¯ç”¨äºéæµè§ˆå™¨ç¯å¢ƒçš„ ä½äºsrc/history/abstract.js 1234567891011121314151617// src/history/abstract.js/** * æ”¯æŒæ‰€æœ‰ JavaScript è¿è¡Œç¯å¢ƒï¼Œå¦‚ Node.js æœåŠ¡å™¨ç«¯ã€‚å¦‚æœå‘ç°æ²¡æœ‰æµè§ˆå™¨çš„ APIï¼Œè·¯ç”±ä¼šè‡ªåŠ¨å¼ºåˆ¶è¿›å…¥è¿™ä¸ªæ¨¡å¼ * * @export * @class AbstractHistory * @extends &#123;History&#125; */export class AbstractHistory extends History &#123; constructor(router: Router, base: ?string) &#123; // åˆå§‹åŒ–çˆ¶ç±» super(router, base) this.stack = [] this.index = -1 &#125;&#125; å¯ä»¥çœ‹åˆ°å®ƒçš„å®ä¾‹åŒ–æ˜¯æœ€ç®€å•çš„ï¼Œåªåˆå§‹åŒ–äº†çˆ¶ç±»ï¼Œå¹¶å¯¹indexã€stackåšäº†åˆå§‹åŒ– å‰é¢è¯´è¿‡ï¼Œéæµè§ˆå™¨ç¯å¢ƒï¼Œæ˜¯æ²¡æœ‰å†å²è®°å½•æ ˆçš„ï¼Œæ‰€ä»¥ä½¿ç”¨indexã€stackæ¥æ¨¡æ‹Ÿå†å²è®°å½•æ ˆ AbstractHistoryç±»çš„å®ä¾‹åŒ–è¿‡ç¨‹å¦‚ä¸‹ abstract-history.png å°ç»“ è¿™ä¸€å°èŠ‚æˆ‘ä»¬å¯¹ä¸‰ç§è·¯ç”±æ¨¡å¼åšäº†ç®€å•åˆ†æï¼Œå¹¶ä¸”è¿˜ä¸€èµ·çœ‹äº†å®ç°è¿™ä¸‰ç§è·¯ç”±æ¨¡å¼æ‰€éœ€è¦çš„Historyç±»æ˜¯å¦‚ä½•å®ä¾‹åŒ–çš„ åˆ°æ­¤ï¼ŒVueRouterçš„æ•´ä¸ªå®ä¾‹åŒ–è¿‡ç¨‹åŸºæœ¬è®²å®Œ ä¸‹é¢ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå›¾æ¥ç®€å•æ€»ç»“ä¸‹VueRouterå®ä¾‹åŒ–è¿‡ç¨‹ vue-router-instance.png åˆå§‹åŒ–æµç¨‹ åˆ†æå®Œå®ä¾‹åŒ–è¿‡ç¨‹ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹åˆå§‹åŒ–æ˜¯å¦‚ä½•è¿›è¡Œçš„ï¼Œéƒ½åšäº†å“ªäº›äº‹æƒ… è°ƒç”¨ init æ—¶æœº åœ¨åˆ†æå®‰è£…æµç¨‹æ—¶ï¼Œæˆ‘ä»¬çŸ¥é“VueRouteræ³¨å†Œäº†ä¸€ä¸ªå…¨å±€æ··å…¥ï¼Œæ··å…¥äº†beforeCreateé’©å­ ä»£ç å¦‚ä¸‹ 123456789101112131415161718192021// src/install.js// æ³¨å†Œå…¨å±€æ··å…¥Vue.mixin(&#123; beforeCreate () &#123; // åˆ¤æ–­æ˜¯å¦ä½¿ç”¨äº†vue-routeræ’ä»¶ if (isDef(this.$options.router)) &#123; ... this._router = this.$options.router // ä¿å­˜VueRouterå®ä¾‹ï¼Œthis.$options.routerä»…å­˜åœ¨äºVueæ ¹å®ä¾‹ä¸Šï¼Œå…¶å®ƒVueç»„ä»¶ä¸åŒ…å«æ­¤å±æ€§ï¼Œæ‰€ä»¥ä¸‹é¢çš„åˆå§‹åŒ–ï¼Œåªä¼šæ‰§è¡Œä¸€æ¬¡ // beforeCreate hookè¢«è§¦å‘æ—¶ï¼Œè°ƒç”¨ this._router.init(this) // åˆå§‹åŒ–VueRouterå®ä¾‹ï¼Œå¹¶ä¼ å…¥Vueæ ¹å®ä¾‹ &#125; else &#123; ... &#125; ... &#125;, destroyed () &#123; ... &#125;&#125;) æˆ‘ä»¬çŸ¥é“å…¨å±€æ··å…¥ï¼Œä¼šå½±å“åç»­åˆ›å»ºçš„æ‰€æœ‰Vueå®ä¾‹ï¼Œæ‰€ä»¥beforeCreateé¦–æ¬¡è§¦å‘æ˜¯åœ¨Vueæ ¹å®ä¾‹å®ä¾‹åŒ–çš„æ—¶å€™å³new Vue({router})æ—¶ï¼Œè§¦å‘åè°ƒç”¨routerå®ä¾‹çš„initæ–¹æ³•å¹¶ä¼ å…¥Vueæ ¹å®ä¾‹ï¼Œå®Œæˆåˆå§‹åŒ–æµç¨‹ï¼› ç”±äºrouterä»…å­˜åœ¨äºVueæ ¹å®ä¾‹çš„$optionsä¸Šï¼Œæ‰€ä»¥ï¼Œæ•´ä¸ªåˆå§‹åŒ–åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ æˆ‘ä»¬æ¥ä¸‹æ¥çœ‹ä¸‹initæ–¹æ³•å®ç° init æ–¹æ³• VueRouterçš„initæ–¹æ³•ä½äºsrc/index.js 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354// src/install.jsexport default class VueRouter &#123; // åˆå§‹åŒ–,appä¸ºVueæ ¹å®ä¾‹ init(app: any /* Vue component instance */) &#123; // å¼€å‘ç¯å¢ƒï¼Œç¡®ä¿å·²ç»å®‰è£…VueRouter process.env.NODE_ENV !== 'production' &amp;&amp; assert( install.installed, `not installed. Make sure to call \`Vue.use(VueRouter)\` ` + `before creating root instance.` ) this.apps.push(app) // ä¿å­˜å®ä¾‹ // set up app destroyed handler // https://github.com/vuejs/vue-router/issues/2639 // ç»‘å®šdestroyed hookï¼Œé¿å…å†…å­˜æ³„éœ² app.$once('hook:destroyed', () =&gt; &#123; // clean out app from this.apps array once destroyed const index = this.apps.indexOf(app) if (index &gt; -1) this.apps.splice(index, 1) // ensure we still have a main app or null if no apps // we do not release the router so it can be reused // éœ€è¦ç¡®ä¿å§‹ç»ˆæœ‰ä¸ªä¸»åº”ç”¨ if (this.app === app) this.app = this.apps[0] || null &#125;) // main app previously initialized // return as we don't need to set up new history listener // main appå·²ç»å­˜åœ¨ï¼Œåˆ™ä¸éœ€è¦é‡å¤åˆå§‹åŒ–history çš„äº‹ä»¶ç›‘å¬ if (this.app) &#123; return &#125; this.app = app const history = this.history if (history instanceof HTML5History) &#123; // è‹¥æ˜¯HTML5Historyç±»ï¼Œåˆ™ç›´æ¥è°ƒç”¨çˆ¶ç±»çš„transitionToæ–¹æ³•ï¼Œè·³è½¬åˆ°å½“å‰location history.transitionTo(history.getCurrentLocation()) &#125; else if (history instanceof HashHistory) &#123; // è‹¥æ˜¯HashHistoryï¼Œåœ¨è°ƒç”¨çˆ¶ç±»çš„transitionToæ–¹æ³•åï¼Œå¹¶ä¼ å…¥onCompleteã€onAbortå›è°ƒ const setupHashListener = () =&gt; &#123; // è°ƒç”¨HashHistory.setupListenersæ–¹æ³•ï¼Œè®¾ç½®hashchangeç›‘å¬ // åœ¨ route åˆ‡æ¢å®Œæˆä¹‹åå†è®¾ç½® hashchange çš„ç›‘å¬, // ä¿®å¤https://github.com/vuejs/vue-router/issues/725 // å› ä¸ºå¦‚æœé’©å­å‡½æ•° beforeEnter æ˜¯å¼‚æ­¥çš„è¯, beforeEnter é’©å­å°±ä¼šè¢«è§¦å‘ä¸¤æ¬¡. å› ä¸ºåœ¨åˆå§‹åŒ–æ—¶, å¦‚æœæ­¤æ—¶çš„ hash å€¼ä¸æ˜¯ä»¥ / å¼€å¤´çš„è¯å°±ä¼šè¡¥ä¸Š #/, è¿™ä¸ªè¿‡ç¨‹ä¼šè§¦å‘ hashchange äº‹ä»¶, å°±ä¼šå†èµ°ä¸€æ¬¡ç”Ÿå‘½å‘¨æœŸé’©å­, ä¹Ÿå°±æ„å‘³ç€ä¼šå†æ¬¡è°ƒç”¨ beforeEnter é’©å­å‡½æ•°. history.setupListeners() &#125; history.transitionTo( history.getCurrentLocation(), setupHashListener, // transitionToçš„onCompleteå›è°ƒ setupHashListener // transitionToçš„onAbortå›è°ƒ ) &#125; // è°ƒç”¨çˆ¶ç±»çš„listenæ–¹æ³•ï¼Œæ·»åŠ å›è°ƒï¼› // å›è°ƒä¼šåœ¨çˆ¶ç±»çš„updateRouteæ–¹æ³•è¢«è°ƒç”¨æ—¶è§¦å‘ï¼Œé‡æ–°ä¸ºapp._routeèµ‹å€¼ // ç”±äºapp._routeè¢«å®šä¹‰ä¸ºå“åº”å¼ï¼Œæ‰€ä»¥app._routeå‘ç”Ÿå˜åŒ–ï¼Œä¾èµ–app._routeçš„ç»„ä»¶(route-viewç»„ä»¶)éƒ½ä¼šè¢«é‡æ–°æ¸²æŸ“ history.listen((route) =&gt; &#123; this.apps.forEach((app) =&gt; &#123; app._route = route &#125;) &#125;) &#125;&#125; å¯ä»¥çœ‹åˆ°ï¼Œä¸»è¦åšäº†ä¸‹é¢å‡ ä»¶äº‹ æ£€æŸ¥äº†VueRouteræ˜¯å¦å·²ç»å®‰è£… ä¿å­˜äº†æŒ‚è½½routerå®ä¾‹çš„vueå®ä¾‹ VueRouteræ”¯æŒå¤šå®ä¾‹åµŒå¥—ï¼Œæ‰€ä»¥å­˜åœ¨this.appsæ¥ä¿å­˜æŒæœ‰routerå®ä¾‹çš„vueå®ä¾‹ æ³¨å†Œäº†ä¸€ä¸ªä¸€æ¬¡æ€§é’©å­destroyedï¼Œåœ¨destroyedæ—¶ï¼Œå¸è½½this.appï¼Œé¿å…å†…å­˜æ³„éœ² æ£€æŸ¥äº†this.appï¼Œé¿å…é‡å¤äº‹ä»¶ç›‘å¬ æ ¹æ®historyç±»å‹ï¼Œè°ƒç”¨transitionToè·³è½¬åˆ°ä¸åŒçš„åˆå§‹é¡µé¢ æ³¨å†ŒupdateRouteå›è°ƒï¼Œåœ¨routeræ›´æ–°æ—¶ï¼Œæ›´æ–°app._routeå®Œæˆé¡µé¢é‡æ–°æ¸²æŸ“ è¿™ä¸ªæˆ‘ä»¬åœ¨viewç»„ä»¶ç« èŠ‚ä¼šè¯¦ç»†è®² æˆ‘ä»¬é‡ç‚¹çœ‹ä¸‹transitionToç›¸å…³é€»è¾‘ setupListeners ä¸Šé¢è¯´åˆ°ï¼Œåœ¨åˆå§‹åŒ–æ—¶ï¼Œä¼šæ ¹æ®historyç±»å‹ï¼Œè°ƒç”¨transitionToè·³è½¬åˆ°ä¸åŒçš„åˆå§‹é¡µé¢ ä¸ºä»€ä¹ˆè¦è·³è½¬åˆå§‹é¡µé¢ï¼Ÿ å› ä¸ºåœ¨åˆå§‹åŒ–æ—¶ï¼Œurl å¯èƒ½æŒ‡å‘å…¶å®ƒé¡µé¢ï¼Œæ­¤æ—¶éœ€è¦è°ƒç”¨getCurrentLocationæ–¹æ³•ï¼Œä»å½“å‰ url ä¸Šè§£æå‡ºè·¯ç”±ï¼Œç„¶åè·³è½¬ä¹‹ å¯ä»¥çœ‹åˆ°HTML5Historyç±»å’ŒHashHistoryç±»è°ƒç”¨transitionToæ–¹æ³•çš„å‚æ•°ä¸å¤ªä¸€æ · å‰è€…åªä¼ å…¥äº†ä¸€ä¸ªå‚æ•° åè€…ä¼ å…¥äº†ä¸‰ä¸ªå‚æ•° æˆ‘ä»¬çœ‹ä¸‹transitionToæ–¹æ³•çš„æ–¹æ³•ç­¾å 12345678910111213141516// src/history/base.js...// çˆ¶ç±»export class History &#123; ... // è·¯ç”±è·³è½¬ transitionTo ( location: RawLocation, // åŸå§‹locationï¼Œä¸€ä¸ªurlæˆ–è€…æ˜¯ä¸€ä¸ªLocation interface(è‡ªå®šä¹‰å½¢çŠ¶ï¼Œåœ¨types/router.d.tsä¸­å®šä¹‰) onComplete?: Function, // è·³è½¬æˆåŠŸå›è°ƒ onAbort?: Function// è·³è½¬å¤±è´¥å›è°ƒ ) &#123; ... &#125;&#125; é¦–ä¸ªå‚æ•°æ˜¯éœ€è¦è§£æçš„åœ°å€ï¼Œç¬¬äºŒæ˜¯è·³è½¬æˆåŠŸå›è°ƒï¼Œç¬¬ä¸‰ä¸ªæ˜¯è·³è½¬å¤±è´¥å›è°ƒ æˆ‘ä»¬æ¥çœ‹ä¸‹HashHistory ç±»ä¸ºä½•éœ€è¦ä¼ å…¥å›è°ƒ å¯ä»¥çœ‹åˆ°ä¼ å…¥çš„æˆåŠŸã€å¤±è´¥å›è°ƒéƒ½æ˜¯setupHashListenerå‡½æ•°,setupHashListenerå‡½æ•°å†…éƒ¨è°ƒç”¨äº†history.setupListenersæ–¹æ³•ï¼Œè€Œè¿™ä¸ªæ–¹æ³•æ˜¯HashHistoryç±»ç‹¬æœ‰çš„ æ‰“å¼€src/history/hash.js 12345678910111213141516171819202122232425262728293031323334// src/history/hash.js // this is delayed until the app mounts // to avoid the hashchange listener being fired too early // ä¿®å¤#725;https://github.com/vuejs/vue-router/issues/725 // å› ä¸ºå¦‚æœé’©å­å‡½æ•° beforeEnter æ˜¯å¼‚æ­¥çš„è¯, beforeEnter é’©å­å°±ä¼šè¢«è§¦å‘ä¸¤æ¬¡. å› ä¸ºåœ¨åˆå§‹åŒ–æ—¶, å¦‚æœæ­¤æ—¶çš„ hash å€¼ä¸æ˜¯ä»¥ / å¼€å¤´çš„è¯å°±ä¼šè¡¥ä¸Š #/, è¿™ä¸ªè¿‡ç¨‹ä¼šè§¦å‘ hashchange äº‹ä»¶, å°±ä¼šå†èµ°ä¸€æ¬¡ç”Ÿå‘½å‘¨æœŸé’©å­, ä¹Ÿå°±æ„å‘³ç€ä¼šå†æ¬¡è°ƒç”¨ beforeEnter é’©å­å‡½æ•°. setupListeners () &#123; const router = this.router const expectScroll = router.options.scrollBehavior const supportsScroll = supportsPushState &amp;&amp; expectScroll // è‹¥æ”¯æŒscroll,åˆå§‹åŒ–scrollç›¸å…³é€»è¾‘ if (supportsScroll) &#123; setupScroll() &#125; // æ·»åŠ äº‹ä»¶ç›‘å¬ window.addEventListener( supportsPushState ? 'popstate' : 'hashchange', // ä¼˜å…ˆä½¿ç”¨popstate () =&gt; &#123; const current = this.current if (!ensureSlash()) &#123; return &#125; this.transitionTo(getHash(), route =&gt; &#123; if (supportsScroll) &#123; handleScroll(this.router, /* to*/route, /* from*/current, true) &#125; // ä¸æ”¯æŒpushStateï¼Œç›´æ¥æ›¿æ¢è®°å½• if (!supportsPushState) &#123; replaceHash(route.fullPath) &#125; &#125;) &#125; ) &#125; ä¸»è¦é€»è¾‘å¦‚ä¸‹ setupListenersä¸»è¦åˆ¤æ–­äº†æ˜¯å¦éœ€è¦æ”¯æŒæ»šåŠ¨è¡Œä¸ºï¼Œå¦‚æœæ”¯æŒï¼Œåˆ™åˆå§‹åŒ–ç›¸å…³é€»è¾‘ ç„¶åæ·»åŠ urlå˜åŒ–äº‹ä»¶ç›‘å¬ï¼Œä¹‹å‰è¯´è¿‡å®ç°è·¯ç”±æœ‰ä¸¤ç§æ–¹æ¡ˆpushState+popStateã€hash+hashChange å¯ä»¥çœ‹åˆ°è¿™é‡Œå³ä½¿æ˜¯HashHistoryä¹Ÿä¼šä¼˜å…ˆä½¿ç”¨popstateäº‹ä»¶æ¥ç›‘å¬urlçš„å˜åŒ– å½“urlå‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè°ƒç”¨transitionToè·³è½¬æ–°è·¯ç”± å¯ä»¥çœ‹åˆ°è¿™ä¸€å—çš„é€»è¾‘å’ŒHTML5Historyç±»åœ¨å®ä¾‹åŒ–æ—¶å¤„ç†çš„é€»è¾‘å¾ˆç±»ä¼¼ 123456789101112131415161718192021222324252627282930// src/history/html5.jsexport class HTML5History extends History &#123; constructor (router: Router, base: ?string) &#123; ... // æ£€æµ‹æ˜¯å¦éœ€è¦æ”¯æŒscroll const expectScroll = router.options.scrollBehavior const supportsScroll = supportsPushState &amp;&amp; expectScroll // è‹¥æ”¯æŒscroll,åˆå§‹åŒ–scrollç›¸å…³é€»è¾‘ if (supportsScroll) &#123; setupScroll() &#125; // è·å–åˆå§‹location const initLocation = getLocation(this.base) // ç›‘å¬popstateäº‹ä»¶ window.addEventListener('popstate', e =&gt; &#123; ... // è·¯ç”±åœ°å€å‘ç”Ÿå˜åŒ–ï¼Œåˆ™è·³è½¬ï¼Œå¹¶åœ¨è·³è½¬åå¤„ç†æ»šåŠ¨ this.transitionTo(location, route =&gt; &#123; if (supportsScroll) &#123; handleScroll(router, route, current, true) &#125; &#125;) &#125;) &#125;&#125; é‚£ä¸ºä½•äºŒè€…å¤„ç†çš„æ—¶æœºä¸åŒå‘¢ï¼Ÿ HTML5Histroyåœ¨å®ä¾‹åŒ–æ—¶ç›‘å¬äº‹ä»¶ HashHistoryåœ¨åˆæ¬¡è·¯ç”±è·³è½¬ç»“æŸåç›‘å¬äº‹ä»¶ è¿™æ˜¯ä¸ºäº†ä¿®å¤#725 é—®é¢˜ å¦‚æœbeforeEnteræ˜¯å¼‚æ­¥çš„è¯ï¼ŒbeforeEnterå°±ä¼šè§¦å‘ä¸¤æ¬¡ï¼Œè¿™æ˜¯å› ä¸ºåœ¨åˆå§‹åŒ–æ—¶ï¼Œhash å€¼ä¸æ˜¯ / å¼€å¤´çš„è¯å°±ä¼šè¡¥ä¸Š#/ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šè§¦å‘ hashchange äº‹ä»¶ï¼Œæ‰€ä»¥ä¼šå†èµ°ä¸€æ¬¡ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œå¯¼è‡´å†æ¬¡è°ƒç”¨ beforeEnter é’©å­å‡½æ•°ã€‚æ‰€ä»¥åªèƒ½å°†hashChangeäº‹ä»¶çš„ç›‘å¬å»¶è¿Ÿåˆ°åˆå§‹è·¯ç”±è·³è½¬å®Œæˆåï¼› å°ç»“ é’ˆå¯¹ init æµç¨‹ï¼Œæ€»ç»“äº†ä¸‹é¢çš„æ´»åŠ¨å›¾ init.png æ€»ç»“ æ–‡ç« ä¸»è¦ä»å‰ç«¯è·¯ç”±çš„æ•´ä½“è®¾è®¡æ€è·¯å¼€å§‹ï¼Œé€æ­¥åˆ†æå‰ç«¯è·¯ç”±è®¾è®¡çš„åŸºæœ¬åŸåˆ™ï¼Œç†æ¸…è®¾è®¡æ€è·¯ ç„¶åä»‹ç»äº†è´¯ç©¿å…¨å±€çš„vue-routerå‡ ä¸ªæœ¯è¯­ å¯¹æœ¯è¯­æœ‰ä¸ªå¤§æ¦‚å°è±¡åï¼Œæˆ‘ä»¬åˆä»‹ç»äº†vue-routerçš„ç›®å½•ç»“æ„ï¼Œå…¶æ˜¯å¦‚ä½•è¿›è¡Œåˆ†å±‚çš„ äº†è§£ç›®å½•ç»“æ„åï¼Œæˆ‘ä»¬ä»å®‰è£…å¼€å§‹å‰–æï¼Œäº†è§£vue-routeråœ¨å®‰è£…æ—¶éƒ½åšäº†å“ªäº›äº‹ å®‰è£…ç»“æŸï¼Œæˆ‘ä»¬åˆä»‹ç»äº†å‡ ä¸ªHistoryç±»ä¹‹é—´æ˜¯æ€æ ·çš„ç»§æ‰¿å…³ç³»ï¼Œå…¶åˆæ˜¯å¦‚ä½•å®ä¾‹åŒ–çš„ å®ä¾‹åŒ–ç»“æŸï¼Œæˆ‘ä»¬æœ€åä»‹ç»äº†åˆå§‹åŒ–çš„è¿‡ç¨‹ PS åé¢è¿˜ä¼šä»‹ç»å…¶ä½™éƒ¨åˆ†ï¼Œå¦‚æœè§‰å¾—è¿˜è¡Œï¼Œå¯ä»¥ç»™ä¸ªèµå“¦ âœ¨ ä¸ªäººgithubï¼Œä¹Ÿæ€»ç»“äº†ä¸€äº›ä¸œè¥¿ï¼Œæ¬¢è¿ star åŸºäº canvas çš„ç»˜å›¾æ¿drawing-board å‰ç«¯å…¥é—¨ demoã€æœ€ä½³å®è·µé›†åˆ fe-awesome-demos ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆåˆ«åçš„vue-cli-pluginhttps://www.npmjs.com/package/vue-cli-plugin-auto-alias å‚è€ƒ https://github.com/dwqs/blog/issues/53 https://github.com/dwqs/blog/issues/54 https://github.com/dwqs/blog/issues/55 https://github.com/vuejs/vue-router/issues/2184#issuecomment-393484643 https://juejin.im/post/5e456513f265da573c0c6d4b https://juejin.im/post/584040e1ac502e006cbedb23 https://juejin.im/post/5df0ada0f265da33d56d1a2f https://juejin.im/post/5dbed0bef265da4cff701f68 https://www.jianshu.com/p/29e8214d0bee https://ustbhuangyi.github.io/vue-analysis/v2/vue-router/ https://blog.liuyunzhuge.com/2020/04/08/vue-router æºç ï¼šcreate-matcher/]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>vue-router</tag>
        <tag>æºç è§£æ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ssh-multiple-account]]></title>
    <url>%2F2020%2F03%2F27%2Fssh-multiple-account%2F</url>
    <content type="text"><![CDATA[ssh é…ç½®å¤šè´¦æˆ· å…¬å¸éƒ¨ç½²äº†gitlabï¼Œè‡ªå·±åŒæ—¶åœ¨ç”¨githubï¼Œæ‰€ä»¥éœ€è¦é…ç½®ä¸¤å¥—sshè´¦æˆ· ç‰¹å°†ç›¸å…³æµç¨‹è®°å½•ä¸‹ï¼Œæ–¹ä¾¿åæœŸæŸ¥é˜… ç”Ÿæˆ key1234ssh-keygen -t rsa -C 'xxx@email.com' -f ~/.ssh/xxx-rsa# -t æŒ‡å®šç±»å‹ï¼Œä¸éœ€è°ƒæ•´ï¼Œrsaå³å¯# -C æŒ‡å®šcommentï¼Œä¸€èˆ¬ä¸ºé‚®ç®±ï¼Œä¼šåœ¨ç”Ÿæˆçš„å…¬é’¥æœ€åä½“ç°# -f æŒ‡å®šæ–‡ä»¶ï¼Œå¦‚æœæ˜¯å•è´¦æˆ·ï¼Œå¯ä»¥ä¸ç”¨æŒ‡å®šï¼›é»˜è®¤ç”Ÿæˆid_rsaã€id_rsa.pubï¼›~åœ¨windowsä¸­ä»£è¡¨c/users/ç”¨æˆ·å æ‰§è¡Œä¸Šè¿°å‘½ä»¤åï¼Œä¼šåœ¨~/.ssh/ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªxxx-rsaå’Œxxx-rsa.pubä¸¤ä¸ªæ–‡ä»¶ï¼Œå‰è€…æ˜¯éœ€è¦ä¿å­˜åœ¨æœ¬åœ°çš„ç§é’¥ï¼Œåè€…æ˜¯éœ€è¦ä¸Šä¼ åˆ°gitlabæˆ–è€…githubä¸Šçš„å…¬é’¥ ç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šè¯¢é—®ä½ è®¾ç½®ä½¿ç”¨ç§é’¥æ—¶çš„å¯†ç (passphrases) å¯ä»¥å¿½ç•¥ å¦‚æœè®¾ç½®äº†ï¼ŒåæœŸä½¿ç”¨sshæ—¶ï¼Œè¦ä½¿ç”¨ssh-agentæ¥ç®¡ç†sshå¯†ç ï¼Œå®ç°å…å¯†ç™»å½•ï¼Œæˆ–è€…æ‰‹åŠ¨è¾“å…¥sshå¯†ç  å»ºè®®å¿½ç•¥ ä¸Šä¼ å…¬é’¥ githubå¯ä»¥åœ¨https://github.com/settings/keysé¡µé¢ä¸Šä¼ å…¬é’¥ gitlabå¯åœ¨ç”¨æˆ·è®¾ç½®é¡µé¢ä¸Šä¼ å…¬é’¥ é…ç½® æŒ‡å®šä¸åŒçš„åŸŸï¼Œä½¿ç”¨ä¸åŒçš„é…ç½® 1234567891011# git.xxx.comçš„é…ç½®Host git.xxx.com HostName git.xxx.com IdentityFile ~/.ssh/gitlab-rsa User git# githubçš„é…ç½®Host github.com HostName github.com IdentityFile ~/.ssh/github-rsa User git HoståŸŸåï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºä¸‹é¢ä¸€å¥—é…ç½®çš„åˆ«åï¼Œåœ¨sshå‘½ä»¤ä¸­å¯ç›´æ¥ä½¿ç”¨åˆ«åï¼› å»ºè®®è®¾ç½®æˆè·ŸHostNameå€¼ä¸€æ ·ï¼Œåœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œä½¿ç”¨åˆ«åï¼Œä¼šå‡ºç°é—®é¢˜ï¼Œæ‰€ä»¥å»ºè®®Hostã€HostNameè®¾ç½®æˆä¸€æ ·çš„ HostNameï¼Œå…·ä½“åŸŸåï¼Œå®Œæ•´åŸŸå IdentityFileå½“å‰åŸŸçš„é…ç½®æ–‡ä»¶(ç§é’¥)åœ°å€ Userç”¨æˆ·ï¼Œè¿™é‡Œçš„ç”¨æˆ·æ˜¯ç™»å½•åå°æœåŠ¡å™¨çš„ç”¨æˆ·åï¼Œä¸€èˆ¬éƒ½ä¸ºgitï¼Œä¸éœ€è¦ä¿®æ”¹ #åé¢ä¸ºæ³¨é‡Š sshé…ç½®æ–‡ä»¶å…·ä½“è§£é‡Šå¯å‚è€ƒ https://www.cnblogs.com/xjshi/p/9146296.html æµ‹è¯•123456ssh -T user@HostName# æˆ–è€…ssh -T Host # ä½¿ç”¨Hostå®šä¹‰çš„ä¸€å¥—é…ç½®# ä¾‹å­ssh -T git@github.com ç”Ÿæˆå¤šä¸ª key çš„å®ä¾‹ ç”Ÿæˆgithubã€gitlabçš„sshé…ç½® ç”Ÿæˆç›¸åº” key12345# ç”Ÿæˆgithubssh-keygen -t rsa -C 'test1@qq.com' -f ~/.ssh/github-rsa# ç”Ÿæˆgitlabssh-keygen -t rsa -C 'test2@qq.com' -f ~/.ssh/gitlab-rsa ç”Ÿæˆåï¼Œ~/.ssh/ç›®å½•ä¸‹åº”è¯¥ä¼šæœ‰ä¸‹é¢ 4 ä¸ªæ–‡ä»¶ ssh.png åˆ†åˆ«ä¸Šä¼ å…¬é’¥ ä¸Šä¼ githubå…¬é’¥ æ‰“å¼€ç”¨æˆ·ä¸‹é¢çš„settings-&gt;SSH and GPG keysé¡µé¢ï¼Œæˆ–è€…ç›´æ¥è®¿é—®https://github.com/settings/keys ç‚¹å‡»New SSH key è®°äº‹æœ¬æ‰“å¼€github-rsa.pubå¹¶æ‹·è´å†…å®¹åˆ°githubå³å¯ ä¸Šä¼ gitlabå…¬é’¥ æ­¥éª¤ç±»ä¼¼github æ‹·è´gitlab-rsa.pubå†…å®¹åˆ°ç›¸åº”å…¬é’¥å¡«å†™å¤„å³å¯ ç¼–å†™é…ç½®æ–‡ä»¶123456789Host gitlab..com HostName gitlab.com IdentityFile ~/.ssh/gitlab-rsa User gitHost github.com HostName github.com IdentityFile ~/.ssh/github-rsa User git æµ‹è¯•1ssh -T git@github.com å‡ºç°ä¸‹å›¾æç¤ºå³å¯ ssh-2.png åŒç†ï¼Œæµ‹è¯•gitlabå³å¯ github é…ç½®ç›¸å…³é—®é¢˜ å¯ä»¥å‚è€ƒ https://help.github.com/cn/github/authenticating-to-github/connecting-to-github-with-ssh å‚è€ƒ https://www.cnblogs.com/popfisher/p/5731232.html https://www.cnblogs.com/hafiz/p/8146324.html https://help.github.com/cn/github/authenticating-to-github/connecting-to-github-with-ssh https://www.cnblogs.com/xjshi/p/9146296.html]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>gitlab</tag>
        <tag>ssh</tag>
        <tag>github</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vuepress]]></title>
    <url>%2F2020%2F03%2F26%2Fvuepress%2F</url>
    <content type="text"><![CDATA[vuepressä»‹ç» VuePressæ˜¯ä¸€ä¸ªé™æ€ç½‘ç«™ç”Ÿæˆå™¨ ç”±VuePressç”Ÿæˆçš„é™æ€ç½‘ç«™æ˜¯ä¸€ä¸ªç”±Vueã€vue-routerã€webpacké©±åŠ¨çš„SPAå•é¡µåº”ç”¨ æ„å»ºæ—¶ï¼Œä¼šé‡‡ç”¨é¢„æ¸²æŸ“çš„æœºåˆ¶ï¼Œç”Ÿæˆæ‰€æœ‰é™æ€é¡µé¢ï¼Œæ‰€ä»¥æœ‰éå¸¸å¥½çš„åŠ è½½æ€§èƒ½å’ŒSEO æœ¬æ–‡å¤§éƒ¨åˆ†å†…å®¹æ‘˜æŠ„è‡ªvuepresså®˜ç½‘ï¼ŒåŠ äº†ä¸€äº›è‡ªå·±çš„ç†è§£ï¼Œæ˜ç¡®äº†ä¸€äº›è¯­ä¹‰ ä¸€æ¥åŠ æ·±å°è±¡ äºŒæ¥æ–¹ä¾¿è‡ªå·±æŸ¥é˜… å®‰è£… ç¡®ä¿node &gt;=8 æœ¬åœ°å®‰è£…å³å¯ 1yarn add -D vuepress # æˆ–è€…ï¼šnpm install -D vuepress ç›®å½•ç»“æ„12345678910111213141516171819202122.â”œâ”€â”€ docs // ç›®æ ‡ç›®å½•targetDirï¼ŒvuepressåŸºäºæ­¤ç›®å½•å·¥ä½œâ”‚ â”œâ”€â”€ .vuepress (å¯é€‰çš„) // vuepressé…ç½®ç›®å½•â”‚ â”‚ â”œâ”€â”€ components (å¯é€‰çš„) // å†…éƒ¨çš„vueç»„ä»¶ä¼šè‡ªåŠ¨è¢«æ³¨å†Œä¸ºå…¨å±€çš„å¼‚æ­¥ç»„ä»¶â”‚ â”‚ â”œâ”€â”€ theme (å¯é€‰çš„) // é…ç½®çš„è‡ªå®šä¹‰ä¸»é¢˜â”‚ â”‚ â”‚ â””â”€â”€ Layout.vue // è‡ªå®šä¹‰ä¸»é¢˜å¿…é¡»è¦çš„å¸ƒå±€ç»„ä»¶â”‚ â”‚ â”œâ”€â”€ public (å¯é€‰çš„) // å…¬ç”¨èµ„æºâ”‚ â”‚ â”œâ”€â”€ styles (å¯é€‰çš„) // è‡ªå®šä¹‰æ ·å¼â”‚ â”‚ â”‚ â”œâ”€â”€ index.styl // å…¨å±€æ ·å¼æ–‡ä»¶â”‚ â”‚ â”‚ â””â”€â”€ palette.styl // stylus é¢œè‰²å¸¸é‡â”‚ â”‚ â”œâ”€â”€ templates (å¯é€‰çš„, è°¨æ…é…ç½®)â”‚ â”‚ â”‚ â”œâ”€â”€ dev.html // å¼€å‘ç¯å¢ƒçš„ HTML æ¨¡æ¿æ–‡ä»¶â”‚ â”‚ â”‚ â””â”€â”€ ssr.html // vue ssr çš„æ¨¡æ¿æ–‡ä»¶â”‚ â”‚ â”œâ”€â”€ config.js (å¯é€‰çš„) // é…ç½®æ–‡ä»¶â”‚ â”‚ â””â”€â”€ enhanceApp.js (å¯é€‰çš„) // ç”¨æ¥å¢å¼ºå®¢æˆ·ç«¯å®ä¾‹ç”¨ï¼Œå¯åœ¨æ­¤æ–‡ä»¶ä¸­ä½¿ç”¨ä¸‰æ–¹UIåº“ï¼ˆå¦‚element-uiï¼‰â”‚ â”‚â”‚ â”œâ”€â”€ README.mdâ”‚ â”œâ”€â”€ guideâ”‚ â”‚ â””â”€â”€ README.mdâ”‚ â””â”€â”€ config.mdâ”‚â””â”€â”€ package.json docsæ˜¯vuepressçº¦å®šçš„ç›®æ ‡ç›®å½•(å·¥ä½œç›®å½•)targetDir è·¯ç”±çš„ç”Ÿæˆæ˜¯ç›¸å¯¹äºtargetDir .vuepressç›®å½•æ˜¯vuepressçš„é…ç½®ç›®å½• docsç›®å½•ä¸‹é™¤äº†.vuepressæ–‡ä»¶å¤¹ä»¥å¤–çš„æ‰€æœ‰.mdéƒ½å°†è¢«ç¼–è¯‘ä¸ºä¸€ä¸ªé¡µé¢ æ‰€æœ‰README.mdã€index.mdéƒ½ä¼šè¢«ç¼–è¯‘ä¸ºindex.html ä¸Šè¿°ç›®å½•å¯¹åº”çš„é»˜è®¤è·¯ç”±ä¸º æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ é¡µé¢è·¯ç”±åœ°å€ /README.md / /guide/README.md /guide/ /config.md /config.html vuepresséµå¾ªçº¦å®šå¤§äºé…ç½®åŸåˆ™ï¼Œå¹¶ä¸”æœ¬èº«è‡ªå¸¦ä¸€å¥—é»˜è®¤ä¸»é¢˜@vuepress/theme-blog(ä¸»è¦ç”¨æ¥ä¹¦å†™æ–‡æ¡£)ï¼Œæ‰€ä»¥ä¸Šè¿°çš„ç›®å½•åŸºæœ¬éƒ½æ˜¯å¯é€‰çš„ï¼› scripts ä¸»è¦æä¾›äº† 123456&#123; "scripts": &#123; "dev": "vuepress dev docs", // å¼€å‘ï¼Œdocsä¸ºtargetDir "build": "vuepress build docs" // ç¼–è¯‘ï¼Œdocsä¸ºtargetDir &#125;&#125; é…ç½®åŸºæœ¬é…ç½® targetDir/.vuepress/config.jsæ˜¯vuepressç½‘ç«™å¿…é¡»æœ‰çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ ä¸»é¢˜é…ç½® vuepresså†…ç½®ä¸€ä¸ªé»˜è®¤ä¸»é¢˜@vuepress/plugin-blogï¼Œå°±æ˜¯vueå®˜ç½‘ä½¿ç”¨çš„ä¸»é¢˜ å®ƒé€‚åˆç”¨æ¥ä¹¦å†™æŠ€æœ¯æ–‡æ¡£ é…ç½®ä¸»é¢˜ é…ç½®é»˜è®¤ä¸»é¢˜@vuepress/plugin-blog targetDir/.vuepress/config.jsä¸­ä¸è¦æŒ‡å®šthemeå­—æ®µ(è®©å…¶ä½¿ç”¨é»˜è®¤çš„ä¸»é¢˜)ï¼Œç›´æ¥é…ç½®themeConfigå­—æ®µå³å¯ 123456// .vuepress/config.js&#123; themeConfig:&#123; logo: '/assets/img/logo.png', &#125;&#125; é»˜è®¤ä¸»é¢˜çš„é…ç½®é¡¹å¯ä»¥æŸ¥çœ‹ https://vuepress.vuejs.org/zh/theme/default-theme-config.html#%E9%A6%96%E9%A1%B5 é…ç½®è‡ªå®šä¹‰ä¸»é¢˜ é¦–å…ˆå®‰è£…è‡ªå®šä¹‰ä¸»é¢˜ ç„¶åç”¨themeå­—æ®µæŒ‡å®šéœ€è¦çš„themeä¸»é¢˜ é…ç½®themeConfigå­—æ®µæ¥æ§åˆ¶è‡ªå®šä¹‰ä¸»é¢˜æ ·å¼ 1234567// .vuepress/config.js&#123; theme: 'modern-blog', themeConfig: &#123; // vuepress-theme-modern-blogä¸»é¢˜çš„é…ç½® &#125;&#125; åº”ç”¨çº§é…ç½® vuepressç”Ÿæˆçš„ç½‘ç«™å…¶å®å°±ä¸€ä¸ªvueåº”ç”¨ï¼Œæ‰€ä»¥å¯ä»¥å¯¹vueå®ä¾‹åšä¸€äº›å¢å¼º ä¾‹å¦‚ä½¿ç”¨ UI æ¡†æ¶ åˆ›å»ºä¸€ä¸ª.vuepress/enhanceApp.jså¹¶å¯¼å‡ºä¸€ä¸ªå‡½æ•°ï¼Œvuepressä¼šè¯»å–æ­¤æ–‡ä»¶ 12345678910111213141516// .vurepress/enhanceApp.jsimport ElementUI from "element-ui";import "element-ui/lib/theme-chalk/index.css";// ä½¿ç”¨å¼‚æ­¥å‡½æ•°ä¹Ÿæ˜¯å¯ä»¥çš„export default (&#123; Vue, // VuePress æ­£åœ¨ä½¿ç”¨çš„ Vue æ„é€ å‡½æ•° options, // é™„åŠ åˆ°æ ¹å®ä¾‹çš„ä¸€äº›é€‰é¡¹ router, // å½“å‰åº”ç”¨çš„è·¯ç”±å®ä¾‹ siteData, // ç«™ç‚¹å…ƒæ•°æ® isServer, // å½“å‰åº”ç”¨é…ç½®æ˜¯å¤„äº æœåŠ¡ç«¯æ¸²æŸ“ æˆ– å®¢æˆ·ç«¯&#125;) =&gt; &#123; // ...åšä¸€äº›å…¶ä»–çš„åº”ç”¨çº§åˆ«çš„ä¼˜åŒ– Vue.use(ElementUI);&#125;; é™æ€èµ„æº æ¯ä¸ª.mdæ–‡ä»¶éƒ½ä¼šè¢«ç¼–è¯‘æˆä¸€ä¸ªvueç»„ä»¶ï¼Œé‡Œé¢å¼•ç”¨åˆ°çš„èµ„æºä¼šè¢«webpackçš„loaderå¤„ç† ä¾‹å¦‚å›¾ç‰‡èµ„æºï¼Œä¼šè¢« url-loader å’Œ file-loader å¤„ç† ç›¸å¯¹è·¯å¾„ æ‰€ä»¥å¯ä»¥é€šè¿‡ç›¸å¯¹è·¯å¾„çš„å½¢å¼æ¥å¼•ç”¨èµ„æº ä¾‹å¦‚å¦‚ä¸‹ç›®å½•ï¼Œå¯ä»¥åœ¨a.mdä¸­å¼•ç”¨assetsä¸­çš„å›¾ç‰‡ 123456789101112131415.â”œâ”€â”€ docs // ç›®æ ‡ç›®å½•targetDirï¼ŒvuepressåŸºäºæ­¤ç›®å½•å·¥ä½œâ”‚ â”‚â”‚ â”œâ”€â”€ .vuepress/â”‚ â”œâ”€â”€ README.mdâ”‚ â”œâ”€â”€ guideâ”‚ â”‚ â”œâ”€â”€ test.jpgâ”‚ â”‚ â””â”€â”€ README.mdâ”‚ â””â”€â”€ config.mdâ”‚â””â”€â”€ package.json// docs/guide/README.md// å¼•ç”¨test.jpg![test.jpg](./test.jpg) è·¯å¾„åˆ«å å¯ä»¥é€šè¿‡é…ç½®webpack aliasåˆ«åï¼Œç„¶åä½¿ç”¨~åˆ«åæ¥å‘Šè¯‰webpackåŠ è½½æŸä¸ªèµ„æº 123456789101112131415// .vuepress/config.jsmodule.exports = &#123; // é…ç½®åˆ«å configureWebpack: &#123; resolve: &#123; alias: &#123; '@alias': 'path/to/some/dir' &#125; &#125; &#125;&#125;// åœ¨.mdä¸­é€šè¿‡åˆ«åå¼•ç”¨èµ„æº![test.png](~@alias/test.png) åŠ è½½ä¾èµ–åŒ…ä¸­èµ„æº å¼•ç”¨èµ„æºæ—¶ï¼Œå¯ä»¥é€šè¿‡~å‰ç¼€æ¥æ˜ç¡®åœ°æŒ‡å‡ºè¿™æ˜¯ä¸€ä¸ª webpack çš„æ¨¡å—è¯·æ±‚ï¼Œè¿™å°†å…è®¸ä½ é€šè¿‡ webpackæ¥å¼•ç”¨npmåŒ…ä¸­çš„èµ„æº 1![Image from dependency](~some-dependency/image.png) å…¬å…±èµ„æº é¡¹ç›®çº§çš„å…¬å…±èµ„æºï¼Œä¾‹å¦‚favicon.icoï¼Œå¯ä»¥ç›´æ¥æ”¾åœ¨.vuepress/publicæ–‡ä»¶å¤¹ä¸­ï¼Œå®ƒä»¬æœ€ç»ˆä¼šè¢«å¤åˆ¶åˆ°ç”Ÿæˆçš„é™æ€æ–‡ä»¶å¤¹ä¸­ å¯ä»¥é€šè¿‡é¡¹ç›®æ ¹è·¯å¾„æ¥å¼•ç”¨ 1![favicon](/favicon.ico) å¦‚æœç½‘ç«™æ²¡æœ‰éƒ¨ç½²åˆ°æ ¹è·¯å¾„ä¸Šï¼Œåˆ™éœ€è¦è®¾ç½®.vurepress/config.jsä¸­çš„baseåŸºç¡€è·¯å¾„ï¼Œè¿™ä¸ªæ—¶å€™å¼•ç”¨é¡¹ç›®æ ¹è·¯å¾„çš„å…¬å…±èµ„æºï¼Œå°±éœ€è¦å¡«å†™å®Œæ•´è·¯å¾„ ä¾‹å¦‚ é¡¹ç›®éƒ¨ç½²åˆ°ç½‘ç«™çš„/blogç›®å½•(éæ ¹è·¯å¾„)ä¸‹ æ‰€ä»¥favicon.icoçš„å¼•ç”¨è·¯å¾„éœ€è¦è°ƒæ•´æˆ/blog/favicon.ico vuepressæä¾›äº†ä¸€ä¸ªå¿«æ·æ–¹æ³•æ¥å¼•ç”¨éƒ¨ç½²åŸºç¡€è·¯å¾„ï¼›ä½¿ç”¨$withBaseæ¥å¼•ç”¨ï¼Œvurepssä¼šä¿è¯$withBaseè¿”å›æ­£ç¡®çš„è·¯å¾„ 1&lt;img :src="$withBase('/foo.png')" alt="foo"&gt; markdown å¸¸è§„èƒ½åŠ›é“¾æ¥ vuepressä¸­æ¯ç¯‡æ–‡ç« éƒ½ä¼šç”Ÿæˆä¸€ä¸ªé“¾æ¥ï¼Œåœ¨mdå†…éƒ¨å¯ä»¥ä½¿ç”¨å¸¸è§„mdé“¾æ¥è·³è½¬å½¢å¼æ¥è®¿é—® 1234567891011121314151617181920212223242526// æœ‰ä¸‹é¢çš„ç›®å½•. â”œâ”€ README.md â”œâ”€ foo â”‚ â”œâ”€ README.md â”‚ â”œâ”€ one.md â”‚ â””â”€ two.md â””â”€bar â”œâ”€ README.md â”œâ”€ three.md â””â”€ four.md// å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼è·³è½¬[Home](/)&lt;!-- è·³è½¬åˆ°æ ¹éƒ¨çš„ README.md --&gt;[foo](/foo/)&lt;!-- è·³è½¬åˆ° foo æ–‡ä»¶å¤¹çš„ index.html --&gt;[foo heading](./#heading)&lt;!-- è·³è½¬åˆ° foo/index.html çš„ç‰¹å®šæ ‡é¢˜ä½ç½® --&gt;[bar - three](../bar/three.md)&lt;!-- å…·ä½“æ–‡ä»¶å¯ä»¥ä½¿ç”¨ .md ç»“å°¾ï¼ˆæ¨èï¼‰ --&gt;[bar - four](../bar/four.html)&lt;!-- ä¹Ÿå¯ä»¥ç”¨ .html --&gt; å¤–éƒ¨é“¾æ¥ æ‰€æœ‰å¤–éƒ¨é“¾æ¥(http/httpså¼€å¤´)ï¼Œvuepressä¼šè‡ªåŠ¨ä¸ºé€šè¿‡OutboundLinkç»„ä»¶æ·»åŠ ä¸Šå¤–éƒ¨é“¾æ¥æ ‡è¯† outside.png tocã€Emojiã€è‡ªå®šä¹‰å®¹å™¨ å¯ä»¥ç”Ÿæˆç›®å½•(toc)ï¼Œä½¿ç”¨emojiè¡¨æƒ…ã€è‡ªå®šä¹‰å®¹å™¨ toc 123// xxx.md // ç›®å½• [[toc]] // emoji :tada: :100: // è‡ªå®šä¹‰å®¹å™¨ ::: tipè¿™æ˜¯ä¸€ä¸ªæç¤º ::: ::: warning è¿™æ˜¯ä¸€ä¸ªè­¦å‘Š ::: ::: danger è¿™æ˜¯ä¸€ä¸ªå±é™©è­¦å‘Š :::::: details è¿™æ˜¯ä¸€ä¸ªè¯¦æƒ…å—ï¼Œåœ¨ IE / Edge ä¸­ä¸ç”Ÿæ•ˆ ::: toc.png emoji 1// xxx.md // emoji :tada: :100: emoji.png è‡ªå®šä¹‰å®¹å™¨ vuepressä½¿ç”¨vuepress-plugin-containeræ’ä»¶å®ç°è‡ªå®šä¹‰å®¹å™¨ 123// xxx.md // è‡ªå®šä¹‰å®¹å™¨ ::: tip è¿™æ˜¯ä¸€ä¸ªæç¤º ::: ::: warning è¿™æ˜¯ä¸€ä¸ªè­¦å‘Š :::::: danger è¿™æ˜¯ä¸€ä¸ªå±é™©è­¦å‘Š ::: ::: details è¿™æ˜¯ä¸€ä¸ªè¯¦æƒ…å—ï¼Œåœ¨ IE / Edgeä¸­ä¸ç”Ÿæ•ˆ ::: tips.png å…¶ä»–å¸¸è§„åŠŸèƒ½å¯ä»¥å‚è€ƒhttps://vuepress.vuejs.org/zh/guide/markdown.html markdown å¢å¼º vuepressé©±åŠ¨çš„ç½‘ç«™ï¼Œmdæ–‡ä»¶é™¤äº†å¯ä»¥ç”¨å¸¸è§„çš„mdè¯­æ³•å’Œç‰¹æ€§ï¼Œè¿˜èƒ½ä½¿ç”¨ä¸€äº›vueèµ‹äºˆçš„èƒ½åŠ› åŸºæœ¬åŸç† vuepressä½¿ç”¨markdown-itæ¥æ¸²æŸ“markdownï¼Œå°†å…¶ç¼–è¯‘æˆhtml,ç„¶åé€šè¿‡vue-loaderï¼Œæ¥ç€åšä¸ºä¸€ä¸ªVueç»„ä»¶ä¼ ç»™vue-loader ä¾‹å­ test.mdé€šè¿‡markdown-itç¼–è¯‘æˆ html å­—ç¬¦ä¸² vuepresså°†å…¶ç»„è£…æˆä¸€ä¸ªvueç»„ä»¶ ç»„è£…å¥½çš„vueç»„ä»¶ä¼ é€’ç»™vue-loaderã€ç»“åˆSSRç”Ÿæˆæœ€ç»ˆçš„test.html æ‰€ä»¥åœ¨vuepressé©±åŠ¨çš„ç½‘ç«™ä¸­ï¼Œå¯ä»¥mdæ–‡ä»¶ä¸­ä½¿ç”¨vueçš„ä¸€äº›ç‰¹æ€§ï¼Œä¾‹å¦‚ æ’å€¼è¡¨è¾¾å¼ å¯ä»¥åœ¨mdä¸­ä½¿ç”¨vueçš„æ’å€¼è¡¨è¾¾å¼ 1// xxx.md è¡¨è¾¾å¼çš„å€¼ä¸º&#123;&#123; 1 + 1 &#125;&#125; // è¾“å‡º è¡¨è¾¾å¼çš„å€¼ä¸º2 è½¬ä¹‰ ç”±äºmdä¸­å¯ä»¥ä½¿ç”¨vueçš„æ’å€¼è¡¨è¾¾å¼ï¼Œæ‰€ä»¥åœ¨ç‰¹å®šæƒ…å†µä¸‹ï¼Œå¦‚æœéœ€è¦å±•ç¤ºå·¦å³å¤§æ‹¬å·{ }ï¼Œåˆ™éœ€è¦ä½¿ç”¨è½¬ä¹‰ 1::: v-pre `&#123;&#123; This will be displayed as-is &#125;&#125;` ::: å†…ç½®æŒ‡ä»¤ å¯ä»¥åœ¨mdä¸­ä½¿ç”¨vueçš„å†…ç½®æŒ‡ä»¤ 1234// xxx.md&lt;span v-for="i in 3"&gt;&#123;&#123; i &#125;&#125; &lt;/span&gt;// è¾“å‡º 1 2 3 è®¿é—®ç½‘ç«™çš„å…ƒæ•°æ® å¯ä»¥åœ¨mdä¸­è®¿é—®ç½‘ç«™çš„å…ƒæ•°æ® 123456789// xxx.md&#123;&#123; $page &#125;&#125;// è¾“å‡º&#123; "path": "/using-vue.html", "title": "Using Vue in Markdown", "frontmatter": &#123;&#125; &#125; ä½¿ç”¨ç»„ä»¶ .vuepress/componentsä¸‹çš„ç»„ä»¶ä¼šè¢«æ³¨å†Œä¸ºå…¨å±€çš„å¼‚æ­¥ç»„ä»¶ï¼Œå¯ä»¥åœ¨mdæ–‡ä»¶ä¸­ä½¿ç”¨ 123456789101112.â””â”€ .vuepress â””â”€ components â”œâ”€ demo-1.vue â”œâ”€ OtherComponent.vue â””â”€ Foo â””â”€ Bar.vue// xxx.md&lt;demo-1/&gt;&lt;OtherComponent/&gt;&lt;Foo-Bar/&gt; ä½¿ç”¨ç»„ä»¶æ—¶ï¼Œå§‹ç»ˆä¿æŒPascalCaseå‘½åé£æ ¼ åœ¨æ ‡é¢˜ä¸­ä½¿ç”¨ vue ç»„ä»¶ å¯ä»¥åœ¨mdçš„æ ‡é¢˜ä¸­ä½¿ç”¨vueç»„ä»¶ markdown-vue.png è¾“å‡ºçš„ HTML ç”± markdown-it å®Œæˆã€‚è€Œè§£æåçš„æ ‡é¢˜ç”± VuePress å®Œæˆï¼Œç”¨äºä¾§è¾¹æ ä»¥åŠæ–‡æ¡£çš„æ ‡é¢˜ã€‚ æ³¨æ„ ç”±äºvuepressä¼šä½¿ç”¨SSRç”Ÿæˆé™æ€é¡µé¢ æ‰€ä»¥Vue ç›¸å…³ä»£ç ï¼Œéœ€è¦ç¡®ä¿åªåœ¨ beforeMount æˆ–è€… mounted è®¿é—®æµè§ˆå™¨ / DOM çš„ APIã€‚ å‚è€ƒhttps://ssr.vuejs.org/zh/guide/universal.html å¿…è¦æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ClientOnlyå†…ç½®ç»„ä»¶ï¼ŒåŒ…è£¹å¯¹SSRä¸å‹å¥½çš„ç»„ä»¶ï¼Œæˆ–è€…åœ¨åˆé€‚çš„ç”Ÿå‘½å‘¨æœŸé’©å­ä¸­åŠ¨æ€è½½å…¥ç›¸å…³ç»„ä»¶ï¼Œä¿è¯ä»–ä»¬èƒ½è®¿é—®åˆ° DOM API 1234567891011121314151617// ä½¿ç”¨ClientOnlyç»„ä»¶&lt;ClientOnly&gt; &lt;NonSSRFriendlyComponent /&gt;&lt;/ClientOnly&gt;// æˆ–è€…åœ¨èƒ½è®¿é—®åˆ°DOM APIçš„é’©å­ä¸­å¯¼å…¥ç»„ä»¶ï¼Œä¿è¯ä»–ä»¬èƒ½è®¿é—®åˆ°DOM API&lt;script&gt; export default &#123; mounted() &#123; import(&quot;./lib-that-access-window-on-import&quot;).then((module) =&gt; &#123; // use code document.querySelector(&quot;.test&quot;).className = &quot;hello&quot;; &#125;); &#125;, &#125;;&lt;/script&gt; markdown æ’æ§½ &lt;Content/&gt;ç»„ä»¶ä¼šä¿å­˜mdæ–‡ä»¶ä¸­çš„æ™®é€šå†…å®¹ markdownæ’æ§½å¯ä»¥åˆ†å‘mdå†…å®¹ï¼Œæ–¹ä¾¿çµæ´»å¸ƒå±€ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152// .vuepress/theme/Layout.vue&lt;template&gt; &lt;div class=&quot;container&quot;&gt; &lt;header&gt; &lt;content slot-key=&quot;header&quot; /&gt; &lt;/header&gt; &lt;main&gt; &lt;content /&gt; &lt;/main&gt; &lt;footer&gt; &lt;content slot-key=&quot;footer&quot; /&gt; &lt;/footer&gt; &lt;/div&gt;&lt;/template&gt;// xxx.md// å†…å®¹ä¼šè¢«åˆ†å‘åˆ°&lt;content slot-key=&quot;header&quot; /&gt;::: slot header# Here might be a page title:::- A Paragraph- Another Paragraph// å†…å®¹ä¼šè¢«åˆ†å‘åˆ°&lt;content slot-key=&quot;footer&quot; /&gt;::: slot footer Here&apos;s some contact info:::// xxx.html&lt;div class=&quot;container&quot;&gt; &lt;header&gt; &lt;div class=&quot;content header&quot;&gt; &lt;h1&gt;Here might be a page title&lt;/h1&gt; &lt;/div&gt; &lt;/header&gt; &lt;main&gt; &lt;div class=&quot;content default&quot;&gt; &lt;ul&gt; &lt;li&gt;A Paragraph&lt;/li&gt; &lt;li&gt;Another Paragraph&lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;/main&gt; &lt;footer&gt; &lt;div class=&quot;content footer&quot;&gt; &lt;p&gt;Here&apos;s some contact info&lt;/p&gt; &lt;/div&gt; &lt;/footer&gt;&lt;/div&gt; æ³¨æ„ æ¯ä¸ªè¢«åˆ†å‘çš„å†…å®¹éƒ½ä¼šè¢«åŒ…è£¹åœ¨divä¸­ï¼Œå¹¶ä¸”divçš„classä¸ºcontentå’Œslotçš„åå­— æ ·å¼é¢„å¤„ç†å™¨ vuepressé¡¹ç›®é»˜è®¤é‡‡ç”¨styluså¤„ç†æ ·å¼ï¼Œæ‰€ä»¥å†…ç½®äº†stylusåŠstylus-loader å¦‚æœéœ€è¦ä½¿ç”¨å…¶å®ƒé¢„å¤„ç†å™¨(sassã€scssã€lessã€pug)ï¼Œå¯ç›´æ¥å®‰è£…ç›¸å…³ä¾èµ–åŒ…ï¼Œvuepresså·²ç»åŒ…å«ç›¸å…³é…ç½®ï¼Œå¼€ç®±å³ç”¨ yarn add -D sass-loader node-sass 1234&lt;style lang=&quot;sass&quot;&gt; .title font-size: 20px&lt;/style&gt; åœ¨é¡µé¢ä½¿ç”¨é¡µé¢çº§æ ·å¼åŠè„šæœ¬ å¯ä»¥ç›´æ¥åœ¨mdæ–‡ä»¶ä¸­æ·»åŠ &lt;script&gt;ã€&lt;style&gt;æ ‡ç­¾ï¼Œè¿™ä¸¤ä¸ªæ ‡ç­¾ä¼šè¢«vuepressæå–å‡ºæ¥å¹¶å½“æˆvueå•æ–‡ä»¶ç»„ä»¶ä¸­çš„&lt;style&gt;ã€&lt;script&gt;ä½¿ç”¨ï¼Œæ‰€ä»¥å¯èƒ½åˆ©ç”¨è¿™ä¸ªç‰¹æ€§å®šä¹‰é¡µé¢çº§æ ·å¼åŠé€»è¾‘ 1234567// xxx.md&lt;style lang="scss"&gt; .test &#123; color: red; &#125;&lt;/style&gt; å†…ç½®ç»„ä»¶ å†…ç½®ç»„ä»¶å¯ä»¥ç›´æ¥åœ¨mdæ–‡ä»¶ä¸­ä½¿ç”¨ OutboundLink æ ‡è¯†å¤–éƒ¨é“¾æ¥ç”¨ï¼Œvuepressä¼šè‡ªåŠ¨åœ¨å¤–éƒ¨é“¾æ¥åé¢ç”Ÿæˆè¿™ä¸ªæ ‡è¯† ClientOnly æ ‡è¯†å†…éƒ¨ç»„ä»¶éœ€è¦è®¿é—® DOM APIï¼Œä¸éœ€è¦åœ¨æœåŠ¡ç«¯è¿›è¡Œæ¸²æŸ“ Content åŒ…å«é¡µé¢ md çš„æ‰€æœ‰æ¸²æŸ“å†…å®¹ è‡ªå®šä¹‰å¸ƒå±€(ä¸»é¢˜)æ—¶ï¼Œå¾ˆæœ‰ç”¨ å…·ä½“å¯å‚è€ƒhttps://vuepress.vuejs.org/zh/guide/using-vue.html#content 12345678910111213141516&lt;template&gt; &lt;div class="c-Container"&gt; &lt;div class="c-Container-hd"&gt;è‡ªå®šä¹‰å¤´éƒ¨&lt;/div&gt; &lt;div class="c-Container-bd"&gt; &lt;content /&gt; &lt;/div&gt; &lt;div class="c-Container-ft"&gt;è‡ªå®šä¹‰é¡µè„š&lt;/div&gt; &lt;/div&gt;&lt;/template&gt; Badge å¾½ç« ï¼Œä¸»è¦ç”¨æ¥ç»™æ ‡é¢˜æ·»åŠ ä¸€äº›æ ‡è¯† ç”¨æ³•å¯è§https://vuepress.vuejs.org/zh/guide/using-vue.html#%E5%9C%A8%E6%A0%87%E9%A2%98%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%BB%84%E4%BB%B6 1### Badge &lt;Badge text="beta" type="warning" /&gt; &lt;Badge text="é»˜è®¤ä¸»é¢˜" /&gt; badge.png å¤šè¯­è¨€ è¦æ”¯æŒå¤šè¯­è¨€ï¼Œé¦–å…ˆè¦æœ‰ç¿»è¯‘å¥½çš„å…¶ä»–è¯­è¨€ç‰ˆæœ¬mdæ–‡ä»¶ ä¸åŒè¯­è¨€çš„mdæ–‡ä»¶ç›®å½•ã€æ–‡ä»¶åè¦ä¿æŒå®Œå…¨ä¸€è‡´ 123456789101112docsâ”œâ”€ README.mdâ”œâ”€ foo.mdâ”œâ”€ nestedâ”‚ â””â”€ README.mdâ””â”€ zh â”œâ”€ README.md â”œâ”€ foo.md â””â”€ nested â””â”€ README.md// å¤–å±‚ä¸ºåŸç‰ˆmdç›®å½•ï¼Œzhç›®å½•ä¸‹ä¸ºä¸­æ–‡ç‰ˆæœ¬ï¼ŒäºŒè€…ç›®å½•ç»“æ„ã€æ–‡ä»¶åå®Œå…¨ä¸€è‡´ å…¶æ¬¡ï¼Œéœ€è¦é…ç½®vuepressçš„localeså­—æ®µï¼Œæ¥å‘Šè¯‰ä¸åŒè¯­è¨€ç¯å¢ƒï¼Œä½¿ç”¨å“ªä¸ªç›®å½•ä¸‹çš„mdæ–‡ä»¶ 123456789101112131415161718// .vuepress/config.jsmodule.exports = &#123; locales: &#123; // é”®åæ˜¯è¯¥è¯­è¨€æ‰€å±çš„å­è·¯å¾„ // ä½œä¸ºç‰¹ä¾‹ï¼Œé»˜è®¤è¯­è¨€å¯ä»¥ä½¿ç”¨ '/' ä½œä¸ºå…¶è·¯å¾„ã€‚ "/": &#123; lang: "en-US", // å°†ä¼šè¢«è®¾ç½®ä¸º &lt;html&gt; çš„ lang å±æ€§ title: "VuePress", description: "Vue-powered Static Site Generator", &#125;, "/zh/": &#123; lang: "zh-CN", title: "VuePress", description: "Vue é©±åŠ¨çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨", &#125;, &#125;,&#125;; è¿˜å¯ä»¥ä¸ºä¸åŒçš„è¯­è¨€ç‰ˆæœ¬ä½¿ç”¨ä¸åŒçš„é…ç½®(éœ€è¦çœ‹ä¸»é¢˜æ˜¯å¦æä¾›äº†æ­¤èƒ½åŠ›)ï¼›é»˜è®¤ä¸»é¢˜æ”¯æŒå¯¹ä¸åŒè¯­è¨€ä½¿ç”¨ä¸åŒé…ç½® 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859// .vuepress/config.jsmodule.exports = &#123; locales: &#123; /* ... */ &#125;, themeConfig: &#123; locales: &#123; "/": &#123; selectText: "Languages", label: "English", ariaLabel: "Languages", editLinkText: "Edit this page on GitHub", serviceWorker: &#123; updatePopup: &#123; message: "New content is available.", buttonText: "Refresh", &#125;, &#125;, algolia: &#123;&#125;, nav: [&#123; text: "Nested", link: "/nested/", ariaLabel: "Nested" &#125;], sidebar: &#123; "/": [ /* ... */ ], "/nested/": [ /* ... */ ], &#125;, &#125;, "/zh/": &#123; // å¤šè¯­è¨€ä¸‹æ‹‰èœå•çš„æ ‡é¢˜ selectText: "é€‰æ‹©è¯­è¨€", // è¯¥è¯­è¨€åœ¨ä¸‹æ‹‰èœå•ä¸­çš„æ ‡ç­¾ label: "ç®€ä½“ä¸­æ–‡", // ç¼–è¾‘é“¾æ¥æ–‡å­— editLinkText: "åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ", // Service Worker çš„é…ç½® serviceWorker: &#123; updatePopup: &#123; message: "å‘ç°æ–°å†…å®¹å¯ç”¨.", buttonText: "åˆ·æ–°", &#125;, &#125;, // å½“å‰ locale çš„ algolia docsearch é€‰é¡¹ algolia: &#123;&#125;, nav: [&#123; text: "åµŒå¥—", link: "/zh/nested/" &#125;], sidebar: &#123; "/zh/": [ /* ... */ ], "/zh/nested/": [ /* ... */ ], &#125;, &#125;, &#125;, &#125;,&#125;; å…¨å±€è®¡ç®—å±æ€§ vuepresså°†ä¸€äº›ç«™ç‚¹ã€é¡µé¢ä¿¡æ¯æ³¨å…¥åˆ°Vue.prototypeä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨mdæ–‡ä»¶ã€è‡ªå®šä¹‰vueç»„ä»¶ä¸­ç›´æ¥ä½¿ç”¨ \$site åŒ…å«ç«™ç‚¹çš„ä¿¡æ¯ 123456789101112131415&#123; "title": "VuePress", "description": "Vue é©±åŠ¨çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨", "base": "/", "pages": [ &#123; "lastUpdated": 1524027677000, "path": "/", "title": "VuePress", "frontmatter": &#123;&#125; &#125;, ... ]&#125; \$page åŒ…å«å½“å‰é¡µé¢çš„ä¿¡æ¯ 12345678910111213141516171819202122&#123; "title": "Global Computed", "frontmatter": &#123; "sidebar": "auto" &#125;, "regularPath": "/zh/miscellaneous/global-computed.html", "key": "v-bc9a3e3f9692d", "path": "/zh/miscellaneous/global-computed.html", "headers": [ &#123; "level": 2, "title": "$site", "slug": "site" &#125;, &#123; "level": 2, "title": "$page", "slug": "page" &#125;, ] &#125; \$frontmatter $page.frontmatterçš„ä¸€ä¸ªå¼•ç”¨ 1$page.frontmatter === $frontmatter // true \$localePath å½“å‰é¡µé¢çš„ locale è·¯å¾„å‰ç¼€ï¼Œé»˜è®¤å€¼ä¸º / è¿”å›configä¸­çš„baseå­—æ®µå€¼ï¼Ÿå¾…ç¡®è®¤ $langã€$titleã€$descriptionã€$themeConfig $langå½“å‰é¡µé¢çš„è¯­è¨€ï¼Œé»˜è®¤en-US $titleå½“å‰é¡µé¢&lt;title&gt;æ ‡ç­¾çš„å€¼ $descriptionç”¨äºå½“å‰é¡µé¢çš„ &lt;meta name=&quot;description&quot; content=&quot;...&quot;&gt; çš„ content å€¼ $themeConfigæ˜¯.vupress/config.jsä¸­çš„themeConfig .vupress/config.jså¯¼å‡ºçš„å†…å®¹ç§°ä¸ºsiteConfig Front Matter vuepressæ”¯æŒYAML front matter Front matterå¯ä»¥ç†è§£ä¸ºå¯¹mdæ–‡ä»¶æ·»åŠ ä¸€äº›ç‰¹æ®Šå­—æ®µ(å…ƒä¿¡æ¯)ï¼Œç”¨æ¥è‡ªå®šä¹‰å½“å‰é¡µé¢ï¼›ç”¨æ¥å¢å¼ºmdçš„è¡¨ç°åŠ› åœ¨mdæ–‡ä»¶ä¸­ï¼Œä¸€èˆ¬å¼€å¤´---ä¹‹é—´çš„å†…å®¹ä¸ºFront matter vuepressé¢„å®šä¹‰äº†ä¸€äº›front matterï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ï¼Œç„¶åä½¿ç”¨$frontmatteræ¥å¼•ç”¨ front-matter.png é¢„å®šä¹‰ front matter title å½“å‰é¡µé¢æ ‡é¢˜ lang å½“å‰é¡µé¢è¯­è¨€ description å½“å‰é¡µé¢æè¿° layout å½“å‰é¡µé¢çš„å¸ƒå±€ç»„ä»¶(é»˜è®¤ä¸ºLayout.vue) permalink å½“å‰é¡µé¢æ°¸ä¹…é“¾æ¥æ ¼å¼ metaTitle é‡å†™é¡µé¢çš„ title meta å½“å‰é¡µé¢é¢å¤–çš„metaæ ‡ç­¾ meta.png é»˜è®¤ä¸»é¢˜é¢„å®šä¹‰å˜é‡ é»˜è®¤ä¸»é¢˜ä¹Ÿæä¾›äº†å¾ˆå¤šé¢„å®šä¹‰å˜é‡ç”¨æ¥æ§åˆ¶å½“å‰é¡µé¢ä¸€äº›å¸ƒå±€ç»„ä»¶çš„å±•ç¤º ä¾‹å¦‚navbarã€sidebarç­‰ç­‰ å…·ä½“å¯å‚è€ƒhttps://vuepress.vuejs.org/zh/theme/default-theme-config.html#%E9%A6%96%E9%A1%B5 æ°¸ä¹…é“¾æ¥ permalink å¦‚æœåˆ©ç”¨vuepressç”Ÿæˆä¸€ä¸ªåšå®¢ï¼Œé‚£æ°¸ä¹…é“¾æ¥æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œä¸ºæ¯ä¸€ç¯‡æ–‡ç« ç”Ÿæˆä¸€ä¸ªæ°¸ä¹…é“¾æ¥ é…ç½® permalink permalinkæ‹¥æœ‰ä¸€äº›å˜é‡ :year æ–‡ç« å‘å¸ƒçš„å¹´ä»½ (4 æ•°å­—) :month æ–‡ç« å‘å¸ƒçš„æœˆä»½ (2 æ•°å­—) :i_month æ–‡ç« å‘å¸ƒçš„æœˆä»½ (å‰é¢ä¸å¸¦ 0) :day æ–‡ç« å‘å¸ƒçš„æ—¥ä»½ (2 æ•°å­—) :i_day æ–‡ç« å‘å¸ƒçš„æ—¥ä»½ (å‰é¢ä¸å¸¦ 0) :slug ä¸å¸¦æ‰©å±•åçš„æ–‡ä»¶å :regular é»˜è®¤é“¾æ¥ç”Ÿæˆæ–¹å¼ https://vuepress.vuejs.org/zh/guide/directory-structure.html#%E9%BB%98%E8%AE%A4%E7%9A%84%E9%A1%B5%E9%9D%A2%E8%B7%AF%E7%94%B1 1234// .vuepress/config.jsmodule.exports = &#123; permalink: "/:year/:month/:day/:slug",&#125;; åœ¨é¡µé¢ä¸­ï¼Œä¹Ÿå¯ä»¥ç”¨front matterä¸ºé¡µé¢å•ç‹¬é…ç½®ä¸€ä¸ªæ°¸ä¹…é“¾æ¥ link.png éƒ¨ç½²åˆ° github pages ç¬¬ä¸€æ­¥ç¡®å®šï¼Œé™æ€å­˜æ”¾ç›®å½• ä¾‹å¦‚https://github.com/bryanadamss/testrepo ç¡®å®šä»“åº“årepoName testrepo é…ç½®siteConfig.baseä¸ºrepoName 1234// .vuepress/config.jsmodule.exports = &#123; base: "/testrepo/",&#125;; è®¾ç½®ä»“åº“ä¸ºgithub pages ç¼–è¯‘æ–‡ä»¶ è¿è¡Œnpm run docs:build ä¸Šä¼ é™æ€æ–‡ä»¶ å¯ä»¥é€šè¿‡shellè„šæœ¬ä¸Šä¼ ï¼Œé¿å…é‡å¤åŠ³åŠ¨ 1234567891011121314151617181920#!/usr/bin/env sh# ç¡®ä¿è„šæœ¬æŠ›å‡ºé‡åˆ°çš„é”™è¯¯set -e# ç”Ÿæˆé™æ€æ–‡ä»¶npm run docs:build# è¿›å…¥ç”Ÿæˆçš„æ–‡ä»¶å¤¹cd docs/.vuepress/dist# å¦‚æœæ˜¯å‘å¸ƒåˆ°è‡ªå®šä¹‰åŸŸå# echo 'www.example.com' &gt; CNAMEgit initgit add -Agit commit -m 'deploy'# å¦‚æœå‘å¸ƒåˆ° https://&lt;USERNAME&gt;.github.io# git push -f git@github.com:&lt;USERNAME&gt;/&lt;USERNAME&gt;.github.io.git master# å¦‚æœå‘å¸ƒåˆ° https://&lt;USERNAME&gt;.github.io/&lt;REPO&gt;# git push -f git@github.com:&lt;USERNAME&gt;/&lt;REPO&gt;.git master:gh-pagescd - å…·ä½“å¯å‚è€ƒ https://vuepress.vuejs.org/zh/guide/deploy.html#github-pages å‚è€ƒ https://vuepress.vuejs.org/zh/guide/]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>vuepress</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[xss]]></title>
    <url>%2F2020%2F03%2F23%2Fxss%2F</url>
    <content type="text"><![CDATA[XSSæ¦‚å¿µ XSS(Cross-site scripting)æ˜¯ä¸€ç§è·¨ç«™è„šæœ¬æ”»å‡»ï¼›å®ƒæ˜¯ä¸€ç§æ³¨å…¥æ”»å‡»ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ¼æ´åœ¨ç½‘ç«™ä¸Šæ³¨å…¥æ¶æ„çš„å®¢æˆ·ç«¯ä»£ç ï¼Œè¿›è€Œè·å–ç”¨æˆ·çš„æ•æ„Ÿä¿¡æ¯(cookieã€session tokens ç­‰)ï¼› ç»´åŸºå®šä¹‰ 1XSSæ”»å‡»é€šå¸¸æŒ‡çš„æ˜¯é€šè¿‡åˆ©ç”¨ç½‘é¡µå¼€å‘æ—¶ç•™ä¸‹çš„æ¼æ´ï¼Œé€šè¿‡å·§å¦™çš„æ–¹æ³•æ³¨å…¥æ¶æ„æŒ‡ä»¤ä»£ç åˆ°ç½‘é¡µï¼Œä½¿ç”¨æˆ·åŠ è½½å¹¶æ‰§è¡Œæ”»å‡»è€…æ¶æ„åˆ¶é€ çš„ç½‘é¡µç¨‹åºã€‚è¿™äº›æ¶æ„ç½‘é¡µç¨‹åºé€šå¸¸æ˜¯JavaScriptï¼Œä½†å®é™…ä¸Šä¹Ÿå¯ä»¥åŒ…æ‹¬Javaï¼ŒVBScriptï¼ŒActiveXï¼ŒFlashæˆ–è€…ç”šè‡³æ˜¯æ™®é€šçš„HTMLã€‚æ”»å‡»æˆåŠŸåï¼Œæ”»å‡»è€…å¯èƒ½å¾—åˆ°æ›´é«˜çš„æƒé™ï¼ˆå¦‚æ‰§è¡Œä¸€äº›æ“ä½œï¼‰ã€ç§å¯†ç½‘é¡µå†…å®¹ã€ä¼šè¯å’Œcookieç­‰å„ç§å†…å®¹ã€‚ ç™½è¯è§£é‡Š æ”»å‡»è€…åˆ©ç”¨ç‰¹æ®Šæ–¹æ³•å°†æ¶æ„ä»£ç æ³¨å…¥å®¢æˆ·ç«¯ç½‘ç«™(æµè§ˆå™¨)ï¼Œå—å®³è€…è®¿é—®ç½‘ç«™ï¼Œè¿›è€Œæ‰§è¡Œäº†è¢«æ³¨å…¥çš„æ¶æ„ä»£ç ï¼Œæ”»å‡»è€…è·å–åˆ°å—å®³è€…çš„ä¿¡æ¯ å› ä¸ºç¼©å†™cssåŒå±‚å æ ·å¼è¡¨åå†²çªï¼Œæ‰€ä»¥æ”¹ä¸ºxss åˆ†ç±» ä¸€èˆ¬æœ‰ä¸‰ç§Persistent XSS(æŒä¹…å‹/å­˜å‚¨å‹)ã€Reflected XSS(åå°„å‹)ã€DOM-based XSS(åŸºäºDOMçš„XSSæ”»å‡») å­˜å‚¨åŒºï¼šæ¶æ„ä»£ç å­˜æ”¾çš„ä½ç½®ã€‚ æ’å…¥ç‚¹ï¼šç”±è°å–å¾—æ¶æ„ä»£ç ï¼Œå¹¶æ’å…¥åˆ°ç½‘é¡µä¸Šã€‚ ç±»å‹ å­˜å‚¨åŒº æ’å…¥ç‚¹ æŒä¹…å‹ åç«¯æ•°æ®åº“ HTML åå°„å‹ URL HTML DOM-based åç«¯æ•°æ®åº“/å‰ç«¯å­˜å‚¨/URL å‰ç«¯ JavaScript æŒä¹…å‹å¸¸è§æ”»å‡»æ­¥éª¤ æ”»å‡»è€…å°†æ¶æ„ä»£ç æäº¤åˆ°ç›®æ ‡ç½‘ç«™çš„æ•°æ®åº“ä¸­ã€‚ æ¶æ„ä»£ç è¢«å­˜å‚¨åœ¨åå°æ•°æ®åº“ä¸­ï¼Œè¿™æ˜¯æŒä¹…å‹çš„ç‰¹ç‚¹ ç”¨æˆ·æ‰“å¼€ç›®æ ‡ç½‘ç«™æ—¶ï¼Œç½‘ç«™æœåŠ¡ç«¯å°†æ¶æ„ä»£ç ä»æ•°æ®åº“å–å‡ºï¼Œæ‹¼æ¥åœ¨ HTML ä¸­è¿”å›ç»™æµè§ˆå™¨ã€‚ æŒä¹…å‹å¸¸è§äºæœåŠ¡ç«¯æ¸²æŸ“ä¸­ï¼Œä¾‹å¦‚åˆ©ç”¨jspæŠ€æœ¯æ‹¼æ¥è¿”å› html ç”¨æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œï¼Œæ··åœ¨å…¶ä¸­çš„æ¶æ„ä»£ç ä¹Ÿè¢«æ‰§è¡Œã€‚ æ¶æ„ä»£ç çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–è€…å†’å……ç”¨æˆ·çš„è¡Œä¸ºï¼Œè°ƒç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚ å®ä¾‹ persistent.png æ”»å‡»è€…åˆ©ç”¨æäº¤ç½‘ç«™è¡¨å•å°†ä¸€æ®µæ¶æ„æ–‡æœ¬æ’å…¥ç½‘ç«™çš„æ•°æ®åº“ä¸­ å—å®³è€…å‘ç½‘ç«™è¯·æ±‚é¡µé¢ ç½‘ç«™ä»æ•°æ®åº“ä¸­å–å‡ºæ¶æ„æ–‡æœ¬æŠŠå®ƒåŒ…å«è¿›è¿”å›ç»™å—å®³è€…çš„é¡µé¢ä¸­ å—å®³è€…çš„æµè§ˆå™¨æ‰§è¡Œè¿”å›é¡µé¢ä¸­çš„æ¶æ„è„šæœ¬ï¼ŒæŠŠè‡ªå·±çš„ cookie å‘é€ç»™æ”»å‡»è€…çš„æœåŠ¡å™¨ã€‚ ç‰¹ç‚¹ æ¶æ„ä»£ç è¢«å­˜å‚¨åœ¨åå°æ•°æ®åº“ä¸­ æ¶æ„ä»£ç é€šè¿‡ä¸ç”¨æˆ·äº¤äº’åŠŸèƒ½è¢«å­˜å…¥æ•°æ®åº“ åå°é€šè¿‡æ‹¼æ¥ html çš„å½¢å¼ç›´æ¥è¿”å›ç»™æµè§ˆå™¨æ¸²æŸ“ æœªåšè¿‡æ»¤(è½¬ä¹‰) å¯¼è‡´æ‰€æœ‰è®¿é—®é¡µé¢çš„ç”¨æˆ·ï¼Œéƒ½ä¼šæ‰§è¡Œæ¶æ„ä»£ç  å¸¸è§åœºæ™¯ å¸¸å‡ºç°åœ¨èƒ½ä¿å­˜ç”¨æˆ·æ•°æ®çš„åŠŸèƒ½ä¸Šï¼Œä¾‹å¦‚è¯„è®ºã€ç§ä¿¡ç­‰ åå°„å‹å¸¸è§æ”»å‡»æ­¥éª¤ æ”»å‡»è€…æ„é€ å‡ºç‰¹æ®Šçš„ URLï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç ã€‚ ç”¨æˆ·æ‰“å¼€å¸¦æœ‰æ¶æ„ä»£ç çš„ URL æ—¶ï¼Œç½‘ç«™æœåŠ¡ç«¯å°†æ¶æ„ä»£ç ä» URL ä¸­å–å‡ºï¼Œæ‹¼æ¥åœ¨ HTML ä¸­è¿”å›ç»™æµè§ˆå™¨ã€‚ åå°„å‹è·ŸæŒä¹…å‹ç±»ä¼¼ï¼Œä¹Ÿå¸¸è§äºæœåŠ¡ç«¯æ¸²æŸ“ä¸­ï¼Œä¾‹å¦‚åˆ©ç”¨jspæŠ€æœ¯æ‹¼æ¥è¿”å› html ç”¨æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œï¼Œæ··åœ¨å…¶ä¸­çš„æ¶æ„ä»£ç ä¹Ÿè¢«æ‰§è¡Œã€‚ æ¶æ„ä»£ç çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–è€…å†’å……ç”¨æˆ·çš„è¡Œä¸ºï¼Œè°ƒç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œ æ³¨æ„ æŒ‰æ­£å¸¸æ­¥éª¤ï¼Œå—å®³è€…äº²è‡ªæäº¤æ¶æ„ä»£ç ï¼Œç„¶åçªƒå–è‡ªå·±çš„ç”¨æˆ·ä¿¡æ¯ï¼Œä¸€èˆ¬æ²¡äººä¼šè¿™ä¹ˆå¹²:) æ‰€ä»¥ï¼Œæ”»å‡»è€…ä¸€èˆ¬ä¼šç”¨ç‰¹æ®Šçš„æ–¹æ³•è¯±å¯¼å—å®³è€…ç‚¹å‡»æŸä¸ªé“¾æ¥ å¦‚æœæ”»å‡»è€…çš„ç›®æ ‡æ˜¯ä¸€ä½å…·ä½“çš„ä¸ªäººç”¨æˆ·ï¼Œæ”»å‡»è€…å¯ä»¥æŠŠæ¶æ„é“¾æ¥å‘é€ç»™å—å®³è€…ï¼ˆæ¯”å¦‚é€šè¿‡ç”µå­é‚®ä»¶æˆ–è€…çŸ­ä¿¡ï¼‰ï¼Œå¹¶ä¸”æ¬ºéª—ä»–å»è®¿é—®è¿™ä¸ªé“¾æ¥ã€‚ å¦‚æœæ”»å‡»è€…çš„ç›®æ ‡æ˜¯ä¸€ä¸ªç¾¤ä½“ï¼Œæ”»å‡»è€…èƒ½å¤Ÿå‘å¸ƒä¸€æ¡æŒ‡å‘æ¶æ„ URL çš„é“¾æ¥ï¼ˆæ¯”å¦‚åœ¨ä»–çš„ä¸ªäººç½‘ç«™æˆ–è€…ç¤¾äº¤ç½‘ç»œä¸Šï¼‰ï¼Œç„¶åç­‰å¾…è®¿é—®è€…å»ç‚¹å‡»å®ƒã€‚ å®ä¾‹ reflect.png æ”»å‡»è€…æ„é€ äº†ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡æœ¬çš„ URL å‘é€ç»™å—å®³è€… å—å®³è€…è¢«æ”»å‡»è€…æ¬ºéª—ï¼Œé€šè¿‡è®¿é—®è¿™ä¸ª URL å‘ç½‘ç«™å‘å‡ºè¯·æ±‚ ç½‘ç«™é€šè¿‡æ‹¼æ¥ html å½¢å¼ç»™å—å®³è€…çš„è¿”å›ä¸­åŒ…å«äº†æ¥è‡ª URL çš„çš„æ¶æ„æ–‡æœ¬ å—å®³è€…çš„æµè§ˆå™¨æ‰§è¡Œäº†æ¥è‡ªè¿”å›ä¸­çš„æ¶æ„è„šæœ¬ï¼ŒæŠŠå—å®³è€…çš„ cookie å‘é€ç»™æ”»å‡»è€…çš„æœåŠ¡å™¨ ç‰¹ç‚¹ æ¶æ„ä»£ç å­˜å‚¨åœ¨ URL ä¸Šï¼Œæ²¡æœ‰å­˜å‚¨åˆ°æ•°æ®åº“ æœåŠ¡ç«¯æ²¡æœ‰å¯¹æ¶æ„ä»£ç åšè¿‡æ»¤ï¼Œç›´æ¥è¾“å‡ºåˆ°é¡µé¢ä¸Šï¼Œå¯¼è‡´æ¶æ„è„šæœ¬è¢«æ‰§è¡Œ ç”±äºéœ€è¦ç”¨æˆ·ä¸»åŠ¨æ‰“å¼€æ¶æ„çš„ URL æ‰èƒ½ç”Ÿæ•ˆï¼Œæ”»å‡»è€…å¾€å¾€ä¼šç»“åˆå¤šç§æ‰‹æ®µè¯±å¯¼ç”¨æˆ·ç‚¹å‡» åŒæŒä¹…å‹åŒºåˆ« åå°„æ€§ xss æ¶æ„ä»£ç å­˜å‚¨åœ¨ URL ä¸­ æŒä¹…å‹ xss æ¶æ„ä»£ç å­˜å‚¨åœ¨åå°æ•°æ®åº“ä¸­ å¸¸è§åœºæ™¯ ä¸€èˆ¬å¸¸è§äºé€šè¿‡ URL ä¼ é€’å‚æ•°çš„åŠŸèƒ½ï¼Œå¦‚ç½‘ç«™æœç´¢ã€è·³è½¬ç­‰ DOM-based å‹(å‰ç«¯é‡ç‚¹å…³æ³¨) åŸºäº DOM çš„ XSS æ˜¯å±äºæŒä¹…å‹å’Œåå°„å‹ XSS çš„å˜ç§ã€‚åœ¨åŸºäº DOM çš„ XSS çš„æ”»å‡»ä¸­ï¼Œé™¤éç½‘ç«™è‡ªèº«çš„åˆæ³•è„šæœ¬è¢«æ‰§è¡Œï¼Œå¦åˆ™æ¶æ„æ–‡æœ¬ä¸ä¼šè¢«å—å®³è€…çš„æµè§ˆå™¨è§£æ æ¶æ„ä»£ç æ˜¯åœ¨ç½‘ç«™åˆæ³•ä»£ç æ‰§è¡Œæ—¶è§¦å‘ DOM-based å‹ï¼Œä¸¥æ ¼æ¥è¯´åº”è¯¥æ˜¯å‰ç«¯çš„ä¸€ä¸ªæ¼æ´ å› ä¸ºå–å‡ºå’Œæ‰§è¡Œæ¶æ„ä»£ç ç”±æµè§ˆå™¨ç«¯å®Œæˆï¼Œå±äºå‰ç«¯ JavaScript è‡ªèº«çš„å®‰å…¨æ¼æ´ï¼Œè€Œå…¶ä»–ä¸¤ç§ XSS éƒ½å±äºæœåŠ¡ç«¯çš„å®‰å…¨æ¼æ´ å‰ç«¯ JavaScript ä»£ç æœ¬èº«ä¸å¤Ÿä¸¥è°¨ï¼ŒæŠŠä¸å¯ä¿¡çš„æ•°æ®å½“ä½œä»£ç æ‰§è¡Œäº†ã€‚ å¸¸è§æ”»å‡»æ­¥éª¤ æ”»å‡»è€…æ„é€ å‡ºç‰¹æ®Šçš„ URLï¼Œå…¶ä¸­åŒ…å«æ¶æ„ä»£ç ã€‚ ç”¨æˆ·æ‰“å¼€å¸¦æœ‰æ¶æ„ä»£ç çš„ URLã€‚ ç”¨æˆ·æµè§ˆå™¨æ¥æ”¶åˆ°å“åº”åè§£ææ‰§è¡Œï¼Œå‰ç«¯ JavaScript å–å‡º URL ä¸­çš„æ¶æ„ä»£ç å¹¶æ‰§è¡Œã€‚ æœåŠ¡ç«¯æ²¡æœ‰è¿”å›æ¶æ„ä»£ç (æ‹¼æ¥å¥½çš„ html) æ¶æ„ä»£ç çªƒå–ç”¨æˆ·æ•°æ®å¹¶å‘é€åˆ°æ”»å‡»è€…çš„ç½‘ç«™ï¼Œæˆ–è€…å†’å……ç”¨æˆ·çš„è¡Œä¸ºï¼Œè°ƒç”¨ç›®æ ‡ç½‘ç«™æ¥å£æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„æ“ä½œã€‚ å®ä¾‹ dom.png æ”»å‡»è€…æ„é€ ä¸€ä¸ªåŒ…å«æ¶æ„æ–‡æœ¬çš„ URL å‘é€å—å®³è€… å—å®³è€…è¢«æ”»å‡»è€…æ¬ºéª—ï¼Œé€šè¿‡è®¿é—®è¿™ä¸ª URL å‘ç½‘ç«™å‘å‡ºè¯·æ±‚ ç½‘ç«™æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ¶æ„æ–‡æœ¬å¹¶æ²¡æœ‰åŒ…å«åœ¨ç»™å—å®³è€…çš„è¿”å›é¡µé¢ä¸­ å—å®³è€…çš„æµè§ˆå™¨æ‰§è¡Œæ¥è‡ªç½‘ç«™è¿”å›é¡µé¢é‡Œçš„åˆæ³•è„šæœ¬ï¼Œå¯¼è‡´æ¶æ„è„šæœ¬è¢«æ’å…¥è¿›é¡µé¢ä¸­ å—å®³è€…çš„æµè§ˆå™¨æ‰§è¡Œæ’å…¥è¿›é¡µé¢çš„æ¶æ„è„šæœ¬ï¼ŒæŠŠè‡ªå·±çš„ cookie å‘é€åˆ°æ”»å‡»è€…çš„æœåŠ¡å™¨ ç‰¹ç‚¹ æŒä¹…å‹ã€åå°„å‹çš„å˜ç§ï¼Œæ¶æ„ä»£ç å¯ä»¥å­˜å‚¨åœ¨æœåŠ¡ç«¯æ•°æ®åº“ä¹Ÿå¯ä»¥å­˜å‚¨åœ¨ URL ä¸­ è§¦å‘æ—¶æœºæ˜¯åœ¨ç½‘ç«™åˆæ³•ä»£ç æ‰§è¡Œæ—¶ åœ¨ä¼ ç»Ÿçš„ XSS æ”»å‡»ä¸­ï¼Œæ¶æ„è„šæœ¬ä½œä¸ºæœåŠ¡å™¨ä¼ å›çš„ä¸€éƒ¨åˆ†ï¼Œåœ¨é¡µé¢åŠ è½½æ—¶å°±è¢«æ‰§è¡Œ åœ¨åŸºäº DOM çš„ XSS æ”»å‡»ä¸­ï¼Œæ¶æ„è„šæœ¬åœ¨é¡µé¢åŠ è½½ä¹‹åçš„æŸä¸ªæ—¶é—´ç‚¹æ‰æ‰§è¡Œï¼Œæ˜¯åˆæ³•è„šæœ¬ä»¥éå®‰å…¨çš„æ–¹å¼å¤„ç†ç”¨æˆ·è¾“å…¥çš„ç»“æœ é˜²æ­¢ è¾“å…¥ä¾§ æ”»å‡»è€…æäº¤æ¶æ„ä»£ç ã€‚ è¾“å‡ºä¾§ æµè§ˆå™¨æ‰§è¡Œæ¶æ„ä»£ç ã€‚ è¾“å…¥ä¾§ ä¸è¦ç›¸ä¿¡ä»»ä½•ç”¨æˆ·è¾“å…¥(ç”¨æˆ·èƒ½ä¿®æ”¹çš„ä»»ä½•æ•°æ®)ï¼Œåšè½¬ä¹‰(ç¼–ç )ã€è¿‡æ»¤(æ ¡éªŒ) æ¥è‡ªç”¨æˆ·çš„ UGC ä¿¡æ¯ è¡¨å•è¾“å…¥ URL å®¢æˆ·ç«¯å­˜å‚¨ localStorage sessionStorage indexDB è½¬ä¹‰æ˜¯æŒ‡å°†ç”¨æˆ·è¾“å…¥è½¬ä¹‰çš„è¡Œä¸ºï¼Œä»¥ç¡®ä¿æµè§ˆå™¨æŠŠè¾“å…¥å½“ä½œæ•°æ®è€Œä¸æ˜¯ä»£ç å¯¹å¾…ã€‚åœ¨ web å¼€å‘ä¸­æœ€çŸ¥åçš„ä¸€ç±»ç¼–ç è«è¿‡äº HTML è½¬ä¹‰ï¼Œè¯¥æ–¹æ³•å°†&lt;å’Œ&gt;åˆ†åˆ«è½¬ä¹‰ä¸º&amp;lt;å’Œ&amp;gt; å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œåªè¦ç”¨æˆ·çš„è¾“å…¥ä¼šè¢«åŒ…å«è¿›é¡µé¢ï¼Œå°±åº”è¯¥æ‰§è¡Œè½¬ä¹‰ å‰ç«¯å¯ä»¥å€ŸåŠ©xssè¿™ä¸ª npm åŒ…æ¥å®Œæˆè½¬ä¹‰ è¿‡æ»¤æ˜¯æŒ‡å¯¹ç”¨æˆ·è¾“å…¥çš„å†…å®¹åšè¿‡æ»¤ï¼Œå¯ä»¥å»ºç«‹ç™½åå•ï¼Œåªæœ‰ç™½åå•ä¸­çš„å†…å®¹æ‰å…è®¸è¾“å…¥ ä¾‹å¦‚å…è®¸è¾“å…¥&lt;em&gt;ã€&lt;strong&gt;ï¼Œä¸å…è®¸è¾“å…¥&lt;script&gt; è½¬ä¹‰ã€è¿‡æ»¤éœ€è¦åŒæ—¶åœ¨æœåŠ¡ç«¯ã€å‰ç«¯åŒæ—¶è¿›è¡Œ è¾“å‡ºä¾§ é˜²æ­¢ html ä¸­å‡ºç°æ³¨å…¥(é’ˆå¯¹æŒä¹…å‹ã€åå°„å‹) é˜²æ­¢ JavaScript æ‰§è¡Œæ—¶ï¼Œæ‰§è¡Œæ¶æ„ä»£ç (é’ˆå¯¹ DOM-based å‹) é˜²æ­¢ html ä¸­å‡ºç°æ³¨å…¥ é’ˆå¯¹æŒä¹…å‹ã€åå°„å‹ï¼Œè¿™ä¸¤ç§æ˜¯ç”±äºæœåŠ¡ç«¯è¿”å›çš„ html æºå¸¦æ¶æ„ä»£ç å¯¼è‡´æ¶æ„ä»£ç è¢«æ‰§è¡Œ æ‰€ä»¥å¯ä»¥æ”¹ä¸ºå‰ç«¯æ¸²æŸ“ï¼Œå°†ä»£ç å’Œæ•°æ®åˆ†ç¦» å‰ç«¯é€šè¿‡ ajax è¯·æ±‚æ•°æ®ç„¶åæ¸²æŸ“ çº¯å‰ç«¯æ¸²æŸ“ï¼Œè¿˜éœ€è¦é¢„é˜² DOM-based xss æ”»å‡» æˆ–è€…æœåŠ¡ç«¯å¯¹è¿”å›çš„ HTML åšå……åˆ†è½¬ä¹‰ éœ€è¦é’ˆå¯¹ä¸åŒçš„è¾“å…¥ç‚¹ä½ç½®åšä¸åŒçš„è½¬ä¹‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;!-- HTML æ ‡ç­¾å†…æ–‡å­—å†…å®¹ --&gt;&lt;div&gt;&lt;%= Encode.forHtml(UNTRUSTED) %&gt;&lt;/div&gt;&lt;!-- HTML æ ‡ç­¾å±æ€§å€¼ --&gt;&lt;input value="&lt;%= Encode.forHtml(UNTRUSTED) %&gt;" /&gt;&lt;!-- CSS å±æ€§å€¼ --&gt;&lt;div style="width:&lt;= Encode.forCssString(UNTRUSTED) %&gt;"&gt; &lt;!-- CSS URL --&gt; &lt;div style="background:&lt;= Encode.forCssUrl(UNTRUSTED) %&gt;"&gt; &lt;!-- JavaScript å†…è”ä»£ç å— --&gt; &lt;script&gt; var msg = "&lt;%= Encode.forJavaScript(UNTRUSTED) %&gt;"; alert(msg); &lt;/script&gt; &lt;!-- JavaScript å†…è”ä»£ç å—å†…åµŒ JSON --&gt; &lt;script&gt; var __INITIAL_STATE__ = JSON.parse( "&lt;%= Encoder.forJavaScript(data.to_json) %&gt;" ); &lt;/script&gt; &lt;!-- HTML æ ‡ç­¾å†…è”ç›‘å¬å™¨ --&gt; &lt;button onclick="alert('&lt;%= Encode.forJavaScript(UNTRUSTED) %&gt;');"&gt; click me &lt;/button&gt; &lt;!-- URL å‚æ•° --&gt; &lt;a href="/search?value=&lt;%= Encode.forUriComponent(UNTRUSTED) %&gt;&amp;order=1#top" &gt; &lt;!-- URL è·¯å¾„ --&gt; &lt;a href="/page/&lt;%= Encode.forUriComponent(UNTRUSTED) %&gt;"&gt; &lt;!-- URL. æ³¨æ„ï¼šè¦æ ¹æ®é¡¹ç›®æƒ…å†µè¿›è¡Œè¿‡æ»¤ï¼Œç¦æ­¢æ‰ "javascript:" é“¾æ¥ã€éæ³• scheme ç­‰--&gt; &lt;a href='&lt;%= urlValidator.isValid(UNTRUSTED) ? Encode.forHtml(UNTRUSTED) : "/404"%&gt;' &gt; link &lt;/a&gt;&lt;/a &gt;&lt;/a &gt; &lt;/div&gt;&lt;/div&gt; é’ˆå¯¹ä¸åŒçš„ä¸Šä¸‹æ–‡è¿›è¡Œè½¬ä¹‰æ˜¯å¾ˆå¤æ‚çš„ï¼Œå¯ä»¥è€ƒè™‘è°·æ­Œçš„Automatic Context-Aware Escaping é˜²æ­¢ JavaScript æ‰§è¡Œæ—¶ï¼Œæ‰§è¡Œæ¶æ„ä»£ç (è¿™å…¶å®ä¸»è¦æ˜¯é¢„é˜² DOM-based xss å‹æ”»å‡») åŸç”Ÿ js é¿å…ä½¿ç”¨ .innerHTMLã€.outerHTMLã€document.write() å°†ä¸å¯ä¿¡çš„æ•°æ®åšä¸º html æ’åˆ°é¡µé¢ä¸Šï¼Œè€Œåº”å°½é‡ä½¿ç”¨ .textContentã€.setAttribute() ç­‰ DOM ä¸­çš„å†…è”äº‹ä»¶ç›‘å¬å™¨ï¼Œå¦‚ locationã€onclickã€onerrorã€onloadã€onmouseover ç­‰ï¼Œ æ ‡ç­¾çš„ href å±æ€§ï¼ŒJavaScript çš„ eval()ã€setTimeout()ã€setInterval() ç­‰ï¼Œéƒ½èƒ½æŠŠå­—ç¬¦ä¸²ä½œä¸ºä»£ç è¿è¡Œã€‚å¦‚æœä¸å¯ä¿¡çš„æ•°æ®æ‹¼æ¥åˆ°å­—ç¬¦ä¸²ä¸­ä¼ é€’ç»™è¿™äº› APIï¼Œå¾ˆå®¹æ˜“äº§ç”Ÿå®‰å…¨éšæ‚£ï¼Œè¯·åŠ¡å¿…é¿å…ã€‚ Vue/React é¿å…ä½¿ç”¨ v-html/dangerouslySetInnerHTML 1234567891011121314&lt;!-- å†…è”äº‹ä»¶ç›‘å¬å™¨ä¸­åŒ…å«æ¶æ„ä»£ç  --&gt;&lt;img onclick="UNTRUSTED" onerror="UNTRUSTED" src="data:image/png," /&gt;&lt;!-- é“¾æ¥å†…åŒ…å«æ¶æ„ä»£ç  --&gt;&lt;a href="UNTRUSTED"&gt;1&lt;/a&gt;&lt;script&gt; // setTimeout()/setInterval() ä¸­è°ƒç”¨æ¶æ„ä»£ç  setTimeout("UNTRUSTED"); setInterval("UNTRUSTED"); // location è°ƒç”¨æ¶æ„ä»£ç  location.href = "UNTRUSTED"; // eval() ä¸­è°ƒç”¨æ¶æ„ä»£ç  eval("UNTRUSTED");&lt;/script&gt; å…¶ä»–æ–¹æ³• æ”»å‡»è€…æœ€ç»ˆç›®çš„æ˜¯è·å–å—å®³è€…çš„æ•æ„Ÿä¿¡æ¯ æ‰€ä»¥å¯å¯¹éƒ¨åˆ†ç”¨æˆ·æ•æ„Ÿä¿¡æ¯åšé™åˆ¶ ä¾‹å¦‚é’ˆå¯¹ cookieï¼Œå¯ä»¥è®¾ç½® http-onlyï¼Œé˜²æ­¢å®¢æˆ·ç«¯è¯»å– cookie è¿›è€Œä¼ é€’ç»™æ”»å‡»è€… å½“è½¬ä¹‰å’Œè¿‡æ»¤éƒ½ä¸èƒ½èµ·åˆ°å¾ˆå¥½çš„ä½œç”¨æ—¶ï¼Œå¯ä»¥è€ƒè™‘é…åˆä½¿ç”¨CSP(Content Security Policy) ç®€å•çš„è¯´:CSPæ˜¯ä¸€ç»„å®‰å…¨åè®®ç­–ç•¥ï¼Œä½ å¯ä»¥é…ç½®ä½ çš„ç½‘ç»œæœåŠ¡å™¨è¿”å› Content-Security-Policy HTTP å¤´éƒ¨æ¥å‘Šè¯‰æµè§ˆå™¨å¼€å¯æŸäº›å®‰å…¨ç­–ç•¥ï¼Œç”¨äºæ£€æµ‹å¹¶å‰Šå¼±æŸäº›ç‰¹å®šç±»å‹çš„æ”»å‡» å…·ä½“å¯å‚è€ƒhttps://developer.mozilla.org/zh-CN/docs/Web/HTTP/CSP æ€»ç»“ XSS æ˜¯ä¸€ç§åˆ©ç”¨ç”¨æˆ·è¾“å…¥çš„å®‰å…¨æ¼æ´çš„ä»£ç æ³¨å…¥æ”»å‡»çš„è¡Œä¸º ä¸»è¦æœ‰ä¸‰ç§ç±»å‹ æŒä¹…å‹ æ¶æ„ä»£ç å­˜å‚¨åœ¨æœåŠ¡ç«¯ åå°„å‹ æ¶æ„ä»£ç å­˜å‚¨åœ¨ URL éœ€è¦è¯±å¯¼ç”¨æˆ·ç‚¹å‡» DOM-based å‰ç«¯éœ€è¦å…³æ³¨ å‰ç«¯ä½¿ç”¨äº†å±é™©çš„æ–¹æ³•å°†ä¸å¯ä¿¡æ•°æ®æ’å…¥é¡µé¢å¯¼è‡´çš„ é˜²æ­¢ è¾“å…¥ä¾§ è½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ éœ€æ ¹æ®ä¸åŒä¸Šä¸‹æ–‡ä½¿ç”¨ä¸åŒè½¬ä¹‰æ–¹æ³• åŸåˆ™ä¸Šï¼Œåªè¦ç”¨æˆ·çš„è¾“å…¥ä¼šè¢«åŒ…å«è¿›é¡µé¢ï¼Œå°±åº”è¯¥æ‰§è¡Œè½¬ä¹‰ è¿‡æ»¤ å»ºç«‹ç™½åå•ï¼Œè¿‡æ»¤å±é™©å­—ç¬¦çš„è¾“å…¥ è¾“å‡ºä¾§ é’ˆå¯¹æŒä¹…ã€åå°„å‹ å¯¹æœåŠ¡ç«¯è¿”å›çš„ html åšå……åˆ†è½¬ä¹‰ ç”¨å‰ç«¯æ¸²æŸ“ éœ€è¦é¢„é˜² DOM-based å‹ xss æ”»å‡» é’ˆå¯¹ DOM-based å‹ xss æ”»å‡» å‰ç«¯é¿å…ä½¿ç”¨å±é™©çš„æ–¹æ³•å°†ä¸ç›¸æ•°æ®æ’å…¥é¡µé¢ å…¶å®ƒ é¢„é˜² xssï¼Œéœ€è¦å‰åç«¯ååŒé…åˆ é’ˆå¯¹çªƒå– cookieï¼Œå¯ä»¥è®¾ç½® http-only å¿…è¦æ—¶å€™å¯ä»¥å¼€å¯ CSP ç­–ç•¥ï¼Œå¢åŠ ä¸€å±‚å®‰å…¨é˜²æŠ¤ å½©è›‹ xss å°æ¸¸æˆ https://xss-game.appspot.com/ å‚è€ƒç­”æ¡ˆ https://blog.csdn.net/abc_12366/article/details/82054946 å‚è€ƒ https://blog.csdn.net/abc_12366/article/details/82054946 https://zhuanlan.zhihu.com/p/21308080 https://juejin.im/post/5bad9140e51d450e935c6d64#heading-29]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>å®‰å…¨</tag>
        <tag>xss</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[flex-space-algorithm]]></title>
    <url>%2F2020%2F03%2F19%2Fflex-space-algorithm%2F</url>
    <content type="text"><![CDATA[flex-basisã€flex-growã€flex-shrink flex-basisã€flex-growã€flex-shrinkè¿™ä¸‰ä¸ªå±æ€§å†³å®šäº†flex itemçš„å±•ç¤ºå°ºå¯¸ è¦æƒ³äº†è§£ä¸‰è€…æ˜¯å¦‚ä½•å†³å®šflex itemçš„å°ºå¯¸å‰ï¼Œå…ˆè¦äº†è§£ä¸€ä¸‹max-contentã€min-contentã€æ­£è´Ÿå‘è‡ªç”±ç©ºé—´æ¦‚å¿µ æ³¨æ„ä»¥ä¸‹çš„è®¨è®ºéƒ½æ˜¯åœ¨ä¸»è½´ä¸ºæ¨ªè½´åŸºç¡€ä¸Šè®¨è®ºçš„ min-contentã€max-content è¿™ä¸¤ä¸ªéƒ½æ˜¯ç”¨æ¥è®¾ç½®widthçš„ é€šè¿‡ä¸‹é¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å°±çŸ¥é“ä»–ä»¬æ˜¯ä»€ä¹ˆå«ä¹‰ 1234567891011121314151617181920212223242526272829303132333435&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;style&gt; .wp &#123; width: 400px; border: 1px solid red; &#125; .box &#123; border: 1px dotted blue; &#125; .box1 &#123; width: min-content; &#125; .box2 &#123; width: max-content; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=&quot;wp&quot;&gt; &lt;p class=&quot;box box1&quot;&gt; Lorem ipsum dolor sit amet consectetur, adipisicing elit. Officia voluptatibus quos nihil dolores &lt;/p&gt; &lt;p class=&quot;box box2&quot;&gt; Lorem ipsum dolor sit amet consectetur, adipisicing elit. Officia voluptatibus quos nihil dolores &lt;/p&gt; &lt;/div&gt; &lt;/body&gt;&lt;/html&gt; mix-max-contet.png å¯ä»¥çœ‹åˆ°box1çš„widthè®¾ç½®äº†min-contentåï¼Œå®ƒæŠ“ä½äº†ä¸€åˆ‡æœºä¼šæ¥æ¢è¡Œï¼Œç›´åˆ°å‡ºç°ä¸€ä¸ªæœ€å¤§çš„æ— æ³•æ¢è¡Œçš„å•è¯æ‰åœæ­¢ï¼Œå°±å¦‚æˆªå›¾ä¸­çš„voluptatibuså•è¯ ä¹Ÿå°±æ˜¯è¯´min-contentçš„å®½åº¦æ˜¯ç”±æœ€é•¿ä¸å¯æ¢è¡Œå•è¯å†³å®šçš„ è€Œè®¾ç½®äº†max-contetçš„box2å´æœ‰æˆªç„¶ç›¸åçš„è¡¨ç°ï¼Œå®ƒå°½å¯èƒ½çš„ä¸æ¢è¡Œï¼Œå°±è·Ÿæˆ‘ä»¬è®¾ç½®äº†white-space:no-wrap;çš„è¡¨ç°å¾ˆç±»ä¼¼ï¼Œå³ä½¿å¤–å±‚.wpè®¾ç½®äº†å›ºå®šå°ºå¯¸ï¼Œå®ƒä¹Ÿä¼šå†²ç ´é™åˆ¶ï¼Œæº¢å‡ºäº† max-contentç¡®å®šçš„å®½åº¦æ˜¯å†…å®¹æ­£å¸¸å±•ç¤ºæ—¶çš„æœ€å¤§å®½åº¦ min-contentã€max-contentåœ¨flexå¸ƒå±€ä¸­æœ‰å…³é”®ä½œç”¨ï¼Œä¸‹é¢ä¼šåšè®²è§£ æ­£è´Ÿå‘è‡ªç”±ç©ºé—´æ­£å‘è‡ªç”±ç©ºé—´ positive free space æ­£å‘è‡ªç”±ç©ºé—´æè¿°çš„æ˜¯flexå¸ƒå±€æ—¶ï¼Œflex containerå‰©ä½™çš„ç©ºé—´ positive-free-space.png åœ¨flexå¸ƒå±€ä¸­ï¼Œå½“flex containerå®½ä¸º500pxï¼Œå†…éƒ¨æœ‰ä¸‰ä¸ª100pxåˆå§‹å®½åº¦çš„flex itemï¼Œé‚£ä¹ˆå‰©ä¸‹çš„200pxå°±æ˜¯æ­£å‘è‡ªç”±ç©ºé—´ï¼Œè¿™200pxçš„å®½åº¦åç»­å°†äº¤ç»™flex-growæŒ‰ç…§ä¸€å®šçš„ç­–ç•¥æ¥åˆ†é… è´Ÿå‘è‡ªç”±ç©ºé—´ negative free space è´Ÿå‘è‡ªç”±ç©ºé—´å…¶å®æ˜¯ä¸€ä¸ªå’Œæ­£å‘ç±»ä¼¼çš„æ¦‚å¿µ å®ƒæè¿°çš„æ˜¯æ‰€æœ‰flex itemå®½åº¦å’Œè¶…å‡ºflex containerçš„éƒ¨åˆ† negative-free-space.png flex containerä»ç„¶æ˜¯500pxï¼Œä½†ä¸‰ä¸ªflex itemåˆå§‹å®½åº¦å˜ä¸º200pxäº†ï¼Œä»–ä»¬å®½åº¦æ€»å’Œè¶…å‡ºflex container 100pxï¼Œè¿™ä¸ª100pxå°±ä¸ºè´Ÿå‘è‡ªç”±ç©ºé—´ï¼Œè¿™100pxçš„å®½åº¦åç»­å°†äº¤ç»™flex-shrinkæŒ‰ç…§ä¸€å®šç­–ç•¥æ¥ç¼©å‡(æ¶ˆåŒ–)ï¼Œè®©å…¶ä¸‰è€…å®½åº¦æ€»å’Œä¸è¶…è¿‡500px æ³¨æ„ æ­£è´Ÿå‘è‡ªç”±ç©ºé—´éƒ½æ˜¯flex-growã€flex-shrinkå‚ä¸ç©ºé—´åˆ†é…å‰çš„æ¦‚å¿µï¼Œå½“è¿™ä¸¤ä¸ªå±æ€§å‚ä¸ç©ºé—´åˆ†é…åï¼Œå…¶å®è¿™ä¸ªç©ºé—´å°±å¯ä»¥è§†ä¸ºä¸å­˜åœ¨äº† flex-basis flex-basisæ˜¯flexå¸ƒå±€çš„åŸºç¡€ flex-basiså†³å®šäº†flex itemåœ¨ä¸»è½´ä¸Šçš„åˆå§‹å°ºå¯¸ åˆå§‹å°ºå¯¸ç”¨æ¥è®¡ç®—æ­£ã€è´Ÿå‘ç©ºé—´ æ­£ã€è´Ÿç©ºé—´å†³å®šäº†flex-growå’Œflex-shrinkå“ªä¸ªç”Ÿæ•ˆ å–å€¼ auto é»˜è®¤å€¼ å¦‚æœè®¾ç½®äº†widthï¼Œåˆ™ä½¿ç”¨widthå€¼åšä¸ºåˆå§‹å°ºå¯¸ï¼Œå¦åˆ™ä½¿ç”¨max-content(æœ€å¤§å†…å®¹å®½åº¦)åšä¸ºåˆå§‹å°ºå¯¸ content ä¸ç®¡æœ‰æ²¡æœ‰è®¾ç½®widthï¼Œéƒ½ä½¿ç”¨æˆ‘çš„max-content(æœ€å¤§å†…å®¹å®½åº¦)åšä¸ºåˆå§‹å°ºå¯¸ å­˜åœ¨å…¼å®¹é—®é¢˜ flex-basis-content.png é0æ•°å€¼ 10px 10% 10em å°†å¯¹åº”æ•°å€¼çš„è®¡ç®—å€¼åšåˆå§‹å°ºå¯¸ 0 åˆå§‹å°ºå¯¸ä¸º 0ï¼Œä»£è¡¨å½“å‰flex itemä¸å‚ä¸æ­£ã€è´Ÿç©ºé—´è®¡ç®— ä¾‹å­ ç”±äºcontentå­˜åœ¨å…¼å®¹é—®é¢˜ï¼Œæ‰€ä»¥æ²¡ä¸¾contentçš„ä¾‹å­ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;style&gt; * &#123; box-sizing: border-box; &#125; .wp &#123; width: 400px; border: 1px solid red; display: flex; flex-direction: row; &#125; .box &#123; border: 1px dotted blue; /* ä¸ºäº†ä¿æŒä¸€è‡´ï¼Œè®©flex item å°ºå¯¸ä¸æ”¾å¤§ä¹Ÿä¸ç¼©å°ï¼Œå°±ç”¨åˆå§‹å°ºå¯¸ */ flex-grow: 0; flex-shrink: 0; &#125; .box+.box&#123; margin-left:10px; &#125; .box:nth-child(1) &#123; /* æœªè®¾ç½®widthï¼Œæ‰€ä»¥ä½¿ç”¨max-content */ flex-basis: auto; &#125; .box:nth-child(2) &#123; /* autoï¼Œå¹¶widthæœ‰å€¼ï¼Œåˆ™å–widthå¯¹åº”å€¼ */ flex-basis: auto; width: 40px; &#125; .box:nth-child(3) &#123; /* 20px */ flex-basis: 20px; &#125; .box:nth-child(4) &#123; /* 30% */ flex-basis: 30%; &#125; .box:nth-child(5) &#123; /* 0 */ /* æœ€åå®½åº¦ä¸ºmin-content */ flex-basis: 0; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=&quot;wp&quot;&gt; &lt;p class=&quot;box&quot;&gt;1 123&lt;/p&gt; &lt;p class=&quot;box&quot;&gt;22&lt;/p&gt; &lt;p class=&quot;box&quot;&gt;333 3&lt;/p&gt; &lt;p class=&quot;box&quot;&gt;4444&lt;/p&gt; &lt;p class=&quot;box&quot;&gt;55555 11&lt;/p&gt; &lt;/div&gt; &lt;/body&gt;&lt;/html&gt; ç¬¬ä¸€ä¸ªç›’å­ example-1.png flex-basisä¸ºautoï¼Œåˆæ²¡è®¾ç½®width,æ‰€ä»¥æœ€ç»ˆå°ºå¯¸ä¸ºmax-content ç¬¬äºŒä¸ªç›’å­ example-2.png è®¾ç½®autoåˆè®¾ç½®äº†widthï¼Œæ‰€ä»¥å–widthå®½åº¦40px æ³¨æ„è¿™é‡Œè™½ç„¶min-content&gt;widthï¼Œä½†æ˜¯æœ€ç»ˆå°ºå¯¸ä»ç„¶æ˜¯width:40px(å¯¼è‡´äº§ç”Ÿæº¢å‡º) æ‰€ä»¥å½“flex-basisæŒ‡å®šautoåŒæ—¶åˆè®¾ç½®widthæ—¶ï¼Œæœ€ç»ˆå°ºå¯¸å°†ä¸å—min-contentå½±å“ ç¬¬ä¸‰ä¸ªç›’å­ example-3.png è™½ç„¶è®¾ç½®äº†flex-basis:20px;ï¼Œä½†ç”±äºmin-contentä¸º30pxï¼Œæ‰€ä»¥æœ€ç»ˆçš„å¤§å°ä¸º30px ç¬¬å››ä¸ªç›’å­ example-4.png 30%ä¸º120pxï¼Œè€Œä¸”min-content&lt;120pxï¼Œæ‰€ä»¥æœ€ç»ˆå°ºå¯¸ä¸º120px ç¬¬äº”ä¸ªç›’å­ example-5.png flex-basisä¸º0ï¼Œä¸å‚ä¸ç©ºé—´è®¡ç®—ï¼Œæ‰€ä»¥æœ€ç»ˆå°ºå¯¸ä¸ºmin-content widthã€flex-basisã€min-widthã€max-width å…³ç³» è®°ä½å…¬å¼ ä¼˜å…ˆçº§flex-basis&gt;width&gt;min|max-content æœ€ç»ˆå±•ç¤ºçš„å¤§å°ä¼šå—max|min-widthé™åˆ¶ åŒæ—¶è®¾ç½®ä¸Šè¿°å±æ€§å¹¶ä¸”flex-basisä¸ä¸ºautoæ—¶ flex-basisä¼šè¦†ç›–(å¿½ç•¥)widthå€¼è¿›è¡Œå¸ƒå±€ï¼Œflex-itemæœ€ç»ˆå±•ç°çš„å°ºå¯¸ä¼šå—min|max-widthé™åˆ¶ å…·ä½“å¯çœ‹ä¸‹é¢ä¾‹å­ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;style&gt; * &#123; box-sizing: border-box; &#125; .wp &#123; border: 1px solid red; display: flex; flex-direction: row; &#125; .box &#123; border: 1px dotted blue; flex-grow: 0; flex-shrink: 0; &#125; .box + .box &#123; margin-left: 10px; &#125; .box:nth-child(1) &#123; flex-basis: auto; /* flex-basisä¸ºautoï¼Œæ‰€ä»¥å–widthä¸ºåˆå§‹å°ºå¯¸ */ width: 200px; /* æœ€ç»ˆå±•ç¤ºå—max-widthé™åˆ¶ */ max-width: 100px; &#125; .box:nth-child(2) &#123; flex-basis: 200px; /* flex-basiséautoï¼Œæ‰€ä»¥widthè¢«å¿½ç•¥ */ width: 400px; &#125; .box:nth-child(3) &#123; flex-basis: 200px; /* flex-basiséautoï¼Œæ‰€ä»¥widthè¢«å¿½ç•¥ */ width: 400px; /* æœ€ç»ˆå±•ç¤ºå—max-widthé™åˆ¶ */ max-width: 100px; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=&quot;wp&quot;&gt; &lt;p class=&quot;box&quot;&gt;1 123 zcjviodf ajdiof jaoisdf asdjifo&lt;/p&gt; &lt;p class=&quot;box&quot;&gt;1 123 zcjviodf ajdiof jaoisdf asdjifo&lt;/p&gt; &lt;p class=&quot;box&quot;&gt;1 123 zcjviodf ajdiof jaoisdf asdjifo&lt;/p&gt; &lt;/div&gt; &lt;/body&gt;&lt;/html&gt; ç¬¬ä¸€ä¸ªç›’å­ space-1.png flex-basisä¸ºautoï¼Œæ‰€ä»¥width:200pxç”Ÿæ•ˆï¼Œä½†æœ€ç»ˆçš„å±•ç¤ºå¤§å°å—max-width:100pxé™åˆ¶ï¼Œæ‰€ä»¥æœ€ç»ˆ100px ç¬¬äºŒä¸ªç›’å­ space-2.png flex-basisä¸ä¸ºautoï¼Œæ‰€ä»¥widthç›´æ¥è¢«å¿½ç•¥ï¼Œæ‰€ä»¥æœ€ç»ˆå°ºå¯¸ä¸ºflex-basisæŒ‡å®šçš„200px ç¬¬ä¸‰ä¸ªç›’å­ space-3.png flex-basisä¸ä¸ºautoï¼Œæ‰€ä»¥widthè¢«å¿½ç•¥ï¼Œå±•ç¤ºå°ºå¯¸ä¸ºflex-basisæŒ‡å®šçš„200pxï¼Œæœ€ç»ˆçš„å°ºå¯¸å—max-width:100pxé™åˆ¶ï¼Œæ‰€ä»¥æœ€åä¸º100px flex-basis å’Œ box-sizing æ³¨æ„flex-basisä¼šå—box-sizingå½±å“ flex-basisæŒ‡å®šçš„å°ºå¯¸ï¼Œå…¶å®æ˜¯box-sizingè®¾ç½®çš„ç›’å­å°ºå¯¸ ä¾‹å­ 1234567891011121314151617181920212223242526272829303132333435&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;style&gt; .wp &#123; display: flex; &#125; .box &#123; flex-basis: 100px; border: 10px solid red; padding: 20px; &#125; .box + .box &#123; margin-left: 10px; &#125; .box:nth-child(1) &#123; box-sizing: border-box; /* flex-basisæŒ‡å®šçš„æ˜¯border-boxçš„å°ºå¯¸ */ &#125; .box:nth-child(2) &#123; /* flex-basisæŒ‡å®šçš„æ˜¯content-boxçš„å°ºå¯¸ */ box-sizing: content-box; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=&quot;wp&quot;&gt; &lt;div class=&quot;box&quot;&gt;1&lt;/div&gt; &lt;div class=&quot;box&quot;&gt;2&lt;/div&gt; &lt;/div&gt; &lt;/body&gt;&lt;/html&gt; å¯ä»¥çœ‹åˆ°åŒæ ·çš„paddingã€borderæœ€åå¾—å‡ºçš„å°ºå¯¸ä¸ä¸€æ · ç¬¬ä¸€ä¸ªç›’å­ flex-basisæŒ‡å®šçš„æ˜¯border-boxçš„å°ºå¯¸ box-sizing-1.png ç¬¬äºŒä¸ªç›’å­ flex-basisæŒ‡å®šçš„æ˜¯content-boxçš„å°ºå¯¸ box-sizing-2.png å°ç»“ flex-basiså†³å®šäº†flex-itemçš„åˆå§‹å°ºå¯¸ flex-basisè®¾ç½®çš„æ˜¯box-sizingæŒ‡å®šçš„ç›’å­å°ºå¯¸ è€Œåˆå§‹å°ºå¯¸åˆå†³å®šäº†æ­£è´Ÿå‘ç©ºé—´ï¼Œè¿›è€Œå½±å“flex-growã€flex-shrinkçš„è¡¨ç° å½“flex-basisä¸ºautoæ—¶ï¼Œå–widthå€¼ä¸ºåˆå§‹å°ºå¯¸ å¦åˆ™ç”¨flex-basisæŒ‡å®šçš„å€¼åšä¸ºåˆå§‹å°ºå¯¸ æœ€ç»ˆå±•ç¤ºçš„å°ºå¯¸ä¼šå—min|max-widthé™åˆ¶ flex-grow æ­£å‘ç©ºé—´çš„åˆ†é… å­˜åœ¨æ­£å‘ç©ºé—´æ—¶ï¼Œåˆ™éœ€è¦å°†ç©ºé—´æŒ‰ç­–ç•¥åˆ†é…ç»™æ¯ä¸ªflex-item ä¹Ÿå°±æ˜¯æŒ‰ç…§ä¸€ä¸ªæ”¾å¤§ç­–ç•¥å°†å‰©ä½™ç©ºé—´åˆ†é…ç»™æ¯ä¸ªflex-item å†³å®šå¦‚ä½•æ”¾å¤§çš„å…³é”®å±æ€§å°±æ˜¯flex-grow é»˜è®¤å€¼ä¸º0ï¼Œå³ä¸æ”¾å¤§ æ”¾å¤§ç®—æ³• flex-growåªèƒ½å–æ­£å€¼ å®ƒä»£è¡¨çš„æ˜¯ä¸€ä¸ªæ‹‰ä¼¸(æ”¾å¤§)å› å­ å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ¯”ä¾‹(æƒé‡)ï¼Œä»£è¡¨æœ‰å¤šå°‘æ­£å‘ç©ºé—´çš„åˆ†é…æƒåˆ© ç®—æ³•å…¬å¼ æœ€ç»ˆå°ºå¯¸=åˆå§‹å°ºå¯¸ + åˆ†é…æ¯”ä¾‹*æ­£å‘ç©ºé—´å¤§å° åˆ†é…æ¯”ä¾‹ = å½“å‰flex-itemçš„æ‹‰ä¼¸å› å­/æ‰€æœ‰flex-itemçš„æ‹‰ä¼¸å› å­ä¹‹å’Œ æ³¨æ„ æ‰€æœ‰flex-itemçš„æ‹‰ä¼¸å› å­ä¹‹å’Œ æœ€å°å€¼ä¸º 1ï¼Œå³å¦‚æœæ‹‰ä¼¸å› å­ä¹‹å’Œå°äº 1ï¼Œä¹Ÿä¼šå– 1 å‚ä¸è®¡ç®— è¿™ä¼šå¯¼è‡´å‡ºç°æ­£å‘ç©ºé—´æ²¡æœ‰è¢«å…¨éƒ¨åˆ†é…çš„åœºæ™¯ï¼Œå…·ä½“è§ç¬¬äºŒä¸ªä¾‹å­ æ¯”å¦‚æ­£å‘ç©ºé—´ä¸º xï¼Œä¸‰ä¸ªå…ƒç´ çš„ flex-grow åˆ†åˆ«ä¸º aï¼Œbï¼Œcã€‚è®¾ sum ä¸º a + b + cã€‚é‚£ä¹ˆä¸‰ä¸ªå…ƒç´ å°†å¾—åˆ°çš„æ­£å‘ç©ºé—´åˆ†åˆ«æ˜¯ x * a / sum, x * b / sum, x * c / sumï¼Œæœ€ç»ˆå°ºå¯¸ä¸ºåˆå§‹å°ºå¯¸åŠ ä¸Š+è·å¾—çš„æ­£å‘ç©ºé—´ ä¾‹å­ 1ï¼Œæ‹‰ä¼¸å› å­ä¹‹å’Œ&gt;=1123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;style&gt; * &#123; box-sizing: border-box; &#125; .c-Wp &#123; width: 500px; border: 1px solid red; display: flex; &#125; .c-Box &#123; outline: 1px dotted blue; /* ä¸ç¼©æ”¾ */ flex-shrink: 0; &#125; .c-Box:nth-child(1) &#123; /* æ­£å‘ç©ºé—´æˆ‘åˆ†é… 1/6 */ flex-grow: 1; flex-basis: 100px; &#125; .c-Box:nth-child(2) &#123; /* æ­£å‘ç©ºé—´æˆ‘åˆ†é… 2/6 */ flex-grow: 2; flex-basis: 150px; &#125; .c-Box:nth-child(3) &#123; /* æ­£å‘ç©ºé—´æˆ‘åˆ†é… 3/6 */ flex-grow: 3; flex-basis: 100px; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=&quot;c-Wp&quot;&gt; &lt;div class=&quot;c-Box&quot;&gt;one jiojio&lt;/div&gt; &lt;div class=&quot;c-Box&quot;&gt;two jlkzjclkvz&lt;/div&gt; &lt;div class=&quot;c-Box&quot;&gt;three cjioajdisof&lt;/div&gt; &lt;/div&gt; &lt;/body&gt;&lt;/html&gt; å¯ä»¥çœ‹åˆ°flex containerå°ºå¯¸ä¸º500px ä¸‰ä¸ªflex itemçš„åˆå§‹å°ºå¯¸åˆ†åˆ«ä¸º100pxã€150pxã€100pxï¼Œæ‰€ä»¥å‰©ä½™500-350=150çš„æ­£å‘ç©ºé—´ ä¸‰ä¸ªflex itemåˆ†åˆ«è®¾ç½®äº†1ã€2ã€3çš„æ‹‰ä¼¸å› å­(æƒé‡) æˆ‘ä»¬è®°sum=1 + 2 + 3 = 6ä¸ºæƒé‡æ€»å’Œï¼Œæ‰€ä»¥æ¯ä¸ªflex-itemçš„åˆ†é…æ¯”ä¾‹ä¹Ÿå°±å¯ä»¥è®¡ç®—å‡ºæ¥ ç¬¬ä¸€ä¸ªç›’å­ 1/sumå³1/6ï¼Œå³150 * 1/6 = 25 æ‰€ä»¥æœ€ç»ˆå°ºå¯¸ä¸º100(åˆå§‹å°ºå¯¸) + 25(æ­£å‘ç©ºé—´)=125 grow-over-1.png ç¬¬äºŒä¸ªç›’å­ 2/sumå³2/6ï¼Œå³150 * 1/6 = 50 æ‰€ä»¥æœ€ç»ˆå°ºå¯¸ä¸º150(åˆå§‹å°ºå¯¸) + 50(æ­£å‘ç©ºé—´)=200 grow-over-2.png ç¬¬ä¸€ä¸ªç›’å­ 3/sumå³3/6ï¼Œå³150 * 1/6 = 75 æ‰€ä»¥æœ€ç»ˆå°ºå¯¸ä¸º100(åˆå§‹å°ºå¯¸) + 75(æ­£å‘ç©ºé—´)=175 grow-over-3.png ä¾‹å­ 2ï¼Œæ‹‰ä¼¸å› å­ä¹‹å’Œ&lt;1123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;style&gt; * &#123; box-sizing: border-box; &#125; .c-Wp &#123; width: 500px; border: 1px solid red; display: flex; &#125; .c-Box &#123; outline: 1px dotted blue; /* ä¸ç¼©æ”¾ */ flex-shrink: 0; &#125; .c-Box:nth-child(1) &#123; /* æ­£å‘ç©ºé—´æˆ‘åˆ†é… 0.1/1 */ flex-grow: 0.1; flex-basis: 100px; &#125; .c-Box:nth-child(2) &#123; /* æ­£å‘ç©ºé—´æˆ‘åˆ†é… 0.2/1 */ flex-grow: 0.2; flex-basis: 150px; &#125; .c-Box:nth-child(3) &#123; /* æ­£å‘ç©ºé—´æˆ‘åˆ†é… 0.3/1 */ flex-grow: 0.3; flex-basis: 100px; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=&quot;c-Wp&quot;&gt; &lt;div class=&quot;c-Box&quot;&gt;one jiojio&lt;/div&gt; &lt;div class=&quot;c-Box&quot;&gt;two jlkzjclkvz&lt;/div&gt; &lt;div class=&quot;c-Box&quot;&gt;three cjioajdisof&lt;/div&gt; &lt;/div&gt; &lt;/body&gt;&lt;/html&gt; å¯ä»¥çœ‹åˆ°sum= 0.1 + 0.2 + 0.3 = 0.6 &lt; 1ï¼Œæ‰€ä»¥æœ€ç»ˆå–1å‚ä¸è®¡ç®— ç¬¬ä¸€ä¸ªç›’å­ æœ€ç»ˆå°ºå¯¸:100(åˆå§‹å°ºå¯¸) +0.1/1 * 150 = 115 grow-less-1.png ç¬¬äºŒä¸ªç›’å­ æœ€ç»ˆå°ºå¯¸:150(åˆå§‹å°ºå¯¸) +0.2/1 * 150 = 180 grow-less-2.png ç¬¬ä¸‰ä¸ªç›’å­ æœ€ç»ˆå°ºå¯¸:100(åˆå§‹å°ºå¯¸) +0.3/1 * 150 = 145 grow-less-3.png å¯ä»¥çœ‹åˆ°æœ€åè¿˜æœ‰500 -115 - 180 - 145 = 60çš„å°ºå¯¸æ²¡æœ‰åˆ†é… ç­‰åˆ†å¸ƒå±€ å¦‚ä½•å®ç°è‡ªé€‚åº”ç­‰åˆ†å¸ƒå±€? æ‰€æœ‰flex itemçš„flex-basisè®¾ç½®ä¸º0å’Œflex-growè®¾ç½®ä¸ºç›¸åŒå€¼(æ€»å’Œ&gt;1)å³å¯ åŸç† flex-basis:0ä»£è¡¨åˆå§‹å°ºå¯¸ä¸º 0ï¼Œå½“æ‰€æœ‰flex itemçš„åˆå§‹å°ºå¯¸éƒ½ä¸º 0ï¼Œé‚£è®¡ç®—å‡ºæ¥çš„æ­£å‘ç©ºé—´å°±ä¸ºflex containerçš„å°ºå¯¸ flex-growè®¾ç½®ä¸ºç›¸åŒå€¼å¹¶ä¸”æ€»å’Œ&gt;1ï¼Œä»£è¡¨å¹³å‡åˆ†é…æ‰€æœ‰æ­£å‘ç©ºé—´ï¼Œç”±äºåˆå§‹å°ºå¯¸ä¸º 0ï¼Œæ‰€æœ‰flex itemå¾—åˆ°çš„æ­£å‘ç©ºé—´åˆç›¸åŒï¼Œæ‰€ä»¥å°±å®ç°äº†ç­‰åˆ†å¸ƒå±€ ä¾‹å­ 123456789101112131415161718192021222324252627282930313233&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;style&gt; * &#123; box-sizing: border-box; &#125; .c-Wp &#123; width: 500px; border: 1px solid red; display: flex; &#125; .c-Box &#123; outline: 1px dotted blue; /* ä¸ç¼©æ”¾ */ flex-shrink: 0; flex-basis: 0; flex-grow: 1; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=&quot;c-Wp&quot;&gt; &lt;div class=&quot;c-Box&quot;&gt;one jiojio&lt;/div&gt; &lt;div class=&quot;c-Box&quot;&gt;two jlkzjclkvz&lt;/div&gt; &lt;div class=&quot;c-Box&quot;&gt;three cjioajdisof&lt;/div&gt; &lt;/div&gt; &lt;/body&gt;&lt;/html&gt; average.png flex-shrink è´Ÿå‘ç©ºé—´çš„åˆ†é… å­˜åœ¨è´Ÿå‘ç©ºé—´æ—¶ï¼Œéœ€è¦æŒ‰ç…§ç¼©å°ç®—æ³•æ”¶ç¼©æ¯ä¸ªflex-item é»˜è®¤å€¼ä¸º0ï¼Œå³ä¸ç¼©å° ç¼©å°ç®—æ³• å’Œæ”¾å¤§ç®—æ³•ä¸åŒï¼Œç¼©å°ç®—æ³•åœ¨è®¡ç®—æ¯ä¸ªflex itemçš„æ”¶ç¼©å¤§å°æ—¶ï¼Œä¸ä»…éœ€è¦è€ƒè™‘æ”¶ç¼©å› å­(flex-shrinkæŒ‡å®šçš„å€¼)ï¼Œè¿˜éœ€è¦è€ƒè™‘itemçš„åˆå§‹å°ºå¯¸ å…·ä½“ç®—æ³• æ€»æƒé‡ TW = æ¯ä¸ª(itemçš„flex-shrink * itemçš„åˆå§‹å°ºå¯¸)ä¹‹å’Œ å½“å‰iteméœ€è¦ç¼©å°çš„å°ºå¯¸= è´Ÿå‘ç©ºé—´ _ ((å½“å‰ item çš„flex-shrink _ åˆå§‹å°ºå¯¸) / æ€»æƒé‡ TW) æœ€ç»ˆå°ºå¯¸ = å½“å‰itemåˆå§‹å°ºå¯¸ + éœ€è¦ç¼©å°å°ºå¯¸ (å› ä¸ºè´Ÿå‘ç©ºé—´å°ºå¯¸ä¸ºè´Ÿå€¼ï¼Œæ‰€ä»¥æ­¤å¤„ä¸ºåŠ å·) ä¾‹å­ 1ï¼Œç¼©å°å› å­ä¹‹å’Œ&gt;=11234567891011121314151617181920212223242526272829303132333435363738394041&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;style&gt; * &#123; box-sizing: border-box; &#125; .c-Wp &#123; width: 500px; border: 1px solid red; display: flex; &#125; .c-Box &#123; outline: 1px dotted blue; flex-grow: 0; &#125; .c-Box:nth-child(1) &#123; flex-shrink: 1; flex-basis: 150px; &#125; .c-Box:nth-child(2) &#123; flex-shrink: 2; flex-basis: 200px; &#125; .c-Box:nth-child(3) &#123; flex-shrink: 3; flex-basis: 300px; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=&quot;c-Wp&quot;&gt; &lt;div class=&quot;c-Box&quot;&gt;1&lt;/div&gt; &lt;div class=&quot;c-Box&quot;&gt;2&lt;/div&gt; &lt;div class=&quot;c-Box&quot;&gt;3&lt;/div&gt; &lt;/div&gt; &lt;/body&gt;&lt;/html&gt; è´Ÿå‘ç©ºé—´ = 500 - 150 - 200 - 300 = -150 è®¡ç®—æ€»æƒé‡ TW = 1 * 150 + 2 * 200 + 3 * 300 = 1450 ç¬¬ä¸€ä¸ªç›’å­ æœ€ç»ˆå°ºå¯¸= 150 + (-150è´Ÿå‘ç©ºé—´ * ((1*150) / 1450)) = 134.5 shrink-over-1.png ç¬¬äºŒä¸ªç›’å­ æœ€ç»ˆå°ºå¯¸= 200 + (-150è´Ÿå‘ç©ºé—´ * ((2*200) / 1450)) = 158.6 shrink-over-2.png ç¬¬ä¸‰ä¸ªç›’å­ æœ€ç»ˆå°ºå¯¸= 300 + (-150è´Ÿå‘ç©ºé—´ * ((3*300) / 1450)) = 206.9 shrink-over-3.png ä¾‹å­ 2ï¼Œç¼©å°å› å­ä¹‹å’Œ&lt;1 å½“ç¼©æ”¾å› å­ä¹‹å’Œ&lt;1 æ—¶ï¼Œåªæœ‰ç¼©æ”¾å› å­ä¹‹å’Œ* è´Ÿå‘ç©ºé—´çš„ç©ºé—´ä¼šå‚ä¸æ”¶ç¼© ä¾‹å¦‚ , ç¼©æ”¾å› å­åˆ†åˆ«ä¸º0.1ã€0.2ã€0.3ï¼Œæ€»å’Œ&lt;1ï¼Œè´Ÿå‘ç©ºé—´çš„å°ºå¯¸ä¸º 150ï¼Œé‚£ä¹ˆåªæœ‰ 90 çš„ç©ºé—´ä¼šè¢«ç¼©å° ä¾‹å­(å°†ä¾‹å­ 1 çš„ç¼©æ”¾å› å­è®¾ç½®ä¸ºç¼©å°åå€) 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;!DOCTYPE html&gt;&lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot; /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;style&gt; * &#123; box-sizing: border-box; &#125; .c-Wp &#123; width: 500px; border: 1px solid red; display: flex; &#125; .c-Box &#123; outline: 1px dotted blue; flex-grow: 0; &#125; .c-Box:nth-child(1) &#123; flex-shrink: 0.1; flex-basis: 150px; &#125; .c-Box:nth-child(2) &#123; flex-shrink: 0.2; flex-basis: 200px; &#125; .c-Box:nth-child(3) &#123; flex-shrink: 0.3; flex-basis: 300px; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=&quot;c-Wp&quot;&gt; &lt;div class=&quot;c-Box&quot;&gt;1&lt;/div&gt; &lt;div class=&quot;c-Box&quot;&gt;2&lt;/div&gt; &lt;div class=&quot;c-Box&quot;&gt;3&lt;/div&gt; &lt;/div&gt; &lt;/body&gt;&lt;/html&gt; è´Ÿå‘ç©ºé—´ = 500 - 150 - 200 - 300 = -150 è®¡ç®—æ€»æƒé‡ TW = 0.1* 150 + 0.2 * 200 + 0.3 * 300 = 145 ç¬¬ä¸€ä¸ªç›’å­ æœ€ç»ˆå°ºå¯¸= 150 + (-150è´Ÿå‘ç©ºé—´ * (0.1 + 0.2 + 0.3) * ((0.1*150) / 145)) = 140.69 shrink-less-1.png ç¬¬äºŒä¸ªç›’å­ æœ€ç»ˆå°ºå¯¸= 200 + (-150è´Ÿå‘ç©ºé—´ * (0.1 + 0.2 + 0.3) * ((0.2*200) / 145)) = 175.17 shrink-less-2.png ç¬¬ä¸‰ä¸ªç›’å­ æœ€ç»ˆå°ºå¯¸= 300 + (-150è´Ÿå‘ç©ºé—´ * (0.1 + 0.2 + 0.3) * ((0.3*300) / 145)) = 244.14 shrink-less-3.png å¯ä»¥çœ‹åˆ°è¿˜æœ‰60pxæº¢å‡ºäº†(æ²¡æœ‰è¢«æ”¶ç¼©) å°ç»“ æ”¾å¤§å’Œç¼©å°çš„ç®—æ³•ä¸å¤ªä¸€æ ·ï¼Œç¼©å°ç®—æ³•éœ€è¦è€ƒè™‘åˆå§‹å°ºå¯¸ æ€»ç»“å…¬å¼å¦‚ä¸‹ sumary.png ç®€å†™å±æ€§flex flexæ˜¯ä¸Šè¿°ä¸‰è€…çš„ç®€å†™ å…¶é»˜è®¤å€¼ä¸ºflex: 0 1 auto; ä¸‰ä¸ªå€¼ä¾æ¬¡ä»£è¡¨flex-growã€flex-shrinkã€flex-basis 0 ä»£è¡¨ä¸æ”¾å¤§ 1 ä»£è¡¨ä¸ç¼©å° auto ä»£è¡¨ä½¿ç”¨ width å€¼åšä¸ºåˆå§‹å°ºå¯¸ ç”±äºé»˜è®¤å€¼ä¸º0 1 autoï¼Œæ‰€ä»¥åœ¨æŸäº›ç‰¹å®šåœºæ™¯ï¼Œä¼šå‡ºç°é—®é¢˜ï¼Œæ‰€ä»¥å»ºè®®åœ¨ä»»ä½•åœºæ™¯éƒ½æ˜¾ç¤ºæŒ‡æ˜flexçš„ä¸‰ä¸ªå±æ€§å€¼ å¸¸ç”¨ç¼©å†™ flex:1 ç­‰åŒflex: 1 1 0; flex:0 ç­‰åŒflex: 0 1 0; flex:auto ç­‰åŒflex: 1 1 auto; flex åº”ç”¨ç§»åŠ¨ç«¯å¸¸è§ï¼Œå¤´å°¾å›ºå®šï¼Œä¸­é—´å±€éƒ¨æ»šåŠ¨å¸ƒå±€1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;template&gt; &lt;div class=&quot;c-BaseLayoutVertical&quot;&gt; &lt;div v-if=&quot;this.$slots.header&quot; class=&quot;c-BaseLayoutVertical-hd&quot; &gt; &lt;slot name=&quot;header&quot; /&gt; &lt;/div&gt; &lt;div class=&quot;c-BaseLayoutVertical-bd&quot;&gt; &lt;slot /&gt; &lt;/div&gt; &lt;div v-if=&quot;this.$slots.footer&quot; class=&quot;c-BaseLayoutVertical-ft&quot; &gt; &lt;slot name=&quot;footer&quot; /&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script&gt;/** * * å¸¸è§å‚ç›´ä¸Šä¸­ä¸‹ä¸‰è¡Œå¸ƒå±€ */export default &#123; name: &apos;BaseLayoutVertical&apos;&#125;&lt;/script&gt;&lt;style scoped&gt;/** * ! c-BaseLayoutVerticalèŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹éœ€è¦æœ‰é«˜åº¦ */.c-BaseLayoutVertical &#123; display: flex; flex-direction: column; height: 100%;&#125;.c-BaseLayoutVertical-hd &#123; flex: 0 0 auto;&#125;.c-BaseLayoutVertical-bd &#123; flex: 1 1 auto; height: 100%; overflow: auto; -webkit-overflow-scrolling: touch; /* ä¼˜åŒ–æ»šåŠ¨æ€§èƒ½ */ will-change: scroll-position; position: relative; z-index: 1;&#125;.c-BaseLayoutVertical-ft &#123; flex: 0 0 auto;&#125;&lt;/style&gt; apply.png åŒç†æ°´å¹³æ–¹å‘ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å®ç°å¸¸è§çš„åŒé£ç¿¼ã€åœ£æ¯å¸ƒå±€ å…·ä½“å¯å‚è€ƒä¸‹é¢è¿æ¥ https://github.com/BryanAdamss/vue-awesome-template/blob/master/src/views/LayoutTest/LayoutTest.vue æ€»ç»“ç¡®å®š flex item å°ºå¯¸çš„æ­¥éª¤ é¦–å…ˆç¡®å®šåˆå§‹å°ºå¯¸ flex-basisã€widthå†³å®š flex-basisä¸ºautoæ—¶ï¼Œå–widthå€¼ï¼Œè‹¥æœªæ˜¾ç¤ºæŒ‡å®šwidthå€¼ï¼Œåˆ™å–max-content éautoæ—¶ï¼Œç›´æ¥å–å¯¹åº”å€¼çš„è®¡ç®—å€¼ä¸ºåˆå§‹å°ºå¯¸ ç¡®å®šç©ºé—´ç±»å‹ åˆå§‹å°ºå¯¸ä¹‹å’Œ &gt;flex containerå°ºå¯¸æ—¶å­˜åœ¨è´Ÿå‘ç©ºé—´ è´Ÿå‘ç©ºé—´å¤§å° = åˆå§‹å°ºå¯¸ä¹‹å’Œ - flex containerå°ºå¯¸ åˆå§‹å°ºå¯¸ä¹‹å’Œ &lt; flex containerå°ºå¯¸æ—¶å­˜åœ¨æ­£å‘ç©ºé—´ æ­£å‘ç©ºé—´å¤§å° = flex containerå°ºå¯¸ - åˆå§‹å°ºå¯¸ä¹‹å’Œ æ ¹æ®ç©ºé—´ç±»å‹å†³å®šä½¿ç”¨flex-growã€flex-shrinkç­–ç•¥æ¥åˆ†é…ç©ºé—´ï¼Œå¾—åˆ°å±•ç¤ºå¤§å° æ­£å‘ç©ºé—´ç›´æ¥æŒ‰æ‹‰ä¼¸å› å­(flex-growç”³æ˜çš„)æ‰€å æ¯”ä¾‹æ¥åˆ†é… è´Ÿå‘ç©ºé—´æ”¶ç¼©ä¸å…‰è¦è€ƒè™‘æ”¶ç¼©å› å­ï¼Œè¿˜éœ€è¦è€ƒè™‘åˆ°åˆå§‹å°ºå¯¸ å±•ç¤ºå¤§å°å—min|max-width|heightçš„é™åˆ¶ å‚è€ƒ https://developer.mozilla.org/zh-CN/docs/Web/CSS/flex-basis https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Flexible_Box_Layout/Controlling_Ratios_of_Flex_Items_Along_the_Main_Ax https://www.zhangxinxu.com/wordpress/2019/12/css-flex-basis/ https://www.zhangxinxu.com/wordpress/2019/12/css-flex-deep/ https://github.com/xieranmaya/blog/issues/9 https://www.cnblogs.com/yunqishequ/p/10006872.html]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>flex</tag>
        <tag>å¸ƒå±€</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[stacking-context]]></title>
    <url>%2F2020%2F03%2F07%2Fstacking-context%2F</url>
    <content type="text"><![CDATA[stacking contextz è½´ ç½‘é¡µå…¶å®æ˜¯ä¸€ä¸ªä¸‰ç»´çš„ï¼Œæ‹¥æœ‰xã€yã€zä¸‰ä¸ªè½´ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼› z è½´æ­£æ–¹å‘æ­£å¯¹ç€å±å¹•ï¼› å½“ html ä¸­çš„å…ƒç´ å‘ç”Ÿå±‚å æ—¶ï¼Œå°±éœ€è¦ç¡®å®šå…ƒç´ å“ªä¸ªåœ¨ä¸Š(ç¦»ç”¨æˆ·è¿‘)ï¼Œå“ªä¸ªåœ¨ä¸‹(ç¦»ç”¨æˆ·è¿œ)ï¼› è€Œå†³å®šå…ƒç´ åœ¨ z è½´é¡ºåºçš„å› ç´ æœ‰ å…ƒç´ çš„ç±»å‹(float, block-level, inline-level, absolutely positioned) å…ƒç´ åœ¨å½“å‰stacking contextä¸­çš„z-indexå€¼ stacking contextå®šä¹‰ stacking contextå±‚å ä¸Šä¸‹æ–‡æ˜¯ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œå€Ÿç”¨mdnçš„å®šä¹‰ 1æˆ‘ä»¬å‡å®šç”¨æˆ·æ­£é¢å‘ï¼ˆæµè§ˆå™¨ï¼‰è§†çª—æˆ–ç½‘é¡µï¼Œè€Œ HTML å…ƒç´ æ²¿ç€å…¶ç›¸å¯¹äºç”¨æˆ·çš„ä¸€æ¡è™šæ„çš„ z è½´æ’å¼€ï¼Œå±‚å ä¸Šä¸‹æ–‡å°±æ˜¯å¯¹è¿™äº› HTML å…ƒç´ çš„ä¸€ä¸ªä¸‰ç»´æ„æƒ³ã€‚ä¼— HTML å…ƒç´ åŸºäºå…¶å…ƒç´ å±æ€§æŒ‰ç…§ä¼˜å…ˆçº§é¡ºåºå æ®è¿™ä¸ªç©ºé—´ã€‚ æˆ‘ä»¬ä¸ç”¨å…³æ³¨ä»–çš„å®šä¹‰ï¼Œåªéœ€è¦çŸ¥é“å®ƒå’Œå…ƒç´ åœ¨ z è½´çš„å±•ç¤ºæœ‰ä¸€å®šå…³ç³»å°±å¯ä»¥äº† å±‚å ä¸Šä¸‹æ–‡å¯ä»¥ç†è§£ä¸ºå±‚å å‘ç”Ÿçš„ç¯å¢ƒï¼Œæ‰€æœ‰çš„å±‚å éƒ½æ˜¯å‘ç”Ÿåœ¨å±‚å ä¸Šä¸‹æ–‡ç¯å¢ƒä¸­çš„ å±‚å ä¸Šä¸‹æ–‡æ˜¯å¯ä»¥åµŒå¥—çš„ å±‚å ä¸Šä¸‹æ–‡æ˜¯å…ƒç´ å‘ç”Ÿå±‚å çš„ç¯å¢ƒ ç”Ÿæˆ å‘ç”Ÿå±‚å ï¼Œå¿…é¡»æœ‰å±‚å ä¸Šä¸‹æ–‡ ä»¥ä¸‹é€”å¾„ä¼šç”Ÿæˆå±‚å ä¸Šä¸‹æ–‡ æ–‡æ¡£æ ¹å…ƒç´ ï¼ˆï¼‰ æ ¹å±‚å ä¸Šä¸‹æ–‡ position å€¼ä¸º absoluteï¼ˆç»å¯¹å®šä½ï¼‰æˆ– relativeï¼ˆç›¸å¯¹å®šä½ï¼‰ï¼Œå¹¶ä¸” z-index å€¼ä¸ä¸º auto çš„å…ƒç´ ï¼› è®¾ç½®äº† absolute æˆ–è€… relativeï¼Œå¹¶ä¸” z-index ä¸ä¸º auto position å€¼ä¸º fixedï¼ˆå›ºå®šå®šä½ï¼‰æˆ– stickyï¼ˆç²˜æ»å®šä½ï¼‰çš„å…ƒç´ ï¼› flex (flexbox) å®¹å™¨çš„å­å…ƒç´ ï¼Œä¸” z-index å€¼ä¸ä¸º auto flex å®¹å™¨ä¸­çš„ z-index ä¸ä¸º auto çš„ item å…ƒç´ ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å±‚å ä¸Šä¸‹æ–‡ grid (grid) å®¹å™¨çš„å­å…ƒç´ ï¼Œä¸” z-index å€¼ä¸ä¸º auto grid å®¹å™¨ä¸­çš„ z-index ä¸ä¸º auto çš„ item å…ƒç´ ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å±‚å ä¸Šä¸‹æ–‡ opacity å±æ€§å€¼å°äº 1 çš„å…ƒç´  mix-blend-mode å±æ€§å€¼ä¸ä¸º normal çš„å…ƒç´  transformã€filterã€perspective ã€clip-pathã€maskã€mask-imageã€mask-border ä»»æ„å€¼ä¸ä¸º none çš„å…ƒç´ éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å±‚å ä¸Šä¸‹æ–‡ isolation å±æ€§å€¼ä¸º isolate çš„å…ƒç´  webkit-overflow-scrolling å±æ€§å€¼ä¸º touch çš„å…ƒç´  will-change å€¼è®¾å®šäº†ä»»ä¸€å±æ€§è€Œè¯¥å±æ€§åœ¨ non-initial å€¼æ—¶ä¼šåˆ›å»ºå±‚å ä¸Šä¸‹æ–‡çš„å…ƒç´  contain å±æ€§å€¼ä¸º layoutã€paint æˆ–åŒ…å«å®ƒä»¬å…¶ä¸­ä¹‹ä¸€çš„åˆæˆå€¼ï¼ˆæ¯”å¦‚ contain: strictã€contain: contentï¼‰çš„å…ƒç´  æ³¨æ„ å…ƒç´ ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ ¹å±‚å ä¸Šä¸‹æ–‡ æ‰€ä»¥æ¯ä¸ªç›’å­éƒ½ä¼šå±äºä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡ï¼Œä¸å­˜åœ¨æŸä¸ªå…ƒç´ æ‰¾ä¸åˆ°æ‰€å±çš„å±‚å ä¸Šä¸‹æ–‡ å±‚å ä¸Šä¸‹æ–‡æ˜¯å¯ä»¥ç›¸äº’åµŒå¥—çš„ æ¯ä¸ªå±‚å ä¸Šä¸‹æ–‡éƒ½æ˜¯å®Œå…¨ç‹¬ç«‹äºå®ƒçš„å…„å¼Ÿå…ƒç´ ï¼Œå¤„ç†å±‚å æ—¶åªè€ƒè™‘å…¶å­å…ƒç´  å½“å…ƒç´ çš„åä»£å…ƒç´ å‘ç”Ÿå±‚å åï¼Œè¯¥å…ƒç´ å°†è¢«ä½œä¸ºæ•´ä½“åœ¨çˆ¶çº§å±‚å ä¸Šä¸‹æ–‡ä¸­æŒ‰é¡ºåºè¿›è¡Œå±‚å  stacking level å±‚å ç­‰çº§(stacking level)æ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œç”¨æ¥æè¿°åœ¨åŒä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡ä¸­å…ƒç´ åœ¨ z è½´çš„ä½ç½®ï¼Œå¯ä»¥è¿™æ ·è¯´åŒä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡ä¸­å±‚å ç­‰çº§è¶Šå¤§ï¼Œè¶Šé è¿‘ç”¨æˆ· å±‚å ç­‰çº§ä¸ç­‰åŒäºz-indexï¼Œå±‚å ç­‰çº§æ˜¯ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œz-indexåœ¨ç‰¹æ®Šæƒ…å†µä¸‹ä¼šå½±å“å…ƒç´ çš„å±‚å ç­‰çº§ å±‚å ç­‰çº§æè¿°çš„æ˜¯å…ƒç´ åœ¨ä¸Šä¸‹æ–‡ä¸­ä½ç½® z-index z-index è§„å®šäº†ï¼Œå‘ç”Ÿå±‚å æ—¶ï¼Œå¤„äºåŒä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡çš„å®šä½è¿‡çš„å…ƒç´ (position ä¸ä¸º static)å±‚å è§„åˆ™ï¼Œz-index å¤§çš„åœ¨ä¸Šé¢ æ³¨æ„ æ‰€æœ‰å…ƒç´ (æ— è®ºæ˜¯å¦è®¾ç½®äº† position å±æ€§)éƒ½æœ‰ z-index,é»˜è®¤ z-index ä¸º autoï¼›ä½†åªæœ‰è¢«å®šä½è¿‡ï¼Œz-index æ‰ä¼šç”Ÿæ•ˆ å½“å…ƒç´ çš„ position ä¸ä¸º static æ—¶ï¼Œä»£è¡¨å…ƒç´ è¢«å®šä½è¿‡ï¼Œæ­¤æ—¶ z-index æ‰ä¼šå‘æŒ¥ä½œç”¨ï¼Œæ‰ä¼šå¯¹åŒä¸€å±‚å ä¸Šä¸‹æ–‡ä¸­çš„å±‚å é¡ºåºäº§ç”Ÿå½±å“(z-index å¤§çš„å®šä½è¿‡å…ƒç´ åœ¨ä¸Šé¢ï¼Œå°çš„åœ¨ä¸‹é¢) æœªå®šä½è¿‡çš„å…ƒç´ å³ä½¿è®¾ç½®äº†å¾ˆå¤§çš„ z-indexï¼Œåœ¨å±‚å æ—¶ä¹Ÿä¼šè¢«å½“ä½œ auto å¤„ç† å½“ z-index å‘æŒ¥ä½œç”¨æ—¶ï¼Œå…¶å€¼ä¸º auto åˆ™åœ¨æ¯”è¾ƒå±‚å é¡ºåºæ—¶å¯è§†ä¸º 0 stacking order(é‡ç‚¹) å±‚å é¡ºåºæ˜¯ä¸€ç§è§„åˆ™ï¼Œè§„å®šäº†å…ƒç´ åœ¨ z è½´ä¸ŠæŒ‰ä»€ä¹ˆæ ·çš„è§„åˆ™å±‚å (å“ªä¸ªåœ¨ä¸Šï¼Œå“ªä¸ªåœ¨ä¸‹) åœ¨åŒä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡ä¸­ï¼ŒæŒ‰ä¸‹é¢é¡ºåºï¼Œåœ¨ z è½´ä¸Šç”±ä¸‹åˆ°ä¸Šæ¸²æŸ“ äº§ç”Ÿå±‚å ä¸Šä¸‹æ–‡å…ƒç´ çš„ backgroundã€border z-index ä¸ºè´Ÿå€¼çš„å®šä½è¿‡ç›’å­ å—çº§ç›’å­ float ç›’å­ inline/inline-block ç›’å­ z-index ä¸º auto æˆ– 0 çš„å®šä½è¿‡ç›’å­ã€å…¶ä»–ä¸ä¾èµ– z-index äº§ç”Ÿå±‚å ä¸Šä¸‹æ–‡çš„ç›’å­(ä¾‹å¦‚ opacity&lt;1 çš„ç›’å­) å½“äºŒè€…å†²çªæ—¶ï¼Œéµå¾ªâ€œåæ¥å±…ä¸Šâ€çš„åŸåˆ™ï¼Œåœ¨ DOM æµä¸­å¤„äºåé¢çš„å…ƒç´ ä¼šè¦†ç›–å‰é¢çš„å…ƒç´  z-index ä¸ºæ­£æ•°å€¼çš„å®šä½è¿‡ç›’å­ ä¸¤å¤§åŸåˆ™ è°å¤§è°ä¸Šï¼šå½“å…·æœ‰æ˜æ˜¾çš„å±‚å æ°´å¹³æ ‡ç¤ºçš„æ—¶å€™ï¼Œå¦‚è¯†åˆ«çš„ z-indx å€¼ï¼Œåœ¨åŒä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡é¢†åŸŸï¼Œå±‚å æ°´å¹³å€¼å¤§çš„é‚£ä¸€ä¸ªè¦†ç›–å°çš„é‚£ä¸€ä¸ªã€‚ åæ¥å±…ä¸Šï¼šå½“å…ƒç´ çš„å±‚å æ°´å¹³ä¸€è‡´ã€å±‚å é¡ºåºç›¸åŒçš„æ—¶å€™ï¼Œåœ¨ DOM æµä¸­å¤„äºåé¢çš„å…ƒç´ ä¼šè¦†ç›–å‰é¢çš„å…ƒç´ ã€‚ å¦‚ä½•æ¯”è¾ƒ ç»™å®šä»»æ„ä¸¤ä¸ªå…ƒç´ ï¼Œå…¶æ˜¾ç¤ºåŒºåŸŸä¼šå‘ç”Ÿé‡å ï¼Œå¦‚ä½•ç¡®å®šè¦†ç›–å…³ç³» å¦‚æœä¸¤ä¸ªå…ƒç´ å¤„äºç›¸åŒçš„å±‚å ä¸Šä¸‹æ–‡ä¸­ï¼Œå¯ç›´æ¥å‚ç…§stacking orderå›¾ä¸­çš„å±‚å é¡ºåºç¡®å®šè¦†ç›–å…³ç³» è‹¥å¤„äºä¸åŒçš„å±‚å ä¸Šä¸‹æ–‡ä¸­ï¼Œåˆ™éœ€è¦æ ¹æ® DOM æ ‘ä¾æ¬¡å‘ä¸Šæ‰¾åˆ°çˆ¶å…ƒç´ ï¼Œæ¯”è¾ƒçˆ¶å…ƒç´ çš„å±‚å é¡ºåºï¼Œå½“æœ‰å…±åŒçš„å±‚å ä¸Šä¸‹æ–‡æ—¶ï¼Œç„¶åæŒ‰ç…§stacking orderä¸­çš„å±‚å é¡ºåºç¡®å®šè¦†ç›–å…³ç³» ä¸¾ä¾‹ï¼Œç¡®å®š child1ã€child2 çš„è¦†ç›–å…³ç³» 12345678910111213141516171819202122232425262728293031323334353637383940414243444546&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt; &lt;head&gt; &lt;meta charset="UTF-8" /&gt; &lt;title&gt;Document&lt;/title&gt; &lt;style&gt; #box1 &#123; background: #f00; width: 100px; height: 100px; position: relative; z-index: 1; &#125; #box2 &#123; background: #00f; width: 100px; height: 100px; position: relative; z-index: 1; margin-top: -50px; margin-left: 50px; &#125; p &#123; border: 1px dashed #0f0; color: #fff; &#125; #child1 &#123; position: relative; z-index: 2; &#125; #child2 &#123; position: relative; z-index: 1; background-color: #000; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div id="box1"&gt; &lt;p id="child1"&gt;æµ‹è¯•æ–‡æ¡ˆ æµ‹è¯•æ–‡æ¡ˆæµ‹è¯•æ–‡æ¡ˆæµ‹è¯•æ–‡æ¡ˆæµ‹è¯•æ–‡æ¡ˆ&lt;/p&gt; &lt;/div&gt; &lt;div id="box2"&gt; &lt;p id="child2"&gt;2222222&lt;/p&gt; &lt;/div&gt; &lt;/body&gt;&lt;/html&gt; å•çœ‹ chid1ã€child2ï¼Œå‰è€… z-index ä¸º 2ï¼Œåè€…ä¸º 1ï¼Œåº”è¯¥å‰è€…è¦†ç›–åè€…ï¼Œä½†å…¶å®æ˜¯åè€…è¦†ç›–äº†å‰è€…ï¼› å› ä¸º box1ã€box2 åˆ†åˆ«åˆ›å»ºäº†ä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡ï¼Œæ‰€ä»¥ child1ã€child2 å¤„äºä¸åŒçš„å±‚å ä¸Šä¸‹æ–‡æ— æ³•æ¯”è¾ƒï¼› æ‰€ä»¥å‘ä¸Šæ‰¾åˆ°å…¶çˆ¶å…ƒç´ ï¼Œæ¯”è¾ƒçˆ¶å…ƒç´ çš„å±‚å å…³ç³»ï¼Œbox1ã€box2 éƒ½å¤„äº html åˆ›å»ºçš„å±‚å ä¸Šä¸‹æ–‡ä¸­ï¼Œå¯ä»¥æ¯”è¾ƒï¼› ç”±äºäºŒè€…éƒ½æ˜¯å®šä½è¿‡çš„ç›’å­ï¼Œæ‰€ä»¥ z-index ç”Ÿæ•ˆï¼Œæ ¹æ®å±‚å é¡ºåºå›¾ï¼Œå‘ç°äºŒè€…å¤„äºåŒä¸€ä¸ªå±‚å ä¸Šä¸‹æ–‡ä¸”å±‚å é¡ºåºä¸€æ ·ï¼Œæ‰€ä»¥é€‚ç”¨åæ¥å±…ä¸Šçš„åŸåˆ™ï¼Œåœ¨ DOM æ ‘ä¸­é åçš„ box2 è¦†ç›–åœ¨ box1 ä¹‹ä¸Šï¼Œè¿›è€Œ child2 è¦†ç›–åœ¨ child1 ä¸Š å†çœ‹ï¼Œå¦‚æœå°† box2 çš„ z-index å»æ‰ï¼Œchild1ã€child2 çš„è¦†ç›–å…³ç³»åˆå¦‚ä½• å…ˆçœ‹ç»“è®º æ­¤æ—¶ child1 å¤„äº box1 åˆ›å»ºçš„å±‚å ä¸Šä¸‹æ–‡ä¸­ï¼Œè€Œ child2 ç”±äº box2 å»æ‰äº† z-indexï¼Œbox2 æ²¡æœ‰äº§ç”Ÿå±‚å ä¸Šä¸‹æ–‡ï¼Œæ‰€ä»¥ child2 å¤„äº html åˆ›å»ºçš„æ ¹å±‚å ä¸Šä¸‹æ–‡ä¸­ï¼Œæ­¤æ—¶äºŒè€…ä¸Šä¸‹æ–‡ä¸åŒï¼Œæ— æ³•æ¯”è¾ƒï¼Œå¿…é¡»æ‰¾åˆ°æ‹¥æœ‰ç›¸åŒå±‚å ä¸Šä¸‹æ–‡çš„ç¥–å…ˆå…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼›box1ã€box2ã€child2 éƒ½å¤„äºæ ¹å±‚å ä¸Šä¸‹æ–‡ä¸­ï¼Œä¸‰è€…å¯ä»¥æ¯”è¾ƒï¼Œç”±äºä¸‰è€…éƒ½ä¸ºå®šä½è¿‡çš„ç›’å­ï¼Œç›´æ¥æ¯”è¾ƒ z-indexï¼Œç”±äº child2ã€box1 çš„ z-index ç›¸åŒï¼Œæ‰€ä»¥å¤„äº DOM æ ‘åé¢çš„ child2 è¦†ç›–åœ¨ box1 ä¸Šäº†ï¼Œbox2 æ²¡æœ‰ z-index å±æ€§é»˜è®¤ä¸º auto ,åœ¨åŒä¸€å±‚å ä¸Šä¸‹æ–‡ä¸­ auto å¯å½“åš 0 å¯¹å¾…ï¼Œæ‰€ä»¥ä¸‰è€… z-index é¡ºåºä¸º child2&gt;box1&gt;box2ï¼Œchild2 åœ¨æœ€ä¸Šé¢ï¼Œbox1 åœ¨ä¸­(å› ä¸º child1 å¤„äº box1 çš„å±‚å ä¸Šä¸‹æ–‡ä¸­ï¼Œæ‰€ä»¥ child1 çš„å±‚å é¡ºåºè·Ÿ box1 ä¸€è‡´)ï¼Œbox2 åœ¨æœ€ä¸‹é¢ æ€»ç»“ æ— è®ºéœ€è¦æ¯”è¾ƒçš„ä¸¤ä¸ªå…ƒç´ å¤„äº DOM æ ‘çš„ä»€ä¹ˆä½ç½®ï¼Œåªè¦å‘ä¸Šæ‰¾åˆ°åˆ°å…±åŒçš„å±‚å ä¸Šä¸‹æ–‡(ä¸€å®šèƒ½æ‰¾åˆ°ï¼Œå› ä¸ºæœ€ç»ˆéƒ½æœ‰ä¸€ä¸ªå…±åŒçš„å±‚å ä¸Šä¸‹æ–‡-æ ¹å±‚å ä¸Šä¸‹æ–‡)ï¼Œç„¶åæ ¹æ®å±‚å é¡ºåºå›¾å°±å¯ä»¥å¾—å‡ºè¦†ç›–å…³ç³» å·¥å…· æ‰‹åŠ¨å¯»æ‰¾å±‚å ä¸Šä¸‹æ–‡æ¯”è¾ƒéº»çƒ¦ï¼Œå¯ä»¥å€ŸåŠ©z-contextå·¥å…·æ¥å¿«é€Ÿæ‰¾åˆ°å±‚å ä¸Šä¸‹æ–‡ chrome æ’ä»¶z-contextï¼Œå¯ä»¥è½»æ¾æŸ¥çœ‹å…ƒç´ æ˜¯å¦ç”Ÿæˆäº†å±‚å ä¸Šä¸‹æ–‡ã€ç”ŸæˆåŸå› ã€çˆ¶å±‚å ä¸Šä¸‹æ–‡æ˜¯å“ªä¸ªå…ƒç´ åˆ›å»ºçš„ å‚è€ƒ https://www.zhangxinxu.com/wordpress/2016/01/understand-css-stacking-context-order-z-index/ https://juejin.im/post/5b876f86518825431079ddd6 http://book.mixu.net/css/3-additional.html https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Understanding_z_index/The_stacking_context https://developer.mozilla.org/zh-CN/docs/Web/CSS/z-index]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>z-index</tag>
        <tag>stacking context</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[line-height]]></title>
    <url>%2F2020%2F03%2F05%2Fline-height%2F</url>
    <content type="text"><![CDATA[line-heightè‹±æ–‡å­—ä½“å››çº¿ åŸºçº¿:åˆ›å»ºå­—ä½“çš„åŸºå‡†ä¹‹çº¿,æ˜¯å°å†™å­—æ¯ x çš„ä¸‹è¾¹ç¼˜; ä¸­çº¿:å°å†™å­—æ¯ x çš„ä¸Šè¾¹ç¼˜ï¼› é¡¶çº¿:æ–‡å­—çš„æœ€ä¸Šè¾¹ç¼˜ åº•çº¿:æ–‡å­—çš„æœ€ä¸‹è¾¹ç¼˜ ç»¼åˆ 1 å’Œ 2 å¯å‘ç°å°å†™ x å¯¹äºè‹±æ–‡å­—æ¯çš„è®¾è®¡éå¸¸é‡è¦ï¼Œæ‰€ä»¥è®¾è®¡å­—ä½“ä¸€èˆ¬ä¼šå…ˆè®¾è®¡å‡º xï¼Œå†è®¾è®¡å…¶ä»–æ–‡å­— content areaæ¯ä¸€ä¸ªæ–‡å­—éƒ½æœ‰ä¸€ä¸ªâ€å†…å®¹åŒºåŸŸ content areaâ€çš„çŸ©å½¢ç›’å­å°†æ–‡å­—åŒ…è£¹åœ¨å…¶ä¸­;â€œå†…å®¹åŒºåŸŸâ€çš„é«˜åº¦å°±æ˜¯ font-size; ç›’å­ æ¯ä¸€è¡Œæ–‡å­—éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªè¡Œæ¡†(line boxes); æ¯ä¸ªè¡Œæ¡†(line boxes)ä¸­åˆåŒ…å«ä¸€ä¸ªä¸ªçš„è¡Œå†…æ¡†(inline boxes);è¡Œå†…æ¡†(inline boxes)åˆæœ‰æ˜¾æ€§è¡Œå†…æ¡†å’ŒåŒ¿åè¡Œå†…æ¡†ä¹‹åˆ†ï¼Œæ˜¾æ€§è¡Œå†…æ¡†ä¸€èˆ¬ç”±æ˜¾æ€§çš„è¡Œå†…æ ‡ç­¾ spanã€em ç­‰åŒ…è£¹ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡å­—åäº§ç”Ÿï¼Œæ²¡æœ‰è¡Œå†…æ ‡ç­¾åŒ…è£¹çš„ä¸€ä¸ªæˆ–å¤šä¸ªæ–‡å­—ä¸€èˆ¬ä¼šäº§ç”ŸåŒ¿åè¡Œå†…æ¡† åœ¨æ²¡æœ‰å…¶ä»–å› ç´ ï¼ˆpaddingï¼‰å½±å“çš„æ—¶å€™ï¼Œè¡Œå†…æ¡†(inline boxes)é«˜åº¦ç­‰äºå†…å®¹åŒºåŸŸ(content area)é«˜åº¦ é«˜åº¦ è¡Œé«˜(line-height):æ–‡æœ¬çš„é«˜åº¦å³è¡Œå†…æ¡†(inline box)çš„é«˜åº¦,ä¸æ˜¯ line box çš„é«˜åº¦,å› ä¸ºæ¯ä¸ªå•ç‹¬çš„ inline å…ƒç´ éƒ½å¯ä»¥è®¾ç½® line-height è¡Œ(é—´)è·:æ¯è¡Œæ–‡æœ¬çš„é—´è·;ä¸€èˆ¬ä¸ºæ–‡å­—â€åº•çº¿â€åˆ°ä¸‹ä¸€è¡Œæ–‡å­—çš„â€é¡¶çº¿â€ä¹‹é—´çš„å‚ç›´è·ç¦»æˆ–è€…ä¸ºâ€é¡¶çº¿â€åˆ°ä¸Šä¸€è¡Œâ€åº•çº¿â€é—´çš„å‚ç›´è·ç¦»ï¼›è¡Œè·=è¡Œé«˜-æ–‡å­—å†…å®¹åŒºåŸŸçš„é«˜åº¦(ä¸€èˆ¬ä¸ºå­—ä½“å¤§å°);è¡Œè·=line-height - font-size åŠè¡Œ(é—´)è·:ä¸€èˆ¬ä¸ºæ–‡å­—â€é¡¶çº¿â€åˆ°è¡Œæ¡†(line boxes) çš„æœ€ä¸Šéƒ¨æˆ–â€åº•çº¿â€åˆ°è¡Œæ¡†çš„æœ€ä¸‹éƒ¨;å¤§å°ä¸ºè¡Œè·çš„ä¸€åŠ,åŠè¡Œ(é—´)è· =è¡Œè·/2=(line-height - font-size )/2;ä¼šæ·»åŠ åˆ°å†…å®¹åŒºåŸŸ(content area)çš„ä¸Šä¸‹éƒ¨ï¼› è¡Œæ¡†(line boxes)ç‰¹æ€§ è¡Œæ¡†æ€»æ˜¯ä»¥æ–‡å­—çš„æ°´å¹³ä¸­çº¿è¿›è¡Œä¸Šä¸‹å¯¹ç§°åˆ†å¸ƒçš„(åˆ©ç”¨æ­¤ç‰¹æ€§å¯å®ç°æ–‡æœ¬çš„å‚ç›´å±…ä¸­) è¡Œæ¡†é«˜åº¦æ˜¯ç”±å†…éƒ¨è¡Œé«˜æœ€å¤§çš„ inline box å†³å®šçš„ ã€çœ‹ test1 çš„ç»“æœï¼Œæ­¤æ—¶ line boxes çš„é«˜åº¦ä¸º 0ï¼Œä½†æ˜¯å®ƒæ˜¯ä»¥æ–‡å­—çš„æ°´å¹³ä¸­å‚çº¿å¯¹ç§°åˆ†å¸ƒçš„ã€‚è¿™ä¸€é‡è¦çš„ç‰¹æ€§å¯ä»¥ç”¨æ¥å®ç°æ–‡å­—æˆ–å›¾ç‰‡çš„å‚ç›´å±…ä¸­å¯¹é½ã€‚(é€šè¿‡ test1 ä¹Ÿè¯´æ˜ line-height å¯ä»¥å°äº font-size) è¡Œé«˜(line-height)çš„å–å€¼ç‰¹ç‚¹body è®¾ç½® line-height:120%ã€120pxã€1.2 åŒºåˆ«(å‡è®¾ font-size ä¸º 16px) ç™¾åˆ†æ¯” ï¼šbody çš„è¡Œé«˜é€šè¿‡è®¡ç®—å¾—å‡ºåº”è¯¥æ˜¯ 16x120%=19.2px;å­å…ƒç´ ä¼šç»§æ‰¿ body è®¡ç®—åçš„ line-height æ•°å€¼,è€Œä¸æ˜¯ç›´æ¥ç»§æ‰¿å£°æ˜å€¼(120%)å†å’Œè‡ªèº« font-size åšè®¡ç®—å¾—å‡ºè‡ªå·±çš„ line-height é•¿åº¦å€¼:body è‡ªèº«çš„ line-height ä¸º 120px,å­å…ƒç´ ä¹Ÿä¼šç»§æ‰¿è¿™ä¸ªå€¼ 120px å€¼(ç¼©æ”¾å› å­):body æœ¬èº«è®¡ç®—åä¸º 16x1.2=19.2;å­å…ƒç´ ä¸ä¼šç»§æ‰¿è®¡ç®—åçš„å€¼ï¼Œè€Œæ˜¯ç»§æ‰¿è¿™ä¸ªå£°æ˜å€¼ 1.2,ç„¶åå†å’Œè‡ªèº«çš„ font-size åšè®¡ç®—ï¼Œå¾—å‡ºè‡ªèº«çš„ line-height.æ‰€ä»¥æ­¤æ–¹æ³•æ¯”è¾ƒå¥½. å‚è€ƒ https://www.cnblogs.com/fengzheng126/archive/2012/05/18/2507632.html https://www.zhangxinxu.com/wordpress/2009/11/css%e8%a1%8c%e9%ab%98line-height%e7%9a%84%e4%b8%80%e4%ba%9b%e6%b7%b1%e5%85%a5%e7%90%86%e8%a7%a3%e5%8f%8a%e5%ba%94%e7%94%a8/]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>line-height</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[bfc]]></title>
    <url>%2F2020%2F03%2F05%2Fbfc%2F</url>
    <content type="text"><![CDATA[BFCå®šä½æ–¹æ¡ˆ(positioning scheme)å¸ƒå±€çš„æ ¸å¿ƒ html ä¸­çš„å…ƒç´ æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„ç›’å­ å¸ƒå±€çš„æ ¸å¿ƒæ˜¯å¦‚ä½•å°†ä¸€ç³»åˆ—å°†ç›’å­æ”¾åœ¨x-y-zåæ ‡ç³»çš„åˆé€‚ä½ç½®ä¸Š xã€yçš„åæ ‡å…¶å®æ˜¯ç”±å®šä½æ–¹æ¡ˆ(positioning scheme)æ¥å†³å®šçš„ï¼› å®šä½æ–¹æ¡ˆæ˜¯ä»€ä¹ˆ å®šä½æ–¹æ¡ˆæ˜¯ css å¸ƒå±€çš„ä¸€ä¸ªæœ€é«˜å±‚æŠ½è±¡ï¼Œç¡®å®šäº†å®šä½æ–¹æ¡ˆåï¼Œå…¶å¯ä»¥è¿›ä¸€æ­¥è¢«ä¸€äº›ç‰¹æ®Šçš„å¸ƒå±€æ¨¡å¼(layout modes)ä¿®æ”¹ï¼Œä¾‹å¦‚display:tableï¼Œdisplay:inline-tableï¼› å“ªæ€•æœ€æ–°çš„å¸ƒå±€æ¨¡å¼flexboxã€gridéƒ½å±äºæŸä¸€å®šä½æ–¹æ¡ˆ(normal flow)ä¸­ å®šä½æ–¹æ¡ˆçš„åˆ†ç±» css2.1 ä¸­ç¡®å®šäº†ä¸‰ç§å®šä½æ–¹æ¡ˆ normal flow å¸¸è¯´çš„æ–‡æ¡£æµæˆ–æ™®é€šæµå®šä½ æŒ‰ç…§æ¬¡åºä¾æ¬¡å®šä½æ¯ä¸ªç›’å­ å…¶åŒ…å«äº†ä»¥ä¸‹æ ¼å¼åŒ–ä¸Šä¸‹æ–‡(formatting context) block formatting contexts inline formatting contexts relative formatting contexts flex formatting contexts css3 æ–°å¢ grid formatting contexts css3 æ–°å¢ floats æµ®åŠ¨å®šä½ å°†ç›’å­ä»æ™®é€šæµä¸­å•ç‹¬æ‹å‡ºæ¥ï¼Œå°†å…¶æ”¾åˆ°å¤–å±‚ç›’å­çš„æŸä¸€è¾¹ å…¶ä¸normal flowäº’åŠ¨ï¼Œå¾ˆå¤šç½‘æ ¼æ¡†æ¶éƒ½ä½¿ç”¨äº†å®ƒ absolute positioning ç»å¯¹å®šä½ æŒ‰ç…§ç»å¯¹ä½ç½®æ¥å®šä½ç›’å­ï¼Œå…¶ä½ç½®æ ¹æ®ç›’å­çš„åŒ…å«å…ƒç´ æ‰€å»ºç«‹çš„ç»å¯¹åæ ‡ç³»æ¥è®¡ç®—ï¼Œå› æ­¤ç»å¯¹å®šä½å…ƒç´ æœ‰å¯èƒ½ä¼šè¦†ç›–å…¶ä»–å…ƒç´  ä¸»è¦ç”¨æ¥å¤„ç†absoluteå’Œfixedå…ƒç´ ç›¸å¯¹äºnormal flowçš„å®šä½ æ‰€æœ‰çš„å…ƒç´ é™¤éé€šè¿‡è®¾ç½®floatå’Œpositionå±æ€§ä»normal flowä¸­ç§»é™¤ï¼Œé»˜è®¤éƒ½å±äºnormal flowã€‚ å¸ƒå±€éœ€è¦å…³å¿ƒçš„ç‚¹ å…¶å®å¸ƒå±€éœ€è¦å…³å¿ƒä¸¤ä¸ªç‚¹ å…ƒç´ ç›’å­çš„å°ºå¯¸å’Œå¯¹é½æ–¹å¼ï¼› è¿™ä¸€èˆ¬ç”±displayã€widthã€heightã€marginç­‰æ¥æ§åˆ¶ ç‰¹å®šçˆ¶å…ƒç´ ä¸­çš„å­å…ƒç´ (ç›´æ¥å­å…ƒç´ )é—´å¦‚ä½•ç›¸å¯¹å½¼æ­¤æ”¾ç½® è¿™ä¸€èˆ¬ç”±formatting contextæ¥æ§åˆ¶ æ ¼å¼åŒ–ä¸Šä¸‹æ–‡(formatting context)å®šä¹‰ å®ƒæ˜¯ä¸€ç§æ¸²æŸ“è§„åˆ™ï¼Œå†³å®šäº†å…¶å­å…ƒç´ å°†å¦‚ä½•å®šä½ï¼Œä»¥åŠå’Œå…¶ä»–å…ƒç´ çš„å…³ç³»å’Œç›¸äº’ä½œç”¨ é€šä¿—ç†è§£æ˜¯å®ƒæ˜¯ä¸€ç§è§„åˆ™ï¼Œç”¨æ¥ç¡®å®šé¡µé¢å¦‚ä½•å¸ƒå±€(æ’ç‰ˆ) ä½œç”¨ æ§åˆ¶ç‰¹å®šçˆ¶å…ƒç´ ä¸­çš„å­å…ƒç´ (ç›´æ¥å­å…ƒç´ )é—´å¦‚ä½•ç›¸å¯¹å½¼æ­¤æ”¾ç½® åˆ›å»ºè€… çˆ¶å…ƒç´  ä¸€ä¸ªçˆ¶å…ƒç´ çš„å­å…ƒç´ çš„ç›¸å¯¹ä½ç½®æ˜¯é€šè¿‡çˆ¶å…ƒç´ ä¸ºå­å…ƒç´ å»ºç«‹çš„formatting contextæ§åˆ¶çš„ ä½œç”¨å¯¹è±¡ åˆ›å»ºè€…çš„ç›´æ¥å­å…ƒç´  å¸¸è§ fc block formatting contexts inline formatting contexts relative formatting contexts flex formatting contexts css3 æ–°å¢ grid formatting contexts css3 æ–°å¢ BFCè§„åˆ™å®šä¹‰ å…¶æ˜¯ä¸€ä¸ªç‹¬ç«‹åŒºåŸŸï¼Œå†…éƒ¨çš„å…ƒç´ ä¸ä¼šå½±å“åˆ°BFCå¤–éƒ¨ BFC å°±æ˜¯é¡µé¢ä¸Šçš„ä¸€ä¸ªéš”ç¦»çš„ç‹¬ç«‹å®¹å™¨ï¼Œå®¹å™¨é‡Œé¢çš„å­å…ƒç´ ä¸ä¼šå½±å“åˆ°å¤–é¢çš„å…ƒç´ ï¼Œåä¹‹äº¦ç„¶ å¤„äºåŒä¸€ä¸ªBFCçš„ç›´æ¥å­ç›’å­å°†ä¾æ¬¡è‡ªé¡¶å‘ä¸‹å‚ç›´æ’åˆ— ä¸¤ä¸ªç›¸é‚»çš„ç›’å­ä¹‹é—´çš„è·ç¦»ç”±ç”±marginå±æ€§ç¡®å®š ç›¸é‚»block-levelç›’å­çš„å‚ç›´çš„marginå¯èƒ½å‘ç”Ÿé‡å margin collapsing(å¤–è¾¹è·é‡å ã€è¾¹ç•ŒæŠ˜å )https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Box_Model/Mastering_margin_collapsing å¤–è¾¹è·æŠ˜å åªä¼šå‘ç”Ÿåœ¨å±äºåŒä¸€ BFC çš„å—çº§å…ƒç´ ä¹‹é—´ã€‚ æ¯ä¸ªç›’å­çš„å·¦å¤–è¾¹ç¼˜è§¦ç¢°åˆ°containing blockçš„å·¦è¾¹ç¼˜ï¼Œrtlæ—¶å³è¾¹ç¼˜ä¼šç›¸è§¦ BFCå°†åŒ…å«åˆ›å»ºå®ƒçš„å…ƒç´ (ä¸€èˆ¬ä¸ºçˆ¶ç›’å­)å†…éƒ¨çš„æ‰€æœ‰å†…å®¹ åˆ›å»º bfc å…ƒç´ çš„é«˜åº¦å°†ä¼šè®¡ç®—å†…éƒ¨æ‰€æœ‰å†…å®¹ï¼ŒåŒ…æ‹¬å†…éƒ¨æµ®åŠ¨çš„å…ƒç´  æµ®åŠ¨å®šä½å’Œæ¸…é™¤æµ®åŠ¨æ—¶åªä¼šåº”ç”¨äºåŒä¸€ä¸ª BFC å†…çš„å…ƒç´  æµ®åŠ¨ä¸ä¼šå½±å“å…¶å®ƒ BFC ä¸­å…ƒç´ çš„å¸ƒå±€ï¼Œè€Œæ¸…é™¤æµ®åŠ¨åªèƒ½æ¸…é™¤åŒä¸€ BFC ä¸­åœ¨å®ƒå‰é¢çš„å…ƒç´ çš„æµ®åŠ¨ã€‚ åˆ›å»º BFC ä¸‹åˆ—æ–¹å¼å°†ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ BFC æ ¹å…ƒç´ () html è‡ªå¸¦ BFCï¼Œæ‰€ä»¥ html å†…éƒ¨ç›’å­é»˜è®¤éƒ½æ˜¯å‚ç›´æ’åˆ—çš„ æµ®åŠ¨å…ƒç´ ï¼ˆå…ƒç´ çš„ float ä¸æ˜¯ noneï¼‰ ç»å¯¹å®šä½å…ƒç´ ï¼ˆå…ƒç´ çš„ position ä¸º absolute æˆ– fixedï¼‰ è¡Œå†…å—å…ƒç´ ï¼ˆå…ƒç´ çš„ display ä¸º inline-blockï¼‰ è¡¨æ ¼å•å…ƒæ ¼ï¼ˆå…ƒç´ çš„ display ä¸º table-cellï¼ŒHTML è¡¨æ ¼å•å…ƒæ ¼é»˜è®¤ä¸ºè¯¥å€¼ï¼‰ è¡¨æ ¼æ ‡é¢˜ï¼ˆå…ƒç´ çš„ display ä¸º table-captionï¼ŒHTML è¡¨æ ¼æ ‡é¢˜é»˜è®¤ä¸ºè¯¥å€¼ï¼‰ åŒ¿åè¡¨æ ¼å•å…ƒæ ¼å…ƒç´ ï¼ˆå…ƒç´ çš„ display ä¸º tableã€table-rowã€ table-row-groupã€table-header-groupã€table-footer-groupï¼ˆåˆ†åˆ«æ˜¯ HTML tableã€rowã€tbodyã€theadã€tfoot çš„é»˜è®¤å±æ€§ï¼‰æˆ– inline-tableï¼‰ overflow å€¼ä¸ä¸º visible çš„å—å…ƒç´  display å€¼ä¸º flow-root çš„å…ƒç´  contain å€¼ä¸º layoutã€content æˆ– paint çš„å…ƒç´  å¼¹æ€§å…ƒç´ ï¼ˆdisplay ä¸º flex æˆ– inline-flex å…ƒç´ çš„ç›´æ¥å­å…ƒç´ ï¼‰ ç½‘æ ¼å…ƒç´ ï¼ˆdisplay ä¸º grid æˆ– inline-grid å…ƒç´ çš„ç›´æ¥å­å…ƒç´ ï¼‰ å¤šåˆ—å®¹å™¨ï¼ˆå…ƒç´ çš„ column-count æˆ– column-width ä¸ä¸º autoï¼ŒåŒ…æ‹¬ column-count ä¸º 1ï¼‰ column-span ä¸º all çš„å…ƒç´ å§‹ç»ˆä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ BFCï¼Œå³ä½¿è¯¥å…ƒç´ æ²¡æœ‰åŒ…è£¹åœ¨ä¸€ä¸ªå¤šåˆ—å®¹å™¨ä¸­ï¼ˆæ ‡å‡†å˜æ›´ï¼ŒChrome bugï¼‰ã€‚ BFC çš„åº”ç”¨è®©æµ®åŠ¨å†…å®¹å’Œå‘¨å›´çš„å†…å®¹ç­‰é«˜(ç±»ä¼¼ clear æ¸…é™¤æµ®åŠ¨æ•ˆæœ) ä¸€èˆ¬ä¼šä½¿ç”¨æ¸…é™¤æµ®åŠ¨ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥åˆ©ç”¨ bfc ç‰¹æ€§æ¥å®ç° åŸç†ï¼šåˆ›å»º BFC çš„å…ƒç´ å°†åŒ…å«å…¶å†…éƒ¨æ‰€æœ‰å†…å®¹ 1234567891011121314151617181920&lt;style&gt; .box &#123; background-color: rgb(224, 206, 247); border: 5px solid rebeccapurple; &#125; .float &#123; float: left; width: 200px; height: 150px; background-color: white; border: 1px solid black; padding: 10px; &#125;&lt;/style&gt;&lt;div class="box"&gt; &lt;div class="float"&gt;I am a floated box!&lt;/div&gt; &lt;p&gt;I am content inside the container.&lt;/p&gt;&lt;/div&gt; å¯ç»™.boxå…ƒç´ æ·»åŠ overflow:auto;æ¥åˆ›å»ºä¸€ä¸ªbfcï¼Œè¿›è€Œåˆ©ç”¨åˆ›å»ºbfcçš„å…ƒç´ å¿…é¡»åŒ…å«å…¶å†…éƒ¨æ‰€æœ‰å…ƒç´ ç‰¹æ€§ é¿å…å¤–è¾¹è·é‡å  åˆ›å»ºæ–°çš„ BFC é¿å…ä¸¤ä¸ªç›¸é‚» ä¹‹é—´çš„ å¤–è¾¹è·é‡å  é—®é¢˜ åŸç†ï¼šå¤–è¾¹è·é‡å åªä¼šå‘ç”Ÿåœ¨å±äºåŒä¸€ BFC çš„å—çº§å…ƒç´ ä¹‹é—´ï¼Œé€šè¿‡åˆ›å»ºæ–°çš„ BFC æ¥é¿å…é‡å  12345678910111213141516171819202122&lt;style&gt; .blue, .red-inner &#123; height: 50px; margin: 10px 0; &#125; .blue &#123; background: blue; &#125; .red-outer &#123; overflow: hidden; /* åˆ›å»ºbfcï¼Œé¿å…æŠ˜å */ background: red; &#125;&lt;/style&gt;&lt;div class="blue"&gt;&lt;/div&gt;&lt;div class="red-outer"&gt; &lt;div class="red-inner"&gt;red inner&lt;/div&gt;&lt;/div&gt; display:flow-root æ— å‰¯ä½œç”¨åˆ›å»º BFC ä½¿ç”¨display:flow-rootæ— å‰¯ä½œç”¨åˆ›å»º BFC 123456789101112131415161718192021&lt;style&gt; .box &#123; background-color: rgb(224, 206, 247); border: 5px solid rebeccapurple; display: flow-root; /* åˆ›å»ºbfc */ &#125; .float &#123; float: left; width: 200px; height: 150px; background-color: white; border: 1px solid black; padding: 10px; &#125;&lt;/style&gt;&lt;div class="box"&gt; &lt;div class="float"&gt;I am a floated box!&lt;/div&gt; &lt;p&gt;I am content inside the container.&lt;/p&gt;&lt;/div&gt; æ€»ç»“ ç½‘é¡µä¸­æ¯ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªç›’å­ å¸ƒå±€å°±æ˜¯å°†ç›’å­æ”¾åˆ°åˆé€‚çš„ä½ç½®ä¸Š æµè§ˆå™¨å‡†å¤‡äº†å‡ ç§å¤§çš„å®šä½æ–¹æ¡ˆ(normal flowã€floatã€positioning)ç”¨æ¥ç¡®å®šç›’å­å¸ƒå±€çš„å¤§æ–¹æ³• ç¡®å®šäº†å¤§çš„å®šä½æ–¹æ¡ˆåï¼Œå°±éœ€è¦è€ƒè™‘å¦‚ä½•å°†ç›’å­æ”¾åˆ°å‡†ç¡®çš„ä½ç½®ä¸Š æ”¾åˆ°å‡†ç¡®çš„ä½ç½®ä¸Šéœ€è¦è€ƒè™‘ä¸¤ç‚¹ 1.ç›’å­è‡ªèº«çš„å°ºå¯¸ï¼Œè¿™ä¸€èˆ¬ç”±ç›’å­ç±»å‹(display)ã€widthã€height æ¥å†³å®š 2.ç›’å­çš„ä½ç½®(ç›’å­åŒå…¶ä»–ç›’å­çš„å…³ç³»)ï¼Œä¸€èˆ¬ç”± formatting context å†³å®š å¸¸è§ fc æœ‰ bfcã€ifcã€rfcã€ffcã€gfc åœ¨ä¸åŒåœºæ™¯ä¸‹ä¼šåˆ›å»ºä¸åŒçš„ fc æ¥ç¡®å®šå…¶å†…éƒ¨ç›´æ¥å­ç›’å­åŒå…¶ä»–ç›´æ¥å­ç›’å­çš„ä½ç½®å…³ç³» fc ä¸€èˆ¬ç”±çˆ¶å…ƒç´ åˆ›å»ºï¼Œä½œç”¨äºç›´æ¥å­å…ƒç´  æœ€å¸¸è§çš„æ˜¯ bfc bfc æ˜¯ä¸€ä¸ªç‹¬ç«‹å¸ƒå±€åŒºåŸŸï¼Œå…¶å†…å¤–éƒ¨ä¸ä¼šç›¸äº’å½±å“ bfc ä¸­çš„ç›’å­ï¼Œä¼šå‚ç›´æ’åˆ—ï¼Œé—´è·ç”± margin å†³å®š bfc ä¸­å—çº§ç›’å­çš„å‚ç›´è¾¹è·ä¼šå‘ç”Ÿé‡å  å¤–è¾¹è·é‡å åªä¼šå‡ºç°åŒä¸€ä¸ª bfc ä¸­çš„å—çº§ç›’å­ æ‰€ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ bfc èƒ½é¿å…å¤–è¾¹è·é‡å  ä½¿ç”¨ clear æ¸…é™¤æµ®åŠ¨ä¹Ÿåªä¼šä½œç”¨äºåŒä¸€ä¸ª bfc ä¸­çš„å…ƒç´  åˆ›å»º bfc çš„å…ƒç´ çš„ä¼šåŒ…å«å…¶å†…éƒ¨æ‰€æœ‰å…ƒç´ ï¼ŒåŒ…æ‹¬å†…éƒ¨æµ®åŠ¨å…ƒç´  æ‰€ä»¥å¯ä»¥åˆ©ç”¨åˆ›å»º bfcï¼Œæ¥å®ç°ç±»ä¼¼ clear æ¸…é™¤æµ®åŠ¨æ•ˆæœ(ä½¿å†…éƒ¨æœ‰ float ç›’å­çš„å…ƒç´ é«˜åº¦åŒ…å« float ç›’å­) åˆ›å»º bfc æœ‰å¾ˆå¤šæ–¹å¼ï¼Œæ— å‰¯ä½œç”¨çš„æ˜¯ä½¿ç”¨ display:flow-root å‚è€ƒ https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Visual_formatting_model https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Flow_Layout/åœ¨Flowä¸­å’ŒFlowä¹‹å¤– https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Box_Model/Mastering_margin_collapsing https://developer.mozilla.org/zh-CN/docs/Web/Guide/CSS/Block_formatting_context http://book.mixu.net/css/index.html https://zhuanlan.zhihu.com/p/23829153 https://zhuanlan.zhihu.com/p/23856688]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>bfc</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[webpack-test-include-exclude]]></title>
    <url>%2F2020%2F03%2F05%2Fwebpack-test-include-exclude%2F</url>
    <content type="text"><![CDATA[webpack testã€includeã€excludeä»‹ç» webpack module rulesä¸­çš„testã€includeã€excludeéƒ½æ˜¯é’ˆå¯¹å¤„ç†å½“å‰ruleçš„loaderåšèŒƒå›´é™åˆ¶çš„ï¼Œæ¢å¥è¯è¯´æ˜¯åšèŒƒå›´åŒ¹é…çš„ loaderä¼šé’ˆå¯¹ä¾èµ–å›¾ä¸­çš„æ‰€æœ‰moduleè¿è¡ŒåŒ¹é…é€»è¾‘ï¼Œå¦‚æœåŒ¹é…äº†ï¼Œåˆ™ç”¨å½“å‰loaderè¿›è¡Œå¤„ç† ä¸‰è€…å¯å•ç‹¬æŒ‡å®šï¼Œä¹Ÿå¯åŒæ—¶æŒ‡å®š12345678910111213141516// webpack.config.jsmodule.exports=&#123; module:&#123; rules:[ &#123; test:/\.css$/, // testã€includeã€excludeä¸‰è€…å¯å•ç‹¬æŒ‡å®šï¼Œä¹Ÿå¯åŒæ—¶æŒ‡å®š // inculde:path.join(__dirname,'./src') // inculde:path.join(__dirname,'./static') loader:'css-loader' &#125; ] &#125;&#125; ç›¸å…³æºç  ä¸testã€includeã€excludeç›¸å…³çš„åŒ¹é…è§„åˆ™ç”Ÿæˆæºç ï¼Œåœ¨RuleSet.jsä¸­ module.rulesä¸€èˆ¬æˆ‘ä»¬ä¼šä¼ é€’ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥å…¶ä¼šé€æ¡åºåˆ—åŒ–rule(normalizeRule) åœ¨åºåˆ—åŒ–ruleæ—¶ï¼Œä¼šæ£€æŸ¥æ˜¯å¦æ—¢è®¾ç½®äº†testã€includeã€excludeåˆè®¾ç½®äº†resourceå­—æ®µï¼Œwebpackä¼šæŠ¥é”™ï¼Œå› ä¸ºä¸å…è®¸åŒæ—¶è®¾ç½®è¿™ä¸¤ä¸ªå­—æ®µï¼›https://webpack.docschina.org/configuration/module/#rule-include å¦‚æœæœªåŒæ—¶è®¾ç½®ï¼Œåˆ™ä¼šåˆ©ç”¨testã€includeã€excludeç”Ÿæˆä¸€ä¸ªconditionå¯¹è±¡ï¼Œç„¶åä½¿ç”¨normalizeConditionè¿›è¡Œåºåˆ—åŒ–ï¼ŒnormalizeConditionå‡½æ•°æ€»æ˜¯è¿”å›ä¸€ä¸ªæ¡ä»¶å‡½æ•° åœ¨normalizeConditionä¸­ï¼Œä¼šåˆ¤æ–­conditionå¯¹è±¡çš„ç±»å‹ å¦‚æœæ˜¯string,åˆ™è¿”å›ä¸€ä¸ªæ¡ä»¶å‡½æ•°ï¼Œæ­¤æ¡ä»¶å‡½æ•°å†…éƒ¨åˆ©ç”¨indexOfåˆ¤æ–­moduleè·¯å¾„æ˜¯å¦ä»¥conditionå¼€å¤´æ¥åŒ¹é… å¦‚æœæ˜¯functionï¼Œåˆ™å°†ä¼ å…¥çš„functionåšä¸ºæ¡ä»¶å‡½æ•°è¿”å› å¦‚æœä¸ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œåˆ™å¯¹å…¶çš„testæ–¹æ³•å…ˆç»‘å®šä¸Šä¸‹æ–‡ï¼Œç„¶åå°†test æ–¹æ³•åšä¸ºæ¡ä»¶å‡½æ•°è¿”å› å¦‚æœæ˜¯objectï¼Œåˆ™éå†conditionå¯¹è±¡çš„keysï¼Œè°ƒç”¨normalizeConditionç”Ÿæˆæ¡ä»¶å‡½æ•° å¦‚æœå‘ç°conditionå¯¹è±¡çš„keyæ˜¯orã€includeã€testï¼Œåˆ™ç›´æ¥ç”Ÿæˆä¸€ä¸ªæ¡ä»¶å‡½æ•°å¹¶pushåˆ°é¢„å…ˆå®šä¹‰å¥½çš„matchersæ•°ç»„ä¸­ å¦‚æœkeyæ˜¯andï¼Œåˆ™éå†keyå¯¹åº”çš„valueæ•°ç»„ï¼Œç”Ÿæˆä¸€ä¸ªç”±æ¡ä»¶å‡½æ•°ç»„æˆçš„æ•°ç»„itemsï¼Œå¹¶å°†itemsä¼ å…¥andMatcherå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªç»è¿‡andMatcheråŒ…è£…çš„æ¡ä»¶å‡½æ•°å¹¶å°†å…¶pushåˆ°matchersä¸­ï¼› ç»è¿‡andMathceråŒ…è£…åçš„æ¡ä»¶å‡½æ•°ï¼Œåœ¨æ‰§è¡Œæ—¶ï¼Œè¦æ±‚å…¥å‚å¿…é¡»è®©itemsä¸­çš„æ‰€æœ‰æ¡ä»¶å‡½æ•°éƒ½è¿”å›trueæ‰é€šè¿‡(ä¸”çš„å…³ç³»)ï¼›ç›¸å½“äºæ‰€æœ‰æ¡ä»¶å‡½æ•°çš„è¿”å›å€¼ä½¿ç”¨&amp;&amp;è¿æ¥äº† å¦‚æœkeyæ˜¯notã€excludeï¼Œåˆ™ç”Ÿæˆä¸€ä¸ªæ¡ä»¶å‡½æ•°ï¼Œä¼ å…¥notMatcherä¸­ï¼Œè¿›è€Œè¿”å›ä¸€ä¸ªè¢«notMathceråŒ…è£…åçš„æ¡ä»¶å‡½æ•°ï¼Œå†å°†åŒ…è£…åçš„æ¡ä»¶å‡½æ•°`pushåˆ°matchers`ä¸­ ç»è¿‡notMathceråŒ…è£…åçš„æ¡ä»¶å‡½æ•°ï¼Œåœ¨æ‰§è¡Œæ—¶ï¼Œè¦æ±‚å…¥å‚å¿…é¡»è®©æ¡ä»¶å‡½æ•°è¿”å›false æ‰é€šè¿‡(éçš„å…³ç³»)ï¼› ç»è¿‡ä¸Šé¢é€»è¾‘åï¼Œmathersæ•°ç»„å°†åŒ…å«æ‰€æœ‰çš„æ¡ä»¶å‡½æ•°ï¼Œæœ€åä½¿ç”¨andMatcherå‡½æ•°ï¼Œå°†matchersä¸­ä¿å­˜çš„æ¡ä»¶å‡½æ•°ä½¿ç”¨&amp;&amp;è¿æ¥èµ·æ¥123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137// RuleSet.js"use strict";module.exports = class RuleSet &#123; // ... // åºåˆ—åŒ–rules static normalizeRules(rules, refs, ident) &#123; // æ•°ç»„ï¼Œé€æ¡åºåˆ—åŒ– if (Array.isArray(rules)) &#123; return rules.map((rule, idx) =&gt; &#123; return RuleSet.normalizeRule(rule, refs, `$&#123;ident&#125;-$&#123;idx&#125;`); &#125;); &#125; else if (rules) &#123; return [RuleSet.normalizeRule(rules, refs, ident)]; &#125; else &#123; return []; &#125; &#125; // åºåˆ—åŒ–rule static normalizeRule(rule, refs, ident) &#123; // ... const newRule = &#123;&#125;; let useSource; let resourceSource; let condition; // ä¼ é€’äº†testæˆ–includeæˆ–exclude if (rule.test || rule.include || rule.exclude) &#123; // testã€includeã€excludeå’ŒRule.resourceæ˜¯äº’æ–¥çš„ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦æ£€æŸ¥ï¼Œå¦‚æœå‘ç°éƒ½è®¾ç½®äº†ï¼Œåˆ™æŠ¥é”™æç¤º checkResourceSource("test + include + exclude"); condition = &#123; test: rule.test, include: rule.include, exclude: rule.exclude &#125;; try &#123; // åºåˆ—åŒ–condition newRule.resource = RuleSet.normalizeCondition(condition); &#125; catch (error) &#123; throw new Error(RuleSet.buildErrorMessage(condition, error)); &#125; &#125; // ... return newRule; &#125; // åºåˆ—åŒ–conditionï¼Œæ€»æ˜¯è¿”å›ä¸€ä¸ªæ¡ä»¶å‡½æ•° static normalizeCondition(condition) &#123; if (!condition) throw new Error("Expected condition but got falsy value"); // å¦‚æœé…ç½®æ•°æ®ç±»å‹ä¸º stringï¼Œé‚£ä¹ˆç›´æ¥ä½¿ç”¨ indexOf ä½œä¸ºè·¯å¾„åŒ¹é…è§„åˆ™ if (typeof condition === "string") &#123; return str =&gt; str.indexOf(condition) === 0; &#125; // å¦‚æœä¸º function å‡½æ•°ï¼Œé‚£ä¹ˆä½¿ç”¨è¿™ä¸ªå¼€å‘è€…è‡ªå·±å®šä¹‰çš„ function ä½œä¸ºè·¯å¾„åŒ¹é…è§„åˆ™ if (typeof condition === "function") &#123; return condition; &#125; // å¦‚æœä¸ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œåˆ™ç»‘å®šä¸Šä¸‹æ–‡åï¼Œä½¿ç”¨æ­£åˆ™æ¥åŒ¹é… if (condition instanceof RegExp) &#123; return condition.test.bind(condition); &#125; // å¦‚æœconditionæ˜¯æ•°ç»„ï¼Œåˆ™ç”ŸæˆorMatcherï¼ŒorMathceræ˜¯ä¸€ä¸ªé«˜é˜¶å‡½æ•°ï¼Œä¼šè¿”å›ä¸€ä¸ªæ¥æ”¶strçš„å‡½æ•°ï¼›å…¶è¦æ±‚stræ»¡è¶³itemsä¸­çš„ä¸€é¡¹å³å¯(æˆ–çš„å…³ç³») if (Array.isArray(condition)) &#123; const items = condition.map(c =&gt; RuleSet.normalizeCondition(c)); return orMatcher(items); &#125; if (typeof condition !== "object") throw Error( "Unexcepted " + typeof condition + " when condition was expected (" + condition + ")" ); // conditionæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™éå†å¯¹è±¡çš„keys const matchers = []; Object.keys(condition).forEach(key =&gt; &#123; const value = condition[key]; switch (key) &#123; // å¦‚æœkeyæ˜¯orã€includeã€testï¼Œåˆ™æ ¹æ®valueå€¼ç”Ÿæˆä¸€ä¸ªæ¡ä»¶å‡½æ•° case "or": case "include": case "test": if (value) matchers.push(RuleSet.normalizeCondition(value)); break; // å¦‚æœkeyæ˜¯andï¼Œåˆ™éå†valueï¼Œç”Ÿæˆå¤šä¸ªæ¡ä»¶å‡½æ•°ï¼Œå¹¶ç”¨andMatcherè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œæ­¤å‡½æ•°è¦æ±‚ä¼ å…¥çš„strå¿…é¡»æ»¡è¶³itemsä¸­çš„æ‰€æœ‰æ¡ä»¶(ä¸”çš„å…³ç³») case "and": if (value) &#123; const items = value.map(c =&gt; RuleSet.normalizeCondition(c)); matchers.push(andMatcher(items)); &#125; break; // notæˆ–excludeï¼Œåºåˆ—åŒ–valueåï¼Œç”Ÿæˆä¸€ä¸ªnotMatcher case "not": case "exclude": if (value) &#123; const matcher = RuleSet.normalizeCondition(value); matchers.push(notMatcher(matcher)); &#125; break; default: throw new Error("Unexcepted property " + key + " in condition"); &#125; &#125;); if (matchers.length === 0) throw new Error("Excepted condition but got " + condition); if (matchers.length === 1) return matchers[0]; // å°†ä¸Šé¢ç”Ÿæˆå¥½çš„æ¡ä»¶å‡½æ•°æ•°ç»„ï¼Œç”¨ä¸”çš„å…³ç³»è¿æ¥èµ·æ¥ï¼›ç¬¦åˆè¿™æ¡ruleçš„moduleï¼Œå°±ä¼šç”¨å¯¹åº”çš„loaderåšè½¬æ¢ return andMatcher(matchers); &#125;&#125;;function notMatcher(matcher) &#123; return function(str) &#123; return !matcher(str); &#125;;&#125;function orMatcher(items) &#123; return function(str) &#123; for (let i = 0; i &lt; items.length; i++) &#123; if (items[i](str)) return true; &#125; return false; &#125;;&#125;function andMatcher(items) &#123; return function(str) &#123; for (let i = 0; i &lt; items.length; i++) &#123; if (!items[i](str)) return false; &#125; return true; &#125;;&#125; è§£é‡Šå•ç‹¬æŒ‡å®šä¸€ä¸ªå­—æ®µ å•ç‹¬æŒ‡å®štest åªè¦moduleç¬¦åˆtestæŒ‡å®šçš„æ­£åˆ™ï¼Œå°±å¯ä»¥ä½¿ç”¨å¯¹åº”loaderè½¬æ¢ å•ç‹¬æŒ‡å®šinclude åªä¼šé’ˆå¯¹includeä¸­æŒ‡å®šçš„æ¨¡å—ï¼Œä¼šä½¿ç”¨å¯¹åº”loaderè½¬æ¢ï¼Œä¸ç®¡æ˜¯å¦çœŸçš„èƒ½è½¬æ¢ å•ç‹¬æŒ‡å®šexclude ä¼šå¯¹excludeä»¥å¤–çš„æ‰€æœ‰æ¨¡å—ï¼Œä½¿ç”¨å¯¹åº”loaderè½¬æ¢ï¼Œä¸ç®¡æ˜¯å¦çœŸçš„èƒ½è½¬æ¢ æŒ‡å®šä¸¤ä¸ªå­—æ®µ test + include é€šè¿‡æºç æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨normalizeConditionæ—¶ï¼Œé‡åˆ°testã€includeéƒ½æ˜¯æ‹¿å¯¹åº”å­—æ®µçš„valueç›´æ¥ç”Ÿæˆä¸€ä¸ªæ¡ä»¶å‡½æ•°ï¼Œç„¶åpushè¿›matchersä¸­ ä½†è¦æ³¨æ„åœ¨normalizeConditionçš„æœ€åï¼Œä»–ä»¬ä½¿ç”¨andMatcherè¿æ¥äº†ï¼Œæ‰€ä»¥moduleå¿…é¡»åŒæ—¶æ»¡è¶³testå’Œincludeï¼Œæ‰èƒ½è¢«å¯¹åº”loaderè½¬æ¢ æ‰€æœ‰å¯ä»¥è¯´ï¼ŒåŒæ—¶æŒ‡å®štestå’Œincludeï¼ŒäºŒè€…æ˜¯test &amp;&amp; includeçš„å…³ç³» test + exclude å› ä¸ºexcludeè¿”å›çš„æ¡ä»¶å‡½æ•°æ˜¯é€šè¿‡notMatcheråŒ…è£…çš„ï¼Œæ‰€ä»¥è¦æ±‚moduleçš„è·¯å¾„å¿…é¡»ä¸åœ¨excludeæŒ‡å®šèŒƒå›´å†…ï¼Œæ‰èƒ½è¢«å¯¹åº”loaderè½¬æ¢ æ‰€ä»¥åŒæ—¶æŒ‡å®štest + excludeä»–ä»¬çš„å…³ç³»æ˜¯test &amp;&amp; (!exclude) include + exclude å’Œtest + excludeç±»ä¼¼ åŒæ—¶æŒ‡å®šæ—¶çš„å…³ç³»æ˜¯include &amp;&amp; (!exclude) åŒæ—¶æŒ‡å®šä¸‰ä¸ªå­—æ®µ åŒæ—¶æŒ‡å®šä¸‰ä¸ªå­—æ®µï¼Œè·ŸåŒæ—¶æŒ‡å®šä¸¤ä¸ªå­—æ®µæœ‰ä¸€å®šçš„ç›¸åŒï¼›testå’Œincludeæ˜¯&amp;çš„å…³ç³»ï¼Œexcludeæ˜¯! æ‰€ä»¥åŒæ—¶æŒ‡å®šæ—¶ä¸‰è€…å…³ç³»æ˜¯test &amp;&amp; include &amp;&amp; (!exclude) ç»“è®º èµ·åˆï¼Œæˆ‘ä»¥ä¸ºtestã€includeä¹‹é—´æ˜¯æˆ–çš„å…³ç³»å–å¹¶é›†çš„æ“ä½œï¼Œå‘ç°é”™äº†ï¼ŒåŸæ¥ä»–ä»¬å–çš„æ˜¯äº¤é›† testã€includeã€excludeç¡®å®šèŒƒå›´æ—¶çš„å…³ç³»æ˜¯test &amp;&amp; include &amp;&amp; (!exclude) åªè¦æŒ‡å®šäº†excludeï¼Œåˆ™å…¶åŒ¹é…çš„moduleå¿…å°†ä¸ä¼šè¢«å¯¹åº”loaderè½¬æ¢ æœ€ä½³å®è·µ æ ¹æ®å®˜ç½‘ä¸Šçš„æ–‡æ¡£æœ‰ä»¥ä¸‹æœ€ä½³å®è·µ ä½¿ç”¨test + includeï¼Œé¿å…ä½¿ç”¨exclude1234567891011121314 // è¿™é‡Œæ˜¯åŒ¹é…æ¡ä»¶ï¼Œæ¯ä¸ªé€‰é¡¹éƒ½æ¥æ”¶ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æˆ–å­—ç¬¦ä¸²// test å’Œ include å…·æœ‰ç›¸åŒçš„ä½œç”¨ï¼Œéƒ½æ˜¯å¿…é¡»åŒ¹é…é€‰é¡¹// exclude æ˜¯å¿…ä¸åŒ¹é…é€‰é¡¹ï¼ˆä¼˜å…ˆäº test å’Œ includeï¼‰// æœ€ä½³å®è·µï¼š// - åªåœ¨ test å’Œ æ–‡ä»¶ååŒ¹é… ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼// - åœ¨ include å’Œ exclude ä¸­ä½¿ç”¨ç»å¯¹è·¯å¾„æ•°ç»„// - å°½é‡é¿å… excludeï¼Œæ›´å€¾å‘äºä½¿ç”¨ include test: /\.jsx?$/, include: [ path.resolve(__dirname, "app") ], exclude: [ path.resolve(__dirname, "app/demo-files") ], ç›¸å…³é¡¹ç›® webpack-chainæºç åˆ†æ ä½¿ç”¨webpack-chainç¼–å†™webpackçš„å®è·µ ã€Šæ·±å…¥æµ…å‡ºWebpackã€‹å­¦ä¹ demos å‚è€ƒ https://github.com/CommanderXL/Biu-blog/issues/30 https://webpack.docschina.org/configuration/]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>webpack</tag>
        <tag>å·¥ç¨‹åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[webpack-hash-chunkhash-contenthash]]></title>
    <url>%2F2020%2F03%2F05%2Fwebpack-hash-chunkhash-contenthash%2F</url>
    <content type="text"><![CDATA[hashã€chunkhashã€contenthashhash hashæ˜¯è·Ÿé¡¹ç›®æ„å»ºæŒ‚é’©çš„ï¼Œåªè¦é¡¹ç›®ä¸­æ²¡æœ‰æ–‡ä»¶å‘ç”Ÿå˜åŒ–ï¼Œhashå°±ä¸ä¼šæ”¹å˜12345678910111213141516171819202122232425262728293031323334353637383940const path = require('path')const ExtractTextPlugin = require('extract-text-webpack-plugin')const resolve = _path =&gt; path.resolve(__dirname, _path)module.exports = &#123; entry: &#123; main: resolve('./main.js'), other: resolve('./other.js') &#125;, output: &#123; path: resolve('./dist'), filename: '[name].[hash].bundle.js' &#125;, module: &#123; rules: [ &#123; test: /\.css$/, // è°ƒç”¨extractä»å·²æœ‰çš„loaderç”Ÿæˆä¸€ä¸ªæ–°çš„loader use: ExtractTextPlugin.extract(&#123; // è½¬æ¢ .css æ–‡ä»¶éœ€è¦ä½¿ç”¨çš„ Loader use: [ &#123; loader: 'css-loader', options: &#123; url: false &#125; &#125; ] &#125;) &#125; ] &#125;, plugins: [ // å®ä¾‹åŒ–æ’ä»¶ new ExtractTextPlugin(&#123; // ä» .js æ–‡ä»¶ä¸­æå–å‡ºæ¥çš„ .css æ–‡ä»¶çš„åç§° filename: `[name].[hash].css` &#125;) ]&#125; åªè¦é¡¹ç›®ä¸­æ²¡æœ‰æ–‡ä»¶å‘ç”Ÿå˜åŒ–ï¼Œhashå€¼å°±ä¸ä¼šæ”¹å˜ï¼›åä¹‹ï¼Œå½“æœ‰ä»»æ„ä¸€ä¸ªæ–‡ä»¶å‘ç”Ÿæ”¹å˜ï¼Œhashå°±ä¼šå‘ç”Ÿæ”¹å˜ è¿™æ ·ä¼šé€ æˆæ‰€æœ‰æ–‡ä»¶çš„hashéƒ½ä¼šå‘ç”Ÿå˜åŒ– chunkhash è·ŸchunkæŒ‚é’©,åªè¦chunkä¸­çš„moduleæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œchunkhashå°±ä¸ä¼šå˜åŒ– æ¯ä¸ªchunkæœ‰è‡ªå·±ç‹¬ç«‹çš„chunkhashï¼Œå±äºç›¸åŒchunkçš„moduleï¼Œchunkhashä¹Ÿä¸€æ · 12345678910111213141516171819202122232425262728293031323334353637383940const path = require('path')const ExtractTextPlugin = require('extract-text-webpack-plugin')const resolve = _path =&gt; path.resolve(__dirname, _path)module.exports = &#123; entry: &#123; main: resolve('./main.js'), other: resolve('./other.js') &#125;, output: &#123; path: resolve('./dist'), filename: '[name].[chunkhash].bundle.js' // ä¿®æ”¹ä¸ºchunkhash &#125;, module: &#123; rules: [ &#123; test: /\.css$/, // è°ƒç”¨extractä»å·²æœ‰çš„loaderç”Ÿæˆä¸€ä¸ªæ–°çš„loader use: ExtractTextPlugin.extract(&#123; // è½¬æ¢ .css æ–‡ä»¶éœ€è¦ä½¿ç”¨çš„ Loader use: [ &#123; loader: 'css-loader', options: &#123; url: false &#125; &#125; ] &#125;) &#125; ] &#125;, plugins: [ // å®ä¾‹åŒ–æ’ä»¶ new ExtractTextPlugin(&#123; // ä» .js æ–‡ä»¶ä¸­æå–å‡ºæ¥çš„ .css æ–‡ä»¶çš„åç§° filename: `[name].[chunkhash].css` // ä¿®æ”¹ä¸ºchunkhash &#125;) ]&#125; ä¿®æ”¹main.jsä¸­ä»£ç ï¼Œå‘ç°åªæœ‰main chunkç›¸å…³çš„chunkhashå‘ç”Ÿå˜åŒ–äº†ï¼Œother chunkçš„æ²¡æœ‰å‘ç”Ÿå˜åŒ– å½“ä¸€ä¸ª.jsæ–‡ä»¶å¼•ç”¨äº†ä¸€ä¸ª.cssæ–‡ä»¶ï¼Œå½“jsæ–‡ä»¶å˜åŒ–æ—¶ï¼Œcssæ–‡ä»¶çš„chunkhashä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¯¼è‡´ç¼“å­˜å¤±æ•ˆï¼Œè¿™æ—¶éœ€è¦contenthash contenthash12345678910111213141516171819202122232425262728293031323334353637383940const path = require('path')const ExtractTextPlugin = require('extract-text-webpack-plugin')const resolve = _path =&gt; path.resolve(__dirname, _path)module.exports = &#123; entry: &#123; main: resolve('./main.js'), other: resolve('./other.js') &#125;, output: &#123; path: resolve('./dist'), filename: '[name].[chunkhash].bundle.js' // æ­¤å¤„ä»ä¸ºchunkhash &#125;, module: &#123; rules: [ &#123; test: /\.css$/, // è°ƒç”¨extractä»å·²æœ‰çš„loaderç”Ÿæˆä¸€ä¸ªæ–°çš„loader use: ExtractTextPlugin.extract(&#123; // è½¬æ¢ .css æ–‡ä»¶éœ€è¦ä½¿ç”¨çš„ Loader use: [ &#123; loader: 'css-loader', options: &#123; url: false &#125; &#125; ] &#125;) &#125; ] &#125;, plugins: [ // å®ä¾‹åŒ–æ’ä»¶ new ExtractTextPlugin(&#123; // ä» .js æ–‡ä»¶ä¸­æå–å‡ºæ¥çš„ .css æ–‡ä»¶çš„åç§° filename: `[name].[contenthash].css` // ä¿®æ”¹ä¸ºcontenthash &#125;) ]&#125; ä»…ä»…å°†cssçš„chunkhashæ”¹ä¸ºcontenthashï¼› ä¿®æ”¹main.jsä¸ä¼šå¯¼è‡´.cssæ ·å¼çš„contenthashå‘ç”Ÿå˜åŒ– ä¿®æ”¹.cssæ–‡ä»¶ï¼Œä¹Ÿä»…ä»…æ˜¯.cssæ–‡ä»¶çš„contenthashå˜åŒ–ï¼Œä¸ä¼šå½±å“main.jsçš„chunkhash vue-cli 2.0ä¹Ÿæ˜¯ä½¿ç”¨ç›¸åŒç­–ç•¥(chunkä½¿ç”¨chunkhashï¼Œcssæ–‡ä»¶ä½¿ç”¨contenthash) ç›¸å…³é¡¹ç›® webpack-chainæºç åˆ†æ ä½¿ç”¨webpack-chainç¼–å†™webpackçš„å®è·µ ã€Šæ·±å…¥æµ…å‡ºWebpackã€‹å­¦ä¹ demos æ€»ç»“ cssã€jpgã€fontç­‰assetæ–‡ä»¶å¯è€ƒè™‘ä½¿ç”¨contenthash å…¶ä½™æ–‡ä»¶ä½¿ç”¨chunkhash]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>webpack</tag>
        <tag>å·¥ç¨‹åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[webpack-module-chunk-bundle]]></title>
    <url>%2F2020%2F03%2F05%2Fwebpack-module-chunk-bundle%2F</url>
    <content type="text"><![CDATA[moduleã€chunkã€bundlemodule å¯¹äºwebpackæ¥è¯´ï¼Œæ‰€æœ‰çš„èµ„æº(.jsã€.cssã€.png)éƒ½æ˜¯module .jsæ–‡ä»¶webpackåŸç”Ÿå¯ä»¥å¤„ç†ï¼Œå…¶ä»–ç±»å‹æ–‡ä»¶ï¼Œéœ€è¦é€šè¿‡loaderè¿›è¡Œè½¬æ¢ï¼Œç„¶åäº¤ç»™webpackå¤„ç† webpacké…ç½®ä¸­ï¼Œå¯ä»¥é€šè¿‡moduleå­—æ®µï¼Œå¯¹ä¸åŒmoduleä½¿ç”¨ä¸åŒçš„ruleå¤„ç†1234567891011module: &#123;rules: [ &#123; test: /\.css$/, use: [ &#123; loader: "style-loader" &#125;, &#123; loader: "css-loader" &#125; ] &#125;, ... ] &#125;, entry-point ç”Ÿæˆä¾èµ–å›¾(dependency graph)çš„å…¥å£ï¼› webpackåªèƒ½ä»¥.jsæ–‡ä»¶åšä¸ºç”Ÿæˆä¾èµ–å›¾çš„å…¥å£ï¼›parcelèƒ½ä½¿ç”¨å…¶ä»–æ¨¡å—(.html)åšä¸ºå…¥å£ï¼Œç”Ÿæˆä¾èµ–å›¾ chunk æ˜¯webpackå†…éƒ¨å¤„ç†æ—¶çš„æ¦‚å¿µï¼› ä¸€ä¸ªchunkæ˜¯å¯¹ä¾èµ–å›¾çš„éƒ¨åˆ†(å­å›¾)è¿›è¡Œå°è£…çš„ç»“æœChunk the class is the encapsulation for parts of your dependency graph å¯ä»¥è¯´ä¸€ä¸ªchunkæ˜¯ä¸€å †moduleçš„é›†åˆ å¯ä»¥é€šè¿‡å¤šä¸ªentry-pointæ¥ç”Ÿæˆä¸€ä¸ªchunk chunkåˆ†ç±» entry chunk åŒ…å«webpack runtime codeå¹¶ä¸”æ˜¯æœ€å…ˆæ‰§è¡Œçš„chunk initial chunk åŒ…å«åŒæ­¥åŠ è½½è¿›æ¥çš„moduleä¸”ä¸åŒ…å«runtime codeçš„chunk åœ¨entry chunkæ‰§è¡Œåå†æ‰§è¡Œ normal chunk ä½¿ç”¨require.ensureã€System.importã€import()å¼‚æ­¥åŠ è½½è¿›æ¥çš„moduleï¼Œä¼šè¢«æ”¾åˆ°normal chunkä¸­ ä¸€èˆ¬normal chunk(å¼‚æ­¥chunk)ï¼Œä¼šå•ç‹¬ç”Ÿæˆä¸€ä¸ªbundleï¼Œå…¶åç§°ä¸€èˆ¬é€šè¿‡webpackChunkNameé­”æ³•æ³¨é‡Šå’Œoutput.chunkFilenameæ¥æŒ‡å®š åœ¨webpackChunkNameé­”æ³•æ³¨é‡Šä¸­æŒ‡å®šçš„nameå¯ä»¥åœ¨output.chunkFilenameä¸­ä½¿ç”¨[name]å–åˆ° bundle æœ€ç»ˆè¾“å‡ºçš„chunkåœ¨ç”¨æˆ·ç«¯ï¼Œè¢«ç§°ä¹‹ä¸ºbundleï¼› æ­£å¸¸æƒ…å†µä¸‹ï¼Œå¯ä»¥å°†chunkå’Œbundleå½“æˆä¸€ä¸ªæ¦‚å¿µï¼Œåªä¸è¿‡æ˜¯ä¸åŒæ—¶é—´çš„åŒä¸€ä¸ªä¸œè¥¿ chunkå’Œbundleçš„åŒºåˆ«ï¼Œå¯ä»¥ç†è§£ä¸ºchunkæ˜¯è¿‡ç¨‹ä¸­çš„ä»£ç å—(ç»™webpackå¤„ç†çš„)ï¼Œbundleæ˜¯ç»“æœçš„ä»£ç å—(å±•ç°ç»™ç”¨æˆ·çš„) ä¸€èˆ¬ä¸€ä¸ªchunkå¯¹åº”ä¸€ä¸ªbundleï¼Œåªæœ‰åœ¨é…ç½®äº†sourcemapæ—¶ï¼Œæ‰ä¼šå‡ºç°ä¸€ä¸ªchunkå¯¹åº”å¤šä¸ªbundleçš„æƒ…å†µï¼› ä¾‹å­12345678910111213141516// other.jsimport(/*webpackChunkName: "lodash */ 'lodash').then(_ =&gt; &#123; console.log(_)&#125;)// webpack.config.jsentry:&#123; main:['./src/main.js','./src/test.js'], other:['./src.other.js']&#125;,output:&#123; path:path.resolve(__dirname,'./dist'), filename:"[name].bundle.js", // æ­£å¸¸ç”Ÿæˆçš„bundleåç§° chunkFileName:"[name].async.bundle.js" // normalChunkçš„åç§°ï¼Œä¹Ÿå³æœ€ç»ˆç”Ÿæˆçš„å¼‚æ­¥bundleçš„åç§°&#125; main.jsä¸­å¼•å…¥äº†gloabl.cssï¼› other.jsä¸­å¼‚æ­¥å¯¼å…¥äº†lodashå¹¶ä½¿ç”¨äº†webpackChunkNameé­”æ³•æ³¨é‡Š module main.jsã€test.jsã€other.jsã€global.csséƒ½æ˜¯module entry-point main.jsã€test.jsã€other.js chunk main other bundle main.bundle.js other.bundle.js lodash.async.bundle.js entryçš„ä¸¤ä¸ªkeyæŒ‡å®šäº†ä¸¤ä¸ªchunk(bundle)ï¼Œåç§°åˆ†åˆ«ä¸ºmianã€otherï¼Œæœ€ç»ˆä¼šè¾“å‡ºä¸¤ä¸ªbundleï¼› main.jsã€test.jsã€other.jséƒ½æ˜¯entry-point å› ä¸ºæ²¡æœ‰æŠ½å–cssï¼Œæ‰€ä»¥æ²¡å•ç‹¬ç”Ÿæˆä¸€ä¸ªcssæ–‡ä»¶ï¼Œglobal.cssçš„å†…å®¹æ˜¯å†…è”åœ¨main.bundle.jsä¸­çš„ loader webpack loader æ˜¯ webpack ä¸ºäº†å¤„ç†å„ç§ç±»å‹æ–‡ä»¶çš„ä¸€ä¸ªä¸­é—´å±‚ï¼Œwebpack æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª node æ¨¡å—ï¼Œå®ƒä¸èƒ½å¤„ç†js ä»¥å¤–çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆ loader å°±å¸®åŠ©webpack åšäº†ä¸€å±‚è½¬æ¢ï¼Œå°†æ‰€æœ‰æ–‡ä»¶éƒ½è½¬æˆå­—ç¬¦ä¸²ï¼Œä½ å¯ä»¥å¯¹å­—ç¬¦ä¸²è¿›è¡Œä»»æ„æ“ä½œ/ä¿®æ”¹ï¼Œç„¶åè¿”å›ç»™ webpack ä¸€ä¸ªåŒ…å«è¿™ä¸ªå­—ç¬¦ä¸²çš„å¯¹è±¡ï¼Œè®© webpack è¿›è¡Œåé¢çš„å¤„ç†ã€‚å¦‚æœæŠŠ webpack å½“æˆä¸€ä¸ªåƒåœ¾å·¥å‚çš„è¯ï¼Œé‚£ä¹ˆ loader å°±æ˜¯è¿™ä¸ªå·¥å‚çš„åƒåœ¾åˆ†ç±» plugin å¦‚æœæŠŠ webpack å½“æˆä¸€ä¸ªåƒåœ¾å·¥å‚ï¼Œloader å°±æ˜¯åƒåœ¾åˆ†ç±»ï¼Œå°†æ‰€æœ‰åƒåœ¾æ•´ç†å¥½äº¤ç»™ webpackã€‚plugin å°±æ˜¯å¦‚ä½•å»å¤„ç†è¿™äº›åƒåœ¾ã€‚ æ ¸å¿ƒæµç¨‹ webpack å¯åŠ¨åä¼šä» entry-point å¼€å§‹é€’å½’è§£æ entry-point ä¾èµ–çš„æ‰€æœ‰ moduleã€‚ æ¯æ‰¾åˆ°ä¸€ä¸ª moduleï¼Œ å°±ä¼šæ ¹æ®é…ç½®çš„ loader å»æ‰¾å‡ºå¯¹åº”çš„è½¬æ¢è§„åˆ™ï¼Œå¯¹ module è¿›è¡Œè½¬æ¢åï¼Œå†è§£æå‡ºå½“å‰ module ä¾èµ–çš„ moduleã€‚ è¿™äº›æ¨¡å—ä¼šä»¥ entryå­—æ®µé…ç½®çš„key(chunk name)ä¸ºå•ä½è¿›è¡Œåˆ†ç»„ï¼Œä¸€ä¸ª entry å’Œå…¶æ‰€æœ‰ä¾èµ–çš„ module è¢«åˆ†åˆ°ä¸€ä¸ªç»„ä¹Ÿå°±æ˜¯ä¸€ä¸ª chunkã€‚ æœ€å webpack ä¼šæŠŠæ‰€æœ‰ chunk è½¬æ¢æˆæ–‡ä»¶è¾“å‡ºä¸ºbundleï¼› åœ¨æ•´ä¸ªæµç¨‹ä¸­ webpack ä¼šåœ¨æ°å½“çš„æ—¶æœºæ‰§è¡Œ plugin é‡Œå®šä¹‰çš„é€»è¾‘ï¼Œåœ¨pluginæ‰§è¡Œé€»è¾‘ä¸­ï¼Œå¯èƒ½ä¼šå†æŠ½å–å…¶ä»–bundle(ä¾‹å¦‚ä»js bundleä¸­å†å•ç‹¬æŠ½å–å‡ºä¸€ä¸ªcss bundleæ–‡ä»¶)ï¼Œä½†è¿™ä¸å±äºwebpackä¸»é€»è¾‘ï¼Œå±äºpluginé™„åŠ çš„èƒ½åŠ› æ­£å¸¸æƒ…å†µä¸‹ï¼Œwebpackæ˜¯ä¸€ä¸ªjs entry-pointå¯¹åº”ä¸€ä¸ªjs chunkå¯¹åº”ç”Ÿæˆä¸€ä¸ªjs bundle(é™¤éé…ç½®äº†sourcemapï¼Œä¼šå•ç‹¬å†ç”Ÿæˆä¸€ä¸ªsourcemap bundle)ï¼› pluginå±äºå¢å¼ºwebpackåŠŸèƒ½ï¼Œloaderç»™webpackæä¾›éjsæ–‡ä»¶çš„è½¬æ¢èƒ½åŠ›ï¼› ç›¸å…³é¡¹ç›® webpack-chainæºç åˆ†æ ä½¿ç”¨webpack-chainç¼–å†™webpackçš„å®è·µ ã€Šæ·±å…¥æµ…å‡ºWebpackã€‹å­¦ä¹ demos å‚è€ƒhttps://github.com/webpack/webpack.js.org/issues/970https://juejin.im/post/5cede821f265da1bbd4b5630https://juejin.im/post/5d2b300de51d45775b419c76]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>webpack</tag>
        <tag>å·¥ç¨‹åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[style-lint]]></title>
    <url>%2F2020%2F03%2F05%2Fstyle-lint%2F</url>
    <content type="text"><![CDATA[é…ç½®stylelintå¹¶åœ¨ä¿å­˜æ—¶è‡ªåŠ¨ä¿®å¤å®‰è£… vscodeå®‰è£…æ’ä»¶stylelint-plusï¼Œå…¶æ”¯æŒautoFixOnSaveï¼Œå…¶å®ƒæ’ä»¶ä¸æ”¯æŒ æ’ä»¶å…³é”®é…ç½®123456789101112131415// * ------------------ // * stylelintç›¸å…³ // * ä¸»è¦æ€è·¯ï¼š // * ä½¿ç”¨vscodeæ’ä»¶stylelint-plusæ’ä»¶ï¼Œå¹¶å¼€å¯autoFixOnSave // * ç”±äºstylelint-pluså†…éƒ¨è‡ªå¸¦stylelintï¼Œé¡¹ç›®ä¸­å¯ä¸éœ€è¦å†å®‰è£…stylelintåŒ… // * stylelint-plusæœºåˆ¶å’Œvscode eslintæ’ä»¶æœºåˆ¶ç±»ä¼¼ï¼Œä¼šè¯»å–é¡¹ç›®ä¸­çš„stylelinté…ç½®æ–‡ä»¶ // * è‹¥é¡¹ç›®æ— é…ç½®æ–‡ä»¶ï¼Œåˆ™ä½¿ç”¨è‡ªå¸¦çš„é»˜è®¤é…ç½® // * é¡¹ç›®é…ç½®ä¸­è‹¥å£°æ˜äº†pluginsï¼Œåˆ™éœ€è¦ä½¿ç”¨npm å®‰è£…å¯¹åº”çš„pluginsåŒ… // * ç”±äºvscodeè‡ªå¸¦cssã€lessã€scssçš„æ ¡éªŒï¼Œä¸ºé¿å…é‡å¤æ£€æŸ¥ï¼Œå¯é€‰æ‹©å…³é—­vscodeçš„æ ¡éªŒ // * ------------------ "stylelint.autoFixOnSave": true, "css.validate": false, "less.validate": false, "scss.validate": false, package.json æ·»åŠ ä»¥ä¸‹åŒ… 1234"stylelint": "^12.0.0", "stylelint-config-rational-order": "^0.1.2", "stylelint-order": "^3.1.1", "stylelint-selector-bem-pattern": "^2.1.0" .stylelintrc å‚ç…§ä»¥ä¸‹æ–‡ç« ï¼Œä½¿ç”¨å¦‚ä¸‹é…ç½®ï¼Œå¯è§£å†³vsocdeä¿å­˜æ—¶æŠ¥ï¼šError: severity property of a stylelint warning must be either â€˜errorâ€™ or â€˜warningâ€™, but it was â€˜ignoreâ€™ (string). at stylelintWarningToVscodeDiagnostic. https://github.com/constverum/stylelint-config-rational-order/issues/13#issuecomment-522421878 https://github.com/constverum/stylelint-config-rational-order/issues/10 1234567891011121314151617181920212223242526272829303132&#123;// ä¸å†ä½¿ç”¨"extends"ç»§æ‰¿stylelint-config-rational-orderé…ç½®ï¼Œè€Œæ˜¯åªä½¿ç”¨stylelint-config-rational-order/plugin "plugins": [ "stylelint-order", // æ˜¾ç¤ºæ·»åŠ stylelint-order "stylelint-config-rational-order/plugin", // æ·»åŠ stylelint-config-rational-order/plugin "stylelint-selector-bem-pattern" // è§„å®šå¿…é¡»éœ€è¦suitè§„èŒƒçš„classåï¼›å…¶å†…éƒ¨ä½¿ç”¨äº†https://github.com/postcss/postcss-bem-linteræ’ä»¶ï¼Œä¸å†é»˜è®¤ç”¨suit è§„èŒƒ(postcss-bem-linteræ’ä»¶é»˜è®¤ä½¿ç”¨suit cssè§„èŒƒ)ï¼Œæ‰€ä»¥ä½¿ç”¨suitè§„èŒƒï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®špreset ], "rules": &#123; "order/properties-order": [], // å‚ç…§issue #10 ï¼Œæ·»åŠ æ­¤é…ç½®ï¼Œå¹¶ä¸”æ­¤é¡¹æœ€å¥½åœ¨rulesé¦–ä½ "plugin/rational-order": [ true, &#123; "border-in-box-model": false, // å°†borderæ”¾åˆ°è§†è§‰éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯ç›’æ¨¡å‹ "empty-line-between-groups": true, // ä¸åŒåˆ†ç»„é—´ï¼Œæ·»åŠ ä¸€ä¸ªç©ºè¡Œ &#125; ], "plugin/selector-bem-pattern": &#123; "preset": "suit", // ä½¿ç”¨suit é¢„è®¾ "presetOptions": &#123; "namespace": "c" // æŒ‡æ˜å‘½åç©ºé—´ï¼Œç»„ä»¶åå¿…é¡»ä»¥c-å¼€å¤´ &#125;, // æŒ‡åsrc/**/*.vueéƒ½æ˜¯componentï¼Œå…¶&lt;style&gt;ä¸­çš„ç±»åå¿…é¡»æ˜¯c-æ–‡ä»¶å "implicitComponents": [ "src/**/*.vue" ], // æŒ‡åssrc/sass/helpers/*.scsséƒ½æ˜¯utilsï¼Œç±»åå¿…é¡»u-å¼€å¤´ "implicitUtilities": [ "src/sass/helpers/*.scss" ] &#125;, &#125;&#125;]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>stylelint</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[hashchange-beforeunload-popstate]]></title>
    <url>%2F2020%2F03%2F05%2Fhashchange-beforeunload-popstate%2F</url>
    <content type="text"><![CDATA[hashchangeã€beforeunloadã€popstatehashchange äº‹ä»¶è§¦å‘æ—¶æœº åœ¨é¡µé¢ hash ç‰‡æ®µ(å³ URL ä¸­#å’Œ#åé¢çš„éƒ¨åˆ†)æ”¹å˜æ—¶è§¦å‘ hashï¼ˆ#ï¼‰æ˜¯ URL çš„é”šç‚¹ï¼Œä»£è¡¨çš„æ˜¯ç½‘é¡µä¸­çš„ä¸€ä¸ªä½ç½®ï¼Œå•å•æ”¹å˜#åçš„éƒ¨åˆ†ï¼Œæµè§ˆå™¨åªä¼šæ»šåŠ¨åˆ°ç›¸åº”ä½ç½®ï¼Œä¸ä¼šé‡æ–°åŠ è½½ç½‘é¡µï¼Œä¹Ÿå°±æ˜¯è¯´ #æ˜¯ç”¨æ¥æŒ‡å¯¼æµè§ˆå™¨åŠ¨ä½œçš„ï¼Œå¯¹æœåŠ¡å™¨ç«¯å®Œå…¨æ— ç”¨ï¼ŒHTTP è¯·æ±‚ä¸­ä¹Ÿä¸ä¼šä¸åŒ…æ‹¬#ï¼›åŒæ—¶æ¯ä¸€æ¬¡æ”¹å˜#åçš„éƒ¨åˆ†ï¼Œéƒ½ä¼šåœ¨æµè§ˆå™¨çš„è®¿é—®å†å²ä¸­å¢åŠ ä¸€ä¸ªè®°å½•ï¼Œä½¿ç”¨â€åé€€â€æŒ‰é’®ï¼Œå°±å¯ä»¥å›åˆ°ä¸Šä¸€ä¸ªä½ç½®ã€‚(hash è™½ç„¶å‡ºç°åœ¨ URL ä¸­ï¼Œä½†ä¸ä¼šè¢«åŒ…æ‹¬åœ¨ HTTP è¯·æ±‚ä¸­ã€‚å®ƒæ˜¯ç”¨æ¥æŒ‡å¯¼æµè§ˆå™¨åŠ¨ä½œçš„ï¼Œå¯¹æœåŠ¡å™¨ç«¯å®Œå…¨æ— ç”¨ï¼Œå› æ­¤ï¼Œæ”¹å˜ hash ä¸ä¼šé‡æ–°åŠ è½½é¡µé¢) å°ç»“ hash æ”¹å˜æ—¶ï¼Œä¼šè§¦å‘hashchangeäº‹ä»¶ï¼Œå¹¶ä¼šåœ¨å…¨å±€å†å²è®°å½•ä¸­æ·»åŠ ä¸€æ¡è®°å½• beforeunload äº‹ä»¶è§¦å‘æ—¶æœº ä»…åœ¨é¡µé¢æ–‡æ¡£è¢«å¸è½½æ—¶è§¦å‘ å¦‚æœå¤„ç†å‡½æ•°ä¸º Event å¯¹è±¡çš„returnValueå±æ€§èµ‹å€¼éç©ºå­—ç¬¦ä¸²ï¼Œæµè§ˆå™¨ä¼šå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†ï¼Œæ¥è¯¢é—®ç”¨æˆ·æ˜¯å¦ç¡®å®šè¦ç¦»å¼€å½“å‰é¡µé¢ æœ‰äº›æµè§ˆå™¨ä¼šå°†è¿”å›çš„å­—ç¬¦ä¸²å±•ç¤ºåœ¨å¼¹æ¡†é‡Œï¼Œä½†æœ‰äº›å…¶ä»–æµè§ˆå™¨åªå±•ç¤ºå®ƒä»¬è‡ªå®šä¹‰çš„ä¿¡æ¯ã€‚æ²¡æœ‰èµ‹å€¼æ—¶ï¼Œè¯¥äº‹ä»¶ä¸åšä»»ä½•å“åº”1234window.addEventListener("beforeunload", function (e) &#123; var confirmationMessage = "ç¦»å¼€æç¤ºä¿¡æ¯"; (e || window.event).returnValue = confirmationMessage; // Gecko and Trident return confirmationMessage; // Gecko and WebKit&#125;); ç›¸å…³åœºæ™¯ åˆ·æ–° åˆ·æ–°æ—¶ï¼ŒåŸæœ‰é¡µé¢æ–‡æ¡£ä¼šè¢«å¸è½½ï¼Œæ‰€ä»¥ä¼šè§¦å‘ï¼›ä¸ä¼šè§¦å‘ popstate äº‹ä»¶ å…³é—­ é¡µé¢å…³é—­ï¼ŒåŸæœ‰é¡µé¢æ–‡æ¡£ä¹Ÿä¼šè¢«å¸è½½ï¼Œæ‰€ä»¥ä¹Ÿä¼šè§¦å‘ï¼›ä¸ä¼šè§¦å‘ popstate äº‹ä»¶ hashchange æ—¶ hash æ”¹å˜ï¼ŒåŸæœ‰é¡µé¢æ–‡æ¡£ä¸ä¼šè¢«å¸è½½ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘ï¼›ä¼šè§¦å‘ popstate äº‹ä»¶ pushStateã€replaceState æ—¶ é¡µé¢ä¸ä¼šè¢«å¸è½½ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘beforeunloadï¼›ä¸ä¼šè§¦å‘ popstate äº‹ä»¶ è¿”å›ã€å‰è¿› å½“è¿”å›ã€å‰è¿›æ“ä½œå¼•èµ·é¡µé¢å¸è½½æ—¶ï¼Œä¼šè§¦å‘ï¼›å¼•èµ·å¸è½½æ—¶ï¼Œä¸ä¼šè§¦å‘ popstate äº‹ä»¶ï¼Œæ²¡æœ‰å¼•èµ·å¸è½½æ—¶ï¼Œä¼šè§¦å‘ popstate äº‹ä»¶ å°æŠ€å·§ åˆ¤æ–­é™¤å…³é—­ä»¥å¤–çš„æ“ä½œæ˜¯å¦ä¼šè§¦å‘beforeunloadçš„æŠ€å·§(é€‚ç”¨äº chrome) è¿›è¡Œæ“ä½œæ—¶ï¼ŒæŸ¥çœ‹å½“å‰æµè§ˆå™¨ tab ä¸Šæ˜¯å¦å‡ºç°æ­£åœ¨åŠ è½½èµ„æºçš„æ ‡è¯† æ³¨æ„ æ­¤äº‹ä»¶çš„å¤„ç†å‡½æ•°ä¸­ï¼Œä¼šå¿½ç•¥å¯¹window.alert(), window.confirm(), å’Œ window.prompt()çš„è°ƒç”¨ å¦‚æœé¡µé¢æ²¡æœ‰å‘ç”Ÿäº¤äº’ï¼Œæµè§ˆå™¨å¯èƒ½ä¸ä¼šå±•ç¤ºå¼¹çª—ï¼Œç”šè‡³å¯èƒ½å³ä½¿å‘ç”Ÿäº¤äº’äº†ä¹Ÿç›´æ¥ä¸æ˜¾ç¤ºï¼Œå¹¶ä¸”ä¼šæç¤ºå¦‚ä¸‹é”™è¯¯ä¿¡æ¯ï¼›ç›¸å…³é“¾æ¥1 [Intervention] Blocked attempt to show a 'beforeunload' confirmation panel for a frame that never had a user gesture since its load å°ç»“ beforeunload ä»…åœ¨é¡µé¢æ–‡æ¡£è¢«å¸è½½æ—¶è§¦å‘ å¯é€šè¿‡é¡µé¢æ˜¯å¦é‡æ–°åŠ è½½èµ„æºï¼Œæ¥åˆ¤æ–­æ“ä½œæ˜¯å¦ä¼šè§¦å‘ beforeunload å³ä½¿è§¦å‘äº†ï¼Œä¹Ÿå¯èƒ½ä¼šè¢«æµè§ˆå™¨æ‹¦æˆª History APIä»‹ç» ä» HTML5 å¼€å§‹â€”â€”æä¾›äº†å¯¹ history æ ˆä¸­å†…å®¹çš„è¿›è¡Œæ“ä½œçš„ APIï¼› ç”±äºå®‰å…¨åŸå› ï¼Œæµè§ˆå™¨ä¸å…è®¸è„šæœ¬è¯»å–å†å²è®°å½•çš„åœ°å€ï¼Œä½†æ˜¯å…è®¸åœ¨åœ°å€ä¹‹é—´å¯¼èˆª æŸ¥çœ‹å½“å‰çª—å£å†å²è®°å½•æ ˆé•¿åº¦ å†å²è®°å½•æ ˆç±»å‹ å½“å‰çª—å£å†å²è®°å½•æ ˆ ç”±window.historyç»´æŠ¤ å…¨å±€å†å²è®°å½•æ ˆ chrome ä¸­é€šè¿‡ctrl+hæ‰“å¼€1window.history.length å‰è¿›ã€åé€€ã€è·³åˆ°æŒ‡å®šä½ç½®12345678// åœ¨historyä¸­å‘åè·³è½¬ï¼›è¿™å’Œç”¨æˆ·ç‚¹å‡»æµè§ˆå™¨å›é€€æŒ‰é’®çš„æ•ˆæœç›¸åŒwindow.history.back()// å‘å‰è·³è½¬ï¼ˆå¦‚åŒç”¨æˆ·ç‚¹å‡»äº†å‰è¿›æŒ‰é’®window.history.forward()// å‘åç§»åŠ¨ä¸€ä¸ªé¡µé¢ (ç­‰åŒäºè°ƒç”¨ back())window.history.go(-1)// å‘å‰ç§»åŠ¨ä¸€ä¸ªé¡µé¢, ç­‰åŒäºè°ƒç”¨äº† forward()window.history.go(1) window.history.go(0) ä½œç”¨ç­‰åŒäºåˆ·æ–° go(0) vs reloadçš„åŒºåˆ« reloadä¼šé‡æ–°æ‹‰å–æ•°æ®ï¼Œgo(0)ç›´æ¥ä»ç¼“å­˜ä¸­è·å–æ•°æ®1234// ç›´æ¥è¯»å–ç¼“å­˜æ•°æ®ï¼Œä¸ä¼šä»æœåŠ¡å™¨ç«¯è·å–æ•°æ®ï¼Œä¹Ÿä¸ä¼šå¢åŠ æ–°çš„å†å²è®°å½•window.history.go(0)// æ˜¯ä¼šä»æœåŠ¡ç«¯è·å–æ•°æ®çš„window.location.reload() æ·»åŠ ã€ä¿®æ”¹è®°å½• ä½¿ç”¨pushStateã€replaceStateæ–¹æ³• å‰è€…æ·»åŠ ä¸€æ¡æ–°è®°å½•ã€åè€…ä¿®æ”¹å½“å‰è®°å½• pushStateã€replaceStateå‚æ•° pushStateã€replaceStateæ”¯æŒä¼ å…¥ 3 ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºstateObjã€titleã€url stateObjå°±æ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œä¸å¯¹åº”çš„å†å²è®°å½•æ¡ç›®ç»‘å®šï¼› stateObj æœ‰å¤§å°é™åˆ¶ stateObj åºåˆ—åŒ–åå¿…é¡»&lt;=640k æ¯æ¬¡ï¼Œå½“ç”¨æˆ·è·¯ç”±åˆ°å¯¹åº”å†å²è®°å½•æ¡ç›®ï¼Œåˆ™å¯ä»¥é€šè¿‡history.stateæˆ–è€…popstateäº‹ä»¶è·å–åˆ°å¯¹åº”çš„stateObj123456// è·å–å½“å‰å†å²è®°å½•çš„çŠ¶æ€å¯¹è±¡history.state// é€šè¿‡popstateäº‹ä»¶è·å–stateObjwindow.onpopstate = e =&gt; &#123; console.log(e.state)&#125; titleæ˜¯ä¸€ä¸ªå¯çœç•¥çš„æ ‡é¢˜ å»ºè®®å³ä½¿ä¸ç”¨æ—¶ï¼Œä¹Ÿä¼ é€’ä¸ªç©ºå­—ç¬¦ä¸² urlå®šä¹‰äº†æ–°çš„å†å² URL è®°å½• å¿…é¡»æ˜¯åŒåŸŸ url å¯ä»¥æ˜¯ç›¸å¯¹ urlï¼Œä¹Ÿå¯ä»¥æ˜¯ç»å¯¹ url1234567// å½“å‰é¡µé¢åœ°å€www.a.com/foo/bar.html// ç›¸å¯¹è·¯å¾„history.pushState(&#123; test: 1 &#125;, 'test', './test.html') // é¡µé¢åœ°å€å˜ä¸ºwww.a.com/foo/test.html// ç»å¯¹è·¯å¾„history.pushState(&#123; test2: 2 &#125;, 'test2', '/test2.html') // é¡µé¢åœ°å€å˜ä¸ºwww.a.com/test2.html// éåŒåŸŸhistory.pushState(&#123; test3: 3 &#125;, 'test3', 'http://www.baidu.com') // è·¨åŸŸï¼ŒæŠ¥é”™ æ³¨æ„ ä½¿ç”¨ pushStateã€replaceState æ·»åŠ å†å²è®°å½•æ—¶ï¼Œä¸ä¼šç«‹å³åŠ è½½ç›¸åº”é¡µé¢ï¼Œç”šè‡³éƒ½ä¸ä¼šæ£€æŸ¥æ–°çš„å†å²è®°å½•åœ°å€æ˜¯å¦çœŸçš„å­˜åœ¨ å®ƒä»…ä»…æ˜¯åœ¨å½“å‰å†å²è®°å½•æ ˆä¸­æ–°å¢äº†ä¸€æ¡è®°å½•ï¼Œå¹¶ä¸ä¼šç«‹å³åŠ è½½ç›¸åº”é¡µé¢ è¿™æ ·å°±å®ç°äº†ä¸åˆ·æ–°é¡µé¢æ”¹å˜ URL åªåœ¨åˆ·æ–°æˆ–å…ˆè·³è½¬åˆ°å…¶ä»–åŸŸé¡µé¢ï¼Œå†è¿”å›çš„åœºæ™¯ä¸‹ï¼Œæ‰ä¼šè§¦å‘åŠ è½½é¡µé¢ï¼Œå¦åˆ™éƒ½æ˜¯æ— åˆ·æ–°çš„ pushState()ã€replaceState() ç»å¯¹ä¸ä¼šè§¦å‘ hashchange äº‹ä»¶ï¼Œå³ä½¿æ–°çš„ URL ä¸æ—§çš„ URL ä»…å“ˆå¸Œä¸åŒä¹Ÿæ˜¯å¦‚æ­¤ã€‚ pushStateã€replaceState å’Œæ”¹å˜ hash æ¥å®ç°æ— åˆ·æ–°æ”¹å˜ URL çš„åŒºåˆ« å‰è€…å¯ä»¥ä¿®æ”¹åŒæºä¸‹çš„ä»»æ„è·¯å¾„ï¼›åè€…åªèƒ½ä¿®æ”¹ hash éƒ¨åˆ† å‰è€…å³ä½¿åœ¨æ·»åŠ çš„ url è·Ÿä¹‹å‰å®Œå…¨ç›¸åŒæ—¶ï¼Œä¹Ÿä¼šè¢«æ·»åŠ åˆ°å†å²è®°å½•æ ˆä¸­ï¼Œå¹¶ä¼šè§¦å‘ popstate äº‹ä»¶ï¼›åè€…åªæœ‰åœ¨æ–° hash ä¸åŒæ—¶ï¼Œæ‰ä¼šæ·»åŠ æ–°çš„å†å²è®°å½•ï¼Œå¹¶è§¦å‘hashchangeï¼Œå¦åˆ™æ— æ³•è§¦å‘hashchange å‰è€…æ”¯æŒå…³è”ä»»æ„çš„æ•°æ®åˆ°å†å²è®°å½•é¡¹ä¸Šï¼›åè€…åªèƒ½æŠŠç›¸å…³æ•°æ®è½¬æˆå­—ç¬¦ä¸²æ·»åŠ åˆ° hash ä¸Šï¼Œå˜ç›¸ç»‘å®šç›¸å…³æ•°æ® popstate äº‹ä»¶ä»‹ç» æ¯å½“å¤„äºæ¿€æ´»çŠ¶æ€çš„å†å²è®°å½•æ¡ç›®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè§¦å‘popstateäº‹ä»¶ æ›´å‡†ç¡®çš„å®šä¹‰ï¼šæ¯å½“åŒä¸€ä¸ªæ–‡æ¡£çš„æµè§ˆå†å²ï¼ˆå³ history å¯¹è±¡ï¼‰å‡ºç°å˜åŒ–æ—¶ï¼Œå°±ä¼šè§¦å‘ popstate äº‹ä»¶ã€‚å½“å†å²è®°å½•å˜åŒ–ï¼Œå¼•èµ·æ–‡æ¡£å˜åŒ–(reload)æ—¶ï¼Œpopstate ä¸ä¼šè§¦å‘(A popstate event is dispatched to the window each time the active history entry changes between two history entries for the same document) è§¦å‘åœºæ™¯ è°ƒç”¨pushStateã€replaceStateæ—¶ï¼Œä¸ä¼šè§¦å‘popstateäº‹ä»¶ åªæœ‰ç”¨æˆ·ç‚¹å‡»æµè§ˆå™¨å€’é€€æŒ‰é’®å’Œå‰è¿›æŒ‰é’®ï¼Œæˆ–è€…ä½¿ç”¨ JavaScript è°ƒç”¨History.back()ã€History.forward()ã€History.go()æ–¹æ³•å¯¼è‡´å†å²è®°å½•æ¡ç›®å˜åŒ–æ—¶æ‰ä¼šè§¦å‘ è¯¥äº‹ä»¶åªé’ˆå¯¹åŒä¸€ä¸ªæ–‡æ¡£ï¼Œå¦‚æœæµè§ˆå†å²çš„åˆ‡æ¢ï¼Œå¯¼è‡´åŠ è½½ä¸åŒçš„æ–‡æ¡£ï¼Œè¯¥äº‹ä»¶ä¹Ÿä¸ä¼šè§¦å‘ã€‚ å½“ç½‘é¡µåŠ è½½æ—¶,å„æµè§ˆå™¨å¯¹popstateäº‹ä»¶æ˜¯å¦è§¦å‘æœ‰ä¸åŒçš„è¡¨ç°,Chrome å’Œ Safariä¼šè§¦å‘popstateäº‹ä»¶, è€ŒFirefoxä¸ä¼š.ï¼ˆæœ‰å¾…éªŒè¯ï¼‰ hashæ”¹å˜æ—¶ï¼Œä¹Ÿä¼šè§¦å‘popstateäº‹ä»¶ æ³¨æ„ å¦‚æœå½“å‰å¤„äºæ¿€æ´»çŠ¶æ€çš„å†å²è®°å½•æ¡ç›®æ˜¯ç”±history.pushState()æ–¹æ³•åˆ›å»º,æˆ–è€…ç”±history.replaceState()æ–¹æ³•ä¿®æ”¹è¿‡çš„, åˆ™popstateäº‹ä»¶å¯¹è±¡çš„stateå±æ€§åŒ…å«äº†å½“å‰è¿™ä¸ªå†å²è®°å½•æ¡ç›®çš„stateå¯¹è±¡çš„ä¸€ä¸ªæ‹·è´ å³ä¾¿è¿›å…¥äº†é‚£äº›épushStateå’ŒreplaceStateæ–¹æ³•ä½œç”¨è¿‡çš„(æ¯”å¦‚http://example.com/example.html)æ²¡æœ‰ state å¯¹è±¡å…³è”çš„é‚£äº›ç½‘é¡µ, popstate äº‹ä»¶ä¹Ÿä»ç„¶ä¼šè¢«è§¦å‘ demos123456789101112131415161718// ç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°.window.onpopstate = function(event) &#123; alert( 'location: ' + document.location + ', state: ' + JSON.stringify(event.state) )&#125;// æ·»åŠ å¹¶æ¿€æ´»ä¸€ä¸ªå†å²è®°å½•æ¡ç›® http://example.com/example.html?page=1,æ¡ç›®ç´¢å¼•ä¸º1history.pushState(&#123; page: 1 &#125;, 'title 1', '?page=1')// æ·»åŠ å¹¶æ¿€æ´»ä¸€ä¸ªå†å²è®°å½•æ¡ç›® http://example.com/example.html?page=2,æ¡ç›®ç´¢å¼•ä¸º2history.pushState(&#123; page: 2 &#125;, 'title 2', '?page=2')// ä¿®æ”¹å½“å‰æ¿€æ´»çš„å†å²è®°å½•æ¡ç›® http://ex..?page=2 å˜ä¸º http://ex..?page=3,æ¡ç›®ç´¢å¼•ä¸º3history.replaceState(&#123; page: 3 &#125;, 'title 3', '?page=3')// å¼¹å‡º "location: http://example.com/example.html?page=1, state: &#123;"page":1&#125;"history.back()// å¼¹å‡º "location: http://example.com/example.html, state: nullhistory.back()// å¼¹å‡º "location: http://example.com/example.html?page=3, state: &#123;"page":3&#125;history.go(2) å°ç»“ pushStateã€replaceStateæ—¶ä¸ä¼šè§¦å‘popstateäº‹ä»¶ åŠ è½½ä¸åŒçš„æ–‡æ¡£æ—¶ï¼Œä¸ä¼šè§¦å‘ hashæ”¹å˜æ—¶ï¼Œä¼šè§¦å‘ vue-router ä¸­çš„ hashã€history æ¨¡å¼è®¾ç½® mode ä¸º hashï¼Œå¹¶ä¸ä¸€å®šç”¨çš„å°±æ˜¯ hash åœ¨æ–°ç‰ˆæœ¬vue-routerä¸­ï¼Œå¦‚æœæµè§ˆå™¨æ”¯æŒHistory APIï¼Œvue-routerä¼šä¼˜å…ˆä½¿ç”¨Historyç›¸å…³ APIï¼ˆpushStateã€replaceStateï¼‰æ¥æ¨¡æ‹Ÿhashï¼Œå³ä½¿ç”¨æˆ·è®¾ç½®modeä¸ºhashï¼›åªæœ‰åœ¨æµè§ˆå™¨ä¸æ”¯æŒHistoryæ—¶ï¼Œæ‰ä¼šä½¿ç”¨hashchange éªŒè¯ vue-router ç‰ˆæœ¬ 3.0.6ï¼Œè®¾ç½®modeä¸º hashï¼›chrome ç‰ˆæœ¬ 78 ç»“è®º è°ƒç”¨ this.$router.push æ–¹æ³•è·³è½¬æ–°è·¯ç”±æ—¶ï¼Œæ²¡æœ‰è§¦å‘popstateäº‹ä»¶ å¦‚æœä½¿ç”¨çš„hashchangeï¼Œåˆ™hashæ”¹å˜æ—¶ï¼Œè‚¯å®šä¼šè§¦å‘popstateäº‹ä»¶ åŸå›  æ­£å¸¸è®¤çŸ¥ä¸‹ï¼Œè®¾ç½®äº†hashæ¨¡å¼ï¼Œvue-routerå†…éƒ¨è‚¯å®šä¼šç”¨åˆ°hashchangeäº‹ä»¶ï¼Œ$router.pushæ—¶ï¼Œhashæ”¹å˜ï¼Œè‚¯å®šä¼šè§¦å‘hashchangeå’Œpopstateäº‹ä»¶ï¼Œä½†å®é™…ä¸Šï¼Œä¸¤ä¸ªäº‹ä»¶éƒ½æ²¡æœ‰è§¦å‘ï¼›åŸå› æ˜¯vue-routeræ£€æµ‹åˆ°æµè§ˆå™¨æ”¯æŒhistoryï¼Œå¼ºåˆ¶ä½¿ç”¨äº†historyçš„pushStateã€replaceStateæ¥æ¨¡æ‹Ÿhash(URL è¡¨ç°å½¢å¼ä¸Šä»ç„¶ä¼šå‡ºç°#å·)ï¼Œè€ŒpushStateã€replaceStateè°ƒç”¨æ—¶ï¼Œä¸ä¼šè§¦å‘popstateäº‹ä»¶ æºç  åœ¨ HashHistory ç±»çš„ setupListeners æ–¹æ³•ä¸­ï¼Œæ˜¯æ ¹æ®supportsPushStateæ¥ç¡®å®šæ˜¯ç»‘å®špopstateè¿˜æ˜¯hashchangeäº‹ä»¶ supportsPushState çš„å®ç°ï¼Œä¸»è¦åˆ¤æ–­äº†ä¸€äº›ç‰¹å®šæµè§ˆå™¨ï¼Œç›´æ¥è¿”å› falseï¼Œå…¶ä»–çš„é€šè¿‡ç‰¹æ€§æ£€æµ‹æ¥åˆ¤æ–­ï¼›æ‰€ä»¥ï¼Œå…¶å¹¶æ²¡æœ‰æ ¹æ®ä¼ å…¥çš„ mode æ¥é€‰æ‹©ç›‘å¬çš„äº‹ä»¶ç±»å‹ï¼Œè€Œæ˜¯æ ¹æ®æµè§ˆå™¨æ˜¯å¦æ”¯æŒæ¥ç¡®å®šç›‘å¬äº‹ä»¶çš„ç±»å‹ è§¦å‘æ—¶æœºæ€»ç»“ æ“ä½œ hashchange popstate beforeunload beforeRouteLeave ç‚¹å‡»åˆ·æ–° N N Y N ç‚¹å‡»ä¸»é¡µ N N Y N ç‚¹å‡»å…³é—­ tab N N Y N æ‰‹åŠ¨ä¿®æ”¹ URLï¼Œå¼•èµ·é¡µé¢åŠ è½½ N N Y N æ‰‹åŠ¨ä¿®æ”¹ hash Y Y N Y history.pushStateã€history.replaceState N N N Y $router.push(è°ƒç”¨äº† history.pushState) N N N Y $router.back(è°ƒç”¨äº† history.back) Y Y N Y åº”ç”¨vue å•é¡µç¦»å¼€æ—¶ï¼Œç»™äºˆä¿å­˜æç¤º ç›‘å¬beforeunloadå¤„ç†é¡µé¢åˆ·æ–°ã€å…³é—­ ç›‘å¬ç»„ä»¶å†…çš„beforeRouteLeaveï¼Œå¤„ç†é¡µé¢å†…è·¯ç”±è·³è½¬ vueä¸­å¯æŠ½å–æˆä¸€ä¸ªå•ç‹¬çš„mixinsï¼Œä¾›ç»„ä»¶å¤ç”¨ å¦‚æœå¸Œæœ›ç‹¬ç«‹vueä½¿ç”¨ï¼Œè€ƒè™‘ä½¿ç”¨popstateæ›¿ä»£beforeRouteLeave1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192/** * @author GuangHui * @description é¡µé¢ç¦»å¼€æç¤º mixins */export const mixinsName = 'LEAVE_TIPS_MIXINS'export const getName = name =&gt; `$&#123;mixinsName&#125;_$&#123;String(name)&#125;`export default &#123; data() &#123; return &#123; [getName('tips')]: 'ç³»ç»Ÿå¯èƒ½ä¸ä¼šä¿å­˜æ‚¨æ‰€åšçš„æ›´æ”¹' &#125; &#125;, created() &#123; this[getName('init')]() &#125;, activated() &#123; this[getName('init')]() &#125;, beforeRouteLeave(to, from, next) &#123; this[getName('handleBeforeRouteLeave')](to, from, next) &#125;, methods: &#123; /** * å¤„ç†beforeRouteLeave * * @param &#123;*&#125; to * @param &#123;*&#125; from * @param &#123;*&#125; next */ [getName('handleBeforeRouteLeave')](to, from, next) &#123; if (this[getName('showTips')]()) &#123; next() &#125; else &#123; next(false) &#125; &#125;, /** * å±•ç¤ºé»˜è®¤tips * * @returns confrimè¿”å›å€¼ */ [getName('showTips')]() &#123; return window.confirm(this[getName('tips')]) &#125;, /** * åˆå§‹åŒ– * */ [getName('init')]() &#123; /* eslint-disable-next-line */ this[getName('handleBeforeUnloadBinded')] = this[ getName('handleBeforeUnload') ].bind(this) this[getName('bindEvents')]() this.$once('hook:deactivated', this[getName('cleanEvents')]) this.$once('hook:beforeDestroy', this[getName('cleanEvents')]) &#125;, /** * å¤„ç†beforeunloadäº‹ä»¶ * * @param &#123;*&#125; e äº‹ä»¶å¯¹è±¡ */ [getName('handleBeforeUnload')](e) &#123; // https://developer.mozilla.org/zh-CN/docs/Web/Events/beforeunload ;(e || window.event).returnValue = this[getName('tips')] // Gecko and Trident return this[getName('tips')] // Gecko and WebKit &#125;, /** * ç»‘å®šäº‹ä»¶ * */ [getName('bindEvents')]() &#123; window.addEventListener( 'beforeunload', this[getName('handleBeforeUnloadBinded')], false ) &#125;, /** * æ¸…é™¤äº‹ä»¶ * */ [getName('cleanEvents')]() &#123; window.removeEventListener( 'beforeunload', this[getName('handleBeforeUnloadBinded')], false ) &#125; &#125;&#125; å‚è€ƒ https://www.cnblogs.com/wancheng7/p/8542544.html https://developer.mozilla.org/zh-CN/docs/Web/API/Window/onpopstate]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>å‰ç«¯</tag>
        <tag>history</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vue-options-merge]]></title>
    <url>%2F2020%2F03%2F05%2Fvue-options-merge%2F</url>
    <content type="text"><![CDATA[Vueã€Vue.extendã€Vue.componentã€vm.mixinsã€vm.extendsçš„åŒºåˆ«åŠé€‰é¡¹åˆå¹¶ç­–ç•¥Vueã€Vue.extendã€Vue.componentã€vm.mixinsã€vm.extendsçš„åŒºåˆ«Vue Vueæ„é€ å™¨(ç±»)ä¸»è¦ç”¨æ¥åˆ›å»ºvueæ ¹å®ä¾‹ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªé€‰é¡¹å¯¹è±¡ï¼› vueä¸­ç»„ä»¶æ˜¯ä¸€ä¸ªå¸¦æœ‰åå­—çš„å¯å¤ç”¨vueå®ä¾‹(ç»„ä»¶ä¹Ÿæ˜¯ä¸€ä¸ªä¸ªçš„vueå®ä¾‹)ï¼Œå…¶æœ¬è´¨ä¹Ÿæ˜¯å€ŸåŠ©Vueæ„é€ å™¨(ç±»)æ¥ç”Ÿæˆçš„ï¼Œæ‰€ä»¥ç»„ä»¶å®šä¹‰çš„å‚æ•°å’ŒVueæ„é€ å™¨éœ€è¦çš„å‚æ•°åŸºæœ¬ä¸€è‡´ï¼Œä»…æœ‰çš„ä¾‹å¤–æ˜¯åƒelè¿™æ ·æ ¹å®ä¾‹ç‰¹æœ‰çš„é€‰é¡¹ã€‚ 1234new Vue(&#123; el:'#app', render:h=&gt;h(App)&#125;) Vue.extend åŸºäºVueç±»ï¼Œåˆ›å»ºä¸€ä¸ªå­ç±»ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªåŒ…å«ç»„ä»¶é€‰é¡¹çš„å¯¹è±¡ ä¸»è¦ç”¨äºvueä¸­åˆ›å»ºå¯å¤ç”¨çš„ç»„ä»¶ï¼Œè§Vue.component ä¸€äº›ç‰¹æ®Šåœºæ™¯ ä¾‹å¦‚åœ¨æŒ‡ä»¤ä¸­ä½¿ç”¨Vue.extendåˆ›å»ºä¸€ä¸ªvueå®ä¾‹ï¼Œå¹¶ç”¨$mountæŒ‚è½½åˆ°domä¸­1234567891011import BaseLoadingSpinner from 'Base/BaseLoadingSpinner'const ExtendLoading = Vue.extend(&#123; components: &#123; BaseLoadingSpinner &#125;, template: '&lt;div style="text-align:center;font-size:20px;"&gt;&lt;BaseLoadingSpinner/&gt;&lt;/div&gt;'&#125;)const MyLoading = new ExtendLoading().$mount()document.body.appendChild(MyLoading.$el) Vue.component æ³¨å†Œ\æŸ¥è¯¢å…¨å±€ç»„ä»¶ å†…éƒ¨å€ŸåŠ©Vue.extendæ¥å®ç°12345Vue.component('global-component', Vue.extend(baseOptions));//ä¼ å…¥ä¸€ä¸ªé€‰é¡¹å¯¹è±¡ï¼ˆè‡ªåŠ¨è°ƒç”¨ Vue.extendï¼‰,ç­‰ä»·äºä¸Šè¡Œä»£ç .Vue.component('global-component', baseOptions);// è·å–æ³¨å†Œçš„ç»„ä»¶ï¼ˆå§‹ç»ˆè¿”å›æ„é€ å™¨ï¼‰var MyComponent = Vue.component('my-component') vm.mixins Vueå®ä¾‹(ç»„ä»¶)ä¸Šçš„æ–¹æ³•ï¼Œä¸»è¦åˆ©ç”¨æ··å…¥æ¥æ‰©å±•ç»„ä»¶çš„åŠŸèƒ½ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªæ··å…¥å¯¹è±¡çš„æ•°ç»„ æ··å…¥å¯¹è±¡æ˜¯ä¸€ä¸ªVueé€‰é¡¹å¯¹è±¡ï¼ŒVueæ„é€ å™¨èƒ½ä½¿ç”¨çš„é€‰é¡¹ï¼Œæ··å…¥å¯¹è±¡éƒ½å¯ä»¥ä½¿ç”¨ å¦‚æœæ··å…¥å¯¹è±¡å’Œç»„ä»¶åŸæœ‰é€‰é¡¹å‡ºç°åŒåé€‰é¡¹å¦‚ä½•å¤„ç†ï¼Ÿ ç”Ÿå‘½å‘¨æœŸhookåŠwatch åŒåçš„ç”Ÿå‘½å‘¨æœŸhookï¼Œå°†æŒ‰ç…§minxinsä¼ å…¥é¡ºåºä¾æ¬¡è°ƒç”¨ ä¸åŒåçš„ç”Ÿå‘½å‘¨æœŸhookï¼Œå°†æŒ‰ç…§åŸå…ˆçš„ç”Ÿå‘½å‘¨æœŸé¡ºåºè°ƒç”¨ åŒåçš„watchå’Œç”Ÿå‘½å‘¨æœŸhookçš„å¤„ç†æ–¹å¼ç›¸åŒï¼Œä¹Ÿæ˜¯æŒ‰ç…§minxinsä¼ å…¥é¡ºåºä¾æ¬¡è°ƒç”¨ éç”Ÿå‘½å‘¨æœŸhookåŠwatchçš„é€‰é¡¹å­—æ®µ åŒåçš„ï¼Œéƒ½ä»¥å½“å‰ç»„ä»¶ä¸ºä¸»(è¦†ç›–æ··å…¥å¯¹è±¡çš„å­—æ®µ) éåŒåçš„ï¼Œåˆå¹¶12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182const mixin1 = &#123;data() &#123; return &#123; text: 'mixin1', test: &#123; source: 'from mixin1' &#125; &#125;&#125;,computed: &#123; computedText() &#123; return `I am $&#123;this.text&#125;` &#125;&#125;,created() &#123; console.log('mixin1 text', this.text) console.log('mixin1 computedText', this.computedText) console.log('mixin1 test', this.test) &#125;&#125;const mixin2 = &#123; data() &#123; return &#123; text: 'mixin2', test: &#123; source: 'from mixin2' &#125; &#125;&#125;,computed: &#123; computedText() &#123; return `I am $&#123;this.text&#125;` &#125;&#125;,created() &#123; console.log('mixin2 text', this.text) console.log('mixin2 computedText', this.computedText) console.log('mixin2 test', this.test)&#125;,mounted() &#123; console.log('mixin2 mounted') &#125;&#125;const compa = &#123; name: 'CompA', // mixins: [mixin1], mixins: [mixin1, mixin2], // extends: mixin2, data() &#123; return &#123; text: 'compa', test: &#123; source: 'from compa', own: 'compa' &#125; &#125; &#125;, computed: &#123; computedText() &#123; return `I am $&#123;this.text&#125;` &#125; &#125;, created() &#123; console.log('compa text', this.text) console.log('compa computedText', this.computedText) console.log('compa test', this.test) &#125;, render: h =&gt; h('div', 'compa')&#125;const App = &#123; name: 'App', render: h =&gt; h(compa)&#125;const baseOptions = &#123; el: '#app', render: h =&gt; h(App)&#125;new Vue(baseOptions) å¯ä»¥çœ‹åˆ°ï¼ŒåŒåçš„createdé’©å­ï¼ŒæŒ‰ç…§ä¼ å…¥é¡ºåºä¾æ¬¡è°ƒç”¨ï¼Œcompaçš„mountedé’©å­åœ¨æ‰€æœ‰çš„createdæ‰§è¡Œå®Œåå†æ‰§è¡Œçš„ï¼›åŒåçš„éhookã€watchçš„é€‰é¡¹ï¼Œå¦‚dataã€computedéƒ½ä¼˜å…ˆä½¿ç”¨å½“å‰ç»„ä»¶çš„ï¼Œæ‰€ä»¥æœ€ç»ˆownã€sourceéƒ½æ˜¯compaä¸­å®šä¹‰ vm.extends ä½œç”¨åŸºæœ¬å’Œmixinsç±»ä¼¼ï¼Œéƒ½ç”¨æ¥æ‰©å……ç»„ä»¶åŠŸèƒ½ï¼Œä½†æœ‰ç»†å¾®å´åˆ« åŒºåˆ« mixinsæ˜¯å°†ä¸€ä¸ªä¸ªç‹¬ç«‹çš„åŠŸèƒ½æ‰©å……åˆ°å½“å‰ç»„ä»¶ä¸Šï¼Œç›¸å½“äºä¸ºå½“å‰ç»„ä»¶æ·»åŠ æŸç§èƒ½åŠ›ï¼Œå…ˆæœ‰åŠŸèƒ½ï¼Œå†å°†åŠŸèƒ½æ·»åŠ åˆ°å½“å‰ç»„ä»¶ä¸Šï¼›åˆ©ç”¨çš„æ˜¯ç»„åˆæ€æƒ³ vm.extendsæ˜¯ç»§æ‰¿ä¸€ä¸ªç»„ä»¶ï¼Œå¹¶åœ¨å…¶ä¹‹ä¸Šå†æ·»åŠ åŠŸèƒ½ï¼Œç›¸å½“äºæ‰©å……ä¸€ä¸ªå·²æœ‰ç»„ä»¶çš„åŠŸèƒ½ï¼›åˆ©ç”¨çš„æ˜¯ç»§æ‰¿æ€æƒ³ mixinsæ¥æ”¶ä¸€ä¸ªæ•°ç»„ï¼Œextendsæ¥æ”¶ä¸€ä¸ªç»„ä»¶ æ—¢ç„¶æ˜¯ç»§æ‰¿ï¼Œè‚¯å®šä¼šå‡ºç°åŒåå†²çªçš„æƒ…å†µï¼Œå…¶å¤„ç†ç­–ç•¥å’Œvm.mixinsé€‰é¡¹åˆå¹¶ç­–ç•¥ä¸€æ ·ï¼›å…¶å®Vue.extendã€vm.mixinsã€vm.extendsä»–ä»¬çš„é€‰é¡¹åˆå¹¶ç­–ç•¥éƒ½æ˜¯ä¸€æ ·çš„ï¼› é€‰é¡¹åˆå¹¶ç­–ç•¥ vueä¸­é€‰é¡¹åˆå¹¶çš„ç­–ç•¥ï¼Œä¸»è¦ç”¨åœ¨Vue.extendã€vm.mixinsã€vm.extendsç­‰éœ€è¦åˆå¹¶é€‰é¡¹å¯¹è±¡çš„åœ°æ–¹ vueç‰ˆæœ¬2.5.21 å‰ç½®çŸ¥è¯†é»˜è®¤åˆå¹¶ç­–ç•¥123456789101112131415 // src\core\util\options.js /*** Default strategy.* é»˜è®¤ç­–ç•¥* åªæœ‰åœ¨å­é€‰é¡¹æ²¡ä¼ æ—¶æ‰ä½¿ç”¨`parentVal`ï¼Œå¦åˆ™éƒ½ä½¿ç”¨`childVal`*/const defaultStrat = function (parentVal: any, childVal: any): any &#123; return childVal === undefined ? parentVal : childVal&#125;defaultStrat(&#123;name:'parentVal'&#125;,&#123;name:'childVal'&#125;) // &#123;name:'childVal&#125;defaultStrat(&#123;name:'parentVal'&#125;) // &#123;name:'parentVal&#125; parentValå¯¹åº”çˆ¶é€‰é¡¹ï¼ŒchildValå¯¹åº”å­é€‰é¡¹ï¼Œåªæœ‰åœ¨å­é€‰é¡¹æ²¡ä¼ æ—¶æ‰ä½¿ç”¨parentValï¼Œå¦åˆ™éƒ½ä½¿ç”¨childVal é’ˆå¯¹ä¸åŒçš„é€‰é¡¹å­—æ®µï¼Œvueæœ‰ä¸åŒçš„åˆå¹¶ç­–ç•¥ çˆ¶ã€å­é€‰é¡¹å¯¹è±¡å¦‚ä½•ç•Œå®š ä½¿ç”¨vm.mixinsæ—¶ æ··å…¥å¯¹è±¡ä¸ºçˆ¶é€‰é¡¹å¯¹è±¡ã€å½“å‰ç»„ä»¶(vm)é€‰é¡¹ä¸ºå­é€‰é¡¹å¯¹è±¡123Vue.component('A',&#123; // Aè§†ä¸ºå­é€‰é¡¹å¯¹è±¡ mixins:[B] // Bè§†ä¸ºçˆ¶é€‰é¡¹å¯¹è±¡&#125;) ä½¿ç”¨vm.extendsæ—¶ ç»§æ‰¿çš„ç»„ä»¶é€‰é¡¹ä¸ºçˆ¶é€‰é¡¹å¯¹è±¡ï¼Œå½“å‰ç»„ä»¶(vm)é€‰é¡¹ä¸ºå­é€‰é¡¹å¯¹è±¡123Vue.component('A',&#123; // Aè§†ä¸ºå­é€‰é¡¹å¯¹è±¡ extends:B // Bè§†ä¸ºçˆ¶é€‰é¡¹å¯¹è±¡&#125;) ä½¿ç”¨Vue.extendæ—¶ Vue.extendæ¥æ”¶çš„é€‰é¡¹å¯¹è±¡ä¸ºå­é€‰é¡¹å¯¹è±¡ï¼ŒVueé»˜è®¤é€‰é¡¹å¯¹è±¡ä¸ºçˆ¶é€‰é¡¹å¯¹è±¡1Vue.extend(B) // Bè§†ä¸ºå­é€‰é¡¹å¯¹è±¡ï¼ŒVueé»˜è®¤é€‰é¡¹å¯¹è±¡ä¸ºçˆ¶é€‰é¡¹å¯¹è±¡ é€’å½’åˆå¹¶å¯¹è±¡1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950// src\core\util\options.js/*** Helper that recursively merges two data objects together.* åˆå¹¶è§„åˆ™ï¼š * 1. å¦‚æœfromä¸­çš„æŸä¸ªå±æ€§toä¸­æœ‰ï¼Œä¿ç•™toä¸­çš„ï¼Œä»€ä¹ˆéƒ½ä¸åšã€‚ * 2. å¦‚æœtoä¸­æ²¡æœ‰ï¼Œèµ‹å€¼ã€‚ * 3. å¦‚æœtoä¸­å’Œfromä¸­çš„æŸä¸ªå±æ€§å€¼éƒ½æ˜¯å¯¹è±¡ï¼Œé€’å½’è°ƒç”¨ã€‚*/function mergeData (to: Object, from: ?Object): Object &#123; if (!from) return to let key, toVal, fromVal const keys = Object.keys(from) for (let i = 0; i &lt; keys.length; i++) &#123; key = keys[i] toVal = to[key] fromVal = from[key] if (!hasOwn(to, key)) &#123; set(to, key, fromVal) &#125; else if ( toVal !== fromVal &amp;&amp; isPlainObject(toVal) &amp;&amp; isPlainObject(fromVal) ) &#123; mergeData(toVal, fromVal) &#125; &#125; return to&#125;mergeData(&#123; name:'parentVal', testObj:&#123; a:3 &#125;&#125;,&#123; name:'childVal', test:'childTest', testObj:&#123; a:4 , b:5 &#125;&#125;) // &#123;// name:'parentVal',// test:'childTest',// testObj:&#123;// a:3,// b:5// &#125;&#125; æ··å…¥å±æ€§åˆ°ç›®æ ‡å¯¹è±¡ä¸­12345678910111213// src\shared\util.js/*** Mix properties into target object.* toã€fromæœ‰ç›¸åŒkeyæ—¶ï¼Œä¼šè¦†ç›–to*/export function extend (to: Object, _from: ?Object): Object &#123; for (const key in _from) &#123; to[key] = _from[key] &#125; return to&#125;extend(&#123;name:'parentVal'&#125;,&#123;name:'childVal'&#125;) // &#123;name:'childVal'&#125; elã€propsDataåˆå¹¶ç­–ç•¥ ä½¿ç”¨é»˜è®¤åˆå¹¶ç­–ç•¥(childé€‰é¡¹æ²¡ä¼ æ—¶æ‰ä½¿ç”¨parenté€‰é¡¹ï¼Œå¦åˆ™éƒ½ç”¨childé€‰é¡¹) å­é€‰é¡¹å¯¹è±¡ä¼˜å…ˆ1234567891011121314151617// src\core\util\options.js/*** Options with restrictions*/if (process.env.NODE_ENV !== 'production') &#123; strats.el = strats.propsData = function (parent, child, vm, key) &#123; if (!vm) &#123; warn( `option "$&#123;key&#125;" can only be used during instance ` + 'creation with the `new` keyword.' ) &#125; // ä½¿ç”¨é»˜è®¤åˆå¹¶ç­–ç•¥(childæ²¡ä¼ æ—¶æ‰ä½¿ç”¨parentï¼Œå¦åˆ™éƒ½ç”¨child) return defaultStrat(parent, child) &#125;&#125; dataåˆå¹¶ç­–ç•¥ ç”±äºdataåœ¨ç»„ä»¶ä¸­æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œæ‰€ä»¥ä¼šå…ˆè°ƒç”¨ï¼Œç„¶åé€šè¿‡mergeDataå°†çˆ¶é€‰é¡¹å¯¹è±¡é€’å½’åˆå¹¶åˆ°å­é€‰é¡¹å¯¹è±¡ä¸­12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849// src\core\util\options.js/*** Data*/export function mergeDataOrFn ( parentVal: any, childVal: any, vm?: Component ): ?Function &#123; if (!vm) &#123; // in a Vue.extend merge, both should be functions if (!childVal) &#123; return parentVal &#125; if (!parentVal) &#123; return childVal &#125; // when parentVal &amp; childVal are both present, // we need to return a function that returns the // merged result of both functions... no need to // check if parentVal is a function here because // it has to be a function to pass previous merges. return function mergedDataFn () &#123; // é€’å½’åˆå¹¶é€‰é¡¹å¯¹è±¡ï¼ˆå°†parentValé€’å½’åˆå¹¶åˆ°childValä¸­ï¼‰ return mergeData( typeof childVal === 'function' ? childVal.call(this, this) : childVal, typeof parentVal === 'function' ? parentVal.call(this, this) : parentVal ) &#125; &#125; else &#123; return function mergedInstanceDataFn () &#123; // instance merge const instanceData = typeof childVal === 'function' ? childVal.call(vm, vm) : childVal const defaultData = typeof parentVal === 'function' ? parentVal.call(vm, vm) : parentVal if (instanceData) &#123; // é€’å½’åˆå¹¶é€‰é¡¹å¯¹è±¡ï¼ˆå°†defaultDataé€’å½’åˆå¹¶åˆ°instanceDataä¸­ï¼‰ return mergeData(instanceData, defaultData) &#125; else &#123; return defaultData &#125; &#125; &#125;&#125; componentsã€directivesã€filtersåˆå¹¶ç­–ç•¥ è¿™ä¸‰ä¸ªè¢«vueè§†ä¸ºASSET ä½¿ç”¨åŸå‹å§”æ‰˜å°†æœ€ç»ˆé€‰é¡¹å¯¹è±¡çš„__proto__æŒ‡å‘äº†çˆ¶é€‰é¡¹å¯¹è±¡ï¼Œå¹¶è°ƒç”¨extendå‡½æ•°å°†å­é€‰é¡¹å¯¹è±¡çš„æ‰€æœ‰å±æ€§æ··å…¥åˆ°æœ€ç»ˆé€‰é¡¹å¯¹è±¡ï¼Œæœ€ç»ˆæ•ˆæœå°±æ˜¯ï¼Œå­é€‰é¡¹å¯¹è±¡ä¸­æ‰¾ä¸åˆ°æ—¶ï¼Œä¼šé¡ºç€åŸå‹é“¾æ‰¾åˆ°çˆ¶é€‰é¡¹å¯¹è±¡ï¼Œç»“æœæ˜¯å­é€‰é¡¹å¯¹è±¡çš„å­—æ®µä¼šä¼˜å…ˆè¢«ä½¿ç”¨123456789101112131415161718192021222324252627282930// src\shared\constants.jsexport const ASSET_TYPES = [ 'component', 'directive', 'filter']// src\core\util\options.js/*** Assets** When a vm is present (instance creation), we need to do* a three-way merge between constructor options, instance* options and parent options.*/function mergeAssets (parentVal: ?Object,childVal: ?Object,vm?: Component,key: string): Object &#123; const res = Object.create(parentVal || null) // res.__proto__æŒ‡å‘parentVal if (childVal) &#123; process.env.NODE_ENV !== 'production' &amp;&amp; assertObjectType(key, childVal, vm) return extend(res, childVal) // å°†å­é€‰é¡¹å¯¹è±¡æ‰€æœ‰å±æ€§æ··å…¥åˆ°res &#125; else &#123; return res &#125;&#125; propsã€methodsã€injectã€computedåˆå¹¶ç­–ç•¥ å…ˆè°ƒç”¨extendå°†çˆ¶é€‰é¡¹å¯¹è±¡æ‰€æœ‰å±æ€§æ··å…¥åˆ°ç©ºå¯¹è±¡objä¸Šï¼Œå†è°ƒç”¨extendå°†å­é€‰é¡¹å¯¹è±¡æ‰€æœ‰å±æ€§æ··å…¥åˆ°objä¸Šï¼›æœ€ç»ˆè¿˜æ˜¯å­é€‰é¡¹å¯¹è±¡çš„å­—æ®µä¼šè¢«ä¼˜å…ˆä½¿ç”¨1234567891011121314151617181920212223242526/*** Other object hashes.*/strats.props =strats.methods =strats.inject =strats.computed = function (parentVal: ?Object,childVal: ?Object,vm?: Component,key: string): ?Object &#123; if (childVal &amp;&amp; process.env.NODE_ENV !== 'production') &#123; assertObjectType(key, childVal, vm) &#125; if (!parentVal) return childVal const ret = Object.create(null) // ç©ºå¯¹è±¡ extend(ret, parentVal) // å…ˆæ··å…¥parentValæ‰€æœ‰å±æ€§ if (childVal) extend(ret, childVal) // å†æ··å…¥childValæ‰€æœ‰å±æ€§ï¼Œå½“childValå’ŒparentValå‡ºç°åŒåå±æ€§æ—¶ï¼Œå°†è¦†ç›–parentVal return ret&#125; provideåˆå¹¶ç­–ç•¥ å…¶å’Œdataåˆå¹¶ç­–ç•¥æ˜¯ä¸€æ ·çš„ å®ƒä½¿ç”¨dataåˆå¹¶ç­–ç•¥ä¸­çš„mergeDataOrFnæ–¹æ³•æ¥åˆå¹¶1strats.provide = mergeDataOrFn ç”Ÿå‘½å‘¨æœŸhook åŒåçš„ç”Ÿå‘½å‘¨æœŸhookï¼Œä¼šåˆå¹¶åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œå¹¶ä¸”çˆ¶é€‰é¡¹å¯¹è±¡çš„hookä¼šå…ˆæ‰§è¡Œï¼› ä¸åŒåçš„ç”Ÿå‘½å‘¨æœŸhookï¼Œä¼šæŒ‰ç…§ç”Ÿå‘½å‘¨æœŸï¼Œä¾æ¬¡è°ƒç”¨123456789101112131415161718192021// src\core\util\options.js/*** Hooks and props are merged as arrays.*/function mergeHook (parentVal: ?Array&lt;Function&gt;,childVal: ?Function | ?Array&lt;Function&gt;): ?Array&lt;Function&gt; &#123; return childVal ? parentVal ? parentVal.concat(childVal) // çˆ¶å­é€‰é¡¹å¯¹è±¡éƒ½å­˜åœ¨ï¼Œåˆ™ç›´æ¥åˆå¹¶åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ : Array.isArray(childVal) ? childVal : [childVal] : parentVal&#125;LIFECYCLE_HOOKS.forEach(hook =&gt; &#123; strats[hook] = mergeHook&#125;) watchåˆå¹¶ç­–ç•¥ å…¶åˆå¹¶ç­–ç•¥å’Œç”Ÿå‘½å‘¨æœŸhookç±»ä¼¼ï¼›çˆ¶å­é€‰é¡¹å¯¹è±¡çš„watchä¼šåˆå¹¶åˆ°åŒä¸€ä¸ªæ•°ç»„ä¸­ï¼Œå¹¶ä¸”çˆ¶é€‰é¡¹çš„watchåœ¨å‰12345678910111213141516171819202122232425262728293031323334353637383940// src\core\util\options.js/*** Watchers.** Watchers hashes should not overwrite one* another, so we merge them as arrays.*/strats.watch = function (parentVal: ?Object,childVal: ?Object,vm?: Component,key: string): ?Object &#123; // work around Firefox's Object.prototype.watch... if (parentVal === nativeWatch) parentVal = undefined if (childVal === nativeWatch) childVal = undefined /* istanbul ignore if */ if (!childVal) return Object.create(parentVal || null) if (process.env.NODE_ENV !== 'production') &#123; assertObjectType(key, childVal, vm) &#125; if (!parentVal) return childVal const ret = &#123;&#125; extend(ret, parentVal) // æ··å…¥çˆ¶é€‰é¡¹å¯¹è±¡æ‰€æœ‰å±æ€§ for (const key in childVal) &#123; let parent = ret[key] const child = childVal[key] if (parent &amp;&amp; !Array.isArray(parent)) &#123; parent = [parent] &#125; ret[key] = parent ? parent.concat(child) // åˆå¹¶åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ : Array.isArray(child) ? child : [child] &#125; return ret&#125; å½“åŒæ—¶ä½¿ç”¨Vue.extendã€vm.extendsã€vm.mixinsæ—¶é€‰é¡¹å¦‚ä½•åˆå¹¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123const mixin1 = &#123; data() &#123; return &#123; text: 'mixin1', test: &#123; source: 'from mixin1' &#125; &#125; &#125;, computed: &#123; computedText() &#123; return `I am $&#123;this.text&#125;` &#125; &#125;, created() &#123; console.log('mixin1 text', this.text) console.log('mixin1 computedText', this.computedText) console.log('mixin1 test', this.test) &#125;&#125;const mixin2 = &#123; data() &#123; return &#123; text: 'mixin2', test: &#123; source: 'from mixin2' &#125; &#125; &#125;, computed: &#123; computedText() &#123; return `I am $&#123;this.text&#125;` &#125; &#125;, created() &#123; console.log('mixin2 text', this.text) console.log('mixin2 computedText', this.computedText) console.log('mixin2 test', this.test) &#125;, mounted() &#123; console.log('mixin2 mounted') &#125;&#125;const compb = &#123;name: 'CompB',data() &#123; return &#123; text: 'compb', test: &#123; source: 'from compb' &#125; &#125;&#125;,computed: &#123; computedText() &#123; return `I am $&#123;this.text&#125;` &#125;&#125;,created() &#123; console.log('compb text', this.text) console.log('compb computedText', this.computedText) console.log('compb test', this.test)&#125;,render: h =&gt; h('div', 'compb')&#125;const compc = &#123;name: 'CompC',data() &#123; return &#123; text: 'compc', test: &#123; source: 'from compc' &#125; &#125;&#125;,computed: &#123; computedText() &#123; return `I am $&#123;this.text&#125;` &#125;&#125;,created() &#123; console.log('compc text', this.text) console.log('compc computedText', this.computedText) console.log('compc test', this.test)&#125;,render: h =&gt; h('div', 'compc')&#125;const compa = &#123; name: 'CompA', // mixins: [mixin1], mixins: [mixin1, mixin2], extends: compb, data() &#123; return &#123; text: 'compa', test: &#123; source: 'from compa', own: 'compa' &#125; &#125; &#125;, computed: &#123; computedText() &#123; return `I am $&#123;this.text&#125;` &#125; &#125;, created() &#123; console.log('compa text', this.text) console.log('compa computedText', this.computedText) console.log('compa test', this.test) &#125;, render: h =&gt; h('div', 'compa')&#125; const ExtendC = Vue.extend(compc) const ExtendCA = ExtendC.extend(compa) new ExtendCA().$mount('#app') ä¼šçœ‹åˆ°createdé’©å­è¢«è°ƒç”¨çš„é¡ºåºä¾æ¬¡ä¸ºcompcã€compbã€mixin1ã€mixin2ã€compa dataéƒ½ä¸ºcompa æ€»ç»“ extendã€extendsã€mixinsåŒæ—¶ä½¿ç”¨æ—¶ hookåŠwatchçš„æ‰§è¡Œé¡ºåº:extend&gt;extends&gt;mixins&gt;å½“å‰ç»„ä»¶ éhookåŠwatchä¼šä½¿ç”¨å½“å‰ç»„ä»¶çš„å€¼ æ€»ç»“ Vue.extendã€vm.extendsã€vm.mixinsä½¿ç”¨ç›¸åŒçš„é€‰é¡¹åˆå¹¶ç­–ç•¥ æœªå‡ºç°åŒåé€‰é¡¹æ—¶ï¼Œä¼šä½¿ç”¨ç±»ä¼¼Object.assignçš„æœºåˆ¶æ¥åˆå¹¶é€‰é¡¹ const newOption=Object.assign({},parentVal,childVal) å‡ºç°åŒåé€‰é¡¹æ—¶ hookã€watché€‰é¡¹å‡ºç°åŒåæ—¶ï¼Œä¼šå°†å…¶åˆå¹¶åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œå¹¶ä¸”çˆ¶é€‰é¡¹å¯¹è±¡çš„å…ˆæ‰§è¡Œ éhookã€watché€‰é¡¹å‡ºç°åŒåæ—¶ï¼Œä¼˜å…ˆä½¿ç”¨å­é€‰é¡¹å¯¹è±¡çš„å€¼ åŒæ—¶ä½¿ç”¨Vue.extendã€vm.extendsã€vm.mixinsæ—¶ æœªå‡ºç°åŒåé€‰é¡¹æ—¶ï¼Œä¼šä½¿ç”¨ç±»ä¼¼Object.assignçš„æœºåˆ¶æ¥åˆå¹¶é€‰é¡¹ å‡ºç°åŒåé€‰é¡¹æ—¶ hookåŠwatchçš„æ‰§è¡Œé¡ºåº:extend&gt;extends&gt;mixins&gt;å½“å‰ç»„ä»¶ éhookåŠwatchä¼šä½¿ç”¨å½“å‰ç»„ä»¶çš„å€¼ å‚è€ƒ https://segmentfault.com/a/1190000010095089https://segmentfault.com/a/1190000007087912]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[git-commit-message]]></title>
    <url>%2F2019%2F10%2F16%2Fgit-commit-message%2F</url>
    <content type="text"><![CDATA[gitæäº¤è§„èŒƒCommit Messageè§„èŒƒ ç¤¾åŒºæ¨è Conventional Commits æ­¤æäº¤é£æ ¼æœ€åˆç”¨angularï¼Œåæ¥ç‹¬ç«‹å¼€å‘æˆä¸€ä¸ªè§„èŒƒ å¾ˆå¤šå¼€æºé¡¹ç›®ä½¿ç”¨æ­¤æäº¤é£æ ¼ï¼Œå¦‚vue Conventional Commitsä»‹ç»12345&lt;type&gt;([optional scope]): &lt;description&gt;// ç©ºä¸€è¡Œ[optional body]// ç©ºä¸€è¡Œ[optional footer(s)] åŒ…å«headerã€bodyã€footer headerå¿…å¡« bodyã€footerå¯çœç•¥ headeråŒ…å«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ† type æäº¤ç±»å‹ å¿…å¡« æœ‰ä»¥ä¸‹æšä¸¾å€¼ feat æ–°åŠŸèƒ½ã€æ–°ç‰¹æ€§(feature) fix ä¿®è¡¥bug docs æ–‡æ¡£(documentation) style æ ¼å¼(ä¸å½±å“ä»£ç è¿è¡Œçš„å˜åŠ¨) refactor é‡æ„(å³ä¸æ˜¯æ–°å¢åŠŸèƒ½ï¼Œä¹Ÿä¸æ˜¯ä¿®æ”¹bugçš„ä»£ç å˜åŠ¨) test å¢åŠ æµ‹è¯• chore æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨ scope æ­¤æ¬¡commitå½±å“çš„èŒƒå›´ éå¿…å¡« ä¸€èˆ¬æ˜¯åè¯ description commitçš„ç®€çŸ­æè¿° body æ­¤æ¬¡commitçš„è¯¦ç»†æè¿° ä½¿ç”¨ç¬¬ä¸€äººç§° è¯´æ˜æ”¹åŠ¨çš„åŠ¨æœºï¼Œæ”¹åŠ¨å‰åçš„å¯¹æ¯” footer é€‚ç”¨äºä»¥ä¸‹æƒ…å†µ å­˜åœ¨ä¸å…¼å®¹å˜åŠ¨æ—¶ footeréƒ¨åˆ†è¦ä»¥BREAKING CHANGEå¼€å¤´ å…³é—­issue åœ¨footeréƒ¨åˆ†æŒ‡æ˜å…³é—­å“ªä¸ªissue å·¥å…· commitizencli ç±»ä¼¼postcssã€babelæ˜¯ä¸€ä¸ªé€šç”¨å·¥å…·ï¼Œé€šè¿‡æ’ä»¶æ”¯æŒå„ç§é£æ ¼çš„äº’åŠ¨æäº¤ cz-conventional-changelogåŒ… ä¸€ä¸ªcommitizen adapterï¼Œç”¨ä»¥æ”¯æŒConventional Commitsæäº¤é£æ ¼ @commitlint/cli @commitlint/config-conventional husky è¿™3ä¸ªåŒ…æ˜¯ç”¨æ¥åœ¨æäº¤æ—¶ï¼Œå¯¹æäº¤messageåšlintç”¨ commitizenå®‰è£… æœ¬åœ°å®‰è£…commitizen 1npm i -D commitizen å› ä¸ºæœ¬åœ°å®‰è£…commitizenï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨ä¸‹é¢å‘½ä»¤(npm&gt;=5.2)åˆå§‹åŒ–å®‰è£…cz-conventional-changelog 1npx commitizen init cz-conventional-changelog --save-dev --save-exact npm&lt;5.2ç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢å‘½ä»¤æ¥å®‰è£… 1./node_modules/.bin/commitizen init cz-conventional-changelog --save-dev --save-exact è‹¥å…¨å±€å®‰è£…äº†commitizenï¼Œåˆ™åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­ä½¿ç”¨ä¸‹é¢å‘½ä»¤å®‰è£…cz-conventional-changelog 1commitizen init cz-conventional-changelog --save-dev --save-exact ç»è¿‡ä»¥ä¸Šæ­¥éª¤åï¼Œæ•´ä¸ªé¡¹ç›®å°±æ˜¯Commitizen-friendly ä¼šè‡ªåŠ¨åœ¨package.jsonä¸­æ·»åŠ ä¸‹é¢å­—æ®µï¼Œç”¨äºå‘Šè¯‰commitizenï¼Œæˆ‘ä»¬å¸Œæœ›è´¡çŒ®è€…ä½¿ç”¨å“ªä¸ªadapter(cz-conventional-changelog)æ¥æäº¤commit12345&quot;config&quot;: &#123; &quot;commitizen&quot;: &#123; &quot;path&quot;: &quot;path/to/cz-conventional-changelog&quot; &#125; &#125; package.jsonä¸­æ·»åŠ ä»¥ä¸‹script 123 &quot;scripts&quot;: &#123; &quot;commit&quot;: &quot;git-cz&quot; &#125; npm run commitå°†ä¼šå‡ºç°äº¤äº’ç•Œé¢ vs code ç”¨æˆ·ä¹Ÿå¯ä»¥ç”¨vscode-commitizenæ’ä»¶æ¥æäº¤ commit-lintå®‰è£… å®‰è£… 1npm i -D @commitlint/cli @commitlint/config-conventional husky é…ç½®commitlint 12345 // é¡¹ç›®æ ¹ç›®å½•æ–°å»º commitlint.config.jsåŒ…å«ä»¥ä¸‹å†…å®¹ module.exports = &#123; extends: [&apos;@commitlint/config-conventional&apos;]&#125; é…ç½®package.json 1234567 &#123; &quot;husky&quot;: &#123; &quot;hooks&quot;: &#123; &quot;commit-msg&quot;: &quot;commitlint -E HUSKY_GIT_PARAMS&quot; &#125; &#125;,&#125; è¿™æ ·åœ¨æ¯æ¬¡æäº¤commitæ—¶éƒ½ä¼šé’ˆå¯¹æäº¤é£æ ¼åšlint ä½¿ç”¨stand-versionåšå‘åŒ…ç‰ˆæœ¬æ§åˆ¶ è‡ªåŠ¨ç”ŸæˆCHANGELOG12345678910111213// package.json "scripts": &#123; "release": "standard-version", &#125;// åˆæ¬¡å‘å¸ƒç‰ˆæœ¬npm run release --first-release// æ·»åŠ ç‰ˆæœ¬ä¿¡æ¯å’ŒæŒ‡å®šå‘å¸ƒç‰ˆæœ¬ç­‰çº§npm run release -m "Commit message" -r minor// ç¡®è®¤å‘å¸ƒï¼Œnpm publish å‘å¸ƒåˆ° npmgit push --follow-tags origin master å‚è€ƒhttps://segmentfault.com/a/1190000015376832 é¡¹ç›®åœ°å€ vue-awesome-template å‚è€ƒ https://github.com/commitizen/cz-cli http://www.ruanyifeng.com/blog/2016/01/commit_message_change_log.html https://segmentfault.com/a/1190000016503661]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>git</tag>
        <tag>commit message</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[npm-publish-flow]]></title>
    <url>%2F2019%2F10%2F16%2Fnpm-publish-flow%2F</url>
    <content type="text"><![CDATA[npm å‘åŒ…æµç¨‹æ€»ç»“æ³¨å†Œnpmè´¦å· https://www.npmjs.com/signup package.jsonä¸­æŒ‡æ˜å¿…è¦å­—æ®µ nameã€versionæ˜¯å¿…é¡»çš„ï¼Œç¼ºå¤±å°†æ— æ³•å‘å¸ƒ mainæŒ‡å‘å…¥å£æ–‡ä»¶ï¼Œä¸€èˆ¬ä¸ºcommonjsã€esmæ ¼å¼ moduleæŒ‡å‘esmæ ¼å¼å…¥å£æ–‡ä»¶ unpkgå­—æ®µ å‘å¸ƒåˆ°npmjs.comä¸­çš„åŒ…ä¼šè‡ªåŠ¨åŒæ­¥åˆ°unpkg.comä¸Š é€šè¿‡unpkgå­—æ®µæŒ‡æ˜unpkg.comåº”è¯¥å¦‚ä½•æŸ¥æ‰¾å…¥å£æ–‡ä»¶ ä¸€èˆ¬ä¸ºumdæ ¼å¼ repository 1234"repository": &#123; "type": "git", "url": "git+https://github.com/BryanAdamss/drawing-board.git" &#125; å‚è€ƒhttps://juejin.im/post/5b231f6ff265da595f0d2540 æ£€æŸ¥åŒ…åæ˜¯å¦é‡å é‡åæ—¶ï¼Œå°†æŠ¥403é”™è¯¯ï¼Œæç¤ºæ²¡æœ‰æƒé™æäº¤åŒ…(ä½ æ²¡æœ‰æƒé™ä¿®æ”¹åˆ«äººçš„åŒ…) 403 Forbidden - PUT http://registry.npmjs.org/react-native-app-info - You do not have permission to publish &quot;react-native-app-info&quot;. Are you logged in as the correct user? npmä¼šä½¿ç”¨package.jsonä¸­çš„nameå­—æ®µåšä¸ºåŒ…å https://www.npmjs.com/ä¸­æœç´¢åŒ…åï¼Œæ£€æŸ¥æ˜¯å¦é‡å æœ‰é‡åï¼Œåˆ™éœ€è¦ä¿®æ”¹åŒ…å ä¿®æ”¹ä¸ºscope packageå³@scope/package-name è¿™ç§åœ¨npm publishæ—¶ä¼šè¢«è‡ªåŠ¨è®¤å®šä¸ºç§æœ‰ä»“åº“ï¼Œç§æœ‰ä»“åº“æ˜¯éœ€è¦ä»˜è´¹çš„ éœ€è¦åœ¨npm publishæ—¶è¿½åŠ --access publicæŒ‡æ˜åŒ…ä¸ºå…¬å¼€è®¿é—® npm publish --access=public æ³¨æ„çš„æ˜¯è¿™ç§å½¢å¼çš„åŒ…åè·Ÿ npm è´¦æˆ·æœ‰å¯¹åº”å…³ç³»ï¼Œä¸èƒ½éšä¾¿å¡«å†™ éœ€è¦åœ¨initæ—¶æŒ‡æ˜scope npm init --scope=@user-name ç›´æ¥ä¿®æ”¹ä¸ºä¸€ä¸ªä¸ä¼šé‡åçš„åŒ…å å‚è€ƒhttps://github.com/XXHolic/segment/issues/28 æ£€æŸ¥ä»“åº“æº å›½å†…ä½¿ç”¨ä¸€èˆ¬éƒ½ä¼šåˆ‡åˆ°æ·˜å®æº(https://registry.npm.taobao.org/)ä¸Šï¼Œåœ¨å‘åŒ…æ—¶ï¼Œéœ€è¦åˆ‡åˆ°npmå®˜æ–¹æº(https://registry.npmjs.org/) npm config lsæŸ¥çœ‹å½“å‰æº è‹¥æºä¸æ­£ç¡®ï¼Œéœ€è¦ä½¿ç”¨npm config set registry https://registry.npmjs.org/åˆ‡æ¢åˆ°å®˜æ–¹æº ç™»å½• ä½¿ç”¨npm loginæˆ–npm adduserå‘½ä»¤ ç„¶åè¾“å…¥è´¦å·ã€å¯†ç ç™»å½• ç™»å½•æˆåŠŸä¼šæç¤º `foo@bar.com Logged in as username on http://registry.npmjs.org/.` å¯é€šè¿‡æç¤ºä¿¡æ¯ï¼Œåˆ¤æ–­æºæ˜¯å¦çœŸç¡® å‘åŒ…publish ç™»å½•åï¼Œç›´æ¥npm publishå³å¯ è®°å¾—publishå‰è¦å…ˆæ„å»ºä¸€æ³¢ ä½¿ç”¨stand-versionåšå‘åŒ…ç‰ˆæœ¬æ§åˆ¶12345678910111213// package.json "scripts": &#123; "release": "standard-version", &#125;// åˆæ¬¡å‘å¸ƒç‰ˆæœ¬npm run release --first-release// æ·»åŠ ç‰ˆæœ¬ä¿¡æ¯å’ŒæŒ‡å®šå‘å¸ƒç‰ˆæœ¬ç­‰çº§npm run release -m "Commit message" -r minor// ç¡®è®¤å‘å¸ƒï¼Œnpm publish å‘å¸ƒåˆ° npmgit push --follow-tags origin master &amp;&amp; npm publish å‚è€ƒhttps://segmentfault.com/a/1190000015376832 å¸¸è§é”™è¯¯ æ— æ³•login- æºä¸å¯¹ 403 åŒ…é‡å ä¿®æ”¹åŒ…å æ²¡æœ‰å‘åŒ…æƒé™ è”ç³»ç®¡ç†å‘˜å¼€é€šæƒé™ åŒ…ç‰ˆæœ¬é‡å¤ æ›´æ–°å‘åŒ…ç‰ˆæœ¬ æºä¸å¯¹ åˆ‡æ¢æº å‘å¸ƒæˆåŠŸåï¼Œä½¿ç”¨æ·˜å®æºæ— æ³•ä¸‹è½½æœ€æ–°åŒ… æ·˜å®æºåŒæ­¥é—®é¢˜ ç­‰å¾…æ·˜å®æºåŒæ­¥åå†ä¸‹è½½ åˆ‡æ¢åˆ°å®˜æ–¹æºä¸‹è½½ å‚è€ƒhttps://www.jianshu.com/p/5ea8e50d628e æ€»ç»“ æ³¨å†Œè´¦å· æ£€æŸ¥package.jsonå¿…è¦å­—æ®µ æ£€æŸ¥é‡å è®¾ç½®å®˜æ–¹æº ç™»å½• å‘å¸ƒ é‡è®¾æ·˜å®æº demo1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&#123; "name": "@bryanadamss/drawing-board", "version": "1.0.1", "description": "canvasç»˜å›¾æ¿ï¼Œæä¾›ç»˜åˆ¶ã€æ’¤é”€ã€æ—‹è½¬ã€ä¸‹è½½ç­‰åŠŸèƒ½", "main": "dist/drawing-board.es.js", "module": "dist/drawing-board.es.js", "unpkg": "dist/drawing-board.umd.js", "scripts": &#123; "setNpmRegistry": "npm config set registry https://registry.npmjs.org/", "setTaoBaoRegistry": "npm config set registry https://registry.npm.taobao.org/", "prepublishOnly": "npm run build &amp;&amp; npm run setNpmRegistry",// å‘å¸ƒå‰æ„å»ºã€è®¾ç½®npmæº "postpublish": "npm run setTaoBaoRegistry",// å‘å¸ƒåï¼Œé‡è®¾ä¸ºæ·˜å®æº "build": "rollup --config rollup.config.js", "release": "standard-version", "release:first": "npm run release --first-release", "publishToNpm": "git push --follow-tags origin master &amp;&amp; npm publish --access=public" &#125;, "repository": &#123; "type": "git", "url": "git+https://github.com/BryanAdamss/drawing-board.git" &#125;, "keywords": [ "canvas", "drawing", "paint" ], "author": "GuangHui", "license": "ISC", "devDependencies": &#123; "@babel/core": "^7.5.5", "@babel/plugin-proposal-class-properties": "^7.5.5", "@babel/preset-env": "^7.5.5", "core-js": "^3.2.1", "rollup": "^1.20.3", "rollup-plugin-babel": "^4.3.3", "rollup-plugin-babel-minify": "^9.0.0", "rollup-plugin-commonjs": "^10.1.0", "rollup-plugin-node-resolve": "^5.2.0", "standard-version": "^7.0.0" &#125;, "bugs": &#123; "url": "https://github.com/BryanAdamss/drawing-board/issues" &#125;, "homepage": "https://github.com/BryanAdamss/drawing-board#readme", "dependencies": &#123;&#125;&#125; é¡¹ç›®é“¾æ¥ https://github.com/BryanAdamss/drawing-board]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>npm</tag>
        <tag>package</tag>
        <tag>publish</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[uml-basic]]></title>
    <url>%2F2019%2F10%2F16%2Fuml-basic%2F</url>
    <content type="text"><![CDATA[å¸¸ç”¨UMLå›¾ç±»å›¾(class) åœºæ™¯ å¯ä»¥ç”¨æ¥æè¿°å‰ç«¯ç»„ä»¶é—´å…³ç³» ä¼ ç»Ÿç±»å›¾ä¹‹é—´çš„å…³ç³» ç»§æ‰¿(Generalization)/æ³›åŒ–(Generalization) é¸Ÿç»§æ‰¿äº†åŠ¨ç‰© å‰ç«¯ä¸€èˆ¬ä½¿ç”¨åœ¨æ˜ç¡®å£°æ˜äº†ç»§æ‰¿å…³ç³»çš„æƒ…å†µä¸‹ Vue.extendsã€class apiçš„extends å®ç°(Realization) ä¸€èˆ¬æ˜¯ç±»å®ç°äº†æŸä¸ªæ¥å£ å¤§é›å®ç°äº†é£ç¿”è¿™ä¸ªæ¥å£ ä¾èµ–(Dependency) åŠ¨ç‰©ä¾èµ–æ°´ã€æ°§æ°” è¡¨ç°åœ¨ä»£ç å±‚é¢ï¼Œä¸ºç±»Bä½œä¸ºå‚æ•°è¢«ç±»Aåœ¨æŸä¸ªmethodæ–¹æ³•ä¸­ä½¿ç”¨ï¼Œå¯ä»¥è¯´ç±»Aä¾èµ–ç±»B ä¾èµ–å…³ç³»æ˜¯å…·æœ‰å¶ç„¶æ€§çš„ã€ä¸´æ—¶æ€§çš„ã€éå¸¸å¼±ï¼Œå› ä¸ºå¯ä»¥éšä¾¿æ”¹å˜å…¥å‚ç±»ï¼Œåªè¦å…¶èƒ½æä¾›éœ€è¦çš„æ•°æ® å‰ç«¯ä¸€èˆ¬ç”¨åœ¨æ–¹æ³•Aè°ƒç”¨æ—¶ï¼ŒBåšä¸ºå‚æ•°ä¼ å…¥ï¼Œåˆ™å¯ä»¥ç§°Aä¾èµ–B å…³è”(Association) ä¼é¹…éœ€è¦çŸ¥é“æ°”å€™æ‰è¿ç§» è¡¨ç°åœ¨ä»£ç å±‚é¢ï¼Œå…³è”ç±»Bä»¥ç±»å±æ€§çš„å½¢å¼å‡ºç°åœ¨å…³è”ç±»Aä¸­ï¼Œä¹Ÿå¯èƒ½æ˜¯å…³è”ç±»Aå¼•ç”¨äº†ä¸€ä¸ªç±»å‹ä¸ºè¢«å…³è”ç±»Bçš„å…¨å±€å˜é‡ï¼›å…³è”çš„ç±»ä¸€èˆ¬æ˜¯å¯¹ç­‰çš„ ä¸€ä¸ªç±»æŒæœ‰äº†å¦å¤–ä¸€ä¸ªç±» èšåˆ(Aggregation) é›ç¾¤å’Œå¤§é›çš„å…³ç³»ï¼Œå…¬å¸å’Œéƒ¨é—¨çš„å…³ç³»ï¼Œæ•´ä½“å’Œéƒ¨åˆ†çš„å…³ç³»ï¼ŒäºŒè€…ç”Ÿå‘½å‘¨æœŸæ²¡æœ‰å…³è”ï¼Œä¸€åªå¤§é›ç¦»å¼€äº†ï¼Œé›ç¾¤å¹¶ä¸ä¼šæ¶ˆå¤±ï¼›ä¸€ä¸ªéƒ¨é—¨æ’¤äº†ï¼Œå¹¶ä¸ä¼šå½±å“å…¬å¸çš„å­˜åœ¨ï¼› äºŒè€…ç”Ÿå‘½å‘¨æœŸç‹¬ç«‹ å‰ç«¯ä¸­ï¼Œè‹¥çˆ¶ç»„ä»¶æ‹¥æœ‰å¤šä¸ªå­ç»„ä»¶ï¼Œå…¶ä¸­æŸä¸ªå­ç»„ä»¶çš„æ¶ˆå¤±å¹¶ä¸ä¼šå½±å“çˆ¶ç»„ä»¶æ—¶ï¼Œåˆ™å¯ä»¥ç§°äºŒè€…æ‹¥æœ‰èšåˆå…³ç³» åˆæˆ/ç»„åˆ(Composition) é¸Ÿå’Œç¿…è†€çš„å…³ç³» é¸Ÿæ²¡äº†ç¿…è†€ä¸èƒ½é£ç¿”ï¼Œç¿…è†€æ²¡äº†é¸Ÿè¿™ä¸ªè½½ä½“ä¹Ÿå°†æ¯«æ— æ„ä¹‰ï¼›äºŒè€…åŒç”Ÿå…±æ­»ï¼Œç”Ÿå‘½å‘¨æœŸç›¸äº’å…³è”ï¼› å‰ç«¯ä¸­ï¼Œçˆ¶å­ç»„ä»¶å¦‚æœç”Ÿå‘½å‘¨æœŸä¸€è‡´å¯ä»¥ç”¨ç»„åˆæ¥è¡¨ç¤ºï¼ŒæŸå­ç»„ä»¶æ¶ˆå¤±ï¼Œä¼šç›´æ¥å¯¼è‡´çˆ¶ç»„ä»¶æ¶ˆå¤± ä¾èµ–ã€å…³è”ã€èšåˆã€åˆæˆè¡¨ç°çš„éƒ½æ˜¯ç±»ä¹‹é—´çš„å…³ç³» å…³ç³»å¼ºå¼±ï¼ˆç”±å¼ºåˆ°å¼±ï¼‰ åˆæˆ(åŒç”Ÿå…±æ­»)&gt;èšåˆ(æ•´ä½“å’Œéƒ¨åˆ†çš„å…³ç³»)&gt;å…³è”(å…³ç³»å¯¹ç­‰)&gt;ä¾èµ–(ä¾èµ–å…³ç³»æ˜¯å…·æœ‰å¶ç„¶æ€§çš„ã€ä¸´æ—¶æ€§çš„ã€éå¸¸å¼±) æ—¶åºå›¾(sequence) æè¿°å¤šç»„ä»¶åä½œå…³ç³» è§’è‰²Actor å¯ä»¥æ˜¯äººã€ç³»ç»Ÿ å¯¹è±¡Object æä¾›æ“ä½œçš„å¯¹è±¡ ç”Ÿå‘½çº¿LifeLine è¡¨ç¤ºå¯¹è±¡çš„å­˜åœ¨æ—¶é—´ æ§åˆ¶ç„¦ç‚¹Focus of Control è¡¨ç¤ºæ—¶é—´æ®µç”¨ï¼Œå¯¹è±¡åœ¨ç›¸åº”æ—¶é—´å†…çš„æ“ä½œï¼Œç”¨å°çŸ©å½¢è¡¨ç¤º æ¶ˆæ¯Message è¡¨ç¤ºå¯¹è±¡ä¹‹é—´ç›¸äº’ä¼ é€’çš„ä¿¡æ¯ æ¶ˆæ¯ç§ç±» åŒæ­¥æ¶ˆæ¯(Synchronous Message) æ¶ˆæ¯çš„å‘é€è€…æŠŠæ¶ˆæ¯ä¼ é€’ç»™æ¥æ”¶è€…åï¼Œç„¶ååœæ­¢è‡ªèº«æ´»åŠ¨ï¼Œç­‰å¾…æ¥æ”¶è€…è¿”å›æ¶ˆæ¯ å¼‚æ­¥æ¶ˆæ¯(Asynchronus Message) æ¶ˆæ¯çš„å‘é€è€…æŠŠæ¶ˆæ¯ä¼ é€’ç»™æ¥æ”¶è€…åï¼Œç„¶åç»§ç»­è‡ªèº«æ´»åŠ¨ï¼Œä¸ç­‰å¾…æ¥æ”¶è€…è¿”å›æ¶ˆæ¯ è¿”å›æ¶ˆæ¯(Return Message) è¡¨ç¤ºæ¶ˆæ¯ä»è¿‡ç¨‹è°ƒç”¨è¿”å› è‡ªå…³è”æ¶ˆæ¯(Self Message) è¡¨ç¤ºæ–¹æ³•çš„è‡ªèº«è°ƒç”¨åŠä¸€ä¸ªå¯¹è±¡çš„ä¸€ä¸ªæ–¹æ³•è°ƒç”¨å¦å¤–ä¸€ä¸ªæ–¹æ³• æ´»åŠ¨å›¾(activity) ç±»ä¼¼æµç¨‹å›¾ æè¿°æµç¨‹ç”¨ ç»„æˆ æ´»åŠ¨çŠ¶æ€Activity å¯æ‹†åˆ†çš„åŠ¨ä½œï¼Œä¾‹å¦‚è¯·å‡ï¼Œè¯·å‡æœ‰å®¡æ‰¹å’Œä¸å®¡æ‰¹ä¸¤ç§ åŠ¨ä½œçŠ¶æ€Action ä¸å¯æ‹†åˆ†çš„åŠ¨ä½œï¼Œä¾‹å¦‚ä¸å®¡æ‰¹ åŠ¨ä½œæµcontrol flow åŠ¨ä½œä¹‹é—´çš„è½¬æ¢ä¸ºåŠ¨ä½œæµï¼Œç”¨ç®­å¤´è¡¨ç¤º å¼€å§‹èŠ‚ç‚¹Initial èµ·ç‚¹ï¼Œåªæœ‰ä¸€ä¸ª ç»“æŸç‚¹Final ç»“æŸç‚¹ï¼Œå¯ä»¥æœ‰å¤šä¸ª åˆ†æ”¯Decision å†³ç­–ç‚¹ï¼Œä¼šäº§ç”Ÿåˆ†æ­§çš„åœ°æ–¹ï¼Œè±å½¢è¡¨ç¤º åˆ†å‰ä¸æ±‡åˆFork and Join ç”¨æ¥åŒæ­¥(æ§åˆ¶æµå…¨éƒ¨å®Œæˆå†æ‰§è¡Œä¸‹ä¸€æ­¥)å¤šä¸ªå¹¶è¡Œçš„æ§åˆ¶æµ æ³³é“Partition åˆ’åˆ†æ´»åŠ¨å›¾ä¸­çš„æ´»åŠ¨ç”¨ å¯ä»¥ç†è§£ä¸ºåˆ†ç»„ æ³¨æ„ æ´»åŠ¨å›¾ç›®çš„åœ¨è¡¨è¾¾æµç¨‹å®Œæ•´æ€§è€Œéæ´»åŠ¨ç»†èŠ‚ æ´»åŠ¨å›¾ä¸­çš„å…ƒç´ ä¸éœ€è¦è€ƒè™‘å¤ç”¨æ€§ å¦‚æœå‡ºç°äº†åˆ†å‰ç‚¹ï¼Œå°±ä¸€å®šè¦æœ‰ä¸€ä¸ªæ±‡åˆç‚¹ä¸ä¹‹å¯¹åº” ç”¨ä¾‹å›¾(use case) æè¿°ç³»ç»Ÿæ‹¥æœ‰å“ªäº›è§’è‰²,æ¯ä¸ªè§’è‰²æ‹¥æœ‰å“ªäº›åŠŸèƒ½(ç”¨ä¾‹) ä¸€èˆ¬ç”¨åœ¨éœ€æ±‚åˆ†æé˜¶æ®µ å…³ç³» å…³è”association å•å‘ç®­å¤´è¡¨ç¤º(è§’è‰²æŒ‡å‘ç”¨ä¾‹) è¡¨ç¤ºè§’è‰²å¯åŠ¨å¯¹åº”ç”¨ä¾‹ é™¤äº†åŒ…å«å’Œæ‰©å±•ç”¨ä¾‹å¤–ï¼Œå…¶ä½™ç”¨ä¾‹éƒ½æœ‰è§’è‰²å¯åŠ¨ä»– åŒ…å«include ä¸€èˆ¬æŒ‡ä¸¤ä¸ªç”¨ä¾‹ä¹‹é—´çš„å…³ç³» ä»£è¡¨ä¸€ä¸ªç”¨ä¾‹çš„è¡Œä¸ºåŒ…å«äº†å¦å¤–ä¸€ä¸ªç”¨ä¾‹çš„è¡Œä¸ºï¼Œç®­å¤´æŒ‡å‘ä¸ºåŒ…å«è€…æŒ‡å‘è¢«åŒ…å«è€… æ‰©å±•extend ä¸¤ä¸ªç”¨ä¾‹ä¹‹é—´çš„å…³ç³» ç”¨æ¥æè¿°ä¸€ä¸ªç”¨ä¾‹æ˜¯å¦å¤–ä¸€ä¸ªç”¨ä¾‹çš„å¢é‡æ‰©å±• è¿™ä¸ªåŠŸèƒ½æ˜¯éå¿…é¡»çš„åŠŸèƒ½,ä¾‹å¦‚æ‰¾å›å¯†ç å¯¹éƒ¨åˆ†ç”¨æˆ·æ¥è¯´å¹¶ä¸æ˜¯æ¯æ¬¡éƒ½ç”¨åˆ°çš„ï¼Œæ‰€ä»¥ä»–æ˜¯ä¸€ä¸ªåœ¨ç™»å½•ä¹‹ä¸Šæ‰©å±•çš„ä¸€ä¸ªåŠŸèƒ½ æ³›åŒ–generalize ä¸¤ä¸ªç”¨ä¾‹æ˜¯ä¸€ä¸ªç»§æ‰¿å…³ç³»ï¼Œçˆ¶ç”¨ä¾‹ä¸€èˆ¬ä¸ºæŠ½è±¡ç”¨ä¾‹ï¼Œå­ç”¨ä¾‹ä¸ºå…·ä½“ç”¨ä¾‹ï¼›ä¾‹å¦‚é¢„å®šæ˜¯ä¸€ä¸ªæŠ½è±¡ç”¨ä¾‹ï¼Œå…·ä½“ç”¨ä¾‹å¯ä¸ºç”µè¯é¢„å®šå’Œç½‘ä¸Šé¢„å®š ç»„ä»¶å›¾(component) ç”¨æ¥è¡¨ç¤ºç³»ç»Ÿçš„æ¨¡å—åŒ–éƒ¨åˆ† æ¯ä¸ªç»„ä»¶æœ‰æš´éœ²ç»™å¤–éƒ¨ç”¨çš„æ¥å£(ç”¨åœ†çƒè¡¨ç¤º)ï¼Œå’Œéœ€è¦åˆ«çš„ç»„ä»¶æä¾›çš„æ¥å£(åŠåœ†è¡¨ç¤º)ï¼ŒäºŒè€…è¿æ¥èµ·æ¥ä»£è¡¨ä¸€æ–¹ä½¿ç”¨äº†å¦å¤–ä¸€æ–¹æä¾›çš„æ¥å£äº† ä¾‹å¦‚ä¸‹å›¾ï¼Œè´­ç‰©è½¦ç»„ä»¶æä¾›äº†åŠ å…¥è´­ç‰©è½¦æ¥å£ï¼ŒåŒæ—¶ä»–ä¹Ÿä½¿ç”¨äº†åº“å­˜ç³»ç»Ÿçš„å•†å“åº“å­˜æ¥å£ ä¾‹å¦‚è´­ç‰©è½¦ä¾èµ–è®¢å•ç³»ç»Ÿçš„ç»“ç®—æ¥å£ å‚è€ƒæ¡ˆä¾‹ ä»¥ä¸‹é“¾æ¥æ˜¯ä¸€ä¸ªå¸¸ç”¨umlå›¾çš„demoæºæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨Enterprise Architectæ‰“å¼€demo.ea]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>uml</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[work-time-assessment]]></title>
    <url>%2F2019%2F10%2F16%2Fwork-time-assessment%2F</url>
    <content type="text"><![CDATA[æ—¶é—´è¯„ä¼°éœ€æ±‚è¯„å®¡ äº†è§£éœ€æ±‚æ•…äº‹(èƒŒæ™¯) ä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªéœ€æ±‚ é¢†å¯¼è¦æ±‚ çº¿ä¸Šç”¨æˆ·åé¦ˆ æ˜ç¡®éœ€æ±‚ä»·å€¼ éœ€æ±‚èƒ½å¸¦æ¥ä»€ä¹ˆæ”¶ç›Š(ç”¨æˆ·ä½“éªŒæ”¹å–„ã€PVå¢åŠ â€¦) é’ˆå¯¹å¤šä¸ªéœ€æ±‚è®©PMç¡®å®šä¼˜å…ˆçº§ äº†è§£é¡¹ç›®å¹³å° web æ¡Œé¢å®¢æˆ·ç«¯ Native ç¡®å®šdeadline é’ˆå¯¹æŠ€æœ¯éš¾ç‚¹ï¼Œæå‡ºæŠ€æœ¯è°ƒç ”éœ€æ±‚ æ–¹æ¡ˆè°ƒç ” é’ˆå¯¹æŠ€æœ¯éš¾ç‚¹è¿›è¡Œè°ƒç ”è¯„ä¼° ç»„ç»‡ç›¸å…³ä¼šè®®è¯„å®¡ç¡®å®šå¯è¡Œæ€§ éœ€æ±‚è¯„ä¼° éœ€æ±‚è¯„ä¼°å…¶å®å°±æ˜¯åœ¨ç¡®å®šçš„deadlineæ—¶é—´ä¸­æ‰¾å‡ºå¯ä»¥æ»¡è¶³çš„éœ€æ±‚ é€šè¿‡éœ€æ±‚äº†è§£é˜¶æ®µè·å–çš„ä¿¡æ¯ï¼Œè¯„ä¼°ç›¸å…³éœ€æ±‚çš„åˆç†æ€§ï¼Œä¸åˆç†çš„éœ€æ±‚å¯ç æ‰ å¾…ç éœ€æ±‚ç‰¹å¾ ç°æœ‰æŠ€æœ¯æ ˆæ— æ³•å®ç°æˆ–éœ€è¦èŠ±è´¹è¾ƒé•¿æ—¶é—´å®ç°å¯¼è‡´é¡¹ç›®å»¶æœŸçš„éœ€æ±‚ éœ€æ±‚ä»·å€¼ä¸é«˜ æ˜æ˜¾æ— æ³•äº§ç”Ÿæ”¶ç›Šçš„éœ€æ±‚ èŠ±è´¹è¾ƒå¤šæˆæœ¬ä½†æ”¶ç›Šè¾ƒä½çš„éœ€æ±‚ ä¼˜å…ˆçº§è¾ƒä½çš„éœ€æ±‚ ä¿ç•™çš„éœ€æ±‚æŒ‰ç…§ä¼˜å…ˆçº§æ’æœŸ æ–¹æ¡ˆè®¾è®¡ äº§å‡ºè¯¦ç»†è®¾è®¡æ–¹æ¡ˆ å‰åç«¯æ¥å£å®šä¹‰ ç»„ä»¶å®šä¹‰ ä¸€èˆ¬åŒ…æ‹¬è®¾è®¡æ–‡æ¡£å’Œç›¸å…³UMLå›¾ï¼ˆç±»å›¾ã€æ—¶åºå›¾ã€æ´»åŠ¨å›¾å¿…é¡»æœ‰ï¼‰ é‚€è¯·ç›¸å…³äººå‘˜å¯¹æ–¹æ¡ˆè¿›è¡Œè¯„å®¡ å®ç° å‚ç…§è¯¦ç»†è®¾è®¡æ–¹æ¡ˆç¼–ç å®ç° è‹¥å‘ç°æœ‰åå·®åŠæ—¶è°ƒæ•´è®¾è®¡æ–¹æ¡ˆå¹¶ç»„ç»‡è¯„å®¡é€šçŸ¥ç›¸å…³å½±å“æ–¹ å‰ç«¯å®ç°æ’æœŸå¸ƒå±€ å¸ƒå±€åŠäº¤äº’ä¸€èˆ¬éœ€è¦ç­‰UIå›¾å‡ºæ¥æ‰èƒ½å‡†ç¡®è¯„ä¼° å‰æœŸå¯ä»¥å‚ç…§éœ€æ±‚æ–‡æ¡£åšä¸ªç²—ç•¥è¯„ä¼° è¯„ä¼°ä¾æ® æ˜¯å¦æœ‰ç°æˆç»„ä»¶ï¼Œä¿®æ”¹æ˜¯å¦æ–¹ä¾¿ è‡ªå·±å®ç°éš¾åº¦å¦‚ä½• æ­£å¸¸æƒ…å†µä¸‹å¯æŒ‰ç…§ä¸€ä¸ªé¡µé¢å¹³å‡1äººæ—¥æ¥è¯„ä¼° è‹¥æœ‰ç‰¹æ®Šå…¼å®¹æ€§è¦æ±‚ï¼Œå¯é…Œæƒ…å¢åŠ æ—¶é—´ äº¤äº’ äº¤äº’å¯åˆ†ä¸ºæ•°æ®äº¤äº’å’ŒåŠ¨æ•ˆäº¤äº’ æ•°æ®äº¤äº’ï¼ŒåŒæ¥å£äº¤äº’ å…¥å£æ•°æ® é’ˆå¯¹æ¥å£è¿”å›æ•°æ®åšå¿…è¦æ ¡éªŒã€æ ¼å¼åŒ–ç­‰ ä¸šåŠ¡æ•°æ® æ ¹æ®ä¸šåŠ¡æµç¨‹è¿›è¡Œç›¸åº”è½¬æ¢æµè½¬ å‡ºå£æ•°æ® æäº¤ç»™æ¥å£çš„æ•°æ®éœ€è¦æ ¡éªŒ(è¡¨å•éªŒè¯ã€æäº¤æ•°æ®æ•´ç†ç­‰) åŠ¨æ•ˆï¼ŒåŒç”¨æˆ·äº¤äº’ æœªå‡ºUIå›¾æ—¶ï¼Œå¯æŒ‰ç…§ä¸€ä¸ªé¡µé¢å¹³å‡1.5äººæ—¥æ¥è¯„ä¼° æ•°æ®å±•ç¤º å°†æ•°æ®ç»‘å®šåˆ°è§†å›¾ä¸Š æ­¤éƒ¨åˆ†ä¸€èˆ¬æŒ‰ä¸€ä¸ªé¡µé¢å¹³å‡0.5äººæ—¥æ¥è¯„ä¼° è”è°ƒ æ¥å£è”è°ƒã€ç«¯è”è°ƒ ä¹è§‚æƒ…å†µä¸‹ï¼Œå¯æŒ‰ç…§ä¸€ä¸ªé¡µé¢å¹³å‡0.5äººæ—¥æ¥è¯„ä¼° æ‚²è§‚æƒ…å†µä¸‹ï¼ŒæŒ‰ç…§ä¸€ä¸ªé¡µé¢å¹³å‡1äººæ—¥æ¥è¯„ä¼° è‡ªæµ‹ é¢„ç•™è‡ªæµ‹æ—¶é—´ ç¡®å®šæ˜¯å¦æœ‰éœ€æ±‚ç»†èŠ‚é—æ¼ å®ç°æ˜¯å¦æ»¡è¶³éœ€æ±‚è¦æ±‚ ä¸€èˆ¬è¯„ä¼°ä¸º1äººæ—¥ å±•ç¤ºã€äº¤äº’ã€å…¼å®¹æ€§ bufferæ—¶é—´ é¢„ç•™å¡«å‘æ—¶é—´ ä¸€èˆ¬ä¸ºæ€»æ—¶é—´çš„0.2æˆ–0.3 ä¾‹å¦‚æ­£å¸¸å®ç°æ—¶é—´éœ€è¦10äººæ—¥ï¼Œåˆ™å¯é¢„ç•™2åˆ°3å¤©åšä¸ºbufferæ—¶é—´ è°ƒæ•´æ’æœŸ åŠæ—¶è°ƒæ•´æ’æœŸï¼Œåº”å¯¹çªå‘æƒ…å†µ UIã€æ¥å£å‘ç”Ÿå˜åŒ– åå°æœåŠ¡ä¸å¯ç”¨ç­‰ç­‰å„ç§ä¸å¯é¢„æ–™çš„æƒ…å†µ æ€»ç»“ å°½é‡æ‚²è§‚è¯„ä¼°ï¼Œç»™è‡ªå·±ä¿ç•™å……åˆ†çš„ç¼“å†²æ—¶é—´ä»¥åº”å¯¹æ„å¤–æƒ…å†µ å‚è€ƒ https://www.zhihu.com/question/21109935/answer/217940281https://www.zhihu.com/question/28461584/answer/40971581]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>å·¥æ—¶</tag>
        <tag>è¯„ä¼°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sql-basic]]></title>
    <url>%2F2019%2F10%2F16%2Fsql-basic%2F</url>
    <content type="text"><![CDATA[SQLåŸºç¡€æ•°æ®åº“è¡¨ç»„æˆ åº“db è¡¨table è¡Œ(è®°å½•)1 åˆ—(å­—æ®µ,field)1ï¼Œåˆ—(å­—æ®µ,field)2 è¡Œ(è®°å½•)2 åˆ—(å­—æ®µ,field)1ï¼Œåˆ—(å­—æ®µ,field)2 æ³¨æ„é¡¹å¤§å°å†™ä¸æ•æ„Ÿ SQLå¯¹å¤§å°å†™ä¸æ•æ„Ÿ SELECTå’Œselectæ˜¯ä¸€æ ·çš„ SQLæ‰§è¡Œé¡ºåº SQLè¯­å¥æ‰§è¡Œçš„æ—¶å€™æ˜¯æœ‰ä¸€å®šé¡ºåºçš„ã€‚ from å…ˆé€‰æ‹©ä¸€ä¸ªè¡¨ï¼Œæ„æˆä¸€ä¸ªç»“æœé›†ã€‚ where å¯¹ç»“æœé›†è¿›è¡Œç­›é€‰ï¼Œç­›é€‰å‡ºéœ€è¦çš„ä¿¡æ¯å½¢æˆæ–°çš„ç»“æœé›†ã€‚ group by å¯¹æ–°çš„ç»“æœé›†åˆ†ç»„ã€‚ having ç­›é€‰å‡ºæƒ³è¦çš„åˆ†ç»„ã€‚ select é€‰æ‹©åˆ—ã€‚ order by å½“æ‰€æœ‰çš„æ¡ä»¶éƒ½å¼„å®Œäº†ã€‚æœ€åæ’åºã€‚ å½“ä¸€æ¡æŸ¥è¯¢è¯­å¥ä¸­åŒ…å«æ‰€æœ‰çš„å­å¥ï¼Œæ‰§è¡Œé¡ºåºä¾ä¸‹åˆ—å­å¥æ¬¡åºï¼š FROM å­å¥ï¼šæ‰§è¡Œé¡ºåºä¸ºä»åå¾€å‰ã€ä»å³åˆ°å·¦ã€‚æ•°æ®é‡è¾ƒå°‘çš„è¡¨å°½é‡æ”¾åœ¨åé¢ã€‚ WHEREå­å¥ï¼šæ‰§è¡Œé¡ºåºä¸ºè‡ªä¸‹è€Œä¸Šã€ä»å³åˆ°å·¦ã€‚å°†èƒ½è¿‡æ»¤æ‰æœ€å¤§æ•°é‡è®°å½•çš„æ¡ä»¶å†™åœ¨WHERE å­å¥çš„æœ€å³ã€‚ GROUP BYï¼šæ‰§è¡Œé¡ºåºä»å·¦å¾€å³åˆ†ç»„ï¼Œæœ€å¥½åœ¨GROUP BYå‰ä½¿ç”¨WHEREå°†ä¸éœ€è¦çš„è®°å½•åœ¨GROUP BYä¹‹å‰è¿‡æ»¤æ‰ã€‚ HAVING å­å¥ï¼šæ¶ˆè€—èµ„æºã€‚å°½é‡é¿å…ä½¿ç”¨ï¼ŒHAVING ä¼šåœ¨æ£€ç´¢å‡ºæ‰€æœ‰è®°å½•ä¹‹åæ‰å¯¹ç»“æœé›†è¿›è¡Œè¿‡æ»¤ï¼Œéœ€è¦æ’åºç­‰æ“ä½œã€‚ SELECTå­å¥ï¼šå°‘ç”¨*å·ï¼Œå°½é‡å–å­—æ®µåç§°ã€‚ORACLE åœ¨è§£æçš„è¿‡ç¨‹ä¸­, é€šè¿‡æŸ¥è¯¢æ•°æ®å­—å…¸å°†*å·ä¾æ¬¡è½¬æ¢æˆæ‰€æœ‰çš„åˆ—å, æ¶ˆè€—æ—¶é—´ã€‚ ORDER BYå­å¥ï¼šæ‰§è¡Œé¡ºåºä¸ºä»å·¦åˆ°å³æ’åºï¼Œæ¶ˆè€—èµ„æºã€‚ å¸¸ç”¨è¯­å¥SELECT(é€‰å–æ•°æ®) SELECTè¯­å¥ç”¨äºä»æ•°æ®åº“ä¸­é€‰å–æ•°æ®ã€‚ç»“æœè¢«å­˜å‚¨åœ¨ä¸€ä¸ªç»“æœè¡¨ä¸­ï¼Œç§°ä¸ºç»“æœé›†1234SELECT column_name,column_name FROM table_name;/* é€‰å–æ‰€æœ‰åˆ—*/SELECT * FROM table_name; SELECT DISTINCT(å»é™¤åˆ—ä¸­é‡å¤å€¼) åœ¨è¡¨ä¸­ï¼Œä¸€ä¸ªåˆ—å¯èƒ½ä¼šåŒ…å«å¤šä¸ªé‡å¤å€¼ï¼Œæœ‰æ—¶æ‚¨ä¹Ÿè®¸å¸Œæœ›ä»…ä»…åˆ—å‡ºä¸åŒï¼ˆdistinctï¼‰çš„å€¼ã€‚DISTINCT å…³é”®è¯ç”¨äºè¿”å›å”¯ä¸€ä¸åŒçš„å€¼(å»æ‰åˆ—çš„é‡å¤å€¼)123SELECT DISTINCT column_name,column_name FROM table_name;SELECT DISTINCT country FROM Websites; WHEREå­å¥(ç±»ä¼¼if) WHEREå­å¥ç”¨äºè¿‡æ»¤è®°å½• 1234SELECT column_name,column_name FROM table_name WHERE column_name operator value;/*ä»Websitesè¡¨ä¸­æŸ¥å‡ºæ‰€æœ‰countryä¸º'CN'çš„è®°å½•(è¡Œ)*/SELECT * FROM Websites WHERE country='CN'; å¸¸ç”¨operator(æ“ä½œç¬¦) æ“ä½œç¬¦ æè¿° = ç­‰äº &lt;&gt;ã€!= ä¸ç­‰äº &gt; å¤§äº &lt; å°äº &gt;= å¤§äºç­‰äº &lt;= å°äºç­‰äº BETWEEN åœ¨æŸä¸ªèŒƒå›´ LIKE æœç´¢æŸç§æ¨¡å¼(ç”¨äºæ­£åˆ™åŒ¹é…) IN æŒ‡å®šé’ˆå¯¹æŸä¸ªåˆ—çš„å¤šä¸ªå¯èƒ½å€¼(æšä¸¾å€¼) AND&amp;ORè¿ç®—ç¬¦(é€»è¾‘è¿ç®—) é€»è¾‘è¿ç®—ç¬¦ï¼ŒåŸºäºå¤šä¸ªæ¡ä»¶å¯¹è®°å½•è¿›è¡Œè¿‡æ»¤12345/*countryä¸ºCNå¹¶alexaå¤§äº50*/SELECT * FROM Websites WHERE country='CN' AND alexa &gt; 50;/*alexaå¤§äº15å¹¶ä¸”countryä¸ºCNæˆ–USA*/SELECT * FROM Websites WHERE alexa &gt; 15 AND (country='CN' OR country='USA'); ORDER BY(æ’åº) ORDER BY å…³é”®å­—ç”¨äºå¯¹ç»“æœé›†è¿›è¡Œæ’åºã€‚ 1SELECT column_name,column_name FROM table_name ORDER BY column_name,column_name ASC | DESC; é¡ºåº ASC å‡åº(é»˜è®¤) DESC é™åº å¤šåˆ—æ’åº12345/*ç»“æœé›†ï¼Œå…ˆæŒ‰countryå‡åºï¼ˆé»˜è®¤ï¼‰ï¼Œå†æŒ‰alexaå‡åºï¼ˆé»˜è®¤ï¼‰*/SELECT * FROM Websites ORDER BY country,alexa;/*ç»“æœé›†ï¼Œå…ˆæŒ‰countryé™åºï¼Œå†æŒ‰alexaå‡åºï¼ˆé»˜è®¤ï¼‰*/SELECT * FROM Websites ORDER BY country DESC,alexa; INSERT INTO(æ’å…¥è®°å½•) INSERT INTO è¯­å¥ç”¨äºå‘è¡¨ä¸­æ’å…¥æ–°è®°å½•ã€‚12345678/*ç¬¬ä¸€ç§å½¢å¼æ— éœ€æŒ‡å®šè¦æ’å…¥æ•°æ®çš„åˆ—åï¼Œåªéœ€æä¾›è¢«æ’å…¥çš„å€¼å³å¯ï¼š*/INSERT INTO table_nameVALUES (value1,value2,value3,...);/*ç¬¬äºŒç§å½¢å¼éœ€è¦æŒ‡å®šåˆ—ååŠè¢«æ’å…¥çš„å€¼ï¼š*/INSERT INTO table_name (column1,column2,column3,...)VALUES (value1,value2,value3,...); UPDATE(æ›´æ–°è®°å½•) UPDATE è¯­å¥ç”¨äºæ›´æ–°è¡¨ä¸­çš„è®°å½•ã€‚ 1UPDATE table_name SET column1=value1,column2=value2,...WHERE some_column=some_value; æ³¨æ„ WHERE å­å¥è§„å®šå“ªæ¡è®°å½•æˆ–è€…å“ªäº›è®°å½•éœ€è¦æ›´æ–°ã€‚å¦‚æœæ‚¨çœç•¥äº† WHERE å­å¥ï¼Œæ‰€æœ‰çš„è®°å½•éƒ½å°†è¢«æ›´æ–°ï¼ åœ¨ MySQL ä¸­å¯ä»¥é€šè¿‡è®¾ç½® sql_safe_updates è¿™ä¸ªè‡ªå¸¦çš„å‚æ•°æ¥è§£å†³ï¼Œå½“è¯¥å‚æ•°å¼€å¯çš„æƒ…å†µä¸‹ï¼Œä½ å¿…é¡»åœ¨update è¯­å¥åæºå¸¦ where æ¡ä»¶ï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™ã€‚set sql_safe_updates=1; è¡¨ç¤ºå¼€å¯è¯¥å‚æ•° DELETE(åˆ é™¤è®°å½•) DELETE è¯­å¥ç”¨äºåˆ é™¤è¡¨ä¸­çš„è¡Œã€‚ 1DELETE FROM table_name WHERE some_column=some_value; WHERE å­å¥è§„å®šå“ªæ¡è®°å½•æˆ–è€…å“ªäº›è®°å½•éœ€è¦åˆ é™¤ã€‚å¦‚æœæ‚¨çœç•¥äº† WHERE å­å¥ï¼Œæ‰€æœ‰çš„è®°å½•éƒ½å°†è¢«åˆ é™¤ï¼ LIMITã€TOPã€ROWNUM(è§„å®šè¿”å›çš„è®°å½•æ•°ç›®) MySQL æ”¯æŒ LIMIT è¯­å¥æ¥é€‰å–æŒ‡å®šçš„æ¡æ•°æ•°æ®ï¼Œ Oracle å¯ä»¥ä½¿ç”¨ ROWNUM æ¥é€‰å–ã€‚12345SELECT column_name(s) FROM table_name LIMIT number;/*ä»Personsä¸­å–å‡ºè®°å½•çš„å‰5æ¡*/SELECT * FROM Persons LIMIT 5; LIKE(æœç´¢æŒ‡å®šæ¨¡å¼) LIKE æ“ä½œç¬¦ç”¨äºåœ¨ WHERE å­å¥ä¸­æœç´¢åˆ—ä¸­çš„æŒ‡å®šæ¨¡å¼ã€‚ ç±»ä¼¼winä¸­æœç´¢æ—¶ç”¨çš„æœç´¢æ¨¡å¼(ç±»ä¼¼*.png) 1234567891011121314151617SELECT column_name(s) FROM table_nameWHERE column_name LIKE pattern;/*%åœ¨SQLä¸­ä»£è¡¨ä»»æ„æ•°é‡çš„ä»»æ„å­—ç¬¦(ä»»æ„é€šé…ç¬¦)ï¼Œç±»ä¼¼*çš„ä½œç”¨ ä¸‹é¢è¯­å¥ä»£è¡¨æœç´¢æ‰€æœ‰nameä¸ºGå¼€å¤´çš„è®°å½•*/SELECT * FROM Websites WHERE name LIKE 'G%';/*kç»“å°¾*/SELECT * FROM Websites WHERE name LIKE '%k';/*ä¸­é—´åŒ…å«oo*/SELECT * FROM Websites WHERE name LIKE '%oo%';/*ä¸­é—´ä¸åŒ…å«oo*/SELECT * FROM Websites WHERE name NOT LIKE '%oo%'; å¸¸ç”¨é€šé…ç¬¦ é€šé…ç¬¦ æè¿° % æ›¿ä»£ 0 ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ _ æ›¿ä»£ä¸€ä¸ªå­—ç¬¦ [charlist] å­—ç¬¦åˆ—ä¸­çš„ä»»ä½•å•ä¸€å­—ç¬¦(ç±»æ¯”æ­£åˆ™[a-zA-Z]) [^charlist]æˆ–[!charlist] ä¸åœ¨å­—ç¬¦åˆ—ä¸­çš„ä»»ä½•å•ä¸€å­—ç¬¦(ç±»æ¯”[^a-zA-Z]) RLIKEã€REGEXP(æ­£åˆ™åŒ¹é…) MySQL ä¸­ä½¿ç”¨ REGEXP æˆ– NOT REGEXP è¿ç®—ç¬¦ (æˆ– RLIKE å’Œ NOT RLIKE) æ¥æ“ä½œæ­£åˆ™è¡¨è¾¾å¼12/*é€‰å–nameä»¥Gã€Fã€så¼€å¤´è®°å½•*/SELECT * FROM Websites WHERE name REGEXP '^[GFs]'; INæ“ä½œç¬¦(æšä¸¾åŒ¹é…) IN æ“ä½œç¬¦å…è®¸æ‚¨åœ¨ WHERE å­å¥ä¸­è§„å®šå¤šä¸ªå€¼ã€‚12345/*column_nameå¿…é¡»æ˜¯INè§„é¿çš„å€¼å…¶ä¸­ä¹‹ä¸€*/SELECT column_name(s) FROM table_name WHERE column_name IN (value1,value2,...);/*nameå¿…é¡»æ˜¯Googleï¼ŒBaiDuå…¶ä¸­ä¹‹ä¸€*/SELECT * FROM Websites WHERE name IN ('Google','BaiDu'); BETWEENæ“ä½œç¬¦(é€‰å–åŒºé—´å€¼) BETWEEN æ“ä½œç¬¦ç”¨äºé€‰å–ä»‹äºä¸¤ä¸ªå€¼ä¹‹é—´çš„æ•°æ®èŒƒå›´å†…çš„å€¼ã€‚123456789101112131415161718SELECT column_name(s) FROM table_name WHERE column_name BETWEEN value1 AND value2;/*é€‰å–alexa &gt;=1&amp;&amp;&lt;=20çš„è®°å½•*/SELECT * FROM Websites WHERE alexa BETWEEN 1 AND 20;/*é€‰å–alexa ä¸æ˜¯&gt;=1&amp;&amp;&lt;=20çš„è®°å½•*/SELECT * FROM Websites WHERE alexa NOT BETWEEN 1 AND 20;/*alexa&gt;=1&amp;&amp;&lt;=20 ä¸”countryä¸ä¸º'USA','IND'*/SELECT * FROM Websites WHERE (alexa BETWEEN 1 AND 20) AND country NOT IN ('USA', 'IND');/*é€‰å– name ä»¥ä»‹äº 'A' å’Œ 'H' ä¹‹é—´å­—æ¯å¼€å§‹çš„æ‰€æœ‰ç½‘ç«™ï¼š*/SELECT * FROM Websites WHERE name BETWEEN 'A' AND 'H';/*é€‰å– date ä»‹äº '2016-05-10' å’Œ '2016-05-14' ä¹‹é—´çš„æ‰€æœ‰è®¿é—®è®°å½•*/SELECT * FROM access_log WHERE date BETWEEN '2016-05-10' AND '2016-05-14'; åˆ«å é€šè¿‡ä½¿ç”¨ SQLï¼Œå¯ä»¥ä¸ºè¡¨åç§°æˆ–åˆ—åç§°æŒ‡å®šåˆ«åã€‚ 123456789101112131415/*åˆ—åˆ«å*/SELECT column_name AS alias_name FROM table_name;/*nameã€countryè¾“å‡ºåˆ°ç»“æœé›†æ—¶åˆ†åˆ«ä¸ºn c*/SELECT name AS n, country AS c FROM Websites;/*è¡¨åˆ«å*/SELECT column_name(s) FROM table_name AS alias_name;/*è¡¨Websitesåˆ«åä¸ºwï¼Œå¯ç›´æ¥ä½¿ç”¨*/SELECT w.name, w.url, a.count, a.date FROM Websites AS w, access_log AS a WHERE a.site_id=w.id and w.name="æµ‹è¯•";/*åˆå¹¶url,alexa,countryå¹¶é‡å‘½åä¸ºsite_info*/SELECT name, CONCAT(url, ', ', alexa, ', ', country) AS site_info FROM Websites; ä½¿ç”¨åœºæ™¯ åœ¨æŸ¥è¯¢ä¸­æ¶‰åŠè¶…è¿‡ä¸€ä¸ªè¡¨ åœ¨æŸ¥è¯¢ä¸­ä½¿ç”¨äº†å‡½æ•° åˆ—åç§°å¾ˆé•¿æˆ–è€…å¯è¯»æ€§å·® éœ€è¦æŠŠä¸¤ä¸ªåˆ—æˆ–è€…å¤šä¸ªåˆ—ç»“åˆåœ¨ä¸€èµ· JOIN(å…³è”) JOINä¸»è¦ç”¨äºå…³è”æŸ¥è¯¢ï¼Œä¸€èˆ¬è¿›è¡Œå…³è”æŸ¥è¯¢çš„è¡¨éƒ½æœ‰å…±åŒå­—æ®µ åŸºäºå…±åŒå­—æ®µï¼Œå°†å¤šä¸ªè¡¨åˆå¹¶æˆä¸€ä¸ªä¸´æ—¶è¡¨å†æŸ¥è¯¢ ä¸€èˆ¬ä½¿ç”¨ONæ¥ç¡®å®šå…±åŒå­—æ®µ è¯­æ³• table1 JOIN table2 ON table1.field=table2.field2 ä¸åŒçš„å…³è” INNER JOIN å†…å…³è” è¿”å›ä¸¤ä¸ªè¡¨çš„äº¤é›† LEFT JOIN ä»¥å·¦è¡¨ä¸ºåŸºå‡†è¡¨ï¼Œæ·»åŠ å³è¡¨ä¸­å…±åŒå­—æ®µå¯¹åº”çš„è®°å½• è¿”å›ç»“æœé›†ä¸ºï¼šå·¦è¡¨æ‰€æœ‰è®°å½•+å³è¡¨ä¸­æœ‰å·¦è¡¨å…±åŒå­—æ®µçš„è®°å½• RIGHT JOIN ä»¥å³è¡¨ä¸ºåŸºå‡†è¡¨ï¼Œæ·»åŠ å·¦è¡¨ä¸­å…±åŒå­—æ®µå¯¹åº”çš„è®°å½• è¿”å›ç»“æœé›†ä¸ºï¼šå³è¡¨æ‰€æœ‰è®°å½•+å·¦è¡¨ä¸­æœ‰å³è¡¨å…±åŒå­—æ®µçš„è®°å½• UNION(åˆå¹¶å¤šä¸ªç»“æœé›†) UNION æ“ä½œç¬¦åˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ª SELECT è¯­å¥çš„ç»“æœã€‚ é»˜è®¤åœ°ï¼ŒUNION æ“ä½œç¬¦é€‰å–ä¸åŒçš„å€¼ã€‚å¦‚æœå…è®¸é‡å¤çš„å€¼ï¼Œè¯·ä½¿ç”¨ UNION ALL 1234SELECT column_name(s) FROM table1 UNION SELECT column_name(s) FROM table2;SELECT column_name(s) FROM table1 UNION ALL SELECT column_name(s) FROM table2; SELECT INTOã€INSERT INTO â€¦ SELECT(å¤åˆ¶è¡¨)1234567891011121314151617/*å¤åˆ¶æ‰€æœ‰çš„åˆ—æ’å…¥åˆ°æ–°è¡¨ä¸­*/SELECT * INTO newtable [IN externaldb] FROM table1;/*åªå¤åˆ¶å¸Œæœ›çš„åˆ—æ’å…¥åˆ°æ–°è¡¨ä¸­*/SELECT column_name(s) INTO newtable [IN externaldb] FROM table1;/*MySqlæ”¯æŒçš„å¤åˆ¶è¡¨*/INSERT INTO table2 SELECT * FROM table1;/*æ‹·è´ç‰¹å®šåˆ—*/INSERT INTO table2(column_name(s)) SELECT column_name(s) FROM table1;/*æ‹·è´è¡¨ç»“æ„åŠæ•°æ®ä¹Ÿå¯ä»¥ç”¨ä¸‹é¢çš„*/CREATE TABLE æ–°è¡¨ASSELECT * FROM æ—§è¡¨ CREATE DATABASE(åˆ›å»ºæ•°æ®åº“)1234CREATE DATABASE dbname;/*åˆ›å»ºåä¸ºmy_dbçš„æ•°æ®åº“*/CREATE DATABASE my_db; CREATE TABLE(åˆ›å»ºè¡¨)1234567891011121314CREATE TABLE table_name (column_name1 data_type (size),column_name2 data_type (size),column_name3 data_type (size),....);CREATE TABLE Persons (PersonID int,LastName varchar(255),FirstName varchar(255),Address varchar(255),City varchar(255)); çº¦æŸ(è§„å®šæ•°æ®çš„è§„åˆ™) SQL çº¦æŸç”¨äºè§„å®šè¡¨ä¸­çš„æ•°æ®è§„åˆ™ã€‚å¦‚æœå­˜åœ¨è¿åçº¦æŸçš„æ•°æ®è¡Œä¸ºï¼Œè¡Œä¸ºä¼šè¢«çº¦æŸç»ˆæ­¢ã€‚çº¦æŸå¯ä»¥åœ¨åˆ›å»ºè¡¨æ—¶è§„å®šï¼ˆé€šè¿‡ CREATE TABLE è¯­å¥ï¼‰ï¼Œæˆ–è€…åœ¨è¡¨åˆ›å»ºä¹‹åè§„å®šï¼ˆé€šè¿‡ ALTER TABLE è¯­å¥ï¼‰ 123456CREATE TABLE table_name (column_name1 data_type (size) constraint_name,column_name2 data_type (size) constraint_name,column_name3 data_type (size) constraint_name,....); å¸¸ç”¨çº¦æŸ NOT NULL æŒ‡ç¤ºæŸåˆ—ä¸èƒ½å­˜å‚¨ NULL å€¼ã€‚ UNIQUE ä¿è¯æŸåˆ—çš„æ¯è¡Œå¿…é¡»æœ‰å”¯ä¸€çš„å€¼ PRIMARY KEYä¸»é”® NOT NULL å’Œ UNIQUE çš„ç»“åˆã€‚ç¡®ä¿æŸåˆ—ï¼ˆæˆ–ä¸¤ä¸ªåˆ—å¤šä¸ªåˆ—çš„ç»“åˆï¼‰æœ‰å”¯ä¸€æ ‡è¯†ï¼Œæœ‰åŠ©äºæ›´å®¹æ˜“æ›´å¿«é€Ÿåœ°æ‰¾åˆ°è¡¨ä¸­çš„ä¸€ä¸ªç‰¹å®šçš„è®°å½• FOREIGN KEYå¤–é”® ä¿è¯ä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®åŒ¹é…å¦ä¸€ä¸ªè¡¨ä¸­çš„å€¼çš„å‚ç…§å®Œæ•´æ€§ CHECK CHECK çº¦æŸç”¨äºé™åˆ¶åˆ—ä¸­çš„å€¼çš„èŒƒå›´ DEFAULT è§„å®šåˆ—çš„é»˜è®¤å€¼1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950CREATE TABLE Persons(P_Id int NOT NULL, /* P_Id ä¸èƒ½ä¸ºç©º*/LastName varchar(255) NOT NULL,FirstName varchar(255),Address varchar(255),City varchar(255))CREATE TABLE Persons(P_Id int NOT NULL,LastName varchar(255) NOT NULL,FirstName varchar(255),Address varchar(255),City varchar(255),UNIQUE (P_Id)) /*P_Idè¦ä¿è¯å”¯ä¸€æ€§*/CREATE TABLE Persons(P_Id int NOT NULL,LastName varchar(255) NOT NULL,FirstName varchar(255),Address varchar(255),City varchar(255),PRIMARY KEY (P_Id))/*è®¾ç½®ä¸»é”®*/CREATE TABLE Persons(P_Id int NOT NULL,LastName varchar(255) NOT NULL,FirstName varchar(255),Address varchar(255),City varchar(255),CHECK (P_Id&gt;0)) /*P_Idå¿…é¡»&gt;0*/CREATE TABLE Persons( P_Id int NOT NULL, LastName varchar(255) NOT NULL, FirstName varchar(255), Address varchar(255), City varchar(255) DEFAULT 'HeF') /*Cityåˆ—æœªè®¾ç½®å€¼æ—¶é»˜è®¤å€¼ä¸ºHeF*//*åˆ›å»ºåæ·»åŠ çº¦æŸ*/ALTER TABLE Persons ADD UNIQUE (P_Id)/*åˆ›å»ºååˆ é™¤çº¦æŸ*/ALTER TABLE Persons DROP INDEX uc_PersonID INDEX(åŠ å¿«æ£€ç´¢é€Ÿåº¦) CREATE INDEX è¯­å¥ç”¨äºåœ¨è¡¨ä¸­åˆ›å»ºç´¢å¼•ã€‚åœ¨ä¸è¯»å–æ•´ä¸ªè¡¨çš„æƒ…å†µä¸‹ï¼Œç´¢å¼•ä½¿æ•°æ®åº“åº”ç”¨ç¨‹åºå¯ä»¥æ›´å¿«åœ°æŸ¥æ‰¾æ•°æ® ç”¨æˆ·æ— æ³•çœ‹åˆ°ç´¢å¼•ï¼Œå®ƒä»¬åªèƒ½è¢«ç”¨æ¥åŠ é€Ÿæœç´¢/æŸ¥è¯¢ã€‚ æ›´æ–°ä¸€ä¸ªåŒ…å«ç´¢å¼•çš„è¡¨éœ€è¦æ¯”æ›´æ–°ä¸€ä¸ªæ²¡æœ‰ç´¢å¼•çš„è¡¨èŠ±è´¹æ›´å¤šçš„æ—¶é—´ï¼Œè¿™æ˜¯ç”±äºç´¢å¼•æœ¬èº«ä¹Ÿéœ€è¦æ›´æ–°ã€‚å› æ­¤ï¼Œç†æƒ³çš„åšæ³•æ˜¯ä»…ä»…åœ¨å¸¸å¸¸è¢«æœç´¢çš„åˆ—ï¼ˆä»¥åŠè¡¨ï¼‰ä¸Šé¢åˆ›å»ºç´¢å¼•1234567891011/*åˆ›å»ºç´¢å¼•*/CREATE INDEX index_name ON table_name (column_name)/*åˆ›å»ºå”¯ä¸€ç´¢å¼•*/CREATE UNIQUE INDEX index_name ON table_name (column_name)/*åœ¨ "Persons" è¡¨çš„ "LastName" åˆ—ä¸Šåˆ›å»ºä¸€ä¸ªåä¸º "PIndex" çš„ç´¢å¼•*/CREATE INDEX PIndex ON Persons (LastName)/*åŸºäºLastNameã€FirstNameåˆ›å»ºç´¢å¼•PIndex*/CREATE INDEX PIndex ON Persons (LastName, FirstName) DROP(å¸¸ç”¨äºåˆ é™¤æ“ä½œ)1234567891011/*åˆ é™¤ç´¢å¼•*/DROP INDEX index_name ON table_name/*åˆ é™¤è¡¨*/DROP TABLE table_name/*åˆ é™¤æ•°æ®åº“*/DROP DATABASE database_name/*ä»…ä»…åˆ é™¤è¡¨å†…çš„æ•°æ®ï¼Œä½†å¹¶ä¸åˆ é™¤è¡¨æœ¬èº«*/TRUNCATE TABLE table_name ALTER(ä¿®æ”¹åˆ—) ALTER TABLE è¯­å¥ç”¨äºåœ¨å·²æœ‰çš„è¡¨ä¸­æ·»åŠ ã€åˆ é™¤æˆ–ä¿®æ”¹åˆ—12345678/*æ·»åŠ åˆ—*/ALTER TABLE table_name ADD column_name datatype/*åˆ é™¤åˆ—*/ALTER TABLE table_name DROP COLUMN column_name/*ä¿®æ”¹åˆ—çš„datatype*/ALTER TABLE table_name MODIFY COLUMN column_name datatype AUTO INCREMENT (è‡ªå¢) Auto-increment ä¼šåœ¨æ–°è®°å½•æ’å…¥è¡¨ä¸­æ—¶ç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„æ•°å­— å¸¸ç”¨åœ¨ç”Ÿæˆä¸€ä¸ªå”¯ä¸€idæ—¶ä½¿ç”¨123456789CREATE TABLE Persons(ID int NOT NULL AUTO_INCREMENT ,/*idä¸ä¸ºç©ºå¹¶è‡ªå¢ï¼Œå¼€å§‹å€¼ä¸º1*/LastName varchar(255) NOT NULL,FirstName varchar(255),Address varchar(255),City varchar(255),PRIMARY KEY (ID)) è§†å›¾(ç»“æœé›†çš„å­é›†) æœ‰æ—¶ï¼Œä½ å¹¶ä¸å¸Œæœ›å®¢æˆ·ç«¯é€šè¿‡è¿”å›çš„æ•°æ®ç»“æ„ï¼Œæ¨æµ‹å‡ºæ•°æ®åº“è¡¨çš„ç»“æ„ã€‚è¿™æ—¶ï¼Œå¯ä»¥è¿”å›ç»™å®¢æˆ·ç«¯ä¸€ä¸ªç»“æœé›†çš„å­é›†ï¼Œåªç»™å®¢æˆ·ç«¯æä¾›å®ƒéœ€è¦çš„å­—æ®µï¼Œè§†å›¾å°±æ˜¯å¹²è¿™ä¸ªçš„ï¼›ç±»æ¯”è¿‡æ»¤å™¨ è§†å›¾åŒ…å«è¡Œå’Œåˆ—ï¼Œå°±åƒä¸€ä¸ªçœŸå®çš„è¡¨ã€‚è§†å›¾ä¸­çš„å­—æ®µå°±æ˜¯æ¥è‡ªä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®åº“ä¸­çš„çœŸå®çš„è¡¨ä¸­çš„å­—æ®µã€‚æ‚¨å¯ä»¥å‘è§†å›¾æ·»åŠ  SQL å‡½æ•°ã€WHERE ä»¥åŠ JOIN è¯­å¥ï¼Œä¹Ÿå¯ä»¥å‘ˆç°æ•°æ®ï¼Œå°±åƒè¿™äº›æ•°æ®æ¥è‡ªäºæŸä¸ªå•ä¸€çš„è¡¨ä¸€æ · è§†å›¾æ€»æ˜¯æ˜¾ç¤ºæœ€æ–°çš„æ•°æ®ï¼æ¯å½“ç”¨æˆ·æŸ¥è¯¢è§†å›¾æ—¶ï¼Œæ•°æ®åº“å¼•æ“é€šè¿‡ä½¿ç”¨è§†å›¾çš„ SQL è¯­å¥é‡å»ºæ•°æ®ã€‚ è§†å›¾éšè—äº†åº•å±‚çš„è¡¨ç»“æ„ï¼Œç®€åŒ–äº†æ•°æ®è®¿é—®æ“ä½œï¼Œå®¢æˆ·ç«¯ä¸å†éœ€è¦çŸ¥é“åº•å±‚è¡¨çš„ç»“æ„åŠå…¶ä¹‹é—´çš„å…³ç³»ã€‚ è§†å›¾æä¾›äº†ä¸€ä¸ªç»Ÿä¸€è®¿é—®æ•°æ®çš„æ¥å£ã€‚ï¼ˆå³å¯ä»¥å…è®¸ç”¨æˆ·é€šè¿‡è§†å›¾è®¿é—®æ•°æ®çš„å®‰å…¨æœºåˆ¶ï¼Œè€Œä¸æˆäºˆç”¨æˆ·ç›´æ¥è®¿é—®åº•å±‚è¡¨çš„æƒé™ï¼‰ ä»è€ŒåŠ å¼ºäº†å®‰å…¨æ€§ï¼Œä½¿ç”¨æˆ·åªèƒ½çœ‹åˆ°è§†å›¾æ‰€æ˜¾ç¤ºçš„æ•°æ®ã€‚ è§†å›¾è¿˜å¯ä»¥è¢«åµŒå¥—ï¼Œä¸€ä¸ªè§†å›¾ä¸­å¯ä»¥åµŒå¥—å¦ä¸€ä¸ªè§†å›¾ã€‚12345678910111213141516/*åˆ›å»ºè¯­æ³•*/CREATE VIEW view_name AS SELECT column_name(s) FROM table_name WHERE condition/*è§†å›¾ "Current Product List" ä¼šä» "Products" è¡¨åˆ—å‡ºæ‰€æœ‰æ­£åœ¨ä½¿ç”¨çš„äº§å“ï¼ˆæœªåœäº§çš„äº§å“ï¼‰*/CREATE VIEW [Current Product List] AS SELECT ProductID,ProductName FROM Products WHERE Discontinued=No/*æˆ‘ä»¬å¯ä»¥åƒè¿™æ ·æŸ¥è¯¢ä¸Šé¢è¿™ä¸ªè§†å›¾ï¼š*/SELECT * FROM [Current Product List]/*æ›´æ–°è§†å›¾ï¼Œä¸ºè§†å›¾æ·»åŠ Categoryåˆ—*/CREATE VIEW [Current Product List] AS SELECT ProductID,ProductName,Category FROM Products WHERE Discontinued=No/*åˆ é™¤è§†å›¾*/DROP VIEW view_name SQLæ—¥æœŸå‡½æ•° å‡½æ•° æè¿° NOW() è¿”å›å½“å‰çš„æ—¥æœŸå’Œæ—¶é—´ CURDATE() è¿”å›å½“å‰çš„æ—¥æœŸ CURTIME() è¿”å›å½“å‰çš„æ—¶é—´ DATE() æå–æ—¥æœŸæˆ–æ—¥æœŸ/æ—¶é—´è¡¨è¾¾å¼çš„æ—¥æœŸéƒ¨åˆ† EXTRACT() è¿”å›æ—¥æœŸ/æ—¶é—´çš„å•ç‹¬éƒ¨åˆ† DATE_ADD() å‘æ—¥æœŸæ·»åŠ æŒ‡å®šçš„æ—¶é—´é—´éš” DATE_SUB() ä»æ—¥æœŸå‡å»æŒ‡å®šçš„æ—¶é—´é—´éš” DATEDIFF() è¿”å›ä¸¤ä¸ªæ—¥æœŸä¹‹é—´çš„å¤©æ•° DATE_FORMAT() ç”¨ä¸åŒçš„æ ¼å¼æ˜¾ç¤ºæ—¥æœŸ/æ—¶é—´ NULL å¦‚æœè¡¨ä¸­çš„æŸä¸ªåˆ—æ˜¯å¯é€‰çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨ä¸å‘è¯¥åˆ—æ·»åŠ å€¼çš„æƒ…å†µä¸‹æ’å…¥æ–°è®°å½•æˆ–æ›´æ–°å·²æœ‰çš„è®°å½•ã€‚è¿™æ„å‘³ç€è¯¥å­—æ®µå°†ä»¥ NULL å€¼ä¿å­˜ NULL ç”¨ä½œæœªçŸ¥çš„æˆ–ä¸é€‚ç”¨çš„å€¼çš„å ä½ç¬¦ æ— æ³•æ¯”è¾ƒ NULL å’Œ 0ï¼›å®ƒä»¬æ˜¯ä¸ç­‰ä»·çš„ æ— æ³•ä½¿ç”¨æ¯”è¾ƒè¿ç®—ç¬¦æ¥æµ‹è¯• NULL å€¼ï¼Œæ¯”å¦‚ =ã€&lt; æˆ– &lt;&gt; åœ¨MySqlä¸­å¯ä»¥ä½¿ç”¨IFNULLæˆ–COALESCEåœ¨è®¡ç®—æ—¶ï¼Œç»™NULLèµ‹äºˆç‰¹å®šçš„å€¼ï¼Œé¿å…è®¡ç®—å‡ºé”™ å¿…é¡»ä½¿ç”¨IS NULLã€IS NOT NULL12345678910/*æ‰¾å‡ºAddressä¸ºNULLçš„è®°å½•*/SELECT LastName,FirstName,Address FROM Persons WHERE Address IS NULL/*æ‰¾å‡ºAddressä¸ä¸ºNULLçš„è®°å½•*/SELECT LastName,FirstName,Address FROM Persons WHERE Address IS NOT NULL/*å¦‚æœalexaåˆ—ä¸ºnullå€¼ï¼Œåˆ™èµ‹äºˆ0ï¼Œå¦åˆ™ï¼Œå–åŸå€¼*/SELECT id,name,url,IFNULL(alexa,0) FROM websites;SELECT id,name,url,COALESCE(alexa,0) FROM websites; æ•°æ®ç±»å‹ SQL å¼€å‘äººå‘˜å¿…é¡»åœ¨åˆ›å»º SQL è¡¨æ—¶å†³å®šè¡¨ä¸­çš„æ¯ä¸ªåˆ—å°†è¦å­˜å‚¨çš„æ•°æ®çš„ç±»å‹ã€‚æ•°æ®ç±»å‹æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œæ˜¯ä¾¿äº SQL äº†è§£æ¯ä¸ªåˆ—æœŸæœ›å­˜å‚¨ä»€ä¹ˆç±»å‹çš„æ•°æ®çš„æŒ‡å—ï¼Œå®ƒä¹Ÿæ ‡è¯†äº† SQL å¦‚ä½•ä¸å­˜å‚¨çš„æ•°æ®è¿›è¡Œäº¤äº’ æ•°æ®ç±»å‹ æè¿° CHARACTER(n) å­—ç¬¦/å­—ç¬¦ä¸²ã€‚å›ºå®šé•¿åº¦ nã€‚ VARCHAR(n) æˆ– CHARACTER VARYING(n) å­—ç¬¦/å­—ç¬¦ä¸²ã€‚å¯å˜é•¿åº¦ã€‚æœ€å¤§é•¿åº¦ nã€‚ BINARY(n) äºŒè¿›åˆ¶ä¸²ã€‚å›ºå®šé•¿åº¦ nã€‚ BOOLEAN å­˜å‚¨ TRUE æˆ– FALSE å€¼ VARBINARY(n) æˆ–BINARY VARYING(n) äºŒè¿›åˆ¶ä¸²ã€‚å¯å˜é•¿åº¦ã€‚æœ€å¤§é•¿åº¦ nã€‚ INTEGER(p) æ•´æ•°å€¼ï¼ˆæ²¡æœ‰å°æ•°ç‚¹ï¼‰ã€‚ç²¾åº¦ pã€‚ SMALLINT æ•´æ•°å€¼ï¼ˆæ²¡æœ‰å°æ•°ç‚¹ï¼‰ã€‚ç²¾åº¦ 5ã€‚ INTEGER æ•´æ•°å€¼ï¼ˆæ²¡æœ‰å°æ•°ç‚¹ï¼‰ã€‚ç²¾åº¦ 10ã€‚ BIGINT æ•´æ•°å€¼ï¼ˆæ²¡æœ‰å°æ•°ç‚¹ï¼‰ã€‚ç²¾åº¦ 19ã€‚ DECIMAL(p,s) ç²¾ç¡®æ•°å€¼ï¼Œç²¾åº¦ pï¼Œå°æ•°ç‚¹åä½æ•° sã€‚ä¾‹å¦‚ï¼šdecimal(5,2) æ˜¯ä¸€ä¸ªå°æ•°ç‚¹å‰æœ‰ 3 ä½æ•°ï¼Œå°æ•°ç‚¹åæœ‰ 2 ä½æ•°çš„æ•°å­—ã€‚ NUMERIC(p,s) ç²¾ç¡®æ•°å€¼ï¼Œç²¾åº¦ pï¼Œå°æ•°ç‚¹åä½æ•° sã€‚ï¼ˆä¸ DECIMAL ç›¸åŒï¼‰ FLOAT(p) è¿‘ä¼¼æ•°å€¼ï¼Œå°¾æ•°ç²¾åº¦ pã€‚ä¸€ä¸ªé‡‡ç”¨ä»¥ 10 ä¸ºåŸºæ•°çš„æŒ‡æ•°è®¡æ•°æ³•çš„æµ®ç‚¹æ•°ã€‚è¯¥ç±»å‹çš„ size å‚æ•°ç”±ä¸€ä¸ªæŒ‡å®šæœ€å°ç²¾åº¦çš„å•ä¸€æ•°å­—ç»„æˆã€‚ REAL è¿‘ä¼¼æ•°å€¼ï¼Œå°¾æ•°ç²¾åº¦ 7ã€‚ FLOAT è¿‘ä¼¼æ•°å€¼ï¼Œå°¾æ•°ç²¾åº¦ 16ã€‚ DOUBLE PRECISION è¿‘ä¼¼æ•°å€¼ï¼Œå°¾æ•°ç²¾åº¦ 16ã€‚ DATE å­˜å‚¨å¹´ã€æœˆã€æ—¥çš„å€¼ã€‚ TIME å­˜å‚¨å°æ—¶ã€åˆ†ã€ç§’çš„å€¼ã€‚ TIMESTAMP å­˜å‚¨å¹´ã€æœˆã€æ—¥ã€å°æ—¶ã€åˆ†ã€ç§’çš„å€¼ã€‚ INTERVAL ç”±ä¸€äº›æ•´æ•°å­—æ®µç»„æˆï¼Œä»£è¡¨ä¸€æ®µæ—¶é—´ï¼Œå–å†³äºåŒºé—´çš„ç±»å‹ã€‚ ARRAY å…ƒç´ çš„å›ºå®šé•¿åº¦çš„æœ‰åºé›†åˆ MULTISET å…ƒç´ çš„å¯å˜é•¿åº¦çš„æ— åºé›†åˆ XML å­˜å‚¨ XML æ•°æ® MySqlæ•°æ®ç±»å‹ åœ¨ MySQL ä¸­ï¼Œæœ‰ä¸‰ç§ä¸»è¦çš„ç±»å‹ï¼šTextï¼ˆæ–‡æœ¬ï¼‰ã€Numberï¼ˆæ•°å­—ï¼‰å’Œ Date/Timeï¼ˆæ—¥æœŸ/æ—¶é—´ï¼‰ç±»å‹ Text ç±»å‹ æ•°æ®ç±»å‹ æè¿° CHAR(size) ä¿å­˜å›ºå®šé•¿åº¦çš„å­—ç¬¦ä¸²ï¼ˆå¯åŒ…å«å­—æ¯ã€æ•°å­—ä»¥åŠç‰¹æ®Šå­—ç¬¦ï¼‰ã€‚åœ¨æ‹¬å·ä¸­æŒ‡å®šå­—ç¬¦ä¸²çš„é•¿åº¦ã€‚æœ€å¤š 255 ä¸ªå­—ç¬¦ã€‚ VARCHAR(size) ä¿å­˜å¯å˜é•¿åº¦çš„å­—ç¬¦ä¸²ï¼ˆå¯åŒ…å«å­—æ¯ã€æ•°å­—ä»¥åŠç‰¹æ®Šå­—ç¬¦ï¼‰ã€‚åœ¨æ‹¬å·ä¸­æŒ‡å®šå­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ã€‚æœ€å¤š 255 ä¸ªå­—ç¬¦ã€‚æ³¨é‡Šï¼šå¦‚æœå€¼çš„é•¿åº¦å¤§äº 255ï¼Œåˆ™è¢«è½¬æ¢ä¸º TEXT ç±»å‹ã€‚ TINYTEXT å­˜æ”¾æœ€å¤§é•¿åº¦ä¸º 255 ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ã€‚ TEXT å­˜æ”¾æœ€å¤§é•¿åº¦ä¸º 65,535 ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ã€‚ BLOB ç”¨äº BLOBsï¼ˆBinary Large OBjectsï¼‰ã€‚å­˜æ”¾æœ€å¤š 65,535 å­—èŠ‚çš„æ•°æ®ã€‚ MEDIUMTEXT å­˜æ”¾æœ€å¤§é•¿åº¦ä¸º 16,777,215 ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ã€‚ MEDIUMBLOB ç”¨äº BLOBsï¼ˆBinary Large OBjectsï¼‰ã€‚å­˜æ”¾æœ€å¤š 16,777,215 å­—èŠ‚çš„æ•°æ®ã€‚ LONGTEXT å­˜æ”¾æœ€å¤§é•¿åº¦ä¸º 4,294,967,295 ä¸ªå­—ç¬¦çš„å­—ç¬¦ä¸²ã€‚ LONGBLOB ç”¨äº BLOBs (Binary Large OBjects)ã€‚å­˜æ”¾æœ€å¤š 4,294,967,295 å­—èŠ‚çš„æ•°æ®ã€‚ ENUM(x,y,z,etc.) å…è®¸æ‚¨è¾“å…¥å¯èƒ½å€¼çš„åˆ—è¡¨ã€‚å¯ä»¥åœ¨ ENUM åˆ—è¡¨ä¸­åˆ—å‡ºæœ€å¤§ 65535 ä¸ªå€¼ã€‚å¦‚æœåˆ—è¡¨ä¸­ä¸å­˜åœ¨æ’å…¥çš„å€¼ï¼Œåˆ™æ’å…¥ç©ºå€¼ã€‚ æ³¨é‡Šï¼šè¿™äº›å€¼æ˜¯æŒ‰ç…§æ‚¨è¾“å…¥çš„é¡ºåºæ’åºçš„ã€‚å¯ä»¥æŒ‰ç…§æ­¤æ ¼å¼è¾“å…¥å¯èƒ½çš„å€¼ï¼š ENUM(â€˜Xâ€™,â€™Yâ€™,â€™Zâ€™) SET ä¸ ENUM ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯ï¼ŒSET æœ€å¤šåªèƒ½åŒ…å« 64 ä¸ªåˆ—è¡¨é¡¹ä¸” SET å¯å­˜å‚¨ä¸€ä¸ªä»¥ä¸Šçš„é€‰æ‹©ã€‚ Numberç±»å‹ ä¸‹é¢çš„sizeä»£è¡¨çš„å¹¶ä¸æ˜¯å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„å…·ä½“çš„é•¿åº¦ï¼Œå¦‚ int(4) å¹¶ä¸æ˜¯åªèƒ½å­˜å‚¨4ä¸ªé•¿åº¦çš„æ•°å­—ã€‚å®é™…ä¸Šint(size)æ‰€å å¤šå°‘å­˜å‚¨ç©ºé—´å¹¶æ— ä»»ä½•å…³ç³»ã€‚int(3)ã€int(4)ã€int(8) åœ¨ç£ç›˜ä¸Šéƒ½æ˜¯å ç”¨ 4 btyes çš„å­˜å‚¨ç©ºé—´ã€‚å°±æ˜¯åœ¨æ˜¾ç¤ºç»™ç”¨æˆ·çš„æ–¹å¼æœ‰ç‚¹ä¸åŒå¤–ï¼Œint(M) è·Ÿ int æ•°æ®ç±»å‹æ˜¯ç›¸åŒçš„ã€‚å°±æ˜¯æ˜¾ç¤ºçš„é•¿åº¦ä¸ä¸€æ ·è€Œå·² éƒ½æ˜¯å ç”¨å››ä¸ªå­—èŠ‚çš„ç©ºé—´12intï¼ˆ9ï¼‰æ˜¾ç¤ºç»“æœä¸º000000010intï¼ˆ3ï¼‰æ˜¾ç¤ºç»“æœä¸º010 æ•°æ®ç±»å‹ æè¿° TINYINT(size) å¸¦ç¬¦å·-128åˆ°127 ï¼Œæ— ç¬¦å·0åˆ°255ã€‚ SMALLINT(size) å¸¦ç¬¦å·èŒƒå›´-32768åˆ°32767ï¼Œæ— ç¬¦å·0åˆ°65535, size é»˜è®¤ä¸º 6ã€‚ MEDIUMINT(size) å¸¦ç¬¦å·èŒƒå›´-8388608åˆ°8388607ï¼Œæ— ç¬¦å·çš„èŒƒå›´æ˜¯0åˆ°16777215ã€‚ size é»˜è®¤ä¸º9 INT(size) å¸¦ç¬¦å·èŒƒå›´-2147483648åˆ°2147483647ï¼Œæ— ç¬¦å·çš„èŒƒå›´æ˜¯0åˆ°4294967295ã€‚ size é»˜è®¤ä¸º 11 BIGINT(size) å¸¦ç¬¦å·çš„èŒƒå›´æ˜¯-9223372036854775808åˆ°9223372036854775807ï¼Œæ— ç¬¦å·çš„èŒƒå›´æ˜¯0åˆ°18446744073709551615ã€‚size é»˜è®¤ä¸º 20 FLOAT(size,d) å¸¦æœ‰æµ®åŠ¨å°æ•°ç‚¹çš„å°æ•°å­—ã€‚åœ¨ size å‚æ•°ä¸­è§„å®šæ˜¾ç¤ºæœ€å¤§ä½æ•°ã€‚åœ¨ d å‚æ•°ä¸­è§„å®šå°æ•°ç‚¹å³ä¾§çš„æœ€å¤§ä½æ•°ã€‚ DOUBLE(size,d) å¸¦æœ‰æµ®åŠ¨å°æ•°ç‚¹çš„å¤§æ•°å­—ã€‚åœ¨ size å‚æ•°ä¸­è§„æ˜¾ç¤ºå®šæœ€å¤§ä½æ•°ã€‚åœ¨ d å‚æ•°ä¸­è§„å®šå°æ•°ç‚¹å³ä¾§çš„æœ€å¤§ä½æ•°ã€‚ DECIMAL(size,d) ä½œä¸ºå­—ç¬¦ä¸²å­˜å‚¨çš„ DOUBLE ç±»å‹ï¼Œå…è®¸å›ºå®šçš„å°æ•°ç‚¹ã€‚åœ¨ size å‚æ•°ä¸­è§„å®šæ˜¾ç¤ºæœ€å¤§ä½æ•°ã€‚åœ¨ d å‚æ•°ä¸­è§„å®šå°æ•°ç‚¹å³ä¾§çš„æœ€å¤§ä½æ•°ã€‚ Date ç±»å‹ æ•°æ®ç±»å‹ æè¿° DATE() æ—¥æœŸã€‚æ ¼å¼ï¼šYYYY-MM-DD æ³¨é‡Šï¼šæ”¯æŒçš„èŒƒå›´æ˜¯ä» â€˜1000-01-01â€™ åˆ° â€˜9999-12-31â€™ DATETIME() æ—¥æœŸå’Œæ—¶é—´çš„ç»„åˆã€‚æ ¼å¼ï¼šYYYY-MM-DD HH:MM:SS æ³¨é‡Šï¼šæ”¯æŒçš„èŒƒå›´æ˜¯ä» â€˜1000-01-01 00:00:00â€™ åˆ° â€˜9999-12-31 23:59:59â€™ TIMESTAMP() æ—¶é—´æˆ³ã€‚TIMESTAMP å€¼ä½¿ç”¨ Unix çºªå…ƒ(â€˜1970-01-01 00:00:00â€™ UTC) è‡³ä»Šçš„ç§’æ•°æ¥å­˜å‚¨ã€‚æ ¼å¼ï¼šYYYY-MM-DD HH:MM:SS æ³¨é‡Šï¼šæ”¯æŒçš„èŒƒå›´æ˜¯ä» â€˜1970-01-01 00:00:01â€™ UTC åˆ° â€˜2038-01-09 03:14:07â€™ UTC TIME() æ—¶é—´ã€‚æ ¼å¼ï¼šHH:MM:SS æ³¨é‡Šï¼šæ”¯æŒçš„èŒƒå›´æ˜¯ä» â€˜-838:59:59â€™ åˆ° â€˜838:59:59â€™ YEAR() 2 ä½æˆ– 4 ä½æ ¼å¼çš„å¹´ã€‚ æ³¨é‡Šï¼š4 ä½æ ¼å¼æ‰€å…è®¸çš„å€¼ï¼š1901 åˆ° 2155ã€‚2 ä½æ ¼å¼æ‰€å…è®¸çš„å€¼ï¼š70 åˆ° 69ï¼Œè¡¨ç¤ºä» 1970 åˆ° 2069ã€‚ å³ä¾¿ DATETIME å’Œ TIMESTAMP è¿”å›ç›¸åŒçš„æ ¼å¼ï¼Œå®ƒä»¬çš„å·¥ä½œæ–¹å¼å¾ˆä¸åŒã€‚åœ¨ INSERT æˆ– UPDATE æŸ¥è¯¢ä¸­ï¼ŒTIMESTAMP è‡ªåŠ¨æŠŠè‡ªèº«è®¾ç½®ä¸ºå½“å‰çš„æ—¥æœŸå’Œæ—¶é—´ã€‚TIMESTAMP ä¹Ÿæ¥å—ä¸åŒçš„æ ¼å¼ï¼Œæ¯”å¦‚ YYYYMMDDHHMMSSã€YYMMDDHHMMSSã€YYYYMMDD æˆ– YYMMDD SQLå‡½æ•° SQLå†…ç½®ä¸€äº›å‡½æ•° SQL Aggregate å‡½æ•° SQL Aggregate å‡½æ•°è®¡ç®—ä»åˆ—ä¸­å–å¾—çš„å€¼ï¼Œè¿”å›ä¸€ä¸ªå•ä¸€çš„å€¼ AVG() - è¿”å›å¹³å‡å€¼ COUNT() - è¿”å›è¿”å›åŒ¹é…æŒ‡å®šæ¡ä»¶çš„è¡Œæ•°,NULL ä¸è®¡å…¥ FIRST() - è¿”å›ç¬¬ä¸€ä¸ªè®°å½•çš„å€¼ LAST() - è¿”å›æœ€åä¸€ä¸ªè®°å½•çš„å€¼ MAX() - è¿”å›æœ€å¤§å€¼ MIN() - è¿”å›æœ€å°å€¼ SUM() - è¿”å›æ€»å’Œ SQL Scalar å‡½æ•° SQL Scalar å‡½æ•°åŸºäºè¾“å…¥å€¼ï¼Œè¿”å›ä¸€ä¸ªå•ä¸€çš„å€¼ UCASE() - å°†æŸä¸ªå­—æ®µè½¬æ¢ä¸ºå¤§å†™ LCASE() - å°†æŸä¸ªå­—æ®µè½¬æ¢ä¸ºå°å†™ MID() - ä»æŸä¸ªæ–‡æœ¬å­—æ®µæå–å­—ç¬¦ï¼ŒMySql ä¸­ä½¿ç”¨SubString(å­—æ®µï¼Œ1ï¼Œend) - ä»æŸä¸ªæ–‡æœ¬å­—æ®µæå–å­—ç¬¦ LEN() - è¿”å›æŸä¸ªæ–‡æœ¬å­—æ®µçš„é•¿åº¦ ROUND() - å¯¹æŸä¸ªæ•°å€¼å­—æ®µè¿›è¡ŒæŒ‡å®šå°æ•°ä½æ•°çš„å››èˆäº”å…¥ NOW() - è¿”å›å½“å‰çš„ç³»ç»Ÿæ—¥æœŸå’Œæ—¶é—´ FORMAT() - æ ¼å¼åŒ–æŸä¸ªå­—æ®µçš„æ˜¾ç¤ºæ–¹å¼123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051/*ä» "access_log" è¡¨çš„ "count" åˆ—è·å–å¹³å‡å€¼*/SELECT AVG(count) AS CountAverage FROM access_log;/* "access_log" è¡¨ä¸­ "site_id"=3 çš„æ€»è®¿é—®é‡ï¼ŒNULL ä¸è®¡å…¥*/SELECT COUNT(count) AS nums FROM access_log WHERE site_id=3;/* "access_log" è¡¨ä¸­æ€»è®°å½•æ•°*/SELECT COUNT(*) AS nums FROM access_log;/* "access_log" è¡¨ä¸­ä¸åŒ site_id çš„è®°å½•æ•°*/SELECT COUNT(DISTINCT site_id) AS nums FROM access_log;/*First()åªæœ‰ MS Accessæ”¯æŒã€‚MySqlä¸­å¯é€šè¿‡LIMITè¿”å›é¦–æ¡è®°å½•*//*é€‰å– "Websites" è¡¨çš„ "name" åˆ—ä¸­ç¬¬ä¸€ä¸ªè®°å½•çš„å€¼*/SELECT name AS FirstSite FROM Websites LIMIT 1;/*åªæœ‰ MS Access æ”¯æŒ LAST() å‡½æ•°ï¼ŒMySqlä¸­å¯é€šè¿‡é™åº+LIMITæ‹¿åˆ°æœ€åä¸€ä¸ªè®°å½•*/SELECT name FROM WebsitesORDER BY id DESC LIMIT 1;/*ä» "Websites" è¡¨çš„ "alexa" åˆ—è·å–æœ€å¤§å€¼*/SELECT MAX(alexa) AS max_alexa FROM Websites;/*ä» "Websites" è¡¨çš„ "alexa" åˆ—è·å–æœ€å°å€¼*/SELECT MIN(alexa) AS min_alexa FROM Websites;/*æŸ¥æ‰¾ "access_log" è¡¨çš„ "count" å­—æ®µçš„æ€»æ•°*/SELECT SUM(count) AS nums FROM access_log;/*ä» "Websites" è¡¨ä¸­é€‰å– "name" å’Œ "url" åˆ—ï¼Œå¹¶æŠŠ "name" åˆ—çš„å€¼è½¬æ¢ä¸ºå¤§å†™*/SELECT UCASE(name) AS site_title, url FROM Websites;/*ä» "Websites" è¡¨ä¸­é€‰å– "name" å’Œ "url" åˆ—ï¼Œå¹¶æŠŠ "name" åˆ—çš„å€¼è½¬æ¢ä¸ºå°å†™*/SELECT LCASE(name) AS site_title, urlFROM Websites;/*ä» "Websites" è¡¨çš„ "name" åˆ—ä¸­æå–å‰ 4 ä¸ªå­—ç¬¦*/SELECT MID(name,1,4) AS ShortTitleFROM Websites;/*ä» "Websites" è¡¨ä¸­é€‰å– "name" å’Œ "url" åˆ—ä¸­å€¼çš„é•¿åº¦*/SELECT name, LENGTH(url) as LengthOfURLFROM Websites;/*å‡è®¾priceä¸º1.32*/SELECT ROUND(price, 1) FROM base_price /*1.3*/SELECT ROUND(price, 0) FROM base_price/*1*/SELECT ROUND(price) FROM base_price /*1.3*/ /*ä» "Websites" è¡¨ä¸­é€‰å– nameï¼Œurlï¼ŒåŠå½“å¤©æ—¥æœŸ*/SELECT name, url, Now() AS dateFROM Websites;/*ä» "Websites" è¡¨ä¸­é€‰å– name, url ä»¥åŠæ ¼å¼åŒ–ä¸º YYYY-MM-DD çš„æ—¥æœŸ*/SELECT name, url, DATE_FORMAT(Now(),'%Y-%m-%d') AS dateFROM Websites; GROUP BYã€HAVING(èšåˆã€åˆ†ç»„) GROUP BY è¯­å¥ç”¨äºç»“åˆèšåˆå‡½æ•°ï¼Œæ ¹æ®ä¸€ä¸ªæˆ–å¤šä¸ªåˆ—å¯¹ç»“æœé›†è¿›è¡Œåˆ†ç»„12345678/*å°†SELECTç»“æœé›†æ ¹æ®site_idåˆ†ç»„èšåˆ*/SELECT site_id, SUM(access_log.count) AS nums FROM access_log GROUP BY site_id;/*å…³è”å¤šä¸ªè¡¨è¿›è¡Œåˆ†ç»„*/SELECT Websites.name,COUNT(access_log.aid) AS nums FROM access_log LEFT JOIN WebsitesON access_log.site_id=Websites.id GROUP BY Websites.name;/*åˆ†ç»„åç­›é€‰å‡ºcount&gt;200çš„è®°å½•*/SELECT Websites.name, Websites.url, SUM(access_log.count) AS nums FROM (access_logINNER JOIN Websites ON access_log.site_id=Websites.id) GROUP BY Websites.name HAVING SUM(access_log.count) &gt; 200; å‚è€ƒ https://www.runoob.com/sql/sql-tutorial.html]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>sql</tag>
        <tag>mysql</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[latex-clean-use-client]]></title>
    <url>%2F2019%2F10%2F16%2Flatex-clean-use-client%2F</url>
    <content type="text"><![CDATA[latexå…¬å¼æ¸²æŸ“åŠåˆ©ç”¨å®¢æˆ·ç«¯åšå…¬å¼èµ„æºçš„æ¸…æ´—èƒŒæ™¯å†å²èƒŒæ™¯ æœ€è¿‘æ¥æ‰‹çš„é¡¹ç›®ä¸­ï¼Œæœ‰å¤§é‡çš„H5æ¸²æŸ“latexå…¬å¼çš„éœ€æ±‚ ç”±äºå†å²åŸå› ï¼Œæˆ‘ä»¬çš„latexå…¬å¼èµ„æºéƒ½æ˜¯é’ˆå¯¹mathjaxå…¬å¼æ¸²æŸ“å¼•æ“å®šåˆ¶åŒ–åˆ¶ä½œçš„ å­˜åœ¨çš„é—®é¢˜æˆ‘ä»¬å­˜åœ¨çš„é—®é¢˜ ç”±äºå†å²åŸå› ï¼Œæˆ‘ä»¬çš„èµ„æºå¤§éƒ¨åˆ†éƒ½æ˜¯é’ˆå¯¹mathjaxåˆ¶ä½œçš„ï¼Œæ— æ³•ç›´æ¥ç”¨katexè¿›è¡Œæ¸²æŸ“ã€‚è€Œmathjaxåœ¨pcç«¯ä½¿ç”¨æ—¶ï¼Œæ•ˆæœã€é€Ÿåº¦å‹‰å¼ºè¿˜èƒ½æ¥å—ï¼Œä½†åœ¨ç§»åŠ¨ç«¯å´å·®å¼ºäººæ„ï¼Œæ¸²æŸ“é€Ÿåº¦æ…¢ï¼Œå…¬å¼é—ªçƒç­‰é—®é¢˜ä¸¥é‡ã€‚ ç¤¾åŒºå†…çš„æ¸²æŸ“æ–¹æ¡ˆ è¦å®ç°latexå…¬å¼çš„æ¸²æŸ“ï¼Œç¤¾åŒºå†…ä¸»æµçš„æ–¹æ¡ˆæœ‰ä¸¤ç§ï¼š ä¸€ï¼Œä½¿ç”¨katexæ¸²æŸ“å¼•æ“æ¥æ¸²æŸ“ã€‚ é€Ÿåº¦å¿«ï¼Œæ¸²æŸ“æ•ˆæœå¥½ å¯¹æ•°æ®æ ¼å¼æœ‰è¦æ±‚ï¼Œéƒ¨åˆ†å­—ç¬¦æ— æ³•æ¸²æŸ“ äºŒï¼Œä½¿ç”¨mathjaxæ¥æ¸²æŸ“ å…¼å®¹æ€§ã€å®¹é”™æ€§å¥½ é€Ÿåº¦è¾ƒæ…¢ è§£å†³æ–¹æ¡ˆï¼ˆæ–¹æ¡ˆ1ï¼‰æ€è·¯ ä¼˜å…ˆä½¿ç”¨æ€§èƒ½é«˜çš„katexè¿›è¡Œæ¸²æŸ“ï¼Œåœ¨katexæ— æ³•æ¸²æŸ“æ—¶ï¼Œå†åˆ‡æ¢åˆ°mathjax å®ç° èµ„æºå¤„ç† æˆ‘ä»¬é’ˆå¯¹æœåŠ¡ç«¯è¿”å›çš„èµ„æºåšäº†ä¸€äº›ç‰¹æ®Šå¤„ç†ã€‚ä¾‹å¦‚ä½¿ç”¨æ­£åˆ™å¯¹èµ„æºè¿›è¡Œè§„èŒƒåŒ–ï¼Œè®©å…¶èƒ½è¢«katex æ¸²æŸ“ã€‚åŒæ—¶ï¼Œå‰”é™¤äº†ä¸€äº›æ— æ³•è¯†åˆ«çš„ç‰¹æ®Šå­—ç¬¦ã€‚ å‡ºé”™é™çº§å¤„ç† katexæ— æ³•æ¸²æŸ“æ—¶ï¼Œä¼šæŠ›å‡ºé”™è¯¯ï¼Œæˆ‘ä»¬æ•è·äº†é”™è¯¯ï¼Œå†åˆ©ç”¨mathjaxè¿›è¡Œæ¸²æŸ“ã€‚12345678910111213141516171819try &#123; return this.htmlString.replace(/\\\(.*?\\\)/g, function(html) &#123; // * å‰”é™¤å¼‚å¸¸å­—ç¬¦ html = html .replace(/&amp;lt;/g, '&lt;') .replace(/&amp;gt;/g, '&gt;') return ( ' ' + katex.renderToString(html, &#123; throwOnError: false, unicodeTextInMathMode: true &#125;) + ' ' ) &#125;)&#125; catch (err) &#123; // * è§£æé”™è¯¯æ—¶ï¼Œé™çº§ä½¿ç”¨MathJax MathJax.Hub.Queue(['Typeset', MathJax.Hub, el])&#125; ç»è¿‡ä¸Šè¿°æ“ä½œï¼Œæ‰€æœ‰å…¬å¼å·²ç»å¯ä»¥æ¸²æŸ“å‡ºæ¥äº†ï¼Œä½†ä»å­˜åœ¨ä¸€äº›é—®é¢˜ã€‚ é—®é¢˜ è™½ç„¶å…¬å¼éƒ½èƒ½æ¸²æŸ“å‡ºæ¥äº†ï¼Œä½†ä»æœ‰é—®é¢˜ å› ä¸ºæ²¡æœ‰å®Œå¤‡çš„ç‰¹æ®Šå­—ç¬¦æ›¿æ¢è¡¨ï¼Œå¯¼è‡´ä»æœ‰éƒ¨åˆ†ç‰¹æ®Šå­—ç¬¦æ— æ³•è¢«katexæ¸²æŸ“ é™çº§ä½¿ç”¨mathjaxæ—¶ï¼Œèƒ½æ˜æ˜¾çœ‹åˆ°å…¬å¼çš„æ¸²æŸ“è¿‡ç¨‹ é¢˜é‡è¿‡å¤§æ—¶ï¼Œç”±äºä¸€æ¬¡æ€§éœ€è¦æ¸²æŸ“çš„å…¬å¼è¾ƒå¤šï¼Œæ— è®ºæ˜¯ä½¿ç”¨katexè¿˜æ˜¯mathjaxåœ¨æ¸²æŸ“æ—¶éƒ½ä¼šæ˜æ˜¾æ„Ÿè§‰åˆ°é¡µé¢çš„å¡é¡¿ é¢˜é‡å¤§æ—¶ï¼Œåˆ—è¡¨æ»šåŠ¨å¡é¡¿ æ–¹æ¡ˆ2æ€è·¯ é’ˆå¯¹é—®é¢˜1 æä¾›ä¸€ä¸ªé”™è¯¯ä¸ŠæŠ¥æœºåˆ¶ï¼Œæ”¶é›†katexæ— æ³•æ¸²æŸ“çš„å­—ç¬¦ é’ˆå¯¹é—®é¢˜2 æ—¢ç„¶ä½¿ç”¨mathjaxé€Ÿåº¦æ…¢ï¼Œé‚£å¹²è„†ä¸ç”¨mathjaxå…¨ä½¿ç”¨katexï¼› éœ€è¦å¯¹èµ„æºè¿›è¡Œæ¸…æ´—(è§„èŒƒåŒ–ã€å‰”é™¤ç‰¹æ®Šå­—ç¬¦) éœ€è¦ä¾èµ–æŠ¥é”™æ”¶é›†æœºåˆ¶ é’ˆå¯¹é—®é¢˜3 å‡å°‘é¦–æ¬¡æ¸²æŸ“çš„é¢˜ç›®æ•°é‡ï¼ˆåˆ†æ—¶æ¸²æŸ“ï¼‰ å®¢æˆ·ç«¯ä¸åšè¿è¡Œæ—¶çš„å…¬å¼çš„æ¸²æŸ“å·¥ä½œï¼Œæ¸²æŸ“å·¥ä½œåç½®ï¼Œäº¤ç»™æœåŠ¡ç«¯ï¼Œæˆ‘ä»¬åªæ‹¿æ¸²æŸ“å¥½çš„htmlå­—ç¬¦ä¸² é’ˆå¯¹é—®é¢˜4 æ— é™åˆ—è¡¨(è™šæ‹Ÿåˆ—è¡¨) å…·ä½“æ–¹æ³• é”™è¯¯ä¸ŠæŠ¥æœºåˆ¶ å¯åœ¨katexæ¸²æŸ“å‡ºé”™æ—¶ï¼Œè°ƒç”¨ä¸ŠæŠ¥æ¥å£ï¼Œå°†é”™è¯¯ä¿¡æ¯åé¦ˆç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯åšç›¸å…³è®°å½•ã€‚ å¯¹èµ„æºè¿›è¡Œå½»åº•çš„æ¸…æ´— æä¾›è§„èŒƒåŒ–ã€å‰”é™¤äº†ç‰¹æ®Šå­—ç¬¦èƒ½è¢«katexæ¸²æŸ“çš„èµ„æºç‰ˆæœ¬ èƒ½å¤Ÿè§£å†³æ ¹æºé—®é¢˜ é—®é¢˜ å·¥ä½œé‡å¤§ï¼Œæ¨åŠ¨éš¾ é¦–æ¬¡æ¸²æŸ“çš„é¢˜ç›®æ•°é‡ï¼Œå¯é‡‡ç”¨åˆ†æ—¶æ¸²æŸ“æ–¹å¼ï¼Œå°†æ¸²æŸ“å‹åŠ›åˆ†æ•£åˆ°ä¸åŒæ—¶é—´ç‚¹ å…¬å¼æ¸²æŸ“åç§»ï¼Œå‰ç«¯ä¸åœ¨è¿è¡Œæ—¶åšå…¬å¼æ¸²æŸ“ï¼Œäº¤ç»™æœåŠ¡ç«¯åšã€‚ å•ç‹¬å°†å…¬å¼çš„ç‰¹æ®Šå­—ç¬¦æ›¿æ¢å’Œæ¸²æŸ“æ”¾åˆ°æœåŠ¡ç«¯å»åšã€‚æœåŠ¡ç«¯åœ¨è¿”å›å…¬å¼èµ„æºæ—¶ï¼Œç›´æ¥è¿”å›ä½¿ç”¨æ¸²æŸ“å¼•æ“æ¸²æŸ“å¥½çš„htmlå­—ç¬¦ä¸²ã€‚è¿™æ ·ï¼Œå®¢æˆ·ç«¯å°±ä¸ç”¨åšå…¬å¼æ¸²æŸ“äº†ï¼Œç›´æ¥å±•ç¤ºæ¸²æŸ“å¥½çš„htmlå­—ç¬¦ä¸²ã€‚ é—®é¢˜ æœåŠ¡ç«¯å¹¶å‘å‹åŠ›å¤§ ssr å°†æ‰€æœ‰å‰ç«¯é¡µé¢ï¼ˆåŒ…æ‹¬å…¬å¼æ¸²æŸ“ï¼‰ç›´æ¥é€šè¿‡ssræ–¹å¼è¾“å‡º é—®é¢˜ ç¼ºä¹ssrç›¸å…³ç»éªŒ ç»¼ä¸Šï¼šé”™è¯¯ä¸ŠæŠ¥æœºåˆ¶æ˜¯å¿…é¡»çš„ã€‚æ ¹æºåœ¨åº•å±‚å…¬å¼èµ„æºï¼Œèµ„æºå¿…é¡»è¦åšæ¸…æ´—ã€‚å…¬å¼æ¸²æŸ“æ”¾åœ¨åç«¯åšï¼Œæ˜¯ä¸€ä¸ªå¯è¡Œæ–¹æ¡ˆï¼Œä½†ä¼šå¢åŠ åç«¯å‹åŠ›ã€‚ æ–¹æ¡ˆ3æ–¹æ¡ˆ2çš„é—®é¢˜ åº•å±‚åšèµ„æºæ¸…æ´—éš¾åº¦è¾ƒå¤§ï¼Œå› ä¸ºèµ„æºæ•°é‡å¤ªåºå¤§ï¼Œæ¸…æ´—æ—¶é—´å¤ªé•¿ï¼ŒæŠ€æœ¯æ–¹æ¡ˆè°ƒç ”ã€å®ç°éœ€è¦äººåŠ›å¤ªå¤šï¼Œæ¨åŠ¨è¾ƒéš¾ã€‚ ssrç»éªŒä¸è¶³ï¼Œå…¬å¸ä¸ç»™è¯•é”™æœºä¼šï¼Œé£é™©è¾ƒå¤§ã€‚æ”¾åœ¨æœåŠ¡ç«¯åšæ¸²æŸ“ï¼Œä¼šåŠ å¤§æœåŠ¡å™¨å‹åŠ› æ–¹æ¡ˆ3çš„æ€è·¯ æ—¢ç„¶èµ„æºæ˜¯å¿…é¡»è¦æ¸…æ´—çš„ï¼Œä½†æœåŠ¡ç«¯å®ç°å‹åŠ›è¾ƒå¤§ï¼Œé‚£æœ‰æ²¡æœ‰å¯èƒ½å°†æ•°æ®æ¸…æ´—çš„ä¸»è¦å·¥ä½œè½¬ç§»åˆ°å‰ç«¯ï¼Ÿ å‰ç«¯å°†æ¸²æŸ“å¥½çš„å…¬å¼htmlå­—ç¬¦ä¸² å›ä¼ ç»™æœåŠ¡ç«¯ä¾›å…¶ä»–è°ƒç”¨è€…ä½¿ç”¨ è¿™æ ·å‡è½»äº†æœåŠ¡ç«¯å‹åŠ›ï¼Œå®é™…çš„æ¸²æŸ“åœ¨å®¢æˆ·ç«¯å®Œæˆ åˆ©ç”¨å®¢æˆ·ç«¯åšå…¬å¼èµ„æºçš„æ¸…æ´— å‰ç«¯ä»ç„¶ä½¿ç”¨æ–¹æ¡ˆ1çš„æ–¹å¼è¿›è¡Œæ¸²æŸ“ï¼Œåœ¨katexæŠ¥é”™æ—¶ï¼Œå°†æ— æ³•æ¸²æŸ“çš„å­—ç¬¦ä¸ŠæŠ¥æœåŠ¡ç«¯ï¼ŒåæœŸè¿›è¡Œäººå·¥æ¸…æ´—ã€‚æœ¬åœ°ç»§ç»­ä½¿ç”¨mathjaxæ¸²æŸ“ã€‚è‹¥katexæœªæŠ¥é”™ï¼Œåˆ™åœ¨æ¸²æŸ“ç”ŸæˆhtmlèŠ‚ç‚¹åã€‚å°†å…¬å¼çš„htmlç¬¦ä¸²å›ä¼ ç»™æœåŠ¡ç«¯ æœåŠ¡ç«¯å°†å…¬å¼htmlå­—ç¬¦ä¸²ä¿å­˜èµ·æ¥ï¼Œå¹¶æä¾›ç»™å…¶ä»–è°ƒç”¨è€…ä½¿ç”¨ å‰ç«¯åœ¨æ‹¿åˆ°æ•°æ®åï¼Œè‹¥å‘ç°å·²ç»æœ‰æ¸²æŸ“å¥½çš„å…¬å¼htmlå­—ç¬¦ä¸²ï¼Œåˆ™ç›´æ¥å°†å…¶æ’å…¥åˆ°å¯¹åº”èŠ‚ç‚¹ï¼Œå¦åˆ™ï¼Œè°ƒç”¨æ¸²æŸ“å¼•æ“è¿›è¡Œæ¸²æŸ“ï¼Œå¹¶é‡å¤1çš„æ­¥éª¤ ç»è¿‡ä¸Šè¿°æ­¥éª¤ï¼ŒæœåŠ¡ç«¯å°†ä¼šé€æ­¥å®Œæˆèµ„æºçš„æ¸…æ´—å·¥ä½œã€‚ ä¼˜ç¼ºç‚¹ ä¼˜ç‚¹ æœåŠ¡ç«¯å‹åŠ›å‡å°ï¼Œå°†æ¸…æ´—å·¥ä½œåˆ†æ•£åˆ°å®¢æˆ·ç«¯ä¸Šï¼Œåˆ©ç”¨å®¢æˆ·ç«¯å®Œæˆèµ„æºçš„æ¸…æ´—å·¥ä½œ å®æ–½éš¾åº¦è¾ƒå° ç¼ºç‚¹ å‰ç«¯å·¥ä½œé‡åŠ å¤§ï¼Œæ¸…æ´—æ—¶é—´åŠ é•¿ æ‰©å±• å‰ç«¯å›ä¼ æ—¶ï¼Œå¯ä»¥æºå¸¦å…¬å¼æ¸²æŸ“åçš„ç›¸å…³ä¿¡æ¯ ä¾‹å¦‚å…¬å¼æ¸²æŸ“æ—¶çš„å­—ä½“å¤§å°ã€å…¬å¼æ¸²æŸ“åçš„å®é™…é«˜åº¦ é«˜åº¦åœ¨åšæ— é™åˆ—è¡¨(è™šæ‹Ÿåˆ—è¡¨)æ—¶ï¼Œæ˜¯ä¸€ä¸ªå¿…è¦å­—æ®µï¼Œä¹‹å‰è¾ƒéš¾è·å–åˆ°å…¬å¼æ¸²æŸ“åçš„å®é™…é«˜åº¦ å®¢æˆ·ç«¯è¿˜å¯ä»¥åˆ©ç”¨canvasç”Ÿæˆå…¬å¼æ¸²æŸ“åçš„å›¾ç‰‡å¹¶å›ä¼ ç»™æœåŠ¡ç«¯ã€‚å¯ä¾›ä¸åŒåœºæ™¯ä½¿ç”¨ã€‚]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>latex</tag>
        <tag>clean</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[eslint-prettier-husky-lint-staged]]></title>
    <url>%2F2019%2F03%2F17%2Feslint-prettier-husky-lint-staged%2F</url>
    <content type="text"><![CDATA[ESLint + Prettier + Husky + lint-staged æ‰“é€ ä»£ç æ£€æŸ¥å·¥ä½œæµ è®°å½•æ­å»ºä»£ç æ£€æŸ¥å·¥ä½œæµçš„ç›¸å…³é—®é¢˜ åŸºæœ¬ä»‹ç» ESLint ä»£ç æ£€æŸ¥å·¥å…· ç‰¹ç‚¹ ä»£ç é™æ€æ£€æŸ¥ æå‰å‘ç°ä½çº§è¯­æ³•é”™è¯¯ ä»£ç é£æ ¼æ£€æŸ¥ æ£€æŸ¥ä»£ç é£æ ¼ å…³äºeslintçš„é…ç½®å¯ä»¥æŸ¥é˜…æˆ‘ä¹‹å‰çš„æ–‡ç« ï¼Œæœ‰è¯¦ç»†è§£é‡Š Prettier ä»£ç æ ¼å¼åŒ–å·¥å…· ç‰¹ç‚¹ æœ‰ä¸€å¥—è‡ªå·±çš„æ ¼å¼åŒ–è§„èŒƒ åŸºæœ¬æ”¯æŒå‰ç«¯æ¶‰åŠçš„æ‰€æœ‰è¯­è¨€ jsã€jsxã€cssã€htmlã€mdç­‰ç­‰ ESLintã€Prettier äºŒè€…å¼‚åŒ eslintè¿˜æ˜¯ä¾§é‡äºä»£ç é™æ€æ£€æŸ¥ã€prettierä¾§é‡äºä»£ç æ ¼å¼åŒ– eslintä½¿ç”¨--fixä¹Ÿå¯ä»¥æ ¹æ®ç‰¹å®šä»£ç é£æ ¼è¿›è¡Œä¸€äº›æ ¼å¼åŒ–å·¥ä½œï¼› Husky åœ¨gitä¸­æä¾›precommitã€prepushé’©å­ï¼Œå¯åœ¨å…¶ä¸­æ‰§è¡Œä¸€äº›è„šæœ¬ lint-staged å¯é’ˆå¯¹æ·»åŠ åˆ°git æš‚å­˜åŒºä¸­ä¸åŒæ ¼å¼çš„æ–‡ä»¶ï¼Œåˆ†åˆ«æ‰§è¡Œä¸åŒçš„è„šæœ¬ å·¥å…·ä»‹ç»ESLint ç›¸å…³ é€šè¿‡npm install eslintå®‰è£…çš„ å¯ä»¥ç”¨æ¥æ‰§è¡Œeslint å‘½ä»¤ å¦‚eslint --fixã€eslitn --ext .js,.vue src é€šè¿‡webpackä¸­çš„eslint-loaderå¯ä»¥å®ç°ä¿å­˜æ—¶è‡ªåŠ¨ä¿®å¤ VSCodeä¸­çš„æ‰©å±•ESLint å®ƒä¼šè¯»å–é¡¹ç›®ä¸­çš„eslint é…ç½®æ–‡ä»¶ï¼Œç„¶åå¯åŠ¨ä¸€ä¸ªlintæœåŠ¡ï¼Œåœ¨vscodeä¸­æ™ºèƒ½æç¤ºä¸ç¬¦åˆé¡¹ç›®eslint é…ç½®çš„ä»£ç  é€šè¿‡é…ç½®eslint.autoFixOnSaveï¼Œå¯ä»¥å®ç°ä¿å­˜æ—¶ï¼Œæ ¹æ®é…ç½®æ–‡ä»¶è§„åˆ™ï¼Œè‡ªåŠ¨ä¿®å¤ä¸€äº›ä»£ç é—®é¢˜ï¼ˆå¤§éƒ¨åˆ†éƒ½æ˜¯ä¸€äº›ä»£ç é£æ ¼ç›¸å…³çš„é—®é¢˜ï¼‰ eslint-loader åœ¨webpackä¸­é…åˆeslintä½¿ç”¨çš„loader é€šè¿‡é…ç½®å¯å®ç°åœ¨æ¯æ¬¡æ‰“åŒ…æ—¶ï¼Œè‡ªåŠ¨ lintï¼›å¦‚ç”¨ vue-cli2.x åˆå§‹åŒ–çš„é¡¹ç›®ä¸­ä¸‹é¢ä»£ç  12345678910111213module:&#123; rules:[ &#123; test: /\.(js|vue)$/, loader: 'eslint-loader', enforce: 'pre', // é‡åˆ°jsã€vueæ–‡ä»¶æ—¶ï¼Œä¼šç¬¬ä¸€ä¸ªè°ƒç”¨æ­¤loaderï¼› include: [resolve('src'), resolve('test')], options: &#123; formatter: require('eslint-friendly-formatter'), emitWarning: !config.dev.showEslintErrorsInOverlay &#125; ]&#125; eslint-friendly-formatter å¯ä»¥è¾“å‡ºæ›´å‹å¥½çš„é”™è¯¯æç¤ºï¼›å¦‚åŒ…å«è¿åè§„åˆ™çš„æ–‡ä»¶åœ°å€å’Œè§„åˆ™è§£é‡Šç½‘å€ Prettier ç›¸å…³ é€šè¿‡npm install prettierå®‰è£…çš„prettier cli å¯ä»¥è°ƒç”¨prettierçš„ä¸€äº›å‘½ä»¤ï¼›å¦‚prettier --wirte test.jsæ¥å®ç°test.jsçš„æ ¼å¼åŒ– æ›´å¤šå‘½ä»¤å¯æŸ¥çœ‹https://prettier.io/docs/en/cli.html ä¼šè¯»å–é¡¹ç›®ä¸­çš„.pretterrcé…ç½®æ–‡ä»¶ VSCodeä¸­çš„æ‰©å±•Prettier æœ¬è´¨æ˜¯å†…éƒ¨è°ƒç”¨pretter-cli æ­¤æ‰©å±•å†…éƒ¨å†…ç½®äº†prettieræ ¼å¼åŒ–è§„åˆ™ï¼Œä¸è¿‡åªæš´éœ²äº†æå°‘çš„é…ç½®é€‰é¡¹ã€‚ é…ç½®è¯»å–ä¼˜å…ˆçº§ ä¼šä¼˜å…ˆè¯»å–.prettierrcæ–‡ä»¶ ä¸å­˜åœ¨åˆ™è¯»å–.editorconfigæ–‡ä»¶ å…¶æ¬¡è¯»å–æ’ä»¶è‡ªèº«é…ç½®é€‰é¡¹ å¯ä»¥é…åˆESLintã€TSLintä½¿ç”¨ æœ‰prettier.eslintIntegrationé€‰é¡¹ è®¾ç½®ä¸ºtrueåï¼Œå†…éƒ¨ä¼šä½¿ç”¨eslint-prettieræ›¿æ¢prettier-cli eslint-pretter ä¼šå°†æ ¼å¼åŒ–çš„ä»£ç ä¼ é€’ç»™eslint --fix Code â¡ï¸ prettier â¡ï¸ eslint â€“fix â¡ï¸ Formatted Code vetur VSCodeä¸­çš„vueæ‰©å±•ï¼Œå¼€å‘vueå¿…å¤‡ è‡ªå¸¦lintåŠŸèƒ½(éœ€è¦é…åˆeslintæ’ä»¶ä½¿ç”¨) è‡ªå¸¦formatåŠŸèƒ½ å†…ç½®prettier è‹¥æœ¬åœ°å®‰è£…äº†prettierï¼Œåˆ™ä¼šä½¿ç”¨æœ¬åœ°prettier å†…ç½®prettierä¹Ÿä¼šè¯»å–.prettierrcæ–‡ä»¶è¿›è¡Œæ ¼å¼åŒ–å·¥ä½œ å¯ä»¥é’ˆå¯¹.vueæ–‡ä»¶ä¸­çš„ä¸åŒéƒ¨åˆ†è®¾ç½®ä¸åŒçš„formatter å¯å‚è€ƒhttps://vuejs.github.io/vetur/formatting.html#settings ESLint+Prettier ç›¸å…³ eslint-config-prettier å…³é—­eslintä¸­ä¸prettierå†²çªçš„rules eslint-plugin-prettier ä¼šå¯¹æ¯”æ ¼å¼åŒ–å‰åçš„ä»£ç ï¼Œå°†ä¸ä¸€è‡´çš„åœ°æ–¹æ ‡è®°ä¸ºé”™è¯¯ï¼Œåœ¨ eslint ä¸­æŠ›å‡º VSCode çš„è®¾ç½® editer.autoFormatOnSave ç¼–è¾‘å™¨çš„è‡ªåŠ¨æ ¼å¼åŒ–ï¼Œä¼šè°ƒç”¨ä¸€ä¸ªæ ¼å¼åŒ–å™¨ å®ƒæ˜¯æ€»å¼€å…³ï¼Œè‹¥ä¸º false,æ‰€æœ‰æ ¼å¼åŒ–å·¥å…·å°†ä¸èƒ½åœ¨ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ– ç›®æ ‡ ä»£ç çš„æ£€æŸ¥å’Œæ ¼å¼åŒ–å·¥ä½œï¼Œåœ¨é¡¹ç›®å†…è°ƒç”¨å‘½ä»¤å³å¯å®Œæˆï¼Œæ— éœ€ä¾èµ–ç¼–è¾‘å™¨é…ç½®ï¼› é’ˆå¯¹ä½¿ç”¨vue-cliåˆ›å»ºçš„é¡¹ç›® é’ˆå¯¹jsã€vueæ–‡ä»¶ä½¿ç”¨vue-cliå®˜æ–¹æ¨èçš„çš„è§„åˆ™æ¥æ£€æŸ¥ï¼ˆæˆ‘ä»¬å›¢é˜Ÿä¹ æƒ¯ä½¿ç”¨plugin:vue/recommendedï¼‰ å…¶å®ƒç±»å‹æ–‡ä»¶ä¸éœ€è¦lintï¼Œç›´æ¥ä½¿ç”¨prettieræ¥åšæ ¼å¼åŒ–å·¥ä½œ ç›´æ¥å¯ç”¨ vue-cli å†…éƒ¨é›†æˆçš„ eslint vue-cliåˆ›å»ºçš„é¡¹ç›®å†…éƒ¨å·²ç»é›†æˆäº†eslintï¼Œå¹¶é…ç½®å¥½äº†ç›¸å…³é…ç½®ï¼›æˆ‘ä»¬åªéœ€è¦å®‰è£…ç›¸å…³ä¾èµ–ï¼Œå¹¶åœ¨é…ç½®ä¸­å¯ç”¨å³å¯ å¼€å¯åï¼Œåœ¨å¼€å‘ç¯å¢ƒå°±å¯åœ¨webpackæ¯æ¬¡bundleæ—¶è‡ªåŠ¨lint 1234567891011121314151617181920212223242526272829// build/webpack.base.conf.js'use strict'const path = require('path')const utils = require('./utils')const config = require('../config')const vueLoaderConfig = require('./vue-loader.conf')function resolve(dir) &#123;return path.join(__dirname, '..', dir)&#125;const createLintingRule = () =&gt; (&#123; test: /\.(js|vue)$/, loader: 'eslint-loader', enforce: 'pre', include: [resolve('src'), resolve('test')], options: &#123; formatter: require('eslint-friendly-formatter'), emitWarning: !config.dev.showEslintErrorsInOverlay &#125;&#125;)...// config/index.jsmodule.exports = &#123; dev:&#123; ... useEslint:true // å¼€å¯å³å¯ &#125; ä¼˜ç¼ºç‚¹ ä¼˜ç‚¹ è¿™æ˜¯æœ€å¿«æ·ã€æœ€å¿«é€Ÿçš„åŠæ³• ç¼ºç‚¹ webpackæ¯æ¬¡bundleæ—¶ï¼Œéƒ½ä¼šè¿›è¡Œå…¨å±€lintï¼Œæ•ˆç‡è¾ƒä½ï¼› å¯ä»¥é€šè¿‡é…ç½®cacheæœ‰æ‰€ç¼“è§£ eslintä»…é’ˆå¯¹.jsã€.vueå®ç°äº†æ£€æŸ¥å’Œæ ¼å¼åŒ–ï¼Œä½†å…¶å®ƒæ–‡ä»¶å¦‚.mdçš„æ ¼å¼åŒ–å¹¶æœªå®ç° ESLint + Prettier é…åˆä½¿ç”¨ESLint + Prettier å¦‚ä½•é…åˆä½¿ç”¨ ESLint ä¾§é‡ä»£ç é™æ€æ£€æŸ¥ Prettier ä¾§é‡ä»£ç é£æ ¼æ ¼å¼åŒ– ä½•ä¸å°†äºŒè€…ç»“åˆèµ·æ¥å‘¢ï¼Ÿ Prettierå®˜æ–¹æ–‡æ¡£ä»‹ç»äº† 3 ç§å°†Prettierç»“åˆESLintä½¿ç”¨çš„æ–¹æ³• https://prettier.io/docs/en/eslint.html ä½¿ç”¨eslint-plugin-prettier ä¼šå¯¹æ¯”æ ¼å¼åŒ–å‰åçš„ä»£ç ï¼Œå°†ä¸ä¸€è‡´çš„åœ°æ–¹æ ‡è®°ä¸ºé”™è¯¯ï¼Œåœ¨ eslint ä¸­æŠ›å‡º 1234567// .eslintrc&#123; "plugins": ["prettier"], "rules": &#123; "prettier/prettier": "error" &#125;&#125; ä½¿ç”¨eslint-config-prettier å…³é—­eslintä¸­ä¸prettierå†²çªçš„rules 1234// .eslintrc&#123; "extends": ["prettier"]&#125; ä½¿ç”¨&quot;plugin:prettier/recommended&quot; ç»“åˆäº† 1ã€2 æ–¹æ³•ï¼›æ¨èä½¿ç”¨ 1234// .eslintrc&#123; "extends": ["plugin:prettier/recommended"]&#125; é’ˆå¯¹évueé¡¹ç›®ï¼Œè¿™ä¹ˆé…ç½®å°±å¯ä»¥åœ¨eslint --fixæ—¶ä½¿ç”¨eslintåšä»£ç æ£€æŸ¥ï¼Œä½¿ç”¨prettieråšæ ¼å¼åŒ–äº† äºŒè€…ç»“åˆä½¿ç”¨æ—¶ï¼Œå¯èƒ½ä¼šé‡åˆ°äºŒè€…æ ¼å¼åŒ–ç›¸å…³è§„åˆ™å†²çªçš„é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨vueé¡¹ç›®ä¸­å°±é‡åˆ°äº†ä¸€äº›é—®é¢˜ ç»“åˆä½¿ç”¨æ—¶é‡åˆ°çš„é—®é¢˜ æˆ‘ä»¬å›¢é˜Ÿå†…éƒ¨ä¹ æƒ¯ä½¿ç”¨plugin:vue/recommendedå’Œstandardè§„åˆ™ æˆ‘ä»¬å°è¯•å°†å…¶åŒPrettieræ ¼å¼åŒ–ç›¸å…³è§„åˆ™ç»“åˆä¸€èµ· 123&#123; "extends": ["plugin:vue/recommended","plugin:prettier/recommended","standard"]&#125; æˆ‘ä»¬å‘ç°ä¿å­˜è‡ªåŠ¨æ ¼å¼åŒ–æ—¶&quot;plugin:vue/recommended&quot;,&quot;plugin:prettier/recommended&quot;è¿™ä¸¤ä¸ªè§„åˆ™ä¼šäº§ç”Ÿå¾ˆå¤šå†²çª ä¾‹å¦‚ï¼ŒäºŒè€…ä¼šå› ä¸ºä¼ é€’ç»™ç»„ä»¶çš„propsæ˜¯å¦éœ€è¦åœ¨åŒä¸€è¡Œè¿˜æ˜¯å¦èµ·ä¸€è¡Œäº§ç”Ÿå†²çªã€‚æœ€åå¯¼è‡´ä»£ç é”™è¯¯ã€‚ è§£å†³æ–¹æ³• å…³é—­å…¶ä¸­ä¸€ç§è§„åˆ™ ä¸ä½¿ç”¨plugin:vue/recommendedï¼Œæ”¹ç”¨çº¦æŸæ€§è¾ƒä½çš„plugin:vue/essentialè§„åˆ™ æˆ‘ä»¬å‘ç°æˆ‘ä»¬è¿˜æ˜¯æ›´å€¾å‘äºplugin:vue/recommendedä¸­å®šä¹‰çš„è§„åˆ™ï¼Œæ‰€ä»¥æˆ‘ä»¬å†³å®šåœ¨vueæ–‡ä»¶ä¸­ä¸ä½¿ç”¨&quot;plugin:prettier/recommended&quot;è§„åˆ™æ¥åšæ ¼å¼åŒ–ï¼›åœ¨å…¶ä»–æ–‡ä»¶ä¸­è°ƒç”¨prettier --writeæ¥æ ¼å¼åŒ– 123&#123; "extends": ["plugin:vue/recommended","standard"]&#125; æ— è®ºæ˜¯ç›´æ¥å¯ç”¨vue-clié…ç½®è¿˜æ˜¯ç»“åˆprettierä½¿ç”¨ï¼Œåœ¨æˆ‘ä»¬é¡¹ç›®ä¸­éƒ½æœ‰ä¸€äº›é—®é¢˜ å‰è€…å¯ä»¥åœ¨bundleæ—¶è‡ªåŠ¨lintï¼Œä½†æ²¡æœ‰ä½¿ç”¨prettier åè€…è™½ä½¿ç”¨äº†prettierï¼Œå´æ— æ³•è‡ªåŠ¨è°ƒç”¨ ä½¿ç”¨ husky+lint-staged æ”¹è¿› å…³é—­vue-cliè‡ªå¸¦çš„bundleæ—¶lintçš„é…ç½®ï¼›åœ¨git commitä¹‹å‰è‡ªåŠ¨åšlintæ£€æŸ¥å’Œprettieræ ¼å¼åŒ– huskyå’Œlint-stagedçš„ä½œç”¨ä¸Šé¢å·²ç»åšè¿‡ä»‹ç»ï¼Œä¸åšèµ˜è¿°ï¼Œç›´æ¥å±•ç¤ºé…ç½® 12345678910111213141516// package.json"husky": &#123; "hooks": &#123; "pre-commit": "lint-staged" &#125;&#125;,"lint-staged": &#123; "*.&#123;js,vue&#125;": [// é’ˆå¯¹jsã€vueæ–‡ä»¶ä½¿ç”¨eslint --fixæ¥åšæ£€æŸ¥å’Œæ ¼å¼åŒ– "eslint --fix", "git add" ], "*.&#123;json,css,scss,less,sass,md,html,flow,ts,tsd&#125;": [ // é’ˆå¯¹éjsã€vueæ–‡ä»¶ä½¿ç”¨pretteræ ¼å¼åŒ– "prettier --write", "git add" ]&#125; è¿™æ ·åŸºæœ¬å®ç°äº†ï¼Œå›¢é˜Ÿå†…éƒ¨æäº¤çš„ä»£ç é£æ ¼ä¸€è‡´ï¼Œå®Œæˆäº†é¢„å®šç›®æ ‡ ä½†æˆ‘ä»¬å›¢é˜Ÿå†…éƒ¨ä½¿ç”¨çš„éƒ½æ˜¯vscodeï¼Œå¤§å®¶ä¸æƒ³åœ¨æäº¤ä»£ç æ—¶å†åšæ£€æŸ¥å’Œæ ¼å¼åŒ–ï¼›å¸Œæœ›èƒ½åœ¨å¼€å‘ã€ä¿å­˜æ—¶å°±èƒ½å‘ç°é”™è¯¯ã€æ ¼å¼åŒ– VSCode ä¸­å®ç°è‡ªåŠ¨æç¤ºé”™è¯¯ï¼Œä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ– åœ¨ä¸Šä¸€æ­¥é…ç½®çš„åŸºç¡€ä¸Šï¼Œå†å€ŸåŠ©VSCodeçš„ESLintã€Prettierã€Veturæ‰©å±•å°±å¯ä»¥å®Œæˆæ­¤ç›®æ ‡ ä¸‰ä¸ªæ‰©å±•çš„ä½œç”¨å¯ä»¥çœ‹æ–‡ç« å‰é¢çš„ä»‹ç» æˆ‘ä»¬å¸Œæœ›é’ˆå¯¹jsã€vueæ–‡ä»¶ï¼Œåœ¨ä¿å­˜æ—¶ï¼Œè‡ªåŠ¨å‘ç°ä½çº§é”™è¯¯å¹¶æ ¼å¼åŒ–ï¼›å…¶å®ƒæ ¼å¼æ–‡ä»¶åœ¨ä¿å­˜æ—¶å¯ä»¥è‡ªåŠ¨æ ¼å¼åŒ– é¦–å…ˆå®‰è£…ESLintã€Prettierã€Veturã€Setting Syncæ‰©å±• é…ç½®ESLintæ‰©å±•ï¼Œå¼€å¯ä¿å­˜æ—¶è‡ªåŠ¨ä¿®å¤ 123456789101112131415// settings.json// * ------------------// * eslintç›¸å…³// * ------------------"eslint.enable": true,"eslint.alwaysShowStatus": true, // å§‹ç»ˆå±•ç¤ºeslintçŠ¶æ€"eslint.validate": ["javascript","javascriptreact", &#123; "language": "vue", "autoFix": true // è‡ªåŠ¨ä¿®å¤.vueæ–‡ä»¶çš„é”™è¯¯å’Œå®Œæˆæ ¼å¼åŒ–å·¥ä½œ &#125;],"eslint.autoFixOnSave": true // ä¿å­˜æ—¶è‡ªåŠ¨ä¿®å¤ å¼€å¯vscodeçš„ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–é€‰é¡¹ 12345// settings.json// ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–ã€‚éœ€è¦å€ŸåŠ©æ ¼å¼åŒ–å™¨ï¼›// è‹¥æ­¤é¡¹ä¸ºfalseï¼Œåˆ™æ‰€æœ‰æ ¼å¼åŒ–å™¨ï¼ˆpretteræ’ä»¶ï¼‰ä¸èƒ½åœ¨ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–ï¼›// é€šè¿‡npmåŒ…å®‰è£…çš„æ ¼å¼åŒ–å™¨å¦‚prettierã€ESLintä¸å—æ­¤é¡¹é™åˆ¶ã€‚"editor.formatOnSave": true, åœ¨vueæ–‡ä»¶ä¸­ç¦ç”¨pretteræ‰©å±• 1"prettier.disableLanguages": ["vue"], åœ¨vueæ–‡ä»¶ä¸­ç¦ç”¨veturçš„æ ¼å¼åŒ–é€‰é¡¹ 12"vetur.format.defaultFormatter.html": "none","vetur.format.defaultFormatter.js": "none", å®Œæ•´settings.jsoné…ç½®å¦‚ä¸‹ 12345678910111213141516171819202122232425262728293031323334353637383940&#123;// * ------------------// * æ ¼å¼åŒ–ç›¸å…³// * ä¸»è¦æ€è·¯ï¼š// * .jså’Œ.vueæ–‡ä»¶ä½¿ç”¨eslint+eslint-plugin-vueé…åˆautoFixæ¥åšä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–ï¼›// * .vueæ–‡ä»¶ä¸­ç¦ç”¨prettierå’Œveturå¯¹templateå’Œscriptéƒ¨åˆ†çš„æ ¼å¼åŒ–// * å…¶ä»–ç±»å‹æ–‡ä»¶å¦‚.cssã€.sassã€.mdç­‰éƒ½ä½¿ç”¨prettieræ’ä»¶æ¥æ ¼å¼åŒ–// * ------------------// ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–ã€‚éœ€è¦å€ŸåŠ©æ ¼å¼åŒ–å™¨ï¼›// è‹¥æ­¤é¡¹ä¸ºfalseï¼Œåˆ™æ‰€æœ‰æ ¼å¼åŒ–å™¨ï¼ˆpretteræ’ä»¶ï¼‰ä¸èƒ½åœ¨ä¿å­˜æ—¶è‡ªåŠ¨æ ¼å¼åŒ–ï¼›// é€šè¿‡npmåŒ…å®‰è£…çš„æ ¼å¼åŒ–å™¨å¦‚prettierã€ESLintä¸å—æ­¤é¡¹é™åˆ¶ã€‚"editor.formatOnSave": true,// prettieræ’ä»¶é…ç½®// è¯»å–é…ç½®çš„ä¼˜å…ˆçº§å¦‚ä¸‹// .prettierrcæ–‡ä»¶ &gt; .editorconfig &gt; prettieræ’ä»¶é€‰é¡¹"prettier.tabWidth": 2,"prettier.singleQuote": true,"prettier.semi": false,// åœ¨vueä¸­ä½¿ç”¨eslint+eslint-plugin-vueå¹¶é…åˆautoFixæ¥åšæ ¼å¼åŒ–ï¼Œæ‰€ä»¥åœ¨vueä¸­ç¦ç”¨prettieræ’ä»¶"prettier.disableLanguages": ["vue"],// veturé…ç½®// veturä¸­è‡ªå¸¦prettieræ ¼å¼åŒ–å™¨ï¼Œå…¶ä¹Ÿä¼šè¯»å–é¡¹ç›®ä¸­çš„.prettierrcé…ç½®æ–‡ä»¶// åœ¨.vueæ–‡ä»¶ä¸­å°†å…¶ç¦ç”¨ï¼Œä½¿ç”¨eslint+eslint-plugin-vueé…åˆautoFixæ¥æ ¼å¼åŒ–ï¼›ä»…ä½¿ç”¨veturä¸­çš„prettieræ¥æ ¼å¼åŒ–vueæ–‡ä»¶ä¸­çš„csséƒ¨åˆ†"vetur.format.defaultFormatter.html": "none","vetur.format.defaultFormatter.js": "none",// * ------------------// * eslintç›¸å…³// * ------------------"eslint.enable": true,"eslint.alwaysShowStatus": true, // å§‹ç»ˆå±•ç¤ºeslintçŠ¶æ€"eslint.validate": ["javascript","javascriptreact",&#123;"language": "vue","autoFix": true // è‡ªåŠ¨ä¿®å¤.vueæ–‡ä»¶çš„é”™è¯¯å’Œå®Œæˆæ ¼å¼åŒ–å·¥ä½œ&#125;],"eslint.autoFixOnSave": true // ä¿å­˜æ—¶è‡ªåŠ¨ä¿®å¤&#125; é—®é¢˜ ä¸Šè¿°é…ç½®æ˜¯å»ºç«‹åœ¨ä½¿ç”¨äº†vue-cliåˆ›å»ºé¡¹ç›®ï¼Œå¹¶ä¸”é¡¹ç›®ä¸­å­˜åœ¨eslintçš„é…ç½®æ–‡ä»¶æ—¶ï¼Œå¦‚æœé¡¹ç›®ä¸­æ²¡æœ‰eslinté…ç½®æ–‡ä»¶ï¼Œé‚£ä¹ˆ.vueæ–‡ä»¶å°†æ— æ³•æ ¼å¼åŒ–ã€‚ è§£å†³æ–¹æ³• æ³¨é‡Šæ‰åœ¨.vueæ–‡ä»¶ç¦ç”¨prettierç›¸å…³è®¾ç½® 123// "prettier.disableLanguages": ["vue"],// "vetur.format.defaultFormatter.html": "none",// "vetur.format.defaultFormatter.js": "none", PS: VSCodeè®¾ç½®çš„å…±äº«ï¼Œå¯ä»¥å€ŸåŠ©Settings Syncæ‰©å±•æ¥å®ç°ï¼Œå…·ä½“æ–¹æ³•å¯ google å‚è€ƒ https://nice.lovejade.cn/zh/article/beautify-vue-by-eslint-and-prettier.html#pre-commit-hook-çº¦æŸä»£ç æäº¤]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>eslint</tag>
        <tag>prettier</tag>
        <tag>husky</tag>
        <tag>lint-staged</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[npm-pre-post]]></title>
    <url>%2F2019%2F03%2F17%2Fnpm-pre-post%2F</url>
    <content type="text"><![CDATA[npm script çš„ preã€post é’©å­åŠåœ¨ pre commit æ—¶è¿›è¡Œ lintpreã€post é’©å­ä»‹ç» npm runä¸ºæ¯æ¡å‘½ä»¤æä¾›äº†pre-å’Œpost-ä¸¤ä¸ªé’©å­ï¼ˆhookï¼‰ã€‚ ä»¥npm run lintä¸ºä¾‹ï¼Œæ‰§è¡Œè¿™æ¡å‘½ä»¤ä¹‹å‰ï¼Œnpmä¼šå…ˆæŸ¥çœ‹æœ‰æ²¡æœ‰å®šä¹‰prelintå’Œpostlintä¸¤ä¸ªé’©å­ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå°±ä¼šå…ˆæ‰§è¡Œnpm run prelintï¼Œç„¶åæ‰§è¡Œnpm run lintï¼Œæœ€åæ‰§è¡Œnpm run postlint å¯ä»¥åœ¨è¿™ä¸¤ä¸ªé’©å­ä¸­æ¥å®Œæˆä¸€äº›å…¶å®ƒäº‹æƒ…ï¼Œå¦‚åœ¨æ‰§è¡Œtestå‰å…ˆæ‰§è¡Œlintæ“ä½œ ç¤ºä¾‹123456789"scripts": &#123; "dev": "webpack-dev-server --inline --progress --config build/webpack.dev.conf.js", "start": "npm run dev", "lint": "eslint --ext .js,.vue src", "test": "karma start --log-leve=error karma.config.js --single-run=true", "pretest": "npm run lint", "posttest": "echo 'Finished running tests'"&#125; æ‰§è¡Œnpm run testæ—¶ä¼šå…ˆæ‰§è¡Œnpm run pretestå†æ‰§è¡Œnpm run testæœ€åæ‰§è¡Œnpm run posttest ä¸­é—´ä»»æ„ä¸€ç¯èŠ‚æŠ¥é”™ï¼Œå°±ä¼šä¸­æ–­åç»­æ‰§è¡Œ ä¸èƒ½åœ¨preè„šæœ¬ä¹‹å‰å†åŠ preï¼Œå³prepretestè„šæœ¬ä¸èµ·ä½œç”¨ã€‚ å³ä½¿npmå¯ä»¥è‡ªåŠ¨è¿è¡Œpreå’Œpostè„šæœ¬ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨æ‰§è¡Œå®ƒä»¬ ç¼ºé™· preã€posté’©å­åªèƒ½åœ¨npm runæ—¶ç”Ÿæ•ˆï¼Œæ²¡æ³•åœ¨å…¶ä»–åœºæ™¯ä½¿ç”¨ï¼› å¦‚éœ€è¦åœ¨git commitæ—¶å…ˆlintä»£ç  æ”¹è¿› ä½¿ç”¨husky huskyä»‹ç» husky å¯ä»¥åœ¨git commitå’Œgit pushæ—¶æ‰§è¡Œè‡ªå®šä¹‰è„šæœ¬ å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§åœ¨commitæ—¶åšlintå·¥ä½œ ç¤ºä¾‹12345678910"scripts": &#123; "dev": "webpack-dev-server --inline --progress --config build/webpack.dev.conf.js", "start": "npm run dev", "lint": "eslint --ext .js,.vue src",&#125;,"husky": &#123; "hooks": &#123; "pre-commit": "npm run lint" // åœ¨commitå‰æ‰§è¡Œnpm run lint &#125;&#125; æ³¨æ„ è€ç‰ˆæœ¬huskyçš„é’©å­æ˜¯ç›´æ¥å®šä¹‰åœ¨scriptsä¸­çš„ï¼Œæœ€æ–°ç‰ˆæœ¬å°†å…¶è½¬ç§»åˆ°huskyå­—æ®µä¸‹äº† è€ç‰ˆæœ¬huskyçš„é’©å­åç§°ä¸€èˆ¬ä¸ºprecommitã€prepushï¼Œç°åœ¨ç»Ÿä¸€æ”¹æˆäº†pre-commitã€pre-push ç¼ºç‚¹ æ¯æ¬¡é’ˆå¯¹æ‰€æœ‰æ–‡ä»¶è¿›è¡Œlintï¼Œæˆ‘ä»¬å¸Œæœ›ä»…é’ˆå¯¹ä¿®æ”¹çš„æˆ–è€…è¯´æ˜¯stagedçš„æ–‡ä»¶è¿›è¡Œlint -huskyé…åˆlint-stagedä½¿ç”¨ lint-stagedä»‹ç» huskyå¯ä»¥è®©æˆ‘ä»¬åœ¨git commitå’Œgit pushæ—¶æ‰§è¡Œä¸€æ®µè„šæœ¬ lint-stagedåˆ™å¯ä»¥é’ˆå¯¹addè¿›git æš‚å­˜åŒºçš„æ–‡ä»¶è¿›è¡Œlintæ“ä½œ ä½¿ç”¨ é¦–å…ˆå®‰è£… npm i -D lint-staged husky å®šä¹‰lint-stagedç›¸å…³è„šæœ¬ å¯é’ˆå¯¹ä¸åŒç±»å‹æ–‡ä»¶æ‰§è¡Œä¸åŒè„šæœ¬ï¼Œå‚è€ƒç¤ºä¾‹ ç¤ºä¾‹123456789101112131415161718"scripts": &#123; "dev": "webpack-dev-server --inline --progress --config build/webpack.dev.conf.js", "start": "npm run dev", "lint": "eslint --ext .js,.vue src",&#125;,"lint-staged": &#123; "*.&#123;js&#125;": [ // é’ˆå¯¹git æš‚å­˜åŒºä¸­çš„æ–‡ä»¶å…ˆæ‰§è¡Œeslint --fixï¼Œæ²¡æœ‰æŠ¥é”™æ—¶ï¼Œå†addè¿›æš‚å­˜åŒº "eslint --fix", "git add" ]&#125;,"husky": &#123; "hooks": &#123; "pre-commit": "lint-staged" // åœ¨commitå‰æ‰§è¡Œlint-stagedä»»åŠ¡ &#125;&#125; å‚è€ƒ http://javascript.ruanyifeng.com/nodejs/npm.html#toc15]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>git</tag>
        <tag>npm</tag>
        <tag>pre</tag>
        <tag>post</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[eslint-basic]]></title>
    <url>%2F2019%2F03%2F12%2Feslint-basic%2F</url>
    <content type="text"><![CDATA[eslint é…ç½®è®°å½• æœ€è¿‘é¡¹ç›®ä¸­éœ€è¦é›†æˆeslintï¼Œå­¦ä¹ åç‰¹åœ¨æ­¤åšä¸ªè®°å½• ä»‹ç» å®˜æ–¹ä»‹ç» ESLint æ˜¯ä¸€ä¸ªå¼€æºçš„ JavaScript ä»£ç æ£€æŸ¥å·¥å…·ï¼Œç”± Nicholas C. Zakas äº2013å¹´6æœˆåˆ›å»ºã€‚ä»£ç æ£€æŸ¥æ˜¯ä¸€ç§é™æ€çš„åˆ†æï¼Œå¸¸ç”¨äºå¯»æ‰¾æœ‰é—®é¢˜çš„æ¨¡å¼æˆ–è€…ä»£ç ï¼Œå¹¶ä¸”ä¸ä¾èµ–äºå…·ä½“çš„ç¼–ç é£æ ¼ã€‚å¯¹å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€æ¥è¯´éƒ½ä¼šæœ‰ä»£ç æ£€æŸ¥ï¼Œä¸€èˆ¬æ¥è¯´ç¼–è¯‘ç¨‹åºä¼šå†…ç½®æ£€æŸ¥å·¥å…·ã€‚ æ€»ç»“ ä»£ç é™æ€æ£€æŸ¥ æå‰å‘ç°ä½çº§é”™è¯¯ï¼›å¦‚å£°æ˜äº†å˜é‡å´æ²¡æœ‰ä½¿ç”¨ã€ä½¿ç”¨äº†== ä»£ç é£æ ¼æ£€æŸ¥ï¼ˆæ­¤èƒ½åŠ›è¾ƒå¼±ï¼‰ å›¢å¸¦æ•´ä½“ç¼–ç é£æ ¼çš„æ£€æŸ¥ï¼›å¦‚å•åŒå¼•å·ã€åˆ†å·ç­‰çš„ä½¿ç”¨ å®‰è£…å®‰è£…åŠåˆå§‹åŒ–123npm i -D eslint // å®‰è£…ä¸ºå¼€å‘ä¾èµ–npx eslint --init // ä¼šä»¥äº¤äº’å½¢å¼ç”Ÿæˆeslinté…ç½®æ–‡ä»¶ é…ç½®é…ç½®æ–‡ä»¶æ ¼å¼ eslintçš„é…ç½®æ–‡ä»¶å¯ä»¥æœ‰å¤šç§æ ¼å¼ .eslintrc(åºŸå¼ƒ) .eslintrc.js .eslintrc.json .eslintrc.yml è¿˜å¯ä»¥åœ¨package.jsonä¸­å£°æ˜é…ç½® PSï¼šç»å¸¸èƒ½çœ‹åˆ°é…ç½®æ–‡ä»¶ä»¥rcç»“å°¾ï¼Œå…¶å®è¿™æ˜¯çº¦å®šä¿—æˆçš„é…ç½®æ–‡ä»¶çš„å‘½åæ–¹æ³•ï¼Œæ˜¯run controlè¿è¡Œæ§åˆ¶çš„æ„æ€ ä¼˜å…ˆçº§ æ—¢ç„¶æœ‰è¿™ä¹ˆæ–‡ä»¶æ ¼å¼ï¼Œé‚£åŒæ—¶å‡ºç°æ—¶ï¼Œè‚¯å®šæœ‰ä¸ªä¼˜å…ˆçº§ .eslintrc.js &gt; .eslintrc.yaml &gt; .eslintrc.yml &gt; .eslintrc.json &gt; .eslintrc &gt; package.json package.jsonä¼˜å…ˆçº§æœ€ä½ï¼Œ.eslintrc..jsæœ€é«˜ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨.eslintrc.js eslintè¿˜æ”¯æŒåœ¨æ–‡ä»¶ä¸­é€šè¿‡æ³¨é‡Šçš„å½¢å¼æ¥å£°æ˜é…ç½®é€‰é¡¹ï¼Œå¦‚/*eslint-disable*/ è¿™ç§æ–¹å¼çš„ä¼˜å…ˆçº§è¦é«˜äºé…ç½®æ–‡ä»¶çš„å½¢å¼ é…ç½®é…ç½®ä¿¡æ¯åˆ†ç±» ç¯å¢ƒç›¸å…³ éœ€è¦lintçš„è„šæœ¬è¿è¡Œç¯å¢ƒï¼Œæ¯ç§ç¯å¢ƒéƒ½æœ‰ä¸€ç»„ç‰¹å®šçš„é¢„å®šä¹‰å…¨å±€å˜é‡ã€‚ï¼›eslintåœ¨æ£€æŸ¥æ—¶ï¼Œå°±ä¸ä¼šå°†ä¸€äº›å…¨å±€å˜é‡æ£€æµ‹ä¸ºä¸ºæœªå®šä¹‰è€ŒæŠ¥é”™ å…¨å±€å˜é‡ éœ€è¦è·³è¿‡eslintæœªå®šä¹‰æ£€æŸ¥çš„å…¨å±€å˜é‡ï¼›å¦‚jQueryã€Zeptoè¿™äº›æœªåœ¨ç¯å¢ƒä¸­é¢„ç½®ä½†åˆåœ¨è„šæœ¬æ‰§è¡Œæ—¶è®¿é—®çš„é¢å¤–çš„å…¨å±€å˜é‡ è§„åˆ™ç›¸å…³ é…ç½®å¯ç”¨å“ªäº›è§„åˆ™åŠé”™è¯¯çº§åˆ« è§„åˆ™é”™è¯¯çº§åˆ« å­—ç¬¦ä¸²è¡¨ç¤º æ•°å­—è¡¨ç¤º è¯´æ˜ â€œoffâ€ 0 å…³é—­å½“å‰è§„åˆ™æ£€æŸ¥ â€œwarnâ€ 1 å¯ç”¨å½“å‰è§„åˆ™æ£€æŸ¥ï¼Œä¸ç¬¦åˆå½“å‰è§„åˆ™ï¼Œä¼šæŠ¥ä¸€ä¸ªè­¦å‘Šï¼ˆä¸å½±å“ç°æœ‰ä»£ç ï¼‰ â€œerrorâ€ 2 å¯ç”¨å½“å‰è§„åˆ™æ£€æŸ¥ï¼Œä¸ç¬¦åˆå½“å‰è§„åˆ™ï¼Œä¼šæŠ¥ä¸€ä¸ªé”™è¯¯ï¼ˆä¸­æ–­åç»­æµç¨‹ï¼‰ é…ç½®é¡¹è¯´æ˜ root å‘ŠçŸ¥eslintåœ¨æŸ¥æ‰¾é…ç½®æ–‡ä»¶æ—¶ï¼Œåˆ°æ­¤æ–‡ä»¶ç»“æŸï¼Œä¸å†å¾€ä¸Šçº§ç›®å½•æŸ¥æ‰¾ parser æŒ‡å®šeslintè§£æå™¨ï¼Œé»˜è®¤ä¸ºEspreeï¼› åªæœ‰åœ¨ä½¿ç”¨äº†eslintæ— æ³•è§£æçš„babelç‰¹æ€§æ—¶ï¼Œæ‰éœ€è¦æ›¿æ¢ä¸ºbabel-eslintï¼›babel-eslintä¼šæä¾›ä¸€ä»½èƒ½è¢«eslintæ­£å¸¸è§£æçš„jsæ–‡ä»¶ï¼ŒeslintåŸºäºæ­¤å†åšé™æ€æ£€æŸ¥ æ­£å¸¸æƒ…å†µä¸‹ï¼Œéƒ½ä¼šä½¿ç”¨babel-eslint parserOptions è§£æå™¨é€‰é¡¹12345678910parserOptions: &#123; ecmaVersion: 6, // ESçš„ç‰ˆæœ¬ï¼Œé»˜è®¤ä¸º5 sourceType: 'module', // æŒ‡å®šæºç ç±»å‹ï¼Œscript | moduleï¼Œé»˜è®¤ä¸ºscriptã€‚ ecmaFeatures: &#123; // ä½ æƒ³ä½¿ç”¨çš„é¢å¤–çš„è¯­è¨€ç‰¹æ€§ experimentalObjectRestSpread: true, // å¯ç”¨æ‰©å±•è¿ç®—ç¬¦ jsx: true, // å¯ç”¨jsxè¯­æ³• globalReturn: true, // å…è®¸returnåœ¨å…¨å±€ä½¿ç”¨ impliedStrict: true // å¯ç”¨ä¸¥æ ¼æ ¡éªŒæ¨¡å¼&#125; env è®¾ç½®æºç è¿è¡Œçš„ç¯å¢ƒï¼Œæ¯ç§ç¯å¢ƒéƒ½æœ‰ä¸€ç»„ç‰¹å®šçš„é¢„å®šä¹‰å…¨å±€å˜é‡ eslintåœ¨æ£€æŸ¥æ—¶ï¼Œå°±ä¸ä¼šå°†ä¸€äº›å…¨å±€å˜é‡æ£€æµ‹ä¸ºä¸ºæœªå®šä¹‰è€ŒæŠ¥é”™ ç¯å¢ƒå˜é‡æ˜¯éäº’æ–¥çš„ï¼Œå¯ä»¥æ·»åŠ å¤šä¸ª å…·ä½“å¯æŸ¥è¯¢è¿™é‡Œï¼šhttps://cn.eslint.org/docs/user-guide/configuring#specifying-environments globals é¢å¤–ä½¿ç”¨çš„å…¨å±€å˜é‡ extends ä¸€ä¸ªé…ç½®æ–‡ä»¶å¯ä»¥ä»åŸºç¡€é…ç½®ä¸­ç»§æ‰¿å·²å¯ç”¨çš„è§„åˆ™ï¼Œextendså­—æ®µå°±æ˜¯ç”¨æ¥é…ç½®ç»§æ‰¿çš„è§„åˆ™ extends å±æ€§å€¼å¯ä»¥æ˜¯ï¼š åœ¨é…ç½®ä¸­æŒ‡å®šçš„ä¸€ä¸ªå­—ç¬¦ä¸² å­—ç¬¦ä¸²æ•°ç»„ï¼šæ¯ä¸ªé…ç½®ç»§æ‰¿å®ƒå‰é¢çš„é…ç½®ï¼Œå‡ºç°é‡å¤è§„åˆ™æ—¶ï¼Œå¦‚extends:[1,2,3] é…ç½®2ä¼šè¦†ç›–1ï¼Œ3ä¼šè¦†ç›–2ï¼Œç±»ä¼¼Object.assign eslintå†…ç½®è§„åˆ™é»˜è®¤æƒ…å†µä¸‹éƒ½æ˜¯ç¦ç”¨çš„ å¯ä»¥é€šè¿‡eslint:recommendedæˆ–è€…eslint:allå¯ç”¨ è¿˜å¯ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„è§„åˆ™ï¼Œå¦‚eslint-config-standardã€eslint-config-airbnbç­‰ç­‰ åœ¨æŒ‡å®šæ—¶ï¼Œå¯å¿½ç•¥å‰é¢ä¸ªçš„slint-config- å¦‚ä¸‹é¢çš„standardï¼Œå…¨åä¸ºeslint-config-standard è‹¥ä½¿ç”¨æ’ä»¶ä¸­çš„è§„åˆ™ å¯ä½¿ç”¨ plugin:æ’ä»¶name/è§„åˆ™å çš„æ ¼å¼æ¥æŒ‡å®š rules åœ¨extendsåŸºç¡€ä¸Šé¢å¤–é™„åŠ çš„è§„åˆ™ï¼Œå…¶ä¼˜å…ˆçº§é«˜äºextendsçš„è§„åˆ™ï¼Œä¼šè¦†ç›–ä»–ä»¬ plugins é’ˆå¯¹ä¸€äº›ç‰¹æ®Šæƒ…å†µï¼Œéœ€è¦ä½¿ç”¨æ’ä»¶ æ’ä»¶èƒ½èµ‹äºˆeslintä¸€äº›å…¶ä»–èƒ½åŠ›ä¹Ÿä¼šåŒ…å«ä¸€äº›è§„åˆ™ settings æŒ‡æ˜éœ€è¦åœ¨ä¸åŒé…ç½®æ–‡ä»¶ä¸­å…±äº«çš„æ•°æ® ç¤ºä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657module.exports = &#123; root: true, // å‘ŠçŸ¥eslintåœ¨æŸ¥æ‰¾é…ç½®æ–‡ä»¶æ—¶ï¼Œåˆ°æ­¤æ–‡ä»¶ç»“æŸï¼Œä¸å†å¾€ä¸Šçº§ç›®å½•æŸ¥æ‰¾ // æŒ‡å®šeslintè§£æå™¨ï¼Œé»˜è®¤ä¸ºEspreeï¼› // åªæœ‰åœ¨ä½¿ç”¨äº†eslintæ— æ³•è§£æçš„babelç‰¹æ€§æ—¶ï¼Œæ‰éœ€è¦æ›¿æ¢ä¸ºbabel-eslintï¼›babel-eslintä¼šæä¾›ä¸€ä»½èƒ½è¢«eslintæ­£å¸¸è§£æçš„jsæ–‡ä»¶ï¼ŒeslintåŸºäºæ­¤å†åšé™æ€æ£€æŸ¥ // æ­£å¸¸æƒ…å†µä¸‹ï¼Œä¼šä½¿ç”¨babel-eslint parser: 'babel-eslint', // è§£æå™¨é€‰é¡¹ parserOptions: &#123; ecmaVersion: 6, // ESçš„ç‰ˆæœ¬ï¼Œé»˜è®¤ä¸º5 sourceType: 'module', // æŒ‡å®šæºç ç±»å‹ï¼Œscript | moduleï¼Œé»˜è®¤ä¸ºscriptã€‚ ecmaFeatures: &#123; // ä½ æƒ³ä½¿ç”¨çš„é¢å¤–çš„è¯­è¨€ç‰¹æ€§ experimentalObjectRestSpread: true, // å¯ç”¨æ‰©å±•è¿ç®—ç¬¦ jsx: true, // å¯ç”¨jsxè¯­æ³• globalReturn: true, // å…è®¸returnåœ¨å…¨å±€ä½¿ç”¨ impliedStrict: true // å¯ç”¨ä¸¥æ ¼æ ¡éªŒæ¨¡å¼ &#125; &#125;, env: &#123; // è®¾ç½®æºç è¿è¡Œçš„ç¯å¢ƒï¼Œæ¯ç§ç¯å¢ƒéƒ½æœ‰ä¸€ç»„ç‰¹å®šçš„é¢„å®šä¹‰å…¨å±€å˜é‡ï¼› // eslintåœ¨æ£€æŸ¥æ—¶ï¼Œå°±ä¸ä¼šå°†ä¸€äº›å…¨å±€å˜é‡æ£€æµ‹ä¸ºä¸ºæœªå®šä¹‰è€ŒæŠ¥é”™ // ç¯å¢ƒå˜é‡æ˜¯éäº’æ–¥çš„ï¼Œå¯ä»¥æ·»åŠ å¤šä¸ª // å…·ä½“å¯æŸ¥è¯¢è¿™é‡Œï¼šhttps://cn.eslint.org/docs/user-guide/configuring#specifying-environments browser: true, // æ·»åŠ æµè§ˆå™¨ç¯å¢ƒä¸‹çš„å…¨å±€å˜é‡ å¦‚ windowã€documentç­‰ es6: true // æ·»åŠ es6çš„å…¨å±€å˜é‡ &#125;, globals: &#123; // é¢å¤–ä½¿ç”¨çš„å…¨å±€å˜é‡ Zepto: true // trueä»£è¡¨ä¸èƒ½é‡å†™æ­¤å˜é‡ &#125;, // ä¸€ä¸ªé…ç½®æ–‡ä»¶å¯ä»¥ä»åŸºç¡€é…ç½®ä¸­ç»§æ‰¿å·²å¯ç”¨çš„è§„åˆ™ï¼Œextendså­—æ®µå°±æ˜¯ç”¨æ¥é…ç½®ç»§æ‰¿çš„è§„åˆ™ // extends å±æ€§å€¼å¯ä»¥æ˜¯ï¼š // åœ¨é…ç½®ä¸­æŒ‡å®šçš„ä¸€ä¸ªå­—ç¬¦ä¸² // å­—ç¬¦ä¸²æ•°ç»„ï¼šæ¯ä¸ªé…ç½®ç»§æ‰¿å®ƒå‰é¢çš„é…ç½®ï¼Œå‡ºç°é‡å¤è§„åˆ™æ—¶ï¼Œå¦‚[1,2,3] é…ç½®2ä¼šè¦†ç›–1ï¼Œ3ä¼šè¦†ç›–2ï¼Œç±»ä¼¼Object.assign // eslintå†…ç½®è§„åˆ™é»˜è®¤æƒ…å†µä¸‹éƒ½æ˜¯ç¦ç”¨çš„ï¼Œå¯ä»¥é€šè¿‡`eslint:recommended`æˆ–è€…`eslint:all`å¯ç”¨ // è¿˜å¯ä½¿ç”¨ç¬¬ä¸‰æ–¹çš„è§„åˆ™ï¼Œå¦‚eslint-config-standardã€eslint-config-airbnbç­‰ç­‰ // åœ¨æŒ‡å®šæ—¶ï¼Œå¯å¿½ç•¥å‰é¢ä¸ªçš„slint-config- // å¦‚ä¸‹é¢çš„standardï¼Œå…¨åä¸ºeslint-config-standard // è‹¥ä½¿ç”¨æ’ä»¶ä¸­çš„è§„åˆ™ // å¯ä½¿ç”¨ plugin:æ’ä»¶name/è§„åˆ™å çš„æ ¼å¼æ¥æŒ‡å®š extends: [ 'plugin:vue/recommended', // ä½¿ç”¨eslint-plugin-vueä¸­çš„recommendedè§„åˆ™ 'standard' ], // åœ¨extendsåŸºç¡€ä¸Šé¢å¤–é™„åŠ çš„è§„åˆ™ï¼Œå…¶ä¼˜å…ˆçº§é«˜äºextendsçš„è§„åˆ™ï¼Œä¼šè¦†ç›–ä»–ä»¬ rules: &#123; // å…³é—­ä¸å…è®¸åŒä¸€ä¸ªvarå£°æ˜å¤šä¸ªå˜é‡ 'one-var': 'off' &#125;, // é’ˆå¯¹ä¸€äº›ç‰¹æ®Šæƒ…å†µï¼Œéœ€è¦ä½¿ç”¨æ’ä»¶ // æ’ä»¶èƒ½èµ‹äºˆeslintä¸€äº›å…¶ä»–èƒ½åŠ›ä¹Ÿä¼šåŒ…å«ä¸€äº›è§„åˆ™ plugins: ['vue'], // æŒ‡æ˜éœ€è¦åœ¨ä¸åŒé…ç½®æ–‡ä»¶ä¸­å…±äº«çš„æ•°æ® settings: &#123; sharedData: 'Hello' &#125;&#125; è¡Œå†…è§„åˆ™å¸¸ç”¨è¡Œå†…è§„åˆ™ eslint-disable å½“å‰æ–‡ä»¶ä¸‹é¢æ‰€æœ‰ä»£ç ç¦ç”¨eslintæ£€æŸ¥ åœ¨ä¸å¸Œæœ›ä½¿ç”¨eslintçš„æ–‡ä»¶é¡¶éƒ¨æ·»åŠ 12345/* eslint-disable */alert('foo');/* eslint-enable */ eslint-disable-next-line ä¸‹é¢ä¸€è¡Œä»£ç ï¼Œç¦ç”¨eslintæ£€æŸ¥12/* eslint-disable-next-line */alert('foo'); å¿½ç•¥æ–‡ä»¶.eslintignore ä½¿ç”¨.eslintignoreæ–‡ä»¶å£°æ˜éœ€è¦å¿½ç•¥çš„æ–‡ä»¶åŠç›®å½• .eslintignoreä¸­ä½¿ç”¨globæ¨¡å¼è¡¨æ˜å“ªäº›è·¯å¾„åº”è¯¥å¿½ç•¥æ£€æµ‹12// .eslintignore**/*.js eslint-cliå¸¸ç”¨æ“ä½œ ç”Ÿæˆé…ç½®æ–‡ä»¶ 1eslint --init // ä»¥äº¤äº’å½¢å¼ç”Ÿæˆ.eslintrcæ–‡ä»¶ ä¿®å¤é”™è¯¯ ç»å¤§éƒ¨åˆ†ä¿®å¤çš„æ˜¯æ ¼å¼åŒ–çš„é”™è¯¯ï¼Œå¦‚ç©ºç™½ç¬¦ã€åˆ†å·ç­‰1eslint --fix file.js // ä¿®å¤file.jsä¸­çš„æ ¼å¼åŒ–é”™è¯¯ æŒ‡å®šé¢å¤–çš„é…ç½®æ–‡ä»¶ 1eslint -c myconfig.js file.js // æŒ‡å®šé…ç½®å¹¶lintå½“å‰ç›®å½•ä¸‹çš„file.js æŒ‡å®šç¯å¢ƒå˜é‡ 1eslint --env browser,node file.js // æŒ‡å®šç¯å¢ƒå˜é‡ æŒ‡å®šæ‰©å±• --ext åªæœ‰åœ¨å‚æ•°ä¸ºç›®å½•æ—¶ï¼Œæ‰ç”Ÿæ•ˆã€‚å¦‚æœä½ ä½¿ç”¨glob æ¨¡å¼æˆ–æ–‡ä»¶åï¼Œ--ext å°†è¢«å¿½ç•¥1eslint --ext .js,.vue src // lint srcç›®å½•ä¸‹åç¼€ä¸ºjsã€vueçš„æ–‡ä»¶ ç¼“å­˜ å­˜å‚¨å¤„ç†è¿‡çš„æ–‡ä»¶çš„ä¿¡æ¯ä»¥ä¾¿åªå¯¹æœ‰æ”¹å˜çš„æ–‡ä»¶è¿›è¡Œæ“ä½œ ç¼“å­˜é»˜è®¤è¢«å­˜å‚¨åœ¨ .eslintcacheä¸­1eslint "src/**/*.js" --cache // åªå¯¹æ”¹å˜çš„æ–‡ä»¶è¿›è¡Œlint å½©è‰²è¾“å‡º 1eslint --color file.js å‚è€ƒ https://juejin.im/post/5bab946cf265da0ae92a75ca]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>eslint</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[bem-suit]]></title>
    <url>%2F2019%2F03%2F11%2Fbem-suit%2F</url>
    <content type="text"><![CDATA[æ ·å¼ç±»çš„å‘½åBEMåŸºæœ¬ç»„æˆ B(block)-æ¯ä¸ªæ¨¡å—å¯è§†ä¸ºä¸€ä¸ª block E(element)-ä»£è¡¨.block çš„åä»£ï¼Œç”¨äºå½¢æˆä¸€ä¸ªå®Œæ•´çš„.block çš„æ•´ä½“ M(modifer)-ä»£è¡¨.block çš„ä¸åŒçŠ¶æ€æˆ–ä¸åŒç‰ˆæœ¬ã€‚å¦‚ current active ç­‰ç‰¹æ®Šæ ·å¼ å‘½åçº¦å®š12345678.block-name &#123;&#125;.block-name__element-name &#123;&#125;.block-name--modifier-name &#123;&#125; é•¿å•è¯é‡‡ç”¨-åˆ†éš”,å¦‚ siteName ç”¨ site-name BE ä¹‹é—´é‡‡ç”¨__(åŒä¸‹åˆ’çº¿)åˆ†éš” M ç”¨--æ ‡è¯† æ³¨æ„äº‹é¡¹ æ³¨æ„:å¹¶éæ‰€æœ‰ç±»éƒ½å¿…é¡»é‡‡ç”¨ bem å‘½åæ–¹å¼ å½“ä¸€ä¸ªå…ƒç´  element æ€»æ˜¯å›ºå®šå‡ºç°åœ¨æŸå—ä¸‹é¢ï¼Œåˆ™å¯é‡‡ç”¨ bem å‘½åæ–¹å¼ã€‚è‹¥åªæ˜¯æ°å·§æ­¤æ¬¡å‡ºç°åœ¨æŸå—ä¸‹é¢ï¼Œåˆ™ä¸å¿…é‡‡ç”¨ bemã€‚å¦‚ logo å¯ç›´æ¥ä½¿ç”¨.logo è€Œä¸å¿…é‡‡ç”¨.header{} .header__logo{}æ¥æ ‡è¯†ã€‚å› ä¸º logo åªæ˜¯æ°å·§å‡ºç°åœ¨ header ä¸­,logo è¿˜å¯ä»¥å‡ºç°åœ¨ footer ç­‰å…¶å®ƒåœ°æ–¹ï¼› å•ç‹¬çš„css æ ·å¼ï¼Œå¯ä¸ç”¨bemå‘½åæ–¹å¼å¦‚ .fr{float:right;}ä¸å¿…é‡‡ç”¨ bem SUITBEM çš„æ”¹è¿› BEMé‡‡ç”¨-ä»¥åŠ__æ¥åˆ†éš”å®¹æ˜“é€ æˆæ··ä¹±,SUITå¯¹å…¶æ”¹è¿›ï¼Œæ€æƒ³æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å‘½åçº¦å®šç¨æœ‰æ”¹å˜ï¼ŒSUITå¤šé‡‡ç”¨å¸•æ–¯å¡,é©¼å³°å‘½åæ–¹æ³• åŸºæœ¬ç»„æˆ Utilities(å…¬ç”¨æ ·å¼)-å¦‚ clearfix Component(å…¬ç”¨ç»„ä»¶)-ç±»ä¼¼ BEM ä¸­çš„ block Descendants(åä»£)-ç±»ä¼¼ BEM ä¸­çš„ element Status(çŠ¶æ€)-ç»„ä»¶çš„å„ç§çŠ¶æ€ï¼Œå¦‚æœ‰éœ€è¦ä¹Ÿå¯ç”¨åœ¨åä»£ä¸Šï¼Œä¸å¯å•ç‹¬ä½¿ç”¨(æ·»åŠ æ ·å¼) Modifer(ä¿®é¥°ç¬¦)-ç±»ä¼¼ BEM ä¸­çš„ M,ä¸è¿‡å®ƒåªèƒ½ç”¨åœ¨ Components ä¸Šä¸èƒ½ç”¨åœ¨ Descendants ä¸Š,ä¹Ÿä¸èƒ½è¡¨ç¤ºç»„ä»¶çŠ¶æ€ï¼ŒçŠ¶æ€ç”± Status æ ‡è¯† å‘½åçº¦å®š1234567891011121314.u-utility &#123;&#125;.ComponentName &#123;&#125;.ComponentName-descendantName &#123;&#125;.ComponentName--modifierName &#123;&#125;.ComponentName.is-someState &#123;&#125; å…¬ç”¨æ ·å¼ æ·»åŠ  u-å‰ç¼€,å¹¶é‡‡ç”¨é©¼å³°å‘½åï¼Œå¦‚ u-clearFix{},u-floatRight{}ï¼Œè¿˜å¯ä»¥æ·»åŠ  smã€mdã€lg ç­‰å“åº”å¼å¦‚.u-sm-floatR ç»„ä»¶ é‡‡ç”¨å¸•æ–¯å¡å‘½åï¼Œå¦‚.SearchForm{} é¿å…å†²çªå¯æ·»åŠ å‘½åç©ºé—´ï¼Œå¦‚.cgh-SearchForm{}ï¼›ç»„ä»¶ååªèƒ½è·Ÿä¸€ä¸ªåä»£ã€ä¸èƒ½è·Ÿå¤šä¸ª åä»£ é‡‡ç”¨-åˆ†éš”ï¼Œé©¼å³°å‘½åã€‚å¦‚.SearchForm-submitBtn{} ä¿®é¥°ç¬¦ é‡‡ç”¨â€“æ ‡è¯†ï¼Œåªèƒ½è·Ÿåœ¨ç»„ä»¶åï¼Œä¸èƒ½è·Ÿåœ¨åä»£åé¢ã€‚.SearchFormâ€“advanced{} çŠ¶æ€ ç”¨é©¼å³°å‘½åï¼Œå¹¶åœ¨é©¼å³°ä¸Šæ·»åŠ .is-å‰ç¼€ã€‚ç”¨åœ¨ç»„ä»¶åé¢ï¼Œå¦‚æœ‰éœ€è¦ä¹Ÿå¯ä»¥è·Ÿåœ¨åä»£åé¢ï¼› ä¸è¦å•ç‹¬ä½¿ç”¨è¿™äº›çŠ¶æ€ç±»(æ·»åŠ æ ·å¼)ï¼Œé…åˆç»„ä»¶/åä»£æ¥å®ç°æŸç§æ ·å¼å¦‚.is-mouseOver{} ä½¿ç”¨æ—¶.SearchForm.is-mouseOver{} æ³¨æ„ï¼šä¸­é—´æ— ç©ºæ ¼ï¼Œä¸æ˜¯.SearchForm ç©ºæ ¼.is-mouseOver{}ï¼›å®ƒæ˜¯è¡¨ç¤ºåŒæ—¶æ‹¥æœ‰.SearchForm å’Œ.is-mouseOver{}ç±»çš„æ ‡ç­¾;é€šè¿‡è¿™ç§æ–¹å¼èƒ½ç¡®å®šå¤„äºç‰¹å®šçŠ¶æ€ä¸‹çš„æ ‡ç­¾,ç­‰äºå°† is-mouseOver ç»‘å®šåˆ° SearchForm ä¸Šäº† ç¤ºä¾‹ å¥½çš„ é”™è¯¯ åŸå›  .u-clearfix{}ã€.u-sm-clearfix{}ã€.u-floatL{} .Treeã€.cgh-Tree .treeã€.cgh_Tree ç»„ä»¶é¦–å­—æ¯åº”å¤§å†™ï¼›å‘½åç©ºé—´åº”ç”¨-è¿æ¥ .Tree-listã€.Tree-listHd .Tree-list-itemã€.Tree-listhd ç»„ä»¶åé¢åªèƒ½è·Ÿä¸€ä¸ªåä»£ï¼Œä¸èƒ½è·Ÿå¤šä¸ªï¼›åä»£åº”è¯¥ç”¨é©¼å³° .Treeâ€“large .Tree-listâ€“large ä¿®é¥°ç¬¦åº”åªè·Ÿåœ¨ç»„ä»¶åé¢ .Tree.is-active{display:block;}ã€.Tree-item.is-active{display:block; } is-active{display:block; } ä¸è¦ç»™çŠ¶æ€å•ç‹¬æ·»åŠ æ ·å¼é¢]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>css</tag>
        <tag>bem</tag>
        <tag>suit</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vue-swiper-virtual]]></title>
    <url>%2F2019%2F03%2F11%2Fvue-swiper-virtual%2F</url>
    <content type="text"><![CDATA[åœ¨ vue ä¸­ä½¿ç”¨ swiper çš„ virtual ç‰¹æ€§swiper ä»‹ç» å‰ç«¯å¼€å‘ä¸­ï¼Œç»å¸¸ä¼šç¢°åˆ°è½®æ’­ã€ç¿»é¡µç­‰éœ€æ±‚ã€‚swiperå°±æ˜¯ç”¨æ¥è§£å†³æ­¤ç±»éœ€æ±‚çš„ã€‚ åŠŸèƒ½å…¨ã€è¦†ç›–åœºæ™¯å¤šï¼Œå¯é€‚é…ç§»åŠ¨ç«¯ç­‰ç‰¹ç‚¹ï¼Œè®©å®ƒæˆä¸ºå®ç°æ­¤ç±»éœ€æ±‚çš„æœ€å¥½é€‰æ‹©ã€‚ å®ƒæœ‰ä¸“é—¨çš„vueç‰ˆæœ¬ï¼Œvue-awesome-swiper èƒŒæ™¯ é¡¹ç›®æ˜¯åŸºäºvueå…¨å®¶æ¡¶å¼€å‘çš„ï¼Œæœ‰è½®æ’­éœ€æ±‚ï¼Œè½®æ’­çš„ slides æ•°é‡è¾ƒå¤šï¼Œslide çš„ DOM ç»“æ„æ¯”è¾ƒå¤æ‚ã€‚ é—®é¢˜ é¡¹ç›®ä¸­ä½¿ç”¨çš„æ˜¯vue-awesome-swiperï¼Œå®ƒåŸºäºswiperåšäº†ç›¸å…³å°è£… ä½¿ç”¨æ—¶å¹¶æ²¡æœ‰ä½¿ç”¨virtual slidesç‰¹æ€§ï¼Œåˆå§‹åŒ–æ—¶ä¼šæ¸²æŸ“æ‰€æœ‰slideï¼Œå¯¼è‡´åˆå§‹æ¸²æŸ“é€Ÿåº¦è¾ƒæ…¢ã€‚åœ¨DOMç»“æ„å¤æ‚ï¼Œslide æ•°é‡ä¸º 100 æ—¶ï¼Œåˆå§‹æ¸²æŸ“å¤§æ¦‚éœ€è¦ 2~3sã€‚ æ•°æ®æ”¹å˜è§¦å‘æ›´æ–°æ—¶ï¼Œvue-awesome-swiperä¼šé¢‘ç¹è§¦å‘updateæ“ä½œã€‚å®¹æ˜“é¡µé¢å¡æ­»ã€‚ ç±»ä¼¼é—®é¢˜https://github.com/surmon-china/vue-awesome-swiper/issues/424 è§æºç  1234567891011121314151617181920212223242526272829303132333435363738// vue-awesome-swiper/src/slide.vue&lt;template&gt;&lt;div :class="slideClass"&gt;&lt;slot&gt;&lt;/slot&gt;&lt;/div&gt;&lt;/template&gt;&lt;script&gt;export default &#123; name: 'swiper-slide', data() &#123; return &#123; slideClass: 'swiper-slide' &#125; &#125;, ready() &#123; this.update() &#125;, mounted() &#123; this.update() if (this.$parent &amp;&amp; this.$parent.options &amp;&amp; this.$parent.options.slideClass) &#123; this.slideClass = this.$parent.options.slideClass &#125; &#125;, updated() &#123; this.update() &#125;, attached() &#123; this.update() &#125;, methods: &#123; update() &#123; if (this.$parent &amp;&amp; this.$parent.swiper) &#123; this.$parent.update() &#125; &#125; &#125;&#125;&lt;/script&gt; - ä½¿ç”¨ swiper çš„ virtual ç‰¹æ€§ virtualå®˜æ–¹ä»‹ç» -è™šæ‹ŸSlideä¼šåœ¨Domç»“æ„ä¸­ä¿æŒå°½é‡å°‘çš„Slideï¼Œåªæ¸²æŸ“å½“å‰å¯è§çš„slideå’Œå‰åçš„slideï¼Œè€Œéšè—å…¶ä»–ä¸å¯è§çš„Slideï¼Œæ¯æ¬¡åˆ‡æ¢æ—¶å°±æ¸²æŸ“æ–°çš„Slideã€‚å½“ä½ çš„Slideå¾ˆå¤šçš„æ—¶å€™ï¼Œå°¤å…¶æ˜¯Slideä¸­æœ‰å¤æ‚çš„Domæ ‘ç»“æ„æ—¶ï¼Œæ€§èƒ½ä¼šæœ‰å¾ˆå¤§çš„æå‡ã€‚ ç”±äºä½¿ç”¨vue-awesome-swiperå‡ºç°äº†ä¸€äº›æ€§èƒ½é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å†³å®šç›´æ¥ä½¿ç”¨swiperç‰ˆæœ¬å¹¶å¼€å¯virtualç‰¹æ€§ï¼ˆæ³¨æ„ä½¿ç”¨ 4.0 ç‰ˆæœ¬ï¼‰ ä¸­æ–‡æ–‡æ¡£ä¸­ï¼Œå¹¶æ²¡æœ‰è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨vueä¸­ä½¿ç”¨virtualç‰¹æ€§ã€‚ è‹±æ–‡æ–‡æ¡£ http://idangero.us/swiper/api/#virtualä¸­è¯¦ç»†ä»‹ç»äº†å¦‚ä½•åœ¨vueã€reactä¸­ä½¿ç”¨virtualç‰¹æ€§ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162&lt;template&gt;&lt;!-- ... --&gt;&lt;div class="swiper-container"&gt; &lt;div class="swiper-wrapper"&gt; &lt;!-- å¿…é¡»åœ¨æ¯ä¸ªslideä¸Šè®¾ç½®left --&gt; &lt;!-- å‹¿ç›´æ¥å°†v-forçš„indexåšä¸ºkeyï¼Œä¼šå‡ºç°keyé‡å¤çš„é—®é¢˜ --&gt; &lt;div class="swiper-slide" v-for="(slide, index) in virtualData.slides" :key="slide.id" :style="&#123;left: `$&#123;virtualData.offset&#125;px`&#125;" &gt; &#123;&#123;curIndex&#125;&#125; &lt;br/&gt; &#123;&#123;slide&#125;&#125; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt;&lt;!-- ... --&gt;&lt;/template&gt;&lt;script&gt;import Swiper from 'swiper/dist/js/swiper.esm.bundle' // å¯¼å…¥swiperimport 'swiper/dist/css/swiper.min.css' // è®°å¾—å¯¼å…¥æ ·å¼export default &#123; data() &#123; return &#123; curIndex:0, // å½“å‰ç¿»é¡µç´¢å¼• // å£°æ˜virtualDataï¼Œä¾›swiperä½¿ç”¨ virtualData: &#123; slides: [], &#125;, &#125; &#125;, mounted() &#123; Api.getSomeSlides().then(res=&gt;&#123; const self = this; const swiper = new Swiper('.swiper-container', &#123; // ... virtual: &#123; slides: res.slides, // éœ€è¦æ·»åŠ çš„è™šæ‹Ÿslideçš„å†…å®¹ renderExternal(data) &#123; console.log(data) // è¿”å›ä¸€ä¸ªç»è¿‡swiperè®¡ç®—åçš„å½“å‰éœ€è¦æ¸²æŸ“çš„slidesç›¸å…³ä¿¡æ¯ // offset - slidesåç§»å€¼ // from - é¦–ä¸ªéœ€è¦æ¸²æŸ“çš„slideç´¢å¼• // to - æœ€åä¸€ä¸ªéœ€è¦æ¸²æŸ“çš„slideç´¢å¼• // slides - éœ€è¦æ¸²æŸ“çš„slides self.virtualData = data &#125;, &#125;, on:&#123; slideChange()&#123; // æ›´æ–°index self.curIndex=this.activeIndex &#125; &#125; &#125;); &#125;) &#125;,&#125;;&lt;/script&gt; ä½¿ç”¨åæ¯æ¬¡ä»…æ¸²æŸ“å½“å‰é¡µåŠå‰åé¡µ æ¯æ¬¡æ¸²æŸ“æ—¶ï¼Œä¼šé‡æ–°è§¦å‘vueçš„ç”Ÿå‘½å‘¨æœŸ å…¶ä»–ä½¿ç”¨åŸºæœ¬å’Œä¸ä½¿ç”¨virtualç‰¹æ€§ä¿æŒä¸€è‡´ è‹¥æœ‰swiperåµŒå¥—éœ€æ±‚ï¼Œå¯åœ¨å­ç»„ä»¶ä¸­ç›´æ¥å®ä¾‹åŒ–ä¸€ä¸ªswiperå¹¶è®¾ç½®nestedé€‰é¡¹ä¸ºtrue æ€»ç»“ vue-awesome-swiperæœ‰å‘ï¼Œä¼šé¢‘ç¹è°ƒç”¨updateï¼Œå¯¼è‡´ä¸€å®šæ€§èƒ½é—®é¢˜ å¯ç›´æ¥ä½¿ç”¨swiperæ›¿æ¢vue-awesome-swiper ç›¸å…³é“¾æ¥ vue-awesome-swiper https://github.com/surmon-china/vue-awesome-swiper/issues/424 http://idangero.us/swiper/api/#virtual]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>vue</tag>
        <tag>swiper</tag>
        <tag>virtual</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[array-flat]]></title>
    <url>%2F2019%2F03%2F11%2Farray-flat%2F</url>
    <content type="text"><![CDATA[æ•°ç»„æ‰å¹³åŒ–å‰ç½®çŸ¥è¯†æµ…æ‰å¹³åŒ– æµ…æ‰å¹³åŒ–å°±æ˜¯åªæ‰å¹³åŒ–ä¸€å±‚æ•°ç»„ æ·±æ‰å¹³åŒ– å®ç°æ— çº¿å±‚çº§çš„å¤šç»´æ•°ç»„æ‰å¹³åŒ– æ–¹æ³•åŸå§‹æ•°ç»„1var needFlatArr = [1, 2, [3, 4], [[5, 6, 7]], [8, [9, 10], [[11]]]] æµ…æ‰å¹³åŒ–å®ç° concat + apply 12345678// 1.concat + apply - æµ…æ‰å¹³åŒ–// concatåœ¨æ‹¼æ¥æ•°ç»„æ—¶ï¼Œè‹¥å…¥å‚ä¸­æœ‰æ•°ç»„æ—¶ï¼Œåˆ™éå†æ­¤æ•°ç»„æ¯é¡¹(ä¸ä¼šé€’å½’éå†ï¼Œä»…ä¼šéå†ä¸€å±‚)ï¼Œå¹¶å°†å…¶ä¾æ¬¡æ‹¼æ¥åˆ°å°¾éƒ¨// [].concat(1,[2,3],[4,5],[[6,7]]) ç»“æœ[1,2,3,4,5,[6,7]]// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/concatfunction flatConcatApply(arr) &#123; // ç›¸å½“äº[].concat.(arr[0],arr[1],arr[2],...) return Array.prototype.concat.apply([], arr)&#125; concat + reduce 1234// concat + reduce - æµ…æ‰å¹³åŒ–function flatConcatReduce(arr) &#123; return arr.reduce((a, b) =&gt; a.concat(b), [])&#125; æ·±æ‰å¹³åŒ–å®ç° é€’å½’å®ç° - å¸¸è§„å®ç° - æ·±æ‰å¹³åŒ– 1234567891011function flatRecursion(arr) &#123; var result = [] for (var i = 0, len = arr.length; i &lt; len; i++) &#123; if (Object.prototype.toString.call(arr[i]) === '[object Array]') &#123; result = result.concat(flatRecursion(arr[i])) &#125; else &#123; result = result.concat(arr[i]) &#125; &#125; return result&#125; é€’å½’å®ç° es6 - å¸¸è§„å®ç° - æ·±æ‰å¹³åŒ– 12345678910function flatRecursionEs6(arr, result = []) &#123; for (let item of arr) &#123; if (Array.isArray(item)) &#123; flatRecursionEs6(item, result) &#125; else &#123; result.push(item) &#125; &#125; return result&#125; é€’å½’å®ç° es6 - ç®€åŒ– - æ·±æ‰å¹³åŒ– - æ¨è 12345678const flatten = arr =&gt; arr.reduce( (result, shouldFlatten) =&gt; result.concat( Array.isArray(shouldFlatten) ? flatten(shouldFlatten) : shouldFlatten ), [] ) å¾ªç¯å®ç° - å¾ªç¯è°ƒç”¨æµ…æ‰å¹³åŒ–å‡½æ•°å®ç° - lodash æ€è·¯ - æ·±æ‰å¹³åŒ– 1234567function flatIterationShallowFlat(arr, deep = 1) &#123; let result = arr while (deep--) &#123; result = flatConcatApply(result) &#125; return result&#125; toString - ä»…æ”¯æŒå…ƒç´ å…¨éƒ¨ä¸º number çš„åœºæ™¯ - æ·±æ‰å¹³åŒ– 123456function flatToString(arr) &#123; return arr .toString() .split(',') .map(item =&gt; +item) // è½¬æ¢ä¸ºæ•°å­—ç±»å‹&#125; å­—ç¬¦ä¸²è¿‡æ»¤ - å°†è¾“å…¥æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸²å¹¶åˆ é™¤æ‰€æœ‰æ‹¬å·ï¼ˆ[]ï¼‰å¹¶å°†è¾“å‡ºè§£æä¸ºæ•°ç»„ - æ·±æ‰å¹³åŒ– 12const flatStringFilter = arr =&gt; JSON.parse(`[$&#123;JSON.stringify(arr).replace(/\[|]/g, '')&#125;]`) Generator - å®šä¹‰ç”Ÿæˆå™¨å‡½æ•°ï¼Œå¹¶ä¾æ¬¡è°ƒç”¨ 1234567891011121314151617function* flatG(arr) &#123; for (let item of arr) &#123; if (Array.isArray(item)) &#123; yield* flat(item) &#125; else &#123; yield item &#125; &#125;&#125;function flatGenerator(arr) &#123; let result = [] for (let val of flatG(arr)) &#123; result.push(val) &#125; return result&#125; åŸç”Ÿ flat - å…¼å®¹æœ‰é—®é¢˜ chrome é«˜ç‰ˆæœ¬ä¸æ”¯æŒ - æ·±æ‰å¹³åŒ– 1234;[1, 2, [3]] .flat(1) // [1, 2, 3] [(1, 2, [3, [4]])].flat(2) // [1, 2, 3, 4] [(1, 2, [3, [4, [5]]])].flat(Infinity) // [1, 2, 3, 4, 5] æ— çº¿å±‚çº§ åŸç”Ÿ flatMap - ç­‰äº map + flat 123// ç›¸å½“äº [[[2]], [[4]], [[6]], [[8]]].flat();[1, 2, 3, 4].flatMap(x =&gt; [[x * 2]])// [[2], [4], [6], [8]] å‚è€ƒ https://www.jianshu.com/p/b1fb3434e1f5 http://www.cnblogs.com/front-end-ralph/p/4871332.html https://juejin.im/post/5c6b63f6f265da2da53ec057]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>æ‰å¹³åŒ–</tag>
        <tag>flat</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[number-to-chinese]]></title>
    <url>%2F2019%2F03%2F11%2Fnumber-to-chinese%2F</url>
    <content type="text"><![CDATA[æµ®ç‚¹æ•°è½¬ä¸­æ–‡ é“¾æ¥ï¼šhttps://github.com/BryanAdamss/VueTemplate/blob/master/src/common/js/NumberToChinese.js èƒŒæ™¯ é¡¹ç›®æœ‰æ•´æ•°è½¬ä¸­æ–‡çš„éœ€æ±‚ï¼Œæœ¬æƒ³ç›´æ¥æœç´¢ä¸ªç®€å•çš„å®ç°ã€‚ ä½†å‘ç°ç½‘ç»œä¸Šçš„æœ‰ä¸€äº›é—®é¢˜ æœ‰äº›æ— æ³•å¤„ç†æµ®ç‚¹æ•° æœ‰äº›å­˜åœ¨ç”Ÿç¡¬ç¿»è¯‘é—®é¢˜ï¼Œæ— æ³•ç¿»è¯‘æˆæ»¡è¶³æ—¥å¸¸ä¹ æƒ¯çš„ä¸­æ–‡ï¼›å¦‚ 11 ç¿»è¯‘æˆäº† ä¸€åä¸€ï¼Œåº”ç¿»è¯‘æˆ åä¸€ æœ‰äº›ç¿»è¯‘èŒƒå›´æœ‰é™ é€ è½®å­ å†³å®šè‡ªå·±å®ç°ä¸€ä¸ªæµ®ç‚¹æ•°è½¬ä¸­æ–‡çš„å·¥å…·æ–¹æ³• æ”¯æŒæµ®ç‚¹æ•° æ”¯æŒæ­£è´Ÿæ•° ç¬¦åˆæ—¥å¸¸å£è¯­ä¹ æƒ¯ èƒ½æ”¯æŒç¿»è¯‘ js æ•°å­—èŒƒå›´å†…çš„æ‰€æœ‰æ•°å­— å®ç°ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309/** * æµ®ç‚¹æ•°è½¬ä¸­æ–‡ * * @author:GuangHui * @email:adamssbryan@foxmail.com * @export * @class NumberToChinese */export default class NumberToChinese &#123; // - 90989002.0384 // ç¬¦å· æ•´æ•° ç‚¹å· å°æ•° // ç¬¦å·ã€ç‚¹å·ã€å°æ•°éƒ¨åˆ†ç›´æ¥æŸ¥æ‰¾å¼•å°„è¡¨è¿›è¡Œç¿»è¯‘å³å¯ // æ•´æ•°éƒ¨åˆ†æ¯ä¸ªè®¡æ•°æ•°å­—éƒ½è·Ÿç€ä¸€ä¸ªæƒä½ï¼Œæƒä½æœ‰ï¼š''(ä¸ªä½ï¼Œé»˜è®¤ä¸ç¿»è¯‘),åã€ç™¾ã€åƒã€ä¸‡ã€äº¿ã€‚ // æ•´æ•°éƒ¨åˆ†ä»¥â€œä¸‡â€ä¸ºå°èŠ‚(æ•´æ•°éƒ¨åˆ†ä»å³è‡³å·¦æ•°æ¯å››ä½ä¸ºä¸€å°èŠ‚)ï¼Œå¯¹åº”ä¸€ä¸ªèŠ‚æƒä½ï¼Œä¸‡ä»¥ä¸‹æ²¡æœ‰èŠ‚æƒä½(æœ€å°èŠ‚æƒä½ä¸ºä¸‡)ï¼ŒèŠ‚æƒä½æœ‰ï¼šä¸‡, äº¿, ä¸‡äº¿, äº¿äº¿ï¼›ä¾‹:1 2345 . 3ï¼›1å±äºé¦–å°èŠ‚ï¼Œ 2345ä¸ºç¬¬äºŒå°èŠ‚ // æ¯ä¸ªå°èŠ‚å†…éƒ¨ä»¥â€œåç™¾åƒâ€ä¸ºæƒä½ç‹¬ç«‹è®¡æ•°ã€‚ // â€œåç™¾åƒâ€ä¸èƒ½è¿ç»­å‡ºç°ï¼Œè€Œâ€œä¸‡â€å’Œâ€œäº¿â€ä½œä¸ºèŠ‚æƒä½æ—¶å¯ä»¥å’Œå…¶ä»–æƒä½è¿ç”¨ï¼Œå¦‚ï¼šâ€œäºŒåäº¿â€ã€‚ // æ•´æ•°å°èŠ‚å†…â€œé›¶â€çš„ä½¿ç”¨è¦æ»¡è¶³ä»¥ä¸‹è§„åˆ™ï¼š // 0å¯¹åº”çš„æƒä½ä¸ç¿»è¯‘ã€‚ä¾‹ï¼š203åº”ç¿»è¯‘ä¸º'äºŒç™¾ é›¶ ä¸‰'è€Œä¸æ˜¯'äºŒç™¾ é›¶å ä¸‰' // å°èŠ‚çš„æœ«ä½æ˜¯0ï¼Œå¯ä¸ç¿»è¯‘ã€‚ä¾‹ï¼šå°èŠ‚ä¸º230ï¼Œé€ä½ç¿»è¯‘ï¼Œåº”ä¸º'äºŒç™¾ ä¸‰å é›¶'ï¼Œæ ¹æ®æ­¤è§„åˆ™ï¼Œç»“å°¾é›¶åº”è¯¥èˆå¼ƒï¼Œä¸º'äºŒç™¾ ä¸‰å' // å°èŠ‚å†…ä¸¤ä¸ªé0æ•°å­—ä¹‹é—´è‹¥å‡ºç°0è¦ä½¿ç”¨â€œé›¶â€ã€‚ä¾‹ï¼šå°èŠ‚ä¸º203ï¼Œåº”ç¿»è¯‘ä¸º'äºŒç™¾ é›¶ ä¸‰' // å°èŠ‚å†…å¤šä¸ªè¿ç»­çš„é›¶åº”åˆå¹¶ã€‚ä¾‹ï¼šå°èŠ‚ä¸º2003ï¼Œåº”ç¿»è¯‘ä¸ºäºŒåƒé›¶ä¸‰ï¼Œè€ŒéäºŒåƒé›¶ç™¾é›¶åä¸‰ // å½“å°èŠ‚çš„â€œåƒâ€ä½æ˜¯0æ—¶ï¼ˆå³ï¼š1~999ï¼‰ï¼Œåªè¦ä¸æ˜¯é¦–å°èŠ‚ï¼Œéƒ½è¦å‰è¡¥â€œé›¶â€ã€‚éé¦–å°èŠ‚ä¸è¶³å››ä½æ—¶ï¼Œéœ€è¦å‰è¡¥é›¶ï¼Œé¦–å°èŠ‚æ— éœ€å‰è¡¥é›¶ã€‚ä¾‹: 10234ï¼Œé¦–å°èŠ‚ä¸º1ï¼Œç¬¬äºŒå°èŠ‚ä¸º234ä¸è¶³å››ä½ï¼Œç¿»è¯‘æ—¶ç¬¬äºŒå°èŠ‚éœ€è¦å‰è¡¥é›¶ï¼Œå³é›¶äºŒç™¾ä¸‰åå››ï¼Œå†prependç¬¬ä¸€å°èŠ‚çš„ç¿»è¯‘ä¸€ä¸‡ï¼Œæœ€ç»ˆç»“æœä¸º'ä¸€ä¸‡ é›¶ äºŒç™¾ ä¸‰å å››' // æ­£è´Ÿ0ä¸åšåŒºåˆ† constructor(&#123; unitChars, sectionUnitChars, numChars, dotChar, signChar &#125; = &#123;&#125;) &#123; this.unitChars = unitChars || ['', 'å', 'ç™¾', 'åƒ'] // èŠ‚å†…æƒä½ this.sectionUnitChars = sectionUnitChars || ['', 'ä¸‡', 'äº¿', 'ä¸‡äº¿', 'äº¿äº¿'] // èŠ‚æƒä½ this.numChars = numChars || [ 'é›¶', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­', 'ä¸ƒ', 'å…«', 'ä¹' ] // æ•°å­—æ˜ å°„è¡¨ this.dotChar = dotChar || 'ç‚¹' this.signChar = signChar || 'è´Ÿ' &#125; /** * åˆ¤æ–­æ•°å­—æ˜¯å¦åœ¨å®‰å…¨èŒƒå›´å†… * @param &#123;Number&#125; n æ•°å­— */ isSafeNumber(n) &#123; return typeof n === 'number' &amp;&amp; !isNaN(n) &amp;&amp; Math.abs(n) &lt;= Math.pow(2, 53) &#125; /** * å¡«å……å­—ç¬¦ä¸² * * @param &#123;String&#125; str åŸå§‹å­—ç¬¦ä¸² * @param &#123;Number&#125; padNum å¡«å……æ•°é‡ * @param &#123;String&#125; padChar å¡«å……å­—ç¬¦ * @param &#123;Boolean&#125; [before=true] å‰å¡«å…… * @returns å¡«å……åçš„å­—ç¬¦ä¸² * @memberof NumberToChinese */ padStr(str, padNum, padChar, before = true) &#123; if ( typeof str !== 'string' || typeof padNum !== 'number' || isNaN(padNum) || padNum === 0 || typeof padChar !== 'string' ) &#123; return str &#125; while (padNum) &#123; if (before) &#123; str = padChar + str &#125; else &#123; str += padChar &#125; padNum-- &#125; return str &#125; /** * è·å–æ•°å­—å¯¹åº”ä¸­æ–‡ * * @param &#123;Number&#125; i æ•°å­— * @returns å¯¹åº”æ•°å­—çš„ä¸­æ–‡ * @memberof NumberToChinese */ getNumChar(i) &#123; return this.numChars[i] &#125; /** * è·å–èŠ‚å†…æƒä½ * @param &#123;Number&#125; i ç´¢å¼• */ getUnitChar(i) &#123; return this.unitChars[i] &#125; /** * è·å–èŠ‚æƒä½ * @param &#123;Number&#125; i ç´¢å¼• */ getSectionUnitChar(i) &#123; return this.sectionUnitChars[i] &#125; /** * è·å–æµ®ç‚¹æ•°å„ç»„æˆéƒ¨åˆ† * * @param &#123;Number&#125; n éœ€è¦åˆ†è§£çš„æ•°å­— * @returns æ•°å­—å„ç»„æˆéƒ¨åˆ† * @memberof NumberToChinese */ getParts(n) &#123; const num = parseFloat(n) if (!this.isSafeNumber(num)) return 'æ— æ³•è§£æ' const reg = /^([-+]?)(0|[1-9]\d*)(\.?)(\d*)$/ const &#123; 1: sign, 2: interger, 3: dot, 4: decimal &#125; = reg.exec( num.toString() ) return &#123; sign, interger, dot, decimal &#125; &#125; /** * è·å–ç‚¹å·å¯¹åº”ä¸­æ–‡ * * @param &#123;String&#125; dotPart ç‚¹å·éƒ¨åˆ† * @returns ç‚¹å·å¯¹åº”ä¸­æ–‡ * @memberof NumberToChinese */ getDotPartChn(dotPart) &#123; if (typeof dotPart !== 'string') return 'æ— æ³•è§£æ' return dotPart === '.' ? this.dotChar : '' &#125; /** * è·å–ç¬¦å·å¯¹åº”ä¸­æ–‡ * * @param &#123;String&#125; signPart ç¬¦å·éƒ¨åˆ† * @returns ç¬¦å·å¯¹åº”ä¸­æ–‡ * @memberof NumberToChinese */ getSignPartChn(signPart) &#123; if (typeof signPart !== 'string') return 'æ— æ³•è§£æ' return signPart === '-' ? this.signChar : '' &#125; /** * è·å–å°æ•°éƒ¨åˆ†çš„ä¸­æ–‡è¡¨ç¤º * * @param &#123;Number | String&#125; deci å°æ•°éƒ¨åˆ† * @returns å°æ•°éƒ¨åˆ†çš„ä¸­æ–‡è¡¨ç¤º * @memberof NumberToChinese */ getDecimalPartChn(n) &#123; if (!this.isSafeNumber(parseInt(n)) || typeof n !== 'string') return 'å‚æ•°ä¸ºæ— æ³•è§£æ' return n .toString() .split('') .map(item =&gt; this.getNumChar(item)) .join('') &#125; /** * è·å–æ•´æ•°éƒ¨åˆ†å°èŠ‚ * * @param &#123;String|Number&#125; n æ•´æ•° * @returns å°èŠ‚æ•°ç»„ * @memberof NumberToChinese */ getIntergerSections(n) &#123; let num = parseInt(n) if (!this.isSafeNumber(num) || num &lt; 0) &#123; return 'å‚æ•°æ— æ³•è§£ææˆ–å°äº0' &#125; if (num === 0) return [0] let temp = [] while (num &gt; 0) &#123; temp.push(num % 10000) num = Math.floor(num / 10000) &#125; return temp.reverse() &#125; /** * ç¿»è¯‘å°èŠ‚ * @param &#123;Number|String&#125; section 4ä½é•¿åº¦çš„å°èŠ‚ * @returns å°èŠ‚å¯¹åº”ä¸­æ–‡ */ getSectionsChn(section) &#123; let num = parseInt(section) if (!this.isSafeNumber(num) || num &gt;= 10000 || num &lt; 0) &#123; return 'èŠ‚æ— æ³•è§£ææˆæ•°å­—æˆ–ä½æ•°è¶…è¿‡4ä½æˆ–å°äº0' &#125; let str = '' let needPadStartZero = false let unitCount = 0 while (num &gt; 0) &#123; let g = num % 10 // å–ä¸ªä½æ•° if (g === 0) &#123; if (needPadStartZero) &#123; needPadStartZero = false // å½“å‰ä¸º0ï¼Œå·²ç»è¡¥è¿‡é›¶ï¼Œä¸‹æ¬¡è‹¥è¿˜ä¸º0åˆ™ä¸éœ€è¡¥ str = this.padStr(str, 1, this.getNumChar(0)) &#125; &#125; else &#123; // å½“å‰æ•°ä¸ä¸º0ï¼Œé»˜è®¤ä¸‹æ¬¡ä¸º0ï¼Œéœ€è¦è¿›è¡Œè¡¥é›¶æ“ä½œã€‚ needPadStartZero = true str = this.getNumChar(g) + this.getUnitChar(unitCount) + str &#125; unitCount++ num = Math.floor(num / 10) &#125; return str &#125; /** * è·å–æ•´æ•°éƒ¨åˆ†å¯¹åº”ä¸­æ–‡ * * @param &#123;String|Number&#125; intergerPart æ•´æ•°éƒ¨åˆ† * @returns æ•´æ•°éƒ¨åˆ†å¯¹åº”ä¸­æ–‡ * @memberof NumberToChinese */ getIntergetPartChn(intergerPart) &#123; const originNum = parseInt(intergerPart) if (!this.isSafeNumber(originNum) || originNum &lt; 0) &#123; return 'æ— æ³•è§£ææˆæ•°å­—æˆ–è¶…å‡ºèŒƒå›´æˆ–ä¸æ˜¯æ­£æ•°' &#125; if (originNum === 0) return this.getNumChar(0) let sectionsArr = this.getIntergerSections(originNum) let transformedSectionsArr = sectionsArr .reverse() // ç¿»è½¬å°èŠ‚ï¼Œä»æœ€åä¸€ä¸ªå°èŠ‚å¼€å§‹ç¿»è¯‘ .reduce((acc, cur, index, arr) =&gt; &#123; if (cur === 0) return acc // éé¦–å°èŠ‚å¹¶å°äº1000çš„éœ€è¦å‰è¡¥é›¶ let sectionChn = index !== arr.length - 1 &amp;&amp; cur &lt; 1000 ? this.padStr(this.getSectionsChn(cur), 1, this.getNumChar(0)) : this.getSectionsChn(cur) // å¤„ç†é¦–å°èŠ‚ä¸º10~19çš„ç‰¹æ®Šåœºæ™¯ // ä¸€åä¸€ï¼Œéœ€è¦è½¬æ¢æˆåä¸€ if (index === arr.length - 1 &amp;&amp; cur &gt;= 10 &amp;&amp; cur &lt; 20) &#123; sectionChn = sectionChn.replace(/^ä¸€/, '') &#125; sectionChn += this.getSectionUnitChar(index) return acc.concat(sectionChn) &#125;, []) return transformedSectionsArr.reverse().join('') &#125; /** * æµ®ç‚¹æ•°è½¬ä¸­æ–‡æ•°å­— * @param &#123;String|Number&#125; n éœ€è¦è½¬æ¢çš„æ•°å­— * @returns ä¸­æ–‡æ•°å­— */ transform(n) &#123; const num = parseFloat(n) if (!this.isSafeNumber(num)) return 'æ— æ³•è§£ææˆæ•°å­—æˆ–è¶…å‡ºèŒƒå›´' const &#123; sign, interger, dot, decimal &#125; = this.getParts(num) const signChn = sign ? this.getSignPartChn(sign) : '' const intergerChn = this.getIntergetPartChn(interger) const dotChn = dot ? this.getDotPartChn(dot) : '' const decimalChn = decimal ? this.getDecimalPartChn(decimal) : '' return `$&#123;signChn&#125;$&#123;intergerChn&#125;$&#123;dotChn&#125;$&#123;decimalChn&#125;` &#125;&#125; è°ƒç”¨1234567891011121314151617181920212223242526272829303132333435363738394041const numberToChn = new NumberToChinese()// æ•´æ•°console.log(numberToChn(1))console.log(numberToChn(2))console.log(numberToChn(11))console.log(numberToChn(19))console.log(numberToChn(123))console.log(numberToChn(103))console.log(numberToChn(1003))console.log(numberToChn(21234))console.log(numberToChn(21003))console.log(numberToChn(123456789))console.log(numberToChn(1000))console.log(numberToChn(10000))console.log(numberToChn(100000))console.log(numberToChn(1000000))console.log(numberToChn(10000000))// æµ®ç‚¹æ•°console.log(0.123)console.log(0.003)console.log(1.003)console.log(10.003)// é›¶çš„æƒ…å†µconsole.log(numberToChn(0))console.log(numberToChn('0'))console.log(numberToChn(0.0))console.log(numberToChn(0.1))console.log(numberToChn(0.01))console.log(numberToChn(0.123456))// è´Ÿæ•°æƒ…å†µconsole.log(numberToChn(-0))console.log(numberToChn(-2))console.log(numberToChn(-10))console.log(numberToChn(-1000))// å†…éƒ¨æ–¹æ³•è°ƒç”¨console.log(numberToChn.getPars(-1.234)) å‚è€ƒ https://www.cnblogs.com/liquanjiang/p/8655075.html]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>åº“</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[v-model-sync]]></title>
    <url>%2F2019%2F02%2F22%2Fv-model-sync%2F</url>
    <content type="text"><![CDATA[v-modelã€.sync çš„å¼‚åŒv-model å®ç°åŒå‘æ•°æ®ç»‘å®š(æ•°æ® model æ”¹å˜ä¼šè‡ªåŠ¨åæ˜ åˆ°è§†å›¾ view ä¸Šï¼Œè§†å›¾ view çš„æ•°æ®å˜åŒ–ä¹Ÿä¼šåŒæ­¥åˆ°æ•°æ® model ä¸­)ï¼Œä¸€èˆ¬ç”¨åœ¨è¡¨å•çš„åŒå‘æ•°æ®ç»‘å®šçº¦å®šä¿—æˆçš„ç”¨åœ¨è¡¨å•ç›¸å…³ç»„ä»¶ä¸Š v-model ä¼šå¿½ç•¥æ‰€æœ‰è¡¨å•å…ƒç´ çš„ valueã€checkedã€selected ç‰¹æ€§çš„åˆå§‹å€¼è€Œæ€»æ˜¯å°† Vue å®ä¾‹çš„æ•°æ®ä½œä¸ºæ•°æ®æ¥æºã€‚åœ¨è°ƒè¯•å·¥å…·ä¸­ç›´æ¥ä¿®æ”¹è¿™ 3 ä¸ªç‰¹æ€§å€¼éƒ½ä¸ä¼šç”Ÿæ•ˆï¼› è¯­æ³•ç³–:é»˜è®¤å½¢å†µä¸‹ä¼šç»‘å®šè¡¨å•çš„ value ä»¥åŠç›‘å¬ input äº‹ä»¶ï¼›å¯é€šè¿‡ model é€‰é¡¹ï¼Œé…ç½® v-model çš„è§¦å‘æœºåˆ¶ 1234567891011121314151617181920212223242526272829303132333435363738&lt;input v-model="searchText"&gt;// ç­‰ä»·äºï¼š&lt;input v-bind:value="searchText" v-on:input="searchText = $event.target.value"&gt;// ç”¨åœ¨ç»„ä»¶ä¸Šæ—¶&lt;custom-input v-bind:value="searchText" v-on:input="searchText = $event" // $eventä¸ºç»„ä»¶å†…éƒ¨æ´¾å‘å‡ºæ¥çš„å€¼&gt;&lt;/custom-input&gt;// custom-inputç»„ä»¶å¿…é¡»æ¥å—value ä»¥åŠåœ¨ æ´¾å‘inputäº‹ä»¶ï¼›å³v-modelé»˜è®¤æƒ…å†µä¸‹æ— è®ºæ˜¯ç”¨åœ¨åŸç”Ÿè¡¨å•ç»„ä»¶è¿˜æ˜¯è‡ªå®šä¹‰ç»„ä»¶ä¸Šï¼Œéƒ½å¿…é¡»ç»‘å®švalueä»¥åŠç›‘å¬inputäº‹ä»¶Vue.component('custom-input', &#123; props: ['value'], template: ` &lt;input v-bind:value="value" v-on:input="$emit('input', $event.target.value)" &gt; `&#125;)// è‡ªå®šä¹‰v-modelçš„è§¦å‘æœºåˆ¶Vue.component('base-checkbox', &#123; model: &#123; // å°†v-modelçš„æœºåˆ¶è°ƒæ•´ä¸º ç»‘å®šcheckedå’Œç›‘å¬changeäº‹ä»¶ prop: 'checked', event: 'change' &#125;, props: &#123; checked: Boolean &#125;, template: ` &lt;input type="checkbox" v-bind:checked="checked" v-on:change="$emit('change', $event.target.checked)" &gt; `&#125;) .sync ä¿®é¥°ç¬¦ ä¸»è¦ç”¨æ¥å®ç°çˆ¶å­ç»„ä»¶é—´æ•°æ®çš„åŒå‘ä¼ é€’ å•å‘æ•°æ®ä¼ é€’ä¸º:props down,events up vue ä¸­æ˜¯ä¸æ¨èä½¿ç”¨åŒå‘æ•°æ®ä¼ é€’çš„ï¼Œå› ä¸ºå­ç»„ä»¶å¯ä»¥ä¿®æ”¹çˆ¶ç»„ä»¶ï¼Œä¸”åœ¨çˆ¶ç»„ä»¶å’Œå­ç»„ä»¶éƒ½æ²¡æœ‰æ˜æ˜¾çš„æ”¹åŠ¨æ¥æºï¼Œä¼šå¸¦æ¥ç»´æŠ¤ä¸Šçš„é—®é¢˜ ä½†åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œæœ‰ä¸€å®šå®ç”¨ä»·å€¼ï¼Œæ‰€ä»¥ vue åœ¨ 2.3 ç‰ˆæœ¬ä¸­åˆæ·»åŠ å›æ¥äº† æœ¬è´¨è¿˜æ˜¯ä¸ªè¯­æ³•ç³– 123456789101112131415161718192021222324252627// åœ¨æ²¡æœ‰.syncæ—¶ï¼Œvueæ¨èä½¿ç”¨ä¸‹é¢æ–¹å¼å®ç°å­ç»„ä»¶ä¿®æ”¹çˆ¶ç»„ä»¶çš„æ•°æ®&lt;text-document v-bind:title="doc.title" v-on:update:title="doc.title = $event"&gt;&lt;/text-document&gt;Vue.component('text-document', &#123; props: &#123; title : String &#125;, template: ` &lt;div v-text="title" @click="$emit('update:title','æˆ‘æ˜¯æ–°title')"&gt; &lt;/div&gt; `&#125;)// ä¸ºäº†ç®€åŒ–ä¸Šè¿°æµç¨‹ï¼Œæ¨å‡ºäº†.syncä¿®é¥°ç¬¦&lt;text-document v-bind:title.sync="doc.title" // æ— éœ€å†ç›‘å¬update:titleäº‹ä»¶,ä½†å­ç»„ä»¶ä»éœ€è¦æ´¾å‘å¯¹åº”è‡ªå®šä¹‰äº‹ä»¶&gt;&lt;/text-document&gt;Vue.component('text-document', &#123; props: &#123; title : String &#125;, template: ` &lt;div v-text="title" @click="$emit('update:title','æˆ‘æ˜¯æ–°title')"&gt; &lt;/div&gt; `&#125;) äºŒè€…å¼‚åŒ v-model é»˜è®¤æƒ…å†µä¸‹ä¸º value+input çš„ç»„åˆï¼›.sync ä¸ºä»»æ„ç»„åˆ v-model å¸¸ç”¨åœ¨è¡¨å•ä¸­ï¼›.sync ä¸»è¦ç”¨åœ¨çˆ¶å­ç»„ä»¶é€šä¿¡ä¸­ï¼Œå­ç»„ä»¶éœ€è¦ä¿®æ”¹çˆ¶ç»„ä»¶æ•°æ®æ—¶ å¯ä»¥å°† v-model ç†è§£æˆ.sync çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼ŒäºŒè€…åº•å±‚çš„å®ç°æœºåˆ¶ç±»ä¼¼ï¼›v-model åšäº†æ•°æ®ä¼ é€’+ä¿®æ”¹çš„å·¥ä½œï¼›.sync æ›´å¤šçš„æ˜¯æ•°æ®ä¼ é€’ï¼Œä¿®æ”¹éœ€è¦äº¤ç»™ç”¨æˆ·è‡ªå·± å¯ä»¥å‚è€ƒ https://blog.csdn.net/Qin_Shuo/article/details/82693919]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vue-high-level-component]]></title>
    <url>%2F2019%2F02%2F22%2Fvue-high-level-component%2F</url>
    <content type="text"><![CDATA[Vue inheritAttrsã€$attrsã€$listenersã€provideã€injectã€slotã€slotScopeä¸ä½¿ç”¨ vuexã€eventBus åœ¨é«˜å±‚çº§ç»„ä»¶ä¸­ä¼ é€’æ•°æ® ç»„ä»¶è°ƒç”¨å…³ç³» A-&gt;B-&gt;C ï¼ˆA è°ƒç”¨ Bï¼ŒB è°ƒç”¨ Cï¼‰ åŸºæœ¬æ¦‚å¿µ inheritAttrs é»˜è®¤æƒ…å†µä¸‹çˆ¶ä½œç”¨åŸŸä¸­çš„ä¸è¢«å­ç»„ä»¶è®¤ä½œä¸º props çš„ç‰¹æ€§ç»‘å®š (attribute bindings) å°†ä¼šâ€œå›é€€â€ä¸”ä½œä¸ºæ™®é€šçš„ HTML ç‰¹æ€§åº”ç”¨åœ¨å­ç»„ä»¶çš„æ ¹å…ƒç´ ä¸Šã€‚ é€šè¿‡è®¾ç½® B ç»„ä»¶çš„ inheritAttrs ä¸º falseï¼Œå¯å±è”½æ‰è¿™ç§é»˜è®¤è¡Œä¸ºã€‚B ç»„ä»¶ä»å¯é€šè¿‡$attrs è®¿é—®è¿™äº›ä¸è¢«è®¤ä½œ propsçš„ç‰¹æ€§ ä¾‹å­ 1 ä¾‹å¦‚ A ç»„ä»¶ä¼ é€’äº† a,b,c,d å››ä¸ªå‚æ•°ç»™ B ç»„ä»¶ï¼Œä½† B ç»„ä»¶å®é™…é€šè¿‡ props åªæ¥æ”¶äº† aã€b ä¸¤ä¸ªä¸ªï¼Œé‚£ä¹ˆä¸¤å¤–ä¸¤ä¸ª cã€d å°†åšä¸ºæ™®é€š html ç‰¹æ€§åº”ç”¨åˆ°å­ç»„ä»¶çš„æ ¹å…ƒç´ ä¸Šã€‚ é€šè¿‡å°† B çš„inheritAttrsè®¾ç½®ä¸º falseï¼Œåˆ™å¯å±è”½è¿™ç§è¡Œä¸º(cã€d å°†ä¸ä¼šåšä¸ºæ™®é€š html ç‰¹æ€§åº”ç”¨åˆ°å­ç»„ä»¶çš„æ ¹å…ƒç´ ä¸Šï¼Œä½† B ç»„ä»¶ä»èƒ½æ¥æ”¶ aã€b)ã€‚B ç»„ä»¶ä»å¯é€šè¿‡ this.$attrs è®¿é—®åˆ°è¿™äº›ä¸è¢«è®¤ä½œ props çš„ç‰¹æ€§ cã€dã€‚ $attrs åŒ…å«äº†çˆ¶ä½œç”¨åŸŸä¸­ä¸è¢«å½“å‰ç»„ä»¶è®¤ä½œä¸º prop è¢«è¯†åˆ« (ä¸”è·å–) çš„ç‰¹æ€§ç»‘å®š (class å’Œ style é™¤å¤–)ã€‚ åœºæ™¯å¦‚ä¾‹å­ 1 B ç»„ä»¶è®¾ç½®äº†inheritAttrsä¸º false åï¼Œä»å¯é€šè¿‡this.$attrsè®¿é—®åˆ°é‚£äº›ä¸è¢«è®¤ä½œ props çš„ç‰¹æ€§ cã€dã€‚ B ç»„ä»¶å¯åœ¨è°ƒç”¨ C ç»„ä»¶æ—¶ï¼Œé€šè¿‡åœ¨ C ç»„ä»¶ä¸Šç¼–å†™v-bind=&quot;$attrs&quot;å°†è¿™äº›å‚æ•°ä¼ é€’åˆ° C ç»„ä»¶ä¸­ã€‚(è¿™æ ·å°±å¯ä»¥é¿å…åœ¨ B ç»„ä»¶è°ƒç”¨ C ç»„ä»¶æ—¶ï¼Œéœ€è¦åœ¨ B ç»„ä»¶çš„ data ä¸­äº‹å…ˆå£°æ˜ C ç»„ä»¶éœ€è¦çš„å‚æ•°ï¼Œè®© B ç»„ä»¶å°½å¯èƒ½çš„ä¿æŒ Dry) é€šè¿‡ä¸Šè¿°æµç¨‹å…¶å®å°±å®Œæˆäº† A ç»„ä»¶çš„å‚æ•°ä¼ é€’åˆ°äº†æ›´æ·±å±‚æ¬¡çš„ C ç»„ä»¶ä¸­ã€‚ $listeners åŒ…å«äº†çˆ¶ä½œç”¨åŸŸä¸­çš„ (ä¸å« .native ä¿®é¥°å™¨çš„) æŒ‚è½½åœ¨å½“å‰ç»„ä»¶ä¸Šçš„ v-on äº‹ä»¶ç›‘å¬å™¨ã€‚ åœ¨ B ç»„ä»¶ä¸­è®¿é—®$listenersï¼Œå°†ä¼šå¾—åˆ° A ç»„ä»¶å†™åœ¨ B ç»„ä»¶ä¸Šçš„æ‰€æœ‰ç›‘å¬å™¨ã€‚ ä¾‹å­ 2 A è°ƒç”¨ B ç»„ä»¶ï¼ŒA åœ¨ B ç»„ä»¶ä¸Šé€šè¿‡@ç›‘å¬äº†clickã€enterä¸¤ä¸ªäº‹ä»¶ï¼Œåˆ™åœ¨ B ç»„ä»¶è®¿é—®$listenerså°†ä¼šå¾—åˆ°clickã€enterè¿™ä¸¤ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œå¹¶èƒ½ç›´æ¥è°ƒç”¨ä»–ä»¬ã€‚ B ç»„ä»¶è°ƒç”¨ C ç»„ä»¶æ—¶ï¼Œå¯é€šè¿‡åœ¨ C ç»„ä»¶ä¸Šç¼–å†™v-on=&quot;$listeners&quot;å°†è¿™äº›äº‹ä»¶ç›‘å¬å™¨ä¼ é€’åˆ° C ç»„ä»¶ä¸­ã€‚ é€šè¿‡ä¸Šè¿°æµç¨‹å°±å®ç°äº† A ç»„ä»¶ç›‘å¬ C ç»„ä»¶è§¦å‘çš„äº‹ä»¶æ•ˆæœè¿™æ ·å°±é¿å…äº† B ç»„ä»¶éœ€è¦ç›‘å¬ C ç»„ä»¶çš„äº‹ä»¶ï¼Œç„¶ååšä¸€å±‚è½¬å‘ï¼Œè¿›è€Œä¼ é€’ç»™ A ç»„ä»¶ã€‚ provide/inject ä»¥å…è®¸ä¸€ä¸ªç¥–å…ˆç»„ä»¶å‘å…¶æ‰€æœ‰å­å­™åä»£æ³¨å…¥ä¸€ä¸ªä¾èµ–ï¼Œä¸è®ºç»„ä»¶å±‚æ¬¡æœ‰å¤šæ·±ï¼Œå¹¶åœ¨èµ·ä¸Šä¸‹æ¸¸å…³ç³»æˆç«‹çš„æ—¶é—´é‡Œå§‹ç»ˆç”Ÿæ•ˆ å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªåŠ å¼ºç‰ˆçš„ props props åªèƒ½å®Œæˆçˆ¶å‘å­ä¼ é€’æ•°æ®ï¼Œæ— æ³•å®Œæˆæ›´æ·±å±‚çº§ç»„ä»¶é—´çš„æ•°æ®ä¼ é€’ã€‚ provide/injectäºŒè€…é€šå¸¸é…å¥—ä½¿ç”¨ provide/injectæä¾›çš„æ•°æ®æ˜¯ä¸å¯å“åº”çš„ï¼Œå¹¶ä¸”æ˜¯å•å‘çš„ï¼ˆç¥–å…ˆ-&gt;å­å­™ï¼‰ã€‚ ä¾‹å­ 3123456789101112131415161718192021222324252627282930313233343536373839// çˆ¶çº§Aç»„ä»¶æä¾› 'foo'var Provider = &#123; provide: &#123; foo: 'bar' &#125; // ...&#125;// å­å­™ç»„ä»¶Bå’ŒCéƒ½å¯ä»¥æ³¨å…¥ 'foo'var Child = &#123; inject: ['foo'], created() &#123; console.log(this.foo) // =&gt; "bar" &#125; // ...&#125;// è®¾ç½®injecté»˜è®¤å€¼const Child = &#123; inject: &#123; foo: &#123; default: 'foo' &#125; &#125;&#125;// å¦‚æœå®ƒéœ€è¦ä»ä¸€ä¸ªä¸åŒåå­—çš„å±æ€§æ³¨å…¥ï¼Œåˆ™ä½¿ç”¨ from æ¥è¡¨ç¤ºå…¶æºå±æ€§const Child = &#123; inject: &#123; foo: &#123; from: 'bar', default: 'foo' &#125; &#125;&#125;// ä¸ prop çš„é»˜è®¤å€¼ç±»ä¼¼ï¼Œä½ éœ€è¦å¯¹éåŸå§‹å€¼ä½¿ç”¨ä¸€ä¸ªå·¥å‚æ–¹æ³•const Child = &#123; inject: &#123; foo: &#123; from: 'bar', default: () =&gt; [1, 2, 3] &#125; &#125;&#125; åœ¨æ·±å±‚çº§ç»„ä»¶ä¸­ä¼ é€’ slot slot å…ƒç´ å¯é€šè¿‡è®¾ç½® name æ¥æ ‡è¯†å…¶ä¸ºä¸€ä¸ªå…·åæ’æ§½ï¼Œå…¶æœ¬èº«è¿˜å¯ä»¥è®¾ç½®ä¸€ä¸ª slot ç‰¹æ€§ç”¨æ¥è¡¨ç¤ºå®ƒå°†åº”ç”¨åˆ°å­ç»„ä»¶çš„å“ªä¸ªæ’æ§½ä¸­ã€‚ åˆ©ç”¨ä¸Šè¿°ç‰¹æ€§å°±å¯ä»¥å®ç°åœ¨æ·±å±‚çº§ç»„ä»¶ä¸­ä¼ é€’ slot ä¾‹å­ 4 A-&gt;B-&gt;C ï¼ˆA è°ƒç”¨ Bï¼ŒB è°ƒç”¨ Cï¼‰ C ä¸­æœ‰ä¸€ä¸ªåä¸º cHd çš„å…·åæ’æ§½ B ä¸­æœ‰ä¸€ä¸ªåä¸º bHd çš„å…·åæ’æ§½ï¼Œå¹¶è®¾ç½®äº† slot ç‰¹æ€§ä¸º cHd A åœ¨è°ƒç”¨ B ç»„ä»¶æ—¶ï¼Œä¼ å…¥äº†ä¸€ä¸ª h1 å¹¶è®¾ç½® slot ç‰¹æ€§ä¸º bHd æœ€ç»ˆæ­¤ h1 å°†ä¼šä¼ é€’åˆ° C ç»„ä»¶çš„ cHd æ’æ§½ä¸­ slotScope å¯å‚è€ƒhttps://www.jianshu.com/p/0645bc9033a5ã€https://segmentfault.com/a/1190000015884505 slot-scope æ˜¯åº”ç”¨åœ¨ç»„ä»¶å°è£…è€…ä¸çŸ¥é“è°ƒç”¨è€…å¦‚ä½•ä½¿ç”¨ç»„ä»¶çš„æƒ…å†µä¸‹ï¼Œå¼€æ”¾äº†ä¸€ä¸ªæ¥å£ç»™è°ƒç”¨è€…è®©å…¶ DIYï¼ˆè‡ªå®šä¹‰æ ·å¼ã€ä¸šåŠ¡é€»è¾‘ï¼‰]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[flip]]></title>
    <url>%2F2019%2F02%2F21%2Fflip%2F</url>
    <content type="text"><![CDATA[flip åŠ¨ç”»æŠ€æœ¯å‰è¨€ å°ºå¯¸ã€ä½ç½®åŠ¨ç”»ä¼šè§¦å‘é‡æ’ï¼Œå¯¼è‡´åŠ¨ç”»ä¸æµç•…ã€åŠ¨ç”»å¯åŠ¨æ…¢ flip æŠ€æœ¯ä¸»è¦çš„ç›®çš„æ˜¯å°†å¸¸è§çš„å°ºå¯¸(widthã€height)ã€ä½ç½®(topã€left...)åŠ¨ç”»æ˜ å°„ä¸ºæ€§èƒ½å¼€é”€å°çš„transformåŠ¨ç”» åŸºæœ¬æ¦‚å¿µ First: å…ƒç´ çš„åˆå§‹çŠ¶æ€ Lastï¼šå…ƒç´ çš„æœ€ç»ˆçŠ¶æ€ Invertï¼šåè½¬ Playï¼šå¼€å¯åŠ¨ç”» åŸºæœ¬æ€è·¯ Firstï¼šè·å–å…ƒç´ çš„åˆå§‹çŠ¶æ€ Lastï¼šè®¾ç½®å…ƒç´ çš„çŠ¶æ€ä¸ºè¿åŠ¨ç»“æŸçš„æœ€ç»ˆçŠ¶æ€ Invertï¼šé€šè¿‡è®¾ç½®ç›¸åçš„transformå€¼å°†å…ƒç´ ä»æœ€ç»ˆçŠ¶æ€åè½¬ä¸ºåˆå§‹çŠ¶æ€ Playï¼šè®¾ç½®å…ƒç´ transitionè¿åŠ¨å±æ€§(ç¼“åŠ¨ã€æ—¶é•¿ç­‰)ï¼Œå†æ¸…ç©ºtransformåŠ¨ç”»æ¥å¯åŠ¨åŠ¨ç”» å¯é€‰çš„ Cleanï¼šåŠ¨ç”»ç»“æŸï¼Œæ¸…é™¤æ“ä½œ ä¾‹å­12345678910111213141516171819202122// è·å–åˆå§‹ä½ç½®var first = el.getBoundingClientRect()// ä¸ºå…ƒç´ æŒ‡å®šä¸€ä¸ªæ ·å¼ï¼Œè®©å…ƒç´ åœ¨æœ€ç»ˆä½ç½®ä¸Šel.classList.add('end')// è·å–æœ€ç»ˆä½ç½®var last = el.getBoundingClientRect()// å¦‚æœæœ‰å¿…è¦ä¹Ÿå¯ä»¥å¯¹å…¶ä»–æ ·å¼è¿›è¡Œè®¡ç®—ï¼Œä½†æœ€å¥½åšæŒåªè¿›è¡Œ transform å’Œ opacity ç›¸å…³çš„è®¡ç®—var invert = first.top - last.top// åè½¬el.style.transform = 'translateY(' + invert + 'px)'// ç­‰åˆ°ä¸‹ä¸€å¸§ï¼Œä¹Ÿå°±æ˜¯å…¶ä»–æ‰€æœ‰çš„æ ·å¼éƒ½å·²ç»è¢«åº”ç”¨requestAnimationFrame(function() &#123; // æ·»åŠ åŠ¨ç”»ç›¸å…³çš„è®¾ç½® el.classList.add('on-moving') // å¼€å§‹åŠ¨ç”» el.style.transform = ''&#125;)// ç»“æŸæ—¶æ¸…ç†el.addEventListener('transitionend', clean, false) å®é™… demo123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263&lt;!DOCTYPE html&gt;&lt;html&gt; &lt;head&gt; &lt;meta charset="utf-8" /&gt; &lt;meta http-equiv="X-UA-Compatible" content="IE=edge" /&gt; &lt;title&gt;Page Title&lt;/title&gt; &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt; &lt;style&gt; .box &#123; width: 100px; height: 100px; border: 1px solid red; position: absolute; &#125; .start &#123; left: 100px; top: 50px; &#125; .end &#123; left: 800px; top: 400px; &#125; .on-moving &#123; transition: transform 0.3s linear; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div class="box start"&gt;box&lt;/div&gt; &lt;script&gt; window.onload = function() &#123; var $el = document.querySelector('.box') $el.addEventListener('click', boot, false) function boot(e) &#123; var that = this // Last this.classList.add('end') // Invert this.style.transform = 'translate3d(-700px,-350px,0)' // -700ä¸º 100-800ï¼› -350ä¸º 50-400 // Play requestAnimationFrame(function() &#123; that.classList.add('on-moving') that.style.transform = '' &#125;) // Clean $el.addEventListener('transitionend', clean, false) function clean(e) &#123; var target = e.target target.classList.remove('on-moving') target.removeEventListener('transitionend', clean, false) &#125; &#125; &#125; &lt;/script&gt; &lt;/body&gt;&lt;/html&gt; å…¶ä»– demohttp://vuejs.github.io/vue-animated-list/example.htmlhttps://codepen.io/davidkpiano/pen/305a618d4dd75cbe8423183c70d6a43e å‚è€ƒé“¾æ¥ https://www.w3cplus.com/animation/high-performance-animations.html https://www.w3cplus.com/javascript/animating-layouts-with-the-flip-technique.html http://luchun.github.io/animating-layouts-with-the-flip-technique/ https://codepen.io/davidkpiano/pen/305a618d4dd75cbe8423183c70d6a43e]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>åŠ¨ç”»</tag>
        <tag>flip</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vue-analysis-note]]></title>
    <url>%2F2019%2F01%2F20%2Fvue-analysis-note%2F</url>
    <content type="text"><![CDATA[å­¦ä¹ é»„å¥•è€å¸ˆçš„ã€Švue æºç åˆ†æã€‹è§†é¢‘çš„ç›¸å…³ç¬”è®°ä»“åº“åœ°å€ï¼šhttps://github.com/BryanAdamss/vue-for-analysis Vue-analysis-noteç‰ˆæœ¬ vue 2.5.17-beta.0 Flowé™æ€ç±»å‹æ£€æŸ¥å™¨æ£€æŸ¥æ–¹å¼ ç±»å‹æ¨æ–­ æ ¹æ®è°ƒç”¨çš„æ–¹æ³•ï¼Œæ¨æ–­å…¥å‚çš„ç±»å‹ ç±»å‹æ³¨é‡Š ä¸»åŠ¨æ·»åŠ å…¥å‚åŠè¿”å›å€¼çš„ç±»å‹ åœ¨ vue ä¸­çš„é…ç½® é€šè¿‡æ ¹ç›®å½•ä¸‹çš„.flowconfigè¿›è¡Œç›¸å…³é…ç½® [libs] \n flowå­—æ®µæŒ‡åäº†flow è‡ªå®šä¹‰ç±»å‹å®šä¹‰æ–‡ä»¶çš„ç›®å½•ä¸ºæ ¹ç›®å½•ä¸‹çš„flowæ–‡ä»¶å¤¹12345678flow |--- compiler.js # ç¼–è¯‘ç›¸å…³ |--- component.js # ç»„ä»¶æ•°æ®ç»“æ„ |--- global-api.js # Global API ç»“æ„ |--- modules.js # ç¬¬ä¸‰æ–¹åº“å®šä¹‰ |--- options.js # é€‰é¡¹ç›¸å…³ |--- ssr.js # æœåŠ¡ç«¯æ¸²æŸ“ç›¸å…³ |--- vnode.js # virtual node ç›¸å…³ ç›®å½•ç»“æ„src ç›®å½•ç»“æ„ vue æºç å­˜æ”¾åœ¨ vue é¡¹ç›®çš„ src ç›®å½•ä¸‹ src ç›®å½•ç»“æ„å¦‚ä¸‹1234567src|--- compiler # ç¼–è¯‘ç›¸å…³ä»£ç |--- core # æ ¸å¿ƒä»£ç |--- platforms # å¹³å°ç›¸å…³ä»£ç (web/weex)|--- server # æœåŠ¡ç«¯æ¸²æŸ“ä»£ç |--- sfc # .vueå•æ–‡ä»¶ç¼–è¯‘æˆjså¯¹è±¡ä»£ç |--- shared # è¾…åŠ©æ–¹æ³•åŠå¸¸é‡ æºç æ„å»ºåŸºäº rollup æ„å»ºæ„å»ºå‘½ä»¤123456789// package.json"scripts":&#123; ..., "build": "node scripts/build.js", // æ„å»ºwebå¹³å° "build:ssr": "npm run build -- web-runtime-cjs,web-server-renderer", // æ„å»ºæˆæœåŠ¡ç«¯æ¸²æŸ“ "build:weex": "npm run build -- weex",// æ„å»ºæˆweexå¹³å° ...&#125; ç”Ÿæˆç›®å½•12345678910dist|--- vue.common.js|--- vue.esm.browser.js|--- vue.esm.js|--- vue.js|--- vue.min.js|--- vue.runtime.common.js|--- vue.runtime.esm.js|--- vue.runtime.js|--- vue.runtime.min.js ç›®å½•ç»“æ„è§£é‡Š version UMD CommonJS ES Module Full vue.js vue.common.js vue.esm.js Runtime-only vue.runtime.js vue.runtime.common.js vue.runtime.esm.js Full (production) vue.min.js - - Runtime-only (production) vue.runtime.min.js - - è¯´æ˜ Full: åŒ…å«Compiler + Runtime Compiler: è´Ÿè´£å°†templateå­—ç¬¦ä¸²ç¼–è¯‘æˆvue renderå‡½æ•° Runtime: è´Ÿè´£åˆ›å»ºvueå®ä¾‹ã€æ¸²æŸ“ã€æ‰“è¡¥ä¸ç­‰ UMD: å¯ç›´æ¥ä½¿ç”¨&lt;script&gt;æ ‡ç­¾å¼•ç”¨çš„ç‰ˆæœ¬ï¼›unpkg CDNä¸Šhttps://unpkg.com/vueçš„é»˜è®¤ä¸ºcompiler+runtimeç‰ˆæœ¬(vue.js) CommonJS: ä¾›browserifyã€webpack1ä½¿ç”¨ ES Module: ä¾›webpack2ã€rollupä½¿ç”¨ CommonJSåŠES Moduleç‰ˆæœ¬æœªæä¾›å‹ç¼©ç‰ˆæœ¬ï¼Œéœ€è¦é€šè¿‡æ‰“åŒ…å·¥å…·è‡ªè¡Œå‹ç¼© Runtime + Compiler vs. Runtime-only Runtime + Compiler å¦‚æœéœ€è¦ä½¿ç”¨vueçš„templateå­—æ®µï¼Œåˆ™éœ€è¦ä½¿ç”¨æ­¤ç‰ˆæœ¬ï¼›ä¼šåœ¨è¿è¡Œæ—¶å°†templateå­—ç¬¦ä¸²ç¼–è¯‘æˆrenderå‡½æ•° å¹¶é…ç½®ç›¸åº”webpackåˆ«å123456789module.exports = &#123; // ... resolve: &#123; alias: &#123; 'vue$': 'vue/dist/vue.esm.js' // 'vue/dist/vue.common.js' for webpack 1 &#125; &#125;&#125;` Runtime-only å½“ä½¿ç”¨vue-loaderæˆ–è€…vueifyæ—¶ï¼Œåˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨æ­¤ç‰ˆæœ¬ï¼Œå› ä¸º*.vue æ–‡ä»¶ä¸­çš„tempalteå·²ç»åœ¨ç¼–è¯‘é˜¶æ®µè‡ªåŠ¨ç¼–è¯‘æˆæ¸²æŸ“å‡½æ•°äº†ï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦compilerï¼Œä»…éœ€è¦runtimeå°±å¯ä»¥äº† æ­¤ç‰ˆæœ¬ä½“ç§¯æ¯”Runtime + Compilerç‰ˆæœ¬ä½“ç§¯&lt;~30% å…¥å£æ–‡ä»¶ webå¹³å°çš„Fullç‰ˆæœ¬å…¥å£ä½ç½® src/platform/web/entry-runtime-with-compiler.js vueæœ€åˆè¢«å®šä¹‰çš„ä½ç½®-src/core/instance/index.js12345678910111213141516171819202122232425262728293031323334353637383940414243444546// src/platform/web/entry-runtime-with-compiler.js/* @flow */import config from 'core/config'import &#123; warn, cached &#125; from 'core/util/index'import &#123; mark, measure &#125; from 'core/util/perf'import Vue from './runtime/index'...// src/platform/web/runtime/index.js/* @flow */import Vue from 'core/index'import config from 'core/config'import &#123; extend, noop &#125; from 'shared/util'...// src/core/index.jsimport Vue from './instance/index'import &#123; initGlobalAPI &#125; from './global-api/index'...// src/core/instance/index.jsimport &#123; initMixin &#125; from './init'import &#123; stateMixin &#125; from './state'import &#123; renderMixin &#125; from './render'import &#123; eventsMixin &#125; from './events'import &#123; lifecycleMixin &#125; from './lifecycle'import &#123; warn &#125; from '../util/index'/* vue åœ¨æ­¤å¤„è¢«å®šä¹‰ */function Vue(options) &#123; if (process.env.NODE_ENV !== 'production' &amp;&amp; !(this instanceof Vue)) &#123; warn('Vue is a constructor and should be called with the `new` keyword') &#125; this._init(options)&#125;initMixin(Vue)stateMixin(Vue)eventsMixin(Vue)lifecycleMixin(Vue)renderMixin(Vue)export default Vue æ•°æ®é©±åŠ¨new Vueæ—¶å‘ç”Ÿäº†ä»€ä¹ˆåˆå§‹åŒ–åŸºæœ¬æ€è·¯ è°ƒç”¨new Vue(options) è°ƒç”¨é€šè¿‡initMixin(Vue)æ–¹æ³•å¯¼å…¥çš„_initæ–¹æ³• _initå†…éƒ¨è°ƒç”¨äº†ç›¸å…³æ–¹æ³•ï¼Œåšäº†ä¸€äº›åˆå§‹åŒ–æ“ä½œ åˆå§‹åŒ–æ—¶å¦‚ä½•ä»£ç†dataçš„? _initæ–¹æ³•å†…éƒ¨è°ƒç”¨initState(vm)æ–¹æ³• initState(vm)æ–¹æ³•ä¸­è°ƒç”¨äº†initData(vm)æ–¹æ³• initData(vm)æ–¹æ³•åˆ¤æ–­äº†vm.$options.dataçš„ç±»å‹(å‡½æ•°æˆ–å…¶å®ƒ)å¹¶æ ¹æ®dataç±»å‹ï¼Œå°†è·å–åˆ°çš„dataå€¼èµ‹å€¼ç»™vm._data éå†æ£€æŸ¥vm._dataä¸­æ˜¯å¦æœ‰å’Œpropsã€methodsé‡åçš„key(å› ä¸ºpropsã€methodsã€dataæœ€ç»ˆéƒ½è¦æŒ‚è½½åˆ°vmä¸Šï¼Œæ‰€ä»¥ä¸èƒ½é‡å)ï¼Œæœªé‡åæ—¶ï¼Œåˆ¤æ–­ä¸‹keyæ˜¯å¦æ˜¯vueçš„ä¿ç•™å­—(vueä¸­å°†ä»¥$å’Œ_å¼€å¤´çš„å­—æ®µè§†ä¸ºvueä¿ç•™å­—,è¿™ä¹Ÿæ˜¯å£°æ˜dataæ—¶ï¼Œdataä¸­çš„keyä¸èƒ½ä»¥$å’Œ_å¼€å¤´çš„åŸå› ) ä¸æ˜¯ä¿ç•™å­—ï¼Œåˆ™è°ƒç”¨proxy(vm,&#39;_data&#39;,key)æ–¹æ³•å°†vm.data[key]ä»£ç†åˆ°vm._data[key]ä¸Š(è¿™ä¹Ÿè¯´æ˜äº†ï¼Œvueä¸­dataç”³æ˜çš„æ•°æ®æœ¬è´¨ä¸Šä¿å­˜åœ¨vm._dataä¸Šçš„) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127// src/core/instance/index.jsimport &#123; initMixin &#125; from './init'import &#123; stateMixin &#125; from './state'import &#123; renderMixin &#125; from './render'import &#123; eventsMixin &#125; from './events'import &#123; lifecycleMixin &#125; from './lifecycle'import &#123; warn &#125; from '../util/index'// å®šä¹‰vueç±»function Vue(options) &#123; // éç”Ÿäº§ç¯å¢ƒå¿…é¡»é€šè¿‡new æ¥ç”Ÿæˆvue å®ä¾‹ if (process.env.NODE_ENV !== 'production' &amp;&amp; !(this instanceof Vue)) &#123; warn('Vue is a constructor and should be called with the `new` keyword') &#125; // åˆå§‹åŒ–ï¼Œå¹¶ä¼ å…¥å‚æ•° this._init(options) // æ­¤æ–¹æ³•åœ¨initMixinä¸­å®šä¹‰&#125;initMixin(Vue) // å¯¼å…¥_initæ–¹æ³•stateMixin(Vue)eventsMixin(Vue)lifecycleMixin(Vue)renderMixin(Vue)export default Vue// src/core/instance/init.js...export function initMixin(Vue: Class&lt;Component&gt;) &#123; // åœ¨VueåŸå‹ä¸Šå®šä¹‰_initæ–¹æ³• Vue.prototype._init = function(options?: Object) &#123; ... // expose real self vm._self = vm initLifecycle(vm) initEvents(vm) initRender(vm) callHook(vm, 'beforeCreate') initInjections(vm) // resolve injections before data/props initState(vm) // åˆå§‹åŒ–ç»„ä»¶è‡ªèº«çŠ¶æ€(dataä¸­å®šä¹‰çš„æ•°æ®) initProvide(vm) // resolve provide after data/props callHook(vm, 'created') ... &#125;&#125;// src/core/instance/state.js...const sharedPropertyDefinition = &#123; enumerable: true, configurable: true, get: noop, set: noop&#125;// å°†target[key]ä»£ç†åˆ°target[sourceKey][key]ä¸Šï¼Œä¸»è¦å®ç°å°†vm.data[key]ä»£ç†åˆ°vm._data[key]ä¸Šçš„æ“ä½œexport function proxy(target: Object, sourceKey: string, key: string) &#123; sharedPropertyDefinition.get = function proxyGetter() &#123; return this[sourceKey][key] &#125; sharedPropertyDefinition.set = function proxySetter(val) &#123; this[sourceKey][key] = val &#125; Object.defineProperty(target, key, sharedPropertyDefinition)&#125;export function initState(vm: Component) &#123; vm._watchers = [] const opts = vm.$options if (opts.props) initProps(vm, opts.props) if (opts.methods) initMethods(vm, opts.methods) if (opts.data) &#123; initData(vm) // åˆå§‹åŒ–data &#125; else &#123; observe((vm._data = &#123;&#125;), true /* asRootData */) &#125; if (opts.computed) initComputed(vm, opts.computed) if (opts.watch &amp;&amp; opts.watch !== nativeWatch) &#123; initWatch(vm, opts.watch) &#125;&#125;function initData(vm: Component) &#123; let data = vm.$options.data data = vm._data = typeof data === 'function' ? getData(data, vm) : data || &#123;&#125; // å°†$optionsä¸­çš„dataå–å‡ºå¹¶èµ‹å€¼ç»™vm._data if (!isPlainObject(data)) &#123; data = &#123;&#125; process.env.NODE_ENV !== 'production' &amp;&amp; warn( 'data functions should return an object:\n' + 'https://vuejs.org/v2/guide/components.html#data-Must-Be-a-Function', vm ) &#125; // proxy data on instance // éå†å¹¶æ£€æŸ¥_dataçš„keyæ˜¯å¦å’ŒmethodsåŠpropsé‡å const keys = Object.keys(data) const props = vm.$options.props const methods = vm.$options.methods let i = keys.length while (i--) &#123; const key = keys[i] if (process.env.NODE_ENV !== 'production') &#123; if (methods &amp;&amp; hasOwn(methods, key)) &#123; warn(`Method "$&#123;key&#125;" has already been defined as a data property.`, vm) &#125; &#125; if (props &amp;&amp; hasOwn(props, key)) &#123; process.env.NODE_ENV !== 'production' &amp;&amp; warn( `The data property "$&#123;key&#125;" is already declared as a prop. ` + `Use prop default value instead.`, vm ) &#125; else if (!isReserved(key)) &#123; // è‹¥keyä¸æ˜¯vueçš„ä¿ç•™å­—($åŠ_å¼€å¤´çš„é»˜è®¤éƒ½æ˜¯vueä¿ç•™å­—ï¼Œæ‰€ä»¥vueä¸­ç”³æ˜çŠ¶æ€æ—¶ï¼Œä¸èƒ½ä»¥$åŠ_å¼€å¤´) // ä»£ç†å°†vm[key]ä»£ç†åˆ°vm[_data][key]ä¸Š proxy(vm, `_data`, key) &#125; &#125; // observe data;è§‚æµ‹æ•°æ® observe(data, true /* asRootData */)&#125; Vueå®ä¾‹æŒ‚è½½çš„å®ç°åŸºæœ¬æ€è·¯ é€šè¿‡$mountæ–¹æ³•å®ç°å®ä¾‹æŒ‚è½½ ä¸åŒç‰ˆæœ¬çš„vueå®ç°çš„æŒ‚è½½æ–¹å¼ä¸åŒï¼Œä¸è¿‡éƒ½æ˜¯åœ¨runtimeç‰ˆæœ¬çš„å…¬å…±$mountåŸºç¡€ä¸Šï¼Œä¿®æ”¹ä»¥æ»¡è¶³ä¸åŒç‰ˆæœ¬çš„å®šåˆ¶åŒ–æŒ‚è½½éœ€æ±‚ æ— è®ºä»€ä¹ˆç‰ˆæœ¬ï¼Œvueæœ€ç»ˆéƒ½æ˜¯éœ€è¦ä¸€ä¸ªrenderå‡½æ•°ï¼Œè‹¥æ˜¯compilerç‰ˆæœ¬ï¼Œä¼šæ£€æŸ¥æ˜¯å¦æœ‰ç”¨æˆ·ç¼–å†™çš„renderï¼Œå¦åˆ™å°†templateç¼–è¯‘æˆrenderå‡½æ•°ä¾›åç»­æµç¨‹ä½¿ç”¨ å¸¦compilerç‰ˆæœ¬çš„$mountè°ƒç”¨é¡ºåº1.ç¼“å­˜å…¬å…±$mountæ–¹æ³•ï¼Œä¾›ä¿®æ”¹åçš„$mountæ–¹æ³•è°ƒç”¨2.ä¿®æ”¹åŸå‹ä¸Šçš„$mountæ–¹æ³•3.è‹¥æ²¡æœ‰æŒ‡å®šrenderå‡½æ•°ï¼Œåˆ™é€šè¿‡templateå­—æ®µè·å–æ¨¡æ¿ï¼Œå†è°ƒç”¨compileToFunctionsæ–¹æ³•ç”Ÿæˆä¸€ä¸ªrenderæ–¹æ³•ç»‘å®šåˆ°vm.$optionsä¸Š4.è°ƒç”¨å…¬å…±$mountæ–¹æ³•5.å…¬å…±$mountæ–¹æ³•å†…éƒ¨è°ƒç”¨äº†mountComponentæ–¹æ³•6.mountComponentæ–¹æ³•å†…éƒ¨é¦–å…ˆæ£€æŸ¥äº†vm.$options.renderå‡½æ•°çš„å­˜åœ¨æ€§ï¼Œä¸å­˜åœ¨ï¼Œåˆ™å°†åˆ›å»ºç©ºvnodeçš„createEmptyVNodeæ–¹æ³•èµ‹å€¼ç»™vm.$options.render7.åœ¨mountComponentæ–¹æ³•å†…éƒ¨å®šä¹‰äº†ä¸€ä¸ªupdateComponentæ–¹æ³•ï¼Œæ­¤æ–¹æ³•ä¸»è¦è°ƒç”¨äº†vm._updateæ–¹æ³•ï¼Œæ­¤æ–¹æ³•æ¥æ”¶ä¸€ä¸ªvm._renderè¿”å›çš„VNode8.mountComponentæ–¹æ³•å†…ç”Ÿæˆä¸€ä¸ªæ¸²æŸ“watcherå®ä¾‹,æ¸²æŸ“watcherå®ä¾‹å†…éƒ¨ä¼šè°ƒç”¨ä¼ å…¥çš„updateComponentæ–¹æ³•è¿›è¡ŒVueå®ä¾‹æŒ‚è½½ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183// src/platforms/web/entry-runtime-with-compiler.js...const mount = Vue.prototype.$mount // ç¼“å­˜äº†åŸå‹ä¸Šçš„$mountæ–¹æ³•ï¼Œç„¶ååŸºäºcompilerç‰ˆæœ¬åšäº†ç›¸åº”ä¿®æ”¹ï¼›åŸå§‹$mountæ–¹æ³•æ˜¯åœ¨./runtime/index.jsä¸­å®šä¹‰çš„Vue.prototype.$mount = function( el?: string | Element, hydrating?: boolean): Component &#123; el = el &amp;&amp; query(el) // queryè¿”å›ä¸€ä¸ªdomå…ƒç´  // el ä¸èƒ½æ˜¯bodyã€htmlå…ƒç´ (å› ä¸ºæŒ‚è½½ä¼šæ›¿æ¢å¯¹åº”å…ƒç´ ) /* istanbul ignore if */ if (el === document.body || el === document.documentElement) &#123; process.env.NODE_ENV !== 'production' &amp;&amp; warn( `Do not mount Vue to &lt;html&gt; or &lt;body&gt; - mount to normal elements instead.` ) return this &#125; const options = this.$options // resolve template/el and convert to render function if (!options.render) &#123; let template = options.template if (template) &#123; if (typeof template === 'string') &#123; if (template.charAt(0) === '#') &#123; // templateæ˜¯ä¸€ä¸ªidé€‰æ‹©å™¨ï¼Œåˆ™å–å…¶innerHTML template = idToTemplate(template) /* istanbul ignore if */ if (process.env.NODE_ENV !== 'production' &amp;&amp; !template) &#123; warn( `Template element not found or is empty: $&#123;options.template&#125;`, this ) &#125; &#125; &#125; else if (template.nodeType) &#123; // templateä¼ å…¥çš„æ˜¯ä¸€ä¸ªdomå¯¹è±¡,å–å…¶innerHTML template = template.innerHTML &#125; else &#123; if (process.env.NODE_ENV !== 'production') &#123; warn('invalid template option:' + template, this) &#125; return this &#125; &#125; else if (el) &#123; // æœªæŒ‡å®štemplateå­—æ®µï¼Œä½†elå­˜åœ¨ï¼Œåˆ™è·å–elçš„outerHTML(innerHTML+elæ ‡ç­¾è‡ªèº«) template = getOuterHTML(el) &#125; if (template) &#123; /* istanbul ignore if */ if (process.env.NODE_ENV !== 'production' &amp;&amp; config.performance &amp;&amp; mark) &#123; mark('compile') &#125; // ç¼–è¯‘ï¼Œç”Ÿæˆrenderå‡½æ•° const &#123; render, staticRenderFns &#125; = compileToFunctions( template, &#123; shouldDecodeNewlines, shouldDecodeNewlinesForHref, delimiters: options.delimiters, comments: options.comments &#125;, this ) // èµ‹å€¼åˆ°optionsä¸Š options.render = render options.staticRenderFns = staticRenderFns /* istanbul ignore if */ if (process.env.NODE_ENV !== 'production' &amp;&amp; config.performance &amp;&amp; mark) &#123; mark('compile end') measure(`vue $&#123;this._name&#125; compile`, 'compile', 'compile end') &#125; &#125; &#125; return mount.call(this, el, hydrating)// è°ƒç”¨ç¼“å­˜çš„å…¬å…±$mountæ–¹æ³•&#125;...// src/platforms/web/runtime/index.js...// é€‚ç”¨äºæ¯ä¸ªå¹³å°çš„å…¬å…±$mountæ–¹æ³•Vue.prototype.$mount = function( el?: string | Element, hydrating?: boolean): Component &#123; el = el &amp;&amp; inBrowser ? query(el) : undefined return mountComponent(this, el, hydrating)// è°ƒç”¨lifecycleä¸­çš„mountComponent&#125;...// src/core/instance/lifecycle.jsexport function mountComponent( vm: Component, el: ?Element, hydrating?: boolean): Component &#123; vm.$el = el // å°†elä¿å­˜åˆ°$elä¸Š if (!vm.$options.render) &#123; vm.$options.render = createEmptyVNode if (process.env.NODE_ENV !== 'production') &#123; /* istanbul ignore if */ if ( (vm.$options.template &amp;&amp; vm.$options.template.charAt(0) !== '#') || vm.$options.el || el ) &#123; // åœ¨ä½¿ç”¨runtime-onlyç‰ˆæœ¬æ—¶ï¼Œæ²¡æœ‰å†™renderå‡½æ•°ï¼Œè€Œæ˜¯ä½¿ç”¨äº†templateï¼Œæ­¤æ—¶ä¼šæŠ¥ä¸€ä¸ªè­¦å‘Š(ä½¿ç”¨å•æ–‡ä»¶æ—¶ï¼Œè™½ç„¶ä¹Ÿæœ‰templateæ¨¡å—ï¼Œä½†å…¶åœ¨vue-loaderæ—¶ï¼Œå°±å·²ç»å°†å…¶ç¼–è¯‘æˆrenderå‡½æ•°äº†) warn( 'You are using the runtime-only build of Vue where the template ' + 'compiler is not available. Either pre-compile the templates into ' + 'render functions, or use the compiler-included build.', vm ) &#125; else &#123; // æ—¢æ²¡å†™templateä¹Ÿæ²¡å†™renderå‡½æ•° warn( 'Failed to mount component: template or render function not defined.', vm ) &#125; &#125; &#125; callHook(vm, 'beforeMount') let updateComponent /* istanbul ignore if */ if (process.env.NODE_ENV !== 'production' &amp;&amp; config.performance &amp;&amp; mark) &#123; updateComponent = () =&gt; &#123; const name = vm._name const id = vm._uid const startTag = `vue-perf-start:$&#123;id&#125;` const endTag = `vue-perf-end:$&#123;id&#125;` mark(startTag) const vnode = vm._render() mark(endTag) measure(`vue $&#123;name&#125; render`, startTag, endTag) mark(startTag) vm._update(vnode, hydrating) mark(endTag) measure(`vue $&#123;name&#125; patch`, startTag, endTag) &#125; &#125; else &#123; // å®šä¹‰updateComponentå‡½æ•°ï¼Œå†…éƒ¨è°ƒç”¨vm._updateæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºvm._renderè¿”å›çš„ä¸€ä¸ªVnode updateComponent = () =&gt; &#123; vm._update(vm._render(), hydrating) &#125; &#125; // we set this to vm._watcher inside the watcher's constructor // since the watcher's initial patch may call $forceUpdate (e.g. inside child // component's mounted hook), which relies on vm._watcher being already defined // å®ä¾‹åŒ–ä¸€ä¸ªæ¸²æŸ“watcherï¼Œå…¶å°†ç«‹å³è°ƒç”¨ä¸€æ¬¡updateComponent new Watcher( vm, updateComponent, noop, &#123; before() &#123; if (vm._isMounted) &#123; callHook(vm, 'beforeUpdate') &#125; &#125; &#125;, true /* isRenderWatcher æ ‡è¯†æ­¤watcheræ˜¯ä¸€ä¸ªæ¸²æŸ“watcherï¼Œè§Watcherç±»*/ ) hydrating = false // manually mounted instance, call mounted on self // mounted is called for render-created child components in its inserted hook if (vm.$vnode == null) &#123; vm._isMounted = true callHook(vm, 'mounted') &#125; return vm&#125; vm._renderæ–¹æ³• updateComponentæ–¹æ³•ä¸­ä¸»è¦è°ƒç”¨äº†vm._updateæ–¹æ³•ï¼Œvm._updateæ–¹æ³•åˆ™æ¥æ”¶ä¸€ä¸ªvm._renderæ–¹æ³•è¿”å›çš„Vnode vm._renderæ–¹æ³•å®šä¹‰åœ¨src/instance/render.jsä¸­ vm._renderæ–¹æ³•ä¼šå–å‡ºvm.$options.renderæ–¹æ³•å¹¶æ‰§è¡Œã€‚ vm.$options.renderå°†åœ¨vm._renderProxyä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œå¹¶ä¼ å…¥ä¸€ä¸ªvm.$createElementæ–¹æ³•ï¼Œæœ€ç»ˆè¿”å›ä¸€ä¸ªvnode vm._renderProxyåœ¨src/core/instance/init.jsçš„initProxyæ–¹æ³•ä¸­å®šä¹‰ï¼Œå…¶ä¼šæ ¹æ®æµè§ˆå™¨æ˜¯å¦æ”¯æŒProxyæ¥è¿”å›ä¸€ä¸ªProxyå®ä¾‹è¿˜æ˜¯vmè‡ªèº«,å¼€å‘ç¯å¢ƒä¸­æ˜¯ä¸€ä¸ªProxyå®ä¾‹ï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­å°±æ˜¯vmè‡ªèº« vm.$createElementåœ¨initRenderæ–¹æ³•ä¸­è¢«å®šä¹‰ï¼ŒinitRenderæ–¹æ³•ä¼šæ ¹æ®renderå‡½æ•°æ¥æº(vueç¼–è¯‘æ¨¡æ¿è€Œæ¥è¿˜æ˜¯ç”¨æˆ·ç¼–å†™çš„)ä¸åŒç”Ÿæˆä¸åŒç‰ˆæœ¬çš„createElementç‰ˆæœ¬1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374// src/core/instance/lifecycle.jsexport function mountComponent( vm: Component, el: ?Element, hydrating?: boolean): Component &#123; ... let updateComponent /* istanbul ignore if */ if (process.env.NODE_ENV !== 'production' &amp;&amp; config.performance &amp;&amp; mark) &#123; ... &#125; else &#123; // å®šä¹‰updateComponentå‡½æ•°ï¼Œå†…éƒ¨è°ƒç”¨vm._updateæ–¹æ³•ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºvm._renderè¿”å›çš„ä¸€ä¸ªVnodeï¼›vm._renderæ–¹æ³•å®šä¹‰åœ¨src/instance/render.jsä¸­ updateComponent = () =&gt; &#123; vm._update(vm._render(), hydrating) &#125; &#125;&#125;// src/core/instance/render.js...// æ­¤æ–¹æ³•å°†åœ¨new Vueçš„è¿‡ç¨‹ä¸­è¢«æ‰§è¡Œï¼Œåœ¨vmä¸ŠæŒ‚è½½ä¸åŒç‰ˆæœ¬çš„createElementæ–¹æ³•export function initRender(vm: Component) &#123; ... // bind the createElement fn to this instance // so that we get proper render context inside it. // args order: tag, data, children, normalizationType, alwaysNormalize // internal version is used by render functions compiled from templates // æœ€åä¸€ä¸ªæ ‡å¿—é‡æ˜¯alwaysNormalizeï¼ˆæ˜¯å¦æ€»æ˜¯è§„èŒƒåŒ–ï¼‰,ä¸ºfalse æ ‡è¯†æ­¤æ–¹æ³•æ˜¯ç»™ç¼–è¯‘ç”Ÿæˆçš„renderå‡½æ•°ä½¿ç”¨ vm._c = (a, b, c, d) =&gt; createElement(vm, a, b, c, d, false) // normalization is always applied for the public version, used in // user-written render functions. // ä¸ºtrue æ ‡è¯†æ­¤æ–¹æ³•æ˜¯ç»™ç”¨æˆ·ç¼–å†™çš„renderå‡½æ•°ä½¿ç”¨ vm.$createElement = (a, b, c, d) =&gt; createElement(vm, a, b, c, d, true) ...&#125;export function renderMixin(Vue: Class&lt;Component&gt;) &#123; ... Vue.prototype._render = function(): VNode &#123; const vm: Component = this // ä»$optionsä¸­æ‹¿åˆ°ç”¨æˆ·ç¼–å†™çš„æˆ–è€…vueç”Ÿæˆçš„renderå‡½æ•° const &#123; render, _parentVnode &#125; = vm.$options ... // render self let vnode try &#123; // è°ƒç”¨renderæ–¹æ³•ï¼›vm._renderProxyåœ¨src/instance/init.jsä¸­å®šä¹‰ï¼›vm._renderProxyåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹å°±æ˜¯vmï¼Œå¼€å‘ç¯å¢ƒä¸‹æ˜¯ä¸€ä¸ªproxyå¯¹è±¡; vm.$createElementåœ¨initRenderæ–¹æ³•ä¸­è¢«å®šä¹‰ vnode = render.call(vm._renderProxy, vm.$createElement) &#125; catch (e) &#123; ... &#125; // return empty vnode in case the render function errored out // åˆ›å»ºçš„vnodeå¹¶ä¸æ˜¯VNodeå®ä¾‹ if (!(vnode instanceof VNode)) &#123; // vnodeä¸ºä¸€ä¸ªæ•°ç»„ï¼Œåˆ™è¡¨ç¤ºæˆ‘ä»¬æ¨¡æ¿æœ‰å¤šä¸ªæ ¹èŠ‚ç‚¹ if (process.env.NODE_ENV !== 'production' &amp;&amp; Array.isArray(vnode)) &#123; warn( 'Multiple root nodes returned from render function. Render function ' + 'should return a single root node.', vm ) &#125; // åˆ›å»ºä¸€ä¸ªç©ºvnode vnode = createEmptyVNode() &#125; // set parent vnode.parent = _parentVnode // è¿”å›ä¸€ä¸ªvnode return vnode &#125;&#125; VirtualDOMå‡ºç°åŸå›  ç°æœ‰DOMå› ä¸ºå†å²åŸå› ï¼Œç»“æ„å¾ˆå¤æ‚ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸ŠåŒ…å«äº†å¾ˆå¤šéå¿…è¦ä¿¡æ¯(å­—æ®µ)ï¼Œæ“ä½œèµ·æ¥æ€§èƒ½æ¶ˆè€—å¾ˆå¤§ã€‚ ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œäººä»¬æƒ³å‡ºåœ¨DOMå±‚ä¸Šå†æ·»åŠ ä¸€ä¸ªé€Ÿåº¦æ›´å¤šï¼Œæ€§èƒ½æ¶ˆè€—å°çš„å±‚ï¼Œéœ€è¦æ“ä½œDOMæ—¶ï¼Œå…ˆæ“ä½œæ–°å±‚ï¼Œæ–°å±‚åœ¨åˆé€‚çš„æ—¶æœºé€šè¿‡ä¸€ç³»åˆ—ç®—æ³•è®¡ç®—å‡ºæœ€å°æ›´æ–°èŒƒå›´ï¼Œå†å°†è¿™äº›æ›´æ–°åº”ç”¨åˆ°DOMå±‚ ç®€å•ç†è§£å°±åƒè®¡ç®—æœºè¯»å†™ç¡¬ç›˜ä¸Šçš„æ–‡ä»¶ä¸€æ ·ï¼Œå¦‚æœç›´æ¥åœ¨ç¡¬ç›˜ä¸Šè¯»å†™æ–‡ä»¶ï¼Œé€Ÿåº¦ä¼šå¾ˆæ…¢ã€‚äºæ˜¯äººä»¬åœ¨ç¡¬ç›˜å’Œç³»ç»Ÿä¹‹é—´åŠ äº†ä¸€å±‚(å†…å­˜)ï¼Œå†…å­˜é€Ÿåº¦å¿«ï¼Œç³»ç»Ÿå¯ä»¥å…ˆåœ¨å†…å­˜ä¸­å¯¹æ–‡ä»¶è¿›è¡Œä¸€ç³»åˆ—æ“ä½œï¼Œæœ€ååœ¨åˆé€‚çš„æ—¶æœºå†å°†æ–‡ä»¶é‡æ–°å†™å…¥ç¡¬ç›˜ã€‚è¿™æ ·å°±é¿å…äº†é¢‘ç¹çš„æ“ä½œç¡¬ç›˜äº†ã€‚ VirtualDOMåŸºæœ¬æ€è·¯ VirtualDOMåˆ©ç”¨ç»“æ„ç®€å•çš„åŸç”Ÿjså¯¹è±¡(VNode)å»æè¿°ä¸€ä¸ªDOMèŠ‚ç‚¹ï¼Œåªä¿ç•™äº†å¿…è¦çš„å­—æ®µï¼Œè¿™æ ·èŠ‚ç‚¹å°±å˜å¾—ç®€å•äº†ï¼Œæ“ä½œèµ·æ¥é€Ÿåº¦æ›´å¿« é€šè¿‡å…³è”ç›¸å…³çš„VNodeç»„æˆä¸€ä¸ªVNode tree é€šè¿‡ç›¸åº”æ¸²æŸ“æ–¹æ³•å°†VNode treeæ¸²æŸ“æˆçœŸæ­£çš„DOM tree éœ€è¦æ›´æ–°DOM treeæ—¶ï¼Œä¼šé€šè¿‡diffç®—æ³•æ¯”è¾ƒæ–°æ—§ä¸¤æ£µVNode treeï¼Œæ‰¾å‡ºå·®å¼‚ï¼Œå¾—å‡ºæœ€å°æ›´æ–°èŒƒå›´ï¼Œé€šè¿‡æ‰“è¡¥ä¸çš„æ–¹å¼(patch)å°†è¿™äº›å·®å¼‚æ›´æ–°çœŸæ­£çš„DOM treeä¸Š é€šè¿‡ä¸Šè¿°è¿‡ç¨‹ï¼Œä¸€æ¥ç®€åŒ–äº†èŠ‚ç‚¹å¤§å°ï¼Œæ“ä½œé€Ÿåº¦æå‡ã€‚äºŒæ¥ï¼Œé™ä½äº†å˜æ›´DOM treeçš„é¢‘ç‡ï¼Œæ€§èƒ½æ›´å¥½ã€‚ vueçš„VirtualDOMå®ç°å‚è€ƒäº†snabbdom VNodeå®šä¹‰ å®šä¹‰åœ¨src/core/vdom/vnode.jsä¸­ ä»…ä¿ç•™äº†ä¸€äº›å¿…è¦å±æ€§123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109/* @flow */export default class VNode &#123; tag: string | void // æ ‡ç­¾å data: VNodeData | void // VNodeæ•°æ® children: ?Array&lt;VNode&gt; // å­èŠ‚ç‚¹ text: string | void // æ–‡æœ¬ elm: Node | void ns: string | void context: Component | void // rendered in this component's scope key: string | number | void componentOptions: VNodeComponentOptions | void componentInstance: Component | void // component instance parent: VNode | void // component placeholder node // strictly internal raw: boolean // contains raw HTML? (server only) isStatic: boolean // hoisted static node isRootInsert: boolean // necessary for enter transition check isComment: boolean // empty comment placeholder? isCloned: boolean // is a cloned node? isOnce: boolean // is a v-once node? asyncFactory: Function | void // async component factory function asyncMeta: Object | void isAsyncPlaceholder: boolean ssrContext: Object | void fnContext: Component | void // real context vm for functional nodes fnOptions: ?ComponentOptions // for SSR caching fnScopeId: ?string // functional scope id support constructor( tag?: string, data?: VNodeData, children?: ?Array&lt;VNode&gt;, text?: string, elm?: Node, context?: Component, componentOptions?: VNodeComponentOptions, asyncFactory?: Function ) &#123; this.tag = tag this.data = data this.children = children this.text = text this.elm = elm this.ns = undefined this.context = context this.fnContext = undefined this.fnOptions = undefined this.fnScopeId = undefined this.key = data &amp;&amp; data.key this.componentOptions = componentOptions this.componentInstance = undefined this.parent = undefined this.raw = false this.isStatic = false this.isRootInsert = true this.isComment = false this.isCloned = false this.isOnce = false this.asyncFactory = asyncFactory this.asyncMeta = undefined this.isAsyncPlaceholder = false &#125; // DEPRECATED: alias for componentInstance for backwards compat. /* istanbul ignore next */ get child(): Component | void &#123; return this.componentInstance &#125;&#125;export const createEmptyVNode = (text: string = '') =&gt; &#123; const node = new VNode() node.text = text node.isComment = true return node&#125;export function createTextVNode(val: string | number) &#123; return new VNode(undefined, undefined, undefined, String(val))&#125;// optimized shallow clone// used for static nodes and slot nodes because they may be reused across// multiple renders, cloning them avoids errors when DOM manipulations rely// on their elm reference.export function cloneVNode(vnode: VNode): VNode &#123; const cloned = new VNode( vnode.tag, vnode.data, vnode.children, vnode.text, vnode.elm, vnode.context, vnode.componentOptions, vnode.asyncFactory ) cloned.ns = vnode.ns cloned.isStatic = vnode.isStatic cloned.key = vnode.key cloned.isComment = vnode.isComment cloned.fnContext = vnode.fnContext cloned.fnOptions = vnode.fnOptions cloned.fnScopeId = vnode.fnScopeId cloned.asyncMeta = vnode.asyncMeta cloned.isCloned = true return cloned&#125; VNodeçš„åˆ›å»º é€šè¿‡vm._renderæ–¹æ³•ç”Ÿæˆï¼Œå†…éƒ¨è°ƒç”¨vm.$createElement createElementå®šä¹‰ vm.$createElementåœ¨å†…éƒ¨è°ƒç”¨äº†createElementæ–¹æ³• createElementæ–¹æ³•å®šä¹‰åœ¨src/core/vdom/create-element.jsä¸­ createElementæ–¹æ³•å†…éƒ¨é‡è®¾äº†normalizationTypeå¹¶è°ƒç”¨äº†_createElementæ–¹æ³•]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[gitlab-ci]]></title>
    <url>%2F2018%2F11%2F19%2Fgitlab-ci%2F</url>
    <content type="text"><![CDATA[è®°å½•æ­å»º gitlab-ci æœåŠ¡ç›¸å…³æ¦‚å¿µï¼›é…ç½®å¤ªå¤šï¼Œå¾ˆå¤šä¸æ˜¯å¾ˆç†è§£ï¼Œä»…åšä¸ªè®°å½•ï¼Œæ–¹ä¾¿åæœŸæŸ¥é˜…ï¼› Gitlab-ciå‰ç½®æ¦‚å¿µ æŒç»­é›†æˆï¼ˆContinuous Integrationï¼‰ æŒç»­é›†æˆå¼ºè°ƒå¼€å‘äººå‘˜æäº¤äº†æ–°ä»£ç ä¹‹åï¼Œç«‹åˆ»è¿›è¡Œæ„å»ºã€ï¼ˆå•å…ƒï¼‰æµ‹è¯•ã€‚æ ¹æ®æµ‹è¯•ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥ç¡®å®šæ–°ä»£ç å’ŒåŸæœ‰ä»£ç èƒ½å¦æ­£ç¡®åœ°é›†æˆåœ¨ä¸€èµ· ä¸ªäººå¼€å‘ä»£ç -&gt;æ„å»ºã€å•å…ƒæµ‹è¯•-&gt;å‘åŸæœ‰ä»£ç ä¸Šé›†æˆ ä¸»è¦ç”¨æ¥å‘ç°ä¸ªäººå¼€å‘ä»£ç æ˜¯å¦èƒ½ä¸»ä½“ä»£ç ä¸Šé›†æˆ æŒç»­äº¤ä»˜ï¼ˆContinuous Deliveryï¼‰ æŒç»­äº¤ä»˜åœ¨æŒç»­é›†æˆçš„åŸºç¡€ä¸Šï¼Œå°†é›†æˆåçš„ä»£ç éƒ¨ç½²åˆ°æ›´è´´è¿‘çœŸå®è¿è¡Œç¯å¢ƒçš„ã€Œç±»ç”Ÿäº§ç¯å¢ƒã€ï¼ˆproduction-like environmentsï¼‰ä¸­ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å®Œæˆå•å…ƒæµ‹è¯•åï¼Œå¯ä»¥æŠŠä»£ç éƒ¨ç½²åˆ°è¿æ¥æ•°æ®åº“çš„ Staging ç¯å¢ƒä¸­æ›´å¤šçš„æµ‹è¯•ã€‚å¦‚æœä»£ç æ²¡æœ‰é—®é¢˜ï¼Œå¯ä»¥ç»§ç»­æ‰‹åŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ã€‚ ä¸»è¦ç”¨æ¥å°†æŒç»­é›†æˆåçš„æˆæœè¿›è¡Œæ›´åŠ æ‹ŸçœŸçš„æµ‹è¯• æŒç»­é›†æˆæˆæœ-&gt;æ‹ŸçœŸç¯å¢ƒæµ‹è¯•-&gt;æ‰‹åŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ æŒç»­éƒ¨ç½²ï¼ˆContinuous Deploymentï¼‰ æŒç»­éƒ¨ç½²åˆ™æ˜¯åœ¨æŒç»­äº¤ä»˜çš„åŸºç¡€ä¸Šï¼ŒæŠŠéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒçš„è¿‡ç¨‹è‡ªåŠ¨åŒ–ã€‚ å°†æ‰‹åŠ¨éƒ¨ç½²è¿‡ç¨‹è¿›è¡Œè‡ªåŠ¨åŒ– æ‰‹åŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ-&gt;è‡ªåŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ DevOps DevOps æ˜¯ä¸€ä¸ªæ¦‚å¿µï¼Œæ˜¯ Development å’Œ Operations çš„ç»„åˆ çªå‡ºé‡è§†è½¯ä»¶å¼€å‘äººå‘˜å’Œè¿ç»´äººå‘˜çš„æ²Ÿé€šåˆä½œï¼Œé€šè¿‡è‡ªåŠ¨åŒ–æµç¨‹æ¥ä½¿å¾—è½¯ä»¶æ„å»ºã€æµ‹è¯•ã€å‘å¸ƒæ›´åŠ å¿«æ·ã€é¢‘ç¹å’Œå¯é  å®ƒæ˜¯åŸºäº CI/CD çš„ä¸€ä¸ªå®Œæ•´çš„è½¯ä»¶å¼€å‘è‡ªåŠ¨åŒ–æµç¨‹ èµ·æ­¥ åŸºæœ¬æ­¥éª¤ ä»“åº“æ ¹ç›®å½•æ·»åŠ .gitlab-ci.ymlæ–‡ä»¶å¹¶é…ç½®ç›¸å…³å‚æ•° é…ç½®ç›¸å…³ job å…·ä½“é…ç½®åŠç›¸å…³æ¦‚å¿µå‚ç…§ä¸‹é¢ é…ç½®é¡¹ç›®å¯ç”¨Runner Runnerè´Ÿè´£ç›¸å…³ job çš„æ‰§è¡Œ GitLab å’Œ Runner ä¹‹é—´é€šè¿‡ API é€šä¿¡ï¼Œæ‰€ä»¥ Runnerâ€™s machine è¦èƒ½è¿æ¥åˆ° Gitlab æœåŠ¡ Runner å¯åˆ†ä¸ºä¸ºæŸä¸€ä¸ªé¡¹ç›®æœåŠ¡çš„å’Œä¸ºå¤šä¸ªé¡¹ç›®æœåŠ¡çš„ï¼Œåè€…ç§°ä¸ºShared Runner æ¯æ¬¡pushå°†è‡ªåŠ¨è§¦å‘ CI çš„å·¥ä½œæµ(pipeline) .gitlab-ci.ymlé…ç½® .gitlab-ci.ymlæ˜¯.ymlæ ¼å¼æ–‡ä»¶ï¼Œæ³¨æ„ç¼©è¿›ï¼Œå§‹ç»ˆç”¨ç©ºæ ¼ä»£æ›¿ tab .gitlab-ci.ymlä¸»è¦å®šä¹‰äº†ä¸€äº›åœ¨ä¸åŒ stage(é˜¶æ®µ) éœ€è¦æ‰§è¡Œçš„ jobs æ¯ä¸ª.gitlab-ci.ymlæ–‡ä»¶å¯ä»¥å®šä¹‰æ— æ•°ä¸ªjobï¼Œæ¯ä¸ªjobéƒ½å®šä¹‰åœ¨.ymlçš„é¡¶å±‚ æ¯ä¸ªjobè‡³å°‘ä¸€åŒ…å«ä¸€ä¸ªscriptå­—æ®µ æ¯ä¸ªjobçš„æ‰§è¡Œæ˜¯ç›¸äº’ç‹¬ç«‹ã€äº’ä¸å¹²æ‰°çš„ jobä¸èƒ½é‡åï¼Œä¸€äº› gitlab çš„å…³é”®å­—ä¸èƒ½ä½¿ç”¨ï¼Œå¦‚ imageã€servicesã€stagesã€typesã€before_scriptã€after_scriptã€variablesã€cache 1234567891011job1: script: - 'npm install'job2: script: - 'npm run test'# job1ã€job2ä¹‹é—´æ— ä»»ä½•å…³è”ï¼ŒäºŒè€…åœ¨æ‰§è¡Œæ—¶æ˜¯ç›¸äº’ç‹¬ç«‹çš„job3:job4:... æ¯ä¸ªjobå¯ä»¥æœ‰ä¸€äº›å‚æ•°æ¥å®šä¹‰ job çš„è¡Œä¸º Keyword Required Description script yes Defines a shell script which is executed by Runner(å®šä¹‰è¦æ‰§è¡Œçš„è„šæœ¬) extends no Defines a configuration entry that this job is going to inherit from (å®šä¹‰æ­¤jobå°†ç»§æ‰¿äºå“ªä¸ªjob) image no Use docker image, covered in Using Docker Images (dockeré•œåƒ) services no Use docker services, covered in Using Docker Images (dockeræœåŠ¡) stage no Defines a job stage (default: test)(å®šä¹‰jobæ‰€å±çš„pipelineé˜¶æ®µï¼Œé»˜è®¤æ˜¯testé˜¶æ®µ) type no Alias for stage (stageåˆ«å) variables no Define job variables on a job level(å®šä¹‰åœ¨å½“å‰jobæ‰§è¡Œæ—¶ç”Ÿæ•ˆçš„å˜é‡) only no Defines a list of git refs for which job is created(å®šä¹‰jobæ‰§è¡ŒèŒƒå›´åŠæ—¶æœº) except no Defines a list of git refs for which job is not created(å®šä¹‰jobæ‰§è¡ŒèŒƒå›´åŠæ—¶æœº) tags no Defines a list of tags which are used to select Runner(æ‹¥æœ‰åˆ¶å®šRunner tagçš„runneræ‰èƒ½æ‰§è¡Œæ­¤job) allow_failure no Allow job to fail. Failed job doesnâ€™t contribute to commit status(æ­¤jobæ˜¯å¦å…è®¸å¤±è´¥) when no Define when to run job. Can be on_success, on_failure, always or manual (å®šä¹‰jobä»€ä¹ˆæ—¶å€™èƒ½è¢«æ‰§è¡Œï¼Œå¯ä»¥æ˜¯on_success,on_failure,alwaysæˆ–è€…manual) dependencies no Define other jobs that a job depends on so that you can pass artifacts between them(å®šä¹‰äº†è¯¥jobä¾èµ–å“ªä¸€ä¸ªjobï¼Œå¦‚æœè®¾ç½®è¯¥é¡¹ï¼Œä½ å¯ä»¥é€šè¿‡artifactsè®¾ç½®) artifacts no Define list of job artifacts(å·¥ä»¶ã€‚ã€‚å°±æ˜¯åœ¨ä¾èµ–é¡¹ä¹‹é—´ä¼ é€’çš„ä¸œè¥¿) cache no Define list of files that should be cached between subsequent runs(å®šä¹‰éœ€è¦è¢«ç¼“å­˜çš„æ–‡ä»¶ã€æ–‡ä»¶å¤¹åˆ—è¡¨) before_script no Override a set of commands that are executed before job(åœ¨æ¯ä¸ªjobæ‰§è¡Œå‰å°†æ‰§è¡Œçš„script) after_script no Override a set of commands that are executed after job(åœ¨æ¯ä¸ªjobæ‰§è¡Œåæ‰§è¡Œçš„script) environment no Defines a name of environment to which deployment is done by this job(å®šä¹‰è®©jobå®Œæˆéƒ¨ç½²çš„ç¯å¢ƒåç§°) coverage no Define code coverage settings for a given job(å…è®¸ä½ è®¾ç½®ä»£ç è¦†ç›–ç‡è¾“å‡ºï¼Œå…¶å€¼ä»jobçš„è¾“å‡ºè·å–) retry no Define when and how many times a job can be auto-retried in case of a failure(å®šä¹‰jobå¤±è´¥åçš„è‡ªåŠ¨é‡è¯•æ¬¡æ•°) parallel no Defines how many instances of a job should be run in parallel(æœ€å¤§å¯å¹¶è¡Œæ‰§è¡Œçš„jobå®ä¾‹æ•°) extends å®šä¹‰jobç»§æ‰¿è¡Œä¸º ä½¿ç”¨includeèƒ½å¤Ÿå®ç°è·¨é…ç½®æ–‡ä»¶çš„jobç»§æ‰¿123456789101112131415161718192021222324# ä½¿ç”¨ymlçš„éšè—keyæ¥åˆ›å»ºéšè—jobï¼Œé€šè¿‡æ·»åŠ ç‚¹å·æ¥å®ç°ã€‚éšè—jobå°†ä¸ä¼šè¢«æ‰§è¡Œï¼Œä½†å¯ä»¥è¢«ç»§æ‰¿.tests: script: rake test stage: test only: refs: - branchesrspec: extends: .tests script: rake rspec only: variables: - $RSPEC# ç»§æ‰¿ç»“æœï¼Œåå®šä¹‰çš„å°†è¦†ç›–å…ˆå®šä¹‰çš„rspec: script: rake rspec stage: test only: refs: - branches variables: - $RSPEC before_scriptã€after_script before_scriptæ¯ä¸ªjobæ‰§è¡Œå‰å¿…é¡»æ‰§è¡Œçš„script before_scriptå’Œjobçš„scriptäº«æœ‰åŒä¸€æ‰§è¡Œç¯å¢ƒ(å¯è®¿é—®åˆ°jobä¸­çš„å˜é‡) after_scriptæ¯ä¸ªjobæ‰§è¡Œåå¿…é¡»æ‰§è¡Œçš„script after_scriptæ— æ³•è®¿é—®åˆ°jobä¸­çš„å˜é‡123456789101112# å…¨å±€before_script: - global before scriptjob: # å±€éƒ¨ï¼Œå°†è¦†ç›–å…¨å±€ before_script: - execute this instead of global before script script: - my command after_script: - execute this after my script stages å®šä¹‰jobæ‰€å±é˜¶æ®µ å¯åœ¨å…¨å±€ä¸­å…ˆå®šä¹‰æ‰€æœ‰é˜¶æ®µ(stage)12345678910111213141516171819202122232425stages: # é¢„å®šä¹‰éœ€è¦æŒ‰é¡ºåºæ‰§è¡Œçš„é˜¶æ®µ - build - test - deployjob 1: # job1å±äºbuildé˜¶æ®µ stage: build script: make build dependenciesjob 2: # job2ä¹Ÿå±äºbuildé˜¶æ®µ stage: build script: make build artifactsjob 3: # job3å±äºtesté˜¶æ®µ stage: test script: make testjob 4: # job4å±äºdeployé˜¶æ®µ stage: deploy script: make deploy script jobå”¯ä¸€å¿…å¡«å­—æ®µ æŒ‡å®šæ­¤jobéœ€è¦æ‰§è¡Œçš„è„šæœ¬ï¼Œå¯æ˜¯ä¸€ä¸ªä¹Ÿå¯æ˜¯å¤šä¸ª123456789job1: # æŒ‡å®šä¸€ä¸ªè„šæœ¬ script: "bundle exec rspec"job2: # æŒ‡å®šé¡ºåºæ‰§è¡Œçš„ä¸¤ä¸ªè„šæœ¬ script: - uname -a - bundle exec rspec onlyã€expect æŒ‡å®šæ­¤jobçš„æ‰§è¡ŒèŒƒå›´æˆ–æ—¶æœºï¼Œåœ¨å“ªä¸ªbranchæˆ–è€…tagä¸Šæ‰§è¡Œï¼Œåœ¨ä½•æ—¶è§¦å‘12345678job: # use regexp only: - /^issue-.*$/ # use special keyword except: - branches# åªä¼šåœ¨issue-çš„refä¸Šè§¦å‘æ­¤ä»»åŠ¡ï¼Œå¹¶æ´¾å‡ºäº†æ‰€æœ‰branche tags ç”¨æ¥æŒ‡å®šå¯ä»¥è¿è¡Œæ­¤jobçš„Runnerï¼Œæ¯ä¸ªRunneråœ¨åˆ›å»ºæ—¶å¯ä»¥æŒ‡å®šä¸€ä¸ªRunner&#39;s tag12345job: # æ‹¥æœ‰rubyã€postgresæ ‡ç­¾çš„runneræ‰èƒ½æ‰§è¡Œæ­¤job tags: - ruby - postgres allow_failure æ˜¯å¦å…è®¸æ­¤jobæ‰§è¡Œå¤±è´¥ æ­£å¸¸æƒ…å†µï¼Œå¦‚æœjobæ‰§è¡Œå¤±è´¥ï¼Œä¼šä¸­æ–­åç»­stageçš„jobæ‰§è¡Œ è‹¥ä¸ºtrueï¼Œå°†ä¸ä¸­æ–­åç»­stageçš„jobæ‰§è¡Œ when æ ‡è¯†å½“å‰jobï¼Œåœ¨stageä¸­æŸä¸€jobæ‰§è¡Œå¤±è´¥æˆ–æ‰€æœ‰jobæ‰§è¡ŒæˆåŠŸæ—¶æ‰æ‰§è¡Œ å…³é”®å­— on_success åœ¨å‰ä¸€stageä¸­æ‰€æœ‰jobéƒ½æ‰§è¡ŒæˆåŠŸåå†æ‰§è¡Œ on_failure åœ¨å‰ä¸€stageä¸­æœ‰ä¸€ä¸ªjobæ‰§è¡Œå¤±è´¥æ—¶ï¼Œå°±ç«‹å³æ‰§è¡Œ always æ— è®ºå‰ä¸€stageæˆåŠŸæˆ–å¤±è´¥éƒ½å°†æ‰§è¡Œæ­¤job manual æ‰‹åŠ¨æ‰§è¡Œ123456789101112131415161718192021222324252627282930313233343536stages: - build - cleanup_build - test - deploy - cleanupbuild_job: stage: build script: - make buildcleanup_build_job: stage: cleanup_build script: - cleanup build when failed when: on_failuretest_job: stage: test script: - make testdeploy_job: stage: deploy script: - make deploy when: manualcleanup_job: stage: cleanup script: - cleanup after jobs when: always# cleanup_build_jobå°†åªåœ¨buildé˜¶æ®µå¤±è´¥æ—¶æ‰§è¡Œ# cleanup_jobæ— è®ºå‰é¢é˜¶æ®µæ˜¯å¦æ‰§è¡ŒæˆåŠŸéƒ½å°†æ‰§è¡Œ environment æ˜¯ç”¨äºå®šä¹‰ä¸€ä¸ªjobéƒ¨ç½²åˆ°æŸä¸ªå…·åçš„ç¯å¢ƒ environment:on_stopã€environment:action on_stopæŒ‡å®šåœ¨ç¯å¢ƒå…³é—­æ—¶æ‰§è¡ŒæŸä¸ªjob actionå…³é”®å­—å’Œon_stopå…³é”®å­—ç›¸å…³ï¼Œå®šä¹‰åœ¨jobçš„environmentä¸­ï¼Œç”¨äºå“åº”å…³é—­ç¯å¢ƒçš„æ“ä½œ123456789101112131415review_app: stage: deploy script: make deploy-app environment: name: review on_stop: stop_review_appstop_review_app: stage: deploy script: make delete-app when: manual environment: name: review action: stop# æˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªreview_appå¹¶éƒ¨ç½²åˆ°reviewç¯å¢ƒï¼Œå¹¶ä¸”æˆ‘ä»¬åœ¨on_stopä¸‹åŒæ ·å®šä¹‰äº†ä¸€ä¸ªæ–°çš„jobåä¸ºstop_review_appã€‚ä¸€æ—¦review_appä½œä¸šæˆåŠŸå®Œæˆï¼Œciå°†å¯ä»¥åœ¨æ‰‹åŠ¨æ“ä½œçš„æ—¶å€™è§¦å‘stop_review_appçš„ä»»åŠ¡ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨whenæ¥è¾¾åˆ°æ‰‹åŠ¨è§¦å‘åœæ­¢review appçš„åŠŸèƒ½ artifacts artifacts è¢«ç”¨äºåœ¨jobä½œä¸šæˆåŠŸåå°†åˆ¶å®šåˆ—è¡¨é‡Œçš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹é™„åŠ åˆ°jobä¸Šï¼Œä¼ é€’ç»™ä¸‹ä¸€ä¸ªjobï¼Œå¦‚æœè¦åœ¨ä¸¤ä¸ªjobä¹‹é—´ä¼ é€’artifactsï¼Œä½ å¿…é¡»è®¾ç½®dependencies, ä¼ é€’æ–‡ä»¶/æ–‡ä»¶å¤¹ 1234artifacts: paths: - binaries/ - .config ä¼ é€’gitæ²¡æœ‰è¿½è¸ªçš„æ–‡ä»¶ 12artifacts: untracked: true åªä¸ºæ‰“tagsçš„è¡Œä¸ºåˆ›å»ºartifacts 1234567891011121314default-job: script: - mvn test -U except: - tagsrelease-job: script: - mvn package -U artifacts: paths: - target/*.war only: - tags åˆ›åˆ›å»ºä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå‘½åä¸ºâ€œjobå_åˆ†æ”¯åâ€å¹¶åŒ…å«ä¸ºè¢«gitè·Ÿè¸ªçš„æ–‡ä»¶ 1234job: artifacts: name: "$&#123;CI_JOB_NAME&#125;_$&#123;CI_COMMIT_REF_NAME&#125;" untracked: true å½“å¤±è´¥æ—¶ä¸Šä¼ artifacts 123job: artifacts: when: on_failure -è®¾ç½®artifactsä¸€æ˜ŸæœŸè¿‡æœŸï¼Œé»˜è®¤artifactsä¼šæ°¸è¿œä¿å­˜åœ¨gitlabä¸­ 123job: artifacts: expire_in: 1 week cache å®šä¹‰åœ¨ä¸åŒjobé—´éœ€è¦ç¼“å­˜çš„æ–‡ä»¶ã€æ–‡ä»¶å¤¹(å¹¶ä¸æ˜ç™½ä»–å’Œartifactsçš„åŒºåˆ«) dependencies dependencieséœ€è¦ç»“åˆartifactsä½¿ç”¨ï¼Œåªæœ‰å®šä¹‰äº†ä¾èµ–å…³ç³»çš„jobæ‰å¯ä»¥ä¼ é€’artifacts(æ€€ç–‘ä¸­?) coverage coverage å…è®¸ä½ è®¾ç½®ä»£ç è¦†ç›–ç‡è¾“å‡ºï¼Œå…¶å€¼ä»jobçš„è¾“å‡ºè·å–123job1: script: rspec coverage: '/Code coverage: \d+\.\d+/' parallel æœ€å¤§å¯å¹¶è¡Œæ‰§è¡Œçš„jobå®ä¾‹æ•°123test: script: rspec parallel: 5 include å¯¼å…¥å…¶ä»–é…ç½®æ–‡ä»¶12345include: 'https://gitlab.com/awesome-project/raw/master/.before-script-template.yml'rspec: script: - bundle exec rspec variables å®šä¹‰å˜é‡1234567# å…¨å±€å˜é‡variables: DATABASE_URL: "postgres://postgres@postgres/my_database"job_name: # å±€éƒ¨å˜é‡ variables: &#123;&#125; Git Strategy ä½ å¯ä»¥é€šè¿‡åœ¨å…¨å±€å˜é‡è®¾ç½®ä½ç½®æˆ–è€…jobå±€éƒ¨å˜é‡è®¾ç½®ä½ç½®æ¥è®¾ç½®GIT_STRATEGYç”¨ä»¥è·å–åº”ç”¨æœ€è¿‘æ›´æ–°çš„ä»£ç ã€‚1234567891011# cloneæ˜¯æœ€æ…¢çš„é€‰é¡¹ï¼Œå¦‚æœè®¾ç½®è¯¥å€¼ï¼Œæ¯ä¸ªjobå°†ä¼šéƒ½å…‹éš†ä¸€éä»“åº“ï¼Œç¡®ä¿é¡¹ç›®å·¥ä½œç©ºé—´æ€»æ˜¯åŸå§‹çš„æ­£ç¡®çš„ã€‚variables: GIT_STRATEGY: clone# fetchæ˜¯æ›´å¿«çš„æ“ä½œé€‰é¡¹ï¼Œå› ä¸ºä»–é‡ç”¨äº†é¡¹ç›®çš„å·¥ä½œç©ºé—´ï¼ˆå¦‚æœæ²¡æœ‰çš„è¯ï¼Œä¼šå»cloneï¼‰, git cleanç”¨äºæ’¤é”€ä¸Šä¸€ä¸ªjobçš„ä»»ä½•æ“ä½œï¼Œgit fetchæ˜¯ç”¨æ¥é‡æ–°è·å–ä¸Šä¸€ä¸ªjobè¿è¡Œåˆ°å½“å‰jobäº§ç”Ÿçš„commitvariables: GIT_STRATEGY: fetch# noneä¹ŸåŒæ ·é‡ç”¨äº†é¡¹ç›®ç©ºé—´ï¼ˆä½†æ˜¯ä»–ä¼šè·³è¿‡æ‰€æœ‰gitæ“ä½œï¼ŒåŒ…æ‹¬å¦‚æœå­˜åœ¨çš„gitlab runnerçš„é¢„å…‹éš†è„šæœ¬ï¼‰ã€‚å…¶ä¸»è¦ç”¨äºåªæ˜¯ä¸ºäº†æ“ä½œartifactsçš„jobä¸Šï¼ˆä¾‹å¦‚depolyéƒ¨ç½²è¡Œä¸ºï¼‰ã€‚æ­¤æ—¶Gitä»“åº“çš„æ•°æ®å¯èƒ½æ˜¯å­˜åœ¨çš„ï¼Œä½†å®ƒä¸€å®šä¸æ˜¯æœ€æ–°çš„ã€‚æ‰€ä»¥åœ¨è®¾ç½®äº†noneçš„jobé‡Œä½ åº”è¯¥ä¾èµ–ä»cacheæˆ–è€…artifactsæ¥çš„æ•°æ®ï¼Œè€Œä¸æ˜¯ä»“åº“æ•°æ®ã€‚variables: GIT_STRATEGY: none Git checkout ç”¨æ¥æŒ‡å®šjobæ‰§è¡Œæ—¶æ˜¯å¦éœ€è¦æ‰§è¡Œgit checkoutå‘½ä»¤1234567variables: GIT_STRATEGY: clone # å…¨å±€å®šä¹‰ï¼Œæ‰§è¡Œjobæ—¶æ— éœ€checkout GIT_CHECKOUT: "false"script: - git checkout master - git merge $CI_BUILD_REF_NAME Shallow cloning ä½ å¯ä»¥é€šè¿‡GIT_DEPTHæ¥è®¾ç½®æŠ“å–æˆ–è€…å…‹éš†æ·±åº¦ã€‚è¿™å°†ä½¿å¾—ä»“åº“è¿›è¡Œæµ…å…‹éš†ï¼Œ å¦‚æœä½ çš„ä»“åº“æœ‰ç‰¹åˆ«å¤§é‡çš„commitsæˆ–è€…ä»“åº“å¥½ä¹…æ²¡æ›´æ–°äº†ï¼Œè¯¥è®¾ç½®å°†æ˜¾è‘—çš„æé«˜å…‹éš†é€Ÿåº¦ã€‚è¯¥å‚æ•°ä¼šå‘é€ç»™git fetchå’Œgit cloneæ“ä½œ(å…¶å®å°±ç›¸å½“äºgit fetch â€“depth=xxx, git clone â€“depth=xxxã€‚ä½†æ˜¯ç”±äºgit fetchå’Œgit cloneæ˜¯runneråœ¨æ‰§è¡Œjobæ—¶å¸®ä½ åšçš„ï¼Œæ‰€ä»¥éœ€è¦æ­¤é…ç½®ã€‚)1234# æŠ“å–æˆ–è€…å…‹éš†æœ€æ–°ä¸‰æ¡commits:variables: GIT_DEPTH: "3" éšè—job jobåå‰æ·»åŠ ç‚¹å·å³å¯ï¼Œæ­¤jobä¸è¢«æ‰§è¡Œï¼Œä½†å¯ä»¥è¢«ç»§æ‰¿123.hidden_job: script: - run test Anchors ç±»ä¼¼æ··å…¥æ¦‚å¿µ 1234567891011121314151617181920212223242526272829303132333435363738.job_template: &amp;job_definition # Hidden key that defines an anchor named 'job_definition' image: ruby:2.1 services: - postgres - redistest1: &lt;&lt;: *job_definition # Merge the contents of the 'job_definition' alias script: - test1 projecttest2: &lt;&lt;: *job_definition # Merge the contents of the 'job_definition' alias script: - test2 project# ç»“æœ.job_template: image: ruby:2.1 services: - postgres - redistest1: image: ruby:2.1 services: - postgres - redis script: - test1 projecttest2: image: ruby:2.1 services: - postgres - redis script: - test2 project è·³è¿‡job å¦‚æœä½ çš„commitä¿¡æ¯åŒ…æ¶µ[ci skip]æˆ–è€…[skip ci]ï¼Œæ­¤æ¬¡æäº¤å°†ä¸è¢«jobæ‰§è¡Œ æ€»ç»“ script å®šä¹‰å…·ä½“è„šæœ¬ job æ¯ä¸ªjobå¯ä»¥æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªscript å¤šä¸ªscriptæŒ‰å®šä¹‰æ—¶é¡ºåºå…ˆåæ‰§è¡Œ stage æ¯ä¸ªé˜¶æ®µç”±ä¸åŒjobç»„æˆ æ¯ä¸ªjobå¹¶è¡Œæ‰§è¡Œäº’ä¸å¹²æ‰° åªæœ‰å½“å‰stageæ‰€æœ‰jobéƒ½æ‰§è¡ŒæˆåŠŸï¼Œæ‰èƒ½è¿›å…¥ä¸‹ä¸€é˜¶æ®µã€‚ä¸€ä¸ªjobæ‰§è¡Œå¤±è´¥ï¼Œæ ‡è¯†æ­¤é˜¶æ®µfail pipeline ç”±å¤šä¸ªé˜¶æ®µç»„æˆ(build-&gt;test-&gt;deploy) Runnerè´Ÿè´£ç®¡ç†è°ƒé…æ‰§è¡Œä¸Šè¿°è¿‡ç¨‹ å‚è€ƒ https://segmentfault.com/a/1190000011881435https://segmentfault.com/a/1190000011890710#articleHeader31]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>git</tag>
        <tag>gitlab</tag>
        <tag>gitlab-ci</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vuex-guide]]></title>
    <url>%2F2018%2F11%2F07%2Fvuex-guide%2F</url>
    <content type="text"><![CDATA[é‡è¯»äº†ä¸€é vuex æ–‡æ¡£ï¼Œç”¨è‡ªå·±çš„è¯­è¨€è®°å½•äº†ä¸€éƒ¨åˆ†ä¸œè¥¿ï¼Œæ–¹ä¾¿è‡ªå·±åæœŸæŸ¥æ‰¾ Vuexå®‰è£… Vuex ä¾èµ– Promiseã€‚å¦‚æœä½ æ”¯æŒçš„æµè§ˆå™¨å¹¶æ²¡æœ‰å®ç° Promise (æ¯”å¦‚ IE)ï¼Œé‚£ä¹ˆä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ª polyfill çš„åº“ï¼Œä¾‹å¦‚ es6-promise ä»€ä¹ˆæƒ…å†µéœ€è¦ Vuex ç›¸äº’åµŒå¥—çš„ç»„ä»¶å¤šï¼Œéœ€è¦ç›¸äº’å…±äº«ã€ä¼ é€’æ•°æ®æ—¶ã€‚ ç®€å•æ–¹æ¡ˆ:EventBusã€provide/injectã€inheritAttrs/$attrs/$listeners æˆ–è€…æ‰‹åŠ¨å®ç°ä¸€ä¸ªè®¢é˜…è€…æ¨¡å¼ æ¦‚å¿µ æ¯ä¸€ä¸ª Vuex åº”ç”¨çš„æ ¸å¿ƒå°±æ˜¯ storeï¼ˆä»“åº“ï¼‰ã€‚â€œstoreâ€åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå®ƒåŒ…å«ç€ä½ çš„åº”ç”¨ä¸­å¤§éƒ¨åˆ†çš„çŠ¶æ€ (state)ã€‚ Vuex çš„çŠ¶æ€å­˜å‚¨æ˜¯å“åº”å¼çš„ã€‚å½“ç»„ä»¶ä» store ä¸­è·å–çŠ¶æ€åï¼ŒåæœŸåªè¦çŠ¶æ€å˜æ›´äº†ï¼Œç»„ä»¶å°±ä¼šè‡ªåŠ¨æ›´æ–° DOM ä½ ä¸èƒ½ç›´æ¥æ”¹å˜ store ä¸­çš„çŠ¶æ€ã€‚æ”¹å˜ store ä¸­çš„çŠ¶æ€çš„å”¯ä¸€é€”å¾„å°±æ˜¯æ˜¾å¼åœ°æäº¤ (commit) mutationã€‚ State Vuex å•ä¸€çŠ¶æ€æ ‘ ä¸€ä¸ªå¯¹è±¡åŒ…å«äº†å…¨éƒ¨çš„åº”ç”¨çŠ¶æ€ å•ä¾‹æ¨¡å¼ï¼šæ¯ä¸ªåº”ç”¨å°†ä»…ä»…åŒ…å«ä¸€ä¸ª store å®ä¾‹ åœ¨ Vue ç»„ä»¶ä¸­è·å¾— Vuex çŠ¶æ€ åœ¨è®¡ç®—å±æ€§ä¸­è¿”å›æŸä¸ªçŠ¶æ€ 12345678910111213141516171819202122// app.vueconst app = new Vue(&#123; el: '#app', // æŠŠ store å¯¹è±¡æä¾›ç»™ â€œstoreâ€ é€‰é¡¹ï¼Œè¿™å¯ä»¥æŠŠ store çš„å®ä¾‹æ³¨å…¥æ‰€æœ‰çš„å­ç»„ä»¶ store, components: &#123; Counter &#125;, template: ` &lt;div class="app"&gt; &lt;counter&gt;&lt;/counter&gt; &lt;/div&gt; `&#125;)// counter.vueconst Counter = &#123; template: `&lt;div&gt;&#123;&#123; count &#125;&#125;&lt;/div&gt;`, computed: &#123; count() &#123; return this.$store.state.count &#125; &#125;&#125; å®é™…ç”Ÿäº§ä¸­ï¼Œä¸€èˆ¬ä¸ç›´æ¥è·å– Stateï¼Œè€Œæ˜¯é€šè¿‡ Getter é—´æ¥è·å– State mapState ä½¿ç”¨ mapState è¾…åŠ©å‡½æ•°å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆè®¡ç®—å±æ€§ï¼ˆå°†çŠ¶æ€æ˜ å°„æˆè®¡ç®—å±æ€§ï¼‰ mapState è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡ä¸­åŒ…å«äº†è·å–å¯¹åº”çŠ¶æ€çš„æ–¹æ³•å®šä¹‰ï¼Œæ‰€ä»¥åˆé€‚ç”¨ computed æ¥æ”¶ 123456789101112131415161718192021222324252627282930313233// åœ¨å•ç‹¬æ„å»ºçš„ç‰ˆæœ¬ä¸­è¾…åŠ©å‡½æ•°ä¸º Vuex.mapStateimport &#123; mapState &#125; from 'vuex'export default &#123; // ... computed: mapState(&#123; // ç®­å¤´å‡½æ•°å¯ä½¿ä»£ç æ›´ç®€ç»ƒ count: state =&gt; state.count, // ä¼ å­—ç¬¦ä¸²å‚æ•° 'count' ç­‰åŒäº `state =&gt; state.count` countAlias: 'count', // ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨ `this` è·å–å±€éƒ¨çŠ¶æ€ï¼Œå¿…é¡»ä½¿ç”¨å¸¸è§„å‡½æ•° countPlusLocalState(state) &#123; return state.count + this.localCount &#125; &#125;)&#125;// å½“æ˜ å°„çš„è®¡ç®—å±æ€§çš„åç§°ä¸ state çš„å­èŠ‚ç‚¹åç§°ç›¸åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç»™ mapState ä¼ ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ã€‚computed: mapState([ // æ˜ å°„ this.count ä¸º store.state.count 'count'])// åˆå¹¶ç°æœ‰computedï¼Œä½¿ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦computed: &#123; localComputed () &#123; /* ... */ &#125;, // ä½¿ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦å°†æ­¤å¯¹è±¡æ··å…¥åˆ°å¤–éƒ¨å¯¹è±¡ä¸­ ...mapState(&#123; // ... &#125;)&#125; Getter æ´¾ç”ŸçŠ¶æ€ åŸºäºåŸå§‹çŠ¶æ€ï¼Œæ´¾ç”Ÿå‡ºä¸€äº›æ–°çŠ¶æ€(ç±»ä¼¼è®¡ç®—å±æ€§) 12345678910111213const store = new Vuex.Store(&#123; state: &#123; todos: [ &#123; id: 1, text: '...', done: true &#125;, &#123; id: 2, text: '...', done: false &#125; ] &#125;, getters: &#123; doneTodos: state =&gt; &#123; return state.todos.filter(todo =&gt; todo.done) &#125; &#125;&#125;) æ¯ä¸ª getter åœ¨è°ƒç”¨æ—¶ä¼šè¢«ä¼ å…¥ state å’Œ getters state åŒ…å«äº†å½“å‰æ‰€æœ‰åŸå§‹çŠ¶æ€ï¼Œç­‰ä»· store.state getters åŒ…å«äº†å½“å‰æ‰€æœ‰ gettersï¼Œç­‰ä»· store.getters ä¼ å‚ç»™ Getter è®© getter è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œæ¥å®ç°ç»™ getter ä¼ å‚12345678getters: &#123; // ... getTodoById: state =&gt; id =&gt; &#123; return state.todos.find(todo =&gt; todo.id === id) &#125;&#125;store.getters.getTodoById(2) // -&gt; &#123; id: 2, text: '...', done: false &#125;// æ³¨æ„ï¼Œgetter åœ¨é€šè¿‡æ–¹æ³•è®¿é—®æ—¶ï¼Œæ¯æ¬¡éƒ½ä¼šå»è¿›è¡Œè°ƒç”¨ï¼Œè€Œä¸ä¼šç¼“å­˜ç»“æœ mapGetters è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«è·å– Getter çš„æ–¹æ³•å®šä¹‰ï¼Œæ‰€ä»¥åˆé€‚ç”¨ computed æ¥æ”¶ 12345678910111213141516171819import &#123; mapGetters &#125; from 'vuex'export default &#123; // ... computed: &#123; // ä½¿ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦å°† getter æ··å…¥ computed å¯¹è±¡ä¸­ ...mapGetters([ 'doneTodosCount', 'anotherGetter' // ... ]) &#125;&#125;// å¦‚æœä½ æƒ³å°†ä¸€ä¸ª getter å±æ€§å¦å–ä¸€ä¸ªåå­—ï¼Œä½¿ç”¨å¯¹è±¡å½¢å¼ï¼šmapGetters(&#123; // æŠŠ `this.doneCount` æ˜ å°„ä¸º `this.$store.getters.doneTodosCount` doneCount: 'doneTodosCount'&#125;) Mutation æ›´æ”¹ Vuex çš„ store ä¸­çš„çŠ¶æ€çš„å”¯ä¸€æ–¹æ³•æ˜¯æäº¤ mutationã€‚ æ¯ä¸ª mutation éƒ½åƒä¸€ä¸ªäº‹ä»¶å¤„ç†å™¨ æœ‰ä¸€ä¸ªäº‹ä»¶ç±»å‹ type å’Œä¸€ä¸ªå›è°ƒå‡½æ•° handler 123456789101112131415161718const store = new Vuex.Store(&#123; state: &#123; count: 1 &#125;, // å£°æ˜æœ‰å“ªäº›mutation mutations: &#123; // è¿™é‡Œçš„å‡½æ•°åincrementç›¸å½“äºäº‹ä»¶ä¸­çš„äº‹ä»¶ç±»å‹type increment(state) &#123; // å‡½æ•°ä½“ç›¸å½“äºäº‹ä»¶ä¸­çš„å›è°ƒhandler // å˜æ›´çŠ¶æ€ state.count++ &#125; &#125;&#125;)// æäº¤mutation// ç›¸å½“äºè§¦å‘æŸä¸€äº‹ä»¶ç±»å‹ï¼ˆincrementï¼‰ï¼Œå°†ä¼šè‡ªåŠ¨è°ƒç”¨å¯¹åº”çš„å›è°ƒhandlerstore.commit('increment') æ¯ä¸ª mutation åœ¨è°ƒç”¨æ—¶ä¼šè¢«ä¼ å…¥ state å’Œ payload state åŒ…å«äº†å½“å‰æ‰€æœ‰åŸå§‹çŠ¶æ€ï¼Œç­‰ä»· store.state payload ä¸ºé¢å¤–å‚æ•° æäº¤è½½è·(Payload) å¯ç†è§£ä¸ºæäº¤ mutation æ—¶çš„é¢å¤–å‚æ•° 1234567891011121314151617181920212223242526272829// ä¾‹å­1ï¼Œæ™®é€šPayloadmutations: &#123; increment (state, n) &#123; state.count += n &#125;&#125;store.commit('increment', 10)// ä¾‹å­2ï¼Œå¯¹è±¡Payloadmutations: &#123; increment (state, payload) &#123; state.count += payload.amount &#125;&#125;store.commit('increment', &#123; amount: 10&#125;)// ä¾‹å­3ï¼Œå¯¹è±¡é£æ ¼çš„æäº¤æ–¹å¼mutations: &#123; increment (state, payload) &#123; state.count += payload.amount &#125;&#125;store.commit(&#123; type: 'increment', amount: 10&#125;) mapMutations mapMutationsï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å« mutation å®šä¹‰ï¼Œè€Œ mutation æ›´åƒä¸€ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥ä½¿ç”¨ methods æ¥æ”¶åˆé€‚ã€‚ 12345678910111213141516import &#123; mapMutations &#125; from 'vuex'export default &#123; // ... methods: &#123; ...mapMutations([ 'increment', // å°† `this.increment()` æ˜ å°„ä¸º `this.$store.commit('increment')` // `mapMutations` ä¹Ÿæ”¯æŒè½½è·ï¼š 'incrementBy' // å°† `this.incrementBy(amount)` æ˜ å°„ä¸º `this.$store.commit('incrementBy', amount)` ]), ...mapMutations(&#123; add: 'increment' // å°† `this.add()` æ˜ å°„ä¸º `this.$store.commit('increment')` &#125;) &#125;&#125; Mutation éœ€éµå®ˆ Vue çš„å“åº”è§„åˆ™ æœ€å¥½æå‰åœ¨ä½ çš„ store ä¸­åˆå§‹åŒ–å¥½æ‰€æœ‰æ‰€éœ€å±æ€§ã€‚ å½“éœ€è¦åœ¨å¯¹è±¡ä¸Šæ·»åŠ æ–°å±æ€§æ—¶ï¼Œä½ åº”è¯¥ ä½¿ç”¨ Vue.set(obj, â€˜newPropâ€™, 123), æˆ–è€… ä»¥æ–°å¯¹è±¡æ›¿æ¢è€å¯¹è±¡ï¼ˆæ‰©å±•è¿ç®—ç¬¦ï¼‰ ä½¿ç”¨å¸¸é‡æ›¿ä»£ Mutation äº‹ä»¶ç±»å‹ å•ç‹¬åˆ›å»ºä¸€ä¸ª mutation-types.js ä¿å­˜æ•´ä¸ª APP çš„ mutation ç±»å‹ æ–¹ä¾¿ eslintï¼Œæ–¹ä¾¿ä»–äººæŸ¥çœ‹ 123456789101112131415// mutation-types.jsexport const SOME_MUTATION = 'SOME_MUTATION'// store.jsimport Vuex from 'vuex'import &#123; SOME_MUTATION &#125; from './mutation-types'const store = new Vuex.Store(&#123; state: &#123; ... &#125;, mutations: &#123; // æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ES2015 é£æ ¼çš„è®¡ç®—å±æ€§å‘½ååŠŸèƒ½æ¥ä½¿ç”¨ä¸€ä¸ªå¸¸é‡ä½œä¸ºå‡½æ•°å [SOME_MUTATION] (state) &#123; // mutate state &#125; &#125;&#125;) mutation å¿…é¡»æ˜¯åŒæ­¥å‡½æ•° è°ƒè¯•å·¥å…·æ— æ³•å‡†ç¡®æ•æ‰åˆ°æ¯æ¬¡è®°å½•ï¼Œéš¾ä»¥è°ƒè¯• å¼‚æ­¥æ“ä½œå¯ä»¥ä½¿ç”¨ action å®Œæˆ Action Action ç±»ä¼¼äº mutationï¼Œä¸åŒåœ¨äºï¼š Action é€šè¿‡æäº¤ mutation æ¥å˜æ›´çŠ¶æ€ï¼Œè€Œä¸æ˜¯ç›´æ¥å˜æ›´çŠ¶æ€ã€‚æ‰€ä»¥ vuex ä¸­å”¯ä¸€èƒ½æ”¹å˜çŠ¶æ€çš„æ–¹æ³•å°±æ˜¯æäº¤ mutation Action å¯ä»¥åŒ…å«ä»»æ„å¼‚æ­¥æ“ä½œã€‚ æ¯ä¸ª action åœ¨è¢«è°ƒç”¨æ—¶ï¼Œä¼šè¢«ä¼ å…¥ä¸€ä¸ª context å¯¹è±¡å’Œ payload context ä¸ºä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å±æ€§ï¼Œå¯åˆ©ç”¨è§£æ„æå– state, // ç­‰åŒäº store.stateï¼Œè‹¥åœ¨æ¨¡å—ä¸­åˆ™ä¸ºå±€éƒ¨çŠ¶æ€ rootState, // ç­‰åŒäº store.stateï¼Œåªå­˜åœ¨äºæ¨¡å—ä¸­ commit, // ç­‰åŒäº store.commit dispatch, // ç­‰åŒäº store.dispatch getters, // ç­‰åŒäº store.getters rootGetters // ç­‰åŒäº store.gettersï¼Œåªå­˜åœ¨äºæ¨¡å—ä¸­ payload ä¸ºé¢å¤–å‚æ•° Action å®šä¹‰åŠæ´¾å‘ 123456789101112131415161718192021222324252627282930const store = new Vuex.Store(&#123; state: &#123; count: 0 &#125;, mutations: &#123; increment(state) &#123; state.count++ &#125; &#125;, actions: &#123; incrementAsync(&#123; commit &#125;) &#123; setTimeout(() =&gt; &#123; commit('increment') &#125;, 1000) &#125; &#125;&#125;)store.dispatch('incrementAsync')// ä»¥è½½è·å½¢å¼åˆ†å‘store.dispatch('incrementAsync', &#123; amount: 10&#125;)// ä»¥å¯¹è±¡å½¢å¼åˆ†å‘store.dispatch(&#123; type: 'incrementAsync', amount: 10&#125;) mapActions è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å« action å®šä¹‰ï¼Œè€Œ action æ›´åƒä¸€ä¸ªæ–¹æ³•ï¼Œæ‰€ä»¥ä½¿ç”¨ methods æ¥æ”¶åˆé€‚ã€‚ 12345678910111213141516import &#123; mapActions &#125; from 'vuex'export default &#123; // ... methods: &#123; ...mapActions([ 'increment', // å°† `this.increment()` æ˜ å°„ä¸º `this.$store.dispatch('increment')` // `mapActions` ä¹Ÿæ”¯æŒè½½è·ï¼š 'incrementBy' // å°† `this.incrementBy(amount)` æ˜ å°„ä¸º `this.$store.dispatch('incrementBy', amount)` ]), ...mapActions(&#123; add: 'increment' // å°† `this.add()` æ˜ å°„ä¸º `this.$store.dispatch('increment')` &#125;) &#125;&#125; ç»„åˆ Action è¿”å› promise 12345678910111213141516171819202122232425actions: &#123; actionA (&#123; commit &#125;) &#123; return new Promise((resolve, reject) =&gt; &#123; setTimeout(() =&gt; &#123; commit('someMutation') resolve() &#125;, 1000) &#125;) &#125;&#125;store.dispatch('actionA').then(() =&gt; &#123; // ...&#125;)// åœ¨å¦å¤–ä¸€ä¸ª action ä¸­ä¹Ÿå¯ä»¥ï¼šactions: &#123; // ... actionB (&#123; dispatch, commit &#125;) &#123; return dispatch('actionA').then(() =&gt; &#123; commit('someOtherMutation') &#125;) &#125;&#125; å°æ€»ç»“ state åŸå§‹çŠ¶æ€ mapState ç»“åˆ computed ä½¿ç”¨ getters åŸºäºåŸå§‹çŠ¶æ€æ´¾ç”Ÿçš„ä¸€äº›çŠ¶æ€ï¼Œç±»ä¼¼è®¡ç®—å±æ€§ mapGetters ç»“åˆ computed ä½¿ç”¨ æ¯ä¸ª getter åœ¨è°ƒç”¨æ—¶ä¼šè¢«ä¼ å…¥ state å’Œ getters state åŒ…å«äº†å½“å‰æ‰€æœ‰åŸå§‹çŠ¶æ€ï¼Œç­‰ä»· store.state getters åŒ…å«äº†å½“å‰æ‰€æœ‰ gettersï¼Œç­‰ä»· store.getters mutations ç”¨æ¥å˜æ›´æŸä¸€åŸå§‹çŠ¶æ€ï¼Œä¸èƒ½ç›´æ¥å˜æ›´æ´¾ç”ŸçŠ¶æ€ getter é€šè¿‡ commit æäº¤ mutation mutation ä¸­åšçš„ä»»åŠ¡ä¸€èˆ¬ä¸ºåŒæ­¥ä»»åŠ¡ï¼Œä¸”è¾ƒä¸ºç®€å• mapMutations ç»“åˆ methos ä½¿ç”¨ æ¯ä¸ª mutation åœ¨è°ƒç”¨æ—¶ä¼šè¢«ä¼ å…¥ state å’Œ payload state åŒ…å«äº†å½“å‰æ‰€æœ‰åŸå§‹çŠ¶æ€ï¼Œç­‰ä»· store.state payload ä¸ºé¢å¤–å‚æ•° actions è´Ÿè´£å¤æ‚çš„å¼‚æ­¥ä»»åŠ¡ ä¸èƒ½ç›´æ¥å˜æ›´åŸå§‹çŠ¶æ€ï¼Œéœ€è¦æäº¤ mutation æ¥å˜æ›´åŸå§‹çŠ¶æ€ mapActions ç»“åˆ methods ä½¿ç”¨ æ¯ä¸ª action åœ¨è¢«è°ƒç”¨æ—¶ï¼Œä¼šè¢«ä¼ å…¥ä¸€ä¸ª context å¯¹è±¡å’Œ payload context ä¸ºä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å±æ€§ï¼Œå¯åˆ©ç”¨è§£æ„æå– state, // ç­‰åŒäº store.stateï¼Œè‹¥åœ¨æ¨¡å—ä¸­åˆ™ä¸ºå±€éƒ¨çŠ¶æ€ rootState, // ç­‰åŒäº store.stateï¼Œåªå­˜åœ¨äºæ¨¡å—ä¸­ commit, // ç­‰åŒäº store.commit dispatch, // ç­‰åŒäº store.dispatch getters, // ç­‰åŒäº store.getters rootGetters // ç­‰åŒäº store.gettersï¼Œåªå­˜åœ¨äºæ¨¡å—ä¸­ payload ä¸ºé¢å¤–å‚æ•° Module å¤æ‚åº”ç”¨ä¸­ï¼ŒVuex å…è®¸å°† store åˆ‡å‰²æˆæ¨¡å— æ³¨æ„å¹¶ä¸æ˜¯åˆ›å»ºäº†å¦å¤–ä¸€ä¸ª storeï¼Œå…¨å±€ä¸­ä»ç„¶åªæœ‰ä¸€ä¸ª storeï¼Œå› ä¸ºå…¶æ˜¯å•ä¾‹æ¨¡å¼ æ‹†åˆ†æˆçš„æ¨¡å—ä¾æ—§åŒ…å« stateã€gettersã€mutationsã€actions 1234567891011121314151617181920212223242526const moduleA = &#123; state: &#123;...&#125;, mutations: &#123; ... &#125;, actions: &#123; ... &#125;, getters: &#123; ... &#125;&#125;const moduleB = &#123; state: &#123; test:'cgh' &#125;, mutations: &#123; ... &#125;, actions: &#123; ... &#125;&#125;const store = new Vuex.Store(&#123; // å®šä¹‰æ¨¡å— modules: &#123; a: moduleA, b: moduleB &#125;&#125;)// å¼•ç”¨æ¨¡å—store.state.a // -&gt; è®¿é—®moduleA çš„æ‰€æœ‰çŠ¶æ€store.state.b.test // -&gt; è®¿é—®moduleB çš„æŸä¸€çŠ¶æ€ï¼Œä¸å¿…store.state.b.state.test æ¨¡å—å†…éƒ¨çš„å±€éƒ¨çŠ¶æ€ æ¨¡å—å†…éƒ¨å®šä¹‰çš„ mutationã€getter æ¥å—åˆ°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ¨¡å—çš„å±€éƒ¨çŠ¶æ€å¯¹è±¡ å¯é€šè¿‡ ç¬¬ä¸‰ä¸ªå‚æ•° rootState è®¿é—®åˆ°æ ¹èŠ‚ç‚¹çŠ¶æ€ æ¨¡å—å†…éƒ¨å®šä¹‰çš„ action æ¥å—åˆ°çš„ context.state ä¹Ÿæ˜¯æ¨¡å—çš„å±€éƒ¨çŠ¶æ€å¯¹è±¡ å¯é€šè¿‡ context.rootState è®¿é—®åˆ°æ ¹èŠ‚ç‚¹çŠ¶æ€ 123456789101112131415161718192021222324const moduleA = &#123; // æ¨¡å—å†…å±€éƒ¨çŠ¶æ€ state: &#123; count: 0 &#125;, mutations: &#123; increment(state) &#123; // è¿™é‡Œçš„ `state` å¯¹è±¡æ˜¯æ¨¡å—çš„å±€éƒ¨çŠ¶æ€ state.count++ &#125; &#125;, getters: &#123; doubleCount(state, getters, rootState) &#123; return state.count * 2 &#125; &#125;, actions: &#123; incrementIfOddOnRootSum(&#123; state, commit, rootState &#125;) &#123; if ((state.count + rootState.count) % 2 === 1) &#123; commit('increment') &#125; &#125; &#125;&#125; å‘½åç©ºé—´ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¨¡å—å†…éƒ¨çš„ actionã€mutation å’Œ getter æ˜¯æ³¨å†Œåœ¨å…¨å±€å‘½åç©ºé—´çš„â€”â€”è¿™æ ·ä½¿å¾—å¤šä¸ªæ¨¡å—èƒ½å¤Ÿå¯¹åŒä¸€ mutation æˆ– action ä½œå‡ºå“åº”ã€‚ æ³¨æ„æ¨¡å—å†…éƒ¨çš„çŠ¶æ€ä»ç„¶æ˜¯æŒ‚åœ¨å¯¹åº”æ¨¡å—å†…éƒ¨çš„ï¼Œè€Œä¸æ˜¯åœ¨æ ¹çŠ¶æ€èŠ‚ç‚¹ä¸Šã€‚å³ store.state.moduleA.cgh è€Œä¸æ˜¯ store.state.cgh å¯ä»¥ç»™æ¨¡å—æ·»åŠ  namespaced:true ï¼Œè®©å…¶æˆä¸ºä¸€ä¸ªå¸¦å‘½åç©ºé—´çš„æ¨¡å— å½“æ¨¡å—è¢«æ³¨å†Œåï¼Œå®ƒçš„æ‰€æœ‰ getterã€action åŠ mutation éƒ½ä¼šè‡ªåŠ¨æ ¹æ®æ¨¡å—æ³¨å†Œçš„è·¯å¾„è°ƒæ•´å‘½åã€‚ æ¨¡å— A ä½¿ç”¨ namespaced:true å,A å†…å†åµŒå¥—æ¨¡å— B æ—¶ï¼Œæ¨¡å— B ä¼šé»˜è®¤ç»§æ‰¿çˆ¶æ¨¡å— A çš„å‘½åç©ºé—´ å¦‚ä¸‹é¢ä¾‹å­ä¸­çš„ getters[&#39;account/profile&#39;] å½“æ¨¡å— B å†æ·»åŠ  namespaced:true,æ¨¡å— B ä¼šåœ¨é»˜è®¤ç»§æ‰¿ A çš„å‘½åç©ºé—´å‰æä¸‹ï¼Œå†æ·»åŠ è‡ªå·±çš„å‘½åç©ºé—´ å¦‚ä¸‹é¢ä¾‹å­ä¸­çš„ getters[&#39;account/posts/popular&#39;] 12345678910111213141516171819202122232425262728293031323334353637383940const store = new Vuex.Store(&#123; modules: &#123; account: &#123; namespaced: true, // æ¨¡å—å†…å®¹ï¼ˆmodule assetsï¼‰ state: &#123; ... &#125;, // æ¨¡å—å†…çš„çŠ¶æ€å·²ç»æ˜¯åµŒå¥—çš„äº†ï¼Œä½¿ç”¨ `namespaced` å±æ€§ä¸ä¼šå¯¹å…¶äº§ç”Ÿå½±å“ getters: &#123; isAdmin () &#123; ... &#125; // -&gt; getters['account/isAdmin'] &#125;, actions: &#123; login () &#123; ... &#125; // -&gt; dispatch('account/login') &#125;, mutations: &#123; login () &#123; ... &#125; // -&gt; commit('account/login') &#125;, // åµŒå¥—æ¨¡å— modules: &#123; // ç»§æ‰¿çˆ¶æ¨¡å—çš„å‘½åç©ºé—´ myPage: &#123; state: &#123; ... &#125;, getters: &#123; profile () &#123; ... &#125; // -&gt; getters['account/profile'] &#125; &#125;, // è¿›ä¸€æ­¥åµŒå¥—å‘½åç©ºé—´ posts: &#123; namespaced: true, state: &#123; ... &#125;, getters: &#123; popular () &#123; ... &#125; // -&gt; getters['account/posts/popular'] &#125; &#125; &#125; &#125; &#125;&#125;) å¯ç”¨äº†å‘½åç©ºé—´çš„ getter å’Œ action ä¼šæ”¶åˆ°å±€éƒ¨åŒ–çš„ getterï¼Œdispatch å’Œ commit å‚æ•°ï¼Œå³åœ¨æ¨¡å—å†…éƒ¨æäº¤æ¨¡å—å†…éƒ¨çš„ mutationã€æ´¾å‘å†…éƒ¨çš„ actionã€è·å–å†…éƒ¨çš„ getter æ—¶ï¼Œä¸éœ€è¦æ·»åŠ é¢å¤–çš„ç©ºé—´åå‰ç¼€(vuex éšå¼å¸®æˆ‘ä»¬æ·»åŠ äº†ç©ºé—´å‰ç¼€ï¼Œä¼šé»˜è®¤è·å–æ¨¡å—å†…çš„èµ„æº)ã€‚æ›´æ”¹ namespaced å±æ€§åä¹Ÿä¸éœ€è¦ä¿®æ”¹æ¨¡å—å†…çš„ä»£ç ã€‚ åœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—å†…è®¿é—®å…¨å±€å†…å®¹ å¦‚æœä½ å¸Œæœ›ä½¿ç”¨å…¨å±€ state å’Œ getterï¼ŒrootState å’Œ rootGetter ä¼šä½œä¸ºç¬¬ä¸‰å’Œç¬¬å››å‚æ•°ä¼ å…¥ getterï¼Œä¹Ÿä¼šé€šè¿‡ context å¯¹è±¡çš„å±æ€§ä¼ å…¥ actionã€‚ è‹¥éœ€è¦åœ¨å…¨å±€å‘½åç©ºé—´å†…åˆ†å‘ action æˆ–æäº¤ mutationï¼Œå°† { root: true } ä½œä¸ºç¬¬ä¸‰å‚æ•°ä¼ ç»™ dispatch æˆ– commit å³å¯ã€‚ 12345678910111213141516171819202122232425262728293031modules: &#123; foo: &#123; namespaced: true, getters: &#123; // åœ¨è¿™ä¸ªæ¨¡å—çš„ getter ä¸­ï¼Œ`getters` è¢«å±€éƒ¨åŒ–äº† // ä½ å¯ä»¥ä½¿ç”¨ getter çš„ç¬¬å››ä¸ªå‚æ•°æ¥è°ƒç”¨ `rootGetters` someGetter (state, getters, rootState, rootGetters) &#123; getters.someOtherGetter // -&gt; 'foo/someOtherGetter' rootGetters.someOtherGetter // -&gt; 'someOtherGetter' &#125;, someOtherGetter: state =&gt; &#123; ... &#125; &#125;, actions: &#123; // åœ¨è¿™ä¸ªæ¨¡å—ä¸­ï¼Œ dispatch å’Œ commit ä¹Ÿè¢«å±€éƒ¨åŒ–äº† // ä»–ä»¬å¯ä»¥æ¥å— `root` å±æ€§ä»¥è®¿é—®æ ¹ dispatch æˆ– commit someAction (&#123; dispatch, commit, getters, rootGetters &#125;) &#123; getters.someGetter // -&gt; 'foo/someGetter' rootGetters.someGetter // -&gt; 'someGetter' dispatch('someOtherAction') // -&gt; 'foo/someOtherAction' dispatch('someOtherAction', null, &#123; root: true &#125;) // -&gt; 'someOtherAction' commit('someMutation') // -&gt; 'foo/someMutation' commit('someMutation', null, &#123; root: true &#125;) // -&gt; 'someMutation' &#125;, someOtherAction (ctx, payload) &#123; ... &#125; &#125; &#125;&#125; åœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—æ³¨å†Œå…¨å±€ action è‹¥éœ€è¦åœ¨å¸¦å‘½åç©ºé—´çš„æ¨¡å—æ³¨å†Œå…¨å±€ actionï¼Œä½ å¯æ·»åŠ  root: trueï¼Œå¹¶å°†è¿™ä¸ª action çš„å®šä¹‰æ”¾åœ¨å‡½æ•° handler ä¸­ã€‚ 12345678910111213141516171819&#123; actions: &#123; someOtherAction (&#123;dispatch&#125;) &#123; dispatch('someAction') &#125; &#125;, modules: &#123; foo: &#123; namespaced: true, actions: &#123; someAction: &#123; root: true, handler (namespacedContext, payload) &#123; ... &#125; // -&gt; 'someAction' &#125; &#125; &#125; &#125;&#125; å¸¦å‘½åç©ºé—´çš„ mapStateã€mapGettersã€mapMutationsã€mapActions è¾…åŠ©å‡½æ•° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748computed: &#123; ...mapState(&#123; a: state =&gt; state.some.nested.module.a, b: state =&gt; state.some.nested.module.b &#125;)&#125;,methods: &#123; ...mapActions([ 'some/nested/module/foo', // -&gt; this['some/nested/module/foo']() 'some/nested/module/bar' // -&gt; this['some/nested/module/bar']() ])&#125;// å¯å°†å‘½åç©ºé—´åšä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ç»™è¾…åŠ©å‡½æ•°computed: &#123; ...mapState('some/nested/module', &#123; a: state =&gt; state.a, b: state =&gt; state.b &#125;)&#125;,methods: &#123; ...mapActions('some/nested/module', [ 'foo', // -&gt; this.foo() 'bar' // -&gt; this.bar() ])&#125;// å¯ä»¥é€šè¿‡ä½¿ç”¨ createNamespacedHelpers åˆ›å»ºåŸºäºæŸä¸ªå‘½åç©ºé—´è¾…åŠ©å‡½æ•°ã€‚å®ƒè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡é‡Œæœ‰æ–°çš„ç»‘å®šåœ¨ç»™å®šå‘½åç©ºé—´å€¼ä¸Šçš„ç»„ä»¶ç»‘å®šè¾…åŠ©å‡½æ•°import &#123; createNamespacedHelpers &#125; from 'vuex'const &#123; mapState, mapActions &#125; = createNamespacedHelpers('some/nested/module')export default &#123; computed: &#123; // åœ¨ `some/nested/module` ä¸­æŸ¥æ‰¾ ...mapState(&#123; a: state =&gt; state.a, b: state =&gt; state.b &#125;) &#125;, methods: &#123; // åœ¨ `some/nested/module` ä¸­æŸ¥æ‰¾ ...mapActions([ 'foo', 'bar' ]) &#125;&#125; æ¨¡å—åŠ¨æ€æ³¨å†Œ åœ¨ store åˆ›å»ºä¹‹åï¼Œä½ å¯ä»¥ä½¿ç”¨ store.registerModule æ–¹æ³•æ³¨å†Œæ¨¡å— å¯ä»¥ä½¿ç”¨ store.unregisterModule(moduleName) æ¥åŠ¨æ€å¸è½½æ¨¡å—ã€‚æ³¨æ„ï¼Œä½ ä¸èƒ½ä½¿ç”¨æ­¤æ–¹æ³•å¸è½½é™æ€æ¨¡å—ï¼ˆå³åˆ›å»º store æ—¶å£°æ˜çš„æ¨¡å—ï¼‰ã€‚ 12345678// æ³¨å†Œæ¨¡å— `myModule`store.registerModule('myModule', &#123; // ...&#125;)// æ³¨å†ŒåµŒå¥—æ¨¡å— `nested/myModule`store.registerModule(['nested', 'myModule'], &#123; // ...&#125;) æ³¨å†Œä¸€ä¸ªæ–° module æ—¶ï¼Œä½ å¾ˆæœ‰å¯èƒ½æƒ³ä¿ç•™è¿‡å»çš„ state å¯ä»¥é€šè¿‡ preserveState é€‰é¡¹å°†å…¶å½’æ¡£ï¼šstore.registerModule(â€˜aâ€™, module, { preserveState: true })ã€‚ æ’ä»¶ å†…ç½® logger æ’ä»¶ 1234567import createLogger from 'vuex/dist/logger'const debug = process.env.NODE_ENV !== 'production'const store = new Vuex.Store(&#123; plugins: debug ? [createLogger()] : [] // * å¼€å‘æ¨¡å¼å¯ç”¨logå·¥å…·&#125;) ä¸¥æ ¼æ¨¡å¼ åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œæ— è®ºä½•æ—¶å‘ç”Ÿäº†çŠ¶æ€å˜æ›´ä¸”ä¸æ˜¯ç”± mutation å‡½æ•°å¼•èµ·çš„ï¼Œå°†ä¼šæŠ›å‡ºé”™è¯¯ã€‚è¿™èƒ½ä¿è¯æ‰€æœ‰çš„çŠ¶æ€å˜æ›´éƒ½èƒ½è¢«è°ƒè¯•å·¥å…·è·Ÿè¸ªåˆ° 12345const debug = process.env.NODE_ENV !== 'production'const store = new Vuex.Store(&#123; strict: debug&#125;) è¡¨å•å¤„ç† åœ¨ä¸¥æ ¼æ¨¡å¼ï¼Œåœ¨å±äº vuex çš„ state ä¸Šä½¿ç”¨ v-model ä¼šæŠ¥é”™(æ²¡æœ‰é€šè¿‡ commit æäº¤ mutation è€Œç›´æ¥æ”¹å˜äº†çŠ¶æ€) å¯ä»¥å°† v-model ä½¿ç”¨åŸå§‹æ–¹æ³•å®ç°(:value+@input) 1234567891011121314151617181920&lt;input :value="message" @input="updateMessage"&gt;// ...computed: &#123; ...mapState(&#123; message: state =&gt; state.obj.message &#125;)&#125;,methods: &#123; updateMessage (e) &#123; this.$store.commit('updateMessage', e.target.value) &#125;&#125;// storemutations: &#123; updateMessage (state, message) &#123; state.obj.message = message &#125;&#125; ä½¿ç”¨å¸¦æœ‰ setter çš„åŒå‘ç»‘å®šè®¡ç®—å±æ€§(æ¨è) 12345678910111213&lt;input v-model="message"&gt;// ...computed: &#123; message: &#123; get () &#123; return this.$store.state.obj.message &#125;, set (value) &#123; this.$store.commit('updateMessage', value) &#125; &#125;&#125;]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>vuex</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[name-style]]></title>
    <url>%2F2018%2F11%2F07%2Fname-style%2F</url>
    <content type="text"><![CDATA[å·¥ä½œä¸­ï¼Œç»å¸¸å› å‘½åè§„èŒƒè€Œå¤´ç–¼ï¼Œæ‰€ä»¥ç‰¹æ„æ•´ç†äº†éƒ¨åˆ†è§„èŒƒï¼Œå°±ä¾¿åæœŸæŸ¥æ‰¾ æ–‡ä»¶åŠæ–‡ä»¶å¤¹å‘½åè§„èŒƒåŸåˆ™ å‘½åå°½é‡ç®€çŸ­ï¼Œä¸è¦äº§ç”Ÿå¤šä¸ªå•è¯ï¼›å°½é‡é‡‡ç”¨çº¦å®šä¿—ç§°çš„åç§°ï¼› éœ€è¦é‡ç‚¹æ ‡è¯†çš„å¯é‡‡ç”¨ç‰¹æ®Šæ ‡è¯†å»ï¼› è§„èŒƒ æ–‡ä»¶å¤¹ å¤šä¸ªå•è¯æ—¶ï¼šç»Ÿä¸€é‡‡ç”¨å…¨å°å†™+è¿å­—ç¬¦ï¼›å¦‚ source-codehttp://www.ruanyifeng.com/blog/2017/02/filename-should-be-lowercase.html ç‰¹æ®Šæƒ…å†µéœ€è¦ç‰¹åˆ«æ ‡è¯†çš„å¯ä»¥é‡‡ç”¨å¸•æ–¯å¡å‘½åæ–¹å¼ï¼Œå¦‚ vue ç»„ä»¶çš„æ–‡ä»¶å¤¹ SyncClass æ–‡ä»¶ ç»Ÿä¸€é‡‡ç”¨å…¨å°å†™+è¿å­—ç¬¦å½¢å¼ï¼šauto-height.js ç‰¹æ®Šæƒ…å†µéœ€è¦ç‰¹åˆ«æ ‡è¯†çš„å¯ä»¥é‡‡ç”¨å¸•æ–¯å¡å‘½åæ–¹å¼ï¼Œå¦‚ vue ç»„ä»¶ SyncClass.vue ç‰¹æ®Šæ–‡ä»¶å¯é‡‡ç”¨å…¨å¤§å†™å½¢å¼ï¼Œå¦‚ README æ–‡ä»¶å†…éƒ¨å†…å®¹å‘½å js å˜é‡ é©¼å³° isLoading js å¸¸é‡ å¤§å†™+ä¸‹åˆ’çº¿ ERROR_TEXT sass å˜é‡ $å¼€å¤´ï¼Œå°å†™+è¿å­—ç¬¦ $color-red vue ç»„ä»¶ name å¸•æ–¯å¡ name:&#39;ErrorCorrection&#39; ç»„ä»¶è°ƒç”¨ å¸•æ–¯å¡ &lt;ErrorCorrection&gt;&lt;/ErrorCorrection&gt;]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>å‘½å</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[chrome-devtools]]></title>
    <url>%2F2018%2F09%2F14%2Fchrome-devtools%2F</url>
    <content type="text"><![CDATA[è®°å½• chrome è°ƒè¯•å·¥å…·çš„ä¸€äº›å¸¸ç”¨æŠ€å·§æ²¡æœ‰æ—¶é—´è¯¦ç»†æ•´ç†ï¼Œæƒ³åˆ°ä»€ä¹ˆè®°å½•ä»€ä¹ˆ Chrome Devtools å¸¸ç”¨æŠ€å·§ç½‘ç»œè¯·æ±‚ç›¸å…³æ‹·è´ç½‘ç»œè¯·æ±‚åœ°å€ é€‰æ‹©NetWorkTab å³é”®ä¸€ä¸ªç½‘ç»œè¯·æ±‚ é€‰æ‹©copy é€‰æ‹©copy link addresså³å¯æ‹·è´æŸä¸€è¯·æ±‚å®é™…åœ°å€ æ³¨æ„ å¦‚æœç›´æ¥åŒå‡»ä¸€ä¸ªç½‘ç»œè¯·æ±‚ä¼šæ‰“å¼€ä¸€ä¸ªæ–°æ ‡ç­¾é¡µï¼Œç„¶åä¼šè¯·æ±‚å¯¹åº”ç½‘ç»œåœ°å€ï¼Œå¦‚æœæœ‰è£…JSONViewå¯ä»¥ç›´æ¥æŸ¥çœ‹å¯¹åº”ç»“æœ æ‹·è´ç½‘ç»œè¯·æ±‚çš„ response é€‰æ‹©NetWorkTab å³é”®ä¸€ä¸ªç½‘ç»œè¯·æ±‚ é€‰æ‹©copy é€‰æ‹©copy responseå³å¯ æ³¨æ„ é€‰æ‹©copy responseæ‹·è´å‡ºçš„ response æ˜¯æ²¡æœ‰ç»è¿‡æ ¼å¼åŒ–çš„(æ²¡æœ‰ç¼©è¿›),å¯ä»¥é€šè¿‡ç±»ä¼¼json.cnç­‰åœ¨çº¿ç½‘ç«™è¿›è¡Œç¾åŒ–ï¼Œæˆ–è€…ä½¿ç”¨JSON.stringify(obj,null,4)æˆ–è€…åœ¨consoleä¸­ä½¿ç”¨copyæ–¹æ³•è¿›è¡Œç¾åŒ–ï¼Œå¦‚ä¸‹é¢ä¾‹å­ 1234567copy(&#123;"most_visited": [], "history_on": false, "recent": []&#125;)// * å°†å¾—åˆ°ä¸‹é¢ç¾åŒ–åçš„ç»“æœ&#123; "most_visited": [], "history_on": false, "recent": []&#125; å°†ç½‘ç»œè¯·æ±‚è½¬æ¢ä¸º fetch å½¢å¼ é€‰æ‹©NetWorkTab å³é”®ä¸€ä¸ªç½‘ç»œè¯·æ±‚ é€‰æ‹©copy é€‰æ‹©copy as fetchå³å¯ï¼Œdevtools ä¼šå°†è¯·æ±‚çš„ç›¸å…³å‚æ•°éƒ½æ‹¼è£…å¥½å¹¶æ”¾åˆ°ä¸€ä¸ª fetch ä¸­ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ 123456789fetch('https://developers.google.com/profile/userhistory', &#123; credentials: 'include', headers: &#123;&#125;, referrer: 'https://developers.google.com/web/tools/chrome-devtools/sources', referrerPolicy: 'no-referrer-when-downgrade', body: null, method: 'GET', mode: 'cors'&#125;) å¦‚ä½•åˆ¤æ–­ç½‘ç«™æ˜¯å¦å¼€å¯ gzip æ¯”è¾ƒèµ„æºå¤§å° åœ¨NetWork Tab çš„å·¦ä¸Šè§’é€‰æ‹©Use large request rows é€‰ä¸­åï¼Œé‡æ–°åŠ è½½é¡µé¢ åœ¨sizeåˆ—ä¼šå‡ºç°ä¸¤ä¸ªèµ„æºå¤§å°ï¼Œä¸Šé¢æ˜¯å®é™…ä¸‹è½½èµ„æºçš„å¤§å°ï¼Œä¸‹é¢çš„æ˜¯åŸå§‹èµ„æºå¤§å°ï¼Œå¦‚æœäºŒè€…å¤§å°å‡ ä¹ä¸€è‡´ï¼Œåˆ™å¯ä»¥åˆ¤å®šç½‘ç«™æœªå¼€å¯gzip ä¸‹é¢ä¸ºå¼€å¯åçš„ å…¶å®ƒæ–¹æ³• æŸ¥çœ‹ç½‘ç»œè¯·æ±‚çš„response headerçš„Content-Encodingæ˜¯å¦ä¸ºgzip æ³¨æ„ åœ¨å¼€å¯gzipæ—¶ï¼Œéœ€è¦å¿½ç•¥å›¾ç‰‡æ ¼å¼ï¼Œå› ä¸ºé’ˆå¯¹å›¾ç‰‡å¼€å¯ gzip ä¸ä½†ä¸ä¼šç¼©å‡å¤§å°ï¼Œåå€’ä¼šå¢å¤§å›¾ç‰‡èµ„æºçš„ä¼ è¾“å¤§å°ï¼Œé€‚å¾—å…¶å å‘½ä»¤ç›¸å…³CommandMenu å’Œå¾ˆå¤šå·¥å…·ä¸€æ ·ï¼Œdevtools ä¹Ÿæœ‰å‘½ä»¤èœå•ï¼Œå¯ä»¥é€šè¿‡ctrl+shift+på”¤å‡º å¯ä»¥é€šè¿‡è¾“å…¥å‘½ä»¤çš„å½¢å¼ä½¿ç”¨ devtools æˆ–è€…æ‰“å¼€ç‰¹å®šèœå• å¸¸ç”¨command ctrl+p-&gt;ç›´æ¥è¾“å…¥ï¼Œåˆ™æŸ¥æ‰¾æ–‡ä»¶ ctrl+p-&gt;è¾“å…¥?-&gt;æŸ¥çœ‹å¸®åŠ© ctrl+p-&gt;è¾“å…¥:-&gt;è·³è½¬ç‰¹å®šè¡Œ ctrl+p-&gt;è¾“å…¥@-&gt;è·³è½¬åˆ°ç‰¹å®šç¬¦å·å¤„(symbol) ctrl+p-&gt;è¾“å…¥!-&gt;è¿è¡Œ snippet ctrl+p-&gt;è¾“å…¥&gt;-&gt;å‘½ä»¤èœå• åˆ›å»ºæ‰€æœ‰é¡µé¢éƒ½èƒ½ä½¿ç”¨çš„ snippet(ä»£ç ç‰‡æ®µ) ä¾‹å¦‚æœ‰äº›ç½‘ç«™æ²¡æœ‰å¼•å…¥jQueryï¼Œæ­¤æ—¶å¯ä»¥åˆ›å»ºä¸€ä¸ªåœ¨ä»»ä½•é¡µé¢éƒ½èƒ½ä½¿ç”¨çš„æ’å…¥jQueryçš„ä»£ç ç‰‡æ®µ ä½¿ç”¨ctrl+shift+pæ‰“å¼€ CommandMenuï¼Œè¾“å…¥Create new snippet æ‹·è´ä¸‹é¢çš„ä»£ç ï¼Œctrl+sä¿å­˜å¹¶ctrl+enteræ‰§è¡Œ ä½ ä¼šå‘ç°åœ¨é¡µé¢çš„headæ ‡ç­¾ä¸‹å·²ç»å¼•å…¥ä¸€ä¸ª jQuery äº† 12345let script = document.createElement('script')script.src = 'https://code.jquery.com/jquery-3.2.1.min.js'script.crossOrigin = 'anonymous'script.integrity = 'sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4='document.head.appendChild(script) å¿«é€Ÿæ‰§è¡Œä¸€ä¸ªå·²ç»åˆ›å»ºçš„ snippet ä½¿ç”¨ctrl+pï¼Œè¾“å…¥!ï¼Œå³ä¼šåˆ—å‡ºæ‰€æœ‰ snippetï¼Œé€‰æ‹©ä¸€ä¸ªæ‰§è¡Œå³å¯ æ ¼å¼åŒ–æºç  æœ‰æ—¶æºç ä¼šè¿›è¡Œå‹ç¼©æˆ–è€…æ ¼å¼ä¸å¯¹ï¼Œéœ€è¦å¯¹å…¶è¿›è¡Œæ ¼å¼åŒ– åœ¨source Tab ä¸‹æ‰“å¼€çš„jsã€htmlã€cssæ–‡ä»¶ï¼Œåœ¨å³ä¸‹è§’ä¼šå±•ç¤ºä¸€ä¸ªFormatæŒ‰é’®(å¤§æ¦‚é•¿è¿™æ ·{})ï¼Œç‚¹å‡»å³å¯æ ¼å¼åŒ–å½“å‰ä»£ç  æ ¼å¼åŒ–å console ç›¸å…³å°† DOM å…ƒç´ æ ¼å¼åŒ–ä¸º JavaScript å¯¹è±¡ ä½¿ç”¨console.dir(domå…ƒç´ ) ä½¿ç”¨$0 åœ¨ElementTab ä¸­é€‰æ‹©ä¸€ä¸ªå…ƒç´ ï¼Œç„¶åä½¿ç”¨$0å¯ä»¥å¼•ç”¨è¿™ä¸ª DOM å…ƒç´  ä¾‹å¦‚ä¸‹é¢æ‰“å°å‡º DOM å…ƒç´  12345// * æ‰“å°é€‰ä¸­çš„DOMå…ƒç´ console.log($0)// * å¦‚æœéœ€è¦è½¬æˆJSå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨dirconsole.dir($0) åœ¨vue-devtoolsä¸­æœ‰ç±»ä¼¼å˜é‡ï¼Œå¯ä»¥ä½¿ç”¨$vm0å¼•ç”¨é€‰ä¸­ç»„ä»¶ åœ¨ console.log ä¸­ä½¿ç”¨ css æ ·å¼ ä½¿ç”¨%c 12// * ä½¿ç”¨%cconsole.log('%cæˆ‘å°†æ˜¯è“è‰²çš„%cæˆ‘æ˜¯ç»¿è‰²çš„', 'color: blue; ', 'color:green;') å¿«é€Ÿæ¸…é™¤ console é¢æ¿å†…å®¹ ä½¿ç”¨ctrl+læˆ–è€…clear() æŸ¥çœ‹ jsã€css ä¸­çš„æ— ç”¨ä»£ç ä½¿ç”¨ coverage ctrl+shift+pè¾“å…¥Show Coverageå¹¶é€‰æ‹©ä¹‹ ä¼šåˆ—å‡ºcssã€jsä¸­æ²¡æœ‰ç”Ÿæ•ˆçš„å æ¯” ç‚¹å‡»å…¶ä¸­ä¸€æ¡ï¼Œä¼šæ‰“å¼€å¯¹åº”æ–‡ä»¶ï¼Œå·¦ä¾§çº¢è‰²ä»£è¡¨æœªç”Ÿæ•ˆçš„ä»£ç è¡Œï¼Œç»¿è‰²ä»£è¡¨å·²ç»æ‰§è¡Œè¿‡çš„ä»£ç è¡Œ æœªå®Œå¾…ç»­]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>è°ƒè¯•</tag>
        <tag>Chrome</tag>
        <tag>DevTools</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[git]]></title>
    <url>%2F2018%2F08%2F18%2Fgit%2F</url>
    <content type="text"><![CDATA[å·¥ä½œä¸­ç»å¸¸ä¼šç”¨åˆ° git,éƒ½åªæ˜¯åœç•™åœ¨ç®€å•çš„æ“ä½œä¸Šï¼Œå¯¹äºå‡ºç°çš„é—®é¢˜ä¹Ÿåªä¼šç™¾åº¦è§£å†³ï¼Œæ— æ³•çŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œæ‰€ä»¥å‡†å¤‡å¥½å¥½äº†è§£ä¸€ä¸‹ gitï¼Œåšåˆ°çŸ¥å…¶æ‰€ä»¥ç„¶ã€‚ä»¥ä¸‹ä¸ºé˜…è¯»ã€Šprogitã€‹åšçš„ä¸€äº›ç¬”è®°ï¼Œæ–¹ä¾¿åæœŸæŸ¥é˜…ã€‚ Gitèµ·æ­¥åŒå…¶ä»–ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„å·®å¼‚ Git å­˜å‚¨çš„æ˜¯é¡¹ç›®éšæ—¶é—´æ”¹å˜çš„å¿«ç…§è€Œä¸æ˜¯ä¸åˆå§‹ç‰ˆæœ¬çš„å·®å¼‚ Git å­˜å‚¨çš„æ˜¯æ¯ä¸ªæ”¹å˜ç‚¹é¡¹ç›®æ•´ä½“å¿«ç…§ å¦‚æœæŸæ–‡ä»¶æ²¡æœ‰è¢«ä¿®æ”¹ï¼ŒGit ä¸ä¼šé‡æ–°å­˜å‚¨è¯¥æ–‡ä»¶ å…¶ä»–å¸¸è§ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿå­˜å‚¨çš„æ˜¯æ¯ä¸ªæ–‡ä»¶ä¸åˆå§‹ç‰ˆæœ¬çš„å·®å¼‚ Git è¿‘ä¹æ‰€æœ‰æ“ä½œéƒ½æ˜¯æœ¬åœ°æ‰§è¡Œ é€Ÿåº¦å¿« å¯ä»¥ç¦»çº¿æ“ä½œ Git ä¿è¯å®Œæ•´æ€§ ç”¨ SHA-1 æ•£åˆ—ï¼ˆhashï¼Œå“ˆå¸Œï¼‰æ¥è®¡ç®—æ ¡éªŒå’Œï¼Œè¿™æ„å‘³ç€ä¸å¯èƒ½åœ¨ Git ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹æ›´æ”¹ä»»ä½•æ–‡ä»¶å†…å®¹å’Œç›®å½• SHA-1 æ•£åˆ—é•¿è¿™æ ·124b9da6552252987aa493b52f8696cd6d3b00373 Git ç®¡ç†çš„æ–‡ä»¶çš„ä¸‰ç§çŠ¶æ€ é€šè¿‡ Git ç®¡ç†çš„æ–‡ä»¶ä¼šå¤„äºä¸‹é¢ä¸‰ç§çŠ¶æ€ä¹‹ä¸€ å·²æäº¤(committed) å·²æäº¤è¡¨ç¤ºæ•°æ®å·²ç»å®‰å…¨çš„ä¿å­˜åœ¨æœ¬åœ°æ•°æ®åº“ä¸­ å·²ä¿®æ”¹(modified) å·²ä¿®æ”¹è¡¨ç¤ºä¿®æ”¹äº†æ–‡ä»¶ï¼Œä½†è¿˜æ²¡ä¿å­˜åˆ°æ•°æ®åº“ä¸­ å·²æš‚å­˜(staged) å·²æš‚å­˜è¡¨ç¤ºå¯¹ä¸€ä¸ªå·²ä¿®æ”¹æ–‡ä»¶çš„å½“å‰ç‰ˆæœ¬åšäº†æ ‡è®°ï¼Œä½¿ä¹‹åŒ…å«åœ¨ä¸‹æ¬¡æäº¤çš„å¿«ç…§ä¸­ã€‚ Git çš„ä¸‰ä¸ªå·¥ä½œåŒºåŸŸ Git ä»“åº“ç›®å½•(.git æ–‡ä»¶å¤¹) Git ä»“åº“ç›®å½•æ˜¯ Git ç”¨æ¥ä¿å­˜é¡¹ç›®çš„å…ƒæ•°æ®å’Œå¯¹è±¡æ•°æ®åº“çš„åœ°æ–¹ã€‚è¿™æ˜¯ Git ä¸­æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œä»å…¶å®ƒè®¡ç®—æœºå…‹éš†ä»“åº“æ—¶ï¼Œæ‹·è´çš„å°±æ˜¯è¿™é‡Œçš„æ•°æ® å·¥ä½œç›®å½•(å½“å‰ç›®å½•) å·¥ä½œç›®å½•æ˜¯å¯¹é¡¹ç›®çš„æŸä¸ªç‰ˆæœ¬ç‹¬ç«‹æå–å‡ºæ¥çš„å†…å®¹ã€‚è¿™äº›ä» Git ä»“åº“çš„å‹ç¼©æ•°æ®åº“ä¸­æå–å‡ºæ¥çš„æ–‡ä»¶ï¼Œæ”¾åœ¨ç£ç›˜ä¸Šä¾›ä½ ä½¿ç”¨æˆ–ä¿®æ”¹ æš‚å­˜åŒºåŸŸ(ä¸€ä¸ªä¿å­˜äº†ä¸‹æ¬¡æäº¤ä¿¡æ¯çš„æ–‡ä»¶) æš‚å­˜åŒºåŸŸæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä¿å­˜äº†ä¸‹æ¬¡å°†æäº¤çš„æ–‡ä»¶åˆ—è¡¨ä¿¡æ¯ï¼Œä¸€èˆ¬åœ¨ Git ä»“åº“ç›®å½•ä¸­ã€‚åˆ«åç´¢å¼• åŸºæœ¬çš„ Git å·¥ä½œæµç¨‹ åœ¨å·¥ä½œç›®å½•ä¸­ä¿®æ”¹æ–‡ä»¶ æš‚å­˜æ–‡ä»¶ï¼Œå°†æ–‡ä»¶çš„å¿«ç…§æ”¾å…¥æš‚å­˜åŒºåŸŸ æäº¤æ›´æ–°ï¼Œæ‰¾åˆ°æš‚å­˜åŒºåŸŸçš„æ–‡ä»¶ï¼Œå°†å¿«ç…§æ°¸ä¹…æ€§å­˜å‚¨åˆ° Git ä»“åº“ç›®å½• Git çš„ä¸‰ä¸ªå­˜å‚¨é…ç½®åœ°æ–¹ /etc/gitconfig ç³»ç»Ÿé€šç”¨é…ç½®ï¼Œé’ˆå¯¹ç³»ç»Ÿä¸­çš„æ¯ä¸ªç”¨æˆ·éƒ½æœ‰æ•ˆï¼› å¯ç”¨å¸¦æœ‰--systemé€‰é¡¹çš„git configå‘½ä»¤è®© Git è¯»å–æ­¤é…ç½® win ç³»ç»Ÿä¸‹ï¼Œæ­¤é…ç½®æ–‡ä»¶åœ¨ Git å®‰è£…ç›®å½•ä¸­ ~/.gitconfigæˆ–~/.config/git/configï¼Œæ­¤é…ç½®ä»…é’ˆå¯¹å½“å‰ç”¨æˆ·æœ‰æ•ˆï¼› å¯ç”¨å¸¦æœ‰--globalé€‰é¡¹çš„git configå‘½ä»¤è®© Git è¯»å–æ­¤é…ç½®ã€‚ win ç³»ç»Ÿä¸‹ï¼Œæ­¤æ–‡ä»¶ä¿å­˜åœ¨c/users/ç”¨æˆ·/.configæ–‡ä»¶ä¸­ å½“å‰ä»“åº“ä¸‹é¢çš„.git/configï¼Œæ­¤é…ç½®ä»…é’ˆå¯¹å½“å‰ä»“åº“æœ‰æ•ˆã€‚ å¯ç”¨å¸¦æœ‰--localé€‰é¡¹çš„git configå‘½ä»¤è®© Git è¯»å–æ­¤é…ç½® åœ¨æŸä»“åº“ä¸‹ç›´æ¥git configç›¸å½“äºgit config --local ä¸‰ç§é…ç½®çš„ä¼˜å…ˆçº§ï¼š ä»“åº“&gt;å½“å‰ç”¨æˆ·&gt;é€šç”¨é…ç½® è®¾ç½®ç”¨æˆ·ä¿¡æ¯ é’ˆå¯¹å½“å‰ç”¨æˆ·é…ç½®åŸºæœ¬ç”¨æˆ·ä¿¡æ¯ 12git config --global user.name &quot;John Doe&quot;git config --global user.email johndoe@example.com --globalåªéœ€è¿è¡Œä¸€æ¬¡ æ£€æŸ¥é…ç½®ä¿¡æ¯1git config --list Git ä¼šåˆ—å‡ºæ‰€æœ‰é…ç½®é¡¹ Git åŸºç¡€è·å– Git ä»“åº“ åœ¨ç°æœ‰é¡¹ç›®æˆ–ç›®å½•ä¸‹å¯¼å…¥æ‰€æœ‰æ–‡ä»¶åˆ° Git ä¸­ 12cd project/git init ä»ä¸€ä¸ªæœåŠ¡å™¨å…‹éš†ä¸€ä¸ªç°æœ‰çš„ Git ä»“åº“ 1git clone [url] url æ”¯æŒä¸‹é¢å‡ ç§ç±»å‹åè®® https git:// ssh Git æ–‡ä»¶çŠ¶æ€çš„ç”Ÿå‘½å‘¨æœŸ å·¥ä½œç›®å½•ä¸‹çš„æ–‡ä»¶ æœªä½¿ç”¨ Git è¿½è¸ªçš„ (Untracked)æ–‡ä»¶ ä½¿ç”¨ add æ“ä½œï¼ŒçŠ¶æ€ä¼šå˜æˆStaged ä½¿ç”¨ Git è¿½è¸ªçš„(Tracked)æ–‡ä»¶ æœªä¿®æ”¹è¿‡çš„(Unmodified) æ–‡ä»¶ç¼–è¾‘åçŠ¶æ€ä¼šå˜æˆModified åˆ é™¤æ–‡ä»¶åï¼ŒçŠ¶æ€ä¼šå˜æˆUntracked ä¿®æ”¹è¿‡çš„(Modified) ModifiedçŠ¶æ€çš„æ–‡ä»¶ä½¿ç”¨æš‚å­˜æ“ä½œï¼ŒçŠ¶æ€ä¼šå˜æˆ(Staged) æš‚å­˜è¿‡çš„(Staged) ä½¿ç”¨ commit æ“ä½œåï¼ŒçŠ¶æ€ä¼šå˜æˆUnmodified æŸ¥çœ‹å½“å‰æ–‡ä»¶çŠ¶æ€(git status) git status git status -sæˆ–è€…git status --short ä½¿ç”¨ç´§å‡‘æ ¼å¼å±•ç¤ºçŠ¶æ€ 123456$ git status -sM READMEMM RakefileA lib/git.rbM lib/simplegit.rb?? LICENSE.txt ??ä»£è¡¨æœªè¿½è¸ª Aä»£è¡¨å·²ç»æš‚å­˜ ç©ºæ ¼Mä»£è¡¨æ–‡ä»¶å·²ç»ä¿®æ”¹è¿‡äº†ï¼Œä½†è¿˜æ²¡æœ‰æ”¾å…¥æš‚å­˜åŒºä¸­ Mç©ºæ ¼ä»£è¡¨æ–‡ä»¶å·²ç»ä¿®æ”¹è¿‡äº†ï¼Œå¹¶ä¸”å·²ç»æ”¾å…¥æš‚å­˜åŒºä¸­ MMä»£è¡¨åœ¨å·¥ä½œåŒºè¢«ä¿®æ”¹å¹¶æäº¤åˆ°æš‚å­˜åŒºååˆåœ¨å·¥ä½œåŒºä¸­è¢«ä¿®æ”¹äº† æš‚å­˜å·²ä¿®æ”¹æ–‡ä»¶/å°†æœªè¿½è¸ªæ–‡ä»¶æ·»åŠ åˆ°è¿½è¸ªåˆ—è¡¨ä¸­(git add) git add å¯ä»¥ç”¨å®ƒå¼€å§‹è·Ÿè¸ªæ–°æ–‡ä»¶ï¼Œæˆ–è€…æŠŠå·²è·Ÿè¸ªçš„æ–‡ä»¶æ”¾åˆ°æš‚å­˜åŒºï¼Œè¿˜èƒ½ç”¨äºåˆå¹¶æ—¶æŠŠæœ‰å†²çªçš„æ–‡ä»¶æ ‡è®°ä¸ºå·²è§£å†³çŠ¶æ€ç­‰ æœ¬è´¨:â€œæ·»åŠ å†…å®¹åˆ°ä¸‹ä¸€æ¬¡æäº¤ä¸­â€-&gt;å°†æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒºä¸­ï¼Œç”¨äºä¸‹æ¬¡æäº¤ å¿½ç•¥æ–‡ä»¶(.gitignore) æ·»åŠ .gitignoreæ–‡ä»¶ ä»¥#å¼€å¤´çš„è¡Œä»£è¡¨æ³¨é‡Š å¯ä»¥ä½¿ç”¨ glob æ¨¡å¼(æ­£åˆ™)åŒ¹é…ã€‚ [abc]ä»£è¡¨åŒ¹é… abc å…¶ä¸­ä¸€ä¸ªå­—ç¬¦ a/**/zä»£è¡¨a/zã€a/b/zã€a/b/c/z ä»¥ï¼ˆ/ï¼‰å¼€å¤´é˜²æ­¢é€’å½’ã€‚ ä»¥ï¼ˆ/ï¼‰ç»“å°¾æŒ‡å®šç›®å½•ã€‚ å¯ä»¥åœ¨æ¨¡å¼å‰åŠ ä¸ŠæƒŠå¹å·ï¼ˆ!ï¼‰å–åã€‚ 123456789101112# å¿½ç•¥ä»»ä½•.aæ–‡ä»¶*.a# ä¸å¿½ç•¥lib.aæ–‡ä»¶!lib.a# ä»…ä»…å¿½ç•¥å½“å‰ç›®å½•ä¸‹ä¸‹çš„TODOæ–‡ä»¶ï¼Œä¸å¿½ç•¥å½“å‰ç›®å½•å­ç›®å½•ä¸‹é¢çš„TODOæ–‡ä»¶/TODO# å¿½ç•¥buildç›®å½•ä¸‹é¢çš„æ‰€æœ‰æ–‡ä»¶build/# å¿½ç•¥docç›®å½•ä¸‹çš„.txtæ–‡ä»¶ï¼Œä½†ä¸å¿½ç•¥docå­ç›®å½•ä¸‹çš„.txtæ–‡ä»¶doc/*.txt# å¿½ç•¥docæ‰€æœ‰ç›®å½•ä¸‹çš„æ‰€æœ‰.pdfæ–‡ä»¶doc/**/*.pdf æŸ¥çœ‹å·®å¼‚(git diff) æŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•å°šæœªæš‚å­˜çš„æ–‡ä»¶æ›´æ–°äº†ä»€ä¹ˆ-&gt;å½“å‰å·¥ä½œç›®å½•æ–‡ä»¶å’Œæš‚å­˜åŒºåŸŸä¸­å¿«ç…§æ–‡ä»¶çš„å·®å¼‚ git diff æ¯”è¾ƒçš„æ˜¯å·¥ä½œç›®å½•ä¸­å½“å‰æ–‡ä»¶å’Œæš‚å­˜åŒºåŸŸå¿«ç…§ä¹‹é—´çš„å·®å¼‚ï¼Œä¹Ÿå°±æ˜¯ä¿®æ”¹ä¹‹åè¿˜æ²¡æœ‰æš‚å­˜èµ·æ¥çš„å˜åŒ–å†…å®¹ git diff æœ¬èº«åªæ˜¾ç¤ºå°šæœªæš‚å­˜çš„æ”¹åŠ¨ï¼Œè€Œä¸æ˜¯è‡ªä¸Šæ¬¡æäº¤ä»¥æ¥æ‰€åšçš„æ‰€æœ‰æ”¹åŠ¨ã€‚æ‰€ä»¥æœ‰æ—¶å€™ä½ ä¸€ä¸‹å­æš‚å­˜äº†æ‰€æœ‰æ›´æ–°è¿‡çš„æ–‡ä»¶åï¼Œè¿è¡Œ git diff åå´ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œå°±æ˜¯è¿™ä¸ªåŸå›  æŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•å·²ç»æš‚å­˜çš„æ–‡ä»¶æ›´æ–°äº†ä»€ä¹ˆï¼Œæš‚å­˜åŒºåŸŸä¸ä½ æœ€åæäº¤ä¹‹é—´çš„å·®å¼‚-&gt;æš‚å­˜åŒºåŸŸå¿«ç…§å’Œæœ€åä¸€æ¬¡æäº¤ä¹‹é—´çš„å·®å¼‚ git diff --cachedå’Œgit diff --staged(äºŒè€…æ˜¯åŒä¸€ä¸ªæ„æ€) æäº¤æ›´æ–°(git commit) git commit æäº¤ä¸€æ¬¡æ›´æ–°(æš‚å­˜åŒºçš„ä¸€æ¬¡å¿«ç…§)åˆ°æœ¬åœ°ä»“åº“ä¸­ æäº¤çš„æ˜¯æ”¾åœ¨æš‚å­˜åŒºåŸŸçš„å¿«ç…§ ä»»ä½•è¿˜æœªæš‚å­˜çš„ä»ç„¶ä¿æŒå·²ä¿®æ”¹çŠ¶æ€ï¼Œå¯ä»¥åœ¨ä¸‹æ¬¡æäº¤æ—¶çº³å…¥ç‰ˆæœ¬ç®¡ç† æ¯ä¸€æ¬¡è¿è¡Œæäº¤æ“ä½œï¼Œéƒ½æ˜¯å¯¹ä½ é¡¹ç›®ä½œä¸€æ¬¡å¿«ç…§ï¼Œä»¥åå¯ä»¥å›åˆ°è¿™ä¸ªçŠ¶æ€ï¼Œæˆ–è€…è¿›è¡Œæ¯”è¾ƒ git commit -m &quot;[fix] - ä¿®å¤ä¸€ä¸ªbug&quot; æ·»åŠ æäº¤è¯´æ˜ è·³è¿‡æš‚å­˜åŒºåŸŸç›´æ¥æäº¤æ›´æ–°(git commit -a) git commit -a Git å°±ä¼šè‡ªåŠ¨æŠŠæ‰€æœ‰å·²ç»è·Ÿè¸ªè¿‡çš„æ–‡ä»¶æš‚å­˜èµ·æ¥ä¸€å¹¶æäº¤ï¼Œä»è€Œè·³è¿‡ git add æ­¥éª¤ ç§»é™¤æ–‡ä»¶(git rm) git rm &lt;file&gt; ä»æš‚å­˜åŒºå’Œå·¥ä½œåŒºä¸­ç§»é™¤æŸä¸€æ–‡ä»¶ git rm --cached &lt;file&gt; åªä»æš‚å­˜åŒºä¸­ç§»é™¤æŸä¸€æ–‡ä»¶ï¼Œä½†ä¼šä¿ç•™å·¥ä½œåŒºçš„æ–‡ä»¶ ç§»åŠ¨æ–‡ä»¶(git mv) Git ä¸ä¼šæ˜¾ç¤ºè¿½è¸ªæ–‡ä»¶çš„ç§»åŠ¨ï¼Œæ–‡ä»¶ç§»åŠ¨å¯ä»¥åˆ†è§£æˆå¤šä¸ªåŠ¨ä½œ git mv README.md README ç­‰ä»·äºä¸‹é¢ä¸‰ä¸ªåŠ¨ä½œ123$ mv README.md README$ git rm README.md$ git add README æŸ¥çœ‹æäº¤å†å²(git log) git log ä¼šåˆ—å‡ºæ‰€æœ‰æ›´æ–°(æäº¤)ã€‚æœ€è¿‘çš„æ›´æ–°åœ¨æœ€ä¸Šé¢ git log --stat ä¼šé™„å¸¦æ¯æ¬¡æäº¤ç®€ç•¥çš„ç»Ÿè®¡ä¿¡æ¯ git log --pretty=oneline å°†æ¯ä¸ªæäº¤æ”¾åœ¨ä¸€è¡Œï¼Œæ–¹ä¾¿æŸ¥çœ‹ è‡ªå®šä¹‰ pretty æ ¼å¼ git log --pretty=format:&quot;%h - %an, %ar : %s&quot; å¸¸ç”¨é€‰é¡¹123456789101112131415%H æäº¤å¯¹è±¡ï¼ˆcommitï¼‰çš„å®Œæ•´å“ˆå¸Œå­—ä¸²%h æäº¤å¯¹è±¡çš„ç®€çŸ­å“ˆå¸Œå­—ä¸²%T æ ‘å¯¹è±¡ï¼ˆtreeï¼‰çš„å®Œæ•´å“ˆå¸Œå­—ä¸²%t æ ‘å¯¹è±¡çš„ç®€çŸ­å“ˆå¸Œå­—ä¸²%P çˆ¶å¯¹è±¡ï¼ˆparentï¼‰çš„å®Œæ•´å“ˆå¸Œå­—ä¸²%p çˆ¶å¯¹è±¡çš„ç®€çŸ­å“ˆå¸Œå­—ä¸²%an ä½œè€…ï¼ˆauthorï¼‰çš„åå­—%ae ä½œè€…çš„ç”µå­é‚®ä»¶åœ°å€%ad ä½œè€…ä¿®è®¢æ—¥æœŸï¼ˆå¯ä»¥ç”¨ --date= é€‰é¡¹å®šåˆ¶æ ¼å¼ï¼‰%ar ä½œè€…ä¿®è®¢æ—¥æœŸï¼ŒæŒ‰å¤šä¹…ä»¥å‰çš„æ–¹å¼æ˜¾ç¤º%cn æäº¤è€…(committer)çš„åå­—%ce æäº¤è€…çš„ç”µå­é‚®ä»¶åœ°å€%cd æäº¤æ—¥æœŸ%cr æäº¤æ—¥æœŸï¼ŒæŒ‰å¤šä¹…ä»¥å‰çš„æ–¹å¼æ˜¾ç¤º%s æäº¤è¯´æ˜ ä½¿ç”¨å›¾è¡¨å½¢å¼æŸ¥çœ‹ git log --graph é™åˆ¶æ¡ä»¶ git log -2 -&gt; æ˜¾ç¤ºæœ€è¿‘ 2 ä¸ªæäº¤ git log --author=&quot;xxx&quot; -&gt; æŸ¥æ‰¾å¯¹åº”ä½œè€…çš„æäº¤ git log --committer=&quot;xxx&quot; -&gt; æŸ¥æ‰¾å¯¹åº”æäº¤è€…çš„æäº¤ git log --grep=&quot;xxx&quot; -&gt; æŸ¥æ‰¾æœ‰å¯¹åº”å…³é”®è¯çš„æäº¤ git log -Sstringname -&gt; æŸ¥æ‰¾åˆ é™¤/æ·»åŠ äº† stringname å­—ç¬¦ä¸²çš„æäº¤ git log --since=&quot;2018-08-22 21:43&quot; -&gt; ç‰¹å®šæ—¶é—´ç‚¹ä¹‹åçš„æäº¤ å¸¸è§é™åˆ¶é€‰é¡¹ 1234567-(n) ä»…æ˜¾ç¤ºæœ€è¿‘çš„ n æ¡æäº¤--since, --after ä»…æ˜¾ç¤ºæŒ‡å®šæ—¶é—´ä¹‹åçš„æäº¤ã€‚--until, --before ä»…æ˜¾ç¤ºæŒ‡å®šæ—¶é—´ä¹‹å‰çš„æäº¤ã€‚--author ä»…æ˜¾ç¤ºæŒ‡å®šä½œè€…ç›¸å…³çš„æäº¤ã€‚--committer ä»…æ˜¾ç¤ºæŒ‡å®šæäº¤è€…ç›¸å…³çš„æäº¤ã€‚--grep ä»…æ˜¾ç¤ºå«æŒ‡å®šå…³é”®å­—çš„æäº¤-S ä»…æ˜¾ç¤ºæ·»åŠ æˆ–ç§»é™¤äº†æŸä¸ªå…³é”®å­—çš„æäº¤ æ’¤é”€æ“ä½œ Git æ’¤é”€æ˜¯ä¸å¯é€†çš„ é‡æ–°ä¿®æ”¹(è¦†ç›–)ä¸Šæ¬¡commit git commit --amend å¯ä»¥ä¿®æ”¹ä¸Šæ¬¡æäº¤æ—¶çš„ message å¹¶é‡æ–°æäº¤(è¦†ç›–ä¹‹å‰æäº¤)ï¼Œå¦‚æœåœ¨æ­¤å‘½ä»¤ä¹‹å‰æ‰§è¡Œäº†æ·»åŠ æ–‡ä»¶åˆ°æš‚å­˜åŒºçš„æ“ä½œï¼Œåˆ™ä¼šåœ¨æ­¤æ¬¡æäº¤æ—¶å¸¦ä¸Šæ–°æ·»åŠ åˆ°æš‚å­˜åŒºä¸­çš„æ–‡ä»¶ã€‚ 123git commit -m &apos;inital&apos;git add test.txtgit commit --amend åˆ™ test.txt ä¹Ÿä¼šè¢«åŒ…å«åˆ°è¿™æ¬¡æäº¤ä¸­ å°†æŸæ–‡ä»¶ä»æš‚å­˜åŒºä¸­ç§»å‡º git reset HEAD &lt;file&gt;12git add test.txtgit reset HEAD test.txt æ’¤é”€å·¥ä½œåŒºä¸­å¯¹æ–‡ä»¶çš„ä¿®æ”¹(æ”¾å¼ƒæ‰€æœ‰æ›´æ”¹) git checkout -- &lt;file&gt; 12echo test &gt; test.txtgit checkout -- test.txt æœ¬è´¨æ˜¯æ‹¿ä¹‹å‰ä¸€ä¸ªç‰ˆæœ¬çš„æ–‡ä»¶æ¥è¦†ç›–å½“å‰æ–‡ä»¶ è¿œç¨‹ä»“åº“çš„ä½¿ç”¨æŸ¥çœ‹å·²ç»é…ç½®çš„è¿œç¨‹ä»“åº“(git remote) ä½¿ç”¨git remote æŸ¥çœ‹æ‰€æœ‰å·²ç»é…ç½®çš„è¿œç¨‹ä»“åº“çš„ç®€å†™ï¼›é»˜è®¤åä¸ºorigin ä½¿ç”¨git remote -v æŸ¥çœ‹æ‰€æœ‰è¿œç¨‹ä»“åº“çš„ç®€å†™åŠå¯¹åº” url å¦‚æœä½ ä½¿ç”¨ clone å‘½ä»¤å…‹éš†äº†ä¸€ä¸ªä»“åº“ï¼Œå‘½ä»¤ä¼šè‡ªåŠ¨å°†å…¶æ·»åŠ ä¸ºè¿œç¨‹ä»“åº“å¹¶é»˜è®¤ä»¥ originä¸ºç®€å†™ æŸ¥çœ‹è¿œç¨‹ä»“åº“è¯¦ç»†ä¿¡æ¯ ä½¿ç”¨git remote show origin å±•ç¤ºè¿œç¨‹ä»“åº“originçš„è¯¦ç»†ä¿¡æ¯ 123456789101112$ git remote show origin* remote originFetch URL: https://github.com/schacon/ticgitPush URL: https://github.com/schacon/ticgitHEAD branch: masterRemote branches:master trackeddev-branch trackedLocal branch configured for &apos;git pull&apos;:master merges with remote masterLocal ref configured for &apos;git push&apos;:master pushes to master (up to date) ä¼šå‘Šè¯‰ä½ å½“å‰å¤„äº master åˆ†æ”¯ï¼Œä»¥åŠgit pullå’Œgit pushæ—¶å…³è”çš„è¿œç¨‹åˆ†æ”¯ æ·»åŠ è¿œç¨‹ä»“åº“(git remote add) git remote add &lt;shortname&gt; &lt;url&gt; æ·»åŠ ä¸€ä¸ªä»“åº“åœ°å€ä¸ºurl,ç®€å†™åä¸ºshortnameçš„ä»“åº“ ä»è¿œç¨‹ä»“åº“ä¸­æŠ“å–ä¸æ‹‰å– git fetch [remote-repo-short-name] fetchä»…ä»…ä¼šè®¿é—®è¿œç¨‹ä»“åº“ï¼Œä»ä¸­æ‹‰å–æ‰€æœ‰ä½ è¿˜æ²¡æœ‰çš„æ•°æ®(è¿œç¨‹ä»“åº“ä¸­æœ¬åœ°è¿˜æ²¡æœ‰çš„æ•°æ®)ï¼Œå¹¶ä¸ä¼šè·Ÿå½“å‰å·¥ä½œåŒºæ–‡ä»¶è¿›è¡Œåˆå¹¶æˆ–ä¿®æ”¹ä»–ä»¬ã€‚ä»…ä»…æ˜¯æ‹‰å–ä¸‹æ¥ä¾›ä½ æŸ¥çœ‹ å¿…é¡»æ³¨æ„ git fetch å‘½ä»¤ä¼šå°†æ•°æ®æ‹‰å–åˆ°ä½ çš„æœ¬åœ°ä»“åº“ - å®ƒå¹¶ä¸ä¼šè‡ªåŠ¨åˆå¹¶æˆ–ä¿®æ”¹ä½ å½“å‰çš„å·¥ä½œã€‚å½“å‡†å¤‡å¥½æ—¶ä½ å¿…é¡»æ‰‹åŠ¨å°†å…¶åˆå¹¶å…¥ä½ çš„å·¥ä½œã€‚- æ¨é€åˆ°è¿œç¨‹ä»“åº“(git push) git push [remote-repo-short-name] [remote-branch-name] æ¨é€æœ¬åœ°å½“å‰åˆ†æ”¯åˆ°è¿œç¨‹çš„ç‰¹å®šåˆ†æ”¯ä¸Š é»˜è®¤æƒ…å†µä¸‹çœç•¥remote-repo-short-nameå’Œremote-branch-nameæ—¶ï¼Œåˆ™é»˜è®¤æ¨é€åˆ°originçš„masteråˆ†æ”¯ä¸Š123git push// ç­‰ä»·äºgit push origin master ä¿®æ”¹è¿œç¨‹åˆ†æ”¯çš„æœ¬åœ°å¼•ç”¨å ä½¿ç”¨git remote rename &lt;oldName&gt; &lt;newName&gt; 1234$ git remote rename pb paul$ git remoteoriginpaul åˆ‡æ–­æœ¬åœ°ä»“åº“å’Œè¿œç¨‹ä»“åº“ä¹‹é—´çš„å…³è” ä½¿ç”¨git remote rm &lt;remote-repo-short-name&gt; 123$ git remote rm paul$ git remoteorigin æ ‡ç­¾æŸ¥çœ‹æ‰€æœ‰æ ‡ç­¾ ä½¿ç”¨git tag ä¼šåˆ—å‡ºæ‰€æœ‰tagå ä½¿ç”¨æ­£åˆ™ git tag -l &#39;v1.8.*&#39;1234567891011$ git tag -l &apos;v1.8.5*&apos;v1.8.5v1.8.5-rc0v1.8.5-rc1v1.8.5-rc2v1.8.5-rc3v1.8.5.1v1.8.5.2v1.8.5.3v1.8.5.4v1.8.5.5 åˆ›å»ºæ ‡ç­¾ ä½¿ç”¨git tag -a &lt;tagName&gt; -m [messages] 12345$ git tag -a v1.4 -m &apos;my version 1.4&apos;$ git tagv0.1v1.3v1.4 æŸ¥çœ‹æŸä¸€ tag è¯¦ç»†ä¿¡æ¯ ä½¿ç”¨git show &lt;tagName&gt;123456789$ git show v1.4tag v1.4Tagger: Ben Straub &lt;ben@straub.cc&gt;Date: Sat May 3 20:19:12 2014 -0700my version 1.4commit ca82a6dff817ec66f44342007202690a93763949Author: Scott Chacon &lt;schacon@gee-mail.com&gt;Date: Mon Mar 17 21:52:11 2008 -0700changed the version number é’ˆå¯¹æŸæ¬¡æäº¤æ‰“ tag ä½¿ç”¨git tag -a &lt;tagName&gt; &lt;commitHash&gt;12// é’ˆå¯¹9fceb02ç‰ˆæœ¬æ‰“tag$ git tag -a v1.2 9fceb02 æ¨é€ tag åˆ°è¿œç¨‹ä»“åº“ ä½¿ç”¨git push &lt;remote-repo-short-name&gt; [local-tag-name] ç±»ä¼¼æ¨é€åˆ†æ”¯åˆ°è¿œç¨‹ä»“åº“12// æ¨é€æœ¬åœ°çš„v1.5tagåˆ°è¿œç¨‹çš„originä»“åº“$ git push origin v1.5 ä¸€æ¬¡æ¨é€å¤šä¸ª tag åˆ°è¿œç¨‹ä»“åº“ ä½¿ç”¨git push &lt;remote-repo-short-name&gt; --tags12// æŠŠæ‰€æœ‰ä¸åœ¨è¿œç¨‹ä»“åº“æœåŠ¡å™¨ä¸Šçš„æ ‡ç­¾å…¨éƒ¨ä¼ é€åˆ°é‚£é‡Œ$ git push origin --tags æ£€å‡ºæŸä¸€æ ‡ç­¾ ä½¿ç”¨git checkout -b [branchname] [tagname] ç›¸å½“äºé‡æ–°å¼€äº†ä¸€ä¸ªåˆ†æ”¯ 12$ git checkout -b version2 v2.0.0Switched to a new branch &apos;version2&apos; ç»™ Git å‘½ä»¤èµ·åˆ«å é€šè¿‡é…ç½®configæ–‡ä»¶ 123456// å¯ä»¥ç”¨git coä»£æ›¿git checkout$ git config --global alias.co checkout// ç”¨git br ä»£æ›¿ git branch$ git config --global alias.br branch$ git config --global alias.ci commit$ git config --global alias.st status Git åˆ†æ”¯æœªå®Œå¾…ç»­]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[oop-basic-in-js]]></title>
    <url>%2F2018%2F04%2F27%2Foop-basic-in-js%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘åœ¨å¤ä¹ åŸºç¡€çŸ¥è¯†ï¼Œç‰¹å¯¹jsé¢å‘å¯¹è±¡ç›¸å…³çŸ¥è¯†åšä¸ªè®°å½• jsä¸­çš„é¢å‘å¯¹è±¡ç¼–ç¨‹åŸºç¡€çŸ¥è¯†åˆ›å»ºå¯¹è±¡å­—é¢é‡æ¨¡å¼ æœ€ç®€å•ä¹Ÿæ˜¯æœ€å¸¸ç”¨åˆ›å»ºç®€å•å¯¹è±¡çš„æ–¹å¼ 12345678var personCgh=&#123; name:'cgh', age:'18', sex:'boy', sayName:function()&#123; alert(this.name); &#125;&#125;; ç¼ºç‚¹ å¦‚æœéœ€è¦åˆ›å»ºå¤§é‡ç±»ä¼¼çš„å¯¹è±¡ï¼Œä¼šäº§ç”Ÿå¤§é‡é‡å¤ä»£ç  å·¥å‚æ¨¡å¼ æŠ½è±¡(å°è£…)åˆ›å»ºå…·ä½“å¯¹è±¡çš„è¿‡ç¨‹ 123456789101112function createPersonFactory(name,age,sex)&#123; var o=new Object(); o.name=name; o.age=age; o.sex=sex; o.sayName=function()&#123; alert(this.name); &#125;; return o;&#125;var personCgh=createPersonFactory('cgh',18,'boy'); è§£å†³äº†å­—é¢é‡æ¨¡å¼åˆ›å»ºå¤šä¸ªç±»ä¼¼å¯¹è±¡çš„é—®é¢˜ ç¼ºç‚¹ æ— æ³•çŸ¥é“ä¸€ä¸ªå¯¹è±¡çš„ç±»å‹ æ„é€ å‡½æ•°æ¨¡å¼ é€šè¿‡åˆ›å»ºè‡ªå®šä¹‰æ„é€ å‡½æ•°å¹¶é€šè¿‡newæ¥åˆ›å»ºå®ä¾‹ 12345678910111213function Person(name,age,sex)&#123; this.name=name; this.age=age; this.sex=sex; this.sayName=function()&#123; alert(this.name); &#125;;&#125;var personCgh=new Person('cgh',18,'boy');personCgh instanceof Person; // truepersonCgh instanceof Object; // true ç¼ºç‚¹ æ¯ä¸ªæ–¹æ³•éƒ½éœ€è¦åœ¨å®ä¾‹ä¸Šé‡æ–°åˆ›å»ºä¸€é åŸå‹æ¨¡å¼ æ¯ä¸ªå‡½æ•°åœ¨åˆ›å»ºæ—¶éƒ½ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåŸå‹(prototype)å±æ€§ï¼ŒæŒ‡å‘å‡½æ•°çš„åŸå‹å¯¹è±¡;åŸå‹å¯¹è±¡ä¼šè‡ªåŠ¨è·å¾—ä¸€ä¸ªconstructorå±æ€§æŒ‡å‘prototypeå±æ€§æ‰€åœ¨çš„å‡½æ•°ï¼› å®ä¾‹å¯¹è±¡ã€æ„é€ å‡½æ•°ã€åŸå‹å¯¹è±¡ä¸‰è€…å…³ç³» æ„é€ å‡½æ•°è¢«åˆ›å»ºæ—¶ï¼Œä¼šæœ‰ä¸€ä¸ªprototypeå±æ€§æŒ‡å‘åŸå‹å¯¹è±¡ åŸå‹å¯¹è±¡é€šè¿‡constructoråå‘æŒ‡å›æ„é€ å‡½æ•° æ„é€ å‡½æ•°é€šè¿‡å®ä¾‹åŒ–è¿‡ç¨‹(newè¿‡ç¨‹)åˆ›å»ºå®ä¾‹å¯¹è±¡ å®ä¾‹å¯¹è±¡é€šè¿‡å†…éƒ¨[[prototype]]æˆ–è€…__proto__å±æ€§(ä¸å¯ç›´æ¥è®¿é—®)æŒ‡å‘åŸå‹å¯¹è±¡12345678910111213141516171819202122function Person()&#123;&#125;Person.prototype=&#123; constructor:Person,// å› ä¸ºå®Œå…¨é‡å†™äº†prototypeå¯¹è±¡ï¼Œæ‰€ä»¥å¿…é¡»å®šä¹‰constructoræŒ‡å‘ name:'cgh', age:18, sex:'boy', friends:['a','b'], sayName:function()&#123; alert(this.name) &#125;&#125;;var personCgh=new Person();var personYg=new Person();personCgh.friends.push('c');personCgh.friends; // ['a','b','c']personYg.friends; // ['a','b','c']personCgh.name === personYg.name; // true ç¼ºç‚¹ ä¼šå­˜åœ¨å…±äº«å¼•ç”¨å€¼çš„é—®é¢˜ ç»„åˆä½¿ç”¨æ„é€ å‡½æ•°æ¨¡å¼å’ŒåŸå‹æ¨¡å¼ ä½¿ç”¨æ„é€ å‡½æ•°åˆ›å»ºå®ä¾‹å±æ€§ï¼Œç”¨åŸå‹æ¨¡å¼åˆ›å»ºå…±äº«çš„æ–¹æ³•å’Œå±æ€§ å¸¸ç”¨æ¨¡å¼12345678910111213141516171819function Person(name,age,job)&#123; this.name=name; this.age=age; this.job=job; this.friends=['a','b'];&#125;Person.prototype=&#123; constructor:Person, sayName:function()&#123; alert(this.name); &#125;&#125;;var personCgh=new Person('cgh',18,'boy');var personYg=new Person('yg',14,'boy');personCgh.friends.push('c'); // ['a','b','c']personYg.friends; // ['a','b'] newçš„è¿‡ç¨‹ new Fnæ“ä½œç¬¦ä¸»è¦å®Œæˆäº†ä¸‹é¢å‡ ä»¶äº‹æƒ… åˆ›å»ºä¸€ä¸ªæ–°çš„ç©ºå¯¹è±¡tempObjï¼Œç©ºå¯¹è±¡çš„é»˜è®¤åŸå‹å¯¹è±¡(__proto__)ä¸ºObject.prototype è®¾ç½®ç©ºå¯¹è±¡çš„__proto__æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼› è°ƒç”¨æ„é€ å‡½æ•°ï¼Œæ„é€ å‡½æ•°çš„thisæŒ‡å‘tempObjï¼› å¦‚æœæ„é€ å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªénullçš„å¼•ç”¨ç±»å‹çš„å¯¹è±¡ï¼Œåˆ™ç”¨æ­¤å¯¹è±¡æ›¿ä»£tempObjæˆä¸ºnewæ“ä½œçš„è¿”å›å¯¹è±¡ newä¼šå°†è¿”å›å¯¹è±¡çš„__proto__æŒ‡å‘æ„é€ å‡½æ•°çš„.prototypeå¯¹è±¡12345678910111213function Test()&#123; this.name='test';&#125;var test=new Test();// new Testå®é™…æ‰§è¡Œçš„ä¼ªä»£ç ...&#123; var temp=&#123;&#125;;// åˆ›å»ºä¸´æ—¶å¯¹è±¡ temp.__proto__=Test.prototype;// æ”¹å˜__ptoto__æŒ‡å‘ var ret=Test.call(tempObj); return ret!==null &amp;&amp; (typeof ret === 'object'|| typeof ret === 'function') ? ret : temp ;// å¦‚æœæ„é€ å‡½æ•°è°ƒç”¨åè¿”å›çš„æ˜¯énullçš„å¼•ç”¨ç±»å‹ï¼Œåˆ™ç”¨å…¶æ›¿ä»£tempåšä¸ºnewæ“ä½œç¬¦çš„è¿”å›å€¼&#125; ç»§æ‰¿ä½¿ç”¨åŸå‹é“¾å®ç°ç»§æ‰¿ è®©ä¸€ä¸ªç±»(æ„é€ å‡½æ•°ï¼ŒåŸºç±»)çš„åŸå‹å¯¹è±¡æŒ‡å‘å¦ä¸€ä¸ªç±»(æ„é€ å‡½æ•°ï¼Œçˆ¶ç±»)çš„å®ä¾‹å³å¯ 123456789101112131415161718192021function SuperType()&#123; this.property=true;&#125;SuperType.prototype.getSuperValue=function()&#123; return this.property;&#125;;function SubType()&#123; this.subProperty=false;&#125;// ç»§æ‰¿çˆ¶ç±» åŸºç±»çš„åŸå‹å¯¹è±¡æŒ‡å‘çˆ¶ç±»çš„ä¸€ä¸ªå®ä¾‹SubType.prototype=new SuperType();SubType.prototype.getSubVaule=function()&#123; return this.subProperty;&#125;;var instance=new SubType();instance.getSuperValue();// true å¦‚æœåŸºç±»è¦è¦†ç›–çˆ¶ç±»æ–¹æ³•ä¸€å®šè¦åœ¨ç»§æ‰¿ä¹‹åå†è¦†ç›– ç¼ºç‚¹ çˆ¶ç±»ä¸Šå®šä¹‰çš„å¼•ç”¨ç±»å‹å€¼å°†ä¼šè¢«å…±äº« æ— æ³•åœ¨ä¸å½±å“æ‰€æœ‰å¯¹è±¡å®ä¾‹çš„åŸºç¡€ä¸Šï¼Œç»™çˆ¶ç±»çš„æ„é€ å‡½æ•°ä¼ é€’å‚æ•° å€Ÿç”¨æ„é€ å‡½æ•°å®ç°ç»§æ‰¿ é€šè¿‡åœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¸­è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°æ¥å®ç°ç»§æ‰¿ 12345678910111213141516function SuperType(name)&#123; this.colors=['red','blue'] this.name=name;&#125;function SubType()&#123; SuperType.call(this);&#125;var instance1=new SubType('cgh');instance1.colors.push('green');var instance2=new SubType('yg');instance1.colors;// ['red','blue','green']instance2.colors;// ['red','blue'] ç¼ºç‚¹ æ–¹æ³•éƒ½å°†åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰ï¼Œæ— æ³•å®ç°æ–¹æ³•çš„å¤ç”¨ ç»„åˆç»§æ‰¿ å€Ÿç”¨æ„é€ å‡½æ•°+åŸå‹é“¾ ä½¿ç”¨åŸå‹é“¾å®ç°å¯¹åŸå‹å±æ€§ã€æ–¹æ³•çš„ç»§æ‰¿ï¼Œä½¿ç”¨å€Ÿç”¨æ„é€ å‡½æ•°å®ç°å®ä¾‹å±æ€§çš„ç»§æ‰¿1234567891011121314151617181920212223242526272829303132333435function SuperType(name)&#123; this.name=name; this.colors=['red','blue'];&#125;SuperType.prototype.sayName=function()&#123; alert(this.name);&#125;;function SubType(name,age)&#123; // ç»§æ‰¿å±æ€§ SuperType.call(this,name); this.age=age;&#125;// ç»§æ‰¿æ–¹æ³•SubType.prototype=new SuperType();SubType.prototype.constructor=SubType;SubType.prototype.sayAge=function()&#123; alert(this.age);&#125;;var instance1=new SubType('cgh',20);instance1.colors.push('green');instance1.colors;// ['red','blue','green'];instance1.sayName();// 'cgh'instance1.sayAge();// 20var instance2=new SubType('yg',18);instance1.colors.push('pink');instance1.colors;// ['red','blue','pink'];instance1.sayName();// 'yg'instance1.sayAge();// 18 åŸå‹ç»§æ‰¿ é€šè¿‡æ”¹å˜å¯¹è±¡å†…éƒ¨çš„__proto__æŒ‡é’ˆæ¥å®ç° ä¸éœ€è¦æ˜¾ç¤ºçš„åˆ›å»ºæ„é€ å‡½æ•° æ€è·¯ç›´æ¥ä»¥ä¸€ä¸ªå¯¹è±¡ä¸ºåŸå‹ï¼Œä»å…¶å…‹éš†å‡ºä¸€ä¸ªæ–°å¯¹è±¡ 123456789function object(o)&#123; function F()&#123;&#125; F.prototype=o;// æŒ‡å®šåŸå‹å¯¹è±¡ return new F();// é€šè¿‡new è°ƒç”¨å°†è¿”å›å¯¹è±¡çš„__proto__æŒ‡å‘F.prototypeå³o &#125;// æœ¬è´¨æ˜¯å°†è¿”å›å¯¹è±¡çš„__proto__æŒ‡å‘äº†ä¼ å…¥å¯¹è±¡var returnObj=object(testObj);returnObj.__proto__===testObj;//true es5å¯¹è¿™ç§æ–¹å¼åšäº†æ ‡å‡†åŒ–ã€‚ç›´æ¥ä½¿ç”¨Object.create()æ¥å®ç° 12345678910var a=&#123; name:'cgh', sayName:function()&#123; alert(this.name); &#125; &#125;;var b=Object.create(a);b.name='yg';b.sayName();// yg å®ç°ç»§æ‰¿çš„æœ¬è´¨ jsä¸­å®ç°ç»§æ‰¿çš„å…³é”®åœ¨__proto__è¿™ä¸ªå†…éƒ¨æŒ‡é’ˆ é¦–å…ˆåŸºç¡€çŸ¥è¯† jsä¸­ä¸‡ç‰©éƒ½æ˜¯å¯¹è±¡ï¼Œæ²¡æœ‰å®é™…çš„ç±»(å¯ä»¥é æ¨¡æ‹Ÿå®ç°ç±»çš„æ•ˆæœ)ã€å‡½æ•°ã€æ„é€ å‡½æ•°(æœ¬è´¨å°±æ˜¯æ™®é€šå‡½æ•°)ã€åŸå‹å¯¹è±¡(xxx.prototype)ï¼Œè¿™äº›éƒ½æ˜¯å¯¹è±¡ æ¯ä¸ªå¯¹è±¡éƒ½æœ‰__proto__è¿™ä¸ªå†…éƒ¨æŒ‡é’ˆ æ¯ä¸ªå‡½æ•°éƒ½æœ‰.prototypeè¿™ä¸ªå±æ€§ æ‰€æœ‰å‡½æ•°éƒ½æ˜¯å¯¹è±¡ï¼›æ‰€ä»¥å‡½æ•°æ—¢æœ‰__proto__ä¹Ÿæœ‰.prototype å†…éƒ¨é€šè¿‡__proto__æ¥æ„å»ºåŸå‹é“¾å®ç°ç±»ä¼¼ç»§æ‰¿æ•ˆæœï¼Œå³æ–¹æ³•å±æ€§çš„æŸ¥æ‰¾é€šè¿‡__proto__é“¾æ¥ä¸€å±‚å±‚æŸ¥æ‰¾;(ç±»ä¼¼ä½œç”¨åŸŸé“¾çš„å›æº¯æŸ¥æ‰¾) æ‰€æœ‰åŸå‹é“¾æœ€åç«¯éƒ½æ˜¯Object.prototypeï¼ŒObject.prototypeè¿™ä¸ªå¯¹è±¡çš„__proto__åˆ™æŒ‡å‘äº†null __proto__å’Œfn.prototypeä¸ä¸€æ ·ï¼Œå‰è€…æ‰æ˜¯å®ç°ç»§æ‰¿çš„å…³é”®ï¼Œåè€…åªæ˜¯ä¸ºäº†æ¨¡æ‹Ÿä¼ ç»Ÿç±»ç»§æ‰¿è€Œè¡ç”Ÿå‡ºæ¥æ–¹ä¾¿è¡¨è¾¾çš„å±æ€§ã€‚å¯ä»¥å½“ä½œä¸€ä¸ªæ™®é€šå¯¹è±¡å¯¹å¾…(ä½†å®ƒåˆæœ‰ä¸åŒï¼Œå®ƒé»˜è®¤è‡ªå¸¦constructoræŒ‡å›å‡½æ•°)12345678910111213141516171819202122232425262728293031323334var o = &#123;a: 1&#125;;// o è¿™ä¸ªå¯¹è±¡ç»§æ‰¿äº†Object.prototypeä¸Šé¢çš„æ‰€æœ‰å±æ€§// o è‡ªèº«æ²¡æœ‰åä¸º hasOwnProperty çš„å±æ€§// hasOwnProperty æ˜¯ Object.prototype çš„å±æ€§// å› æ­¤ o ç»§æ‰¿äº† Object.prototype çš„ hasOwnProperty// Object.prototype çš„åŸå‹ä¸º null// åŸå‹é“¾å¦‚ä¸‹:// o ---&gt; Object.prototype ---&gt; null// o.__proto___===Object.prototype;// true// Object.prototype.__proto__===null;// truevar a = ["yo", "whadup", "?"];// æ•°ç»„éƒ½ç»§æ‰¿äº Array.prototype // (Array.prototype ä¸­åŒ…å« indexOf, forEachç­‰æ–¹æ³•)// åŸå‹é“¾å¦‚ä¸‹:// a ---&gt; Array.prototype ---&gt; Object.prototype ---&gt; null// a.__proto__===Array.prototype;// true// Array.prototype.__proto__===Object.prototype;// true// Object.prototype.__proto__===null;// truefunction f()&#123; return 2;&#125;// å‡½æ•°éƒ½ç»§æ‰¿äºFunction.prototype// (Function.prototype ä¸­åŒ…å« call, bindç­‰æ–¹æ³•)// åŸå‹é“¾å¦‚ä¸‹:// f ---&gt; Function.prototype ---&gt; Object.prototype ---&gt; null// f.__proto__===Function.prototype;// true// Function.prototype.__proto__===Object.prototype;// true// Object.prototype.__proto__===null;// true jsä¸­ä¸‡ç‰©éƒ½æ˜¯å¯¹è±¡ï¼Œä¸ä¸€å®šéè¦æ¨¡æ‹Ÿä¼ ç»Ÿè¯­è¨€å…ˆæœ‰ç±»(æ¨¡æ¿)å†åˆ›å»ºå®ä¾‹çš„å½¢å¼æ¥å®ç°ç»§æ‰¿æ•ˆæœå‘¢ï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥ç”¨ä¸€ä¸ªå¯¹è±¡åšä¸ºæ¨¡æ¿ï¼Œç›´æ¥å…‹éš†å‡ºå¦ä¸€ä¸ªç±»ä¼¼å¯¹è±¡å‘¢?jså†…éƒ¨é€šè¿‡__proto_ï¼Œæ¥å®ç°ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´çš„å…³è”(å§”æ‰˜)å…³ç³»ï¼Œè¿›è€Œå®ç°ç±»ä¼¼ç»§æ‰¿çš„æ•ˆæœã€‚ åŸå‹ç»§æ‰¿å’ŒObject.create()éƒ½æ˜¯ç±»ä¼¼æ€æƒ³ï¼Œç›´æ¥é€šè¿‡å»ºç«‹ä¸¤ä¸ªå¯¹è±¡é—´çš„å§”æ‰˜å…³ç³»ï¼Œå®ç°ç»§æ‰¿æ•ˆæœ12345678910var a=&#123; name:'cgh', sayName:function()&#123; alert(this.name); &#125; &#125;;var b=Object.create(a);b.name='yg';b.sayName();// yg __proto__æ˜¯ä¸€ä¸ªå†…éƒ¨å±æ€§ï¼Œes6å¯¹å…¶åšäº†è§„èŒƒå¯ä»¥é€šè¿‡Object.getPrototypeOfå’Œå¯¹åº”çš„Object.setPrototypeOfæ¥æ“ä½œ__proto__ å‚è€ƒé“¾æ¥https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chainhttps://www.zhihu.com/question/34183746]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>oop</tag>
        <tag>é¢å‘å¯¹è±¡</tag>
        <tag>åˆ›å»ºå¯¹è±¡</tag>
        <tag>ç»§æ‰¿</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[design-pattern]]></title>
    <url>%2F2018%2F04%2F25%2Fdesign-pattern%2F</url>
    <content type="text"><![CDATA[æ­¤æ–‡æ˜¯ã€ŠJavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µã€‹çš„è¯»ä¹¦ç¬”è®°æœ¬æ–‡æ‰€æœ‰æºç å¯åœ¨è¿™é‡Œæ‰¾åˆ° JavaScriptè®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µåŸºç¡€çŸ¥è¯†é¸­å­ç±»å‹1234567891011121314151617181920212223242526272829303132333435363738&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // é¸­å­ç±»å‹ // å¦‚æœå®ƒèµ°èµ·æ¥åƒé¸­å­ï¼Œå«èµ·æ¥ä¹Ÿåƒé¸­å­ï¼Œé‚£å®ƒå°±æ˜¯é¸­å­ // é¸­å­ç±»å‹æŒ‡å¯¼æˆ‘ä»¬åªå…³æ³¨å¯¹è±¡çš„è¡Œä¸ºï¼Œè€Œä¸å…³æ³¨å¯¹è±¡æœ¬èº« var duck = &#123; duckSinging: function() &#123; console.log("å˜å˜"); &#125; &#125;; var chicken = &#123; duckSinging: function() &#123; console.log("å˜å˜"); &#125; &#125;; // åˆå”±å›¢ var choir = []; var joinChoir = function(animal) &#123; if (animal &amp;&amp; typeof animal.duckSinging === "function") &#123; choir.push(animal); console.log("æ­å–œåŠ å…¥åˆå”±å›¢"); console.log("åˆå”±å›¢å½“å‰äººæ•°:" + choir.length); &#125; &#125;; joinChoir(duck); joinChoir(chicken); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å¤šæ€12345678910111213141516171819202122232425262728&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // å¤šæ€:åŒä¸€æ“ä½œåº”ç”¨åœ¨ä¸åŒçš„å¯¹è±¡ä¸Šé¢ï¼Œå¯ä»¥äº§ç”Ÿä¸åŒçš„è§£é‡Šå’Œä¸åŒçš„æ‰§è¡Œç»“æœ // å³ç»™ä¸åŒçš„å¯¹è±¡å‘é€åŒä¸€ä¸ªæ¶ˆæ¯çš„æ—¶å€™ï¼Œè¿™äº›å¯¹è±¡ä¼šæ ¹æ®è¿™ä¸ªæ¶ˆæ¯åˆ†åˆ«ç»™å‡ºä¸åŒçš„åé¦ˆ var makeSound = function(animal) &#123; if (animal instanceof Duck) &#123; console.log("å˜å˜"); &#125; else if (animal instanceof Chicken) &#123; console.log("å’¯å’¯"); &#125; &#125;; var Duck = function() &#123;&#125;; var Chicken = function() &#123;&#125;; makeSound(new Duck()); makeSound(new Chicken()); // è¿™é‡Œæ˜¯ä¸ä¼˜é›…çš„ï¼Œå› ä¸ºå¦‚æœå†æ¥ä¸€æ¡ç‹—ï¼Œéœ€è¦ä¿®æ”¹makeSound &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å¤šæ€212345678910111213141516171819202122232425262728293031323334353637383940414243&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // å¤šæ€èƒŒåæ˜¯å°†"åšä»€ä¹ˆ"å’Œ"è°å»åšï¼Œæ€ä¹ˆåš"åˆ†ç¦»å¼€æ¥ï¼Œå³å°†ä¸å˜çš„å’Œå¯å˜çš„åˆ†ç¦»å¼€æ¥ // æŠŠä¸å˜çš„éš”ç¦»å‡ºæ¥ï¼ŒæŠŠå¯å˜çš„éƒ¨åˆ†å°è£…èµ·æ¥,å«æ˜¯ä¸å˜çš„ï¼ŒåŠ¨ç‰©æ€ä¹ˆå«æ˜¯å¯å˜çš„ // éš”ç¦»å‡ºä¸å˜çš„ var makeSound = function(animal) &#123; animal.sound(); &#125;; // å°è£…å¯å˜çš„ var Duck = function() &#123;&#125;; Duck.prototype.sound = function() &#123; console.log("å˜å˜"); &#125;; var Chicken = function() &#123;&#125;; Chicken.prototype.sound = function() &#123; console.log("å’¯å’¯"); &#125;; makeSound(new Duck()); makeSound(new Chicken()); // æ·»åŠ æ–°åŠ¨ç‰© var Dog = function() &#123;&#125;; Dog.prototype.sound = function() &#123; console.log("æ±ªæ±ª"); &#125;; makeSound(new Dog()); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å¤šæ€31234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; var googleMap = &#123; show: function() &#123; console.log('å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾'); &#125; &#125;; var baiduMap = &#123; show: function() &#123; console.log('å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾'); &#125; &#125;; var renderMap = function(type) &#123; if (type === 'google') &#123; googleMap.show(); &#125; else if (type === 'baidu') &#123; baiduMap.show(); &#125; &#125;; renderMap('google'); // è¾“å‡ºï¼šå¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾ renderMap('baidu'); // è¾“å‡ºï¼šå¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾ // å¦‚æœæ·»åŠ å…¶ä»–åœ°å›¾ï¼Œåˆ™éœ€è¦åœ¨renderMapä¸­ç»§ç»­åˆ¤æ–­ï¼Œè¿™é‡Œæ˜¾ç¤ºåœ°å›¾æ˜¯ä¸å˜çš„ï¼Œæ˜¾ç¤ºå“ªä¸ªï¼Œæ€ä¹ˆæ˜¾ç¤ºæ˜¯å¯å˜çš„ï¼Œæ‰€ä»¥å¯å°†showéš”ç¦»(æå–)å‡ºæ¥ var renderMap2 = function(map) &#123; if (map.show instanceof Function) &#123; map.show(); &#125; &#125;; // æ·»åŠ å…¶ä»–åœ°å›¾ var sosoMap = &#123; show: function() &#123; console.log("å¼€å§‹æ¸²æŸ“Sosoåœ°å›¾"); &#125; &#125;; renderMap2(googleMap); // è¾“å‡ºï¼šå¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾ renderMap2(baiduMap); // è¾“å‡ºï¼šå¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾ renderMap2(sosoMap); // è¾“å‡º:å¼€å§‹æ¸²æŸ“Sosoåœ°å›¾ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å°è£…æ•°æ®123456789101112131415161718192021222324252627&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // jsä¸€èˆ¬é€šè¿‡å‡½æ•°æ¥åˆ›å»ºä½œç”¨åŸŸæ¥å°è£…æ•°æ® var myObj = (function() &#123; // ç§æœ‰å˜é‡ var _name = "haha"; return &#123; // å…¬å¼€æ–¹æ³• getName: function() &#123; return _name; &#125; &#125; &#125;)(); console.log(myObj.getName()); // "haha" console.log(myObj._name); // undefined &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å°è£…å®ç°1234567891011121314151617&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // å°è£…å®ç°ï¼Œä¾‹å¦‚sort()å‡½æ•°çš„å…·ä½“å®ç°ä½ å¹¶ä¸çŸ¥é“ï¼Œå®ƒå¯¹å¤–ç•Œæ¥è¯´æ˜¯é€æ˜çš„ï¼Œä¸å¯è§çš„ var arr = [1, 3, 5, 2, 4, 9, 7]; console.log(arr.sort()); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; åŸå‹æ¨¡å¼1234567891011121314151617181920212223242526272829303132333435363738394041&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // åŸå‹æ¨¡å¼æ˜¯ç”¨æ¥åˆ›å»ºå¯¹è±¡çš„ä¸€ç§æ¨¡å¼ï¼Œå¦‚æœæƒ³åˆ›å»ºä¸€ä¸ªå¯¹è±¡æœ‰2ç§æ–¹æ³• // 1.å…ˆæŒ‡å®šç±»å‹ï¼Œç„¶åé€šè¿‡ç±»å‹åˆ›å»ºå¯¹è±¡ // 2.æ‰¾åˆ°ä¸€ä¸ªå¯¹è±¡åšä¸ºåŸå‹ï¼Œé€šè¿‡å…‹éš†åˆ›å»ºä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„å¯¹è±¡ // åŸå‹æ¨¡å¼æ˜¯é€‰ç”¨çš„ç¬¬äºŒç§ // ä½¿ç”¨åœºæ™¯:åˆ›å»ºä¸€ä¸ªè·ŸæŸä¸ªå¯¹è±¡ä¸€æ¨¡ä¸€æ ·çš„å¯¹è±¡æ—¶ // å®ç°å…³é”®:è¯­è¨€æœ¬èº«æ˜¯å¦æä¾›äº†å…‹éš†çš„æ–¹æ³•,jsä¸­å¯ç”¨Object.create() var Plane = function() &#123; this.blood = 100; this.attackLevel = 1; this.defenseLevel = 1; &#125;; var plane = new Plane(); plane.blood = 500; plane.attackLevel = 3; plane.defenseLevel = 4; // Object.createçš„å…¼å®¹ Object.create = Object.create || function(obj) &#123; var F = function() &#123;&#125;; F.prototype = obj; return new F(); &#125;; // å…‹éš† var clonePlane = Object.create(plane); console.log(clonePlane); console.log(clonePlane.blood); console.log(clonePlane.attackLevel); console.log(clonePlane.defenseLevel); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; this1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // jsä¸­thisæ˜¯åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶æ‰ç¡®å®šçš„ï¼Œå®ƒæ˜¯æŒ‡å‘è¢«è°ƒç”¨æ—¶çš„æ‰§è¡Œç¯å¢ƒ // 1.å…¨å±€ç¯å¢ƒä¸‹this-&gt;window console.log(this); // window // 2.å½“å‡½æ•°åšä¸ºå¯¹è±¡æ–¹æ³•è°ƒç”¨æ—¶,thisæŒ‡å‘æ­¤å¯¹è±¡ var a = &#123; name: "aaaa", getName: function() &#123; console.log(this.name); &#125; &#125;; a.getName(); // aaaa (a.getName)(); // aaaa (a.getName = a.getName)(); // ç©º (a.getName || a.getName)(); // ç©º (a.getName, a.getName)(); // ç©º // æ³¨æ„thisæ˜¯æŒ‡å‘æœ€é è¿‘æ–¹æ³•çš„å¯¹è±¡ var b = &#123; name: "bbbb" &#125;; b.bar = a; b.bar.getName(); // aaaa // 3.åŒ¿åå‡½æ•°çš„æ‰§è¡Œç¯å¢ƒå…·æœ‰å…¨å±€æ€§ï¼Œæ‰€ä»¥thisé€šå¸¸æŒ‡å‘window (function() &#123; console.log(this); // window &#125;)(); // 4.åšä¸ºæ„é€ å™¨è°ƒç”¨æ—¶,thisæŒ‡å‘è¢«æ–°åˆ›å»ºçš„å¯¹è±¡ var Person = function(name) &#123; this.name = name; &#125;; var person = new Person("haha"); console.log(person.name); // 5.Function.prototype.call æˆ–Function.prototype.apply å¯ä»¥åŠ¨æ€åœ°æ”¹å˜ä¼ å…¥å‡½æ•°çš„this a.getName.call(b); // bbbb ç›¸å½“äºb.getName() a.getName.apply(b); // bbbb ç›¸å½“äºb.getName() &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; callã€apply123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // callã€applyéƒ½å¯ä»¥æ”¹å˜å‡½æ•°ä¸­thisçš„æŒ‡å‘ // ç¬¬ä¸€ä¸ªå‚æ•°éƒ½æŒ‡å®šäº†å‡½æ•°ä½“å†…thisçš„æŒ‡å‘ï¼Œå¦‚æœä¼ å…¥null,åˆ™ä»£è¡¨åœ¨å…¨å±€ç¯å¢ƒä¸‹è°ƒç”¨ã€‚applyçš„ç¬¬äºŒä¸ªå‚æ•°ä¸ºå¸¦ä¸‹æ ‡çš„é›†åˆ(ç±»æ•°ç»„),callå‚æ•°ä¸ªæ•°ä¸é™åˆ¶ï¼Œä¼šæŒ‰é¡ºåºä¾ä¾å¯¹åº”åˆ°å½¢å‚ä¸Š var func = function(a, b, c) &#123; console.log([a, b, c]); &#125;; func.apply(null, [1, 2, 3]); // è¾“å‡º [ 1, 2, 3 ] func.call(null, 1, 2, 3); // è¾“å‡º [ 1, 2, 3 ] // callã€applyé€šå¸¸ç”¨æ¥å®ç°å‡½æ•°å€Ÿç”¨ï¼Œç”¨æ¥åœ¨ç±»æ•°ç»„(arguments)ä¸Šè°ƒç”¨æ•°ç»„çš„æ–¹æ³• // å‡½æ•°çš„å‚æ•°åˆ—è¡¨arguments æ˜¯ä¸€ä¸ªç±»æ•°ç»„å¯¹è±¡ï¼Œè™½ç„¶å®ƒä¹Ÿæœ‰â€œä¸‹æ ‡â€ï¼Œä½†å®ƒå¹¶éçœŸæ­£çš„æ•°ç»„ï¼Œæ‰€ä»¥ä¹Ÿä¸èƒ½åƒæ•°ç»„ä¸€æ ·ï¼Œè¿›è¡Œæ’åºæ“ä½œæˆ–è€…å¾€é›†åˆé‡Œæ·»åŠ ä¸€ä¸ªæ–°çš„å…ƒç´  // argumentsè½¬æˆçœŸæ­£çš„æ•°ç»„çš„æ—¶å€™ï¼Œå¯ä»¥å€Ÿç”¨Array.prototype.sliceæ–¹æ³• // æƒ³æˆªå–argumentsåˆ—è¡¨ä¸­çš„å¤´ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œå¯ä»¥å€Ÿç”¨Array.prototype.shiftæ–¹æ³•ã€‚ (function() &#123; Array.prototype.push.call(arguments, 6); console.log(arguments); // è¾“å‡º[4,5,6] &#125;)(4, 5); // é€šè¿‡callã€applyå®ç°ç»‘å®šthis Function.prototype.bind = function() &#123; var self = this, // ä¿å­˜åŸå‡½æ•° context = [].shift.call(arguments), // éœ€è¦ç»‘å®šçš„thisä¸Šä¸‹æ–‡,argumentsä¸Šä¸ºshiftæ–¹æ³•ï¼Œé€šè¿‡callæ¥å®ç°è°ƒç”¨æ•°ç»„çš„shiftæ–¹æ³• args = [].slice.call(arguments); // å‰©ä½™çš„å‚æ•°è½¬æˆæ•°ç»„ return function() &#123; // è¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•° return self.apply(context, [].concat.call(args, [].slice.call(arguments))); // æ‰§è¡Œæ–°çš„å‡½æ•°çš„æ—¶å€™ï¼Œä¼šæŠŠä¹‹å‰ä¼ å…¥çš„context å½“ä½œæ–°å‡½æ•°ä½“å†…çš„this // å¹¶ä¸”ç»„åˆä¸¤æ¬¡åˆ†åˆ«ä¼ å…¥çš„å‚æ•°ï¼Œä½œä¸ºæ–°å‡½æ•°çš„å‚æ•° &#125; &#125;; var obj = &#123; name: 'sven' &#125;; var func = function(a, b, c, d) &#123; alert(this.name); // è¾“å‡ºï¼šsven alert([a, b, c, d]) &#125;.bind(obj, 1, 2); // å°†funcä¸­çš„thisç»‘å®šåˆ°objä¸Šï¼Œå¹¶ä¼ å…¥äº†é»˜è®¤å‚æ•° func(3, 4); // è¾“å‡ºï¼š[ 1, 2, 3, 4 ] &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; é—­åŒ…123456789101112131415161718192021222324252627282930313233343536&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;div&gt;1&lt;/div&gt; &lt;div&gt;2&lt;/div&gt; &lt;div&gt;3&lt;/div&gt; &lt;div&gt;4&lt;/div&gt; &lt;div&gt;5&lt;/div&gt; &lt;script&gt; // å‡½æ•°ä¸­å£°æ˜å¦å¤–ä¸€ä¸ªå‡½æ•°å°±ä¼šå‡ºç°é—­åŒ… // ç»å…¸æ¡ˆä¾‹ï¼Œæ¯ä¸ªéƒ½å¼¹å‡º5 var nodes = document.getElementsByTagName('div'); // for (var i = 0, len = nodes.length; i &lt; len; i++) &#123; // nodes[i].onclick = function() &#123; // alert(i); // &#125;; // &#125;; // è¿™æ˜¯å› ä¸ºonclickäº‹ä»¶æ˜¯å¼‚æ­¥è§¦å‘çš„ï¼Œå½“è§¦å‘æ—¶forå¾ªç¯æ—©ç»“æŸäº†ï¼Œiå·²ç»å˜æˆ5äº†ï¼Œæ‰€ä»¥äº‹ä»¶å¤„ç†å‡½æ•°ä¸­å¼•ç”¨çš„iéƒ½ä¸º5 // ä¿®æ­£ for (var i = 0, len = nodes.length; i &lt; len; i++) &#123; (function(i) &#123; nodes[i].onclick = function() &#123; alert(i); &#125; &#125;)(i) &#125;; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; åˆ©ç”¨é—­åŒ…åˆ›å»ºæµ‹è¯•ç±»å‹å‡½æ•°12345678910111213141516171819202122232425&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; var Type = &#123;&#125;; for (var i = 0, type; type = ['String', 'Array', 'Number'][i++];) &#123; // å½“è¯­å¥2æ¡ä»¶ä¸ºfalseæ—¶ï¼Œå°±ä¼šé€€å‡ºforå¾ªç¯ï¼Œå½“iä¸º3æ—¶ï¼Œtype[3]ä¸ºundefinedï¼Œä¸ºfalseè·³å‡ºå¾ªç¯ // åˆ©ç”¨é—­åŒ…åˆ›å»ºåˆ¤æ–­ç±»å‹çš„å‡½æ•° (function(type) &#123; Type['is' + type] = function(obj) &#123; return Object.prototype.toString.call(obj) === '[object ' + type + ']'; &#125; &#125;)(type) &#125;; Type.isArray([]); // è¾“å‡ºï¼štrue Type.isString("str"); // è¾“å‡ºï¼štrue &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; é—­åŒ…å°è£…å˜é‡123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // ä¹˜ç§¯ // 1.æ™®é€šæ–¹æ³• var mult = function() &#123; var a = 1; for (var i = 0, len = arguments.length; i &lt; len; i++) &#123; a *= arguments[i]; &#125; return a; &#125;; console.log(mult(8, 9)); // 72 // 2.è¿›é˜¶æ·»åŠ ç¼“å­˜æœºåˆ¶ var cache = &#123;&#125;; var mult2 = function() &#123; var args = Array.prototype.join.call(arguments, ","); // å°†å®å‚æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸² if (cache[args]) &#123; // cacheä¸­å­˜åœ¨åŸå…ˆçš„è®¡ç®—ç»“æœï¼Œåˆ™ç›´æ¥è¿”å›ç»“æœ console.log("æˆ‘æ˜¯ä»ç¼“å­˜2å–çš„"); return cache[args]; &#125; var a = 1; for (var i = 0, len = arguments.length; i &lt; len; i++) &#123; a *= arguments[i]; &#125; // å°†ç»“æœå­˜å…¥ç¼“å­˜ä¸­ cache[args] = a; return a; &#125;; console.log(mult2(8, 9)); // console.log(cache); console.log(mult2(8, 9)); // 3.è¶…è¿›é˜¶ä½¿ç”¨é—­åŒ…å°è£…cacheï¼Œå› ä¸ºè¿™ä¸ªcacheæ˜¯å•ç‹¬å±äºmult3çš„ï¼Œæ‰€ä»¥å¯ä»¥å°è£…åˆ°mult3ä¸­ var mult3 = (function() &#123; var cache3 = &#123;&#125;; return function() &#123; var args = Array.prototype.join.call(arguments, ","); // å°†å®å‚æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸² if (args in cache3) &#123; // cacheä¸­å­˜åœ¨åŸå…ˆçš„è®¡ç®—ç»“æœï¼Œåˆ™ç›´æ¥è¿”å›ç»“æœ console.log("æˆ‘æ˜¯ä»ç¼“å­˜3å–çš„"); return cache3[args]; &#125; var a = 1; for (var i = 0, len = arguments.length; i &lt; len; i++) &#123; a *= arguments[i]; &#125; // å°†ç»“æœå­˜å…¥ç¼“å­˜ä¸­ cache3[args] = a; return a; &#125;; &#125;)(); console.log(mult3(8, 10)); console.log(mult3(8, 10)); // console.log(cache3); // error // 4.Maxç‰ˆæœ¬æç‚¼å‡½æ•° var mult4 = (function() &#123; var cache4 = &#123;&#125;; // å°†é‡å¤ä½¿ç”¨åˆ°çš„è®¡ç®—æç‚¼å‡ºæ¥ var calcuate = function() &#123; var a = 1; for (var i = 0, len = arguments.length; i &lt; len; i++) &#123; a *= arguments[i]; &#125; return a; &#125;; return function() &#123; var args = Array.prototype.join.call(arguments, ","); // å°†å®å‚æ•°ç»„è½¬æ¢ä¸ºå­—ç¬¦ä¸² if (args in cache4) &#123; // cacheä¸­å­˜åœ¨åŸå…ˆçš„è®¡ç®—ç»“æœï¼Œåˆ™ç›´æ¥è¿”å›ç»“æœ console.log("æˆ‘æ˜¯ä»ç¼“å­˜4å–çš„"); return cache4[args]; &#125; // å…¨å±€ç¯å¢ƒä¸‹è°ƒç”¨calcuate cache4[args] = calcuate.apply(null, arguments); return cache4[args]; &#125;; &#125;)(); console.log(mult4(9, 9)); console.log(mult4(9, 9)); // console.log(calcuate);// error &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å›è°ƒå‡½æ•°1234567891011121314151617181920212223242526272829&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; var appendDiv = function(callback) &#123; for (var i = 0; i &lt; 100; i++) &#123; var div = document.createElement("div"); div.innerHTML = i; document.body.appendChild(div); if (typeof callback === "function") &#123; callback(div); &#125; &#125; &#125;; appendDiv(); // é€šè¿‡å›è°ƒå‡½æ•°æ¥ç¡®å®šæ˜¯å¦éšè— appendDiv(function(node) &#123; node.style.display = "none"; &#125;); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; AOP1234567891011121314151617181920212223242526272829303132333435363738394041&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // AOP é¢å‘åˆ‡ç‰‡ç¼–ç¨‹ï¼Œå°†è·Ÿæ ¸å¿ƒä¸šåŠ¡æ— å…³çš„åŠŸèƒ½æŠ½ç¦»å‡ºæ¥ï¼Œå†é€šè¿‡åŠ¨æ€ç»‡å…¥ Function.prototype.before = function(beforefn) &#123; var __self = this; // ä¿å­˜åŸå‡½æ•°çš„å¼•ç”¨ return function() &#123; // è¿”å›åŒ…å«äº†åŸå‡½æ•°å’Œæ–°å‡½æ•°çš„"ä»£ç†"å‡½æ•° beforefn.apply(this, arguments); // æ‰§è¡Œæ–°å‡½æ•°ï¼Œä¿®æ­£this return __self.apply(this, arguments); // æ‰§è¡ŒåŸå‡½æ•° &#125; &#125;; Function.prototype.after = function(afterfn) &#123; var __self = this; return function() &#123; var ret = __self.apply(this, arguments); afterfn.apply(this, arguments); return ret; &#125; &#125;; var func = function() &#123; console.log(2); &#125;; func = func.before(function() &#123; console.log(1); &#125;).after(function() &#123; console.log(3); &#125;); func(); // 1,2,3 &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å‡½æ•°æŸ¯é‡ŒåŒ–12345678910111213141516171819202122232425262728293031&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // æŸ¯é‡ŒåŒ–ä¸€èˆ¬ç”¨äºåˆ›å»ºå·²ç»è®¾ç½®å¥½äº†ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°çš„å‡½æ•°(åˆ›å»ºå¸¦æœ‰é»˜è®¤å‚æ•°å€¼å‡½æ•°çš„è¿‡ç¨‹) var curry = function(fn) &#123; var _args = Array.prototype.slice.call(arguments, 1); //ä¿å­˜é»˜è®¤å‚æ•°, ä¸€èˆ¬curryæ¥æ”¶çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºéœ€è¦æŸ¯é‡ŒåŒ–çš„å‡½æ•°ï¼Œåé¢çš„å®å‚éƒ½æ˜¯è¦è®¾ç½®ä¸ºé»˜è®¤å€¼çš„å‚æ•° console.log(_args); return function() &#123; var innerArgs = Array.prototype.slice.call(arguments); // æ–°å‚æ•° var finalArgs = _args.concat(innerArgs); // æœ€ç»ˆå‚æ•° return fn.apply(null, finalArgs); // åœ¨å…¨å±€è°ƒç”¨æŸ¯é‡ŒåŒ–å¥½çš„å‡½æ•° &#125;; &#125;; function add(num1, num2) &#123; return num1 + num2; &#125; var curriedAdd = curry(add, 5); // curriedAddæ­¤æ—¶å·²ç»æœ‰ä¸€ä¸ªé»˜è®¤å‚æ•°5äº†ï¼Œ ä½¿ç”¨æ—¶å°±åªç”¨å†ä¼ å…¥ä¸€ä¸ªå‚æ•° console.log(curriedAdd(3)); //8 &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; åæŸ¯ç†åŒ–123456789101112131415161718192021222324252627282930313233343536&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // å°†ç‰¹æœ‰å‡½æ•°æ™®é€šåŒ– Function.prototype.uncurrying = function() &#123; var _self = this; // ä¿å­˜åŸå‡½æ•° return function() &#123; var obj = Array.prototype.shift.call(arguments); // ä¿å­˜è°ƒç”¨ç¯å¢ƒ return _self.apply(obj, arguments); // è°ƒç”¨åŸå‡½æ•° &#125;; &#125;; // åæŸ¯é‡ŒåŒ–çš„å¦ä¸€ç§å†™æ³• // Function.prototype.uncurrying = function() &#123; // var _self = this; // return function() &#123; // return Function.prototype.call.apply(_self, arguments); // &#125;; // &#125;; var push = Array.prototype.push.uncurrying(); (function() &#123; push(arguments, 4); console.log(arguments); // è¾“å‡ºï¼š[1, 2, 3, 4] &#125;)(1, 2, 3); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å‡½æ•°æˆªæµ123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // æœ‰äº›æ—¶å€™å‡½æ•°ä¼šè¢«ç³»ç»Ÿé¢‘ç¹çš„è§¦å‘,å¦‚window.onresizeäº‹ä»¶ã€mousemoveã€ä¸Šä¼ è¿›åº¦æ—¶ä¼šé¢‘ç¹è§¦å‘ç›¸åº”çš„å¤„ç†å‡½æ•° // å®ç°å‡½æ•°èŠ‚æµå¯é€šè¿‡setTimeoutå»¶è¿Ÿæ‰§è¡Œæ¥è§£å†³ var throttle = function(fn, interval) &#123; var _self = fn, //ä¿å­˜éœ€è¦è¢«å»¶è¿Ÿçš„å‡½æ•° firstTime = true, // æ˜¯å¦é¦–æ¬¡è°ƒç”¨ intervalTime = interval || 500, // é—´éš”è°ƒç”¨æ—¶é—´ï¼Œé»˜è®¤500æ¯«ç§’ timer; // å®šæ—¶å™¨ return function() &#123; var args = arguments, _me = this; if (firstTime) &#123; // å¦‚æœç¬¬ä¸€æ¬¡ï¼Œåˆ™æ— éœ€å»¶è¿Ÿï¼Œç›´æ¥è°ƒç”¨ _self.apply(_me, args); return firstTime = false; &#125; if (timer) &#123; // å¦‚æœå®šæ—¶å™¨å­˜åœ¨ï¼Œè¯´æ˜å‰ä¸€æ¬¡æ‰§è¡Œè¿˜æ²¡æœ‰å®Œæˆ return false; &#125; timer = setTimeout(function() &#123; // å»¶è¿ŸintervalTimeåæ‰§è¡Œ clearTimeout(timer); timer = null; _self.apply(_me, args); &#125;, intervalTime); &#125;; &#125;; window.onresize = throttle(function() &#123; console.log(1); // åªè§¦å‘äº†å‡ æ¬¡ &#125;, 1000); // window.onresize = function() &#123; // console.log(1); // å‡ åæ¬¡ // &#125;; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; åˆ†æ—¶å‡½æ•°12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // å½“ä¸€æ¬¡æ€§å¾€DOMä¸­æ·»åŠ å¤§é‡èŠ‚ç‚¹ï¼Œæµè§ˆå™¨ä¼šå¡æ­»ï¼Œæ‰€ä»¥éœ€è¦åˆ†æ—¶é—´æ·»åŠ èŠ‚ç‚¹ // var ary = []; // for (var i = 1; i &lt;= 99999; i++) &#123; // ary.push(i); // å‡è®¾ary è£…è½½äº†1000 ä¸ªå¥½å‹çš„æ•°æ® // &#125;; // var renderFriendList = function(data) &#123; // for (var i = 0, l = data.length; i &lt; l; i++) &#123; // var div = document.createElement('div'); // div.innerHTML = i; // document.body.appendChild(div); // &#125; // &#125;; // renderFriendList(ary); /** * å®ç°åˆ†æ—¶çš„å‡½æ•°ï¼Œåœ¨intervalTimeæ—¶é—´é—´éš”å†…æ‰§è¡Œcountæ¬¡fnå‡½æ•° * @author cgh * @time 2017-03-06 * @param &#123;Array&#125; ary æ¯æ¬¡fnæ‰§è¡Œéœ€è¦çš„å‚æ•°æ•°ç»„ * @param &#123;Function&#125; fn å¤„ç†å‡½æ•° * @param &#123;Number&#125; count æ¯ä¸ªæ—¶é—´é—´éš”å†…æ‰§è¡Œçš„æ¬¡æ•° * @param &#123;Number&#125; intervalTime æ—¶é—´é—´éš” * @return &#123;Function&#125; å‡½æ•° */ var timeChunk = function(ary, fn, count, interval) &#123; var obj, t, len = ary.length, intervalTime = interval || 200; // é»˜è®¤æ—¶é—´é—´éš”200ms var start = function() &#123; for (var i = 0; i &lt; Math.min(count || 1, len); i++) &#123; obj = ary.shift(); fn(obj); &#125; &#125;; return function() &#123; t = setInterval(function() &#123; if (ary.length === 0) &#123; return clearInterval(t); &#125; start(); &#125;, intervalTime); &#125;; &#125;; var ary = []; for (var i = 1; i &lt;= 800; i++) &#123; ary.push(i); &#125;; // æ¯éš”500msåˆ›å»º8ä¸ªèŠ‚ç‚¹æ’å…¥åˆ°DOMä¸­ var renderFriendList = timeChunk(ary, function(n) &#123; var div = document.createElement('div'); div.innerHTML = n; document.body.appendChild(div); &#125;, 8, 500); renderFriendList(); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; æƒ°æ€§è½½å…¥å‡½æ•°1234567891011121314151617181920212223242526272829303132333435&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;div id="div1"&gt;ç‚¹æˆ‘ç»‘å®šäº‹ä»¶&lt;/div&gt; &lt;script type="text/javascript"&gt; var addEvent = function(elem, type, handler) &#123; // é¦–æ¬¡ç‚¹å‡»æ—¶åˆ¤æ–­ç»‘å®šæ–¹å¼ï¼Œåç»­ç‚¹å‡»æ—¶æ— éœ€å†åˆ¤æ–­ if (window.addEventListener) &#123; addEvent = function(elem, type, handler) &#123; elem.addEventListener(type, handler, false); &#125; &#125; else if (window.attachEvent) &#123; addEvent = function(elem, type, handler) &#123; elem.attachEvent('on' + type, handler); &#125; &#125; addEvent(elem, type, handler); &#125;; var div = document.getElementById('div1'); addEvent(div, 'click', function() &#123; alert(1); &#125;); addEvent(div, 'click', function() &#123; alert(2); &#125;); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å•ä¾‹æ¨¡å¼åŸºæœ¬å®šä¹‰12345678910111213141516171819202122232425262728293031323334&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // å•ä¾‹æ¨¡å¼:ä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ // ä½¿ç”¨åœºæ™¯:å½“æŸäº›å¯¹è±¡åªéœ€è¦ä¸€ä¸ªçš„æ—¶å€™ï¼Œå¦‚çº¿ç¨‹æ± ã€å…¨å±€ç¼“å­˜ã€windowç­‰ // ä½¿ç”¨ä¸¾ä¾‹:å¦‚ç™»å½•é¡µï¼Œç‚¹å‡»æŒ‰é’®ç”Ÿæˆç™»å½•æ¡†ï¼Œè¿™ä¸ªç™»å½•æ¡†åªä¼šç”Ÿæˆä¸€æ¬¡ï¼Œä¸ä¼šæ¯æ¬¡ç‚¹å‡»éƒ½ç”Ÿæˆä¸€ä¸ª var Singleton = function(name) &#123; this.name = name; this.instance = null; &#125;; Singleton.prototype.getName = function() &#123; alert(this.name); &#125;; Singleton.getInstance = function(name) &#123; if (!this.instance) &#123; this.instance = new Singleton(name); &#125; return this.instance; &#125;; var a = Singleton.getInstance("AAA"); var b = Singleton.getInstance("BBB"); console.log(a === b); //true // æ­¤ç§æ–¹æ³•é€šè¿‡getInstanceæ¥è·å–å®ä¾‹ï¼Œå’Œæ­£å¸¸çš„newä¸ä¸€æ ·ï¼Œç”¨æˆ·å¿…é¡»çŸ¥é“è¿™æ˜¯ä¸ªå•ä¾‹æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯ç”¨æˆ·å¿…é¡»çŸ¥é“æ˜¯é€šè¿‡getInstanceæ–¹æ³•æ¥è·å–å®ä¾‹è€Œä¸æ˜¯newæ–¹å¼ï¼Œæ‰€å°±è¿™ç§æ–¹å¼å¯¹ç”¨æˆ·æ¥è¯´"ä¸é€æ˜" &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; é€æ˜çš„å•ä¾‹æ¨¡å¼123456789101112131415161718192021222324252627282930313233343536&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // å®ä¾‹åŒ–æ—¶ä¸æ˜¯é€šè¿‡ç‰¹æ®Šçš„æ–¹æ³•æ¥å®ç°ï¼Œå®ä¾‹åŒ–å’Œå¹³å¸¸ä¸€æ ·ä½¿ç”¨new var CreateDiv = (function() &#123; var instance; var CreateDiv = function(html) &#123; if (instance) &#123; return instance; &#125; this.html = html; this.init(); return instance = this; &#125;; CreateDiv.prototype.init = function() &#123; var div = document.createElement("div"); div.innerHTML = this.html; document.body.appendChild(div); &#125;; return CreateDiv; &#125;)(); var a = new CreateDiv("div1"); var b = new CreateDiv("div2"); console.log(a === b); // true // ä¸è¶³:æ­¤å¤„çš„æ„é€ å‡½æ•°åšäº†2ä»¶äº‹ï¼Œ1.åˆ›å»ºå¯¹è±¡å¹¶åˆå§‹åŒ–2.ä¿è¯åªæœ‰ä¸€ä¸ªå¯¹è±¡ã€‚å¦‚æœæŸå¤©éœ€è¦åœ¨é¡µé¢ä¸­åˆ›å»ºå¤šä¸ªdivï¼Œåˆ™éœ€è¦æ‰‹åŠ¨ä¿®æ”¹æ­¤æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥æ¨èç”¨ä»£ç†å®ç°å•ä¾‹æ¨¡å¼ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ç”¨ä»£ç†å®ç°å•ä¾‹æ¨¡å¼1234567891011121314151617181920212223242526272829303132333435363738&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; var CreateDiv = function(html) &#123; this.html = html; this.init(); &#125;; CreateDiv.prototype.init = function() &#123; var div = document.createElement("div"); div.innerHTML = this.html; document.body.appendChild(div); &#125;; // å¼•å…¥ä»£ç†,æ¥ä¿è¯å®ä¾‹çš„å•ä¸€æ€§ var ProxySingletonCreateDiv = (function() &#123; var instance; return function(html) &#123; if (!instance) &#123; instance = new CreateDiv(html); &#125; return instance; &#125;; &#125;)(); var a = new ProxySingletonCreateDiv("div1"); var b = new ProxySingletonCreateDiv("div2"); console.log(a === b); //true // è¿™æ ·åˆ›å»ºdivå’Œä¿è¯å•ä¸€æ€§å°±åˆ†å¼€äº†ï¼ŒåæœŸä¹Ÿå¥½ä¿®æ”¹ // è¿™äº›æ–¹æ³•éƒ½å’Œä¼ ç»Ÿçš„é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸€æ ·ï¼Œå…ˆæœ‰ç±»ï¼Œå†åˆ›å»ºå®ä¾‹ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; jsä¸­çš„å•ä¾‹æ¨¡å¼12345678910111213141516171819202122232425262728293031323334353637&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // å•ä¾‹æ¨¡å¼çš„æ ¸å¿ƒæ˜¯åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›å…¨å±€è®¿é—®ï¼Œæ‰€ä»¥åœ¨JSä¸­æ— éœ€è„±è£¤å­æ”¾å±ï¼Œå…ˆåˆ›å»ºä¸ªç±»ï¼Œå†ä»ç±»åˆ›å»ºå®ä¾‹ï¼Œå¯ä»¥ç›´æ¥ç”¨å…¨å±€å˜é‡(å¯¹è±¡)æ¥åˆ›å»ºå•ä¾‹ // å…¨å±€å¯¹è±¡æ»¡è¶³å•ä¾‹çš„ä¸¤ä¸ªæ ¸å¿ƒç‚¹ï¼Œä¸€ä¸ªå®ä¾‹å¹¶æä¾›å…¨å±€è®¿é—®ï¼Œè™½ç„¶å…¨å±€å¯¹è±¡ä¸æ˜¯å•ä¾‹æ¨¡å¼ï¼Œä½†åœ¨JSä¸­ä¼šæŠŠå…¨å±€å¯¹è±¡å½“åšå•ä¾‹æ¨¡å¼æ¥ç”¨ // ä½†å…¨å±€å˜é‡(å¯¹è±¡)ä¼šé€ æˆå…¨å±€å˜é‡æ±¡æŸ“ï¼Œæ‰€ä»¥éœ€è¦é¿å…ï¼Œå¯é€šè¿‡ä¸‹é¢æ–¹å¼ // ä½¿ç”¨å‘½åç©ºé—´ var namespace1 = &#123; a: function() &#123; alert(1); &#125;, b: function() &#123; alert(2); &#125; &#125;; // ä½¿ç”¨é—­åŒ…å°è£…ç§æœ‰å˜é‡ var user = (function() &#123; var _name = "aaa"; var _age = 18; return &#123; getUserInfo: functioin() &#123; return _name + ":" + _age; &#125; &#125; &#125;)(); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; æƒ°æ€§å•ä¾‹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;button id="loginBtn"&gt;ç™»å½•&lt;/button&gt; &lt;script type="text/javascript"&gt; // æƒ°æ€§å•ä¾‹æŒ‡çš„æ˜¯åœ¨éœ€è¦çš„æ—¶å€™æ‰åˆ›å»ºå¯¹è±¡å®ä¾‹ï¼Œå®é™…åœ¨19ä¸­Singleton.getInstanceå°±æ˜¯åœ¨éœ€è¦çš„æ—¶å€™åˆ›å»ºå®ä¾‹ï¼Œå¹¶éä¸€å¼€å§‹å°±åˆ›å»º // åˆ©ç”¨å…¨å±€å˜é‡(å¯¹è±¡)å’Œæƒ°æ€§å•ä¾‹æ¥å®ç°ç™»å½•å¼¹çª—å¯¹è±¡çš„åˆ›å»º // var loginLayer = (function() &#123; // var div = document.createElement("div"); // div.innerHTML = "æˆ‘æ˜¯ç™»å½•çª—å£"; // div.style.display = 'none'; // document.body.appendChild(div); // return div; // &#125;)(); // document.getElementById('loginBtn').onclick = function() &#123; // loginLayer.style.display = 'block'; // &#125;; // ä¸Šé¢è¿™ç§åœ¨é¡µé¢åŠ è½½çš„æ—¶å€™å°±ä¼šåˆ›å»ºä¸€ä¸ªç™»å½•çª—å£ï¼Œå¦‚æœç”¨æˆ·æ ¹æœ¬ä¸ç‚¹ç™»å½•çš„æ—¶å€™ä¹Ÿä¼šåˆ›å»ºï¼Œæ‰€ä»¥ä¼šæµªè´¹ // æ”¹è¿› // var createLoginLayer = function() &#123; // var div = document.createElement("div"); // div.innerHTML = "æˆ‘æ˜¯ç™»å½•çª—å£"; // div.style.display = 'none'; // document.body.appendChild(div); // return div; // &#125;; // document.getElementById('loginBtn').onclick = function() &#123; // var loginLayer = createLoginLayer(); // loginLayer.style.display = 'block'; // &#125;; // è¿™æ ·è™½ç„¶ä¸ä¼šä¸€è½½å…¥å°±åˆ›å»ºï¼Œä½†æ˜¯æ²¡æœ‰ä¿è¯å•ä¾‹ï¼Œå¤šæ¬¡ç‚¹å‡»ä¼šåˆ›å»ºå¤šä¸ª // æ”¹è¿› var createLoginLayer = (function() &#123; var div; return function() &#123; if (!div) &#123; div = document.createElement("div"); div.innerHTML = "æˆ‘æ˜¯ç™»å½•çª—å£"; div.style.display = "none"; document.body.appendChild(div); &#125; return div; &#125;; &#125;)(); document.getElementById('loginBtn').onclick = function() &#123; var loginLayer = createLoginLayer(); loginLayer.style.display = 'block'; &#125;; // ä¸Šé¢çš„æ–¹å¼å·²ç»èƒ½å®ç°åŸºæœ¬åŠŸèƒ½ï¼Œä½†æ˜¯ä»”ç»†è§‚å¯Ÿä¼šå‘ç°ï¼Œä»–å°†åˆ›å»ºå¯¹è±¡å’Œç®¡ç†å•ä¾‹çš„é€»è¾‘æ”¾åœ¨äº†ä¸€èµ·ï¼ŒåŠ å…¥ä¸‹æ¬¡æƒ³åˆ›å»ºä¸€ä¸ªiframeï¼Œå°±å¿…é¡»å°†ä¸Šé¢ä»£ç å†æŠ„ä¸€é &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; é€šç”¨çš„æƒ°æ€§å•ä¾‹1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;button id="loginBtn"&gt;ç™»å½•&lt;/button&gt; &lt;button id="loginBtn2"&gt;ç™»å½•2&lt;/button&gt; &lt;script type="text/javascript"&gt; // å°†23ä¸­çš„ç®¡ç†å•ä¾‹çš„é€»è¾‘ç»™éš”ç¦»(æŠ½è±¡)å‡ºæ¥ï¼Œå®ç°åˆ›å»ºå’Œç®¡ç†çš„åˆ†ç¦» // ç®¡ç†å•ä¾‹ var getSingle = function(fn) &#123; var result; return function() &#123; return result || (result = fn.apply(this, arguments)); &#125;; &#125;; // åˆ›å»ºloginå¯¹è±¡ var createLoginLayer = function() &#123; var div = document.createElement('div'); div.innerHTML = 'æˆ‘æ˜¯ç™»å½•æµ®çª—'; div.style.display = 'none'; document.body.appendChild(div); return div; &#125;; var createSingleLoginLayer = getSingle(createLoginLayer); document.getElementById('loginBtn').onclick = function() &#123; var loginLayer = createSingleLoginLayer(); loginLayer.style.display = 'block'; &#125;; // åˆ›å»ºiframeå¯¹è±¡ var createIframe = function() &#123; var iframe = document.createElement('iframe'); document.body.appendChild(iframe); return iframe; &#125; var createSingleIframe = getSingle(createIframe); document.getElementById('loginBtn2').onclick = function() &#123; var loginLayer = createSingleIframe(); loginLayer.src = 'http://baidu.com'; &#125;; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ç­–ç•¥æ¨¡å¼åŸºæœ¬å®šä¹‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // ç­–ç•¥æ¨¡å¼:å®šä¹‰ä¸€ç³»åˆ—ç®—æ³•ï¼ŒæŠŠä»–ä»¬ä¸€ä¸ªä¸€ä¸ªå°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿ä»–ä»¬å¯ä»¥ç›¸äº’æ›¿æ¢ã€‚ç­–ç•¥æ¨¡å¼å®šä¹‰äº†ç®—æ³•å®¶æ—ï¼Œåˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©ä»–ä»¬ä¹‹é—´å¯ä»¥äº’ç›¸æ›¿æ¢ï¼Œæ­¤æ¨¡å¼è®©ç®—æ³•çš„å˜åŒ–ä¸ä¼šå½±å“åˆ°ä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ã€‚å®ƒå°†ç®—æ³•çš„å®ç°å’Œä½¿ç”¨åˆ†ç¦» // åº”ç”¨åœºæ™¯:å½“éœ€è¦æ ¹æ®ä¸åŒç­–ç•¥(ç®—æ³•)è®¡ç®—æ—¶;å®è·µä¸­ï¼Œä¸ä»…å¯ä»¥å°è£…ç®—æ³•ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å°è£…å‡ ä¹ä»»ä½•ç±»å‹çš„è§„åˆ™ï¼Œæ˜¯è¦åœ¨åˆ†æè¿‡ç¨‹ä¸­éœ€è¦åœ¨ä¸åŒæ—¶é—´åº”ç”¨ä¸åŒçš„ä¸šåŠ¡è§„åˆ™ï¼Œå°±å¯ä»¥è€ƒè™‘æ˜¯è¦ç­–ç•¥æ¨¡å¼æ¥å¤„ç†å„ç§å˜åŒ–ã€‚ // ä½¿ç”¨ä¸¾ä¾‹:æ ¹æ®å·¥èµ„å’Œç»©æ•ˆç­‰çº§è®¡ç®—å¹´ç»ˆå¥–ã€ç¼“åŠ¨åŠ¨ç”»ã€è¡¨å•éªŒè¯ï¼Œè¿™ä¸‰ç§éƒ½æ˜¯ä¼šæœ‰å¤šä¸­ä¸åŒçš„ç­–ç•¥ï¼Œå¦‚å¹´ç»ˆå¥–æœ‰SABä¸‰ç­‰çº§3ä¸ªç­–ç•¥ï¼Œæœ€ç»ˆéƒ½æ˜¯è¦å¾—åˆ°å¹´ç»ˆå¥–ã€‚ç¼“åŠ¨åŠ¨ç”»æœ‰ease-in,ease-out...ï¼Œæœ€åæ˜¯è¦å¾—åˆ°ä¸€ä¸ªåŠ¨ç”»ã€‚è¡¨å•éªŒè¯éœ€è¦éªŒè¯æ•°å­—ã€é‚®ç®±...ç­‰ï¼Œä½†æœ€ç»ˆéƒ½è¦å¾—åˆ°æ˜¯å¦éªŒè¯é€šè¿‡è¿™ä¸€ç»“æœã€‚éƒ½æ˜¯éœ€è¦æ ¹æ®ä¸åŒç­–ç•¥ï¼Œå¾—å‡ºæŸç»“æœ // ç»„æˆéƒ¨åˆ†:1.ä¸€ç»„ç­–ç•¥ç±»ï¼Œå°è£…äº†ç®—æ³•ï¼Œå¹¶è´Ÿè´£å…·ä½“è®¡ç®—2.ç¯å¢ƒç±»Contexï¼Œè´Ÿè´£æ¥æ”¶è¯·æ±‚ï¼Œå¹¶æŠŠè¯·æ±‚å§”æ‰˜ç»™æŸä¸ªå…·ä½“çš„ç­–ç•¥ç±» // var calculateBonus = function(performanceLevel, salary) &#123; // if (performanceLevel === "S") &#123; // return salary * 4; // &#125; // if (performanceLevel === "A") &#123; // return salary * 3; // &#125; // if (performanceLevel === "B") &#123; // return salary * 2; // &#125; // &#125;; // console.log(calculateBonus("B", 2000)); //4000 // console.log(calculateBonus("S", 4000)); //16000 // ä¸Šé¢çš„ç¼ºç‚¹ // å‡½æ•°åºå¤§ï¼ŒåŒ…å«äº†å¾ˆå¤šif-elseï¼Œè¿™äº›è¦è¦†ç›–æ‰€æœ‰çš„é€»è¾‘åˆ†æ”¯ // ç¼ºä¹å¼¹æ€§ï¼Œå¦‚æœè¦å¢åŠ Cç­‰çº§ï¼Œæˆ–ä¿®æ”¹å€æ•°ï¼Œå¿…é¡»è¿›å…¥å‡½æ•°å†…éƒ¨ä¿®æ”¹ // ç®—æ³•å¤ç”¨æ€§å·® // ä½¿ç”¨ç»„åˆå‡½æ•°é‡æ„ var performanceS = function(salary) &#123; return salary * 4; &#125;; var performanceA = function(salary) &#123; return salary * 3; &#125;; var performanceB = function(salary) &#123; return salary * 2; &#125;; var calculateBonus = function(performanceLevel, salary) &#123; if (performanceLevel === 'S') &#123; return performanceS(salary); &#125; if (performanceLevel === 'A') &#123; return performanceA(salary); &#125; if (performanceLevel === 'B') &#123; return performanceB(salary); &#125; &#125;; calculateBonus('A', 10000); // è¾“å‡ºï¼š30000 // è™½ç„¶è§£å†³äº†ç®—æ³•å¤ç”¨ï¼Œä½†æ˜¯ä¾æ—§åºå¤§ï¼Œå¹¶ç¼ºä¹å¼¹æ€§ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ä¼ ç»Ÿé¢å‘å¯¹è±¡ä¸­çš„ç­–ç•¥æ¨¡å¼1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // ä½¿ç”¨ä¼ ç»Ÿé¢å‘å¯¹è±¡æ–¹å¼å®ç°ç­–ç•¥æ¨¡å¼ï¼Œå°†ä¸åŒç­–ç•¥å°è£…åˆ°ä¸åŒçš„ç±»ä¸­ // ä¸€ç»„ç­–ç•¥ç±» var performanceS = function() &#123;&#125;; performanceS.prototype.calculate = function(salary) &#123; return salary * 4; &#125; var performanceA = function() &#123;&#125;; performanceA.prototype.calculate = function(salary) &#123; return salary * 3; &#125; var performanceB = function() &#123;&#125;; performanceB.prototype.calculate = function(salary) &#123; return salary * 2; &#125; var Bonus = function() &#123; this.salary = null; // å·¥èµ„ this.strategy = null; // ç»©æ•ˆç­‰çº§å¯¹åº”çš„ç­–ç•¥å¯¹è±¡ &#125;; Bonus.prototype.setSalary = function(salary) &#123; this.salary = salary; &#125;; Bonus.prototype.setStrategy = function(strategy) &#123; this.strategy = strategy; &#125;; // ç¯å¢ƒç±»ï¼ŒæŠŠè¯·æ±‚å§”æ‰˜ç»™å…·ä½“çš„ç­–ç•¥å¯¹è±¡ Bonus.prototype.getBonus = function() &#123; return this.strategy.calculate(this.salary); // æŠŠè®¡ç®—å…·ä½“å¥–é‡‘çš„å·¥ä½œå§”æ‰˜ç»™æŸä¸ªç­–ç•¥å¯¹è±¡ &#125;; var bonus = new Bonus(); // å®ä¾‹åŒ–ä¸€ä¸ªå¹´ç»ˆå¥–å¯¹è±¡ bonus.setSalary(1000); // æ·»åŠ å·¥èµ„ bonus.setStrategy(new performanceS()); // ä¼ å…¥ç»©æ•ˆç­‰çº§ console.log(bonus.getBonus()); // è·å¾—å¹´ç»ˆå¥– &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; jsä¸­çš„ç­–ç•¥æ¨¡å¼123456789101112131415161718192021222324252627282930313233&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // ä¼ ç»Ÿçš„ç­–ç•¥æ¨¡å¼å¯¹è±¡ï¼Œå¿…é¡»è¦ä»ç±»ä¸­åˆ›å»ºï¼Œä½†æ˜¯JSä¸­å¯ä»¥ç›´æ¥åˆ›å»ºï¼Œç¯å¢ƒç±»å¯¹è±¡ä¹Ÿä¸ç”¨ä»ç±»ä¸­åˆ›å»ºï¼Œå¯ä»¥ç›´æ¥åˆ›å»º // ä¸€ç»„ç­–ç•¥ var strategies = &#123; "S": function(salary) &#123; return salary * 4; &#125;, "A": function(salary) &#123; return salary * 3; &#125;, "B": function(salary) &#123; return salary * 2; &#125; &#125;; // è´Ÿè´£æŠŠè¯·æ±‚å§”æ‰˜ç»™å…·ä½“çš„æŸä¸ªç­–ç•¥ç±» var calculateBonus = function(level, salary) &#123; return strategies[level](salary); &#125;; console.log(calculateBonus("S", 3000)); //12000 console.log(calculateBonus("A", 1000)); //2000 &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ä½¿ç”¨ç­–ç•¥æ¨¡å¼å®ç°ç¼“åŠ¨åŠ¨ç”»123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;div style="position:absolute;background:blue" id="div"&gt;æˆ‘æ˜¯div&lt;/div&gt; &lt;script type="text/javascript"&gt; // å°†å„ç§ç¼“åŠ¨åŠ¨ç”»çš„ç®—æ³•å°è£…èµ·æ¥ var tween = &#123; // tæ˜¯åŠ¨ç”»å·²æ¶ˆè€—çš„æ—¶é—´ã€bå°çƒåŸå§‹ä½ç½®ã€cå°çƒç›®æ ‡ä½ç½®ã€dåŠ¨ç”»æŒç»­çš„æ€»æ—¶é—´ linear: function(t, b, c, d) &#123; return c * t / d + b; &#125;, easeIn: function(t, b, c, d) &#123; return c * (t /= d) * t + b; &#125;, strongEaseIn: function(t, b, c, d) &#123; return c * (t /= d) * t * t * t * t + b; &#125;, strongEaseOut: function(t, b, c, d) &#123; return c * ((t = t / d - 1) * t * t * t * t + 1) + b; &#125;, sineaseIn: function(t, b, c, d) &#123; return c * (t /= d) * t * t + b; &#125;, sineaseOut: function(t, b, c, d) &#123; return c * ((t = t / d - 1) * t * t + 1) + b; &#125; &#125;; var Animate = function(dom) &#123; this.dom = dom; // è¿›è¡Œè¿åŠ¨çš„dom èŠ‚ç‚¹ this.startTime = 0; // åŠ¨ç”»å¼€å§‹æ—¶é—´ this.startPos = 0; // åŠ¨ç”»å¼€å§‹æ—¶ï¼Œdom èŠ‚ç‚¹çš„ä½ç½®ï¼Œå³dom çš„åˆå§‹ä½ç½® this.endPos = 0; // åŠ¨ç”»ç»“æŸæ—¶ï¼Œdom èŠ‚ç‚¹çš„ä½ç½®ï¼Œå³dom çš„ç›®æ ‡ä½ç½® this.propertyName = null; // dom èŠ‚ç‚¹éœ€è¦è¢«æ”¹å˜çš„css å±æ€§å this.easing = null; // ç¼“åŠ¨ç®—æ³• this.duration = null; // åŠ¨ç”»æŒç»­æ—¶é—´ &#125;; // startè´Ÿè´£å¯åŠ¨åŠ¨ç”» /** * å¯åŠ¨åŠ¨ç”» * @author cgh * @time 2017-03-07 * @param &#123;String&#125; propertyName è¦è¿åŠ¨çš„å±æ€§ * @param &#123;Number&#125; endPos ç»“æŸä½ç½® * @param &#123;Time&#125; duration æŒç»­æ—¶é—´ * @param &#123;Obj&#125; easing ç¼“åŠ¨ç®—æ³• * @return &#123;[type]&#125; [description] */ Animate.prototype.start = function(propertyName, endPos, duration, easing) &#123; this.startTime = +new Date; // åŠ¨ç”»å¯åŠ¨æ—¶é—´ this.startPos = this.dom.getBoundingClientRect()[propertyName]; // dom èŠ‚ç‚¹åˆå§‹ä½ç½® this.propertyName = propertyName; // dom èŠ‚ç‚¹éœ€è¦è¢«æ”¹å˜çš„CSS å±æ€§å this.endPos = endPos; // dom èŠ‚ç‚¹ç›®æ ‡ä½ç½® this.duration = duration; // åŠ¨ç”»æŒç»­äº‹ä»¶ this.easing = tween[easing]; // ç¼“åŠ¨ç®—æ³• var self = this; var timeId = setInterval(function() &#123; // å¯åŠ¨å®šæ—¶å™¨ï¼Œå¼€å§‹æ‰§è¡ŒåŠ¨ç”» if (self.step() === false) &#123; // å¦‚æœåŠ¨ç”»å·²ç»“æŸï¼Œåˆ™æ¸…é™¤å®šæ—¶å™¨ clearInterval(timeId); &#125; &#125;, 1000 / 60); &#125;; // å®šä¹‰å°çƒæ¯ä¸€å¸§çš„åŠ¨ç”» Animate.prototype.step = function() &#123; var t = +new Date; // å–å¾—å½“å‰æ—¶é—´ if (t &gt;= this.startTime + this.duration) &#123; // (1) this.update(this.endPos); // æ›´æ–°å°çƒçš„CSS å±æ€§å€¼ return false; &#125; var pos = this.easing(t - this.startTime, this.startPos, this.endPos - this.startPos, this.duration); // pos ä¸ºå°çƒå½“å‰ä½ç½® this.update(pos); // æ›´æ–°å°çƒçš„CSS å±æ€§å€¼ &#125;; // è´Ÿè´£æ›´æ–°åŠ¨ç”» Animate.prototype.update = function(pos) &#123; this.dom.style[this.propertyName] = pos + 'px'; &#125;; var div = document.getElementById('div'); var animate = new Animate(div); animate.start('left', 500, 1000, 'strongEaseOut'); // animate.start('top', 1500, 500, 'strongEaseIn'); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ä½¿ç”¨ç­–ç•¥æ¨¡å¼å®Œæˆè¡¨å•éªŒè¯123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;form id="registerForm" method="post"&gt; è¯·è¾“å…¥ç”¨æˆ·åï¼š &lt;input type="text" name="userName" /&gt; è¯·è¾“å…¥å¯†ç ï¼š &lt;input type="text" name="password" /&gt; è¯·è¾“å…¥æ‰‹æœºå·ç ï¼š &lt;input type="text" name="phoneNumber" /&gt; &lt;button&gt;æäº¤&lt;/button&gt; &lt;/form&gt; &lt;script type="text/javascript"&gt; // ç­–ç•¥æ¨¡å¼çš„ä¸»è¦ç›®çš„æ˜¯å°†ç®—æ³•çš„å®ç°å’Œä½¿ç”¨åˆ†ç¦» // ä½†åœ¨å¹¿ä¹‰çš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯ä»¥ç”¨ç­–ç•¥æ¨¡å¼å°†ä¸€äº›ä¸šåŠ¡è§„åˆ™å°è£…èµ·æ¥ï¼Œåªè¦è¿™äº›ä¸šåŠ¡è§„åˆ™æŒ‡å‘çš„ç›®æ ‡ä¸€è‡´ï¼Œå¹¶å¯è¢«æ›¿æ¢ä½¿ç”¨å³å¯ã€‚å¦‚è¡¨å•éªŒè¯ // var registerForm = document.getElementById('registerForm'); // registerForm.onsubmit = function() &#123; // if (registerForm.userName.value === '') &#123; // alert('ç”¨æˆ·åä¸èƒ½ä¸ºç©º'); // return false; // &#125; // if (registerForm.password.value.length &lt; 6) &#123; // alert('å¯†ç é•¿åº¦ä¸èƒ½å°‘äº6 ä½'); // return false; // &#125; // if (!/(^1[3|5|8][0-9]&#123;9&#125;$)/.test(registerForm.phoneNumber.value)) &#123; // alert('æ‰‹æœºå·ç æ ¼å¼ä¸æ­£ç¡®'); // return false; // &#125; // &#125;; // ä¸è¶³å¾ˆæ˜æ˜¾ï¼Œå‡½æ•°æ¯”è¾ƒåºå¤§ã€ç¼ºä¹å¼¹æ€§ã€å¤ç”¨æ€§å·® // ç­–ç•¥æ¨¡å¼æ”¹è¿› // å°è£…æ ¡éªŒé€»è¾‘ /***********************ç­–ç•¥å¯¹è±¡**************************/ var strategies = &#123; isNonEmpty: function(value, errorMsg) &#123; if (value === '') &#123; return errorMsg; &#125; &#125;, minLength: function(value, length, errorMsg) &#123; if (value.length &lt; length) &#123; return errorMsg; &#125; &#125;, isMobile: function(value, errorMsg) &#123; if (!/(^1[3|5|8][0-9]&#123;9&#125;$)/.test(value)) &#123; return errorMsg; &#125; &#125; &#125;; /***********************Validator ç±»**************************/ var Validator = function() &#123; this.cache = []; &#125;; Validator.prototype.add = function(dom, rules) &#123; var self = this; for (var i = 0, rule; rule = rules[i++];) &#123; (function(rule) &#123; var strategyAry = rule.strategy.split(':'); var errorMsg = rule.errorMsg; self.cache.push(function() &#123; var strategy = strategyAry.shift(); strategyAry.unshift(dom.value); strategyAry.push(errorMsg); return strategies[strategy].apply(dom, strategyAry); &#125;); &#125;)(rule) &#125; &#125;; Validator.prototype.start = function() &#123; for (var i = 0, validatorFunc; validatorFunc = this.cache[i++];) &#123; var errorMsg = validatorFunc(); if (errorMsg) &#123; return errorMsg; &#125; &#125; &#125;; /***********************å®¢æˆ·è°ƒç”¨ä»£ç **************************/ var registerForm = document.getElementById('registerForm'); var validataFunc = function() &#123; var validator = new Validator(); validator.add(registerForm.userName, [&#123; strategy: 'isNonEmpty', errorMsg: 'ç”¨æˆ·åä¸èƒ½ä¸ºç©º' &#125;, &#123; strategy: 'minLength:6', errorMsg: 'ç”¨æˆ·åé•¿åº¦ä¸èƒ½å°äº10 ä½' &#125;]); validator.add(registerForm.password, [&#123; strategy: 'minLength:6', errorMsg: 'å¯†ç é•¿åº¦ä¸èƒ½å°äº6 ä½' &#125;]); validator.add(registerForm.phoneNumber, [&#123; strategy: 'isMobile', errorMsg: 'æ‰‹æœºå·ç æ ¼å¼ä¸æ­£ç¡®' &#125;]); var errorMsg = validator.start(); return errorMsg; &#125; registerForm.onsubmit = function() &#123; var errorMsg = validataFunc(); if (errorMsg) &#123; alert(errorMsg); return false; &#125; &#125;; // ç­–ç•¥æ¨¡å¼ä¼˜ç‚¹ // ç­–ç•¥æ¨¡å¼åˆ©ç”¨ç»„åˆã€å§”æ‰˜å’Œå¤šæ€ç­‰æŠ€æœ¯å’Œæ€æƒ³ï¼Œå¯ä»¥æœ‰æ•ˆåœ°é¿å…å¤šé‡æ¡ä»¶é€‰æ‹©è¯­å¥ã€‚ // ç­–ç•¥æ¨¡å¼æä¾›äº†å¯¹å¼€æ”¾â€” å°é—­åŸåˆ™çš„å®Œç¾æ”¯æŒï¼Œå°†ç®—æ³•å°è£…åœ¨ç‹¬ç«‹çš„strategyä¸­ï¼Œä½¿å¾—å®ƒä»¬æ˜“äºåˆ‡æ¢ï¼Œæ˜“äºç†è§£ï¼Œæ˜“äºæ‰©å±•ã€‚ // ç­–ç•¥æ¨¡å¼ä¸­çš„ç®—æ³•ä¹Ÿå¯ä»¥å¤ç”¨åœ¨ç³»ç»Ÿçš„å…¶ä»–åœ°æ–¹ï¼Œä»è€Œé¿å…è®¸å¤šé‡å¤çš„å¤åˆ¶ç²˜è´´å·¥ä½œã€‚ // åœ¨ç­–ç•¥æ¨¡å¼ä¸­åˆ©ç”¨ç»„åˆå’Œå§”æ‰˜æ¥è®©Context æ‹¥æœ‰æ‰§è¡Œç®—æ³•çš„èƒ½åŠ›ï¼Œè¿™ä¹Ÿæ˜¯ç»§æ‰¿çš„ä¸€ç§æ›´è½»ä¾¿çš„æ›¿ä»£æ–¹æ¡ˆã€‚ // ç¼ºç‚¹ // ä½¿ç”¨ç­–ç•¥æ¨¡å¼ä¼šåœ¨ç¨‹åºä¸­å¢åŠ è®¸å¤šç­–ç•¥ç±»æˆ–è€…ç­–ç•¥å¯¹è±¡ï¼Œä½†å®é™…ä¸Šè¿™æ¯”æŠŠå®ƒä»¬è´Ÿè´£çš„é€»è¾‘å †ç Œåœ¨Context ä¸­è¦å¥½ã€‚ // è¦ä½¿ç”¨ç­–ç•¥æ¨¡å¼ï¼Œå¿…é¡»äº†è§£æ‰€æœ‰çš„strategyï¼Œå¿…é¡»äº†è§£å„ä¸ªstrategy ä¹‹é—´çš„ä¸åŒç‚¹ï¼Œè¿™æ ·æ‰èƒ½é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„strategy,æ­¤æ—¶strategy è¦å‘å®¢æˆ·æš´éœ²å®ƒçš„æ‰€æœ‰å®ç°ï¼Œè¿™æ˜¯è¿åæœ€å°‘çŸ¥è¯†åŸåˆ™çš„ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ä»£ç†æ¨¡å¼åŸºæœ¬å®šä¹‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // ä»£ç†æ¨¡å¼:ä¸ºä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªä»£ç”¨å“æˆ–å ä½ç¬¦ï¼Œä»¥ä¾¿æ§åˆ¶å¯¹å®ƒçš„è®¿é—® // åº”ç”¨åœºæ™¯:å½“ä¸æ–¹ä¾¿ç›´æ¥è®¿é—®æŸä¸ªå¯¹è±¡æ—¶ // åˆ†ç±»: // JSä¸­å¸¸ç”¨: // è™šæ‹Ÿä»£ç†æ¨¡å¼:ä¼šæŠŠä¸€äº›å¼€é”€å¾ˆå¤§çš„å¯¹è±¡ï¼Œå»¶è¿Ÿåˆ°çœŸæ­£éœ€è¦å®ƒçš„æ—¶å€™å†åˆ›å»º(å¸¸ç”¨) // ç¼“å­˜ä»£ç†æ¨¡å¼:å¯ä»¥ä¸ºä¸€äº›å¼€é”€å¾ˆå¤§çš„è¿ç®—ç»“æœæä¾›æš‚æ—¶çš„ç¼“å­˜ï¼Œåœ¨ä¸‹æ¬¡è¿ç®—æ—¶ï¼Œå¦‚æœä¼ é€’è¿›æ¥çš„å‚æ•°è·Ÿä¹‹å‰ä¸€è‡´ï¼Œåˆ™å¯ç›´æ¥è¿”å›ç¼“å­˜çš„ç»“æœ(å¸¸ç”¨) // // ä¸å¸¸ç”¨: // ä¿æŠ¤ä»£ç†æ¨¡å¼:ä»£ç†Bå¯ä»¥å¸®Aè¿‡æ»¤æ‰ä¸€äº›è¯·æ±‚ // é˜²ç«å¢™ä»£ç†æ¨¡å¼:æ§åˆ¶ç½‘ç»œèµ„æºçš„è®¿é—®ï¼Œä¿æŠ¤ä¸»ä½“ä¸è®©"åäºº"æ¥è¿‘ // è¿œç¨‹ä»£ç†æ¨¡å¼:ä¸ºä¸€ä¸ªå¯¹è±¡åœ¨ä¸åŒçš„åœ°å€ç©ºé—´æä¾›å±€éƒ¨ä»£è¡¨ï¼Œåœ¨Java ä¸­ï¼Œè¿œç¨‹ä»£ç†å¯ä»¥æ˜¯å¦ä¸€ä¸ªè™šæ‹Ÿæœºä¸­çš„å¯¹è±¡ã€‚ // ä¿æŠ¤ä»£ç†æ¨¡å¼ï¼šç”¨äºå¯¹è±¡åº”è¯¥æœ‰ä¸åŒè®¿é—®æƒé™çš„æƒ…å†µã€‚ // æ™ºèƒ½å¼•ç”¨ä»£ç†æ¨¡å¼ï¼šå–ä»£äº†ç®€å•çš„æŒ‡é’ˆï¼Œå®ƒåœ¨è®¿é—®å¯¹è±¡æ—¶æ‰§è¡Œä¸€äº›é™„åŠ æ“ä½œï¼Œæ¯”å¦‚è®¡ç®—ä¸€ä¸ªå¯¹è±¡è¢«å¼•ç”¨çš„æ¬¡æ•°ã€‚ // å†™æ—¶å¤åˆ¶ä»£ç†ï¼šé€šå¸¸ç”¨äºå¤åˆ¶ä¸€ä¸ªåºå¤§å¯¹è±¡çš„æƒ…å†µã€‚å†™æ—¶å¤åˆ¶ä»£ç†å»¶è¿Ÿäº†å¤åˆ¶çš„è¿‡ç¨‹ï¼Œå½“å¯¹è±¡è¢«çœŸæ­£ä¿®æ”¹æ—¶ï¼Œæ‰å¯¹å®ƒè¿›è¡Œå¤åˆ¶æ“ä½œã€‚å†™æ—¶å¤åˆ¶ä»£ç†æ˜¯è™šæ‹Ÿä»£ç†çš„ä¸€ç§å˜ä½“ï¼ŒDLLï¼ˆæ“ä½œç³»ç»Ÿä¸­çš„åŠ¨æ€é“¾æ¥åº“ï¼‰æ˜¯å…¶å…¸å‹è¿ç”¨åœºæ™¯ã€‚ // ä½¿ç”¨ä¸¾ä¾‹:å°æ˜æ‰˜äººé€èŠ±ã€è™šæ‹Ÿä»£ç†å®ç°å›¾ç‰‡é¢„åŠ è½½ã€ç¼“å­˜ä»£ç†å¼‚æ­¥ajaxè¯·æ±‚ // å°æ˜å§”æ‰˜Bç»™Aé€èŠ± // var Flower = function() &#123;&#125;; // // å‘èµ·è€… // var xiaoMing = &#123; // sendFolower: function(target) &#123; // var flower = new Flower(); // target.receiveFlower(flower); // &#125; // &#125;; // // æ¥æ”¶è€… // var A = &#123; // receiveFlower: function(flower) &#123; // console.log("æ”¶åˆ°èŠ±" + flower); // &#125; // &#125;; // // è¢«å§”æ‰˜çš„å¯¹è±¡ // var B = &#123; // receiveFlower: function(flower) &#123; // A.receiveFlower(flower); // &#125; // &#125;; // xiaoMing.sendFolower(B); // ä¸è¶³ï¼Œä¸Šé¢è¿™ä¸ªä¾‹å­çœ‹ä¸å‡ºå°æ˜è‡ªå·±é€å’Œæ‰˜Bé€æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œå› ä¸ºBåªæ˜¯ç®€å•çš„æŠŠèŠ±é€’ç»™äº†A // è€ƒè™‘ä¸‹é¢æƒ…å†µ // åœ¨Aå¿ƒæƒ…å¥½çš„æ—¶å€™å°æ˜é€èŠ±ï¼ŒæˆåŠŸç‡å¾ˆé«˜ã€‚å¦‚æœå¿ƒæƒ…ä¸å¥½çš„æ—¶å€™é€èŠ±ï¼Œåˆ™æˆåŠŸç‡ä¸º0ã€‚å°æ˜æ‰è®¤è¯†Aï¼Œå¹¶ä¸çŸ¥é“å¥¹å¿ƒæƒ…çš„å˜åŒ–ï¼Œè€ŒAçš„å¥½æœ‹å‹Bå´å¾ˆäº†è§£ï¼Œæ‰€ä»¥å°æ˜åªç®¡æŠŠèŠ±äº¤ç»™Bï¼ŒBè´Ÿè´£ç›‘å¬Aï¼Œåœ¨Aå¿ƒæƒ…å¥½çš„æ—¶å€™å°†èŠ±ä¼ é€’ç»™A var Flower = function() &#123;&#125;; var xiaoMing = &#123; sendFolower: function(target) &#123; var flower = new Flower(); target.receiveFlower(flower); &#125; &#125;; var A = &#123; receiveFlower: function(flower) &#123; console.log("æ”¶åˆ°èŠ±" + flower); &#125;, listenGoodMood: function(fn) &#123; setTimeout(function() &#123; // å‡è®¾1såå¿ƒæƒ…å˜å¥½ fn(); &#125;, 3000); &#125; &#125;; var B = &#123; receiveFlower: function(flower) &#123; A.listenGoodMood(function() &#123; // ç›‘å¬Açš„å¿ƒæƒ… A.receiveFlower(flower); &#125;); &#125; &#125;; xiaoMing.sendFolower(B); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; è™šæ‹Ÿä»£ç†æ¨¡å¼å®ç°å›¾ç‰‡é¢„åŠ è½½12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // åœ¨Web å¼€å‘ä¸­ï¼Œå›¾ç‰‡é¢„åŠ è½½æ˜¯ä¸€ç§å¸¸ç”¨çš„æŠ€æœ¯ï¼Œå¦‚æœç›´æ¥ç»™æŸä¸ªimgæ ‡ç­¾èŠ‚ç‚¹è®¾ç½®srcå±æ€§ï¼Œç”±äºå›¾ç‰‡è¿‡å¤§æˆ–è€…ç½‘ç»œä¸ä½³ï¼Œå›¾ç‰‡çš„ä½ç½®å¾€å¾€æœ‰æ®µæ—¶é—´ä¼šæ˜¯ä¸€ç‰‡ç©ºç™½ã€‚å¸¸è§çš„åšæ³•æ˜¯å…ˆç”¨ä¸€å¼ loading ç‰‡å ä½ï¼Œç„¶åç”¨å¼‚æ­¥çš„æ–¹å¼åŠ è½½å›¾ç‰‡ï¼Œç­‰å›¾ç‰‡åŠ è½½å¥½äº†å†æŠŠå®ƒå¡«å……åˆ°imgèŠ‚ç‚¹é‡Œï¼Œè¿™ç§åœºæ™¯å°±å¾ˆé€‚åˆä½¿ç”¨è™šæ‹Ÿä»£ç† // éä»£ç†æ¨¡å¼å®ç° // var MyImage = (function() &#123; // var imgNode = document.createElement('img'); // document.body.appendChild(imgNode); // var img = new Image; // img.onload = function() &#123; // imgNode.src = img.src; // &#125;; // return &#123; // setSrc: function(src) &#123; // imgNode.src = 'http://img.zcool.cn/community/013cb15648986a32f87512f6d87dc8.gif'; // img.src = src; // &#125; // &#125; // &#125;)(); // MyImage.setSrc('http://img1.3lian.com/2015/a1/24/d/17.jpg'); // ä¸Šé¢è¿åäº†å•ä¸€èŒè´£åŸåˆ™ï¼ŒMyImageæ—¢è´Ÿè´£ç»™imgè®¾ç½®srcå¤–ï¼Œè¿˜è´Ÿè´£é¢„åŠ è½½å›¾ç‰‡ // è™šæ‹Ÿä»£ç†æ¨¡å¼ // æ™®é€šæœ¬ä½“å¯¹è±¡ï¼Œå¯¹å¤–æä¾›ä¸€ä¸ªsetSrcæ¥å£ var myImage = (function() &#123; var imgNode = document.createElement('img'); document.body.appendChild(imgNode); return &#123; setSrc: function(src) &#123; imgNode.src = src; &#125; &#125; &#125;)(); // ä»£ç†å¯¹è±¡ var proxyImage = (function() &#123; var img = new Image(); img.onload = function() &#123; // çœŸå›¾è¯·æ±‚å®Œæˆï¼Œå°†çœŸå›¾æ”¾åˆ°é¡µé¢ä¸Š myImage.setSrc(this.src); &#125; return &#123; setSrc: function(src) &#123; // è®¾ç½®loadingå›¾ myImage.setSrc('http://img.zcool.cn/community/013cb15648986a32f87512f6d87dc8.gif'); // è®¾ç½®çœŸå›¾åœ°å€ img.src = src; &#125; &#125; &#125;)(); proxyImage.setSrc('http://img1.3lian.com/2015/a1/24/d/17.jpg'); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; è™šæ‹Ÿä»£ç†åˆå¹¶httpè¯·æ±‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;input type="checkbox" id="1"&gt;&lt;/input&gt;1 &lt;input type="checkbox" id="2"&gt;&lt;/input&gt;2 &lt;input type="checkbox" id="3"&gt;&lt;/input&gt;3 &lt;input type="checkbox" id="4"&gt;&lt;/input&gt;4 &lt;input type="checkbox" id="5"&gt;&lt;/input&gt;5 &lt;input type="checkbox" id="6"&gt;&lt;/input&gt;6 &lt;input type="checkbox" id="7"&gt;&lt;/input&gt;7 &lt;input type="checkbox" id="8"&gt;&lt;/input&gt;8 &lt;input type="checkbox" id="9"&gt;&lt;/input&gt;9 &lt;script type="text/javascript"&gt; // å°†å¤šä¸ªHTPPè¯·æ±‚æ‰“åŒ…æˆä¸€ä¸ªï¼Œä¸€æ¬¡å‘å¾€æœåŠ¡å™¨ var synchronousFile = function(id) &#123; console.log("å¼€å§‹åŒæ­¥æ–‡ä»¶,idä¸º:" + id); &#125;; var checkbox = document.getElementsByTagName("input"); for (var i = 0, c; c = checkbox[i++];) &#123; c.onclick = function() &#123; // è¿™æ ·æ¯ç‚¹ä¸€æ¬¡å°±åŒæ­¥ä¸€æ¬¡ï¼Œå¯¹æœåŠ¡å™¨ä¼¤å®³å¾ˆå¤§ï¼Œå¯ä»¥å°†å¤šä¸ªæ‰“åŒ…äº†ï¼Œå†ä¸€å¹¶å‘é€ if (this.checked === true) &#123; proxySynchronousFile(this.id); &#125; &#125;; &#125; // æ·»åŠ ä»£ç†å‡½æ•°ï¼Œè´Ÿè´£æ‰‹æœºä¸€æ®µæ—¶é—´å†…çš„è¯·æ±‚ var proxySynchronousFile = (function() &#123; var cache = [], timer; return function(id) &#123; // å­˜å…¥ç¼“å­˜ cache.push(id); if (timer) &#123; return; &#125; timer = setTimeout(function() &#123; // æ‰§è¡ŒåŒæ­¥ synchronousFile(cache.join(",")); // æ¸…é™¤ clearTimeout(timer); timer = null; cache.length = 0; &#125;, 2000); &#125; &#125;)(); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; è™šæ‹Ÿä»£ç†åœ¨æƒ°æ€§åŠ è½½ä¸­çš„åº”ç”¨1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // åœ¨æŒ‰ç‰¹å®šæŒ‰é”®æ—¶æ‰åŠ è½½å¦å¤–ä¸€ä¸ªjsæ–‡ä»¶ // var cache = []; // var miniConsole = &#123; // log: function() &#123; // var args = arguments; // cache.push(function() &#123; // return miniConsole.log.apply(miniConsole, args); // &#125;); // &#125; // &#125;; // var handler = function(ev) &#123; // if (ev.keyCode === 32) &#123; // // æŒ‰ç©ºæ ¼æ‰ä¼šåˆ›å»ºè„šæœ¬ // var script = document.createElement("script"); // script.src = "js/33.js"; // script.onload = function() &#123; // for (var i = 0, fn; fn = cache[i++];) &#123; // fn(); // &#125; // &#125;; // document.body.appendChild(script); // &#125; // &#125;; // document.body.addEventListener("keydown", handler, false); // miniConsole.log(3); // è¿™æ ·çš„é—®é¢˜æ˜¯åœ¨æ¯æ¬¡æŒ‰ç©ºæ ¼éƒ½ä¼šé‡å¤åˆ›å»ºscript // æ”¹è¿› var miniConsole = (function() &#123; var cache = []; var handler = function(ev) &#123; if (ev.keyCode === 32) &#123; console.log(ev); var script = document.createElement('script'); script.onload = function() &#123; for (var i = 0, fn; fn = cache[i++];) &#123; fn(); &#125; &#125;; script.src = 'js/33.js'; document.body.appendChild(script); document.body.removeEventListener('keydown', handler); // åªåŠ è½½ä¸€æ¬¡33.js &#125; &#125;; document.body.addEventListener('keydown', handler, false); return &#123; log: function() &#123; var args = arguments; cache.push(function() &#123; return miniConsole.log.apply(miniConsole, args); &#125;); &#125; &#125; &#125;)(); miniConsole.log(11); // å¼€å§‹æ‰“å°log &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ç¼“å­˜ä»£ç†123456789101112131415161718192021222324252627282930313233343536373839&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // å¯ä»¥ä¸ºä¸€äº›å¼€é”€å¾ˆå¤§çš„è¿ç®—ç»“æœæä¾›æš‚æ—¶çš„ç¼“å­˜ï¼Œåœ¨ä¸‹æ¬¡è¿ç®—æ—¶ï¼Œå¦‚æœä¼ é€’è¿›æ¥çš„å‚æ•°è·Ÿä¹‹å‰ä¸€è‡´ï¼Œåˆ™å¯ç›´æ¥è¿”å›ç¼“å­˜çš„ç»“æœ // è®¡ç®—ä¹˜ç§¯ var mult = function() &#123; var a = 1; for (var i = 0, len = arguments.length; i &lt; len; i++) &#123; a *= arguments[i]; &#125; return a; &#125;; console.log(mult(2, 3)); console.log(mult(2, 3, 4)); // ä»£ç†å‡½æ•° var proxyMult = (function() &#123; var cache = &#123;&#125;; return function() &#123; var args = Array.prototype.join.call(arguments, ","); if (args in cache) &#123; console.log("æ¥è‡ªç¼“å­˜"); return cache[args]; &#125; return cache[args] = mult.apply(this, arguments); &#125;; &#125;)(); console.log(proxyMult(1, 2, 3, 4)); console.log(proxyMult(1, 2, 3, 4)); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ç”¨é«˜é˜¶å‡½æ•°åŠ¨æ€åˆ›å»ºç¼“å­˜ä»£ç†123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; /**************** è®¡ç®—ä¹˜ç§¯ *****************/ var mult = function() &#123; var a = 1; for (var i = 0, l = arguments.length; i &lt; l; i++) &#123; a = a * arguments[i]; &#125; return a; &#125;; /**************** è®¡ç®—åŠ å’Œ *****************/ var plus = function() &#123; var a = 0; for (var i = 0, l = arguments.length; i &lt; l; i++) &#123; a = a + arguments[i]; &#125; return a; &#125;; /**************** åˆ›å»ºç¼“å­˜ä»£ç†çš„å·¥å‚ *****************/ var createProxyFactory = function(fn) &#123; var cache = &#123;&#125;; return function() &#123; var args = Array.prototype.join.call(arguments, ','); if (args in cache) &#123; console.log("æ¥è‡ªç¼“å­˜"); return cache[args]; &#125; return cache[args] = fn.apply(this, arguments); &#125; &#125;; var proxyMult = createProxyFactory(mult), proxyPlus = createProxyFactory(plus); console.log((proxyMult(1, 2, 3, 4))); // è¾“å‡ºï¼š24 console.log((proxyMult(1, 2, 3, 4))); // è¾“å‡ºï¼š24 console.log((proxyPlus(1, 2, 3, 4))); // è¾“å‡ºï¼š10 console.log((proxyPlus(1, 2, 3, 4))); // è¾“å‡ºï¼š10 &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; è¿­ä»£å™¨æ¨¡å¼åŸºæœ¬å®šä¹‰1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // è¿­ä»£å™¨æ¨¡å¼:æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚å®ƒå°†è¿­ä»£è¿‡ç¨‹ä»ä¸šåŠ¡é€»è¾‘ä¸­æŠ½è±¡å‡ºæ¥ã€‚ // åˆ†ç±»: // å†…éƒ¨è¿­ä»£å™¨:å†…éƒ¨å·²ç»å®šä¹‰å¥½äº†è¿­ä»£è§„åˆ™ï¼Œå®ƒå®Œå…¨æ¥æ‰‹æ•´ä¸ªè¿­ä»£è¿‡ç¨‹ï¼Œå¤–éƒ¨åªéœ€è¦ä¸€æ¬¡åˆå§‹è°ƒç”¨ã€‚ä¼˜ç‚¹:ä¸ç”¨å…³å¿ƒè¿­ä»£å™¨å†…éƒ¨å®ç°ã€‚ç¼ºç‚¹:ä¼˜ç‚¹ä¹Ÿæ˜¯ç¼ºç‚¹ï¼Œå› ä¸ºè¿­ä»£å™¨ä¸­çš„è¿­ä»£è§„åˆ™ä»¥è¢«æå‰è§„å®šå¥½ // å¤–éƒ¨è¿­ä»£å™¨:å¤–éƒ¨è¿­ä»£å™¨å¿…é¡»æ˜¾å¼åœ°è¯·æ±‚è¿­ä»£ä¸‹ä¸€ä¸ªå…ƒç´  // ä½¿ç”¨åœºæ™¯æ˜¯:å¯¹äºé›†åˆå†…éƒ¨ç»“æœå¸¸å¸¸å˜åŒ–å„å¼‚ï¼Œæˆ‘ä»¬ä¸æƒ³æš´éœ²å…¶å†…éƒ¨ç»“æ„çš„è¯ï¼Œä½†åˆå“è®©å®¢æˆ·ä»£ç é€æ˜åº•è®¿é—®å…¶ä¸­çš„å…ƒç´ ï¼Œè¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿­ä»£å™¨æ¨¡å¼ã€‚ // ä½¿ç”¨ä¸¾ä¾‹:å¾ˆå¤šè¯­è¨€éƒ½å†…ç½®äº†è¿­ä»£å™¨å¦‚Array.prototype.forEachã€jQueryä¸­çš„$.each // å®ç°è‡ªå·±çš„each(ä¸€ä¸ªå†…éƒ¨è¿­ä»£å™¨) var each = function(ary, callback) &#123; for (var i = 0, len = ary.length; i &lt; len; i++) &#123; callback.call(ary[i], i, ary[i]); // åœ¨ary[i]ä¸‹è°ƒç”¨callback,ä¼ å…¥ç´¢å¼•iå’Œå…ƒç´ ary[i] &#125; &#125;; // each([1, 2, 3, 4], function(i, n) &#123; // console.log(([i, n])); // &#125;); // ç”¨eachå®Œæˆåˆ¤æ–­ä¸¤ä¸ªæ•°ç»„æ˜¯å¦ç›¸ç­‰ // var compare = function(ary1, ary2) &#123; // // é•¿åº¦ä¸åŒè‚¯å®šä¸ç›¸ç­‰ // if (ary1.length !== ary2.length) &#123; // throw new Error("ä¸ç›¸ç­‰"); // &#125; // // æ¯”è¾ƒå†…éƒ¨å…ƒç´ å€¼ // each(ary1, function(i, n) &#123; // if (n !== ary2[i]) &#123; // throw new Error("ä¸ç›¸ç­‰"); // &#125; // &#125;); // console.log("ç›¸ç­‰"); // &#125;; // compare([1, 2, 3], [1, 2, 4]); // ä½¿ç”¨å¤–éƒ¨è¿­ä»£å™¨æ”¹å†™åˆ¤æ–­æ•°ç»„ç›¸ç­‰ var Iterator = function(obj) &#123; var current = 0; var next = function() &#123; current += 1; &#125;; var isDone = function() &#123; return current &gt;= obj.length; &#125;; var getCurrItem = function() &#123; return obj[current]; &#125;; return &#123; next: next, isDone: isDone, getCurrItem: getCurrItem &#125; &#125;; var compare = function(iterator1, iterator2) &#123; while (!iterator1.isDone() &amp;&amp; !iterator2.isDone()) &#123; if (iterator1.getCurrItem() !== iterator2.getCurrItem()) &#123; throw new Error("ä¸ç›¸ç­‰"); &#125; iterator1.next(); iterator2.next(); &#125; console.log("ç›¸ç­‰"); &#125;; var iterator1 = Iterator([1, 2, 3]); var iterator2 = Iterator([1, 2, 3]); compare(iterator1, iterator2); // è¾“å‡ºï¼šiterator1 å’Œiterator2 ç›¸ç­‰ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; è¿­ä»£ç±»æ•°ç»„å¯¹è±¡å’Œå­—é¢é‡å¯¹è±¡123456789101112131415161718192021222324252627282930313233343536373839&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // æœ¬è´¨ä¸Šï¼Œåªè¦å¯¹è±¡æ‹¥æœ‰lengthå±æ€§çš„éƒ½å¯ä»¥è¿­ä»£ï¼Œargumentså’Œå¯¹è±¡å­—é¢é‡ä¹Ÿå¯ä»¥è¿­ä»£ï¼Œä»¿ç…§jqueryçš„$.eachå†™ä¸€ä¸ªé€šç”¨çš„è¿­ä»£å™¨ each = function(obj, callback) &#123; var value, i = 0, length = obj.length, isArray = isArraylike(obj); if (isArray) &#123; // ç±»æ•°ç»„å¯¹è±¡ for (; i &lt; length; i++) &#123; value = callback.call(obj[i], i, obj[i]); // çº¦å®šå›è°ƒå‡½æ•°è¿”å›falseæ—¶ï¼Œç»ˆæ­¢è¿­ä»£ if (value === false) &#123; break; &#125; &#125; &#125; else &#123; // æ™®é€šå¯¹è±¡ for (i in obj) &#123; value = callback.call(obj[i], i, obj[i]); if (value === false) &#123; break; &#125; &#125; &#125; return obj; &#125;; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å€’åºè¿­ä»£å™¨1234567891011121314151617181920212223&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // å€’åºè¿­ä»£å™¨ var reverseEach = function(ary, callback) &#123; for (var l = ary.length - 1; l &gt;= 0; l--) &#123; callback(l, ary[l]); &#125; &#125;; reverseEach([0, 1, 2], function(i, n) &#123; console.log(n); // åˆ†åˆ«è¾“å‡ºï¼š2, 1 ,0 &#125;); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; è¿­ä»£å™¨æ¨¡å¼å®ç°ä¸Šä¼ ç©ºé—´é€‰æ‹©12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // var getUploadObj = function() &#123; // try &#123; // return new ActiveXObject("TXFTNActiveX.FTNUpload"); // IE ä¸Šä¼ æ§ä»¶ // &#125; catch (e) &#123; // if (supportFlash()) &#123; // supportFlash å‡½æ•°æœªæä¾› // var str = '&lt;object type="application/x-shockwave-flash"&gt;&lt;/object&gt;'; // return $(str).appendTo($('body')); // &#125; else &#123; // var str = '&lt;input name="file" type="file"/&gt;'; // è¡¨å•ä¸Šä¼  // return $(str).appendTo($('body')); // &#125; // &#125; // &#125;; // ä¸Šé¢çš„éš¾ä»¥é˜…è¯»ã€æ‰©å±•ã€ç»´æŠ¤ // å°†è·å–ä¸Šä¼ å¯¹è±¡å°è£…èµ·æ¥ var getActiveUploadObj = function() &#123; try &#123; return new ActiveXObject("TXFTNActiveX.FTNUpload"); // IE ä¸Šä¼ æ§ä»¶ &#125; catch (e) &#123; return false; &#125; &#125;; var getFlashUploadObj = function() &#123; if (isSupportFlash()) &#123; // isSupportFlash å‡½æ•°æœªæä¾› var str = '&lt;object type="application/x-shockwave-flash"&gt;&lt;/object&gt;'; return document.body.innerHTML += str; &#125; return false; &#125;; var getFormUpladObj = function() &#123; var str = '&lt;input name="file" type="file" class="ui-file"/&gt;'; // è¡¨å•ä¸Šä¼  return document.body.innerHTML += str; &#125;; // è¿­ä»£å™¨ var iteratorUploadObj = function() &#123; for (var i = 0, fn; fn = arguments[i++];) &#123; var uploadObj = fn(); if (uploadObj !== false) &#123; return uploadObj; &#125; &#125; &#125;; var uploadObj = iteratorUploadObj(getActiveUploadObj, getFlashUploadObj, getFormUpladObj); console.log(uploadObj); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; è§‚å¯Ÿè€…æ¨¡å¼åŸºæœ¬å®šä¹‰1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // è§‚å¯Ÿè€…æ¨¡å¼åˆå«å‘å¸ƒ-è®¢é˜…æ¨¡å¼ã€‚å®ƒå®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§åœ¨å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å°†å¾—åˆ°é€šçŸ¥ã€‚JSä¸­ä¸€èˆ¬ç”¨äº‹ä»¶æ¨¡å‹æ¥æ›¿ä»£ä¼ ç»Ÿçš„è§‚å¯Ÿè€…æ¨¡å¼ // ä½¿ç”¨åœºæ™¯:åº”ç”¨äºå¼‚æ­¥ç¼–ç¨‹ä¸­ï¼Œè¿™æ˜¯ä¸€ç§æ›¿ä»£ä¼ é€’å›è°ƒå‡½æ•°çš„æ–¹æ¡ˆã€‚å¯ä»¥å–ä»£å¯¹è±¡ä¹‹é—´ç¡¬ç¼–ç çš„é€šçŸ¥æœºåˆ¶ï¼Œä¸€ä¸ªå¯¹è±¡ä¸ç”¨å†æ˜¾å¼åœ°è°ƒç”¨å¦å¤–ä¸€ä¸ªå¯¹è±¡çš„æŸä¸ªæ¥å£ // ä½¿ç”¨ä¸¾ä¾‹:ä¹°æˆ¿ï¼Œåˆ°è¾¾é¢„å”®æ—¶é—´ï¼Œå”®æ¥¼éƒ¨(å‘å¸ƒè€…)ä¼šæ‰“ç”µè¯(é€šè¿‡èŠ±åå†Œï¼Œä¸€ä¸ªç¼“å­˜åˆ—è¡¨ï¼Œæ‹¨æ‰“ç”µè¯è¿‡ç¨‹å°±æ˜¯åœ¨æ‰§è¡Œå›è°ƒå‡½æ•°çš„è¿‡ç¨‹)é€šçŸ¥ä¹°æˆ¿è€…(è®¢é˜…è€…)å¯ä»¥è´­ä¹°äº†ã€‚ // var salesOffices = &#123;&#125;; // å®šä¹‰å”®æ¥¼å¤„ï¼Œå‘å¸ƒè€… // salesOffices.clientList = []; // ç¼“å­˜åˆ—è¡¨ï¼ŒèŠ±åå†Œï¼Œå­˜æ”¾è®¢é˜…è€…çš„å›è°ƒå‡½æ•° // salesOffices.listen = function(fn) &#123; // å¢åŠ è®¢é˜…è€… // this.clientList.push(fn); // è®¢é˜…è€…çš„å›è°ƒå‡½æ•°æ·»åŠ åˆ°ç¼“å­˜åˆ—è¡¨ä¸­ // &#125;; // salesOffices.trigger = function() &#123; // å‘å¸ƒæ¶ˆæ¯ // for (var i = 0, fn; fn = this.clientList[i++];) &#123; // fn.apply(this, arguments); // argumentsæ˜¯å‘å¸ƒæ¶ˆæ¯æ—¶å¸¦ä¸Šçš„å‚æ•° // &#125; // &#125;; // salesOffices.listen(function(price, squareMeter) &#123; // å°æ˜è®¢é˜…æ¶ˆæ¯ // console.log("æˆ‘æ˜¯å°æ˜è®¢é˜…çš„"); // console.log('ä»·æ ¼= ' + price); // console.log('squareMeter= ' + squareMeter); // &#125;); // salesOffices.listen(function(price, squareMeter) &#123; // å°çº¢è®¢é˜…æ¶ˆæ¯ // console.log("æˆ‘æ˜¯å°çº¢è®¢é˜…çš„"); // console.log('ä»·æ ¼= ' + price); // console.log('squareMeter= ' + squareMeter); // &#125;); // // å‘å¸ƒæ¶ˆæ¯ï¼Œæ­¤æ—¶ä¼šé€šçŸ¥æ‰€æœ‰è®¢é˜…è€… // salesOffices.trigger(2000000, 88); // è¾“å‡ºï¼š200 ä¸‡ï¼Œ88 å¹³æ–¹ç±³ // salesOffices.trigger(3000000, 110); // è¾“å‡ºï¼š300 ä¸‡ï¼Œ110 å¹³æ–¹ç±³ // ä¸Šé¢å‡ºç°çš„é—®é¢˜æ—¶ï¼Œå‡å¦‚å°æ˜åªæƒ³ä¹°88å¹³çš„ï¼Œå”®æ¥¼éƒ¨å´æŠŠ110å¹³çš„ä¹Ÿæ¨é€ç»™ä»–äº† var salesOffices = &#123;&#125;; salesOffices.clientList = &#123;&#125;; salesOffices.listen = function(key, fn) &#123; // keyä¸ºè®¢é˜…è€…æƒ³è®¢é˜…çš„æŸä¸ªæ¶ˆæ¯ç±»å‹ï¼Œä¾‹å¦‚å°æ˜æƒ³è®¢é˜…çš„88å¹³ if (!this.clientList[key]) &#123; // å¦‚æœè¿˜æ²¡è®¢é˜…è¿‡æ­¤ç±»æ¶ˆæ¯ï¼Œåˆ™ç»™è¯¥ç±»æ¶ˆæ¯åˆ›å»ºä¸€ä¸ªç¼“å­˜åˆ—è¡¨ this.clientList[key] = []; &#125; this.clientList[key].push(fn); // å°†è®¢é˜…çš„æ¶ˆæ¯æ·»åŠ åˆ°ç¼“å­˜åˆ—è¡¨ä¸­ &#125;; salesOffices.trigger = function() &#123; var key = Array.prototype.shift.call(arguments); // å–å‡ºæ¶ˆæ¯ç±»å‹ var fns = this.clientList[key]; // æ­¤æ¶ˆæ¯ç±»å‹å¯¹åº”çš„å›è°ƒå‡½æ•°åˆ—è¡¨ if (!fns || fns.length === 0) &#123; // æ²¡æœ‰è®¢é˜…è¯¥æ¶ˆæ¯ï¼Œåˆ™è¿”å› return false; &#125; for (var i = 0, fn; fn = fns[i++];) &#123; fn.apply(this, arguments); // å‘å¸ƒæ¶ˆæ¯ &#125; &#125;; salesOffices.listen('squareMeter88', function(price) &#123; // å°æ˜è®¢é˜…88 å¹³æ–¹ç±³æˆ¿å­çš„æ¶ˆæ¯ console.log('ä»·æ ¼= ' + price); // è¾“å‡ºï¼š 2000000 &#125;); salesOffices.listen('squareMeter88', function(price) &#123; // å°å‘¨è®¢é˜…88 å¹³æ–¹ç±³æˆ¿å­çš„æ¶ˆæ¯ console.log('ä»·æ ¼= ' + price); // è¾“å‡ºï¼š 2000000 &#125;); salesOffices.listen('squareMeter110', function(price) &#123; // å°çº¢è®¢é˜…110 å¹³æ–¹ç±³æˆ¿å­çš„æ¶ˆæ¯ console.log('ä»·æ ¼= ' + price); // è¾“å‡ºï¼š 3000000 &#125;); salesOffices.trigger('squareMeter88', 2000000); // å‘å¸ƒ88 å¹³æ–¹ç±³æˆ¿å­çš„ä»·æ ¼ï¼Œæ­¤æ—¶åªæœ‰å°æ˜å’Œå°å‘¨ä¼šæ”¶åˆ°è®¢é˜…æ¶ˆæ¯ salesOffices.trigger('squareMeter110', 3000000); // å‘å¸ƒ110 å¹³æ–¹ç±³æˆ¿å­çš„ä»·æ ¼ï¼Œåªæœ‰å°çº¢èƒ½æ”¶åˆ°æ¶ˆæ¯ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; è§‚å¯Ÿè€…çš„é€šç”¨å®ç°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; var event = &#123; clientList: &#123;&#125;, listen: function(key, fn) &#123; if (!this.clientList[key]) &#123; this.clientList[key] = []; &#125; this.clientList[key].push(fn); &#125;, trigger: function() &#123; var key = Array.prototype.shift.call(arguments); var fns = this.clientList[key]; if (!fns || fns.length === 0) &#123; return false; &#125; for (var i = 0, fn; fn = fns[i++];) &#123; fn.apply(this, arguments); &#125; &#125;, remove: function(key, fn) &#123; var fns = this.clientList[key]; if (!fns) &#123; return false; &#125; if (!fn) &#123; fns &amp;&amp; (fns.length = 0); &#125; else &#123; for (var l = fns.length - 1; l &gt;= 0; l--) &#123; // åå‘éå†è®¢é˜…çš„å›è°ƒå‡½æ•°åˆ—è¡¨ var _fn = fns[l]; if (_fn === fn) &#123; fns.splice(l, 1); // åˆ é™¤è®¢é˜…è€…çš„å›è°ƒå‡½æ•° &#125; &#125; &#125; &#125; &#125;; var cloneObj = function(sourceObject) &#123; var str, newObj = sourceObject.constructor === Array ? [] : &#123;&#125;; if (typeof sourceObject !== 'object') &#123; return; &#125; else &#123; for (var i in sourceObject) &#123; newObj[i] = typeof sourceObject[i] === 'object' ? cloneObj(sourceObject[i]) : sourceObject[i]; &#125; &#125; return newObj; &#125;; var salesOffices = cloneObj(event); salesOffices.listen('squareMeter88', fn1 = function(price) &#123; // å°æ˜è®¢é˜…å”®æ¥¼1 88å¹³æ¶ˆæ¯ console.log('å”®æ¥¼1é€šçŸ¥å°æ˜ä»·æ ¼= ' + price); &#125;); salesOffices.listen('squareMeter88', fn2 = function(price) &#123; // å°å‘¨è®¢é˜…å”®æ¥¼1 88å¹³æ¶ˆæ¯ console.log('å”®æ¥¼1é€šçŸ¥å°å‘¨ä»·æ ¼= ' + price); &#125;); salesOffices.listen('squareMeter100', fn3 = function(price) &#123; // å°çº¢è®¢é˜…å”®æ¥¼1 100å¹³æ¶ˆæ¯ console.log('å”®æ¥¼1é€šçŸ¥å°çº¢ä»·æ ¼= ' + price); &#125;); // å”®æ¥¼1å‘å¸ƒ88å¹³ç±³çš„æ¶ˆæ¯ salesOffices.trigger('squareMeter88', 20000); // è¾“å‡ºï¼š20000 // å”®æ¥¼1å‘å¸ƒ100å¹³ç±³çš„æ¶ˆæ¯ salesOffices.trigger('squareMeter100', 30000); // è¾“å‡ºï¼š20000 console.log("=======================");; console.log("åˆ é™¤å°æ˜è®¢é˜…å”®æ¥¼1"); salesOffices.remove('squareMeter88', fn1); // åˆ é™¤å°æ˜çš„è®¢é˜… salesOffices.trigger('squareMeter88', 20000); // è¾“å‡ºï¼š20000 salesOffices.trigger('squareMeter100', 30000); // è¾“å‡ºï¼š20000 console.log("======================="); var salesOffices2 = cloneObj(event); salesOffices2.listen('squareMeter88', fn21 = function(price) &#123; // å°æ˜è®¢é˜…å”®æ¥¼2 88å¹³æ¶ˆæ¯ console.log('å”®æ¥¼2é€šçŸ¥å°æ˜ä»·æ ¼= ' + price); &#125;); salesOffices2.listen('squareMeter88', fn22 = function(price) &#123; // å°çº¢è®¢é˜…å”®æ¥¼2 100å¹³æ¶ˆæ¯ console.log('å”®æ¥¼2é€šçŸ¥å°çº¢ä»·æ ¼= ' + price); &#125;); // å‘å¸ƒ88å¹³ç±³æ¶ˆæ¯ salesOffices2.trigger('squareMeter88', 25000); // è¾“å‡ºï¼š25000 console.log("=======================");; console.log("åˆ é™¤å°æ˜è®¢é˜…å”®æ¥¼2"); salesOffices2.remove('squareMeter88', fn21); // åˆ é™¤å°æ˜çš„è®¢é˜… salesOffices2.trigger('squareMeter88', 35000); // è¾“å‡ºï¼š35000 &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼å®ç°ç½‘ç«™ç™»å½•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;p&gt;å‡å¦‚æˆ‘ä»¬æ­£åœ¨å¼€å‘ä¸€ä¸ªå•†åŸç½‘ç«™ï¼Œç½‘ç«™é‡Œæœ‰header å¤´éƒ¨ã€nav å¯¼èˆªã€æ¶ˆæ¯åˆ—è¡¨ã€è´­ç‰©è½¦ç­‰æ¨¡å—ã€‚è¿™å‡ ä¸ªæ¨¡å—çš„æ¸²æŸ“æœ‰ä¸€ä¸ªå…±åŒçš„å‰ææ¡ä»¶ï¼Œå°±æ˜¯å¿…é¡»å…ˆç”¨ajaxå¼‚æ­¥è¯·æ±‚è·å–ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯ã€‚ è¿™æ˜¯å¾ˆæ­£å¸¸çš„ï¼Œæ¯”å¦‚ç”¨æˆ·çš„åå­—å’Œå¤´åƒè¦æ˜¾ç¤ºåœ¨header æ¨¡å—é‡Œï¼Œè€Œè¿™ä¸¤ä¸ªå­—æ®µéƒ½æ¥è‡ªç”¨æˆ·ç™»å½•åè¿”å›çš„ä¿¡æ¯ã€‚è‡³äºajax è¯·æ±‚ä»€ä¹ˆæ—¶å€™èƒ½æˆåŠŸè¿”å›ç”¨æˆ·ä¿¡æ¯ï¼Œè¿™ç‚¹æˆ‘ä»¬æ²¡æœ‰åŠæ³•ç¡®å®š&lt;/p&gt; &lt;script type="text/javascript" src="js/jquery-2.2.4.min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript" src="js/mock-min.js"&gt;&lt;/script&gt; &lt;script type="text/javascript"&gt; var event = &#123; clientList: &#123;&#125;, listen: function(key, fn) &#123; if (!this.clientList[key]) &#123; this.clientList[key] = []; &#125; this.clientList[key].push(fn); &#125;, trigger: function() &#123; var key = Array.prototype.shift.call(arguments); var fns = this.clientList[key]; if (!fns || fns.length === 0) &#123; return false; &#125; for (var i = 0, fn; fn = fns[i++];) &#123; fn.apply(this, arguments); &#125; &#125;, remove: function(key, fn) &#123; var fns = this.clientList[key]; if (!fns) &#123; return false; &#125; if (!fn) &#123; fns &amp;&amp; (fns.length = 0); &#125; else &#123; for (var l = fns.length - 1; l &gt;= 0; l--) &#123; // åå‘éå†è®¢é˜…çš„å›è°ƒå‡½æ•°åˆ—è¡¨ var _fn = fns[l]; if (_fn === fn) &#123; fns.splice(l, 1); // åˆ é™¤è®¢é˜…è€…çš„å›è°ƒå‡½æ•° &#125; &#125; &#125; &#125; &#125;; var cloneObj = function(sourceObject) &#123; var str, newObj = sourceObject.constructor === Array ? [] : &#123;&#125;; if (typeof sourceObject !== 'object') &#123; return; &#125; else &#123; for (var i in sourceObject) &#123; newObj[i] = typeof sourceObject[i] === 'object' ? cloneObj(sourceObject[i]) : sourceObject[i]; &#125; &#125; return newObj; &#125;; // ä½¿ç”¨ Mockæ¨¡æ‹Ÿæ•°æ® Mock.setup(&#123; timeout: '500-1000' &#125;); Mock.mock('http://test.cn', &#123; "userName": "@cname", "sex|1": ["ç”·", "å¥³"], "avator": Mock.Random.image('100x100', '#894FC4', '#FFF', 'png', 'å¤´åƒ'), "test|1-3": 3 &#125;); // æ¨¡æ‹Ÿè¯·æ±‚ $.ajax(&#123; url: 'http://test.cn', dataType: 'json' &#125;).done(function(data, status, xhr) &#123; // è¯·æ±‚æˆåŠŸï¼Œè§¦å‘ç™»å½•æˆåŠŸ login.trigger("loginSucc", data); &#125;); var login = cloneObj(event); var header = (function() &#123; // è®¢é˜…ç™»å½•çš„ç™»å½•æˆåŠŸæ¶ˆæ¯ login.listen("loginSucc", function(data) &#123; header.setAvator(data.avator); &#125;); return &#123; setAvator: function(data) &#123; console.log("è®¾ç½®Headeræ¨¡å—å¤´åƒ"); &#125; &#125; &#125;)(); var nav = (function() &#123; login.listen("loginSucc", function(data) &#123; nav.setAvator(data.avator); &#125;); return &#123; setAvator: function(data) &#123; console.log("è®¾ç½®Navæ¨¡å—å¤´åƒ"); &#125; &#125; &#125;)(); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å…¨å±€å‘å¸ƒè®¢é˜…-å¯¹è±¡1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;button id="count"&gt;ç‚¹æˆ‘&lt;/button&gt; &lt;div id="show"&gt;&lt;/div&gt; &lt;script type="text/javascript"&gt; var Event = (function() &#123; var clientList = &#123;&#125;, listen, trigger, remove; listen = function(key, fn) &#123; if (!clientList[key]) &#123; clientList[key] = []; &#125; clientList[key].push(fn); &#125;; trigger = function() &#123; var key = Array.prototype.shift.call(arguments); var fns = clientList[key]; if (!fns || fns.length === 0) &#123; return false; &#125; for (var i = 0, fn; fn = fns[i++];) &#123; fn.apply(this, arguments); &#125; &#125;; remove = function(key, fn) &#123; var fns = clientList[key]; if (!fns) &#123; return false; &#125; if (!fn) &#123; fns &amp;&amp; (fns.length = 0); &#125; else &#123; for (var l = fns.length - 1; l &gt;= 0; l--) &#123; var _fn = fns[l]; if (_fn === fn) &#123; fns.spice(l, 1); &#125; &#125; &#125; &#125;; return &#123; listen: listen, trigger: trigger, remove: remove &#125;; &#125;)(); Event.listen('squareMeter88', function(price) &#123; // å°çº¢è®¢é˜…æ¶ˆæ¯ console.log('ä»·æ ¼= ' + price); // è¾“å‡ºï¼š'ä»·æ ¼=2000000' &#125;); Event.trigger('squareMeter88', 2000000); // å”®æ¥¼å¤„å‘å¸ƒæ¶ˆæ¯ // åˆ©ç”¨å…¨å±€çš„å‘å¸ƒ-è®¢é˜…å¯¹è±¡ï¼Œå¯ä»¥å®ç°æ¨¡å—é—´çš„é€šä¿¡ // ç‚¹å‡»æŒ‰é’®ï¼Œdivä¸­æ˜¾ç¤ºæ€»çš„ç‚¹å‡»æ¬¡æ•° var a = (function() &#123; var count = 0; var button = document.getElementById("count"); button.onclick = function() &#123; Event.trigger("add", count++); &#125;; &#125;)(); var b = (function() &#123; var div = document.getElementById("show"); Event.listen("add", function(count) &#123; div.innerHTML = count; &#125;); &#125;)(); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; æ”¯æŒå…ˆå‘å¸ƒåè®¢é˜…ã€å‘½åç©ºé—´çš„è§‚å¯Ÿè€…æ¨¡å¼123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;pre&gt; æœ‰æ—¶ï¼Œéœ€è¦å…ˆå‘å¸ƒï¼Œå†è®¢é˜…ã€‚å¦‚42ä¸­çš„ç™»å½•ï¼Œè·å–ç™»å½•ä¿¡æ¯å¯èƒ½å¾ˆå¿«ï¼Œä½†å…¶ä»–æ¨¡å—å¯èƒ½åŠ è½½çš„å¾ˆæ…¢ï¼Œå°±ä¼šé€ æˆå·²ç»å‘å¸ƒäº†ç™»å½•æˆåŠŸçš„æ¶ˆæ¯ï¼Œä½†å…¶ä»–æ¨¡å—è¿˜æ²¡æœ‰è®¢é˜…çš„é”™è¯¯ã€‚ æ‰€ä»¥éœ€è¦è®©è§‚å¯Ÿè€…æ¨¡å¼æ”¯æŒå…ˆç¼“å­˜è¦å‘å¸ƒçš„æ¶ˆæ¯ï¼Œç­‰åˆ°æœ‰æ¨¡å—è®¢é˜…æ¶ˆæ¯çš„æ—¶å€™å†æ­£å¼å‘å¸ƒæ¶ˆæ¯ã€‚ å¦å¤–ï¼ŒEventå¯¹è±¡ä¸­åªå­˜åœ¨ä¸€ä¸ªclientListï¼Œå½“è®¢é˜…å¤šäº†ï¼Œå°±å¯èƒ½å‡ºç°å‘½åå†²çªçš„é—®é¢˜ã€‚æ‰€ä»¥è¿˜éœ€è¦æ”¯æŒåˆ›å»ºå‘½åç©ºé—´ã€‚&lt;/pre&gt; &lt;script&gt; var Event = (function() &#123; var global = this, Event, _default = "default"; Event = function() &#123; var _listen, _trigger, _remove, _slice = Array.prototype.slice, _shift = Array.prototype.shift, _unshift = Array.prototype.unshift, namespaceCache = &#123;&#125;, _create, find, each = function(ary, fn) &#123; var ret; for (var i = 0, l = ary.length; i &lt; l; i++) &#123; var n = ary[i]; ret = fn.call(n, i, n); &#125; return ret; &#125;; _listen = function(key, fn, cache) &#123; if (!cache[key]) &#123; cache[key] = []; &#125; cache[key].push(fn); &#125;; _remove = function(key, cache, fn) &#123; if (cache[key]) &#123; if (fn) &#123; for (var i = cache[key].length; i &gt;= 0; i--) &#123; if (cache[key][i] === fn) &#123; cache[key].splice(i, 1); &#125; &#125; &#125; else &#123; cache[key] = &#123;&#125;; &#125; &#125; &#125;; _trigger = function() &#123; var cache = _shift.call(arguments), key = _shift.call(arguments), args = arguments, _self = this, ret, stack = cache[key]; if (!stack || !stack.length) &#123; return; &#125; return each(stack, function() &#123; return this.apply(_self, args); &#125;); &#125;; _create = function(namespace) &#123; var namespace = namespace || _default; var cache = &#123;&#125;, offlineStack = [], // ç¦»çº¿äº‹ä»¶ ret = &#123; listen: function(key, fn, last) &#123; _listen(key, fn, cache); if (offlineStack === null) &#123; return; &#125; if (last === "last") &#123; offlineStack.length &amp;&amp; offlineStack.pop()(); &#125; else &#123; each(offlineStack, function() &#123; this(); &#125;); &#125; offlineStack = null; &#125;, one: function(key, fn, last) &#123; _remove(key, cache); this.listen(key, fn, last); &#125;, remove: function(key, fn) &#123; _remove(key, cache, fn); &#125;, trigger: function() &#123; var fn, args, _self = this; _unshift.call(arguments, cache); args = arguments; fn = function() &#123; return _trigger.apply(_self, args); &#125;; if (offlineStack) &#123; return offlineStack.push(fn); &#125; return fn(); &#125; &#125;; return namespace ? (namespaceCache[namespace] ? namespaceCache[namespace] : namespaceCache[namespace] = ret) : ret; &#125;; return &#123; create: _create, one: function(key, fn, last) &#123; var event = this.create(); event.one(key, fn, last); &#125;, remove: function(key, fn) &#123; var event = this.create(); event.remove(key, fn); &#125;, listen: function(key, fn, last) &#123; var event = this.create(); event.listen(key, fn, last); &#125;, trigger: function() &#123; var event = this.create(); event.trigger.apply(this, arguments); &#125; &#125;; &#125;(); return Event; &#125;)(); /************** å…ˆå‘å¸ƒåè®¢é˜… ********************/ Event.trigger('click', 1); Event.listen('click', function(a) &#123; console.log(a); // è¾“å‡ºï¼š1 &#125;); /************** ä½¿ç”¨å‘½åç©ºé—´ ********************/ Event.create('namespace1').listen('click', function(a) &#123; console.log(a); // è¾“å‡ºï¼š1 &#125;); Event.create('namespace1').trigger('click', 1); Event.create('namespace2').listen('click', function(a) &#123; console.log(a); // è¾“å‡ºï¼š2 &#125;); Event.create('namespace2').trigger('click', 2); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å‘½ä»¤æ¨¡å¼åŸºæœ¬å®šä¹‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;button id="button1"&gt;ç‚¹å‡»æŒ‰é’®1&lt;/button&gt; &lt;button id="button2"&gt;ç‚¹å‡»æŒ‰é’®2&lt;/button&gt; &lt;button id="button3"&gt;ç‚¹å‡»æŒ‰é’®3&lt;/button&gt; &lt;script&gt; // å‘½ä»¤æ¨¡å¼:å‘½ä»¤æ¨¡å¼æ˜¯æœ€ç®€å•å’Œä¼˜é›…çš„æ¨¡å¼ä¹‹ä¸€ï¼Œå‘½ä»¤æ¨¡å¼ä¸­çš„å‘½ä»¤ï¼ˆcommandï¼‰æŒ‡çš„æ˜¯ä¸€ä¸ªæ‰§è¡ŒæŸäº›ç‰¹å®šäº‹æƒ…çš„æŒ‡ä»¤ã€‚ // ä½¿ç”¨åœºæ™¯:æœ‰æ—¶å€™éœ€è¦å‘æŸäº›å¯¹è±¡å‘é€è¯·æ±‚ï¼Œä½†æ˜¯å¹¶ä¸çŸ¥é“è¯·æ±‚çš„æ¥æ”¶è€…æ˜¯è°ï¼Œä¹Ÿä¸çŸ¥é“è¢«è¯·æ±‚çš„æ“ä½œæ˜¯ä»€ä¹ˆã€‚æ­¤æ—¶å¸Œæœ›ç”¨ä¸€ç§æ¾è€¦åˆçš„æ–¹å¼æ¥è®¾è®¡ç¨‹åºï¼Œä½¿å¾—è¯·æ±‚å‘é€è€…å’Œè¯·æ±‚æ¥æ”¶è€…èƒ½å¤Ÿæ¶ˆé™¤å½¼æ­¤ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚ // ä½¿ç”¨ä¸¾ä¾‹:æ‹¿è®¢é¤æ¥è¯´ï¼Œå®¢äººéœ€è¦å‘å¨å¸ˆå‘é€è¯·æ±‚ï¼Œä½†æ˜¯å®Œå…¨ä¸çŸ¥é“è¿™äº›å¨å¸ˆçš„åå­—å’Œè”ç³»æ–¹å¼ï¼Œä¹Ÿä¸çŸ¥é“å¨å¸ˆç‚’èœçš„æ–¹å¼å’Œæ­¥éª¤ã€‚ å‘½ä»¤æ¨¡å¼æŠŠå®¢äººè®¢é¤çš„è¯·æ±‚å°è£…æˆcommand å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è®¢é¤ä¸­çš„è®¢å•å¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡å¯ä»¥åœ¨ç¨‹åºä¸­è¢«å››å¤„ä¼ é€’ï¼Œå°±åƒè®¢å•å¯ä»¥ä»æœåŠ¡å‘˜æ‰‹ä¸­ä¼ åˆ°å¨å¸ˆçš„æ‰‹ä¸­ã€‚è¿™æ ·ä¸€æ¥ï¼Œå®¢äººä¸éœ€è¦çŸ¥é“å¨å¸ˆçš„åå­—ï¼Œä»è€Œè§£å¼€äº†è¯·æ±‚è°ƒç”¨è€…å’Œè¯·æ±‚æ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚ // èœå•ç¨‹åº // ç»˜åˆ¶æŒ‰é’®å’Œç‚¹å‡»æŒ‰é’®çš„å…·ä½“è¡Œä¸ºåˆ†ç¦» // ç‚¹å‡»äº†æŒ‰é’®ä¹‹åï¼Œå¿…é¡»å‘æŸäº›è´Ÿè´£å…·ä½“è¡Œä¸ºçš„å¯¹è±¡å‘é€è¯·æ±‚ï¼Œè¿™äº›å¯¹è±¡å°±æ˜¯è¯·æ±‚çš„æ¥æ”¶è€…ã€‚ä½†æ˜¯ç›®å‰å¹¶ä¸çŸ¥é“æ¥æ”¶è€…æ˜¯ä»€ä¹ˆå¯¹è±¡ï¼Œä¹Ÿä¸çŸ¥é“æ¥æ”¶è€…ç©¶ç«Ÿä¼šåšä»€ä¹ˆã€‚æ­¤æ—¶æˆ‘ä»¬éœ€è¦å€ŸåŠ©å‘½ä»¤å¯¹è±¡çš„å¸®åŠ©ï¼Œä»¥ä¾¿è§£å¼€æŒ‰é’®å’Œè´Ÿè´£å…·ä½“è¡Œä¸ºå¯¹è±¡ä¹‹é—´çš„è€¦åˆã€‚ // // ä¼ ç»Ÿé¢å‘å¯¹è±¡è¯­è¨€ä¸­çš„å‘½ä»¤æ¨¡å¼ // var button1 = document.getElementById('button1'), // button2 = document.getElementById('button2'), // button3 = document.getElementById('button3'); // // è´Ÿè´£å¾€æŒ‰é’®ä¸Šå®‰è£…å‘½ä»¤ // var setCommand = function(button, command) &#123; // button.onclick = function() &#123; // command.execute(); // &#125;; // &#125;; // var MenuBar = &#123; // refresh: function() &#123; // console.log('åˆ·æ–°èœå•ç›®å½•'); // &#125; // &#125;; // var SubMenu = &#123; // add: function() &#123; // console.log('å¢åŠ å­èœå•'); // &#125;, // del: function() &#123; // console.log('åˆ é™¤å­èœå•'); // &#125; // &#125;; // // æ„å»ºå‘½ä»¤ // var RefreshMenuBarCommand = function(receiver) &#123; // this.receiver = receiver; // &#125;; // RefreshMenuBarCommand.prototype.execute = function() &#123; // this.receiver.refresh(); // &#125;; // var AddSubMenuCommand = function(receiver) &#123; // this.receiver = receiver; // &#125;; // AddSubMenuCommand.prototype.execute = function() &#123; // this.receiver.add(); // &#125;; // var DelSubMenuCommand = function(receiver) &#123; // this.receiver = receiver; // &#125;; // DelSubMenuCommand.prototype.execute = function() &#123; // console.log('åˆ é™¤å­èœå•'); // &#125;; // // å®ä¾‹åŒ–å‘½ä»¤ // var refreshMenuBarCommand = new RefreshMenuBarCommand(MenuBar); // var addSubMenuCommand = new AddSubMenuCommand(SubMenu); // var delSubMenuCommand = new DelSubMenuCommand(SubMenu); // // å®‰è£…å‘½ä»¤ // setCommand(button1, refreshMenuBarCommand); // setCommand(button2, addSubMenuCommand); // setCommand(button3, delSubMenuCommand); // // åœ¨jsä¸­ä½¿ç”¨é—­åŒ…å®ç°å‘½ä»¤æ¨¡å¼ // var button1 = document.getElementById('button1'); // var setCommand = function(button, func) &#123; // button.onclick = function() &#123; // func(); // &#125;; // &#125; // var MenuBar = &#123; // refresh: function() &#123; // console.log("åˆ·æ–°èœå•ç•Œé¢"); // &#125; // &#125;; // var RefreshMenuBarCommand = function(receiver) &#123; // return function() &#123; // receiver.refresh(); // &#125;; // &#125;; // var refreshMenuBarCommand = RefreshMenuBarCommand(MenuBar); // setCommand(button1, refreshMenuBarCommand); // ä¸ºäº†æ›´æ˜ç¡®çš„è¡¨è¾¾å½“å‰æ­£åœ¨ç”¨å‘½ä»¤æ¨¡å¼ï¼Œæˆ–è€…å°†æ¥æœ‰å¯èƒ½æä¾›æ’¤é”€æ“ä½œæ—¶ï¼Œå¯ä»¥å°†æ‰§è¡Œå‡½æ•°æ”¹ä¸ºè°ƒç”¨executeæ–¹æ³• var RefreshMenuBarCommand = function(receiver) &#123; return &#123; execute: function() &#123; receiver.refresh(); &#125; &#125; &#125;; var button1 = document.getElementById('button1'); var setCommand = function(button, command) &#123; button.onclick = function() &#123; command.execute(); &#125;; &#125;; var MenuBar = &#123; refresh: function() &#123; console.log("åˆ·æ–°èœå•ç•Œé¢"); &#125; &#125;; var refreshMenuBarCommand = RefreshMenuBarCommand(MenuBar); setCommand(button1, refreshMenuBarCommand); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å¸¦æ’¤é”€çš„å‘½ä»¤æ¨¡å¼123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;div id="ball" style="position:absolute;background:#000;width:50px;height:50px"&gt;&lt;/div&gt; è¾“å…¥å°çƒç§»åŠ¨åçš„ä½ç½®ï¼š &lt;input id="pos" /&gt; &lt;button id="moveBtn"&gt;å¼€å§‹ç§»åŠ¨&lt;/button&gt; &lt;!--å¢åŠ å–æ¶ˆæŒ‰é’®--&gt; &lt;button id="cancelBtn"&gt;cancel&lt;/button&gt; &lt;script type="text/javascript"&gt; var tween = &#123; linear: function(t, b, c, d) &#123; return c * t / d + b; &#125;, easeIn: function(t, b, c, d) &#123; return c * (t /= d) * t + b; &#125;, strongEaseIn: function(t, b, c, d) &#123; return c * (t /= d) * t * t * t * t + b; &#125;, strongEaseOut: function(t, b, c, d) &#123; return c * ((t = t / d - 1) * t * t * t * t + 1) + b; &#125;, sineaseIn: function(t, b, c, d) &#123; return c * (t /= d) * t * t + b; &#125;, sineaseOut: function(t, b, c, d) &#123; return c * ((t = t / d - 1) * t * t + 1) + b; &#125; &#125;; var Animate = function(dom) &#123; this.dom = dom; this.startTime = 0; this.startPos = 0; this.endPos = 0; this.propertyName = null; this.easing = null; this.duration = null; &#125;; Animate.prototype.start = function(propertyName, endPos, duration, easing) &#123; this.startTime = +new Date; this.startPos = this.dom.getBoundingClientRect()[propertyName]; this.propertyName = propertyName; this.endPos = endPos; this.duration = duration; this.easing = tween[easing]; var self = this; var timeId = setInterval(function() &#123; if (self.step() === false) &#123; clearInterval(timeId); &#125; &#125;, 1000 / 60); &#125;; Animate.prototype.step = function() &#123; var t = +new Date; if (t &gt;= this.startTime + this.duration) &#123; this.update(this.endPos); return false; &#125; var pos = this.easing(t - this.startTime, this.startPos, this.endPos - this.startPos, this.duration); this.update(pos); &#125;; Animate.prototype.update = function(pos) &#123; this.dom.style[this.propertyName] = pos + 'px'; &#125;; // ä»¥ä¸Šä¸ºè¿åŠ¨ç®—æ³• // ä¸‹é¢é€šè¿‡å‘½ä»¤æ¨¡å¼å®ç°è¿åŠ¨ä»¥åŠæ’¤é”€åŠŸèƒ½ var ball = document.getElementById('ball'); var pos = document.getElementById('pos'); var moveBtn = document.getElementById('moveBtn'); var cancelBtn = document.getElementById('cancelBtn'); var MoveCommand = function(receiver, pos) &#123; this.receiver = receiver; this.pos = pos; this.oldPos = null; &#125;; MoveCommand.prototype.execute = function() &#123; this.receiver.start('left', this.pos, 1000, 'strongEaseOut'); // è®°å½•å°çƒå¼€å§‹ç§»åŠ¨å‰çš„ä½ç½® this.oldPos = this.receiver.dom.getBoundingClientRect()[this.receiver.propertyName]; &#125;; MoveCommand.prototype.undo = function() &#123; // å›åˆ°å°çƒç§»åŠ¨å‰è®°å½•çš„ä½ç½® this.receiver.start('left', this.oldPos, 1000, 'strongEaseOut'); &#125;; var moveCommand; moveBtn.onclick = function() &#123; var animate = new Animate(ball); moveCommand = new MoveCommand(animate, pos.value); moveCommand.execute(); &#125;; cancelBtn.onclick = function() &#123; moveCommand.undo(); // æ’¤é”€å‘½ä»¤ &#125;; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ä½¿ç”¨å‘½ä»¤æ¨¡å¼å®ç°é‡åš12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;button id="replay"&gt;æ’­æ”¾å½•åƒ&lt;/button&gt; &lt;script&gt; var Ryu = &#123; attack: function() &#123; console.log('æ”»å‡»'); &#125;, defense: function() &#123; console.log('é˜²å¾¡'); &#125;, jump: function() &#123; console.log('è·³è·ƒ'); &#125;, crouch: function() &#123; console.log('è¹²ä¸‹'); &#125; &#125;; var makeCommand = function(receiver, state) &#123; // åˆ›å»ºå‘½ä»¤ return function() &#123; receiver[state](); &#125; &#125;; var commands = &#123; "119": "jump", // W "115": "crouch", // S "97": "defense", // A "100": "attack" // D &#125;; var commandStack = []; // ä¿å­˜å‘½ä»¤çš„å †æ ˆ document.onkeypress = function(ev) &#123; var keyCode = ev.keyCode, command = makeCommand(Ryu, commands[keyCode]); if (command) &#123; command(); // æ‰§è¡Œå‘½ä»¤ commandStack.push(command); // å°†åˆšåˆšæ‰§è¡Œè¿‡çš„å‘½ä»¤ä¿å­˜è¿›å †æ ˆ &#125; &#125;; document.getElementById('replay').onclick = function() &#123; // ç‚¹å‡»æ’­æ”¾å½•åƒ var command; while (command = commandStack.shift()) &#123; // ä»å †æ ˆé‡Œä¾æ¬¡å–å‡ºå‘½ä»¤å¹¶æ‰§è¡Œ command(); &#125; &#125;; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å®å‘½ä»¤1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; var closeDoorCommand = &#123; execute: function() &#123; console.log('å…³é—¨'); &#125; &#125;; var openPcCommand = &#123; execute: function() &#123; console.log('å¼€ç”µè„‘'); &#125; &#125;; var openQQCommand = &#123; execute: function() &#123; console.log('ç™»å½•QQ'); &#125; &#125;; var MacroCommand = function() &#123; return &#123; commandList: [], add: function(command) &#123; this.commandList.push(command); &#125;, execute: function() &#123; for (var i = 0, command; command = this.commandList[i++];) &#123; command.execute(); &#125; &#125; &#125;; &#125;; var macroCommand = MacroCommand(); macroCommand.add(closeDoorCommand); macroCommand.add(openPcCommand); macroCommand.add(openQQCommand); macroCommand.execute(); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ç»„åˆæ¨¡å¼åŸºæœ¬å®šä¹‰1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // ç»„åˆæ¨¡å¼:ç»„åˆæ¨¡å¼å°±æ˜¯ç”¨å°çš„å­å¯¹è±¡æ¥æ„å»ºæ›´å¤§çš„å¯¹è±¡ï¼Œè€Œè¿™äº›å°çš„å­å¯¹è±¡æœ¬èº«ä¹Ÿè®¸æ˜¯ç”±æ›´å°çš„â€œå­™å¯¹è±¡â€æ„æˆçš„ã€‚ // ç»„åˆæ¨¡å¼å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ï¼Œä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ã€‚ç»„åˆæ¨¡å¼å¯ä»¥éå¸¸æ–¹ä¾¿åœ°æè¿°å¯¹è±¡éƒ¨åˆ†-æ•´ä½“å±‚æ¬¡ç»“æ„ã€‚ é™¤äº†ç”¨æ¥è¡¨ç¤ºæ ‘å½¢ç»“æ„ä¹‹å¤–ï¼Œç»„åˆæ¨¡å¼çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯é€šè¿‡å¯¹è±¡çš„å¤šæ€æ€§è¡¨ç°ï¼Œä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚åˆ©ç”¨å¯¹è±¡å¤šæ€æ€§ç»Ÿä¸€å¯¹å¾…ç»„åˆå¯¹è±¡å’Œå•ä¸ªå¯¹è±¡ã€‚åˆ©ç”¨å¯¹è±¡çš„å¤šæ€æ€§è¡¨ç°ï¼Œå¯ä»¥ä½¿å®¢æˆ·ç«¯å¿½ç•¥ç»„åˆå¯¹è±¡å’Œå•ä¸ªå¯¹è±¡çš„ä¸åŒã€‚åœ¨ç»„åˆæ¨¡å¼ä¸­ï¼Œå®¢æˆ·å°†ç»Ÿä¸€åœ°ä½¿ç”¨ç»„åˆç»“æ„ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼Œè€Œä¸éœ€è¦å…³å¿ƒå®ƒç©¶ç«Ÿæ˜¯ç»„åˆå¯¹è±¡è¿˜æ˜¯å•ä¸ªå¯¹è±¡ã€‚ // ä½¿ç”¨åœºæ™¯:è¡¨ç¤ºå¯¹è±¡çš„éƒ¨åˆ†-æ•´ä½“å±‚æ¬¡ç»“æ„ã€‚ç»„åˆæ¨¡å¼å¯ä»¥æ–¹ä¾¿åœ°æ„é€ ä¸€æ£µæ ‘æ¥è¡¨ç¤ºå¯¹è±¡çš„éƒ¨åˆ†-æ•´ä½“ç»“æ„ã€‚ç‰¹åˆ«æ˜¯æˆ‘ä»¬åœ¨å¼€å‘æœŸé—´ä¸ç¡®å®šè¿™æ£µæ ‘åˆ°åº•å­˜åœ¨å¤šå°‘å±‚æ¬¡çš„æ—¶å€™ã€‚åœ¨æ ‘çš„æ„é€ æœ€ç»ˆå®Œæˆä¹‹åï¼Œåªéœ€è¦é€šè¿‡è¯·æ±‚æ ‘çš„æœ€é¡¶å±‚å¯¹è±¡ï¼Œä¾¿èƒ½å¯¹æ•´æ£µæ ‘åšç»Ÿä¸€çš„æ“ä½œã€‚åœ¨ç»„åˆæ¨¡å¼ä¸­å¢åŠ å’Œåˆ é™¤æ ‘çš„èŠ‚ç‚¹éå¸¸æ–¹ä¾¿ï¼Œå¹¶ä¸”ç¬¦åˆå¼€æ”¾-å°é—­åŸåˆ™;å®¢æˆ·å¸Œæœ›ç»Ÿä¸€å¯¹å¾…æ ‘ä¸­çš„æ‰€æœ‰å¯¹è±¡ã€‚ç»„åˆæ¨¡å¼ä½¿å®¢æˆ·å¯ä»¥å¿½ç•¥ç»„åˆå¯¹è±¡å’Œå¶å¯¹è±¡çš„åŒºåˆ«ï¼Œå®¢æˆ·åœ¨é¢å¯¹è¿™æ£µæ ‘çš„æ—¶å€™ï¼Œä¸ç”¨å…³å¿ƒå½“å‰æ­£åœ¨å¤„ç†çš„å¯¹è±¡æ˜¯ç»„åˆå¯¹è±¡è¿˜æ˜¯å¶å¯¹è±¡ï¼Œä¹Ÿå°±ä¸ç”¨å†™ä¸€å †ifã€elseè¯­å¥æ¥åˆ†åˆ«å¤„ç†å®ƒä»¬ã€‚ç»„åˆå¯¹è±¡å’Œå¶å¯¹è±¡ä¼šå„è‡ªåšè‡ªå·±æ­£ç¡®çš„äº‹æƒ…ï¼Œè¿™æ˜¯ç»„åˆæ¨¡å¼æœ€é‡è¦çš„èƒ½åŠ›ã€‚ // ä½¿ç”¨ä¸¾ä¾‹:æ‰«ææ–‡ä»¶å¤¹,æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ä¹‹é—´çš„å…³ç³»ï¼Œéå¸¸é€‚åˆç”¨ç»„åˆæ¨¡å¼æ¥æè¿°ã€‚æ–‡ä»¶å¤¹é‡Œæ—¢å¯ä»¥åŒ…å«æ–‡ä»¶ï¼Œåˆå¯ä»¥åŒ…å«å…¶ä»–æ–‡ä»¶å¤¹ /***************æ–‡ä»¶å¤¹*******************/ var Folder = function(name) &#123; this.name = name; this.files = []; &#125;; Folder.prototype.add = function(file) &#123; this.files.push(file); &#125;; Folder.prototype.scan = function() &#123; console.log("å¼€å§‹æ‰«ææ–‡ä»¶å¤¹:" + this.name); for (var i = 0, file, files = this.files; file = files[i++];) &#123; file.scan(); &#125; &#125;; /*****************æ–‡ä»¶*******************/ var File = function(name) &#123; this.name = name; &#125;; File.prototype.add = function() &#123; throw new Error("æ–‡ä»¶ä¸‹é¢ä¸èƒ½å†æ·»åŠ æ–‡ä»¶"); &#125;; File.prototype.scan = function() &#123; console.log("å¼€å§‹æ‰«ææ–‡ä»¶:" + this.name); &#125;; /****åˆ›å»ºæ–‡ä»¶å¤¹åŠæ–‡ä»¶****/ var folder = new Folder('å­¦ä¹ èµ„æ–™'); var folder1 = new Folder('JavaScript'); var folder2 = new Folder('jQuery'); var file1 = new File('JavaScript è®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ'); var file2 = new File('ç²¾é€šjQuery'); var file3 = new File('é‡æ„ä¸æ¨¡å¼') folder1.add(file1); folder2.add(file2); folder.add(folder1); folder.add(folder2); var folder3 = new Folder('Nodejs'); var file4 = new File('æ·±å…¥æµ…å‡ºNode.js'); folder3.add(file4); var file5 = new File('JavaScript è¯­è¨€ç²¾é«“ä¸ç¼–ç¨‹å®è·µ'); folder.add(folder3); folder.add(file5); /****æ‰«ææ–‡ä»¶å¤¹****/ folder.scan(); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ç»„åˆæ¨¡å¼-å¼•ç”¨çˆ¶å¯¹è±¡1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // åœ¨49çš„åŸºç¡€ä¸Šè¦æ·»åŠ åˆ é™¤åŠŸèƒ½ï¼Œä¾‹å¦‚åˆ é™¤æŸä¸ªæ–‡ä»¶çš„æ—¶å€™ï¼Œå…¶å®æ˜¯åœ¨å…¶ä¸Šå±‚æ–‡ä»¶å¤¹ä¸­åˆ é™¤è¯¥æ–‡ä»¶ã€‚æ­¤æ—¶æ–‡ä»¶å°±å¿…é¡»è¦ä¿å­˜ä¸Šå±‚å¯¹è±¡çš„å¼•ç”¨ var Folder = function(name) &#123; this.name = name; this.parent = null; //å¢åŠ this.parent å±æ€§ this.files = []; &#125;; Folder.prototype.add = function(file) &#123; file.parent = this; //è®¾ç½®çˆ¶å¯¹è±¡ this.files.push(file); &#125;; Folder.prototype.scan = function() &#123; console.log('å¼€å§‹æ‰«ææ–‡ä»¶å¤¹: ' + this.name); for (var i = 0, file, files = this.files; file = files[i++];) &#123; file.scan(); &#125; &#125;; // å¢åŠ åˆ é™¤åŠŸèƒ½ Folder.prototype.remove = function() &#123; if (!this.parent) &#123; //æ ¹èŠ‚ç‚¹æˆ–è€…æ ‘å¤–çš„æ¸¸ç¦»èŠ‚ç‚¹ return; &#125; for (var files = this.parent.files, l = files.length - 1; l &gt;= 0; l--) &#123; var file = files[l]; if (file === this) &#123; files.splice(l, 1); &#125; &#125; &#125;; var File = function(name) &#123; this.name = name; this.parent = null; &#125;; File.prototype.add = function() &#123; throw new Error('ä¸èƒ½æ·»åŠ åœ¨æ–‡ä»¶ä¸‹é¢'); &#125;; File.prototype.scan = function() &#123; console.log('å¼€å§‹æ‰«ææ–‡ä»¶: ' + this.name); &#125;; File.prototype.remove = function() &#123; if (!this.parent) &#123; //æ ¹èŠ‚ç‚¹æˆ–è€…æ ‘å¤–çš„æ¸¸ç¦»èŠ‚ç‚¹ return; &#125; for (var files = this.parent.files, l = files.length - 1; l &gt;= 0; l--) &#123; var file = files[l]; if (file === this) &#123; files.splice(l, 1); &#125; &#125; &#125;; var folder = new Folder('å­¦ä¹ èµ„æ–™'); var folder1 = new Folder('JavaScript'); var file1 = new Folder('æ·±å…¥æµ…å‡ºNode.js'); folder1.add(new File('JavaScript è®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ')); folder.add(folder1); folder.add(file1); folder.scan(); console.log("/******ç§»é™¤æ–‡ä»¶å¤¹******/"); folder1.remove(); folder.scan(); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; æ¨¡æ¿æ–¹æ³•æ¨¡å¼åŸºæœ¬å®šä¹‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // æ¨¡æ¿æ–¹æ³•æ¨¡å¼:ä¸€ç§åŸºäºç»§æ‰¿çš„è®¾è®¡æ¨¡å¼ // æ„æˆ:ç¬¬ä¸€éƒ¨åˆ†æ˜¯æŠ½è±¡çˆ¶ç±»ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯å…·ä½“çš„å®ç°å­ç±»;é€šå¸¸åœ¨æŠ½è±¡çˆ¶ç±»ä¸­å°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æ¶ï¼ŒåŒ…æ‹¬å®ç°ä¸€äº›å…¬å…±æ–¹æ³•ä»¥åŠå°è£…å­ç±»ä¸­æ‰€æœ‰æ–¹æ³•çš„æ‰§è¡Œé¡ºåºã€‚å­ç±»é€šè¿‡ç»§æ‰¿è¿™ä¸ªæŠ½è±¡ç±»ï¼Œä¹Ÿç»§æ‰¿äº†æ•´ä¸ªç®—æ³•ç»“æ„ï¼Œå¹¶ä¸”å¯ä»¥é€‰æ‹©é‡å†™çˆ¶ç±»çš„æ–¹æ³•;çˆ¶ç±»å°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æ¶å’Œæ–¹æ³•çš„æ‰§è¡Œé¡ºåºï¼Œå­ç±»ç»§æ‰¿çˆ¶ç±»ä¹‹åï¼Œçˆ¶ç±»é€šçŸ¥å­ç±»æ‰§è¡Œè¿™äº›æ–¹æ³•ï¼Œå¥½è±ååŸåˆ™å¾ˆå¥½åœ°è¯ é‡Šäº†è¿™ç§è®¾è®¡æŠ€å·§ï¼Œå³é«˜å±‚ç»„ä»¶è°ƒç”¨åº•å±‚ç»„ä»¶ã€‚ // ä½¿ç”¨åœºæ™¯:ä»å¤§çš„æ–¹é¢æ¥è®²ï¼Œæ¨¡æ¿æ–¹æ³•æ¨¡å¼å¸¸è¢«æ¶æ„å¸ˆç”¨äºæ­å»ºé¡¹ç›®çš„æ¡†æ¶ï¼Œæ¶æ„å¸ˆå®šå¥½äº†æ¡†æ¶çš„éª¨æ¶ï¼Œç¨‹åºå‘˜ç»§æ‰¿æ¡†æ¶çš„ç»“æ„ä¹‹åï¼Œè´Ÿè´£å¾€é‡Œé¢å¡«ç©ºã€‚ // åœ¨Web å¼€å‘ä¸­ä¹Ÿèƒ½æ‰¾åˆ°å¾ˆå¤šæ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„é€‚ç”¨åœºæ™¯ // æ¯”å¦‚æˆ‘ä»¬åœ¨æ„å»ºä¸€ç³»åˆ—çš„UI ç»„ä»¶è¿™äº›ç»„ä»¶çš„æ„å»ºè¿‡ç¨‹ä¸€èˆ¬å¦‚ä¸‹æ‰€ç¤ºï¼š // (1) åˆå§‹åŒ–ä¸€ä¸ªdiv å®¹å™¨ï¼› // (2) é€šè¿‡ajax è¯·æ±‚æ‹‰å–ç›¸åº”çš„æ•°æ®ï¼› // (3) æŠŠæ•°æ®æ¸²æŸ“åˆ°div å®¹å™¨é‡Œé¢ï¼Œå®Œæˆç»„ä»¶çš„æ„é€ ï¼› // (4) é€šçŸ¥ç”¨æˆ·ç»„ä»¶æ¸²æŸ“å®Œæ¯•ã€‚ // æˆ‘ä»¬çœ‹åˆ°ï¼Œ ä»»ä½•ç»„ä»¶çš„æ„å»ºéƒ½éµå¾ªä¸Šé¢çš„4æ­¥ï¼Œå…¶ä¸­ç¬¬(1)æ­¥å’Œç¬¬(4)æ­¥æ˜¯ç›¸åŒçš„ã€‚ç¬¬(2)æ­¥ä¸åŒçš„åœ°æ–¹åªæ˜¯è¯·æ±‚ajaxçš„è¿œç¨‹åœ°å€ï¼Œç¬¬(3)æ­¥ä¸åŒçš„åœ°æ–¹æ˜¯æ¸²æŸ“æ•°æ®çš„æ–¹å¼ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥æŠŠè¿™4ä¸ªæ­¥éª¤éƒ½æŠ½è±¡åˆ°çˆ¶ç±»çš„æ¨¡æ¿æ–¹æ³•é‡Œé¢ï¼Œçˆ¶ç±»ä¸­è¿˜å¯ä»¥é¡ºä¾¿æä¾›ç¬¬(1)æ­¥å’Œç¬¬(4)æ­¥çš„å…·ä½“å®ç°ã€‚å½“å­ç±»ç»§æ‰¿è¿™ä¸ªçˆ¶ç±»ä¹‹åï¼Œä¼šé‡å†™æ¨¡æ¿æ–¹æ³•é‡Œé¢çš„ç¬¬(2)æ­¥å’Œç¬¬(3)æ­¥ã€‚ // ä½¿ç”¨ä¸¾ä¾‹:æ³¡å’–å•¡å’Œæ³¡èŒ¶ // æ³¡å’–å•¡ // (1) æŠŠæ°´ç…®æ²¸ // (2) ç”¨æ²¸æ°´å†²æ³¡å’–å•¡ // (3) æŠŠå’–å•¡å€’è¿›æ¯å­ // (4) åŠ ç³–å’Œç‰›å¥¶ // æ³¡èŒ¶ // (1) æŠŠæ°´ç…®æ²¸ // (2) ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶ // (3) æŠŠèŒ¶æ°´å€’è¿›æ¯å­ // (4) åŠ æŸ æª¬ // äºŒè€…åŸºæœ¬æ­¥éª¤æ˜¯ç›¸åŒï¼Œä¸åŒçš„åœ°æ–¹æœ‰ // åŸæ–™ä¸åŒã€‚ä¸€ä¸ªæ˜¯å’–å•¡ï¼Œä¸€ä¸ªæ˜¯èŒ¶ï¼Œä½†æˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬éƒ½æŠ½è±¡ä¸ºâ€œé¥®æ–™â€ã€‚ // æ³¡çš„æ–¹å¼ä¸åŒã€‚å’–å•¡æ˜¯å†²æ³¡ï¼Œè€ŒèŒ¶å¶æ˜¯æµ¸æ³¡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬éƒ½æŠ½è±¡ä¸ºâ€œæ³¡â€ã€‚ // åŠ å…¥çš„è°ƒæ–™ä¸åŒã€‚ä¸€ä¸ªæ˜¯ç³–å’Œç‰›å¥¶ï¼Œä¸€ä¸ªæ˜¯æŸ æª¬ï¼Œä½†æˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»¬éƒ½æŠ½è±¡ä¸ºâ€œè°ƒæ–™â€ã€‚ // æŠ½è±¡ä¹‹å // (1) æŠŠæ°´ç…®æ²¸ // (2) ç”¨æ²¸æ°´å†²æ³¡é¥®æ–™ // (3) æŠŠé¥®æ–™å€’è¿›æ¯å­ // (4) åŠ è°ƒæ–™ // æŠ½è±¡çˆ¶ç±»-é¥®æ–™ç±» var Beverage = function() &#123;&#125;; // çƒ§æ°´ Beverage.prototype.boilWater = function() &#123; console.log("æŠŠæ°´ç…®æ²¸"); &#125;; // æ³¡ Beverage.prototype.brew = function() &#123; throw new Error('å­ç±»å¿…é¡»é‡å†™brewæ–¹æ³•'); &#125;; // ç©ºæ–¹æ³•ï¼Œåº”è¯¥ç”±å­ç±»é‡å†™ï¼Œè‹¥å­ç±»å¿˜è®°é‡å†™ï¼Œå¯åœ¨çˆ¶ç±»ä¸Šæ·»åŠ ä¸€ä¸ªé”™è¯¯æé†’ä¿¡æ¯ // å€’å…¥æ¯å­ Beverage.prototype.pourInCup = function() &#123; throw new Error('å­ç±»å¿…é¡»é‡å†™pourInCupæ–¹æ³•'); &#125;; // ç©ºæ–¹æ³•ï¼Œåº”è¯¥ç”±å­ç±»é‡å†™ // åŠ è°ƒæ–™ Beverage.prototype.addCondiments = function() &#123; throw new Error('å­ç±»å¿…é¡»é‡å†™addCondimentsæ–¹æ³•'); &#125;; // ç©ºæ–¹æ³•ï¼Œåº”è¯¥ç”±å­ç±»é‡å†™ Beverage.prototype.init = function() &#123; this.boilWater(); this.brew(); this.pourInCup(); this.addCondiments(); &#125;; // æŠ½è±¡å­ç±»-coffee var Coffee = function() &#123;&#125;; // ç»§æ‰¿é¥®æ–™ç±» Coffee.prototype = new Beverage(); // é‡å†™æ³¡ã€å€’å…¥æ¯å­ã€åŠ è°ƒæ–™æ–¹æ³• Coffee.prototype.brew = function() &#123; console.log('ç”¨æ²¸æ°´å†²æ³¡å’–å•¡'); &#125;; Coffee.prototype.pourInCup = function() &#123; console.log('æŠŠå’–å•¡å€’è¿›æ¯å­'); &#125;; Coffee.prototype.addCondiments = function() &#123; console.log('åŠ ç³–å’Œç‰›å¥¶'); &#125;; // coffeeå®ä¾‹ var Coffee = new Coffee(); Coffee.init(); // æŠ½è±¡å­ç±»-tea var Tea = function() &#123;&#125;; Tea.prototype = new Beverage(); Tea.prototype.brew = function() &#123; console.log('ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶'); &#125;; Tea.prototype.pourInCup = function() &#123; console.log('æŠŠèŒ¶å€’è¿›æ¯å­'); &#125;; Tea.prototype.addCondiments = function() &#123; console.log('åŠ æŸ æª¬'); &#125;; var tea = new Tea(); tea.init(); // ä¸Šé¢Beverage.prototype.init è¢«ç§°ä¸ºæ¨¡æ¿æ–¹æ³•ã€‚è¯¥æ–¹æ³•ä¸­å°è£…äº†å­ç±»çš„ç®—æ³•æ¡†æ¶ï¼Œå®ƒä½œä¸ºä¸€ä¸ªç®—æ³•çš„æ¨¡æ¿ï¼ŒæŒ‡å¯¼å­ç±»ä»¥ä½•ç§é¡ºåºå»æ‰§è¡Œå“ªäº›æ–¹æ³• &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; é’©å­æ–¹æ³•12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // åœ¨50ä¸­å®ç°äº†ä¸‹é¢çš„æµç¨‹ï¼Œå¦‚æœæœ‰å®¢äººä¸åŠ è°ƒæ–™ï¼Œè¯¥å¦‚ä½•å®ç° // (1) æŠŠæ°´ç…®æ²¸ // (2) ç”¨æ²¸æ°´å†²æ³¡é¥®æ–™ // (3) æŠŠé¥®æ–™å€’è¿›æ¯å­ // (4) åŠ è°ƒæ–™ // é’©å­æ–¹æ³•ï¼ˆhookï¼‰å¯ä»¥ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ”¾ç½®é’©å­æ˜¯éš”ç¦»å˜åŒ–çš„ä¸€ç§å¸¸è§æ‰‹æ®µã€‚æˆ‘ä»¬åœ¨çˆ¶ç±»ä¸­å®¹æ˜“å˜åŒ–çš„åœ°æ–¹æ”¾ç½®é’©å­ï¼Œé’©å­å¯ä»¥æœ‰ä¸€ä¸ªé»˜è®¤çš„å®ç°ï¼Œç©¶ç«Ÿè¦ä¸è¦â€œæŒ‚é’©â€ï¼Œè¿™ç”±å­ç±»è‡ªè¡Œå†³å®šã€‚é’©å­æ–¹æ³•çš„è¿”å›ç»“æœå†³å®šäº†æ¨¡æ¿æ–¹æ³•åé¢éƒ¨åˆ†çš„æ‰§è¡Œæ­¥éª¤ï¼Œä¹Ÿå°±æ˜¯ç¨‹åºæ¥ä¸‹æ¥çš„èµ°å‘ï¼Œè¿™æ ·ä¸€æ¥ï¼Œç¨‹åºå°±æ‹¥æœ‰äº†å˜åŒ–çš„å¯èƒ½ã€‚ var Beverage = function() &#123;&#125;; Beverage.prototype.boilWater = function() &#123; console.log("æŠŠæ°´ç…®æ²¸"); &#125;; Beverage.prototype.brew = function() &#123; throw new Error('å­ç±»å¿…é¡»é‡å†™brew æ–¹æ³•'); &#125;; Beverage.prototype.pourInCup = function() &#123; throw new Error('å­ç±»å¿…é¡»é‡å†™pourInCup æ–¹æ³•'); &#125;; Beverage.prototype.addCondiments = function() &#123; throw new Error('å­ç±»å¿…é¡»é‡å†™addCondiments æ–¹æ³•'); &#125;; Beverage.prototype.customerWantsCondiments = function() &#123; return true; // é»˜è®¤éœ€è¦è°ƒæ–™ &#125;; Beverage.prototype.init = function() &#123; this.boilWater(); this.brew(); this.pourInCup(); if (this.customerWantsCondiments()) &#123; // å¦‚æœæŒ‚é’©è¿”å›trueï¼Œåˆ™éœ€è¦è°ƒæ–™ this.addCondiments(); &#125; &#125;; var CoffeeWithHook = function() &#123;&#125;; CoffeeWithHook.prototype = new Beverage(); CoffeeWithHook.prototype.brew = function() &#123; console.log('ç”¨æ²¸æ°´å†²æ³¡å’–å•¡'); &#125;; CoffeeWithHook.prototype.pourInCup = function() &#123; console.log('æŠŠå’–å•¡å€’è¿›æ¯å­'); &#125;; CoffeeWithHook.prototype.addCondiments = function() &#123; console.log('åŠ ç³–å’Œç‰›å¥¶'); &#125;; CoffeeWithHook.prototype.customerWantsCondiments = function() &#123; return window.confirm('è¯·é—®éœ€è¦è°ƒæ–™å—ï¼Ÿ'); &#125;; var coffeeWithHook = new CoffeeWithHook(); coffeeWithHook.init(); // å¥½è±ååŸåˆ™ // å¥½è±åæ— ç–‘æ˜¯æ¼”å‘˜çš„å¤©å ‚ï¼Œä½†å¥½è±åä¹Ÿæœ‰å¾ˆå¤šæ‰¾ä¸åˆ°å·¥ä½œçš„æ–°äººæ¼”å‘˜ï¼Œè®¸å¤šæ–°äººæ¼”å‘˜åœ¨å¥½è±åæŠŠç®€å†é€’ç»™æ¼”è‰ºå…¬å¸ä¹‹åå°±åªæœ‰å›å®¶ç­‰å¾…ç”µè¯ã€‚æœ‰æ—¶å€™è¯¥æ¼”å‘˜ç­‰å¾—ä¸è€çƒ¦äº†ï¼Œç»™æ¼”è‰ºå…¬å¸æ‰“ç”µè¯è¯¢é—®æƒ…å†µï¼Œæ¼”è‰ºå…¬å¸å¾€å¾€è¿™æ ·å›ç­”ï¼šâ€œä¸è¦æ¥æ‰¾æˆ‘ï¼Œæˆ‘ä¼šç»™ä½ æ‰“ç”µè¯ã€‚â€ // åœ¨è®¾è®¡ä¸­ï¼Œè¿™æ ·çš„è§„åˆ™å°±ç§°ä¸ºå¥½è±ååŸåˆ™ã€‚åœ¨è¿™ä¸€åŸåˆ™çš„æŒ‡å¯¼ä¸‹ï¼Œæˆ‘ä»¬å…è®¸åº•å±‚ç»„ä»¶å°†è‡ªå·±æŒ‚é’©åˆ°é«˜å±‚ç»„ä»¶ä¸­ï¼Œ è€Œé«˜å±‚ç»„ä»¶ä¼šå†³å®šä»€ä¹ˆæ—¶å€™ã€ ä»¥ä½•ç§æ–¹å¼å»ä½¿ç”¨è¿™äº›åº•å±‚ç»„ä»¶ï¼Œ é«˜å±‚ç»„ä»¶å¯¹å¾…åº•å±‚ç»„ä»¶çš„æ–¹å¼ï¼Œ è·Ÿæ¼”è‰ºå…¬å¸å¯¹å¾…æ–°äººæ¼”å‘˜ä¸€æ ·ï¼Œéƒ½æ˜¯â€œ åˆ«è°ƒç”¨æˆ‘ä»¬ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨ä½ â€ã€‚ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; æ¨¡æ¿æ–¹æ³•æ¨¡å¼åœ¨jsä¸­çš„å®ç°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; var Beverage = function(param) &#123; var boilWater = function() &#123; console.log("æŠŠæ°´ç…®æ²¸"); &#125;; var brew = param.brew || function() &#123; throw new Error("å¿…é¡»ä¼ é€’brewæ–¹æ³•"); &#125;; var pourInCup = param.pourInCup || function() &#123; throw new Error("å¿…é¡»ä¼ é€’pourInCupæ–¹æ³•"); &#125;; var addCondiments = param.addCondiments || function() &#123; throw new Error("å¿…é¡»ä¼ é€’addCondimentsæ–¹æ³•"); &#125;; var F = function() &#123;&#125;; F.prototype.init = function() &#123; boilWater(); brew(); pourInCup(); addCondiments(); &#125;; return F; &#125;; var Coffee = Beverage(&#123; brew: function() &#123; console.log('ç”¨æ²¸æ°´å†²æ³¡å’–å•¡'); &#125;, pourInCup: function() &#123; console.log('æŠŠå’–å•¡å€’è¿›æ¯å­'); &#125;, addCondiments: function() &#123; console.log('åŠ ç³–å’Œç‰›å¥¶'); &#125; &#125;); var Tea = Beverage(&#123; brew: function() &#123; console.log('ç”¨æ²¸æ°´æµ¸æ³¡èŒ¶å¶'); &#125;, pourInCup: function() &#123; console.log('æŠŠèŒ¶å€’è¿›æ¯å­'); &#125;, addCondiments: function() &#123; console.log('åŠ æŸ æª¬'); &#125; &#125;); var coffee = new Coffee(); coffee.init(); var tea = new Tea(); tea.init(); // åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬æŠŠbrewã€pourInCupã€addCondiments è¿™äº›æ–¹æ³•ä¾æ¬¡ä¼ å…¥Beverage å‡½æ•°ï¼Œ Beverage å‡½æ•°è¢«è°ƒç”¨ä¹‹åè¿”å›æ„é€ å™¨Fã€‚ F ç±»ä¸­åŒ…å«äº†â€œ æ¨¡æ¿æ–¹æ³•â€ F.prototype.initã€‚ è·Ÿç»§æ‰¿å¾—åˆ°çš„æ•ˆæœä¸€æ ·ï¼Œ è¯¥â€œ æ¨¡æ¿æ–¹æ³•â€ é‡Œä¾ç„¶å°è£…äº†é¥®æ–™å­ç±»çš„ç®—æ³•æ¡†æ¶ã€‚ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; äº«å…ƒæ¨¡å¼åŸºæœ¬å®šä¹‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // äº«å…ƒæ¨¡å¼:äº«å…ƒ(flyweight)æ¨¡å¼æ˜¯ä¸€ç§ç”¨äºæ€§èƒ½ä¼˜åŒ–çš„æ¨¡å¼ï¼Œâ€œ flyâ€ åœ¨è¿™é‡Œæ˜¯è‹è‡çš„æ„æ€ï¼Œ æ„ä¸ºè‡é‡çº§ã€‚ äº«å…ƒæ¨¡å¼çš„æ ¸å¿ƒæ˜¯è¿ç”¨å…±äº«æŠ€æœ¯æ¥æœ‰æ•ˆæ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚ // äº«å…ƒæ¨¡å¼çš„ç›®æ ‡æ˜¯å°½é‡å‡å°‘å…±äº«å¯¹è±¡çš„æ•°é‡ï¼Œäº«å…ƒæ¨¡å¼è¦æ±‚å°†å¯¹è±¡çš„å±æ€§åˆ’åˆ†ä¸ºå†…éƒ¨çŠ¶æ€ä¸å¤–éƒ¨çŠ¶æ€ï¼ˆçŠ¶æ€åœ¨è¿™é‡Œé€šå¸¸æŒ‡å±æ€§ï¼‰,å…³äºå¦‚ä½•åˆ’åˆ†å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€ï¼Œä¸‹é¢çš„å‡ æ¡ç»éªŒæä¾›äº†ä¸€äº›æŒ‡å¼•ã€‚ // å†…éƒ¨çŠ¶æ€å­˜å‚¨äºå¯¹è±¡å†…éƒ¨ã€‚ // å†…éƒ¨çŠ¶æ€å¯ä»¥è¢«ä¸€äº›å¯¹è±¡å…±äº«ã€‚ // å†…éƒ¨çŠ¶æ€ç‹¬ç«‹äºå…·ä½“çš„åœºæ™¯ï¼Œé€šå¸¸ä¸ä¼šæ”¹å˜ã€‚ // å¤–éƒ¨çŠ¶æ€å–å†³äºå…·ä½“çš„åœºæ™¯ï¼Œå¹¶æ ¹æ®åœºæ™¯è€Œå˜åŒ–ï¼Œå¤–éƒ¨çŠ¶æ€ä¸èƒ½è¢«å…±äº«ã€‚ // æˆ‘ä»¬ä¾¿å¯ä»¥æŠŠæ‰€æœ‰å†…éƒ¨çŠ¶æ€ç›¸åŒçš„å¯¹è±¡éƒ½æŒ‡å®šä¸ºåŒä¸€ä¸ªå…±äº«çš„å¯¹è±¡ã€‚è€Œå¤–éƒ¨çŠ¶æ€å¯ä»¥ä»å¯¹è±¡èº«ä¸Šå‰¥ç¦»å‡ºæ¥ï¼Œå¹¶å‚¨å­˜åœ¨å¤–éƒ¨ã€‚ // å‰¥ç¦»äº†å¤–éƒ¨çŠ¶æ€çš„å¯¹è±¡æˆä¸ºå…±äº«å¯¹è±¡ï¼Œå¤–éƒ¨çŠ¶æ€åœ¨å¿…è¦æ—¶è¢«ä¼ å…¥å…±äº«å¯¹è±¡æ¥ç»„è£…æˆä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡ã€‚è™½ç„¶ç»„è£…å¤–éƒ¨çŠ¶æ€æˆä¸ºä¸€ä¸ªå®Œæ•´å¯¹è±¡çš„è¿‡ç¨‹éœ€è¦èŠ±è´¹ä¸€å®šçš„æ—¶é—´ï¼Œä½†å´å¯ä»¥å¤§å¤§å‡å°‘ç³»ç»Ÿä¸­çš„å¯¹è±¡æ•°é‡ï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼Œè¿™ç‚¹æ—¶é—´æˆ–è®¸æ˜¯å¾®ä¸è¶³é“çš„ã€‚å› æ­¤ï¼Œäº«å…ƒæ¨¡å¼æ˜¯ä¸€ç§ç”¨æ—¶é—´æ¢ç©ºé—´çš„ä¼˜åŒ–æ¨¡å¼ã€‚ // ä½¿ç”¨åœºæ™¯: // ä¸€ä¸ªç¨‹åºä¸­ä½¿ç”¨äº†å¤§é‡çš„ç›¸ä¼¼å¯¹è±¡ã€‚ // ç”±äºä½¿ç”¨äº†å¤§é‡å¯¹è±¡ï¼Œé€ æˆå¾ˆå¤§çš„å†…å­˜å¼€é”€ã€‚ // å¯¹è±¡çš„å¤§å¤šæ•°çŠ¶æ€éƒ½å¯ä»¥å˜ä¸ºå¤–éƒ¨çŠ¶æ€ã€‚ // å‰¥ç¦»å‡ºå¯¹è±¡çš„å¤–éƒ¨çŠ¶æ€ä¹‹åï¼Œå¯ä»¥ç”¨ç›¸å¯¹è¾ƒå°‘çš„å…±äº«å¯¹è±¡å–ä»£å¤§é‡å¯¹è±¡ã€‚ // ä½¿ç”¨ä¸¾ä¾‹:å‡è®¾æœ‰ä¸ªå†…è¡£å·¥å‚ï¼Œç›®å‰çš„äº§å“æœ‰50ç§ç”·å¼å†…è¡£å’Œ50ç§å¥³å£«å†…è¡£ï¼Œä¸ºäº†æ¨é”€äº§å“ï¼Œå·¥å‚å†³å®šç”Ÿäº§ä¸€äº›å¡‘æ–™æ¨¡ç‰¹æ¥ç©¿ä¸Šä»–ä»¬çš„å†…è¡£æ‹æˆå¹¿å‘Šç…§ç‰‡ã€‚ // æ­£å¸¸æƒ…å†µä¸‹éœ€è¦50 ä¸ªç”·æ¨¡ç‰¹å’Œ50ä¸ªå¥³æ¨¡ç‰¹ï¼Œç„¶åè®©ä»–ä»¬æ¯äººåˆ†åˆ«ç©¿ä¸Šä¸€ä»¶å†…è¡£æ¥æ‹ç…§ // var Model = function(sex, underwear) &#123; // this.sex = sex; // this.underwear = underwear; // &#125;; // Model.prototype.takePhoto = function() &#123; // console.log("sex=" + this.sex + ";underwear=" + this.underwear); // &#125;; // for (var i = 1; i &lt;= 50; i++) &#123; // var maleModel = new Model("male", "underwear" + i); // maleModel.takePhoto(); // &#125; // for (var j = 1; j &lt;= 50; j++) &#123; // var femaleModel = new Model("female", "underwear" + j); // femaleModel.takePhoto(); // &#125; // è¿™æ ·ä¼šäº§ç”Ÿ100ä¸ªå¯¹è±¡ï¼Œå¦‚æœæœ‰10000ç§å†…è¡£ï¼Œåˆ™æ­¤ç¨‹åºä¼šçˆ†ç‚¸ // ä¼˜åŒ–ï¼Œå…¶å®åªè¦ä¸€ä¸ªç”·æ¨¡ç‰¹ã€ä¸€ä¸ªå¥³æ¨¡ç‰¹ï¼Œè®©ä»–ä»¬åˆ†åˆ«è¯•ç©¿50ä»¶å†…è¡£ç„¶åæ‹ç…§å³å¯ var Model = function(sex) &#123; this.sex = sex; &#125;; Model.prototype.takePhoto = function() &#123; console.log("sex=" + this.sex + ";underwear=" + this.underwear); &#125;; var maleModel = new Model('male'), femaleModel = new Model('female'); for (var i = 1; i &lt;= 50; i++) &#123; maleModel.underwear = 'underwear' + i; maleModel.takePhoto(); &#125;; for (var j = 1; j &lt;= 50; j++) &#123; femaleModel.underwear = 'underwear' + j; femaleModel.takePhoto(); &#125;; // ä¸Šä¾‹ä¸­æ€§åˆ«æ˜¯å†…éƒ¨çŠ¶æ€ï¼Œå†…è¡£æ˜¯å¤–éƒ¨çŠ¶æ€ // å¯ä»¥è¢«å¯¹è±¡å…±äº«çš„å±æ€§é€šå¸¸è¢«åˆ’åˆ†ä¸ºå†…éƒ¨çŠ¶æ€ï¼Œå¦‚åŒä¸ç®¡ä»€ä¹ˆæ ·å¼çš„è¡£æœï¼Œéƒ½å¯ä»¥æŒ‰ç…§æ€§åˆ«ä¸åŒï¼Œç©¿åœ¨åŒä¸€ä¸ªç”·æ¨¡ç‰¹æˆ–è€…å¥³æ¨¡ç‰¹èº«ä¸Šï¼Œæ¨¡ç‰¹çš„æ€§åˆ«å°±å¯ä»¥ä½œä¸ºå†…éƒ¨çŠ¶æ€å‚¨å­˜åœ¨å…±äº«å¯¹è±¡çš„å†…éƒ¨ã€‚è€Œå¤–éƒ¨çŠ¶æ€å–å†³äºå…·ä½“çš„åœºæ™¯ï¼Œå¹¶æ ¹æ®åœºæ™¯è€Œå˜åŒ–ï¼Œå°±åƒä¾‹å­ä¸­æ¯ä»¶è¡£æœéƒ½æ˜¯ä¸åŒçš„ï¼Œå®ƒä»¬ä¸èƒ½è¢«ä¸€äº›å¯¹è±¡å…±äº«ï¼Œå› æ­¤åªèƒ½è¢«åˆ’åˆ†ä¸ºå¤–éƒ¨çŠ¶æ€ã€‚ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; äº«å…ƒæ¨¡å¼é‡æ„ä¸Šä¼ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // æ™®é€šä¸Šä¼  // var id = 0; // window.startUpload = function(uploadType, files) &#123; // for (var i = 0, file; file = files[i++];) &#123; // var uploadObj = new Upload(uploadType, file.fileName, file.fileSize); // uploadObj.init(id++); // &#125; // &#125;; // var Upload = function(uploadType, fileName, fileSize) &#123; // this.uploadType = uploadType; // this.fileName = fileName; // this.fileSize = fileSize; // this.dom = null; // &#125;; // Upload.prototype.init = function(id) &#123; // var that = this; // this.id = id; // this.dom = document.createElement("div"); // this.dom.innerHTML = '&lt;span&gt;æ–‡ä»¶åç§°:' + this.fileName + ', æ–‡ä»¶å¤§å°: ' + this.fileSize + '&lt;/span&gt;' + // '&lt;button class="delFile"&gt;åˆ é™¤&lt;/button&gt;'; // this.dom.querySelector(".delFile").onclick = function() &#123; // that.delFile(); // &#125;; // document.body.appendChild(this.dom); // &#125;; // Upload.prototype.delFile = function() &#123; // if (this.fileSize &lt; 3000) &#123; // return this.dom.parentNode.removeChild(this.dom); // &#125; // if (window.confirm("ç¡®å®šè¦åˆ é™¤è¯¥æ–‡ä»¶å—ï¼Ÿ" + this.fileName)) &#123; // return this.dom.parentNode.removeChild(this.dom); // &#125; // &#125;; // startUpload('plugin', [&#123; // fileName: '1.txt', // fileSize: 1000 // &#125;, &#123; // fileName: '2.html', // fileSize: 3000 // &#125;, &#123; // fileName: '3.txt', // fileSize: 5000 // &#125;]); // startUpload('flash', [&#123; // fileName: '4.txt', // fileSize: 1000 // &#125;, &#123; // fileName: '5.html', // fileSize: 3000 // &#125;, &#123; // fileName: '6.txt', // fileSize: 5000 // &#125;]); // ä¸Šé¢çš„é—®é¢˜åœ¨äºï¼Œæœ‰å¤šå°‘ä¸ªè¦ä¸Šä¼ çš„æ–‡ä»¶ï¼Œå°±è¦éœ€è¦åˆ›å»ºå¤šå°‘ä¸ªuploadå¯¹è±¡ // ä½¿ç”¨äº«å…ƒæ¨¡å¼é‡æ„ // uploadTypeæ˜¯å†…éƒ¨çŠ¶æ€ï¼ŒfileNameå’ŒfileSizeéƒ½æ˜¯å¤–éƒ¨çŠ¶æ€ var Upload = function(uploadType) &#123; this.uploadType = uploadType; &#125;; Upload.prototype.delFile = function(id) &#123; uploadManager.setExternalState(id, this); if (this.fileSize &lt; 3000) &#123; return this.dom.parentNode.removeChild(this.dom); &#125; if (window.confirm('ç¡®å®šè¦åˆ é™¤è¯¥æ–‡ä»¶å—? ' + this.fileName)) &#123; return this.dom.parentNode.removeChild(this.dom); &#125; &#125;; var UploadFactory = (function() &#123; var createdFlyWeightObjs = &#123;&#125;; return &#123; create: function(uploadType) &#123; if (createdFlyWeightObjs[uploadType]) &#123; return createdFlyWeightObjs[uploadType]; &#125; return createdFlyWeightObjs[uploadType] = new Upload(uploadType); &#125; &#125;; &#125;)(); var uploadManager = (function() &#123; var uploadDatabase = &#123;&#125;; return &#123; add: function(id, uploadType, fileName, fileSize) &#123; var flyWeightObj = UploadFactory.create(uploadType); var dom = document.createElement("div"); dom.innerHTML = '&lt;span&gt;æ–‡ä»¶åç§°:' + fileName + ', æ–‡ä»¶å¤§å°: ' + fileSize + '&lt;/span&gt;' + '&lt;button class="delFile"&gt;åˆ é™¤&lt;/button&gt;'; dom.querySelector('.delFile').onclick = function() &#123; flyWeightObj.delFile(id); &#125; document.body.appendChild(dom); uploadDatabase[id] = &#123; fileName: fileName, fileSize: fileSize, dom: dom &#125;; return flyWeightObj; &#125;, setExternalState: function(id, flyWeightObj) &#123; var uploadData = uploadDatabase[id]; for (var i in uploadData) &#123; flyWeightObj[i] = uploadData[i]; &#125; &#125; &#125;; &#125;)(); var id = 0; window.startUpload = function(uploadType, files) &#123; for (var i = 0, file; file = files[i++];) &#123; var uploadObj = uploadManager.add(++id, uploadType, file.fileName, file.fileSize); &#125; &#125;; startUpload('plugin', [&#123; fileName: '1.txt', fileSize: 1000 &#125;, &#123; fileName: '2.html', fileSize: 3000 &#125;, &#123; fileName: '3.txt', fileSize: 5000 &#125;]); startUpload('flash', [&#123; fileName: '4.txt', fileSize: 1000 &#125;, &#123; fileName: '5.html', fileSize: 3000 &#125;, &#123; fileName: '6.txt', fileSize: 5000 &#125;]); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å¯¹è±¡æ± 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // å¯¹è±¡æ± ç»´ // æŠ¤ä¸€ä¸ªè£…è½½ç©ºé—²å¯¹è±¡çš„æ± å­ï¼Œå¦‚æœéœ€è¦å¯¹è±¡çš„æ—¶å€™ï¼Œä¸æ˜¯ç›´æ¥newï¼Œè€Œæ˜¯è½¬ä»å¯¹è±¡æ± é‡Œè·å–ã€‚å¦‚ // æœå¯¹è±¡æ± é‡Œæ²¡æœ‰ç©ºé—²å¯¹è±¡ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå½“è·å–å‡ºçš„å¯¹è±¡å®Œæˆå®ƒçš„èŒè´£ä¹‹åï¼Œ å†è¿›å…¥ // æ± å­ç­‰å¾…è¢«ä¸‹æ¬¡è·å–ã€‚ // å¯¹è±¡æ± æŠ€æœ¯çš„åº”ç”¨éå¸¸å¹¿æ³›ï¼ŒHTTP è¿æ¥æ± å’Œæ•°æ®åº“è¿æ¥æ± éƒ½æ˜¯å…¶ä»£è¡¨åº”ç”¨ã€‚åœ¨Web å‰ç«¯å¼€ // å‘ä¸­ï¼Œå¯¹è±¡æ± ä½¿ç”¨æœ€å¤šçš„åœºæ™¯å¤§æ¦‚å°±æ˜¯è·ŸDOM æœ‰å…³çš„æ“ä½œã€‚å¾ˆå¤šç©ºé—´å’Œæ—¶é—´éƒ½æ¶ˆè€—åœ¨äº†DOM // èŠ‚ç‚¹ä¸Šï¼Œå¦‚ä½•é¿å…é¢‘ç¹åœ°åˆ›å»ºå’Œåˆ é™¤DOM èŠ‚ç‚¹å°±æˆäº†ä¸€ä¸ªæœ‰æ„ä¹‰çš„è¯é¢˜ã€‚ // å¯¹è±¡æ± è·Ÿäº«å…ƒæ¨¡å¼çš„æ€æƒ³æœ‰ç‚¹ç›¸ä¼¼,è™½ç„¶innerHTML çš„å€¼Aã€Bã€Cã€D ç­‰ä¹Ÿå¯ä»¥çœ‹æˆèŠ‚ç‚¹çš„å¤–éƒ¨çŠ¶æ€ï¼Œä½†åœ¨è¿™é‡Œæˆ‘ä»¬å¹¶æ²¡æœ‰ä¸»åŠ¨åˆ†ç¦»å†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€çš„è¿‡ç¨‹ã€‚ var toolTipFactory = (function() &#123; var toolTipPool = []; return &#123; create: function() &#123; if (toolTipPool.length === 0) &#123; // å¯¹è±¡æ± ä¸ºç©ºåˆ™åˆ›å»ºä¸€ä¸ªdiv var div = document.createElement("div"); document.body.appendChild(div); return div; &#125; else &#123; // ä¸ä¸ºç©ºåˆ™å–å‡ºä¸€ä¸ª return toolTipPool.shift(); &#125; &#125;, recover: function(tooltipDom) &#123; // å¯¹è±¡æ± å›æ”¶dom return toolTipPool.push(tooltipDom); &#125; &#125;; &#125;)(); // åˆ›å»º2ä¸ªå°æ°”æ³¡ var ary = []; for (var i = 0, str; str = ["A", "B"][i++];) &#123; var toolTip = toolTipFactory.create(); toolTip.innerHTML = str; ary.push(toolTip); &#125; console.log(ary); // åœ°å›¾éœ€è¦é‡ç»˜ï¼Œæ‰€ä»¥å…ˆå›æ”¶ä¹‹å‰åˆ›å»ºçš„2ä¸ªæ°”æ³¡ for (var i = 0, toolTip; toolTip = ary[i++];) &#123; toolTipFactory.recover(toolTip); &#125;; // åˆ›å»º6ä¸ªæ°”æ³¡ for (var i = 0, str; str = ['A', 'B', 'C', 'D', 'E', 'F'][i++];) &#123; var toolTip = toolTipFactory.create(); toolTip.innerHTML = str; &#125;; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; é€šç”¨å¯¹è±¡æ± 12345678910111213141516171819202122232425262728293031323334353637383940414243444546&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // é€šç”¨çš„åˆ›å»ºå¯¹è±¡æ± çš„å·¥å‚ var objectPoolFactory = function(creactObjFn) &#123; var objectPool = []; return &#123; create: function() &#123; var obj = objectPool.length === 0 ? creactObjFn.apply(this, arguments) : objectPool.shift(); return obj; &#125;, recover: function(obj) &#123; objectPool.push(obj); &#125; &#125;; &#125;; var iframeFactory = objectPoolFactory(function() &#123; var iframe = document.createElement("iframe"); document.body.appendChild(iframe); iframe.onload = function() &#123; // é˜²æ­¢iframeé‡å¤åŠ è½½çš„bug iframe.onload = null; // åŠ è½½å®Œæˆåå›æ”¶èŠ‚ç‚¹ï¼Œä¾›ä¸‹æ¬¡ä½¿ç”¨ iframeFactory.recover(iframe); &#125;; return iframe; &#125;); var iframe1 = iframeFactory.create(); iframe1.src = 'http://www.baidu.com'; var iframe2 = iframeFactory.create(); iframe2.src = 'http://www.qq.com'; setTimeout(function() &#123; var iframe3 = iframeFactory.create(); iframe3.src = 'http://www.163.com'; &#125;, 3000); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; èŒè´£é“¾æ¨¡å¼åŸºæœ¬å®šä¹‰1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // èŒè´£é“¾æ¨¡å¼:ä½¿å¤šä¸ªå¯¹è±¡éƒ½æœ‰æœºä¼šå¤„ç†è¯·æ±‚ï¼Œä»è€Œé¿å…è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆå…³ç³»ï¼Œ å°†è¿™äº›å¯¹è±¡è¿æˆä¸€æ¡é“¾ï¼Œ å¹¶æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯¥è¯·æ±‚ï¼Œ ç›´åˆ°æœ‰ä¸€ä¸ªå¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚ // ä½¿ç”¨åœºæ™¯:ç±»ä¼¼é˜Ÿåˆ—çš„æ“ä½œæ—¶å¯ä»¥ç”¨ // ä½¿ç”¨ä¸¾ä¾‹:å…¬å¸é’ˆå¯¹æ”¯ä»˜è¿‡å®šé‡‘çš„ç”¨æˆ·æœ‰ä¸€å®šçš„ä¼˜æƒ æ”¿ç­–ã€‚åœ¨æ­£å¼è´­ä¹°åï¼Œå·²ç»æ”¯ä»˜è¿‡500å…ƒå®šé‡‘çš„ç”¨æˆ·ä¼šæ”¶åˆ°100å…ƒçš„å•†åŸä¼˜æƒ åˆ¸ï¼Œ200å…ƒå®šé‡‘çš„ç”¨æˆ·å¯ä»¥æ”¶åˆ°50 å…ƒçš„ä¼˜æƒ åˆ¸ï¼Œè€Œä¹‹å‰æ²¡æœ‰æ”¯ä»˜å®šé‡‘çš„ç”¨æˆ·åªèƒ½è¿›å…¥æ™®é€šè´­ä¹°æ¨¡å¼ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ä¼˜æƒ åˆ¸ï¼Œä¸”åœ¨åº“å­˜æœ‰é™çš„æƒ…å†µä¸‹ä¸ä¸€å®šä¿è¯èƒ½ä¹°åˆ°ã€‚æˆ‘ä»¬çš„è®¢å•é¡µé¢æ˜¯PHP åå‡ºçš„æ¨¡æ¿ï¼Œåœ¨é¡µé¢åŠ è½½ä¹‹åˆï¼ŒPHP ä¼šä¼ é€’ç»™é¡µé¢å‡ ä¸ªå­—æ®µã€‚ // orderTypeï¼šè¡¨ç¤ºè®¢å•ç±»å‹ï¼ˆå®šé‡‘ç”¨æˆ·æˆ–è€…æ™®é€šè´­ä¹°ç”¨æˆ·ï¼‰ï¼Œcode çš„å€¼ä¸º1 çš„æ—¶å€™æ˜¯500 å…ƒå®šé‡‘ç”¨æˆ·ï¼Œä¸º2 çš„æ—¶å€™æ˜¯200 å…ƒå®šé‡‘ç”¨æˆ·ï¼Œä¸º3 çš„æ—¶å€™æ˜¯æ™®é€šè´­ä¹°ç”¨æˆ·ã€‚ // payï¼šè¡¨ç¤ºç”¨æˆ·æ˜¯å¦å·²ç»æ”¯ä»˜å®šé‡‘ï¼Œå€¼ä¸ºtrue æˆ–è€…false, è™½ç„¶ç”¨æˆ·å·²ç»ä¸‹è¿‡500 å…ƒå®šé‡‘çš„è®¢å•ï¼Œä½†å¦‚æœä»–ä¸€ç›´æ²¡æœ‰æ”¯ä»˜å®šé‡‘ï¼Œç°åœ¨åªèƒ½é™çº§è¿›å…¥æ™®é€šè´­ä¹°æ¨¡å¼ã€‚ // stockï¼šè¡¨ç¤ºå½“å‰ç”¨äºæ™®é€šè´­ä¹°çš„æ‰‹æœºåº“å­˜æ•°é‡ï¼Œå·²ç»æ”¯ä»˜è¿‡500 å…ƒæˆ–è€…200 å…ƒå®šé‡‘çš„ç”¨æˆ·ä¸å—æ­¤é™åˆ¶ã€‚ // ç”¨æ™®é€šæµç¨‹å†™ // var order = function(orderType, pay, stock) &#123; // if (orderType === 1) &#123; // 500 å…ƒå®šé‡‘è´­ä¹°æ¨¡å¼ // if (pay === true) &#123; // å·²æ”¯ä»˜å®šé‡‘ // console.log('500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ°100 ä¼˜æƒ åˆ¸'); // &#125; else &#123; // æœªæ”¯ä»˜å®šé‡‘ï¼Œé™çº§åˆ°æ™®é€šè´­ä¹°æ¨¡å¼ // if (stock &gt; 0) &#123; // ç”¨äºæ™®é€šè´­ä¹°çš„æ‰‹æœºè¿˜æœ‰åº“å­˜ // console.log('æ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸'); // &#125; else &#123; // console.log('æ‰‹æœºåº“å­˜ä¸è¶³'); // &#125; // &#125; // &#125; else if (orderType === 2) &#123; // 200 å…ƒå®šé‡‘è´­ä¹°æ¨¡å¼ // if (pay === true) &#123; // console.log('200 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ°50 ä¼˜æƒ åˆ¸'); // &#125; else &#123; // if (stock &gt; 0) &#123; // console.log('æ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸'); // &#125; else &#123; // console.log('æ‰‹æœºåº“å­˜ä¸è¶³'); // &#125; // &#125; // &#125; else if (orderType === 3) &#123; // if (stock &gt; 0) &#123; // console.log('æ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸'); // &#125; else &#123; // console.log('æ‰‹æœºåº“å­˜ä¸è¶³'); // &#125; // &#125; // &#125;; // order(1, true, 500); // è¾“å‡ºï¼š 500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ°100 ä¼˜æƒ åˆ¸ // ç”¨èŒè´£é“¾æ¥é‡å†™ // å…ˆæŠŠ500 å…ƒè®¢å•ã€200 å…ƒè®¢å•ä»¥åŠæ™®é€šè´­ä¹°åˆ†æˆ3ä¸ªå‡½æ•° // æ¥ä¸‹æ¥æŠŠorderTypeã€payã€stock è¿™3 ä¸ªå­—æ®µå½“ä½œå‚æ•°ä¼ é€’ç»™500 å…ƒè®¢å•å‡½æ•°ï¼Œå¦‚æœè¯¥å‡½æ•°ä¸ç¬¦åˆå¤„ç†æ¡ä»¶ï¼Œåˆ™æŠŠè¿™ä¸ªè¯·æ±‚ä¼ é€’ç»™åé¢çš„200 å…ƒè®¢å•å‡½æ•°ï¼Œå¦‚æœ200 å…ƒè®¢å•å‡½æ•°ä¾ç„¶ä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œåˆ™ç»§ç»­ä¼ é€’è¯·æ±‚ç»™æ™®é€šè´­ä¹°å‡½æ•° // 500 å…ƒè®¢å• var order500 = function(orderType, pay, stock) &#123; if (orderType === 1 &amp;&amp; pay === true) &#123; console.log('500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ°100 ä¼˜æƒ åˆ¸'); &#125; else &#123; order200(orderType, pay, stock); // å°†è¯·æ±‚ä¼ é€’ç»™200 å…ƒè®¢å• // order200 å’Œorder500 è€¦åˆåœ¨ä¸€èµ· &#125; &#125;; // 200 å…ƒè®¢å• var order200 = function(orderType, pay, stock) &#123; if (orderType === 2 &amp;&amp; pay === true) &#123; console.log('200 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ°50 ä¼˜æƒ åˆ¸'); &#125; else &#123; orderNormal(orderType, pay, stock); // å°†è¯·æ±‚ä¼ é€’ç»™æ™®é€šè®¢å• &#125; &#125;; // æ™®é€šè´­ä¹°è®¢å• var orderNormal = function(orderType, pay, stock) &#123; if (stock &gt; 0) &#123; console.log('æ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸'); &#125; else &#123; console.log('æ‰‹æœºåº“å­˜ä¸è¶³'); &#125; &#125;; // æµ‹è¯•ç»“æœï¼š order500(1, true, 500); // è¾“å‡ºï¼š500 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ°100 ä¼˜æƒ åˆ¸ order500(1, false, 500); // è¾“å‡ºï¼šæ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸ order500(2, true, 500); // è¾“å‡ºï¼š200 å…ƒå®šé‡‘é¢„è´­, å¾—åˆ°500 ä¼˜æƒ åˆ¸ order500(3, false, 500); // è¾“å‡ºï¼šæ™®é€šè´­ä¹°, æ— ä¼˜æƒ åˆ¸ order500(3, false, 0); // è¾“å‡ºï¼šæ‰‹æœºåº“å­˜ä¸è¶³ // ç›¸æ¯”ä¸Šé¢ä¸€ä¸ªå»æ‰äº†å¾ˆå¤šifåˆ¤æ–­ï¼Œä½†æ˜¯ä»ç„¶å­˜åœ¨æ¯ä¸ªå¤„ç†å¯¹è±¡ç›¸äº’è€¦åˆçš„é—®é¢˜ï¼Œåœ¨order500ä¸­æœ‰order200 // å¦‚æœæœ‰å¤©æˆ‘ä»¬è¦å¢åŠ 300 å…ƒé¢„è®¢æˆ–è€…å»æ‰200 å…ƒé¢„è®¢ï¼Œæ„å‘³ç€å°±å¿…é¡»æ”¹åŠ¨è¿™äº›ä¸šåŠ¡å‡½æ•°å†…éƒ¨ã€‚å°±åƒä¸€æ ¹ç¯ç¯ç›¸æ‰£æ‰“äº†æ­»ç»“çš„é“¾æ¡ï¼Œå¦‚æœè¦å¢åŠ ã€æ‹†é™¤æˆ–è€…ç§»åŠ¨ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±å¿…é¡»å¾—å…ˆç ¸çƒ‚è¿™æ ¹é“¾æ¡ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; çµæ´»å¯æ‹†åˆ†çš„èŒè´£é“¾èŠ‚ç‚¹12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // 58ä¸­çš„ç¬¬äºŒä¸ªä¾‹å­å¾ˆä¸çµæ´»ï¼Œé“¾ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹æ— æ³•çµæ´»æ‹†åˆ†å’Œé‡ç»„ var order500 = function(orderType, pay, stock) &#123; if (orderType === 1 &amp;&amp; pay === true) &#123; console.log('500 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ°100 ä¼˜æƒ åˆ¸'); &#125; else &#123; return 'nextSuccessor'; // æˆ‘ä¸çŸ¥é“ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯è°ï¼Œåæ­£æŠŠè¯·æ±‚å¾€åé¢ä¼ é€’ &#125; &#125;; var order200 = function(orderType, pay, stock) &#123; if (orderType === 2 &amp;&amp; pay === true) &#123; console.log('200 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ°50 ä¼˜æƒ åˆ¸'); &#125; else &#123; return 'nextSuccessor'; // æˆ‘ä¸çŸ¥é“ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯è°ï¼Œåæ­£æŠŠè¯·æ±‚å¾€åé¢ä¼ é€’ &#125; &#125;; var orderNormal = function(orderType, pay, stock) &#123; if (stock &gt; 0) &#123; console.log('æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸'); &#125; else &#123; console.log('æ‰‹æœºåº“å­˜ä¸è¶³'); &#125; &#125;; // Chain.prototype.setNextSuccessor æŒ‡å®šåœ¨é“¾ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ // Chain.prototype.passRequest ä¼ é€’è¯·æ±‚ç»™æŸä¸ªèŠ‚ç‚¹ var Chain = function(fn) &#123; this.fn = fn; this.successor = null; //è¡¨ç¤ºåœ¨é“¾ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ &#125;; Chain.prototype.setNextSuccessor = function(successor) &#123; return this.successor = successor; &#125;; Chain.prototype.passRequest = function() &#123; var ret = this.fn.apply(this, arguments); if (ret === "nextSuccessor") &#123; return this.successor &amp;&amp; this.successor.passRequest.apply(this.successor, arguments); &#125; return ret; &#125;; // å°†è®¢å•å‡½æ•°åŒ…è£…æˆèŒè´£é“¾çš„èŠ‚ç‚¹ var chainOrder500 = new Chain(order500); var chainOrder200 = new Chain(order200); var chainOrderNormal = new Chain(orderNormal); // ç„¶åæŒ‡å®šèŠ‚ç‚¹åœ¨èŒè´£é“¾ä¸­çš„é¡ºåº chainOrder500.setNextSuccessor(chainOrder200); chainOrder200.setNextSuccessor(chainOrderNormal); // ä¼ é€’è¯·æ±‚ chainOrder500.passRequest(1, true, 500); // è¾“å‡ºï¼š500 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ°100 ä¼˜æƒ åˆ¸ chainOrder500.passRequest(2, true, 500); // è¾“å‡ºï¼š200 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ°50 ä¼˜æƒ åˆ¸ chainOrder500.passRequest(3, true, 500); // è¾“å‡ºï¼šæ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸ chainOrder500.passRequest(1, false, 0); // è¾“å‡ºï¼šæ‰‹æœºåº“å­˜ä¸è¶³ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å¼‚æ­¥çš„èŒè´£é“¾12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // åœ¨59ä¸­æˆ‘ä»¬è®©æ¯ä¸ªèŠ‚ç‚¹å‡½æ•°åŒæ­¥è¿”å›ä¸€ä¸ªç‰¹å®šçš„å€¼"nextSuccessor"ï¼Œæ¥è¡¨ç¤ºæ˜¯å¦æŠŠè¯·æ±‚ä¼ é€’ç»™ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚è€Œåœ¨ç°å®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°ä¸€äº›å¼‚æ­¥çš„é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘ä»¬è¦åœ¨èŠ‚ç‚¹å‡½æ•°ä¸­å‘èµ·ä¸€ä¸ªajaxå¼‚æ­¥è¯·æ±‚ï¼Œå¼‚æ­¥è¯·æ±‚è¿”å›çš„ç»“æœæ‰èƒ½å†³å®šæ˜¯å¦ç»§ç»­åœ¨èŒè´£é“¾ä¸­passRequestã€‚ var Chain = function(fn) &#123; this.fn = fn; this.successor = null; //è¡¨ç¤ºåœ¨é“¾ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ &#125;; Chain.prototype.setNextSuccessor = function(successor) &#123; return this.successor = successor; &#125;; Chain.prototype.passRequest = function() &#123; var ret = this.fn.apply(this, arguments); if (ret === "nextSuccessor") &#123; return this.successor &amp;&amp; this.successor.passRequest.apply(this.successor, arguments); &#125; return ret; &#125;; // æ·»åŠ nextï¼Œè¡¨ç¤ºæ‰‹åŠ¨ä¼ é€’è¯·æ±‚ç»™ä¸‹ä¸€èŠ‚ç‚¹ Chain.prototype.next = function() &#123; return this.successor &amp;&amp; this.successor.passRequest.apply(this.successor, arguments); &#125;; var fn1 = new Chain(function() &#123; console.log(1); return 'nextSuccessor'; &#125;); var fn2 = new Chain(function() &#123; console.log(2); var self = this; setTimeout(function() &#123; self.next(); &#125;, 1000); &#125;); var fn3 = new Chain(function() &#123; console.log(3); &#125;); fn1.setNextSuccessor(fn2).setNextSuccessor(fn3); fn1.passRequest(); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ç”¨AOPå®ç°èŒè´£é“¾12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; Function.prototype.after = function(fn) &#123; var self = this; return function() &#123; var ret = self.apply(this, arguments); if (ret === 'nextSuccessor') &#123; return fn.apply(this, arguments); &#125; return ret; &#125; &#125;; var order500 = function(orderType, pay, stock) &#123; if (orderType === 1 &amp;&amp; pay === true) &#123; console.log('500 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ°100 ä¼˜æƒ åˆ¸'); &#125; else &#123; return 'nextSuccessor'; // æˆ‘ä¸çŸ¥é“ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯è°ï¼Œåæ­£æŠŠè¯·æ±‚å¾€åé¢ä¼ é€’ &#125; &#125;; var order200 = function(orderType, pay, stock) &#123; if (orderType === 2 &amp;&amp; pay === true) &#123; console.log('200 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ°50 ä¼˜æƒ åˆ¸'); &#125; else &#123; return 'nextSuccessor'; // æˆ‘ä¸çŸ¥é“ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ˜¯è°ï¼Œåæ­£æŠŠè¯·æ±‚å¾€åé¢ä¼ é€’ &#125; &#125;; var orderNormal = function(orderType, pay, stock) &#123; if (stock &gt; 0) &#123; console.log('æ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸'); &#125; else &#123; console.log('æ‰‹æœºåº“å­˜ä¸è¶³'); &#125; &#125;; var order = order500.after(order200).after(orderNormal); order(1, true, 500); // è¾“å‡ºï¼š500 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ°100 ä¼˜æƒ åˆ¸ order(2, true, 500); // è¾“å‡ºï¼š200 å…ƒå®šé‡‘é¢„è´­ï¼Œå¾—åˆ°50 ä¼˜æƒ åˆ¸ order(1, false, 500); // è¾“å‡ºï¼šæ™®é€šè´­ä¹°ï¼Œæ— ä¼˜æƒ åˆ¸ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ç”¨èŒè´£é“¾è·å–æ–‡ä»¶ä¸Šä¼ å¯¹è±¡12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; Function.prototype.after = function(fn) &#123; var self = this; return function() &#123; var ret = self.apply(this, arguments); if (ret === 'nextSuccessor') &#123; return fn.apply(this, arguments); &#125; return ret; &#125; &#125;; var getActiveUploadObj = function() &#123; try &#123; return new ActiveXObject("TXFTNActiveX.FTNUpload"); // IE ä¸Šä¼ æ§ä»¶ &#125; catch (e) &#123; return 'nextSuccessor'; &#125; &#125;; var getFlashUploadObj = function() &#123; if (supportFlash()) &#123; var str = '&lt;object type="application/x-shockwave-flash"&gt;&lt;/object&gt;'; return $(str).appendTo($('body')); &#125; return 'nextSuccessor'; &#125;; var getFormUpladObj = function() &#123; return $('&lt;form&gt;&lt;input name="file" type="file"/&gt;&lt;/form&gt;').appendTo($('body')); &#125;; var getUploadObj = getActiveUploadObj.after(getFlashUploadObj).after(getFormUpladObj); console.log(getUploadObj()); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ä¸­ä»‹è€…æ¨¡å¼åŸºæœ¬å®šä¹‰12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // ä¸­ä»‹è€…æ¨¡å¼:ç¨‹åºç”±å¤§å¤§å°å°çš„å•ä¸€å¯¹è±¡ç»„æˆï¼Œæ‰€æœ‰è¿™äº›å¯¹è±¡éƒ½æŒ‰ç…§æŸç§å…³ç³»å’Œè§„åˆ™æ¥é€šä¿¡ã€‚å½“å¯¹è±¡å¤šäº†ä»¥åï¼Œç›¸äº’é€šä¿¡ä¼šå˜çš„éå¸¸å°é—­å¼ã€‚ä¸­ä»‹è€…æ¨¡å¼çš„ä½œç”¨å°±æ˜¯è§£é™¤å¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´çš„ç´§è€¦åˆå…³ç³»ã€‚å¢åŠ ä¸€ä¸ªä¸­ä»‹è€…å¯¹è±¡åï¼Œæ‰€æœ‰çš„ç›¸å…³å¯¹è±¡éƒ½é€šè¿‡ä¸­ä»‹è€…å¯¹è±¡æ¥é€šä¿¡ï¼Œè€Œä¸æ˜¯äº’ç›¸å¼•ç”¨ï¼Œæ‰€ä»¥å½“ä¸€ä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜æ—¶ï¼Œåªéœ€è¦é€šçŸ¥ä¸­ä»‹è€…å¯¹è±¡å³å¯ã€‚ä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¹‹é—´è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚ä¸­ä»‹è€…æ¨¡å¼ä½¿ç½‘çŠ¶çš„å¤šå¯¹å¤šå…³ç³»å˜æˆäº†ç›¸å¯¹ç®€å•çš„ä¸€å¯¹å¤šå…³ç³» // ä½¿ç”¨åœºæ™¯:å½“å¯¹è±¡ä¹‹é—´ç›¸äº’å¼•ç”¨éå¸¸å¤šæ—¶ // ä½¿ç”¨ä¸¾ä¾‹:æ³¡æ³¡å ‚æ¸¸æˆã€è´­ä¹°å•†å“ function Player(name, teamColor) &#123; this.partners = []; // é˜Ÿå‹åˆ—è¡¨ this.enemies = []; // æ•Œäººåˆ—è¡¨ this.state = 'live'; // ç©å®¶çŠ¶æ€ this.name = name; // è§’è‰²åå­— this.teamColor = teamColor; // é˜Ÿä¼é¢œè‰² &#125;; Player.prototype.win = function() &#123; // ç©å®¶å›¢é˜Ÿèƒœåˆ© console.log('winner: ' + this.name); &#125;; Player.prototype.lose = function() &#123; // ç©å®¶å›¢é˜Ÿå¤±è´¥ console.log('loser: ' + this.name); &#125;; Player.prototype.die = function() &#123; // ç©å®¶æ­»äº¡ var all_dead = true; this.state = 'dead'; // è®¾ç½®ç©å®¶çŠ¶æ€ä¸ºæ­»äº¡ for (var i = 0, partner; partner = this.partners[i++];) &#123; // éå†é˜Ÿå‹åˆ—è¡¨ if (partner.state !== 'dead') &#123; // å¦‚æœè¿˜æœ‰ä¸€ä¸ªé˜Ÿå‹æ²¡æœ‰æ­»äº¡ï¼Œåˆ™æ¸¸æˆè¿˜æœªå¤±è´¥ all_dead = false; break; &#125; &#125; if (all_dead === true) &#123; // å¦‚æœé˜Ÿå‹å…¨éƒ¨æ­»äº¡ this.lose(); // é€šçŸ¥è‡ªå·±æ¸¸æˆå¤±è´¥ for (var i = 0, partner; partner = this.partners[i++];) &#123; // é€šçŸ¥æ‰€æœ‰é˜Ÿå‹ç©å®¶æ¸¸æˆå¤±è´¥ partner.lose(); &#125; for (var i = 0, enemy; enemy = this.enemies[i++];) &#123; // é€šçŸ¥æ‰€æœ‰æ•Œäººæ¸¸æˆèƒœåˆ© enemy.win(); &#125; &#125; &#125;; var playerFactory = function(name, teamColor) &#123; var newPlayer = new Player(name, teamColor); // åˆ›å»ºæ–°ç©å®¶ for (var i = 0, player; player = players[i++];) &#123; // é€šçŸ¥æ‰€æœ‰çš„ç©å®¶ï¼Œæœ‰æ–°è§’è‰²åŠ å…¥ if (player.teamColor === newPlayer.teamColor) &#123; // å¦‚æœæ˜¯åŒä¸€é˜Ÿçš„ç©å®¶ player.partners.push(newPlayer); // ç›¸äº’æ·»åŠ åˆ°é˜Ÿå‹åˆ—è¡¨ newPlayer.partners.push(player); &#125; else &#123; player.enemies.push(newPlayer); // ç›¸äº’æ·»åŠ åˆ°æ•Œäººåˆ—è¡¨ newPlayer.enemies.push(player); &#125; &#125; players.push(newPlayer); return newPlayer; &#125;; var players = []; //çº¢é˜Ÿï¼š var player1 = playerFactory('çš®è›‹', 'red'), player2 = playerFactory('å°ä¹–', 'red'), player3 = playerFactory('å®å®', 'red'), player4 = playerFactory('å°å¼º', 'red'); //è“é˜Ÿï¼š var player5 = playerFactory('é»‘å¦', 'blue'), player6 = playerFactory('è‘±å¤´', 'blue'), player7 = playerFactory('èƒ–å¢©', 'blue'), player8 = playerFactory('æµ·ç›—', 'blue'); player1.die(); player2.die(); player4.die(); player3.die(); // é—®é¢˜,æ¯ä¸ªç©å®¶å’Œå…¶ä»–ç©å®¶éƒ½æ˜¯ç´§ç´§è€¦åˆåœ¨ä¸€èµ·çš„ã€‚å½“æ¯ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œæ¯”å¦‚è§’è‰²ç§»åŠ¨ã€åƒåˆ°é“å…·æˆ–è€…æ­»äº¡æ—¶ï¼Œéƒ½å¿…é¡»è¦æ˜¾å¼åœ°éå†é€šçŸ¥å…¶ä»–å¯¹è±¡ã€‚å½“ç©å®¶å˜çš„å¾ˆå¤šï¼Œåˆ™ä¼šçˆ†ç‚¸ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ä¸­ä»‹è€…æ¨¡å¼æ”¹é€ æ³¡æ³¡å ‚æ¸¸æˆ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; function Player(name, teamColor) &#123; this.name = name; // è§’è‰²åå­— this.teamColor = teamColor; // é˜Ÿä¼é¢œè‰² this.state = 'alive'; // ç©å®¶ç”Ÿå­˜çŠ¶æ€ &#125;; Player.prototype.win = function() &#123; console.log(this.name + ' won '); &#125;; Player.prototype.lose = function() &#123; console.log(this.name + ' lost'); &#125;; /*******************ç©å®¶æ­»äº¡*****************/ Player.prototype.die = function() &#123; this.state = 'dead'; playerDirector.reciveMessage('playerDead', this); // ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œç©å®¶æ­»äº¡ &#125;; /*******************ç§»é™¤ç©å®¶*****************/ Player.prototype.remove = function() &#123; playerDirector.reciveMessage('removePlayer', this); // ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œç§»é™¤ä¸€ä¸ªç©å®¶ &#125;; /*******************ç©å®¶æ¢é˜Ÿ*****************/ Player.prototype.changeTeam = function(color) &#123; playerDirector.reciveMessage('changeTeam', this, color); // ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œç©å®¶æ¢é˜Ÿ &#125;; var playerFactory = function(name, teamColor) &#123; var newPlayer = new Player(name, teamColor); // åˆ›é€ ä¸€ä¸ªæ–°çš„ç©å®¶å¯¹è±¡ playerDirector.reciveMessage('addPlayer', newPlayer); // ç»™ä¸­ä»‹è€…å‘é€æ¶ˆæ¯ï¼Œæ–°å¢ç©å®¶ return newPlayer; &#125;; var playerDirector = (function() &#123; var players = &#123;&#125;, // ä¿å­˜æ‰€æœ‰ç©å®¶ operations = &#123;&#125;; // ä¸­ä»‹è€…å¯ä»¥æ‰§è¡Œçš„æ“ä½œ /****************æ–°å¢ä¸€ä¸ªç©å®¶***************************/ operations.addPlayer = function(player) &#123; var teamColor = player.teamColor; // ç©å®¶çš„é˜Ÿä¼é¢œè‰² players[teamColor] = players[teamColor] || []; // å¦‚æœè¯¥é¢œè‰²çš„ç©å®¶è¿˜æ²¡æœ‰æˆç«‹é˜Ÿä¼ï¼Œåˆ™æ–°æˆç«‹ä¸€ä¸ªé˜Ÿä¼ players[teamColor].push(player); // æ·»åŠ ç©å®¶è¿›é˜Ÿä¼ &#125;; /****************ç§»é™¤ä¸€ä¸ªç©å®¶***************************/ operations.removePlayer = function(player) &#123; var teamColor = player.teamColor, // ç©å®¶çš„é˜Ÿä¼é¢œè‰² teamPlayers = players[teamColor] || []; // è¯¥é˜Ÿä¼æ‰€æœ‰æˆå‘˜ for (var i = teamPlayers.length - 1; i &gt;= 0; i--) &#123; // éå†åˆ é™¤ if (teamPlayers[i] === player) &#123; teamPlayers.splice(i, 1); &#125; &#125; &#125;; /****************ç©å®¶æ¢é˜Ÿ***************************/ operations.changeTeam = function(player, newTeamColor) &#123; // ç©å®¶æ¢é˜Ÿ operations.removePlayer(player); // ä»åŸé˜Ÿä¼ä¸­åˆ é™¤ player.teamColor = newTeamColor; // æ”¹å˜é˜Ÿä¼é¢œè‰² operations.addPlayer(player); // å¢åŠ åˆ°æ–°é˜Ÿä¼ä¸­ &#125;; operations.playerDead = function(player) &#123; // ç©å®¶æ­»äº¡ var teamColor = player.teamColor, teamPlayers = players[teamColor]; // ç©å®¶æ‰€åœ¨é˜Ÿä¼ var all_dead = true; for (var i = 0, player; player = teamPlayers[i++];) &#123; if (player.state !== 'dead') &#123; all_dead = false; break; &#125; &#125; if (all_dead === true) &#123; // å…¨éƒ¨æ­»äº¡ for (var i = 0, player; player = teamPlayers[i++];) &#123; player.lose(); // æœ¬é˜Ÿæ‰€æœ‰ç©å®¶lose &#125; for (var color in players) &#123; if (color !== teamColor) &#123; var teamPlayers = players[color]; // å…¶ä»–é˜Ÿä¼çš„ç©å®¶ for (var i = 0, player; player = teamPlayers[i++];) &#123; player.win(); // å…¶ä»–é˜Ÿä¼æ‰€æœ‰ç©å®¶win &#125; &#125; &#125; &#125; &#125;; var reciveMessage = function() &#123; var message = Array.prototype.shift.call(arguments); // arguments çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæ¶ˆæ¯åç§° operations[message].apply(this, arguments); &#125;; return &#123; reciveMessage: reciveMessage &#125; &#125;)(); // çº¢é˜Ÿï¼š var player1 = playerFactory('çš®è›‹', 'red'), player2 = playerFactory('å°ä¹–', 'red'), player3 = playerFactory('å®å®', 'red'), player4 = playerFactory('å°å¼º', 'red'); // è“é˜Ÿï¼š var player5 = playerFactory('é»‘å¦', 'blue'), player6 = playerFactory('è‘±å¤´', 'blue'), player7 = playerFactory('èƒ–å¢©', 'blue'), player8 = playerFactory('æµ·ç›—', 'blue'); player1.changeTeam('blue'); player2.die(); player3.die(); player4.die(); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; æ™®é€šæ–¹æ³•è´­ä¹°å•†å“123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt;é€‰æ‹©é¢œè‰²: &lt;select id="colorSelect"&gt; &lt;option value=""&gt;è¯·é€‰æ‹©&lt;/option&gt; &lt;option value="red"&gt;çº¢è‰²&lt;/option&gt; &lt;option value="blue"&gt;è“è‰²&lt;/option&gt; &lt;/select&gt; é€‰æ‹©å†…å­˜: &lt;select id="memorySelect"&gt; &lt;option value=""&gt;è¯·é€‰æ‹©&lt;/option&gt; &lt;option value="32G"&gt;32G&lt;/option&gt; &lt;option value="16G"&gt;16G&lt;/option&gt; &lt;/select&gt; è¾“å…¥è´­ä¹°æ•°é‡: &lt;input type="text" id="numberInput" /&gt; &lt;br/&gt; æ‚¨é€‰æ‹©äº†é¢œè‰²: &lt;div id="colorInfo"&gt;&lt;/div&gt; &lt;br/&gt; æ‚¨é€‰æ‹©äº†å†…å­˜: &lt;div id="memoryInfo"&gt;&lt;/div&gt; &lt;br/&gt; æ‚¨è¾“å…¥äº†æ•°é‡: &lt;div id="numberInfo"&gt;&lt;/div&gt; &lt;br/&gt; &lt;button id="nextBtn" disabled="true"&gt;è¯·é€‰æ‹©æ‰‹æœºé¢œè‰²å’Œè´­ä¹°æ•°é‡&lt;/button&gt; &lt;script&gt; // å‡è®¾æˆ‘ä»¬æ­£åœ¨ç¼–å†™ä¸€ä¸ªæ‰‹æœºè´­ä¹°çš„é¡µé¢ï¼Œåœ¨è´­ä¹°æµç¨‹ä¸­ï¼Œå¯ä»¥é€‰æ‹©æ‰‹æœºçš„é¢œè‰²ä»¥åŠè¾“å…¥è´­ä¹°æ•°é‡ï¼ŒåŒæ—¶é¡µé¢ä¸­æœ‰ä¸¤ä¸ªå±•ç¤ºåŒºåŸŸï¼Œåˆ†åˆ«å‘ç”¨æˆ·å±•ç¤ºåˆšåˆšé€‰æ‹©å¥½çš„é¢œè‰²å’Œæ•°é‡ã€‚è¿˜æœ‰ä¸€ä¸ªæŒ‰é’®åŠ¨æ€æ˜¾ç¤ºä¸‹ä¸€æ­¥çš„æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦æŸ¥è¯¢è¯¥é¢œè‰²æ‰‹æœºå¯¹åº”çš„åº“å­˜ï¼Œå¦‚æœåº“å­˜æ•°é‡å°‘äºè¿™æ¬¡çš„è´­ä¹°æ•°é‡ï¼ŒæŒ‰é’®å°†è¢«ç¦ç”¨å¹¶ä¸”æ˜¾ç¤ºåº“å­˜ä¸è¶³ï¼Œåä¹‹æŒ‰é’®å¯ä»¥ç‚¹å‡»å¹¶ä¸”æ˜¾ç¤ºæ”¾å…¥è´­ç‰©è½¦ã€‚ var colorSelect = document.getElementById('colorSelect'), numberInput = document.getElementById('numberInput'), colorInfo = document.getElementById('colorInfo'), numberInfo = document.getElementById('numberInfo'), nextBtn = document.getElementById('nextBtn'); var goods = &#123; // æ‰‹æœºåº“å­˜ "red|32G": 3, // çº¢è‰²32Gï¼Œåº“å­˜æ•°é‡ä¸º3 "red|16G": 0, "blue|32G": 1, "blue|16G": 6 &#125;; colorSelect.onchange = function() &#123; var color = this.value, memory = memorySelect.value, stock = goods[color + '|' + memory]; number = numberInput.value, // æ•°é‡ colorInfo.innerHTML = color; if (!color) &#123; nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·é€‰æ‹©æ‰‹æœºé¢œè‰²'; return; &#125; if (!memory) &#123; nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·é€‰æ‹©å†…å­˜å¤§å°'; return; &#125; if (!(/^[0-9]*[1-9][0-9]*$/).test(number)) &#123; // è¾“å…¥è´­ä¹°æ•°é‡æ˜¯å¦ä¸ºæ­£æ•´æ•° nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·è¾“å…¥æ­£ç¡®çš„è´­ä¹°æ•°é‡'; return; &#125; if (number &gt; stock) &#123; // å½“å‰é€‰æ‹©æ•°é‡æ²¡æœ‰è¶…è¿‡åº“å­˜é‡ nextBtn.disabled = true; nextBtn.innerHTML = 'åº“å­˜ä¸è¶³'; return; &#125; nextBtn.disabled = false; nextBtn.innerHTML = 'æ”¾å…¥è´­ç‰©è½¦'; &#125;; numberInput.oninput = function() &#123; var color = colorSelect.value, // é¢œè‰² number = this.value, // æ•°é‡ memory = memorySelect.value, stock = goods[color + '|' + memory]; number = numberInput.value, // æ•°é‡ numberInfo.innerHTML = number; if (!color) &#123; nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·é€‰æ‹©æ‰‹æœºé¢œè‰²'; return; &#125; if (!memory) &#123; nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·é€‰æ‹©å†…å­˜å¤§å°'; return; &#125; if (!(/^[0-9]*[1-9][0-9]*$/).test(number)) &#123; // è¾“å…¥è´­ä¹°æ•°é‡æ˜¯å¦ä¸ºæ­£æ•´æ•° nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·è¾“å…¥æ­£ç¡®çš„è´­ä¹°æ•°é‡'; return; &#125; if (number &gt; stock) &#123; // å½“å‰é€‰æ‹©æ•°é‡æ²¡æœ‰è¶…è¿‡åº“å­˜é‡ nextBtn.disabled = true; nextBtn.innerHTML = 'åº“å­˜ä¸è¶³'; return; &#125; nextBtn.disabled = false; nextBtn.innerHTML = 'æ”¾å…¥è´­ç‰©è½¦'; &#125;; memorySelect.onchange = function() &#123; var color = colorSelect.value, // é¢œè‰² number = numberInput.value, // æ•°é‡ memory = this.value, stock = goods[color + '|' + memory]; // è¯¥é¢œè‰²æ‰‹æœºå¯¹åº”çš„å½“å‰åº“å­˜ memoryInfo.innerHTML = memory; if (!color) &#123; nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·é€‰æ‹©æ‰‹æœºé¢œè‰²'; return; &#125; if (!memory) &#123; nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·é€‰æ‹©å†…å­˜å¤§å°'; return; &#125; if (!(/^[0-9]*[1-9][0-9]*$/).test(number)) &#123; // è¾“å…¥è´­ä¹°æ•°é‡æ˜¯å¦ä¸ºæ­£æ•´æ•° nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·è¾“å…¥æ­£ç¡®çš„è´­ä¹°æ•°é‡'; return; &#125; if (number &gt; stock) &#123; // å½“å‰é€‰æ‹©æ•°é‡æ²¡æœ‰è¶…è¿‡åº“å­˜é‡ nextBtn.disabled = true; nextBtn.innerHTML = 'åº“å­˜ä¸è¶³'; return; &#125; nextBtn.disabled = false; nextBtn.innerHTML = 'æ”¾å…¥è´­ç‰©è½¦'; &#125;; // ä¸Šé¢çš„æ–¹å¼ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½è€¦åˆåœ¨ä¸€èµ·ï¼Œå½“ä¿®æ”¹ä¸€ä¸ªåœ°æ–¹ï¼Œéœ€è¦åœ¨æ¯ä¸ªäº‹ä»¶é‡ŒåŒæ­¥ä¿®æ”¹ï¼Œéå¸¸ä¸åˆ©äºç»´æŠ¤ã€‚ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ä¸­ä»‹è€…æ¨¡å¼è´­ä¹°å•†å“123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt;é€‰æ‹©é¢œè‰²: &lt;select id="colorSelect"&gt; &lt;option value=""&gt;è¯·é€‰æ‹©&lt;/option&gt; &lt;option value="red"&gt;çº¢è‰²&lt;/option&gt; &lt;option value="blue"&gt;è“è‰²&lt;/option&gt; &lt;/select&gt; é€‰æ‹©å†…å­˜: &lt;select id="memorySelect"&gt; &lt;option value=""&gt;è¯·é€‰æ‹©&lt;/option&gt; &lt;option value="16G"&gt;16G&lt;/option&gt; &lt;option value="32G"&gt;32G&lt;/option&gt; &lt;/select&gt; é€‰æ‹©CPU: &lt;select id="cpuSelect"&gt; &lt;option value=""&gt;è¯·é€‰æ‹©&lt;/option&gt; &lt;option value="800"&gt;800&lt;/option&gt; &lt;option value="801"&gt;801&lt;/option&gt; &lt;/select&gt; è¾“å…¥è´­ä¹°æ•°é‡: &lt;input type="text" id="numberInput" /&gt; &lt;br/&gt; æ‚¨é€‰æ‹©äº†é¢œè‰²: &lt;div id="colorInfo"&gt;&lt;/div&gt; &lt;br/&gt; æ‚¨é€‰æ‹©äº†å†…å­˜: &lt;div id="memoryInfo"&gt;&lt;/div&gt; &lt;br/&gt;æ‚¨é€‰æ‹©äº†cpu: &lt;div id="cpuInfo"&gt;&lt;/div&gt; &lt;br/&gt; æ‚¨è¾“å…¥äº†æ•°é‡: &lt;div id="numberInfo"&gt;&lt;/div&gt; &lt;br/&gt; &lt;button id="nextBtn" disabled="true"&gt;è¯·é€‰æ‹©æ‰‹æœºé¢œè‰²å’Œè´­ä¹°æ•°é‡&lt;/button&gt; &lt;script&gt; // å¼•å…¥ä¸­ä»‹è€…æ¨¡å¼,æ‰€æœ‰çš„èŠ‚ç‚¹å¯¹è±¡åªè·Ÿä¸­ä»‹è€…é€šä¿¡ var goods = &#123; // æ‰‹æœºåº“å­˜ "red|32G|800": 3, // é¢œè‰²redï¼Œå†…å­˜32Gï¼Œcpu800ï¼Œå¯¹åº”åº“å­˜æ•°é‡ä¸º3 "red|16G|801": 0, "blue|32G|800": 1, "blue|16G|801": 6 &#125;; var mediator = (function() &#123; var colorSelect = document.getElementById('colorSelect'), memorySelect = document.getElementById('memorySelect'), numberInput = document.getElementById('numberInput'), colorInfo = document.getElementById('colorInfo'), cpuInfo = document.getElementById('cpuInfo'), memoryInfo = document.getElementById('memoryInfo'), numberInfo = document.getElementById('numberInfo'), nextBtn = document.getElementById('nextBtn'), cpuSelect = document.getElementById('cpuSelect'); return &#123; changed: function(obj) &#123; var color = colorSelect.value, memory = memorySelect.value, number = numberInput.value, cpu = cpuSelect.value, stock = goods[color + '|' + memory + '|' + cpu]; if (obj === colorSelect) &#123; colorInfo.innerHTML = color; &#125; else if (obj === memorySelect) &#123; memoryInfo.innerHTML = memory; &#125; else if (obj === cpuSelect) &#123; cpuInfo.innerHTML = cpu; &#125; else if (obj === numberInput) &#123; numberInfo.innerHTML = number; &#125; if (!color) &#123; nextBtn.disabled = true; nextBtn.innerHTML = "è¯·é€‰æ‹©æ‰‹æœºé¢œè‰²"; return; &#125; if (!memory) &#123; nextBtn.disabled = true; nextBtn.innerHTML = "è¯·é€‰æ‹©æ‰‹æœºå†…å­˜å¤§å°"; return; &#125; if (!cpu) &#123; nextBtn.disabled = true; nextBtn.innerHTML = "è¯·é€‰æ‹©CPU"; return; &#125; if (!(/^[0-9]*[1-9][0-9]*$/).test(number)) &#123; // è¾“å…¥è´­ä¹°æ•°é‡æ˜¯å¦ä¸ºæ­£æ•´æ•° nextBtn.disabled = true; nextBtn.innerHTML = 'è¯·è¾“å…¥æ­£ç¡®çš„è´­ä¹°æ•°é‡'; return; &#125; if (!stock || number &gt; stock) &#123; // å½“å‰é€‰æ‹©æ•°é‡æ²¡æœ‰è¶…è¿‡åº“å­˜é‡ nextBtn.disabled = true; nextBtn.innerHTML = 'åº“å­˜ä¸è¶³'; return; &#125; nextBtn.disabled = false; nextBtn.innerHTML = "æ”¾å…¥è´­ç‰©è½¦"; &#125; &#125;; &#125;)(); colorSelect.onchange = function() &#123; mediator.changed(this); &#125;; memorySelect.onchange = function() &#123; mediator.changed(this); &#125;; cpuSelect.onchange = function() &#123; mediator.changed(this); &#125;; numberInput.oninput = function() &#123; mediator.changed(this); &#125;; // å½“å†æ·»åŠ ä¸€ä¸ªcpuå‹å·æ—¶ï¼Œå¯ç›´æ¥åœ¨mediatorä¸­æ·»åŠ å³å¯ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; è£…é¥°è€…æ¨¡å¼åŸºæœ¬å®šä¹‰12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // è£…é¥°è€…æ¨¡å¼:è£…é¥°è€…æ¨¡å¼å¯ä»¥åŠ¨æ€åœ°ç»™æŸä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ï¼Œè€Œä¸ä¼šå½±å“ä»è¿™ä¸ªç±»ä¸­æ´¾ç”Ÿçš„å…¶ä»–å¯¹è±¡ã€‚è£…é¥°è€…æ¨¡å¼èƒ½å¤Ÿåœ¨ä¸æ”¹å˜å¯¹è±¡è‡ªèº«çš„åŸºç¡€ä¸Šï¼Œåœ¨ç¨‹åºè¿è¡ŒæœŸé—´ç»™å¯¹è±¡ åŠ¨æ€åœ°æ·»åŠ èŒè´£ã€‚ // ä½¿ç”¨åœºæ™¯:å½“éœ€è¦ç»™å¯¹è±¡åŠ¨æ€çš„æ·»åŠ è¡Œä¸ºæ—¶ // ä½¿ç”¨ä¸¾ä¾‹:ç»Ÿè®¡ä»£ç ã€æ’ä»¶å¼éªŒè¯ç­‰ // ä¼ ç»Ÿè£…é¥°è€…æ¨¡å¼ // var Plane = function() &#123;&#125; // Plane.prototype.fire = function() &#123; // console.log('å‘å°„æ™®é€šå­å¼¹'); // &#125;; // var MissileDecorator = function(plane) &#123; // this.plane = plane; // &#125; // MissileDecorator.prototype.fire = function() &#123; // this.plane.fire(); // console.log('å‘å°„å¯¼å¼¹'); // &#125;; // var AtomDecorator = function(plane) &#123; // this.plane = plane; // &#125;; // AtomDecorator.prototype.fire = function() &#123; // this.plane.fire(); // console.log('å‘å°„åŸå­å¼¹'); // &#125;; // var plane = new Plane(); // plane = new MissileDecorator(plane); // plane = new AtomDecorator(plane); // plane.fire(); // // åˆ†åˆ«è¾“å‡ºï¼š å‘å°„æ™®é€šå­å¼¹ã€å‘å°„å¯¼å¼¹ã€å‘å°„åŸå­å¼¹ // jsä¸­çš„è£…é¥°è€…æ¨¡å¼ var plane = &#123; fire: function() &#123; console.log("å‘å°„æ™®é€š"); &#125; &#125;; var missileDecorator = function() &#123; console.log('å‘å°„å¯¼å¼¹'); &#125; var atomDecorator = function() &#123; console.log('å‘å°„åŸå­å¼¹'); &#125; var fire1 = plane.fire; plane.fire = function() &#123; fire1(); missileDecorator(); &#125; var fire2 = plane.fire; plane.fire = function() &#123; fire2(); atomDecorator(); &#125; plane.fire(); // åˆ†åˆ«è¾“å‡ºï¼š å‘å°„æ™®é€šå­å¼¹ã€å‘å°„å¯¼å¼¹ã€å‘å°„åŸå­å¼¹ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; è£…é¥°å‡½æ•°1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // è£…é¥°å‡½æ•°-&gt;ä¸ºå‡½æ•°æ·»åŠ åŠŸèƒ½ // æœ€lowçš„æ·»åŠ åŠŸèƒ½ï¼Œç›´æ¥æ”¹å†™åŸå‡½æ•° // var a = function() &#123; // alert(1); // &#125;; // var a = function() &#123; // alert(1); // alert(2); // &#125;; // ä¿å­˜åŸå‡½æ•°çš„å¼•ç”¨ï¼Œè¿™ç§æ–¹æ³•å¿…é¡»å¾—ç»´æŠ¤_aè¿™ä¸ªä¸­é—´é‡ï¼Œå¦‚æœè£…é¥°é“¾è¿‡é•¿æˆ–è¦è£…é¥°çš„å‡½æ•°è¿‡å¤šï¼Œä¸­é—´é‡å°±ä¼šå˜çš„å¾ˆå¤š;è¿˜ä¼šå‡ºç°thisåŠ«æŒé—®é¢˜ // var a = function() &#123; // alert(1); // &#125;; // var _a = a; // a = function() &#123; // _a(); // alert(2); // &#125;; // a(); // ä¸Šé¢æ–¹æ³•ä¼šå‡ºç°ä¸‹é¢çš„thisåŠ«æŒé—®é¢˜ // var _getElementById = document.getElementById; // document.getElementById = function(id) &#123; // alert(1); // return _getElementById(id); // (1) // &#125; // var button = document.getElementById('button'); // error // æŠ¥é”™åŸå› æ˜¯getElementByIdå†…éƒ¨æ˜¯è¦ç”¨åˆ°this,è°ƒç”¨_getElementByIdæ—¶thisæ˜¯æŒ‡å‘windowè€Œä¸æ˜¯documentï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ // ä¸ºè§£å†³ä¸Šé¢é—®é¢˜ï¼Œå¯ä»¥å°†documentåŠ¨æ€ä¼ å…¥ var _getElementById = document.getElementById; document.getElementById = function() &#123; alert(1); return _getElementById.apply(document, arguments); &#125; var button = document.getElementById('button'); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ç”¨AOPæ¥è£…é¥°å‡½æ•°1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; Function.prototype.before = function(beforefn) &#123; var __self = this; // ä¿å­˜åŸå‡½æ•°çš„å¼•ç”¨ return function() &#123; // è¿”å›åŒ…å«äº†åŸå‡½æ•°å’Œæ–°å‡½æ•°çš„"ä»£ç†"å‡½æ•° beforefn.apply(this, arguments); // æ‰§è¡Œæ–°å‡½æ•°ï¼Œä¸”ä¿è¯this ä¸è¢«åŠ«æŒï¼Œæ–°å‡½æ•°æ¥å—çš„å‚æ•° // ä¹Ÿä¼šè¢«åŸå°ä¸åŠ¨åœ°ä¼ å…¥åŸå‡½æ•°ï¼Œæ–°å‡½æ•°åœ¨åŸå‡½æ•°ä¹‹å‰æ‰§è¡Œ return __self.apply(this, arguments); // æ‰§è¡ŒåŸå‡½æ•°å¹¶è¿”å›åŸå‡½æ•°çš„æ‰§è¡Œç»“æœï¼Œ // å¹¶ä¸”ä¿è¯this ä¸è¢«åŠ«æŒ &#125; &#125;; Function.prototype.after = function(afterfn) &#123; var __self = this; return function() &#123; var ret = __self.apply(this, arguments); afterfn.apply(this, arguments); return ret; &#125; &#125;; document.getElementById = document.getElementById.before(function() &#123; alert("å–buttonä¹‹å‰"); &#125;); var button = document.getElementById('button'); console.log(button); window.onload = function() &#123; alert(1); &#125; window.onload = (window.onload || function() &#123;&#125;).after(function() &#123; alert(2); &#125;).after(function() &#123; alert(3); &#125;).after(function() &#123; alert(4); &#125;); // ä¸Šé¢çš„AOP å®ç°æ˜¯åœ¨Function.prototype ä¸Šæ·»åŠ before å’Œafter æ–¹æ³•ï¼Œä½†è®¸å¤šäººä¸å–œæ¬¢è¿™ç§æ±¡æŸ“åŸå‹çš„æ–¹å¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åšä¸€äº›å˜é€šï¼ŒæŠŠåŸå‡½æ•°å’Œæ–°å‡½æ•°éƒ½ä½œä¸ºå‚æ•°ä¼ å…¥before æˆ–è€…after æ–¹æ³• var before = function(fn, beforefn) &#123; return function() &#123; beforefn.apply(this, arguments); return fn.apply(this, arguments); &#125; &#125; var a = before( function() &#123; alert(3) &#125;, function() &#123; alert(2) &#125; ); a = before(a, function() &#123; alert(1); &#125;); a(); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ç”¨AOPå®ç°æ•°æ®ä¸ŠæŠ¥12345678910111213141516171819202122232425262728293031323334353637383940414243444546&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;button tag="login" id="button"&gt;ç‚¹å‡»æ‰“å¼€ç™»å½•æµ®å±‚&lt;/button&gt; &lt;script&gt; // ä¸€èˆ¬åœ¨ä¸šåŠ¡å®Œæˆåè¦è¦æ±‚æ·»åŠ ä¸Šæ•°æ®ç»Ÿè®¡çš„åŠŸèƒ½ // æ™®é€šä¸ŠæŠ¥ // var showLogin = function() &#123; // console.log('æ‰“å¼€ç™»å½•æµ®å±‚'); // log(this.getAttribute('tag')); // &#125; // var log = function(tag) &#123; // console.log('ä¸ŠæŠ¥æ ‡ç­¾ä¸º: ' + tag); // // (new Image).src = 'http:// xxx.com/report?tag=' + tag; // çœŸæ­£çš„ä¸ŠæŠ¥ä»£ç ç•¥ // &#125; // document.getElementById('button').onclick = showLogin; // showLoginæ—¢æ‰“å¼€æµ®å±‚åˆä¸ŠæŠ¥ // ä½¿ç”¨AOPåˆ†ç¦» Function.prototype.after = function(afterfn) &#123; var __self = this; return function() &#123; var ret = __self.apply(this, arguments); afterfn.apply(this, arguments); return ret; &#125; &#125;; var showLogin = function() &#123; console.log('æ‰“å¼€ç™»å½•æµ®å±‚'); &#125;; var log = function() &#123; console.log('ä¸ŠæŠ¥æ ‡ç­¾ä¸º: ' + this.getAttribute('tag')); &#125;; showLogin = showLogin.after(log); // æ‰“å¼€ç™»å½•æµ®å±‚ä¹‹åä¸ŠæŠ¥æ•°æ® document.getElementById('button').onclick = showLogin; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ç”¨AOPåŠ¨æ€æ”¹å˜å‡½æ•°çš„å‚æ•°12345678910111213141516171819202122232425262728293031&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // 1,2å…¬ç”¨äº†argumentsï¼Œæ‰€ä»¥å¯ä»¥åœ¨1ä¸­å°†argumentsæ”¹å˜ Function.prototype.before = function(beforefn) &#123; var __self = this; return function() &#123; beforefn.apply(this, arguments); // (1) return __self.apply(this, arguments); // (2) &#125; &#125;; var func = function(param) &#123; console.log(param); // è¾“å‡ºï¼š &#123;a: "a", b: "b"&#125; &#125; func = func.before(function(param) &#123; param.b = 'b'; &#125;); func(&#123; a: 'a' &#125;); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; åˆ©ç”¨AOPåŠ¨æ€æ”¹å˜å‚æ•°å®ç°å‘é€ajaxå‰æ·»åŠ token12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // éœ€è¦åœ¨æ¯æ¬¡å‘é€ajaxå‰æ·»åŠ ä¸€ä¸ªéªŒè¯ç”¨çš„token // é€šå¸¸åšæ³• // var getToken = function() &#123; // return 'Token'; // &#125; // var ajax = function(type, url, param) &#123; // param = param || &#123;&#125;; // param.Token = getToken(); // å‘é€ajax è¯·æ±‚çš„ä»£ç ç•¥... // &#125;; // å¦‚æœè¦å°†è¿™ä¸ªajaxå‘å¸ƒåˆ°ç½‘ä¸Šï¼Œå¯èƒ½æœ‰äº›äººå°±ä¸éœ€è¦token // æ”¹è¿› Function.prototype.before = function(beforefn) &#123; var __self = this; // ä¿å­˜åŸå‡½æ•°çš„å¼•ç”¨ return function() &#123; // è¿”å›åŒ…å«äº†åŸå‡½æ•°å’Œæ–°å‡½æ•°çš„"ä»£ç†"å‡½æ•° beforefn.apply(this, arguments); // æ‰§è¡Œæ–°å‡½æ•°ï¼Œä¸”ä¿è¯this ä¸è¢«åŠ«æŒï¼Œæ–°å‡½æ•°æ¥å—çš„å‚æ•° // ä¹Ÿä¼šè¢«åŸå°ä¸åŠ¨åœ°ä¼ å…¥åŸå‡½æ•°ï¼Œæ–°å‡½æ•°åœ¨åŸå‡½æ•°ä¹‹å‰æ‰§è¡Œ return __self.apply(this, arguments); // æ‰§è¡ŒåŸå‡½æ•°å¹¶è¿”å›åŸå‡½æ•°çš„æ‰§è¡Œç»“æœï¼Œ // å¹¶ä¸”ä¿è¯this ä¸è¢«åŠ«æŒ &#125; &#125;; var ajax = function(type, url, param) &#123; console.log(param); &#125;; var getToken = function() &#123; return "Token"; &#125;; // åœ¨ajaxå‘é€ä¹‹å‰æ·»åŠ token ajax = ajax.before(function(type, url, param) &#123; param.Token = getToken(); &#125;); ajax("get", 'http:// xxx.com/userinfo', &#123; name: 'sven' &#125;); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; æ’ä»¶å¼çš„è¡¨å•éªŒè¯123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt;ç”¨æˆ·åï¼š &lt;input id="username" type="text" /&gt; å¯†ç ï¼š &lt;input id="password" type="password" /&gt; &lt;input id="submitBtn" type="button" value="æäº¤"&gt; &lt;script&gt; // æ­£å¸¸å†™æ³• // var username = document.getElementById('username'), // password = document.getElementById('password'), // submitBtn = document.getElementById('submitBtn'); // var formSubmit = function() &#123; // if (username.value === '') &#123; // return alert('ç”¨æˆ·åä¸èƒ½ä¸ºç©º'); // &#125; // if (password.value === '') &#123; // return alert('å¯†ç ä¸èƒ½ä¸ºç©º'); // &#125; // var param = &#123; // username: username.value, // password: password.value // &#125; // ajax('http:// xxx.com/login', param); // ajax å…·ä½“å®ç°ç•¥ // &#125; // submitBtn.onclick = function() &#123; // formSubmit(); // &#125;; // å­˜åœ¨çš„é—®é¢˜formSubmitæ‰¿æ‹…äº†è¿‡å¤šçš„èŒè´£ï¼Œä¸€è¦éªŒè¯ï¼ŒäºŒè¦è´Ÿè´£æäº¤ // å°†éªŒè¯é€»è¾‘åˆ†ç¦»åˆ°validataä¸­ // var validata = function() &#123; // if (username.value === '') &#123; // alert('ç”¨æˆ·åä¸èƒ½ä¸ºç©º'); // return false; // &#125; // if (password.value === '') &#123; // alert('å¯†ç ä¸èƒ½ä¸ºç©º'); // return false; // &#125; // &#125;; // var formSubmit = function() &#123; // if (validata() === false) &#123; // æ ¡éªŒæœªé€šè¿‡ // return; // &#125; // var param = &#123; // username: username.value, // password: password.value // &#125; // ajax('http:// xxx.com/login', param); // &#125;; // submitBtn.onclick = function() &#123; // formSubmit(); // &#125;; // æ­¤æ—¶ï¼Œè™½å°†éªŒè¯é€»è¾‘æŠ½ç¦»ï¼Œä½†formSubmitä¸­è¿˜éœ€è¦validataçš„è¿”å›å€¼ // å†æ¬¡ä¼˜åŒ– Function.prototype.before = function(beforefn) &#123; var __self = this; return function() &#123; if (beforefn.apply(this, arguments) === false) &#123; // beforefn è¿”å›false çš„æƒ…å†µç›´æ¥returnï¼Œä¸å†æ‰§è¡Œåé¢çš„åŸå‡½æ•° return; &#125; return __self.apply(this, arguments); &#125; &#125;; var validata = function() &#123; if (username.value === '') &#123; alert('ç”¨æˆ·åä¸èƒ½ä¸ºç©º'); return false; &#125; if (password.value === '') &#123; alert('å¯†ç ä¸èƒ½ä¸ºç©º'); return false; &#125; &#125;; var formSubmit = function() &#123; var param = &#123; username: username.value, password: password.value &#125; ajax('http:// xxx.com/login', param); &#125;; // åˆ©ç”¨AOPåŠ¨æ€ç»‡å…¥éªŒè¯é€»è¾‘ formSubmit = formSubmit.before(validata); submitBtn.onclick = function() &#123; formSubmit(); &#125; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; AOPçš„æ³¨æ„äº‹é¡¹12345678910111213141516171819202122232425262728293031323334&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; // before,afterè¿”å›çš„å®é™…ä¸Šæ˜¯ä¸€ä¸ªæ–°å‡½æ•°ï¼Œæ‰€ä»¥åŸå…ˆä¿å­˜åœ¨å‡½æ•°ä¸Šçš„å±æ€§ä¼šä¸¢å¤±;è¿™ç§è£…é¥°æ–¹å¼ä¹Ÿå åŠ äº†å‡½æ•°çš„ä½œç”¨åŸŸï¼Œå¦‚æœè£…é¥°çš„é“¾æ¡è¿‡é•¿ï¼Œæ€§èƒ½ä¸Šä¹Ÿä¼šå—åˆ°ä¸€äº›å½±å“ã€‚ Function.prototype.after = function(afterfn) &#123; var __self = this; return function() &#123; var ret = __self.apply(this, arguments); afterfn.apply(this, arguments); return ret; &#125; &#125;; var func = function() &#123; alert(1); &#125; func.a = 'a'; func = func.after(function() &#123; alert(2); &#125;); alert(func.a); // è¾“å‡ºï¼šundefined // ä»£ç†æ¨¡å¼å’Œè£…é¥°è€…æ¨¡å¼çš„ä¸åŒ // ä»£ç†æ¨¡å¼å’Œè£…é¥°è€…æ¨¡å¼æœ€é‡è¦çš„åŒºåˆ«åœ¨äºå®ƒä»¬çš„æ„å›¾å’Œè®¾è®¡ç›®çš„ã€‚ä»£ç†æ¨¡å¼çš„ç›®çš„æ˜¯ï¼Œå½“ç›´æ¥è®¿é—®æœ¬ä½“ä¸æ–¹ä¾¿æˆ–è€…ä¸ç¬¦åˆéœ€è¦æ—¶ï¼Œä¸ºè¿™ä¸ªæœ¬ä½“æä¾›ä¸€ä¸ªæ›¿ä»£è€…ã€‚æœ¬ä½“å®šä¹‰äº†å…³é”®åŠŸèƒ½ï¼Œè€Œä»£ç†æä¾›æˆ–æ‹’ç»å¯¹å®ƒçš„è®¿é—®ï¼Œæˆ–è€…åœ¨è®¿é—®æœ¬ä½“ä¹‹å‰åšä¸€äº›é¢å¤–çš„äº‹æƒ…ã€‚è£…é¥°è€…æ¨¡å¼çš„ä½œç”¨å°±æ˜¯ä¸ºå¯¹è±¡åŠ¨æ€åŠ å…¥è¡Œä¸ºã€‚æ¢å¥è¯è¯´ï¼Œä»£ç†æ¨¡å¼å¼ºè°ƒä¸€ç§å…³ç³»ï¼ˆProxy ä¸å®ƒçš„å®ä½“ä¹‹é—´çš„å…³ç³»ï¼‰ï¼Œè¿™ç§å…³ç³»å¯ä»¥é™æ€çš„è¡¨è¾¾ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ç§å…³ç³»åœ¨ä¸€å¼€å§‹å°±å¯ä»¥è¢«ç¡®å®šã€‚è€Œè£…é¥°è€…æ¨¡å¼ç”¨äºä¸€å¼€å§‹ä¸èƒ½ç¡®å®šå¯¹è±¡çš„å…¨éƒ¨åŠŸèƒ½æ—¶ã€‚ä»£ç†æ¨¡å¼é€šå¸¸åªæœ‰ä¸€å±‚ä»£ç†ï€­æœ¬ä½“çš„å¼•ç”¨ï¼Œè€Œè£…é¥°è€…æ¨¡å¼ç»å¸¸ä¼šå½¢æˆä¸€æ¡é•¿é•¿çš„è£…é¥°é“¾ã€‚ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; çŠ¶æ€æ¨¡å¼åŸºæœ¬å®šä¹‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // çŠ¶æ€æ¨¡å¼:å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºï¼Œå¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»ã€‚çŠ¶æ€æ¨¡å¼çš„å…³é”®æ˜¯åŒºåˆ†äº‹ç‰©å†…éƒ¨çš„çŠ¶æ€ï¼Œäº‹ç‰©å†…éƒ¨çŠ¶æ€çš„æ”¹å˜å¾€å¾€ä¼šå¸¦æ¥äº‹ç‰©çš„è¡Œä¸ºæ”¹å˜ã€‚å¾€å¾€å°†çŠ¶æ€å°è£…æˆä¸€ä¸ªç±»ï¼Œè·Ÿæ­¤çŠ¶æ€æœ‰å…³çš„æ‰€æœ‰è¡Œä¸ºéƒ½è¢«å°è£…åœ¨è¿™ä¸ªç±»çš„å†…éƒ¨ // ä½¿ç”¨åœºæ™¯:ç¨‹åºæœ‰å¤šç§çŠ¶æ€ï¼Œå¹¶çŠ¶æ€æ”¹å˜ä¼šå½±å“å…¶ä»–è¡Œä¸ºæ—¶ // ä½¿ç”¨ä¸¾ä¾‹:ä¸€ä¸ªå¼€å…³çš„ä¸¤ä¸ªçŠ¶æ€(å¼€ã€å…³)ï¼Œå°†å½±å“ç¯æ³¡çš„çŠ¶æ€ var Light = function() &#123; this.state = 'off'; // ç»™ç”µç¯è®¾ç½®åˆå§‹çŠ¶æ€off this.button = null; // ç”µç¯å¼€å…³æŒ‰é’® &#125;; Light.prototype.init = function() &#123; var button = document.createElement('button'), self = this; button.innerHTML = 'å¼€å…³'; this.button = document.body.appendChild(button); this.button.onclick = function() &#123; self.buttonWasPressed(); &#125; &#125;; Light.prototype.buttonWasPressed = function() &#123; if (this.state === 'off') &#123; console.log('å¼€ç¯'); this.state = 'on'; &#125; else if (this.state === 'on') &#123; console.log('å…³ç¯'); this.state = 'off'; &#125; &#125;; var light = new Light(); light.init(); //è¿™ä¸ªä¸–ç•Œä¸Šçš„ç”µç¯å¹¶éåªæœ‰ä¸€ç§ã€‚è®¸å¤šé…’åº—é‡Œæœ‰å¦å¤–ä¸€ç§ç”µç¯ï¼Œè¿™ç§ç”µç¯ä¹Ÿåªæœ‰ä¸€ä¸ªå¼€å…³ï¼Œä½†å®ƒçš„è¡¨ç°æ˜¯ï¼šç¬¬ä¸€æ¬¡æŒ‰ä¸‹æ‰“å¼€å¼±å…‰ï¼Œç¬¬äºŒæ¬¡æŒ‰ä¸‹æ‰“å¼€å¼ºå…‰ï¼Œç¬¬ä¸‰æ¬¡æ‰æ˜¯å…³é—­ç”µç¯ Light.prototype.buttonWasPressed = function() &#123; if (this.state === 'off') &#123; console.log('å¼±å…‰'); this.state = 'weakLight'; &#125; else if (this.state === 'weakLight') &#123; console.log('å¼ºå…‰'); this.state = 'strongLight'; &#125; else if (this.state === 'strongLight') &#123; console.log('å…³ç¯'); this.state = 'off'; &#125; &#125;; // ä¸Šé¢çš„ç¼ºç‚¹ // buttonWasPressedæ–¹æ³•è¿åäº†å¼€æ”¾-å°é—­åŸåˆ™ï¼Œæ¯æ¬¡æ–°å¢æˆ–ä¿®æ”¹lightçš„çŠ¶æ€éƒ½éœ€è¦æ”¹åŠ¨buttonWasPressedæ–¹æ³• // æ‰€æœ‰è·ŸçŠ¶æ€æœ‰å…³çš„è¡Œä¸ºéƒ½å°è£…åœ¨äº†buttonWasPressedæ–¹æ³•é‡Œï¼Œä»¥åè‹¥éœ€è¦ä¿®æ”¹å¯èƒ½ä¼šé€ æˆæ­¤æ–¹æ³•çš„æ— é™è†¨èƒ€ // çŠ¶æ€çš„åˆ‡æ¢éå¸¸ä¸æ˜æ˜¾ï¼Œä»…ä»…è¡¨ç°åœ¨å¯¹stateå˜é‡çš„èµ‹å€¼ï¼Œå®é™…è¿‡ç¨‹ä¸­å¯èƒ½ä¼šé—å¿˜ï¼Œä¹Ÿæ— æ³•ä¸€ç›®äº†ç„¶çš„çŸ¥é“æ€»å…±æœ‰å¤šå°‘çŠ¶æ€ // çŠ¶æ€ä¹‹é—´çš„åˆ‡æ¢å…³ç³»ä¾é if...elseæ¥åˆ‡æ¢ï¼Œç»´æŠ¤éº»çƒ¦ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; çŠ¶æ€æ¨¡å¼æ”¹è¿›ç”µç¯ç¨‹åº12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // é€šå¸¸æˆ‘ä»¬è°ˆåˆ°å°è£…ï¼Œä¸€èˆ¬éƒ½ä¼šä¼˜å…ˆå°è£…å¯¹è±¡çš„è¡Œä¸ºï¼Œè€Œä¸æ˜¯å¯¹è±¡çš„çŠ¶æ€ã€‚ä½†åœ¨çŠ¶æ€æ¨¡å¼ä¸­åˆšå¥½ç›¸åï¼ŒçŠ¶æ€æ¨¡å¼çš„å…³é”®æ˜¯æŠŠäº‹ç‰©çš„æ¯ç§çŠ¶æ€éƒ½å°è£…æˆå•ç‹¬çš„ç±»ï¼Œè·Ÿæ­¤ç§çŠ¶æ€æœ‰å…³çš„è¡Œä¸ºéƒ½è¢«å°è£…åœ¨è¿™ä¸ªç±»çš„å†…éƒ¨ï¼Œæ‰€ä»¥button è¢«æŒ‰ä¸‹çš„çš„æ—¶å€™ï¼Œåªéœ€è¦åœ¨ä¸Šä¸‹æ–‡ä¸­ï¼ŒæŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™å½“å‰çš„çŠ¶æ€å¯¹è±¡å³å¯ï¼Œè¯¥çŠ¶æ€å¯¹è±¡ä¼šè´Ÿè´£æ¸²æŸ“å®ƒè‡ªèº«çš„è¡Œä¸º // OffLightState var OffLightState = function(light) &#123; this.light = light; &#125;; OffLightState.prototype.buttonWasPressed = function() &#123; console.log("å¼±å…‰"); // offLightStateå¯¹åº”çš„è¡Œä¸º this.light.setState(this.light.weakLightState); // åˆ‡æ¢åˆ°weakLightState &#125;; // WeakLightStateï¼š var WeakLightState = function(light) &#123; this.light = light; &#125;; WeakLightState.prototype.buttonWasPressed = function() &#123; console.log('å¼ºå…‰'); // weakLightState å¯¹åº”çš„è¡Œä¸º this.light.setState(this.light.strongLightState); // åˆ‡æ¢çŠ¶æ€åˆ°strongLightState &#125;; // StrongLightStateï¼š var StrongLightState = function(light) &#123; this.light = light; &#125;; StrongLightState.prototype.buttonWasPressed = function() &#123; console.log('è¶…å¼ºå…‰'); // strongLightState å¯¹åº”çš„è¡Œä¸º this.light.setState(this.light.superStrongLightState); // åˆ‡æ¢çŠ¶æ€åˆ°offLightState &#125;; var SuperStrongLightState = function(light) &#123; this.light = light; &#125;; SuperStrongLightState.prototype.buttonWasPressed = function() &#123; console.log('å…³ç¯'); this.light.setState(this.light.offLightState); &#125;; var Light = function() &#123; console.log(this); this.offLightState = new OffLightState(this); this.weakLightState = new WeakLightState(this); this.strongLightState = new StrongLightState(this); this.superStrongLightState = new SuperStrongLightState(this); // æ–°å¢superStrongLightState å¯¹è±¡ this.button = null; &#125;; Light.prototype.init = function() &#123; var button = document.createElement("button"), self = this; this.button = document.body.appendChild(button); this.button.innerHTML = "å¼€å…³"; this.currState = this.offLightState; // è®¾ç½®å½“å‰çŠ¶æ€ this.button.onclick = function() &#123; self.currState.buttonWasPressed(); &#125;; &#125;; Light.prototype.setState = function(newState) &#123; this.currState = newState; &#125;; var light = new Light(); light.init(); // æ·»åŠ æ–°çŠ¶æ€æ—¶ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; çŠ¶æ€æ¨¡å¼çš„é€šç”¨ç»“æ„12345678910111213141516171819202122232425262728293031323334353637383940&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // é¦–å…ˆå®šä¹‰äº†Light ç±»ï¼ŒLightç±»åœ¨è¿™é‡Œä¹Ÿè¢«ç§°ä¸ºä¸Šä¸‹æ–‡ï¼ˆContextï¼‰ã€‚éšååœ¨Light çš„æ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬è¦åˆ›å»ºæ¯ä¸€ä¸ªçŠ¶æ€ç±»çš„å®ä¾‹å¯¹è±¡ï¼ŒContextå°†æŒæœ‰è¿™äº›çŠ¶æ€å¯¹è±¡çš„å¼•ç”¨ï¼Œä»¥ä¾¿æŠŠè¯·æ±‚å§”æ‰˜ç»™çŠ¶æ€å¯¹è±¡ã€‚ç”¨æˆ·çš„è¯·æ±‚ï¼Œå³ç‚¹å‡»buttonçš„åŠ¨ä½œä¹Ÿæ˜¯å®ç°åœ¨Contextä¸­çš„ var Light = function() &#123; this.offLightState = new OffLightState(this); // æŒæœ‰çŠ¶æ€å¯¹è±¡çš„å¼•ç”¨ this.weakLightState = new WeakLightState(this); this.strongLightState = new StrongLightState(this); this.superStrongLightState = new SuperStrongLightState(this); this.button = null; &#125;; Light.prototype.init = function() &#123; var button = document.createElement('button'), self = this; this.button = document.body.appendChild(button); this.button.innerHTML = 'å¼€å…³'; this.currState = this.offLightState; // è®¾ç½®é»˜è®¤åˆå§‹çŠ¶æ€ this.button.onclick = function() &#123; // å®šä¹‰ç”¨æˆ·çš„è¯·æ±‚åŠ¨ä½œ self.currState.buttonWasPressed(); &#125; &#125;; // æ¥ä¸‹æ¥å¯èƒ½æ˜¯ä¸ªè‹¦åŠ›æ´»ï¼Œæˆ‘ä»¬è¦ç¼–å†™å„ç§çŠ¶æ€ç±»ï¼Œlightå¯¹è±¡è¢«ä¼ å…¥çŠ¶æ€ç±»çš„æ„é€ å‡½æ•°ï¼ŒçŠ¶æ€å¯¹è±¡ä¹Ÿéœ€è¦æŒæœ‰lightå¯¹è±¡çš„å¼•ç”¨ï¼Œä»¥ä¾¿è°ƒç”¨light ä¸­çš„æ–¹æ³•æˆ–è€…ç›´æ¥æ“ä½œlight å¯¹è±¡ var OffLightState = function(light) &#123; this.light = light; &#125;; OffLightState.prototype.buttonWasPressed = function() &#123; console.log('å¼±å…‰'); this.light.setState(this.light.weakLightState); &#125;; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; çŠ¶æ€æ¨¡å¼å®ç°æ–‡ä»¶ä¸Šä¼ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script type="text/javascript"&gt; //æ–‡ä»¶åœ¨æ‰«æçŠ¶æ€ä¸­ï¼Œæ˜¯ä¸èƒ½è¿›è¡Œä»»ä½•æ“ä½œçš„ï¼Œæ—¢ä¸èƒ½æš‚åœä¹Ÿä¸èƒ½åˆ é™¤æ–‡ä»¶ï¼Œåªèƒ½ç­‰å¾…æ‰«æå®Œæˆã€‚æ‰«æå®Œæˆä¹‹åï¼Œæ ¹æ®æ–‡ä»¶çš„md5 å€¼åˆ¤æ–­ï¼Œè‹¥ç¡®è®¤è¯¥æ–‡ä»¶å·²ç»å­˜åœ¨äºæœåŠ¡å™¨ï¼Œç›´æ¥è·³åˆ°ä¸Šä¼ å®ŒæˆçŠ¶æ€ã€‚å¦‚æœè¯¥æ–‡ä»¶çš„å¤§å°è¶…è¿‡å…è®¸ä¸Šä¼ çš„æœ€å¤§å€¼ï¼Œæˆ–è€…è¯¥æ–‡ä»¶å·²ç»æŸåï¼Œåˆ™è·³å¾€ä¸Šä¼ å¤±è´¥çŠ¶æ€ã€‚å‰©ä¸‹çš„æƒ…å†µä¸‹æ‰è¿›å…¥ä¸Šä¼ ä¸­çŠ¶æ€ã€‚ // ä¸Šä¼ è¿‡ç¨‹ä¸­å¯ä»¥ç‚¹å‡»æš‚åœæŒ‰é’®æ¥æš‚åœä¸Šä¼ ï¼Œæš‚åœåç‚¹å‡»åŒä¸€ä¸ªæŒ‰é’®ä¼šç»§ç»­ä¸Šä¼ ã€‚ // æ‰«æå’Œä¸Šä¼ è¿‡ç¨‹ä¸­ï¼Œç‚¹å‡»åˆ é™¤æŒ‰é’®æ— æ•ˆï¼Œåªæœ‰åœ¨æš‚åœã€ä¸Šä¼ å®Œæˆã€ä¸Šä¼ å¤±è´¥ä¹‹åï¼Œæ‰èƒ½ åˆ é™¤æ–‡ä»¶ã€‚ // æ­£å¸¸å®ç° window.external.upload = function(state) &#123; console.log(state); // å¯èƒ½ä¸ºsignã€uploadingã€doneã€error &#125;; var plugin = (function() &#123; var plugin = document.createElement('embed'); plugin.style.display = 'none'; plugin.type = 'application/txftn-webkit'; plugin.sign = function() &#123; console.log('å¼€å§‹æ–‡ä»¶æ‰«æ'); &#125; plugin.pause = function() &#123; console.log('æš‚åœæ–‡ä»¶ä¸Šä¼ '); &#125;; plugin.uploading = function() &#123; console.log('å¼€å§‹æ–‡ä»¶ä¸Šä¼ '); &#125;; plugin.del = function() &#123; console.log('åˆ é™¤æ–‡ä»¶ä¸Šä¼ '); &#125; plugin.done = function() &#123; console.log('æ–‡ä»¶ä¸Šä¼ å®Œæˆ'); &#125; document.body.appendChild(plugin); return plugin; &#125;)(); var Upload = function(fileName) &#123; this.plugin = plugin; this.fileName = fileName; this.button1 = null; this.button2 = null; this.state = 'sign'; // è®¾ç½®åˆå§‹çŠ¶æ€ä¸ºwaiting &#125;; Upload.prototype.init = function() &#123; var that = this; this.dom = document.createElement('div'); this.dom.innerHTML = '&lt;span&gt;æ–‡ä»¶åç§°:' + this.fileName + '&lt;/span&gt;\&lt;button data-action="button1"&gt;æ‰«æä¸­&lt;/button&gt;\&lt;button data-action="button2"&gt;åˆ é™¤&lt;/button&gt;'; document.body.appendChild(this.dom); this.button1 = this.dom.querySelector('[data-action="button1"]'); // ç¬¬ä¸€ä¸ªæŒ‰é’® this.button2 = this.dom.querySelector('[data-action="button2"]'); // ç¬¬äºŒä¸ªæŒ‰é’® this.bindEvent(); &#125;; Upload.prototype.bindEvent = function() &#123; var self = this; this.button1.onclick = function() &#123; if (self.state === 'sign') &#123; // æ‰«æçŠ¶æ€ä¸‹ï¼Œä»»ä½•æ“ä½œæ— æ•ˆ console.log('æ‰«æä¸­ï¼Œç‚¹å‡»æ— æ•ˆ...'); &#125; else if (self.state === 'uploading') &#123; // ä¸Šä¼ ä¸­ï¼Œç‚¹å‡»åˆ‡æ¢åˆ°æš‚åœ self.changeState('pause'); &#125; else if (self.state === 'pause') &#123; // æš‚åœä¸­ï¼Œç‚¹å‡»åˆ‡æ¢åˆ°ä¸Šä¼ ä¸­ self.changeState('uploading'); &#125; else if (self.state === 'done') &#123; console.log('æ–‡ä»¶å·²å®Œæˆä¸Šä¼ , ç‚¹å‡»æ— æ•ˆ'); &#125; else if (self.state === 'error') &#123; console.log('æ–‡ä»¶ä¸Šä¼ å¤±è´¥, ç‚¹å‡»æ— æ•ˆ'); &#125; &#125;; this.button2.onclick = function() &#123; if (self.state === 'done' || self.state === 'error' || self.state === 'pause') &#123; // ä¸Šä¼ å®Œæˆã€ä¸Šä¼ å¤±è´¥å’Œæš‚åœçŠ¶æ€ä¸‹å¯ä»¥åˆ é™¤ self.changeState('del'); &#125; else if (self.state === 'sign') &#123; console.log('æ–‡ä»¶æ­£åœ¨æ‰«æä¸­ï¼Œä¸èƒ½åˆ é™¤'); &#125; else if (self.state === 'uploading') &#123; console.log('æ–‡ä»¶æ­£åœ¨ä¸Šä¼ ä¸­ï¼Œä¸èƒ½åˆ é™¤'); &#125; &#125;; &#125;; Upload.prototype.changeState = function(state) &#123; switch (state) &#123; case 'sign': this.plugin.sign(); this.button1.innerHTML = 'æ‰«æä¸­ï¼Œä»»ä½•æ“ä½œæ— æ•ˆ'; break; case 'uploading': this.plugin.uploading(); this.button1.innerHTML = 'æ­£åœ¨ä¸Šä¼ ï¼Œç‚¹å‡»æš‚åœ'; break; case 'pause': this.plugin.pause(); this.button1.innerHTML = 'å·²æš‚åœï¼Œç‚¹å‡»ç»§ç»­ä¸Šä¼ '; break; case 'done': this.plugin.done(); this.button1.innerHTML = 'ä¸Šä¼ å®Œæˆ'; break; case 'error': this.button1.innerHTML = 'ä¸Šä¼ å¤±è´¥'; break; case 'del': this.plugin.del(); this.dom.parentNode.removeChild(this.dom); console.log('åˆ é™¤å®Œæˆ'); break; &#125;; this.state = state; &#125;; var uploadObj = new Upload('JavaScript è®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ'); uploadObj.init(); window.external.upload = function(state) &#123; // æ’ä»¶è°ƒç”¨JavaScript çš„æ–¹æ³• uploadObj.changeState(state); &#125;; window.external.upload('sign'); // æ–‡ä»¶å¼€å§‹æ‰«æ setTimeout(function() &#123; window.external.upload('uploading'); // 1 ç§’åå¼€å§‹ä¸Šä¼  &#125;, 1000); setTimeout(function() &#123; window.external.upload('done'); // 5 ç§’åä¸Šä¼ å®Œæˆ &#125;, 5000); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; çŠ¶æ€æ¨¡å¼é‡æ„æ–‡ä»¶ä¸Šä¼ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; window.external.upload = function(state) &#123; console.log(state); // å¯èƒ½ä¸ºsignã€uploadingã€doneã€error &#125;; var plugin = (function() &#123; var plugin = document.createElement('embed'); plugin.style.display = 'none'; plugin.type = 'application/txftn-webkit'; plugin.sign = function() &#123; console.log('å¼€å§‹æ–‡ä»¶æ‰«æ'); &#125; plugin.pause = function() &#123; console.log('æš‚åœæ–‡ä»¶ä¸Šä¼ '); &#125;; plugin.uploading = function() &#123; console.log('å¼€å§‹æ–‡ä»¶ä¸Šä¼ '); &#125;; plugin.del = function() &#123; console.log('åˆ é™¤æ–‡ä»¶ä¸Šä¼ '); &#125; plugin.done = function() &#123; console.log('æ–‡ä»¶ä¸Šä¼ å®Œæˆ'); &#125; document.body.appendChild(plugin); return plugin; &#125;)(); var Upload = function(fileName) &#123; this.plugin = plugin; this.fileName = fileName; this.button1 = null; this.button2 = null; this.signState = new SignState(this); // è®¾ç½®åˆå§‹çŠ¶æ€ä¸ºwaiting this.uploadingState = new UploadingState(this); this.pauseState = new PauseState(this); this.doneState = new DoneState(this); this.errorState = new ErrorState(this); this.currState = this.signState; // è®¾ç½®å½“å‰çŠ¶æ€ &#125;; Upload.prototype.init = function() &#123; var that = this; this.dom = document.createElement('div'); this.dom.innerHTML = '&lt;span&gt;æ–‡ä»¶åç§°:' + this.fileName + '&lt;/span&gt;\&lt;button data-action="button1"&gt;æ‰«æä¸­&lt;/button&gt;\&lt;button data-action="button2"&gt;åˆ é™¤&lt;/button&gt;'; document.body.appendChild(this.dom); this.button1 = this.dom.querySelector('[data-action="button1"]'); this.button2 = this.dom.querySelector('[data-action="button2"]'); this.bindEvent(); &#125;; Upload.prototype.bindEvent = function() &#123; var self = this; this.button1.onclick = function() &#123; self.currState.clickHandler1(); &#125; this.button2.onclick = function() &#123; self.currState.clickHandler2(); &#125; &#125;; Upload.prototype.sign = function() &#123; this.plugin.sign(); this.currState = this.signState; &#125;; Upload.prototype.uploading = function() &#123; this.button1.innerHTML = 'æ­£åœ¨ä¸Šä¼ ï¼Œç‚¹å‡»æš‚åœ'; this.plugin.uploading(); this.currState = this.uploadingState; &#125;; Upload.prototype.pause = function() &#123; this.button1.innerHTML = 'å·²æš‚åœï¼Œç‚¹å‡»ç»§ç»­ä¸Šä¼ '; this.plugin.pause(); this.currState = this.pauseState; &#125;; Upload.prototype.done = function() &#123; this.button1.innerHTML = 'ä¸Šä¼ å®Œæˆ'; this.plugin.done(); this.currState = this.doneState; &#125;; Upload.prototype.error = function() &#123; this.button1.innerHTML = 'ä¸Šä¼ å¤±è´¥'; this.currState = this.errorState; &#125;; Upload.prototype.del = function() &#123; this.plugin.del(); this.dom.parentNode.removeChild(this.dom); &#125;; var StateFactory = (function() &#123; var State = function() &#123;&#125;; State.prototype.clickHandler1 = function() &#123; throw new Error('å­ç±»å¿…é¡»é‡å†™çˆ¶ç±»çš„clickHandler1 æ–¹æ³•'); &#125; State.prototype.clickHandler2 = function() &#123; throw new Error('å­ç±»å¿…é¡»é‡å†™çˆ¶ç±»çš„clickHandler2 æ–¹æ³•'); &#125; return function(param) &#123; var F = function(uploadObj) &#123; this.uploadObj = uploadObj; &#125;; F.prototype = new State(); for (var i in param) &#123; F.prototype[i] = param[i]; &#125; return F; &#125; &#125;)(); var SignState = StateFactory(&#123; clickHandler1: function() &#123; console.log('æ‰«æä¸­ï¼Œç‚¹å‡»æ— æ•ˆ...'); &#125;, clickHandler2: function() &#123; console.log('æ–‡ä»¶æ­£åœ¨ä¸Šä¼ ä¸­ï¼Œä¸èƒ½åˆ é™¤'); &#125; &#125;); var UploadingState = StateFactory(&#123; clickHandler1: function() &#123; this.uploadObj.pause(); &#125;, clickHandler2: function() &#123; console.log('æ–‡ä»¶æ­£åœ¨ä¸Šä¼ ä¸­ï¼Œä¸èƒ½åˆ é™¤'); &#125; &#125;); var PauseState = StateFactory(&#123; clickHandler1: function() &#123; this.uploadObj.uploading(); &#125;, clickHandler2: function() &#123; this.uploadObj.del(); &#125; &#125;); var DoneState = StateFactory(&#123; clickHandler1: function() &#123; console.log('æ–‡ä»¶å·²å®Œæˆä¸Šä¼ , ç‚¹å‡»æ— æ•ˆ'); &#125;, clickHandler2: function() &#123; this.uploadObj.del(); &#125; &#125;); var ErrorState = StateFactory(&#123; clickHandler1: function() &#123; console.log('æ–‡ä»¶ä¸Šä¼ å¤±è´¥, ç‚¹å‡»æ— æ•ˆ'); &#125;, clickHandler2: function() &#123; this.uploadObj.del(); &#125; &#125;); var uploadObj = new Upload('JavaScript è®¾è®¡æ¨¡å¼ä¸å¼€å‘å®è·µ'); uploadObj.init(); window.external.upload = function(state) &#123; uploadObj[state](); &#125;; window.external.upload('sign'); setTimeout(function() &#123; window.external.upload('uploading'); // 1 ç§’åå¼€å§‹ä¸Šä¼  &#125;, 1000); setTimeout(function() &#123; window.external.upload('done'); // 5 ç§’åä¸Šä¼ å®Œæˆ &#125;, 5000); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; çŠ¶æ€æ¨¡å¼æ³¨æ„äº‹é¡¹1234567891011121314151617181920212223242526272829303132&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // çŠ¶æ€æ¨¡å¼çš„ä¼˜ç¼ºç‚¹ // çŠ¶æ€æ¨¡å¼å®šä¹‰äº†çŠ¶æ€ä¸è¡Œä¸ºä¹‹é—´çš„å…³ç³»ï¼Œå¹¶å°†å®ƒä»¬å°è£…åœ¨ä¸€ä¸ªç±»é‡Œã€‚é€šè¿‡å¢åŠ æ–°çš„çŠ¶æ€ç±»ï¼Œå¾ˆå®¹æ˜“å¢åŠ æ–°çš„çŠ¶æ€å’Œè½¬æ¢ã€‚ // é¿å…Context æ— é™è†¨èƒ€ï¼ŒçŠ¶æ€åˆ‡æ¢çš„é€»è¾‘è¢«åˆ†å¸ƒåœ¨çŠ¶æ€ç±»ä¸­ï¼Œä¹Ÿå»æ‰äº†Context ä¸­åŸæœ¬è¿‡å¤šçš„æ¡ä»¶åˆ†æ”¯ã€‚ // ç”¨å¯¹è±¡ä»£æ›¿å­—ç¬¦ä¸²æ¥è®°å½•å½“å‰çŠ¶æ€ï¼Œä½¿å¾—çŠ¶æ€çš„åˆ‡æ¢æ›´åŠ ä¸€ç›®äº†ç„¶ã€‚ // Context ä¸­çš„è¯·æ±‚åŠ¨ä½œå’ŒçŠ¶æ€ç±»ä¸­å°è£…çš„è¡Œä¸ºå¯ä»¥éå¸¸å®¹æ˜“åœ°ç‹¬ç«‹å˜åŒ–è€Œäº’ä¸å½±å“ã€‚ // ç¼ºç‚¹ // çŠ¶æ€æ¨¡å¼çš„ç¼ºç‚¹æ˜¯ä¼šåœ¨ç³»ç»Ÿä¸­å®šä¹‰è®¸å¤šçŠ¶æ€ç±»ï¼Œç¼–å†™20 ä¸ªçŠ¶æ€ç±»æ˜¯ä¸€é¡¹æ¯ç‡¥ä¹å‘³çš„å·¥ä½œï¼Œè€Œä¸”ç³»ç»Ÿä¸­ä¼šå› æ­¤è€Œå¢åŠ ä¸å°‘å¯¹è±¡ã€‚å¦å¤–ï¼Œç”±äºé€»è¾‘åˆ†æ•£åœ¨çŠ¶æ€ç±»ä¸­ï¼Œè™½ç„¶é¿å¼€äº†ä¸å—æ¬¢è¿çš„æ¡ä»¶åˆ†æ”¯è¯­å¥ï¼Œä½†ä¹Ÿé€ æˆäº†é€»è¾‘åˆ†æ•£çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ— æ³•åœ¨ä¸€ä¸ªåœ°æ–¹å°±çœ‹å‡ºæ•´ä¸ªçŠ¶æ€æœºçš„é€»è¾‘ã€‚ // çŠ¶æ€æ¨¡å¼çš„æ€§èƒ½ä¼˜åŒ–ç‚¹ // æœ‰ä¸¤ç§é€‰æ‹©æ¥ç®¡ç†state å¯¹è±¡çš„åˆ›å»ºå’Œé”€æ¯ã€‚ç¬¬ä¸€ç§æ˜¯ä»…å½“state å¯¹è±¡è¢«éœ€è¦æ—¶æ‰åˆ›å»ºå¹¶éšåé”€æ¯ï¼Œå¦ä¸€ç§æ˜¯ä¸€å¼€å§‹å°±åˆ›å»ºå¥½æ‰€æœ‰çš„çŠ¶æ€å¯¹è±¡ï¼Œå¹¶ä¸”å§‹ç»ˆä¸é”€æ¯å®ƒä»¬ã€‚å¦‚æœstateå¯¹è±¡æ¯”è¾ƒåºå¤§ï¼Œå¯ä»¥ç”¨ç¬¬ä¸€ç§æ–¹å¼æ¥èŠ‚çœå†…å­˜ï¼Œè¿™æ ·å¯ä»¥é¿å…åˆ›å»ºä¸€äº›ä¸ä¼šç”¨åˆ°çš„å¯¹è±¡å¹¶åŠæ—¶åœ°å›æ”¶å®ƒä»¬ã€‚ä½†å¦‚æœçŠ¶æ€çš„æ”¹å˜å¾ˆé¢‘ç¹ï¼Œæœ€å¥½ä¸€å¼€å§‹å°±æŠŠè¿™äº›state å¯¹è±¡éƒ½åˆ›å»ºå‡ºæ¥ï¼Œä¹Ÿæ²¡æœ‰å¿…è¦é”€æ¯å®ƒä»¬ï¼Œå› ä¸ºå¯èƒ½å¾ˆå¿«å°†å†æ¬¡ç”¨åˆ°å®ƒä»¬ã€‚ // åœ¨æœ¬ç« çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªContext å¯¹è±¡éƒ½åˆ›å»ºäº†ä¸€ç»„state å¯¹è±¡ï¼Œå®é™…ä¸Šè¿™äº›stateå¯¹è±¡ä¹‹é—´æ˜¯å¯ä»¥å…±äº«çš„ï¼Œå„Context å¯¹è±¡å¯ä»¥å…±äº«ä¸€ä¸ªstate å¯¹è±¡ï¼Œè¿™ä¹Ÿæ˜¯äº«å…ƒæ¨¡å¼çš„åº”ç”¨åœºæ™¯ä¹‹ä¸€ã€‚ // çŠ¶æ€æ¨¡å¼å’Œç­–ç•¥æ¨¡å¼çš„å…³ç³» // ç›¸åŒç‚¹ // ç­–ç•¥æ¨¡å¼å’ŒçŠ¶æ€æ¨¡å¼çš„ç›¸åŒç‚¹æ˜¯ï¼Œå®ƒä»¬éƒ½æœ‰ä¸€ä¸ªä¸Šä¸‹æ–‡ã€ä¸€äº›ç­–ç•¥æˆ–è€…çŠ¶æ€ç±»ï¼Œä¸Šä¸‹æ–‡æŠŠè¯·æ±‚å§”æ‰˜ç»™è¿™äº›ç±»æ¥æ‰§è¡Œã€‚ // ä¸åŒç‚¹ // ç­–ç•¥æ¨¡å¼ä¸­çš„å„ä¸ªç­–ç•¥ç±»ä¹‹é—´æ˜¯å¹³ç­‰åˆå¹³è¡Œçš„ï¼Œå®ƒä»¬ä¹‹é—´æ²¡æœ‰ä»»ä½•è”ç³»ï¼Œæ‰€ä»¥å®¢æˆ·å¿…é¡»ç†ŸçŸ¥è¿™äº›ç­–ç•¥ç±»çš„ä½œç”¨ï¼Œä»¥ä¾¿å®¢æˆ·å¯ä»¥éšæ—¶ä¸»åŠ¨åˆ‡æ¢ç®—æ³•ï¼›è€Œåœ¨çŠ¶æ€æ¨¡å¼ä¸­ï¼ŒçŠ¶æ€å’ŒçŠ¶æ€å¯¹åº”çš„è¡Œä¸ºæ˜¯æ—©å·²è¢«å°è£…å¥½çš„ï¼ŒçŠ¶æ€ä¹‹é—´çš„åˆ‡æ¢ä¹Ÿæ—©è¢«è§„å®šå®Œæˆï¼Œâ€œæ”¹å˜è¡Œä¸ºâ€è¿™ä»¶äº‹æƒ…å‘ç”Ÿåœ¨çŠ¶æ€æ¨¡å¼å†…éƒ¨ã€‚å¯¹å®¢æˆ·æ¥è¯´ï¼Œå¹¶ä¸éœ€è¦äº†è§£è¿™äº›ç»†èŠ‚ã€‚è¿™æ­£æ˜¯çŠ¶æ€æ¨¡å¼çš„ä½œç”¨æ‰€åœ¨ã€‚ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; jsç‰ˆæœ¬çš„çŠ¶æ€æœº123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // çŠ¶æ€æ¨¡å¼æ˜¯çŠ¶æ€æœºçš„å®ç°ä¹‹ä¸€ï¼Œä½†åœ¨JavaScript è¿™ç§â€œæ— ç±»â€è¯­è¨€ä¸­ï¼Œæ²¡æœ‰è§„å®šè®©çŠ¶æ€å¯¹è±¡ä¸€å®šè¦ä»ç±»ä¸­åˆ›å»ºè€Œæ¥ã€‚å¦å¤–ä¸€ç‚¹ï¼ŒJavaScript å¯ä»¥éå¸¸æ–¹ä¾¿åœ°ä½¿ç”¨å§”æ‰˜æŠ€æœ¯ï¼Œå¹¶ä¸éœ€è¦äº‹å…ˆè®©ä¸€ä¸ªå¯¹è±¡æŒæœ‰å¦ä¸€ä¸ªå¯¹è±¡ã€‚ä¸‹é¢çš„çŠ¶æ€æœºé€‰æ‹©äº†é€šè¿‡Function.prototype.call æ–¹æ³•ç›´æ¥æŠŠè¯·æ±‚å§”æ‰˜ç»™æŸä¸ªå­—é¢é‡å¯¹è±¡æ¥æ‰§è¡Œã€‚ // æ”¹å†™ç¯æ³¡ var Light = function() &#123; this.currState = FSM.off; // è®¾ç½®å½“å‰çŠ¶æ€ this.button = null; &#125;; Light.prototype.init = function() &#123; var button = document.createElement("button"), self = this; button.innerHTML = "å·²å…³ç¯"; this.button = document.body.appendChild(button); this.button.onclick = function() &#123; self.currState.buttonWasPressed.call(self); // æŠŠè¯·æ±‚å§”æ‰˜ç»™FSMçŠ¶æ€æœº &#125;; &#125;; var FSM = &#123; off: &#123; buttonWasPressed: function() &#123; console.log('å…³ç¯'); this.button.innerHTML = 'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘æ˜¯å¼€ç¯'; this.currState = FSM.on; &#125; &#125;, on: &#123; buttonWasPressed: function() &#123; console.log('å¼€ç¯'); this.button.innerHTML = 'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘æ˜¯å…³ç¯'; this.currState = FSM.off; &#125; &#125; &#125;; var light = new Light(); light.init(); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ä½¿ç”¨delegateå‡½æ•°å®ç°çŠ¶æ€æœº123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; var delegate = function(client, delegation) &#123; return &#123; buttonWasPressed: function() &#123; // å°†å®¢æˆ·çš„æ“ä½œå§”æ‰˜ç»™delegation å¯¹è±¡ return delegation.buttonWasPressed.apply(client, arguments); &#125; &#125; &#125;; var FSM = &#123; off: &#123; buttonWasPressed: function() &#123; console.log('å…³ç¯'); this.button.innerHTML = 'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘æ˜¯å¼€ç¯'; this.currState = this.onState; &#125; &#125;, on: &#123; buttonWasPressed: function() &#123; console.log('å¼€ç¯'); this.button.innerHTML = 'ä¸‹ä¸€æ¬¡æŒ‰æˆ‘æ˜¯å…³ç¯'; this.currState = this.offState; &#125; &#125; &#125;; var Light = function() &#123; this.offState = delegate(this, FSM.off); this.onState = delegate(this, FSM.on); this.currState = this.offState; // è®¾ç½®åˆå§‹çŠ¶æ€ä¸ºå…³é—­çŠ¶æ€ this.button = null; &#125;; Light.prototype.init = function() &#123; var button = document.createElement('button'), self = this; button.innerHTML = 'å·²å…³ç¯'; this.button = document.body.appendChild(button); this.button.onclick = function() &#123; self.currState.buttonWasPressed(); &#125; &#125;; var light = new Light(); light.init(); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; è¡¨é©±åŠ¨çš„æœ‰é™çŠ¶æ€æœº1234567891011121314151617181920212223242526272829303132333435363738&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // å‚è€ƒ:https://github.com/jakesgordon/javascript-state-machine var fsm = StateMachine.create(&#123; initial: 'off', events: [&#123; name: 'buttonWasPressed', from: 'off', to: 'on' &#125;, &#123; name: 'buttonWasPressed', from: 'on', to: 'off' &#125;], callbacks: &#123; onbuttonWasPressed: function(event, from, to) &#123; console.log(arguments); &#125; &#125;, error: function(eventName, from, to, args, errorCode, errorMessage) &#123; console.log(arguments); // ä»ä¸€ç§çŠ¶æ€è¯•å›¾åˆ‡æ¢åˆ°ä¸€ç§ä¸å¯èƒ½åˆ°è¾¾çš„çŠ¶æ€çš„æ—¶å€™ &#125; &#125;); button.onclick = function() &#123; fsm.buttonWasPressed(); &#125; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; é€‚é…å™¨æ¨¡å¼åŸºæœ¬å®šä¹‰12345678910111213141516171819202122232425262728293031323334&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // é€‚é…å™¨æ¨¡å¼:é€‚é…å™¨æ¨¡å¼çš„ä½œç”¨æ˜¯è§£å†³ä¸¤ä¸ªè½¯ä»¶å®ä½“é—´çš„æ¥å£ä¸å…¼å®¹çš„é—®é¢˜,å®ƒä¸è€ƒè™‘è¿™äº›æ¥å£æ˜¯æ€æ ·å®ç°çš„ï¼Œä¹Ÿä¸è€ƒè™‘å®ƒä»¬å°†æ¥å¯èƒ½ä¼šå¦‚ä½•æ¼”åŒ–ã€‚é€‚é…å™¨æ¨¡å¼ä¸éœ€è¦æ”¹å˜å·²æœ‰çš„æ¥å£ï¼Œå°±èƒ½å¤Ÿä½¿å®ƒä»¬ååŒä½œç”¨ã€‚ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ä¹‹åï¼ŒåŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½å·¥ä½œçš„ä¸¤ä¸ªè½¯ä»¶å®ä½“å¯ä»¥ä¸€èµ·å·¥ä½œã€‚ // ä½¿ç”¨åœºæ™¯:å½“ä¸¤ä¸ªæ¥å£ä¸ä¸€æ ·æ—¶ï¼Œå¯ä»¥é‡‡ç”¨äº¡ç¾Šè¡¥ç‰¢çš„æ–¹å¼å®ç°ä¸€ä¸ªé€‚é…å™¨ï¼Œæ¥æä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ // ä½¿ç”¨ä¸¾ä¾‹:ç™¾åº¦è°·æ­Œåœ°å›¾æä¾›çš„å±•ç¤ºåœ°å›¾çš„APIä¸åŒï¼Œä¸€ä¸ªshow,ä¸€ä¸ªdisplay var googleMap = &#123; show: function() &#123; console.log('å¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾'); &#125; &#125;; var baiduMap = &#123; display: function() &#123; console.log('å¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾'); &#125; &#125;; var baiduMapAdapter = &#123; show: function() &#123; return baiduMap.display(); &#125; &#125;; renderMap(googleMap); // è¾“å‡ºï¼šå¼€å§‹æ¸²æŸ“è°·æ­Œåœ°å›¾ renderMap(baiduMapAdapter); // è¾“å‡ºï¼šå¼€å§‹æ¸²æŸ“ç™¾åº¦åœ°å›¾ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å•ä¸€èŒè´£åŸåˆ™åŸºæœ¬å®šä¹‰12345678910111213141516171819202122232425&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // å°±ä¸€ä¸ªç±»è€Œè¨€ï¼Œåº”è¯¥ä»…æœ‰ä¸€ä¸ªå¼•èµ·å®ƒå˜åŒ–çš„åŸå› ã€‚åœ¨JSä¸­ç±»ç”¨çš„å¾ˆå°‘ï¼Œå•ä¸€èŒè´£æ›´å¤šçš„æ˜¯ä½“ç°åœ¨å¯¹è±¡å’Œæ–¹æ³•ä¸Š // SRPåŸåˆ™ä½“ç°ä¸ºï¼šä¸€ä¸ªå¯¹è±¡ï¼ˆæ–¹æ³•ï¼‰åªåšä¸€ä»¶äº‹æƒ…ã€‚-&gt;èŒè´£åˆ†ç¦» // SRPåŸåˆ™åœ¨ä»£ç†æ¨¡å¼ã€è¿­ä»£å™¨æ¨¡å¼ã€å•ä¾‹æ¨¡å¼ã€è£…é¥°è€…æ¨¡å¼ä¸­éƒ½æœ‰ä½“ç° // ä½•æ—¶ç”¨èŒè´£åˆ†ç¦»: // å¦‚æœéšç€éœ€æ±‚çš„å˜åŒ–ï¼Œæœ‰2ä¸ªèŒè´£æ€»æ˜¯åŒæ—¶å˜åŒ–ï¼Œåˆ™ä¸å¿…åˆ†ç¦»ä»–ä»¬ // å¦‚æœä¸¤ä¸ªèŒè´£ä»¥åç¡®å®šä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œåˆ™ä¸ç”¨åˆ†ç¦» // SRPåŸåˆ™ä¼˜ç¼ºç‚¹ // ä¼˜ç‚¹:é™ä½äº†å•ä¸ªç±»æˆ–è€…å¯¹è±¡çš„å¤æ‚åº¦ï¼ŒæŒ‰ç…§èŒè´£æŠŠå¯¹è±¡åˆ†è§£æˆæ›´å°çš„ç²’åº¦ï¼Œè¿™æœ‰åŠ©äºä»£ç çš„å¤ç”¨ï¼Œä¹Ÿæœ‰åˆ©äºè¿›è¡Œå•å…ƒæµ‹è¯•ã€‚å½“ä¸€ä¸ªèŒè´£éœ€è¦å˜æ›´çš„æ—¶å€™ï¼Œä¸ä¼šå½±å“åˆ°å…¶ä»–çš„èŒè´£ã€‚ // ç¼ºç‚¹:ä¼šå¢åŠ ç¼–å†™ä»£ç çš„å¤æ‚åº¦ã€‚å½“æˆ‘ä»¬æŒ‰ç…§èŒè´£æŠŠå¯¹è±¡åˆ†è§£æˆæ›´å°çš„ç²’åº¦ä¹‹åï¼Œå®é™…ä¸Šä¹Ÿå¢å¤§äº†è¿™äº›å¯¹è±¡ä¹‹é—´ç›¸äº’è”ç³»çš„éš¾åº¦ã€‚ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; æœ€å°‘çŸ¥è¯†åŸåˆ™åŸºæœ¬å®šä¹‰1234567891011121314151617&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼ˆLKPï¼‰è¯´çš„æ˜¯ä¸€ä¸ªè½¯ä»¶å®ä½“åº”å½“å°½å¯èƒ½å°‘åœ°ä¸å…¶ä»–å®ä½“å‘ç”Ÿç›¸äº’ä½œç”¨ã€‚è¿™é‡Œçš„è½¯ä»¶å®ä½“æ˜¯ä¸€ä¸ªå¹¿ä¹‰çš„æ¦‚å¿µï¼Œä¸ä»…åŒ…æ‹¬å¯¹è±¡ï¼Œè¿˜åŒ…æ‹¬ç³»ç»Ÿã€ç±»ã€æ¨¡å—ã€å‡½æ•°ã€å˜é‡ç­‰ã€‚ // æœ€å°‘çŸ¥è¯†åŸåˆ™è¦æ±‚æˆ‘ä»¬åœ¨è®¾è®¡ç¨‹åºæ—¶ï¼Œåº”å½“å°½é‡å‡å°‘å¯¹è±¡ä¹‹é—´çš„äº¤äº’ã€‚å¦‚æœä¸¤ä¸ªå¯¹è±¡ä¹‹é—´ä¸å¿…å½¼æ­¤ç›´æ¥é€šä¿¡ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå¯¹è±¡å°±ä¸è¦å‘ç”Ÿç›´æ¥çš„ç›¸äº’è”ç³»ã€‚å¸¸è§çš„åšæ³•æ˜¯å¼•å…¥ä¸€ä¸ªç¬¬ä¸‰è€…å¯¹è±¡ï¼Œæ¥æ‰¿æ‹…è¿™äº›å¯¹è±¡ä¹‹é—´çš„é€šä¿¡ä½œç”¨ã€‚å¦‚æœä¸€äº›å¯¹è±¡éœ€è¦å‘å¦ä¸€äº›å¯¹è±¡å‘èµ·è¯·æ±‚ï¼Œå¯ä»¥é€šè¿‡ç¬¬ä¸‰è€…å¯¹è±¡æ¥è½¬å‘è¿™äº›è¯·æ±‚ã€‚ // ä¸­ä»‹è€…æ¨¡å¼ã€å¤–è§‚æ¨¡å¼(å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£å»å°è£…ä¸€ç»„â€œå­ç³»ç»Ÿâ€ï¼Œå¯ä»¥ç›´æ¥å®šä¹‰è°ƒç”¨é«˜å±‚æ¥å£å®Œæˆä¸€ç»„äº‹æƒ…ï¼Œä¹Ÿå¯è°ƒç”¨å­ç³»ç»Ÿä¸­çš„æŸä¸€ä¸ªæ¥å£å®ŒæˆæŸä¸€ä¸ªç‰¹å®šäº‹æƒ…)ä¸­éƒ½æœ‰ä½“ç°ã€‚ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; å¼€æ”¾å°é—­åŸåˆ™åŸºæœ¬å®šä¹‰12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // åœ¨é¢å‘å¯¹è±¡çš„ç¨‹åºè®¾è®¡ä¸­ï¼Œå¼€æ”¾-å°é—­åŸåˆ™ï¼ˆOCPï¼‰æ˜¯æœ€é‡è¦çš„ä¸€æ¡åŸåˆ™ // è½¯ä»¶å®ä½“ï¼ˆç±»ã€æ¨¡å—ã€å‡½æ•°ï¼‰ç­‰åº”è¯¥æ˜¯å¯ä»¥æ‰©å±•çš„ï¼Œä½†æ˜¯ä¸å¯ä¿®æ”¹ã€‚(è¿›è¡Œæ‰©å±•ï¼Œä½†ä¸èƒ½ä¿®æ”¹æºä»£ç -&gt;ä¿ç•™æºç åŸºç¡€ä¸Šå¢åŠ ä»£ç ) // å¼€æ”¾-å°é—­åŸåˆ™çš„æ€æƒ³ï¼šå½“éœ€è¦æ”¹å˜ä¸€ä¸ªç¨‹åºçš„åŠŸèƒ½æˆ–è€…ç»™è¿™ä¸ªç¨‹åºå¢åŠ æ–°åŠŸèƒ½çš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨å¢åŠ ä»£ç çš„æ–¹å¼ï¼Œä½†æ˜¯ä¸å…è®¸æ”¹åŠ¨ç¨‹åºçš„æºä»£ç ã€‚ // æŒ‘é€‰å‡ºæœ€å®¹æ˜“å‘ç”Ÿå˜åŒ–çš„åœ°æ–¹ï¼Œç„¶åæ„é€ æŠ½è±¡æ¥å°é—­è¿™äº›å˜åŒ–ã€‚åœ¨ä¸å¯é¿å…å‘ç”Ÿä¿®æ”¹çš„æ—¶å€™ï¼Œå°½é‡ä¿®æ”¹é‚£äº›ç›¸å¯¹å®¹æ˜“ä¿®æ”¹çš„åœ°æ–¹ã€‚ // å‘å¸ƒ-è®¢é˜…ã€æ¨¡æ¿æ–¹æ³•ã€ç­–ç•¥ã€ä»£ç†ã€èŒè´£é“¾ç­‰æ¨¡å¼éƒ½æœ‰ä½“ç° // è¿‡å¤šçš„æ¡ä»¶åˆ†æ”¯è¯­å¥æ˜¯é€ æˆç¨‹åºè¿åå¼€æ”¾-å°é—­åŸåˆ™çš„ä¸€ä¸ªå¸¸è§åŸå› ã€‚æ¯å½“éœ€è¦å¢åŠ ä¸€ä¸ªæ–°çš„ifæ—¶ï¼Œå°±å¿…é¡»ä¿®æ”¹æºä»£ç ã€‚ // å½“çœ‹åˆ°å¾ˆå¤šifæ—¶ï¼Œåº”è€ƒè™‘èƒ½å¦ä½¿ç”¨å¯¹è±¡çš„å¤šæ€æ€§æ¥é‡æ„(æ‰¾å‡ºå˜åŒ–éƒ¨åˆ†ï¼Œå°†å…¶å°è£…èµ·æ¥ï¼Œè¿™æ ·å°±å¯ä»¥å°†å˜åŒ–çš„å’Œç¨³å®šçš„éš”ç¦»å¼€æ¥) // åä¾‹ï¼Œå¾ˆå¤šifï¼Œè¿åå¼€æ”¾-å°é—­åŸåˆ™ // var makeSound = function(animal) &#123; // if (animal instanceof Duck) &#123; // console.log('å˜å˜å˜'); // &#125; else if (animal instanceof Chicken) &#123; // console.log('å’¯å’¯å’¯'); // &#125; // &#125;; // var Duck = function() &#123;&#125;; // var Chicken = function() &#123;&#125;; // makeSound(new Duck()); // è¾“å‡ºï¼šå˜å˜å˜ // makeSound(new Chicken()); // è¾“å‡ºï¼šå’¯å’¯å’¯ // åˆ©ç”¨å¤šæ€çš„æ€æƒ³ï¼Œæˆ‘ä»¬æŠŠç¨‹åºä¸­ä¸å˜çš„éƒ¨åˆ†éš”ç¦»å‡ºæ¥ï¼ˆåŠ¨ç‰©éƒ½ä¼šå«ï¼‰ï¼Œç„¶åæŠŠå¯å˜çš„éƒ¨åˆ†å°è£…èµ·æ¥ï¼ˆä¸åŒç±»å‹çš„åŠ¨ç‰©å‘å‡ºä¸åŒçš„å«å£°ï¼‰ï¼Œè¿™æ ·ä¸€æ¥ç¨‹åºå°±å…·æœ‰äº†å¯æ‰©å±•æ€§ã€‚å½“æˆ‘ä»¬æƒ³è®©ä¸€åªç‹—å‘å‡ºå«å£°æ—¶ï¼Œåªéœ€å¢åŠ ä¸€æ®µä»£ç å³å¯ï¼Œè€Œä¸ç”¨å»æ”¹åŠ¨åŸæœ‰çš„makeSound å‡½æ•° var makeSound = function(animal) &#123; animal.sound(); &#125;; var Duck = function() &#123;&#125;; Duck.prototype.sound = function() &#123; console.log('å˜å˜å˜'); &#125;; var Chicken = function() &#123;&#125;; Chicken.prototype.sound = function() &#123; console.log('å’¯å’¯å’¯'); &#125;; makeSound(new Duck()); // å˜å˜å˜ makeSound(new Chicken()); // å’¯å’¯å’¯ /********* å¢åŠ åŠ¨ç‰©ç‹—ï¼Œä¸ç”¨æ”¹åŠ¨åŸæœ‰çš„makeSound å‡½æ•° ****************/ var Dog = function() &#123;&#125;; Dog.prototype.sound = function() &#123; console.log('æ±ªæ±ªæ±ª'); &#125;; makeSound(new Dog()); // æ±ªæ±ªæ±ª // å®ç°å¼€æ”¾-å°é—­åŸåˆ™çš„å…¶ä»–æ–¹æ³•:æ”¾ç½®é’©å­è§52ã€ä½¿ç”¨å›è°ƒ(ç‰¹æ®Šé’©å­) &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; æ¥å£å’Œé¢å‘æ¥å£ç¼–ç¨‹åŸºæœ¬å®šä¹‰123456789101112131415161718&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // æ¥å£: // ç¬¬ä¸€ç§å«ä¹‰:æˆ‘ä»¬ç»å¸¸è¯´ä¸€ä¸ªåº“æˆ–è€…æ¨¡å—å¯¹å¤–æä¾›äº†æŸæŸAPI æ¥å£ã€‚é€šè¿‡ä¸»åŠ¨æš´éœ²çš„æ¥å£æ¥é€šä¿¡ï¼Œå¯ä»¥éšè—è½¯ä»¶ç³»ç»Ÿå†…éƒ¨çš„å·¥ä½œç»†èŠ‚ // ç¬¬äºŒç§å«ä¹‰:æ˜¯ä¸€äº›è¯­è¨€æä¾›çš„å…³é”®å­—ï¼Œæ¯”å¦‚Java çš„interfaceã€‚interface å…³é”®å­—å¯ä»¥äº§ç”Ÿä¸€ä¸ªå®Œå…¨æŠ½è±¡çš„ç±»ã€‚è¿™ä¸ªå®Œå…¨æŠ½è±¡çš„ç±»ç”¨æ¥è¡¨ç¤ºä¸€ç§å¥‘çº¦ï¼Œä¸“é—¨è´Ÿè´£å»ºç«‹ç±»ä¸ç±»ä¹‹é—´çš„è”ç³»ã€‚ // ç¬¬ä¸‰ç§å«ä¹‰:â€œé¢å‘æ¥å£ç¼–ç¨‹â€ä¸­çš„æ¥å£ï¼Œæ¥å£çš„å«ä¹‰åœ¨è¿™é‡Œä½“ç°å¾—æ›´ä¸ºæŠ½è±¡ã€‚-&gt;æ¥å£æ˜¯å¯¹è±¡èƒ½å“åº”çš„è¯·æ±‚çš„é›†åˆã€‚ &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; ä»£ç é‡æ„æŠ€å·§åŸºæœ¬å®šä¹‰123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;script&gt; // 1.æç‚¼å‡½æ•° var getUserInfo = function() &#123; ajax('http:// xxx.com/userInfo', function(data) &#123; // æœ‰æ‰“å°æ•°æ®çš„æ“ä½œï¼Œå¯æç‚¼å‡ºæ¥ console.log('userId: ' + data.userId); console.log('userName: ' + data.userName); console.log('nickName: ' + data.nickName); &#125;); &#125;; // æ”¹è¿› var getUserInfo = function() &#123; ajax('http:// xxx.com/userInfo', function(data) &#123; printDetails(data); &#125;); &#125;; var printDetails = function(data) &#123; console.log('userId: ' + data.userId); console.log('userName: ' + data.userName); console.log('nickName: ' + data.nickName); &#125;; // 2.åˆå¹¶é‡å¤çš„æ¡ä»¶ç‰‡æ®µ var paging = function(currPage) &#123; // æ¯ä¸ªåˆ†æ”¯é‡Œé¢éƒ½æœ‰jump if (currPage &lt;= 0) &#123; currPage = 0; jump(currPage); // è·³è½¬ &#125; else if (currPage &gt;= totalPage) &#123; currPage = totalPage; jump(currPage); // è·³è½¬ &#125; else &#123; jump(currPage); // è·³è½¬ &#125; &#125;; // æ”¹è¿› var paging = function(currPage) &#123; if (currPage &lt;= 0) &#123; currPage = 0; &#125; else if (currPage &gt;= totalPage) &#123; currPage = totalPage; &#125; jump(currPage); // æŠŠjump å‡½æ•°ç‹¬ç«‹å‡ºæ¥ &#125;; function jump(page) &#123; xxxxx &#125; // 3.æŠŠæ¡ä»¶åˆ†æ”¯è¯­å¥æç‚¼æˆå‡½æ•° var getPrice = function(price) &#123; var date = new Date(); if (date.getMonth() &gt;= 6 &amp;&amp; date.getMonth() &lt;= 9) &#123; // å¯å°†åˆ¤æ–­å¤å¤©æå–å‡ºæ¥ï¼Œå•ç‹¬ä½¿ç”¨ return price * 0.8; &#125; return price; &#125;; // æ”¹è¿› var isSummer = function() &#123; var date = new Date(); return date.getMonth() &gt;= 6 &amp;&amp; date.getMonth() &lt;= 9; &#125;; var getPrice = function(price) &#123; if (isSummer()) &#123; // å¤å¤© return price * 0.8; &#125; return price; &#125;; // 4.åˆç†ä½¿ç”¨å¾ªç¯ var createXHR = function() &#123; var xhr; try &#123; xhr = new ActiveXObject('MSXML2.XMLHttp.6.0'); &#125; catch (e) &#123; try &#123; xhr = new ActiveXObject('MSXML2.XMLHttp.3.0'); &#125; catch (e) &#123; xhr = new ActiveXObject('MSXML2.XMLHttp'); &#125; &#125; return xhr; &#125;; var xhr = createXHR(); // å¯ç”¨å¾ªç¯ä¸€æ¬¡ç”Ÿæˆ var createXHR = function() &#123; var versions = ['MSXML2.XMLHttp.6.0ddd', 'MSXML2.XMLHttp.3.0', 'MSXML2.XMLHttp']; for (var i = 0, version; version = versions[i++];) &#123; try &#123; return new ActiveXObject(version); &#125; catch (e) &#123;&#125; &#125; &#125;; var xhr = createXHR(); // 5.æå‰è®©å‡½æ•°é€€å‡ºä»£æ›¿åµŒå¥—æ¡ä»¶åˆ†æ”¯ var del = function(obj) &#123; var ret; if (!obj.isReadOnly) &#123; // ä¸ä¸ºåªè¯»çš„æ‰èƒ½è¢«åˆ é™¤ if (obj.isFolder) &#123; // å¦‚æœæ˜¯æ–‡ä»¶å¤¹ ret = deleteFolder(obj); &#125; else if (obj.isFile) &#123; // å¦‚æœæ˜¯æ–‡ä»¶ ret = deleteFile(obj); &#125; &#125; return ret; &#125;; // æ”¹è¿› var del = function(obj) &#123; if (obj.isReadOnly) &#123; // åè½¬if è¡¨è¾¾å¼ return; &#125; if (obj.isFolder) &#123; return deleteFolder(obj); &#125; if (obj.isFile) &#123; return deleteFile(obj); &#125; &#125;; // 6.ä¼ é€’å¯¹è±¡å‚æ•°ä»£æ›¿è¿‡é•¿çš„å‚æ•°åˆ—è¡¨ var setUserInfo = function(id, name, address, sex, mobile, qq) &#123; console.log('id= ' + id); console.log('name= ' + name); console.log('address= ' + address); console.log('sex= ' + sex); console.log('mobile= ' + mobile); console.log('qq= ' + qq); &#125;; setUserInfo(1314, 'sven', 'shenzhen', 'male', '137********', 377876679); // æ”¹è¿› var setUserInfo = function(obj) &#123; console.log('id= ' + obj.id); console.log('name= ' + obj.name); console.log('address= ' + obj.address); console.log('sex= ' + obj.sex); console.log('mobile= ' + obj.mobile); console.log('qq= ' + obj.qq); &#125;; setUserInfo(&#123; id: 1314, name: 'sven', address: 'shenzhen', sex: 'male', mobile: '137********', qq: 377876679 &#125;); // 7.å°½é‡å‡å°‘å‚æ•°æ•°é‡ var draw = function(width, height, square) &#123;&#125;; // æ”¹è¿› var draw = function(width, height) &#123; var square = width * height; &#125;; // 8.å°‘ç”¨ä¸‰ç›®è¿ç®—ç¬¦ï¼Œä»…åœ¨ç®€å•åˆ¤æ–­æ—¶ä½¿ç”¨ï¼Œå¤æ‚æƒ…å†µä¸‹ç”¨if if (!aup || !bup) &#123; return a === doc ? -1 : b === doc ? 1 : aup ? -1 : bup ? 1 : sortInput ? (indexOf.call(sortInput, a) - indexOf.call(sortInput, b)) : 0; &#125; // 9.åˆ†è§£å¤§å‹ç±» // 10.ç”¨returné€€å‡ºå¤šé‡å¾ªç¯ var func = function() &#123; for (var i = 0; i &lt; 10; i++) &#123; for (var j = 0; j &lt; 10; j++) &#123; if (i * j &gt; 30) &#123; return; &#125; &#125; &#125; console.log(i); // è¿™å¥ä»£ç æ²¡æœ‰æœºä¼šè¢«æ‰§è¡Œ &#125;; // æ”¹è¿› var print = function(i) &#123; console.log(i); &#125;; var func = function() &#123; for (var i = 0; i &lt; 10; i++) &#123; for (var j = 0; j &lt; 10; j++) &#123; if (i * j &gt; 30) &#123; return print(i); &#125; &#125; &#125; &#125;; func(); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mini-program-bus]]></title>
    <url>%2F2018%2F03%2F15%2Fmini-program-bus%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘åœ¨åšä¸€ä¸ªå…³äºå…¬äº¤æŸ¥è¯¢çš„å°ç¨‹åºç¬¬ä¸€æ¬¡æ¥è§¦å°ç¨‹åºï¼Œæœ‰å¾ˆå¤šä¸ç†Ÿæ‚‰çš„åœ°æ–¹ï¼Œç‰¹åœ¨æ­¤åšä¸ªè®°å½• å¾®ä¿¡å°ç¨‹åº-å…¬äº¤æŸ¥è¯¢ç¬”è®°æ³¨å†Œå°ç¨‹åº å¯ä»¥å‚ç…§å®˜ç½‘çš„æ•™ç¨‹https://mp.weixin.qq.com/debug/wxadoc/introduction/index.html?t=1521093163 éœ€è¦æ³¨æ„çš„æ˜¯æ³¨å†Œé‚®ç®±å¿…é¡»æ˜¯æœªæ³¨å†Œè¿‡å…¬ä¼—å·ã€ä¸ªäººå¾®ä¿¡å·çš„é‚®ç®±æ‰è¡Œ ç›®å½•ç»“æ„ app.jsç”¨æ¥æ³¨å†Œappç¨‹åºçš„ï¼Œæœ‰å¯¹åº”çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œå¯ä»¥åœ¨å…¶ä¸­åšä¸€äº›åˆå§‹åŒ–å·¥ä½œï¼Œappä¼šåœ¨æ•´ä¸ªç¨‹åºè¿è¡Œçš„ç”Ÿå‘½å‘¨æœŸå†…å¯è®¿é—®ï¼Œæ‰€ä»¥ä¸€äº›ç®€å•çš„æ•°æ®ä¼ é€’ã€å…±äº«ï¼Œå¯ä»¥é€šè¿‡åœ¨app.jsä¸­æŒ‚è½½å…¨å±€å˜é‡çš„å½¢å¼å®Œæˆã€‚ app.jsonç”¨æ¥é…ç½®appç¨‹åº pageså­—æ®µç”¨æ¥æŒ‡å®šæ€»å…±æœ‰å“ªäº›é¡µé¢ï¼Œæœ€ä¸Šé¢çš„æ˜¯ç¨‹åºå¯åŠ¨é¡µï¼› å¾®ä¿¡å¼€å‘å·¥å…·ä¿å­˜æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ·æ–°å¹¶è¿”å›åˆ°å¯åŠ¨é¡µï¼Œæ‰€ä»¥åœ¨å¼€å‘éå¯åŠ¨é¡µé¡µé¢æ—¶ï¼Œå¯ä»¥é€šè¿‡å°†éå¯åŠ¨é¡µè°ƒæ•´åˆ°pageså­—æ®µæœ€ä¸Šé¢ï¼Œæ¥æé«˜å¼€å‘æ•ˆç‡ã€‚ windowä¸»è¦ç”¨æ¥é…ç½®appçš„ä¸€äº›æ ·å¼(navigationBaræ ·å¼)ã€å…¨å±€åŠŸèƒ½(ä¸‹æ‹‰åˆ·æ–°) networkTimeoutç”¨æ¥é…ç½®ç½‘ç»œçš„è¶…æ—¶æ—¶é—´ app.wxssç”¨æ¥é…ç½®å…¨å±€æ ·å¼ å¯ä»¥åœ¨é‡Œé¢è®¾è®¡åŸºç¡€æ ·å¼ï¼Œå¦‚å…¨å±€å­—ä½“ã€èƒŒæ™¯è‰² wxssåŸºæœ¬å’Œcssä¸€æ ·ï¼Œcssèƒ½ç”¨çš„ï¼ŒwxssåŸºæœ¬éƒ½èƒ½ç”¨ project.config.jsoné¡¹ç›®é…ç½® pagesæ–‡ä»¶å¤¹ä¸»è¦ç”¨æ¥å­˜æ”¾é¡µé¢ï¼Œé¡µé¢ç›¸å…³èµ„æºå…¨éƒ¨ä¿å­˜åœ¨ä¸€ä¸ªé¡µé¢æ–‡ä»¶ä¸­ï¼Œå¦‚å›¾ä¸­çš„index æ¯ä¸ªé¡µé¢æ–‡ä»¶å¤¹(å¦‚indexé¡µé¢)ä¸­åˆåŒ…å«é¡µé¢å¯¹åº”çš„jsã€json(éå¿…é¡»ï¼Œè‹¥è®¾ç½®äº†ä¼šè¦†ç›–app.json)ã€wxmlã€wxss(ä¼šè¦†ç›–app.wxss) utilsç”¨æ¥ä¿å­˜ä¸€äº›å·¥å…·å‡½æ•° API Promisify å°ç¨‹åºæä¾›çš„æ¥å£ï¼Œç”¨çš„éƒ½æ˜¯å›è°ƒå‡½æ•°çš„å½¢å¼ï¼Œè¿™åœ¨å¼€å‘æ—¶ä¸å¤ªå‹å¥½ã€‚ä¸è¿‡ï¼Œå°ç¨‹åºæä¾›çš„apiæ¥å£çš„å›è°ƒåä¸€è‡´ï¼Œè€Œä¸”æ”¯æŒåŸç”Ÿçš„promiseï¼Œå¯ä»¥ç”¨promiseæ¥å®šä¹‰ä¸€ä¸ªPromisifyå‡½æ•°æ¥ã€‚123456789101112131415161718// promisify.jsmodule.exports = (api) =&gt; &#123; return (options, ...params) =&gt; &#123; return new Promise((resolve, reject) =&gt; &#123; api(Object.assign(&#123;&#125;, options, &#123; success: resolve, fail: reject &#125;), ...params); &#125;); &#125;&#125;// index.jsconst Promisify = require('../../utils/promise.js'); let promisiedGetLocation = Promisify(wx.getLocation);promisiedGetLocation(&#123; type: 'gcj02'&#125;).then((res)=&gt;&#123; console.log(res);&#125;); ä¸åŒé¡µé¢é€šä¿¡ å¯ä»¥å‚è€ƒhttps://github.com/dannnney/weapp-event12345678910111213141516171819202122232425262728293031323334353637// event.jsvar events = &#123;&#125;;function on(name, self, callback) &#123; var tuple = [self, callback]; var callbacks = events[name]; if (Array.isArray(callbacks)) &#123; callbacks.push(tuple); &#125; else &#123; events[name] = [tuple]; &#125;&#125;function remove(name, self) &#123; var callbacks = events[name]; if (Array.isArray(callbacks)) &#123; events[name] = callbacks.filter((tuple) =&gt; &#123; return tuple[0] != self; &#125;) &#125;&#125;function emit(name, data) &#123; var callbacks = events[name]; if (Array.isArray(callbacks)) &#123; callbacks.map((tuple) =&gt; &#123; var self = tuple[0]; var callback = tuple[1]; callback.call(self, data); &#125;) &#125;&#125;exports.on = on;exports.remove = remove;exports.emit = emit; æ¸…é™¤inputå†…å®¹ å°ç¨‹åºæ²¡æœ‰æä¾›ä¸€ä¸ªç®€ä¾¿çš„æ–¹æ³•æ¸…é™¤inputçš„å†…å®¹ï¼Œç™¾åº¦äº†ä¸‹å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•å®ç° å°†inputçš„valueå±æ€§ç»‘å®šåˆ°ä¸€ä¸ªå˜é‡ä¸Šï¼Œå•å‡»æ—¶ç½®ç©ºå˜é‡ åœºæ™¯:å®ç°æœç´¢å»ºè®®ï¼Œæœç´¢æ¡†å¸¦æœ‰æ¸…é™¤æŒ‰é’® å°†inputçš„valueç»‘å®šåˆ°å˜é‡aä¸Šï¼Œå¹¶ç›‘å¬inputçš„oninputäº‹ä»¶ï¼Œå°†e.currentTarget.detail.valueèµ‹å€¼ç»™a,ç‚¹å‡»æ¸…é™¤æŒ‰é’®æ—¶ï¼Œç½®ç©ºaã€‚ è™½ç„¶å®Œæˆäº†æœç´¢å»ºè®®å’Œæ¸…é™¤åŠŸèƒ½ï¼Œä½†åœ¨æ‰‹æœºä¸Šï¼Œå¿«é€Ÿåˆ é™¤æ—¶ï¼Œå…‰æ ‡ä¼šå‡ºç°é—ªçƒé—®é¢˜ åæ ‡è½¬æ¢ wx.getLocation()å¯ä»¥è¿”å›wgs84åæ ‡å’Œgcj02åæ ‡ wgs84åæ ‡ä¸ºgpsåæ ‡ï¼›å›½å†…åœ°å›¾å…¬å¸ä¸€èˆ¬ä¸ä½¿ç”¨ ç¡¬ä»¶è®¾å¤‡ã€è°·æ­Œåœ°çƒã€chrome devToolä¸­çš„Sensor gcj02ä¸ºåœ¨wgs84åŸºç¡€ä¸ŠåŠ å¯†çš„åæ ‡ï¼Œåˆç§°ç«æ˜Ÿåæ ‡ç³»ï¼›å›½å†…å¤§éƒ¨åˆ†åœ°å›¾å…¬å¸ç”¨çš„æ˜¯gcj02 è…¾è®¯åœ°å›¾ã€é«˜å¾·åœ°å›¾å›½å†…ã€è°·æ­Œåœ°å›¾å›½å†… bd09ä¸ºç™¾åº¦åœ°å›¾ä½¿ç”¨çš„åæ ‡ç³»ç»Ÿï¼Œåœ¨gcj02çš„åŸºç¡€åˆåŠ å¯†äº†ä¸€å±‚ ç™¾åº¦åœ°å›¾123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120// Created by Wandergis on 2015/7/8.// æä¾›äº†ç™¾åº¦åæ ‡ï¼ˆBD09ï¼‰ã€å›½æµ‹å±€åæ ‡ï¼ˆç«æ˜Ÿåæ ‡ï¼ŒGCJ02ï¼‰ã€å’ŒWGS84åæ ‡ç³»ä¹‹é—´çš„è½¬æ¢//å®šä¹‰ä¸€äº›å¸¸é‡var x_PI = 3.14159265358979324 * 3000.0 / 180.0;var PI = 3.1415926535897932384626;var a = 6378245.0;var ee = 0.00669342162296594323;// ç™¾åº¦åæ ‡ç³» (BD-09) ä¸ ç«æ˜Ÿåæ ‡ç³» (GCJ-02)çš„è½¬æ¢// å³ ç™¾åº¦ è½¬ è°·æ­Œã€é«˜å¾·// @param bd_lon// @param bd_lat// @returns &#123;*[]&#125;//function bd09togcj02(bd_lon, bd_lat) &#123; var x_pi = 3.14159265358979324 * 3000.0 / 180.0; var x = bd_lon - 0.0065; var y = bd_lat - 0.006; var z = Math.sqrt(x * x + y * y) - 0.00002 * Math.sin(y * x_pi); var theta = Math.atan2(y, x) - 0.000003 * Math.cos(x * x_pi); var gg_lng = z * Math.cos(theta); var gg_lat = z * Math.sin(theta); return [gg_lng, gg_lat]&#125;// ç«æ˜Ÿåæ ‡ç³» (GCJ-02) ä¸ç™¾åº¦åæ ‡ç³» (BD-09) çš„è½¬æ¢// å³è°·æ­Œã€é«˜å¾· è½¬ ç™¾åº¦// @param lng// @param lat// @returns &#123;*[]&#125;function gcj02tobd09(lng, lat) &#123; var z = Math.sqrt(lng * lng + lat * lat) + 0.00002 * Math.sin(lat * x_PI); var theta = Math.atan2(lat, lng) + 0.000003 * Math.cos(lng * x_PI); var bd_lng = z * Math.cos(theta) + 0.0065; var bd_lat = z * Math.sin(theta) + 0.006; return [bd_lng, bd_lat]&#125;// WGS84è½¬GCj02// @param lng// @param lat// @returns &#123;*[]&#125;function wgs84togcj02(lng, lat) &#123; if (out_of_china(lng, lat)) &#123; return [lng, lat] &#125; else &#123; var dlat = transformlat(lng - 105.0, lat - 35.0); var dlng = transformlng(lng - 105.0, lat - 35.0); var radlat = lat / 180.0 * PI; var magic = Math.sin(radlat); magic = 1 - ee * magic * magic; var sqrtmagic = Math.sqrt(magic); dlat = (dlat * 180.0) / ((a * (1 - ee)) / (magic * sqrtmagic) * PI); dlng = (dlng * 180.0) / (a / sqrtmagic * Math.cos(radlat) * PI); var mglat = lat + dlat; var mglng = lng + dlng; return [mglng, mglat] &#125;&#125;// GCJ02 è½¬æ¢ä¸º WGS84// @param lng// @param lat// @returns &#123;*[]&#125;function gcj02towgs84(lng, lat) &#123; if (out_of_china(lng, lat)) &#123; return [lng, lat] &#125; else &#123; var dlat = transformlat(lng - 105.0, lat - 35.0); var dlng = transformlng(lng - 105.0, lat - 35.0); var radlat = lat / 180.0 * PI; var magic = Math.sin(radlat); magic = 1 - ee * magic * magic; var sqrtmagic = Math.sqrt(magic); dlat = (dlat * 180.0) / ((a * (1 - ee)) / (magic * sqrtmagic) * PI); dlng = (dlng * 180.0) / (a / sqrtmagic * Math.cos(radlat) * PI); mglat = lat + dlat; mglng = lng + dlng; return [lng * 2 - mglng, lat * 2 - mglat] &#125;&#125;function transformlat(lng, lat) &#123; var ret = -100.0 + 2.0 * lng + 3.0 * lat + 0.2 * lat * lat + 0.1 * lng * lat + 0.2 * Math.sqrt(Math.abs(lng)); ret += (20.0 * Math.sin(6.0 * lng * PI) + 20.0 * Math.sin(2.0 * lng * PI)) * 2.0 / 3.0; ret += (20.0 * Math.sin(lat * PI) + 40.0 * Math.sin(lat / 3.0 * PI)) * 2.0 / 3.0; ret += (160.0 * Math.sin(lat / 12.0 * PI) + 320 * Math.sin(lat * PI / 30.0)) * 2.0 / 3.0; return ret&#125;function transformlng(lng, lat) &#123; var ret = 300.0 + lng + 2.0 * lat + 0.1 * lng * lng + 0.1 * lng * lat + 0.1 * Math.sqrt(Math.abs(lng)); ret += (20.0 * Math.sin(6.0 * lng * PI) + 20.0 * Math.sin(2.0 * lng * PI)) * 2.0 / 3.0; ret += (20.0 * Math.sin(lng * PI) + 40.0 * Math.sin(lng / 3.0 * PI)) * 2.0 / 3.0; ret += (150.0 * Math.sin(lng / 12.0 * PI) + 300.0 * Math.sin(lng / 30.0 * PI)) * 2.0 / 3.0; return ret&#125;// åˆ¤æ–­æ˜¯å¦åœ¨å›½å†…ï¼Œä¸åœ¨å›½å†…åˆ™ä¸åšåç§»// @param lng// @param lat// @returns &#123;boolean&#125; function out_of_china(lng, lat) &#123; return (lng &lt; 72.004 || lng &gt; 137.8347) || ((lat &lt; 0.8293 || lat &gt; 55.8271) || false);&#125;module.exports=&#123; bd09togcj02: bd09togcj02, gcj02tobd09: gcj02tobd09, wgs84togcj02: wgs84togcj02, gcj02towgs84: gcj02towgs84,&#125;;]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>å°ç¨‹åº</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[postman-guide]]></title>
    <url>%2F2018%2F02%2F24%2Fpostman-guide%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘åœ¨çœ‹postmanæ–‡æ¡£(https://www.getpostman.com/docs/)è®°å½•ä¸€äº›å¸¸ç”¨æ“ä½œ postman å¸¸ç”¨æ“ä½œä»‹ç» postmanæ˜¯ä¸€ä¸ªè°ƒè¯•ã€ç®¡ç†æ¥å£çš„ç¥å™¨ã€‚ ç™»ä¸ç™»å½•éƒ½å¯ä»¥ä½¿ç”¨ï¼Œç™»å½•åå¯ä»¥åŒæ­¥æ•°æ®ã€‚ ç•Œé¢ ä¸»è¦åˆ†ä¸¤éƒ¨åˆ† å·¦ä¾§ä¸ºä¾§è¾¹æ ï¼ŒåŒ…å«å†å²è®°å½•(History)ã€é›†åˆ(Collections) å³ä¾§ä¸ºrequest builder å†å²è®°å½•Tabé¡µ ä¸»è¦è®°å½•äº†ä¹‹å‰æ“ä½œçš„ä¸€äº›requestï¼›å¯ä»¥é€šè¿‡clear allæ¥æ¸…ç©ºï¼›ä»¥åŠä¸Šé¢çš„filteræ¥ç­›é€‰ æ¯ä¸ªè¯·æ±‚å·¦ä¾§éƒ½ä¼šæ ‡è¯†å‡ºè¯·æ±‚çš„ç±»å‹(postã€getâ€¦) é›†åˆTabé¡µ ä¸»è¦ç”¨æ¥å±•ç¤ºæ‰€æœ‰çš„é¡¹ç›® ä¸€èˆ¬ä¸€ä¸ªé›†åˆå¯¹åº”ç€ä¸€ä¸ªé¡¹ç›®ï¼Œå¦‚ShangChengå°±å¯¹åº”ç€ä¸€ä¸ªé¡¹ç›®ï¼› é»„è‰²æ˜Ÿæ˜Ÿä»£è¡¨ç½®é¡¶é¡¹ç›® é¡¹ç›®å¯ä»¥æŒ‰ç…§å­—æ¯æˆ–è€…æ—¶é—´æ¥æ’åº å¯ä»¥é€šè¿‡å³é”®-&gt;editå¯¹å½“å‰collectionè¿›è¡Œè¯¦ç»†ç¼–è¾‘ï¼Œå¦‚æ·»åŠ æè¿°ã€è„šæœ¬ç­‰ request builder ä¸»è¦ç”¨æ¥æ„å»ºè¯·æ±‚ çœ‹ä¸‹å›¾ï¼Œä¸€å…±æœ‰5ä¸ªçº¢æ¡†ï¼Œä¾æ¬¡ä¸º ç¬¬ä¸€ä¸ªæ¡†å³ä¾§ä¸ºç¯å¢ƒç›¸å…³é€‰é¡¹ï¼Œä¸‹æ‹‰æ¡†å¯ä»¥é€‰æ‹©å½“å‰requestå‘é€çš„ç¯å¢ƒ(åœ¨ç¯å¢ƒä¸­ä¼šå®šä¹‰ä¸€äº›å˜é‡)ï¼Œæ¯”å¦‚å¯ä»¥ä¸ºè¯·æ±‚å®šä¹‰å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒï¼ŒäºŒè€…è¯·æ±‚çš„urlä¸åŒï¼›çœ¼ç›å›¾æ ‡ï¼Œå¯ä»¥æŸ¥çœ‹å½“å‰ç¯å¢ƒä¸‹å®šä¹‰çš„ä¸€äº›å˜é‡çš„å…·ä½“å€¼ï¼›å†å³ä¾§é½¿è½®æ˜¯ç¯å¢ƒçš„ç®¡ç† ç¬¬äºŒä¸ªæ¡†ä¸»è¦æœ‰å½“å‰è¯·æ±‚çš„ä¸€äº›ç®€å•æè¿°(æ³¨æ„åœ¨postmanä¸­å¯ä»¥ä½¿ç”¨markdownè¯­æ³•æ¥å†™æè¿°)ï¼›å³ä¾§exampleså¯ä»¥ç”¨æ¥ä¿å­˜å½“å‰requestçš„exampleï¼Œä¾›å…¶ä»–äººæŸ¥çœ‹è¯·æ±‚å¯èƒ½è¿”å›çš„æƒ…å†µ ç¬¬ä¸‰ä¸ªæ¡†ä¸­æœ€å·¦ä¾§å¯ä»¥é€‰æ‹©è¯·æ±‚çš„ç±»å‹(getã€post..)ï¼Œå†å³ä¾§æ˜¯urlåœ°å€(pathæ˜¯å®šä¹‰çš„ä¸€ä¸ªå˜é‡)ï¼Œparamsæ˜¯æ·»åŠ æŸ¥è¯¢å­—ç¬¦ä¸²çš„æŒ‰é’®ï¼Œç‚¹å‡»åå¯ä»¥é€šè¿‡key-valueçš„å½¢å¼æ·»åŠ æŸ¥è¯¢å­—ç¬¦ä¸²ï¼›å†å³ä¾§æ˜¯å‘é€è¯·æ±‚(å¯é€šè¿‡ctrl+enteræ¥å¿«é€Ÿå‘é€)ä»¥åŠä¿å­˜å½“å‰è¯·æ±‚ ç¬¬å››ä¸ªæ¡†æ˜¯requestç›¸å…³çš„ï¼Œåˆ†åˆ«æœ‰ æˆæƒ request header(é€šè¿‡key-valueå½¢å¼æ·»åŠ ) request body(ä¼šæ ¹æ®é€‰æ‹©çš„è¯·æ±‚ç±»å‹ï¼Œè‡ªåŠ¨ç½®ç°ï¼Œå¦‚é€‰æ‹©getè¯·æ±‚ï¼Œrequest bodyä¼šä¸å¯ç”¨) å¯ä»¥åœ¨descriptionsç»™valueæ·»åŠ æè¿° pre-request script(è¯·æ±‚å‘é€ä¹‹å‰ä¼šæ‰§è¡Œçš„è„šæœ¬ï¼Œjsç¼–å†™) tests(è¯·æ±‚è¿”å›åä¼šæ‰§è¡Œçš„script) å³ä¾§cookieæ˜¯cookieç®¡ç† å³ä¾§codeæ˜¯ç”Ÿæˆä¸åŒè¯­è¨€å‘é€å½“å‰è¯·æ±‚ä»£ç æ®µçš„æŒ‰é’®ï¼Œç”Ÿæˆåå¯ä»¥ç›´æ¥æ‹·è´ä½¿ç”¨ æœ€åä¸€ä¸ªæ¡†æ˜¯responseç›¸å…³çš„ bodyå±•ç¤ºçš„æ˜¯response body å¯ä»¥é€šè¿‡prettyã€raw(æºç )ã€preview(ä¼ ä¼šå›¾ç‰‡æ—¶ä¼šæœ‰ç”¨)ä»¥ä¸åŒå½¢å¼æ¥æŸ¥çœ‹è¿”å›çš„å€¼ cookieæ˜¯åå°è¿”å›çš„cookie headeræ˜¯response header test resultsæ˜¯å±•ç¤ºæµ‹è¯•è„šæœ¬æ‰§è¡Œçš„ç»“æœ å˜é‡ ä¸»è¦ç”¨æ¥å¤ç”¨ å¸¸ç”¨çš„å˜é‡æœ‰ç¯å¢ƒå˜é‡ã€é›†åˆå˜é‡ã€å…¨å±€å˜é‡ ç¯å¢ƒå˜é‡ä»…åœ¨å¯¹åº”å¯¹åº”ç¯å¢ƒä¸­èµ·ä½œç”¨ é›†åˆå˜é‡ä»…åœ¨å½“å‰é›†åˆä¸­èµ·ä½œç”¨ å…¨å±€å˜é‡åˆ™æ˜¯åœ¨ä»»ä½•åœ°æ–¹éƒ½èµ·ä½œç”¨ åŒåå˜é‡å†²çªæ—¶ï¼Œä½œç”¨èŒƒå›´å°çš„ç”Ÿæ•ˆï¼Œå¦‚ä¸€ä¸ªå˜é‡åŒæ—¶åœ¨ä¸Šè¿°ä¸‰ä¸ªä¸­éƒ½æœ‰å®šä¹‰ï¼Œåˆ™ç¯å¢ƒå˜é‡ä¸­å®šä¹‰çš„ç”Ÿæ•ˆ ä½¿ç”¨ ä½¿ç”¨åŒå¤§æ‹¬å·åŒ…è£¹ä½¿ç”¨ å¦‚ä¸Šæ–‡çœ‹åˆ°çš„åŒå¤§æ‹¬å·pathå°±æ˜¯ä¸€ä¸ªå˜é‡ ä¼ é€’å‚æ•° å®é™…åœºæ™¯ï¼šåœ¨ç™»å½•åï¼Œä¿å­˜tokenï¼Œåœ¨åç»­çš„è¯·æ±‚ä¸­å¸¦ä¸Štokenï¼›è¿™å°±æ¶‰åŠåˆ°å¦‚ä½•ä¿å­˜ï¼Œå¦‚ä½•ä¼ é€’tokenäº† è§£å†³:å¯ä»¥åœ¨ç™»å½•æ¥å£çš„testä¸­ç¼–å†™ä»£ç ï¼Œå°†tokenåšä¸ºä¸€ä¸ªå˜é‡ä¿å­˜åˆ°å…¨å±€æˆ–è€…ç¯å¢ƒå˜é‡(éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªç¯å¢ƒ)ä¸­ï¼Œåœ¨å…¶ä»–æ¥å£ä¸­ç›´æ¥ä½¿ç”¨æ­¤å˜é‡å³å¯ æ€»ç»“ https://www.getpostman.com/docs/]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>postman</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[same-origin-policy]]></title>
    <url>%2F2018%2F02%2F05%2Fsame-origin-policy%2F</url>
    <content type="text"><![CDATA[å‰ç«¯æ—¶é—´ï¼Œé¡¹ç›®ä¸­é‡åˆ°ä¸€äº›è·¨åŸŸé—®é¢˜ï¼ŒæŸ¥é˜…äº†ä¸€äº›æ–‡æ¡£åï¼Œç‰¹åœ¨æ­¤åšä¸ªè®°å½•ã€‚ æµè§ˆå™¨çš„åŒæºç­–ç•¥åŠè§„é¿æ–¹æ³•åŒæºç­–ç•¥(same-origin-policy) åŒæºç­–ç•¥ä¸»è¦æ˜¯ç”¨æ¥éš”ç¦»ä¸€äº›æ½œåœ¨çš„æ¶æ„æ–‡ä»¶ã€‚ä¿è¯ç”¨æˆ·ä¿¡æ¯çš„å®‰å…¨ï¼Œé˜²æ­¢æ¶æ„çš„ç½‘ç«™çªƒå–æ•°æ®ã€‚https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy ä¾‹å¦‚ABä¸¤ä¸ªä¸åŒæºçš„ç½‘é¡µï¼Œå¦‚æœæ²¡æœ‰åŒæºç­–ç•¥ï¼ŒABä¹‹é—´å°±å¯ä»¥ç›¸äº’è®¿é—®è¯·æ±‚åˆ°å¯¹æ–¹çš„éšç§ä¿¡æ¯(å¦‚cookie)ï¼Œè¿™æ ·æ˜¾ç„¶æ˜¯ä¸å®‰å…¨çš„ã€‚ ä»€ä¹ˆæ˜¯åŒæº? åŒæºè¦æ±‚: åè®®ç›¸åŒ åŸŸåç›¸åŒ ç«¯å£ç›¸åŒ ä¸¾ä¾‹ URL è¯´æ˜ æ˜¯å¦å…è®¸é€šä¿¡ http://www.a.com/a.js http://www.a.com/b.js åŒä¸€åŸŸåä¸‹ å…è®¸ http://www.a.com/lab/a.js http://www.a.com/script/b.js åŒä¸€åŸŸåä¸‹ä¸åŒæ–‡ä»¶å¤¹ å…è®¸ http://www.a.com:8000/a.js http://www.a.com/b.js åŒä¸€åŸŸåï¼Œä¸åŒç«¯å£ ä¸å…è®¸ http://www.a.com/a.js https://www.a.com/b.js åŒä¸€åŸŸåï¼Œä¸åŒåè®® ä¸å…è®¸ http://www.a.com/a.js http://70.32.92.74/b.js åŸŸåå’ŒåŸŸåå¯¹åº”ip ä¸å…è®¸ http://www.a.com/a.js http://script.a.com/b.js ä¸»åŸŸç›¸åŒï¼Œå­åŸŸä¸åŒ ä¸å…è®¸ http://www.a.com/a.js http://a.com/b.js åŒä¸€åŸŸåï¼Œä¸åŒäºŒçº§åŸŸåï¼ˆåŒä¸Šï¼‰ ä¸å…è®¸ï¼ˆcookieè¿™ç§æƒ…å†µä¸‹ä¹Ÿä¸å…è®¸è®¿é—®ï¼‰ http://www.cnblogs.com/a.js http://www.a.com/b.js ä¸åŒåŸŸå ä¸å…è®¸ å¦‚ä½•è§„é¿åŒæºç­–ç•¥(è·¨åŸŸ) è™½ç„¶åŒæºç­–ç•¥èƒ½ä¿è¯ä¸€å®šçš„å®‰å…¨æ€§ï¼Œä½†æ˜¯æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦è¯·æ±‚ä¸åŒæºé¡µé¢çš„èµ„æºï¼Œå°±éœ€è¦è·¨è¿‡åŒæºç­–ç•¥ã€‚ cookie å½“ABä¸¤ä¸ªé¡µé¢ï¼Œä¸€çº§åŸŸåç›¸åŒï¼ŒäºŒçº§åŸŸåä¸åŒæ—¶ï¼Œå¯ä»¥é€šè¿‡åŒæ—¶è®¾ç½®document.domainä¸ºä¸€çº§åŸŸåï¼Œå°±å¯ä»¥å®ç°cookieçš„å…±äº« Aé¡µé¢æ˜¯http://a.test.comï¼ŒBé¡µé¢æ˜¯http://b.test.comï¼ŒäºŒè€…å› ä¸ºäºŒçº§åŸŸåä¸åŒï¼Œæ‰€ä»¥å—åŒæºç­–ç•¥çš„é™åˆ¶ï¼Œæ— æ³•å…±äº«cookieã€‚å¯ä»¥åŒæ—¶è®¾ç½®document.domain=&#39;test.com&#39;æ¥è§£å†³123456789// Aé¡µé¢document.domain='test.com'document.cookie = "testName=cgh"; // Aé¡µé¢è®¾ç½®cookie// Bé¡µé¢document.domain='test.com'...var allCookie = document.cookie; // Bé¡µé¢å¯ä»¥è¯»å–åˆ°Aé¡µé¢çš„cookie... iframe ä½¿ç”¨iframeåµŒå¥—é¡µé¢æ—¶ï¼Œiframeçš„srcä¸å—åŒæºç­–ç•¥çš„å½±å“ï¼Œå¯ä»¥åŠ è½½ä»»æ„åœ°å€çš„æ–‡æ¡£ï¼›å½“çˆ¶é¡µé¢å’Œiframeå­˜åœ¨åŒæºé™åˆ¶æ—¶ï¼Œå°†ä¸èƒ½ç›¸äº’è®¿é—®windowå’ŒDOMã€‚ä¾‹å¦‚åœ¨Aé¡µé¢åµŒå¥—äº†ç™¾åº¦ï¼Œåˆ™åœ¨Aé¡µé¢æ˜¯æ— æ³•è®¿é—®åˆ°ç™¾åº¦é¦–é¡µçš„windowå’ŒDOMçš„ã€‚çˆ¶å­é¡µé¢åŒæºæ—¶ï¼Œèƒ½å¯ä»¥ç›¸äº’è®¿é—®windowã€DOM çˆ¶å­é¡µé¢ï¼Œä¸€çº§åŸŸåç›¸åŒï¼ŒäºŒçº§åŸŸåä¸åŒæ—¶ï¼Œå¯ä»¥ä½¿ç”¨å’Œcookieç›¸åŒçš„åŠæ³•ï¼ˆè®¾ç½®documen.domainï¼‰æ¥è§£å†³ï¼Œè¿›è€Œå¯ä»¥ç›¸äº’è®¿é—®windowå’ŒDOM 12345678910111213// http://www.test.com/a.html&lt;iframe src="child.test.com/b.html"&gt;&lt;/iframe&gt;&lt;script&gt;document.domain='test.com';var user='cgh';&lt;/script&gt;// http://child.test.com/b.html&lt;script&gt;document.domain='test.com';console.log(window.parent.user);// è·å–çˆ¶çª—å£çš„å˜é‡&lt;/script&gt; å®Œå…¨ä¸åŒæºçš„iframeå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•å®ç° hash+hashchange çˆ¶é¡µé¢å°†ä¿¡æ¯å†™å…¥åˆ°å­iframeçš„hashå€¼ä¸­ï¼Œå­é¡µé¢é€šè¿‡ç›‘å¬hashchangeäº‹ä»¶æ¥æ¥æ”¶ä¿¡æ¯(ä¹Ÿå¯ä»¥é‡‡ç”¨setIntervalå‘ä¸‹å…¼å®¹);å­é¡µé¢å¯ä»¥ç›´æ¥æ”¹å†™çˆ¶é¡µé¢çš„hashå€¼(æœ‰äº›æµè§ˆå™¨ä¸å…è®¸ç›´æ¥ä¿®æ”¹çˆ¶é¡µé¢çš„hashå€¼ï¼Œå¯ä»¥é€šè¿‡åœ¨çˆ¶é¡µé¢Açš„åŒåŸŸä¸‹å†åˆ›å»ºä¸€ä¸ªä¸­é—´é¡µé¢C,åœ¨ç›®æ ‡é¡µé¢BåµŒå…¥Cæ¥å®ç°ï¼Œå…·ä½“çœ‹ä¸‹é¢ä¾‹å­)ï¼Œçˆ¶é¡µé¢ä¹Ÿå¯ä»¥ç›‘å¬hashchangeæ¥æ¥æ”¶å­é¡µé¢çš„ä¿¡æ¯ï¼›å‚è€ƒ:https://www.zhihu.com/question/20314348/answer/20025563123456789101112131415161718192021// http://w1.test.com/a.htmlï¼Œaé¡µé¢ä¸­åµŒå…¥äº†ä¸åŒæºçš„bé¡µé¢ï¼›aé¡µé¢å¯ä»¥è®¾ç½®bFrame srcä¸­çš„hashå€¼&lt;iframe id="bFrame" src="http://ah122.cn/b.html"&gt;&lt;/iframe&gt;// http://ah122.cn/b.htmlï¼Œbé¡µé¢åµŒå¥—äº†å’Œaé¡µé¢åŒæºçš„cé¡µé¢&lt;iframe id="cFrame" src="http://w1.test.com/c.html" style="display:none"&gt;&lt;/iframe&gt;&lt;script&gt; window.onhashchange = function()&#123;// bé¡µé¢ç›‘å¬aé¡µé¢æ”¹å˜bFrame Hashå€¼çš„äº‹ä»¶ï¼Œå¹¶å°†å€¼ä¼ é€’ç»™å’ŒaåŒæºçš„cé¡µé¢ document.getElementById('cFrame').src = 'http://w1.test.com/c.html' + location.hash; &#125;&lt;/script&gt;// http://w1.test.com/c.htmlï¼Œå’Œaé¡µé¢åŒæºï¼Œacé¡µé¢å¯ä»¥ç›¸äº’è®¿é—®å˜é‡å’ŒDOM&lt;script&gt; window.onhashchange = function()&#123;// cé¡µé¢ç›‘å¬åˆ°hashå€¼æ”¹å˜ï¼Œå°†å€¼ä¼ é€’åˆ°åŒæºçš„aé¡µé¢ parent.parent._bHash = location.hash; &#125;&lt;/script&gt;// æ€»ç»“A-&gt;B ABä¸åŒæºï¼Œä½†Aå¯ä»¥ä¿®æ”¹bFrameä¸­srcçš„hashå€¼ï¼ŒBå¯ä»¥é€šè¿‡hashchangeäº‹ä»¶è·å–åˆ°ä¼ é€’è¿‡æ¥çš„hashå€¼B-&gt;A å› ä¸ºBä¸ºå­é¡µé¢ï¼Œè€Œä¸”ä¸åŒæºï¼Œæ— æ³•ç›´æ¥ä¼ é€’æ•°æ®æˆ–è€…ä¿®æ”¹Açš„windowã€DOMï¼Œå¿…é¡»æ‰¾ä¸ªä¸­é—´æ¡¥æ¢æ¥å®ç°ä¼ é€’ï¼Œäºæ˜¯ï¼Œé€šè¿‡åœ¨Bä¸­åµŒå¥—å’ŒAåŒæºçš„Cé¡µé¢ï¼Œå°†æ•°æ®é€šè¿‡ä¿®æ”¹cFrameçš„hashçš„æ–¹å¼ä¼ é€’ç»™Cé¡µé¢ï¼ŒCé¡µé¢é€šè¿‡hashchangeäº‹ä»¶æ¥æ”¶åˆ°æ•°æ®ï¼Œå¹¶é€šè¿‡parent.parentå°†æ•°æ®ä¼ é€’ç»™A(ACåŒæºï¼Œå¯ä»¥ç›¸äº’è®¿é—®windowã€DOM)ï¼Œè¿™æ ·å°±å®Œæˆäº†å­é¡µé¢Båƒä¸åŒæºçš„Aé¡µé¢ä¼ é€’æ•°æ®çš„è¿‡ç¨‹ã€‚ window.name æµè§ˆå™¨çª—å£æœ‰window.nameå±æ€§ã€‚è¿™ä¸ªå±æ€§çš„æœ€å¤§ç‰¹ç‚¹æ˜¯ï¼Œæ— è®ºæ˜¯å¦åŒæºï¼Œåªè¦åœ¨åŒä¸€ä¸ªçª—å£é‡Œï¼Œå‰ä¸€ä¸ªç½‘é¡µ(iframe)è®¾ç½®äº†è¿™ä¸ªå±æ€§ï¼Œåä¸€ä¸ªç½‘é¡µå¯ä»¥è¯»å–å®ƒ(å°±æ˜¯iframeå³ä½¿srcå‘ç”Ÿæ”¹å˜äº†ï¼Œiframeå¯¹åº”çš„contentWindow.nameéƒ½ä¸ä¼šå‘ç”Ÿæ”¹å˜ï¼Œé™¤éé‡æ–°è®¾ç½®äº†)ã€‚å¹¶ä¸”å®¹é‡å¾ˆå¤§ï¼Œæ­£å¸¸2Mï¼ŒIEã€FFå¯ä»¥è¾¾åˆ°32M; åˆ©ç”¨window.nameè·¨åŸŸï¼ŒåŸç†å’Œhashå€¼è·¨åŸŸç±»ä¼¼ï¼Œéƒ½éœ€è¦ä¸€ä¸ªä¸­é—´(ä»£ç†)é¡µé¢ï¼›å‚è€ƒ:http://www.cnblogs.com/rainman/archive/2011/02/21/1960044.html12345678910111213141516171819202122232425262728293031323334353637383940// a.com/a.htmlï¼šåº”ç”¨é¡µé¢ã€‚// a.com/c.htmlï¼šä»£ç†æ–‡ä»¶ï¼Œä¸€èˆ¬æ˜¯ä¸€ä¸ªæ²¡æœ‰ä»»ä½•å†…å®¹çš„htmlæ–‡ä»¶ï¼Œéœ€è¦å’Œåº”ç”¨é¡µé¢åœ¨åŒä¸€åŸŸä¸‹ã€‚// b.com/b.htmlï¼šåº”ç”¨é¡µé¢éœ€è¦è·å–æ•°æ®çš„é¡µé¢ï¼Œå¯ç§°ä¸ºæ•°æ®é¡µé¢ã€‚// a.com/a.htmlï¼Œaé¡µé¢ä¸­åˆ›å»ºå¹¶åµŒå…¥ä¸åŒæºçš„cé¡µé¢ï¼›å¯ä»¥é€šè¿‡ä¿®æ”¹hashå€¼æ¥ä¼ é€’æ•°æ®ç»™bé¡µé¢&lt;script&gt; var state = 0, iframe = document.createElement('iframe'), loadfn = function() &#123;// b.htmlåŠ è½½å®Œæˆåä¼šæ‰§è¡Œ if (state === 1) &#123; var data = iframe.contentWindow.name; // è¯»å–æ•°æ® alert(data); //å¼¹å‡º'éœ€è¦å›ä¼ ç»™açš„æ•°æ®' &#125; else if (state === 0) &#123; state = 1; iframe.contentWindow.location = "http://a.com/c.html"; // è®¾ç½®çš„ä»£ç†æ–‡ä»¶ &#125; &#125;; iframe.src = 'http://b.com/b.html'; if (iframe.attachEvent) &#123; iframe.attachEvent('onload', loadfn); &#125; else &#123; iframe.onload = loadfn; &#125; document.body.appendChild(iframe); // æ•°æ®è·å–å®Œæ¯•åï¼Œå¯ä»¥é”€æ¯iframe iframe.contentWindow.document.write(''); iframe.contentWindow.close(); document.body.removeChild(iframe);&lt;/script&gt;// b.com/b.htmlï¼Œbé¡µé¢å¯ä»¥ç›‘å¬hashchangeäº‹ä»¶æ¥æ¥æ”¶aé¡µé¢ä¼ é€’æ¥çš„æ•°æ®&lt;script&gt;window.onhashchange=function()&#123; // æ¥æ”¶aä¼ é€’æ¥çš„æ•°æ® var receive=window.location.hash;&#125;;window.name='éœ€è¦å›ä¼ ç»™açš„æ•°æ®';&lt;/script&gt;// a.com/c.htmlï¼Œæ˜¯ä¸€ä¸ªç©ºç™½é¡µé¢ï¼Œä»€ä¹ˆéƒ½ä¸éœ€è¦å¤„ç†ï¼Œåªéœ€è¦å’Œaé¡µé¢åŒæº window.postMessage æ— è®ºæ˜¯hashè¿˜æ˜¯window.nameéƒ½å±äºä¸€ç§hackæŠ€æœ¯ï¼›H5å¼•å…¥äº†è·¨æ–‡æ¡£é€šä¿¡çš„APIï¼ŒpostMessageï¼›å¯ä»¥æ”¯æŒIE8+(IE89ä»…æ”¯æŒåœ¨iframeä¸­ä¼ é€’)ï¼›å‚è€ƒ:http://www.ruanyifeng.com/blog/2016/04/same-origin-policy.html1234567891011// a.com/a.htmlvar popup = window.open('http://b.com', 'title');popup.postMessage('Hello World!', 'http://b.com');// b.com/b.htmlwindow.addEventListener('message', function(e) &#123;// event.sourceï¼šå‘é€æ¶ˆæ¯çš„çª—å£// event.origin: æ¶ˆæ¯å‘å‘çš„ç½‘å€// event.data: æ¶ˆæ¯å†…å®¹ console.log(e.data);// 'Hello World!'&#125;,false); AJAX åŒæºæ”¿ç­–è§„å®šï¼ŒAJAXè¯·æ±‚åªèƒ½å‘ç»™åŒæºçš„ç½‘å€ï¼Œå¦åˆ™å°±æŠ¥é”™ è·¨åŸŸè§£å†³ æ¶è®¾æœåŠ¡å™¨ä»£ç†(æµè§ˆå™¨è¯·æ±‚åŒæºæœåŠ¡å™¨ï¼Œå†ç”±åè€…è¯·æ±‚å¤–éƒ¨æœåŠ¡) åœ¨vue-cliä¸­å¯ä»¥é€šè¿‡é…ç½®express.Router.get()æ¥å®ç°å¯¹å¤–æ¥å£è¯·æ±‚ JSONP åœ¨htmlä¸­srcã€hrefè¯·æ±‚çš„èµ„æºæ˜¯ä¸å—åŒæºç­–ç•¥çš„é™åˆ¶çš„;imgã€iframeã€cssã€scriptå¯ä»¥åŠ è½½ä»»æ„çš„èµ„æºï¼›jsonpå°±æ˜¯åˆ©ç”¨scriptæ ‡ç­¾çš„srcä¸å—åŒæºé™åˆ¶ï¼Œå¹¶åœ¨åˆ›å»ºæ—¶è‡ªåŠ¨æ‰§è¡Œå†…éƒ¨ä»£ç æ¥å®ç°çš„ã€‚ ä¸€ä¸ªç®€å•çš„jsonpå®ç°ï¼›æºç è¯·æŸ¥çœ‹:https://github.com/BryanAdamss/SourceSave/blob/master/Plugins/js/vendor/12_jsonp.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143(function(root, moduleName, factory) &#123; if (typeof define === 'function' &amp;&amp; define.amd) &#123; define([], function() &#123; return (root[moduleName] = factory(root)); &#125;); &#125; else &#123; root[moduleName] = factory(root); &#125;&#125;(typeof window !== "undefined" ? window : this, "c_jsonp", function(win) &#123; if (typeof Object.assign != 'function') &#123; Object.defineProperty(Object, "assign", &#123; value: function assign(target, varArgs) &#123; 'use strict'; if (target == null) &#123; throw new TypeError('Cannot convert undefined or null to object'); &#125; var to = Object(target); for (var index = 1; index &lt; arguments.length; index++) &#123; var nextSource = arguments[index]; if (nextSource != null) &#123; for (var nextKey in nextSource) &#123; if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) &#123; to[nextKey] = nextSource[nextKey]; &#125; &#125; &#125; &#125; return to; &#125;, writable: true, configurable: true &#125;); &#125; function formatParams(obj) &#123; // æ ¼å¼åŒ–å‚æ•° var arr = []; for (var key in obj) &#123; arr.push(encodeURIComponent(key) + '=' + encodeURIComponent(obj[key])); &#125; return arr.join('&amp;'); &#125; var configs = &#123; url: '', data: &#123;&#125;, callbackKey: 'callback', // å’Œåå°çº¦å®šçš„ç¡®å®šå›è°ƒåçš„keyå€¼ callbackName: ('jsonpCallback' + Math.random()).replace('.', ''), // é»˜è®¤çš„éšæœºå›è°ƒå timeout: 3000, // è¶…æ—¶æ—¶é—´ success: function(resp) &#123; // ä¼šåœ¨è¯·æ±‚æˆåŠŸæ—¶ï¼Œè°ƒç”¨callbackNameå¯¹åº”çš„å‡½æ•°ä¸­æ‰§è¡Œsuccess(ä¸ºä»€ä¹ˆä¸ç›´æ¥æ‰§è¡Œsuccessæ˜¯å› ä¸ºï¼Œéœ€è¦åœ¨callbackNameå¯¹åº”çš„å‡½æ•°ä¸­åšä¸€äº›å…¶ä»–æ“ä½œï¼Œå¦‚åˆ é™¤scriptã€æ¸…é™¤å®šæ—¶å™¨) console.log(resp); &#125;, error: function() &#123; // è¯·æ±‚å‡ºé”™æ—¶ï¼Œä¼šç›´æ¥è°ƒç”¨ throw new Error('è¯·æ±‚å‡ºé”™!'); &#125;, &#125;; function jsonp(options) &#123; var settings = Object.assign(&#123;&#125;, configs, options); if (!settings.url) &#123; throw new Error('urlå¿…é¡»ä¼ å…¥'); return; &#125; var params = ''; // æ ¼å¼åŒ–å‚æ•° if (settings.data) &#123; settings.data[settings.callbackKey] = settings.callbackName; params = formatParams(settings.data); &#125; var timer = null; // è¶…æ—¶å¤„ç† if (settings.timeout) &#123; timer = setTimeout(function() &#123; win[settings.callbackName] = null; oHead.removeChild(oScript); settings.error &amp;&amp; settings.error.call(null); &#125;, settings.timeout); &#125; // åˆ›å»ºä¸€ä¸ªå…¨å±€å›è°ƒå‡½æ•°ï¼Œç­‰å¾…jsonpè°ƒç”¨ window[settings.callbackName] = function(resp) &#123; oHead.removeChild(oScript); if (timer) &#123; clearTimeout(timer); &#125; window[settings.callbackName] = null; settings.success &amp;&amp; settings.success.call(null, resp); &#125;; // åˆ›å»ºscriptå¹¶è¿½åŠ åˆ°é¡µé¢ä¸Š var oHead = document.querySelector('head'); var oScript = document.createElement('script'); var hasQuestionMark = settings.url.indexOf('?') &lt; 0 ? false : true; var src = ''; if (hasQuestionMark) &#123; src = settings.url + params; &#125; else &#123; src = settings.url + '?' + params; &#125; oScript.src = src; oHead.appendChild(oScript); &#125; return jsonp;&#125;));// ä½¿ç”¨&lt;script type="text/javascript" src="js/vendor/12_jsonp.js"&gt;&lt;/script&gt;&lt;script type="text/javascript"&gt;window.onload = function() &#123; main();&#125;;function main() &#123; getList();&#125;function getList() &#123; c_jsonp(&#123; url: 'http://192.168.23.126:8080/hfgj/app/cgh.do', data: &#123; id: 3, name: 'cgh' &#125;, success: function(resp) &#123; console.log(resp); &#125;, error: function() &#123; console.log('å‡ºé”™äº†'); &#125; &#125;);&#125;&lt;/script&gt; websocket åŒå‘å®æ—¶å…¨åŒå·¥é€šä¿¡ï¼Œæ”¯æŒè·¨åŸŸè¿æ¥ï¼›å…·ä½“å‚è€ƒ:http://www.52im.net/forum.php?mod=viewthread&amp;tid=331&amp;ctid=15 CORS è·¨èµ„æºå…±äº«ï¼Œéœ€è¦åœ¨æœåŠ¡ç«¯é…ç½®Access-Control-Allow-Originä¸º*ï¼Œä»£è¡¨å…è®¸ä»»ä½•æ¥æºçš„è¯·æ±‚èµ„æºï¼›å®¢æˆ·ç«¯åœ¨å‘é€è¯·æ±‚æ—¶éœ€è¦å¸¦ä¸Šoriginæ¥æ ‡è¯†è¯·æ±‚æ¥è‡ªå“ªä¸ªåŸŸï¼Œå¥½è®©æœåŠ¡ç«¯åšéªŒè¯ã€‚å…·ä½“å¯å‚è€ƒ:http://www.ruanyifeng.com/blog/2016/04/cors.html å‚è€ƒé“¾æ¥ https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy#%E8%B7%A8%E6%BA%90%E7%BD%91%E7%BB%9C%E8%AE%BF%E9%97%AEhttps://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORShttp://www.cnblogs.com/rainman/archive/2011/02/20/1959325.htmlhttp://www.cnblogs.com/rainman/archive/2011/02/21/1960044.htmlhttp://www.ruanyifeng.com/blog/2016/04/same-origin-policy.htmlhttp://www.ruanyifeng.com/blog/2016/04/cors.html]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>CORS</tag>
        <tag>JSONP</tag>
        <tag>è·¨åŸŸ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[vue-music-note]]></title>
    <url>%2F2018%2F01%2F30%2Fvue-music-note%2F</url>
    <content type="text"><![CDATA[å¹•å®¢ç½‘éŸ³ä¹appå­¦ä¹ ç¬”è®° å¹•å®¢ç½‘éŸ³ä¹appå­¦ä¹ ç¬”è®°vue-cli åˆå§‹åŒ– vue init webpack vue-musicï¼Œå¦‚æœæ²¡æœ‰ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºvue-musicæ–‡ä»¶å¤¹ vue-cliçš„runtime+compiler vs runtimeé€‰æ‹© å‰è€…ä¼šåŒ…å«ç¼–è¯‘å™¨ï¼Œé€‚åˆåœ¨éœ€è¦å®¢æˆ·ç«¯ç¼–è¯‘æ¨¡æ¿çš„æ—¶å€™ åè€…å› ä¸ºä¸åŒ…å«ç¼–è¯‘å™¨ï¼Œæœ€ç»ˆç¼–è¯‘å‡ºæ¥çš„å¤§å°ä¼šæ¯”å‰è€…å°ï¼Œé€‚ç”¨äºåŸºäº.vueæ–‡ä»¶å¼€å‘ä½¿ç”¨äº†vue-loaderçš„æƒ…å†µã€‚ä¸€èˆ¬é€‰æ‹©è¿™ä¸ª vue-cliçš„eslintæ¨¡å¼ ä½¿ç”¨standard åŸºæœ¬å‘½ä»¤ å¯åœ¨package.jsonçš„scriptsä¸­æŸ¥è¯¢åˆ° npm startã€npm run devå¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œé»˜è®¤åœ¨localhost:8080ç«¯å£ï¼›è‹¥æƒ³åœ¨å…¶ä»–ç”µè„‘æŸ¥çœ‹ï¼Œå¯é…ç½®config/index.jsä¸‹çš„hostå­—æ®µä¸ºæœ¬æœºIP ä¿®æ”¹vue-cliç›®å½• é»˜è®¤ç›®å½•ç»“æ„ 12345678910111213141516171819/vue-music|---build/ // å­˜æ”¾webpackæ„å»ºç›¸å…³æ–‡ä»¶ï¼Œä¸€èˆ¬ä¸å»ºè®®ä¿®æ”¹|---config/ // æ„å»ºçš„ä¸€äº›é…ç½®å‚æ•°ï¼Œå¦‚æœéœ€è¦å¯¹æ„å»ºè¿‡ç¨‹åšä¸€äº›ä¿®æ”¹ï¼Œå¯ä»¥é…ç½®æ­¤æ–‡ä»¶|---node_modules/|---src/ // å­˜æ”¾å¼€å‘çš„ä¸»è¦æ–‡ä»¶ï¼Œä¸€èˆ¬éœ€è¦ä¿®æ”¹è¿™é‡Œçš„ç›®å½•ç»“æ„ assets/ // å­˜æ”¾ä¸€äº›éœ€è¦webpackå¤„ç†çš„é™æ€æ–‡ä»¶ components/ // å­˜æ”¾vueçš„.vueç»„ä»¶ router/ // å­˜æ”¾è·¯ç”±æ–‡ä»¶ App.vue // æ ¹ç»„ä»¶ï¼Œä¸€èˆ¬åšæ•´ä½“å¸ƒå±€ç”¨ main.js // å…¥å£æ–‡ä»¶ï¼Œè´Ÿè´£æ¸²æŸ“App.vueæ–‡ä»¶ï¼Œå¹¶è¿›è¡Œä¸€äº›å…¨å±€æ€§çš„æ“ä½œï¼›å…¨å±€æ€§æ ·å¼å¯åœ¨è¿™é‡Œé€šè¿‡import &apos;test.scss&apos;å¯¼å…¥|---static/ // å­˜æ”¾ä¸éœ€è¦webpackå¤„ç†å¯ä»¥ç›´æ¥ä½¿ç”¨çš„é™æ€æ–‡ä»¶|---.babelrc // babelé…ç½®|---.editorconfig|---.eslintrc.js // eslinté…ç½®æ–‡ä»¶|---.gitignore|---.postcssrc.js // postcssé…ç½®|---index.html // spaçš„ä¸»ä½“htmlæ–‡ä»¶ï¼Œéœ€è¦ä¿®æ”¹ä¸€äº›headä¸­ä»£ç ï¼Œjsä»£ç ä¼šé€šè¿‡webpackè‡ªåŠ¨æ³¨å…¥|---package.json // ä¿å­˜é¡¹ç›®æ‰€æœ‰çš„ä¾èµ–|---README.md ä¿®æ”¹åçš„ç›®å½•ï¼Œå¼€å‘æ—¶ä¸»è¦ä¿®æ”¹çš„æ˜¯/src/ç›®å½•ç»“æ„ 1234567891011121314151617181920212223242526272829303132/vue-music|---build/|---config/|---node_modules/|---src/ api/ // å­˜æ”¾è¯·æ±‚åå°æ¥å£çš„jsæ–‡ä»¶ä»¥åŠæ¥å£çš„é€šç”¨é…ç½®å‚æ•°æ–‡ä»¶ base/ // å­˜æ”¾åŸºç¡€(é€šç”¨)ç»„ä»¶ï¼Œä»¥æ–‡ä»¶å¤¹åšåŒºåˆ† base1/ base1.vue base2/ base2.vue common/ // å­˜æ”¾ä¸€äº›é€šç”¨çš„jsã€imgã€å­—ä½“ç­‰é™æ€èµ„æº components/ // å­˜æ”¾ä¸šåŠ¡ç»„ä»¶ï¼Œç»„ä»¶ç”¨ä¸åŒçš„æ–‡ä»¶å¤¹åŒºåˆ†ï¼Œç»„ä»¶è‡ªèº«ç”¨åˆ°çš„èµ„æºç»„ç»‡åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ comp1/ com1Bg.jpg comp1.vue comp2/ comp2.vue router/ store/ // å­˜æ”¾vuexç›¸å…³æ–‡ä»¶ sass/ // å­˜æ”¾sassæ ·å¼æ–‡ä»¶ App.vue main.js|---static/|---.babelrc|---.editorconfig|---.gitignore|---.postcssrc.js|---index.html|---package.json|---README.md vue-cliæœ¬èº«ä¸è‡ªå¸¦æ ·å¼é¢„å¤„ç†å™¨ï¼Œéœ€è¦æ‰‹åŠ¨å®‰è£…npm install --save-dev node-sass sass-loader vue-cliä¼šé…ç½®è·¯å¾„åˆ«å@æŒ‡å‘/src/æ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡@/components/comp1/comp1æ¥å¼•ç”¨ç»„ä»¶ï¼›ä¹Ÿå¯ä»¥æ‰‹åŠ¨é…ç½®è·¯å¾„åˆ«åï¼Œå‡å°‘ä¹¦å†™é‡ã€‚ vue-router éœ€è¦åœ¨/src/router/index.jsä¸­å¯¼å…¥vue-routerï¼Œå¹¶å¯¼å‡ºä¸€ä¸ªrouterçš„å®ä¾‹ï¼Œæœ€ååœ¨å…¥å£js(main.js)ä¸­å¯¼å…¥å¹¶æ³¨å†Œ 1234567891011121314151617181920212223242526272829303132333435363738394041// router/index.jsimport Vue from &apos;vue&apos;;import Router from &apos;vue-router&apos;;// å¯¼å…¥vue-router..import Recommend from &apos;components/recommend/recommend&apos;import Singer from &apos;components/singer/singer&apos;...Vue.use(Router); // å¿…é¡»ä½¿ç”¨useæ–¹æ³•æ¥æ³¨å†Œç¬¬ä¸‰æ–¹æ’ä»¶export default new Router(&#123;// å¯¼å‡ºä¸€ä¸ªvue-routerå®ä¾‹ routes: [&#123; path: &apos;/&apos;, redirect: &apos;/recommend&apos;,// æ²¡æœ‰åŒ¹é…åˆ°çš„è·¯å¾„å…¨éƒ¨é‡å®šå‘åˆ°/recomend &#125;, &#123; path: &apos;/recommend&apos;,// pathä¸€å®šæ˜¯ä¸ªè·¯å¾„ï¼Œå¼€å¤´å¿…é¡»æœ‰/ name: &apos;Recommend&apos;, component: Recommend, children: [&#123;// å­è·¯ç”± path: &apos;:id&apos;,// ä¼ é€’çš„å‚æ•° name: &apos;Disc&apos;, component: Disc &#125;]&#125;)// src/main.jsimport Vue from &apos;vue&apos;...import router from &apos;./router&apos;; // å¯¼å…¥...new Vue(&#123; el: &apos;#app&apos;, router,// æ³¨å†Œ store, render: h =&gt; h(App)&#125;) router-link 123&lt;router-link tag=&quot;div&quot; class=&quot;tab-item&quot; to=&quot;/recommend&quot; active-class=&quot;is-cur&quot;&gt; // æ¸²æŸ“æˆdivï¼Œè·³è½¬åˆ°/recommendè·¯å¾„ï¼Œå¹¶åœ¨æ¿€æ´»æ—¶æ·»åŠ is-curæ ·å¼ç±» &lt;span class=&quot;tab-link&quot;&gt;æ¨è&lt;/span&gt; &lt;/router-link&gt; ä½¿ç”¨babel vue-cliçš„babelè½¬ä¹‰ä¸å¤ªæ¸…æ¥šï¼Œä¸ºä»€ä¹ˆç”¨äº†å¾ˆå¤špresetï¼Œéš¾é“ä¸æ˜¯ç”¨æœ€æ–°çš„babel-preset-envå°±å¯ä»¥äº†å—ï¼Ÿç–‘æƒ‘ä¸­â€¦ è‡ªå·±æ€»ç»“çš„babelä½¿ç”¨ç»éªŒ ä½¿ç”¨babel-preset-envï¼Œå¹¶é…ç½®targetsæµè§ˆå™¨ ç»“åˆuseBuiltIns:usageé€‰é¡¹å’Œbabel-polyfillæ¥å®ŒæˆæŒ‰éœ€polyfill å‚è€ƒ https://github.com/babel/babel/tree/master/packages/babel-preset-env fastclick å–æ¶ˆç§»åŠ¨ç«¯ç‚¹å‡»300mså»¶è¿Ÿ å…¥å£æ–‡ä»¶ä¸­å¯¼å…¥ï¼Œå¹¶ç»‘å®šåˆ°bodyä¸Š 1234567// src/main.js...import fastclick from &apos;fastclick&apos;...fastclick.attach(document.body) æ³¨æ„:fastclickä¼šæ‹¦æˆªclickäº‹ä»¶ï¼Œå¦‚æœä¸€ä¸ªç»„ä»¶å†…éƒ¨éœ€è¦ç›‘å¬clickäº‹ä»¶æ—¶ï¼Œå¯åœ¨å¯¹åº”DOMèŠ‚ç‚¹ä¸Šæ·»åŠ needsclickæ ·å¼ç±»å‘Šè¯‰fastclickä¸æ‹¦æˆªæ­¤DOMçš„clickäº‹ä»¶ import/export é€šè¿‡importå¯ä»¥å¯¼å…¥å„ç§æ¨¡å—1234567891011121314151617181920import Test from &apos;./components/test/test&apos;; // ç›¸å¯¹è·¯å¾„æŸ¥æ‰¾import &#123;getRecommend,getDiscList&#125; from &apos;./api/recommend&apos;; // å¯¼å…¥ç‰¹å®šæ–¹æ³•import myDefault,* as myObj from &apos;./a&apos;; // å¯¼å…¥æ‰€æœ‰æ–¹æ³•(é»˜è®¤æ–¹æ³•+å…¶ä»–æ–¹æ³•)import Vue from &apos;vue&apos;; // ç›´æ¥ä»¥åå­—å¼€å¤´ï¼Œä¼šåœ¨node_modulesä¸‹æŸ¥æ‰¾import createLogger from &apos;vuex/dist/logger&apos;; // å¯ä»¥åœ¨node_modulesä¸‹æŒ‰è·¯å¾„æŸ¥æ‰¾// é…ç½®äº†åˆ«åçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨åå­—å¼€å¤´ï¼Œå¦‚æœæ²¡é…ç½®åˆ«ååˆ™ä¼šåœ¨node_modulesä¸‹æŸ¥æ‰¾// webpack.base.conf.jsmodule.exports = &#123; ... resolve: &#123; extensions: [&apos;.js&apos;, &apos;.vue&apos;, &apos;.json&apos;], alias: &#123; &apos;components&apos;: resolve(&apos;src/components&apos;), &#125; &#125;,&#125;import Test from &apos;components/test/test&apos;; jsonp åŸç†:scriptæ ‡ç­¾æ²¡æœ‰åŒæºç­–ç•¥é™åˆ¶ã€‚é€šè¿‡åŠ¨æ€åˆ›å»ºscriptæ ‡ç­¾ï¼Œç„¶åsrcæŒ‡å‘apiåœ°å€ï¼Œå¹¶é™„å¸¦ä¸€ä¸ªå›è°ƒå‡½æ•°åï¼Œåç«¯ç”¨å‰å°ä¼ æ¥çš„å›è°ƒåå°†éœ€è¦çš„æ•°æ®åŒ…è£¹å¹¶ä¼ å›å‰å°ï¼Œå‰å°ä¼šè‡ªåŠ¨æ‰§è¡Œæå‰å†™å¥½çš„å›è°ƒã€‚jsonpæ˜¯getè¯·æ±‚ï¼› ä¸‹é¢æ˜¯jsonpçš„ç®€å•å®ç°ï¼Œå…·ä½“å¯æŸ¥çœ‹:https://github.com/BryanAdamss/SourceSave/blob/master/Plugins/js/vendor/11_jsonp.js 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115(function(root, moduleName, factory) &#123; if (typeof define === 'function' &amp;&amp; define.amd) &#123; define([], function() &#123; return (root[moduleName] = factory(root)); &#125;); &#125; else &#123; root[moduleName] = factory(root); &#125;&#125;(typeof window !== "undefined" ? window : this, "c_jsonp", function(win) &#123; if (typeof Object.assign != 'function') &#123; Object.defineProperty(Object, "assign", &#123; value: function assign(target, varArgs) &#123; 'use strict'; if (target == null) &#123; throw new TypeError('Cannot convert undefined or null to object'); &#125; var to = Object(target); for (var index = 1; index &lt; arguments.length; index++) &#123; var nextSource = arguments[index]; if (nextSource != null) &#123; for (var nextKey in nextSource) &#123; if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) &#123; to[nextKey] = nextSource[nextKey]; &#125; &#125; &#125; &#125; return to; &#125;, writable: true, configurable: true &#125;); &#125; function formatParams(obj) &#123; // æ ¼å¼åŒ–å‚æ•° var arr = []; for (var key in obj) &#123; arr.push(encodeURIComponent(key) + '=' + encodeURIComponent(obj[key])); &#125; return arr.join('&amp;'); &#125; var configs = &#123; url: '', data: &#123;&#125;, callbackKey: 'callback', // å’Œåå°çº¦å®šçš„ç¡®å®šå›è°ƒåçš„keyå€¼ callbackName: ('jsonpCallback' + Math.random()).replace('.', ''), // é»˜è®¤çš„éšæœºå›è°ƒå timeout: 3000, // è¶…æ—¶æ—¶é—´ success: function(resp) &#123; // ä¼šåœ¨è¯·æ±‚æˆåŠŸæ—¶ï¼Œè°ƒç”¨callbackNameå¯¹åº”çš„å‡½æ•°ä¸­æ‰§è¡Œsuccess(ä¸ºä»€ä¹ˆä¸ç›´æ¥æ‰§è¡Œsuccessæ˜¯å› ä¸ºï¼Œéœ€è¦åœ¨callbackNameå¯¹åº”çš„å‡½æ•°ä¸­åšä¸€äº›å…¶ä»–æ“ä½œï¼Œå¦‚åˆ é™¤scriptã€æ¸…é™¤å®šæ—¶å™¨) console.log(resp); &#125;, error: function() &#123; // è¯·æ±‚å‡ºé”™æ—¶ï¼Œä¼šç›´æ¥è°ƒç”¨ throw new Error('è¯·æ±‚å‡ºé”™!'); &#125;, &#125;; function jsonp(options) &#123; var settings = Object.assign(&#123;&#125;, configs, options); if (!settings.url) &#123; throw new Error('urlå¿…é¡»ä¼ å…¥'); return; &#125; var params = ''; // æ ¼å¼åŒ–å‚æ•° if (settings.data) &#123; settings.data[settings.callbackKey] = settings.callbackName; params = formatParams(settings.data); &#125; var timer = null; // è¶…æ—¶å¤„ç† if (settings.timeout) &#123; timer = setTimeout(function() &#123; win[settings.callbackName] = null; oHead.removeChild(oScript); settings.error &amp;&amp; settings.error.call(null); &#125;, settings.timeout); &#125; // åˆ›å»ºä¸€ä¸ªå…¨å±€å›è°ƒå‡½æ•°ï¼Œç­‰å¾…jsonpè°ƒç”¨ window[settings.callbackName] = function(resp) &#123; oHead.removeChild(oScript); if (timer) &#123; clearTimeout(timer); &#125; window[settings.callbackName] = null; settings.success &amp;&amp; settings.success.call(null, resp); &#125;; // åˆ›å»ºscriptå¹¶è¿½åŠ åˆ°é¡µé¢ä¸Š var oHead = document.querySelector('head'); var oScript = document.createElement('script'); var hasQuestionMark = settings.url.indexOf('?') &lt; 0 ? false : true; var src = ''; if (hasQuestionMark) &#123; src = settings.url + params; &#125; else &#123; src = settings.url + '?' + params; &#125; oScript.src = src; oHead.appendChild(oScript); &#125; return jsonp;&#125;)); vueä¸­å¯ä»¥ä½¿ç”¨webmodules/jsonpæ¨¡å—(githubä¸‹è½½)æ¥å®ç°jsonpè¯·æ±‚ é»˜è®¤æ˜¯ä½¿ç”¨å›è°ƒå‡½æ•°çš„å½¢å¼ æ”¹é€ æˆpromiseå½¢å¼1234567891011121314151617181920212223242526import originJsonp from 'jsonp'; // å¯¼å…¥åŸæ¥å›è°ƒå½¢å¼çš„jsonpexport default function jsonp(url, data, option) &#123; url += (url.indexOf('?') &lt; 0 ? '?' : '&amp;') + param(data); return new Promise((resolve, reject) =&gt; &#123;// è¿”å›ä¸€ä¸ªpromiseå®ä¾‹ï¼Œä¾›åé¢ä½¿ç”¨thenæ–¹æ³• originJsonp(url, option, (err, data) =&gt; &#123; if (!err) &#123; resolve(data); &#125; else &#123; reject(err); &#125; &#125;); &#125;);&#125;function param(data) &#123;// æ ¼å¼åŒ–å‚æ•° let url = ''; for (var k in data) &#123; let value = data[k] !== undefined ? data[k] : ''; url += `&amp;$&#123;k&#125;=$&#123;encodeURIComponent(value)&#125;`; &#125; return url ? url.substring(1) : '';&#125; ç»„ä»¶ä½•æ—¶æ‹‰å–æ•°æ®ï¼Ÿ ç»„ä»¶æ‹‰å–åå°æ•°æ®ä¸€èˆ¬æ”¾åœ¨createdé’©å­ä¸­ï¼Œå¹¶å°†è·å–æ•°æ®å°è£…æˆä¸€ä¸ªmethods12345678910111213141516171819202122232425import &#123;getRecommend,getDiscList&#125; from 'api/recommend'; // å¯¼å…¥å®é™…æ‹‰å–æ•°æ®çš„æ–¹æ³•import &#123;ERR_OK&#125; from 'api/config';// ä¸ºä¿è¯è¯­ä¹‰åŒ–ï¼Œå¯ä»¥å°†ä¸€äº›å¸¸è§çŠ¶æ€å®šä¹‰ä¸ºå¸¸é‡export default&#123; created()&#123; this._getRecommend(); this._getDiscList(); &#125;, methods:&#123; _getRecommend()&#123; getRecommend().then((res)=&gt;&#123; if(res.code===ERR_OK)&#123; this.recommends=res.data.slider; &#125; &#125;); &#125;, _getDiscList()&#123; getDiscList().then((res)=&gt;&#123; if(res.code===ERR_OK)&#123; this.discList=res.data.list; &#125; &#125;); &#125;, &#125;&#125;; å°è£…è½®æ’­ç»„ä»¶ åº•å±‚ä½¿ç”¨better-scrollå®ç° åŸºæœ¬åŸç†:å¤–éƒ¨ä¸€ä¸ªå›ºå®šå°ºå¯¸çš„å®¹å™¨(å°ºå¯¸better-scrollä¼šè‡ªåŠ¨è®¾ç½®)ï¼Œå†…éƒ¨æœ‰ä¸€ä¸ªè¶…å‡ºå°ºå¯¸çš„å†…å®¹;åŠ¨æ€è®¾ç½®å†…å®¹çš„transformï¼› ä¸‹é¢çš„slideæ˜¯å®¹å™¨ï¼ŒsliderGroupæ˜¯å†…å®¹123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136&lt;template&gt; &lt;div class="slider" ref="slider"&gt; &lt;div class="slider-group" ref="sliderGroup"&gt; &lt;slot&gt; &lt;/slot&gt; &lt;/div&gt; &lt;div class="dots"&gt; &lt;span v-for="(item,index) in dots" class="dot" :class="&#123;active:index===currentPageIndex&#125;"&gt;&lt;/span&gt; &lt;/div&gt; &lt;/div&gt;&lt;/template&gt;&lt;script type="text/ecmascript-6"&gt; import BScroll from 'better-scroll'; import &#123;addClass&#125; from 'common/js/dom'; export default &#123; data()&#123; return &#123; dots:[], currentPageIndex:0,// æŒ‡ç¤ºå½“å‰dots &#125;; &#125;, props:&#123; loop:&#123; type:Boolean, default:true, &#125;, autoPlay:&#123; type:Boolean, default:true, &#125;, interval:&#123; type:Number, default:4000 &#125; &#125;, mounted()&#123; // DOMå‡†å¤‡å¥½æ—¶ï¼Œåˆå§‹åŒ–ï¼›å¯ä»¥ç”¨this.$nextTick(),æ›´æ¨èç”¨setTimeout(()=&gt;&#123;&#125;,20); setTimeout(()=&gt;&#123; this._setSliderWidth(); this._initDots(); this._initSlider(); if(this.autoPlay)&#123; this._play(); &#125; &#125;,20); window.addEventListener('resize',()=&gt;&#123; if(!this.slider)&#123; return ; &#125; this._setSliderWidth(true); this.slider.refresh(); &#125;); &#125;, destoryed()&#123; // ç»„ä»¶åˆ‡æ¢åï¼Œåº”è¯¥åœæ­¢timer clearTimeout(this.timer); &#125;, methods:&#123; _setSliderWidth(isResize)&#123; this.children=this.$refs.sliderGroup.children; let width=0; let sliderWidth=this.$refs.slider.clientWidth; for(let i=0;i&lt;this.children.length;i++)&#123; let child =this.children[i]; // æˆ‘ä»¬ä¸åº”è¯¥è¦æ±‚ä¼ å…¥çš„slotæ˜¯ç‰¹å®šæ ·å¼çš„ï¼Œåº”è¯¥æˆ‘ä»¬ä¸»åŠ¨æ·»åŠ æ ·å¼ï¼Œè¿™æ ·å¯ä»¥é™ä½å’Œå¤–éƒ¨çš„è€¦åˆ addClass(child,'slider-item'); child.style.width=sliderWidth+'px'; width+=sliderWidth; &#125; // å› ä¸ºbetter-scrollåœ¨å¾ªç¯æ—¶ï¼Œä¼šåœ¨å‰åè‡ªåŠ¨å¤åˆ¶ä¸€ä¸ªï¼Œæ‰€ä»¥æ€»å®½åº¦éœ€è¦åŠ 2 if(this.loop &amp;&amp; !isResize)&#123; width+=2*sliderWidth; &#125; // è®¾ç½®å†…å®¹çš„å®½åº¦ this.$refs.sliderGroup.style.width=width + 'px'; &#125;, _initDots()&#123; // dotsä¸ºä¸€ä¸ªåªæœ‰é•¿åº¦çš„ç©ºæ•°ç»„ï¼Œæ–¹ä¾¿æ¸²æŸ“dots // this.childrenåœ¨_setSliderWidthä¸­å·²ç»å£°æ˜ this.dots=new Array(this.children.length); &#125;, _initSlider()&#123; this.slider=new BScroll(this.$refs.slider,&#123; scrollX: true,// æ¨ªå‘æ»šåŠ¨ scrollY: false, momentum: false,// åŠ¨é‡åŠ¨ç”» snap: &#123; loop: true,// å¾ªç¯ threshold: 0.1, speed:400 &#125;, &#125;); // ç›‘å¬better-scrollæ´¾å‘çš„scrollEndäº‹ä»¶ï¼Œæ›´æ–°currentPageIndex this.slider.on('scrollEnd',()=&gt;&#123; let pageIndex=this.slider.getCurrentPage().pageX; // å¾ªç¯æ’­æ”¾ä¼šåœ¨å¤´å°¾å¤åˆ¶ä¸€ä¸ªï¼Œæ‰€ä»¥indexéœ€è¦-1 if(this.loop)&#123; pageIndex-=1; &#125; this.currentPageIndex=pageIndex; if(this.autoPlay)&#123; clearTimeout(this.timer); this._play(); &#125; &#125;); &#125;, _play()&#123; // è¦æ»šåŠ¨åˆ°çš„ç´¢å¼•å€¼ let pageIndex=this.currentPageIndex+1; // å¾ªç¯ï¼Œå› ä¸ºå­˜åœ¨å¤´å°¾å¤åˆ¶ï¼Œæ‰€ä»¥éœ€è¦å†+1 if(this.loop)&#123; pageIndex+=1; &#125; this.timer=setTimeout(()=&gt;&#123; // æ¨ªå‘æ»šåŠ¨åˆ°pageIndexé¡µ this.slider.goToPage(pageIndex,0,400); &#125;,this.interval); &#125;, &#125; &#125;&lt;/script&gt; keep-alive ç”¨æ¥ç¼“å­˜ä¸æ´»åŠ¨çš„ç»„ä»¶ 123&lt;keep-alive&gt; &lt;router-view&gt;&lt;/router-view&gt;&lt;/keep-alive&gt; å’Œtransitionç»„ä»¶ä½¿ç”¨æ—¶ï¼Œè¦æ”¾åœ¨transitionå†…éƒ¨ 12345&lt;transition&gt; &lt;keep-alive&gt; &lt;router-view&gt;&lt;/router-view&gt; &lt;/keep-alive&gt;&lt;/transition&gt; åç«¯æ¥å£ä»£ç† æœ‰äº›æ¥å£ä¼šåœ¨è¯·æ±‚æ—¶é…ç½®è¯·æ±‚å¤´çš„Hostå’ŒRefereræ¥é™åˆ¶éšæ„è®¿é—®ï¼Œçº¯å‰ç«¯æ— æ³•ç›´æ¥ç»•è¿‡ã€‚ å› ä¸ºvue-cliä½¿ç”¨çš„expressæ¡†æ¶ï¼Œå¯ä»¥å€ŸåŠ©expressæ¡†æ¶çš„Routeræ¥å®ç°åç«¯æ¥å£åå‘ä»£ç†å·¥ä½œ æ­£åå‘ä»£ç† æ­£å‘ä»£ç† ä»£ç†äººä»£ç†çš„æ˜¯å®¢æˆ·ç«¯(VPN)ï¼Œä»£ç†äººå……å½“çš„æ˜¯å®¢æˆ·ç«¯ï¼Œè´Ÿè´£æ¥å—æœåŠ¡å™¨ä¼ æ¥çš„æ•°æ® åå‘ä»£ç† ä»£ç†äººä»£ç†çš„æ˜¯æœåŠ¡ç«¯(è´Ÿè½½å‡è¡¡,å…¶å®å°±æ˜¯æœåŠ¡å™¨å†…å®¹åˆ†å‘)ï¼Œä»£ç†äººå……å½“çš„æ˜¯æœåŠ¡ç«¯ï¼Œæä¾›æ•°æ®ç»™å‰å° ä¸ºä½•åå‘ä»£ç†å¯ä»¥å®ç°è·¨åŸŸè¯·æ±‚ åŒæºç­–ç•¥æ˜¯æµè§ˆå™¨çš„å®‰å…¨ç­–ç•¥ï¼Œä¸æ˜¯HTTPåè®®çš„ä¸€éƒ¨åˆ†ã€‚æœåŠ¡å™¨ç«¯è°ƒç”¨HTTPæ¥å£åªæ˜¯ä½¿ç”¨HTTPåè®®ï¼Œä¸ä¼šæ‰§è¡ŒJSè„šæœ¬ï¼Œä¸éœ€è¦åŒæºç­–ç•¥ï¼Œä¹Ÿå°±æ²¡æœ‰è·¨è¶Šé—®é¢˜ã€‚ é€šä¿—æ˜“æ‡‚è§£é‡Šå¯å‚è€ƒ https://www.aliyun.com/jiaocheng/21099.html http://blog.csdn.net/zhanghanboke/article/details/77488894123456789101112131415161718192021const app = express()const apiRoutes = express.Router();apiRoutes.get('/getDiscList', function (req, res) &#123; var url = 'https://c.y.qq.com/splcloud/fcgi-bin/fcg_get_diss_by_tag.fcg' axios.get(url, &#123; headers: &#123; // é…ç½®referã€host referer: 'https://c.y.qq.com/', host: 'c.y.qq.com' &#125;, params: req.query &#125;).then((response) =&gt; &#123; res.json(response.data) &#125;).catch((e) =&gt; &#123; console.log(e) &#125;)&#125;);app.use('/api', apiRoutes); // æ‰€æœ‰/apiä¸‹çš„è¯·æ±‚éƒ½ä¼šç”±åå°å‘é€ç»™è¿œç¨‹æœåŠ¡å™¨ï¼ŒæˆåŠŸåè¿”å›æ•°æ®ç»™åå°ï¼Œåå°å†ä¼ ç»™å‰å°(ä»£ç†äººå……å½“äº†è¿œç¨‹æœåŠ¡å™¨çš„è§’è‰²ï¼Œè´Ÿè´£æä¾›æ•°æ®ç»™å‰å°) å°è£…scrollç»„ä»¶ åº•å±‚ä½¿ç”¨better-scroll æ³¨æ„:better-scrollçš„å¯æ»šåŠ¨è·ç¦»æ˜¯è‡ªåŠ¨è®¡ç®—rçš„ï¼Œæ‰€ä»¥åˆå§‹åŒ–ä¸€å®šè¦åœ¨DOMæ¸²æŸ“å¥½å 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103&lt;template&gt; &lt;div ref="wrapper"&gt; &lt;slot&gt;&lt;/slot&gt; &lt;/div&gt;&lt;/template&gt;&lt;script type="text/ecmascript-6"&gt; import BScroll from 'better-scroll' export default&#123; props: &#123; // å¦‚ä½•æ´¾å‘scrolläº‹ä»¶(0é»˜è®¤å€¼ï¼Œä¸æ´¾å‘ï¼›1å±å¹•æ»‘åŠ¨è¶…è¿‡ä¸€å®šæ—¶é—´åæ´¾å‘ï¼›2å®æ—¶æ´¾å‘ï¼›3å®æ—¶æ´¾å‘ï¼Œè€Œä¸”åœ¨ç¼“åŠ¨æ—¶ä¹Ÿæ´¾å‘) probeType: &#123; type: Number, default:1 &#125;, // æ˜¯å¦ä¸»åŠ¨æ´¾å‘ç‚¹å‡»äº‹ä»¶ click: &#123; type: Boolean, default: true &#125;, // åœ¨ä½ç‰ˆæœ¬çš„better-scrollä¸­éœ€è¦æ‰‹åŠ¨ç›‘å¬æ•°æ®çš„å˜åŒ–å¹¶é‡æ–°åˆå§‹åŒ–ç»„ä»¶ï¼Œä½†é«˜ç‰ˆæœ¬çš„å·²ç»ä¸éœ€è¦æ‰‹åŠ¨ç›‘å¬dataäº† data: &#123; type: Array, default: null &#125;, // æ˜¯å¦ç›‘å¬æ»šåŠ¨ listenScroll:&#123; type:Boolean, default:false &#125;, // æ˜¯å¦æ´¾å‘æ»šåŠ¨åˆ°åº•éƒ¨äº‹ä»¶ pullup:&#123; type:Boolean, default:false &#125;, // æ˜¯å¦æ´¾å‘beforeScrolläº‹ä»¶ beforeScroll:&#123; type:Boolean, default:false &#125; &#125;, mounted() &#123; // DOMå‡†å¤‡å¥½æ—¶åˆå§‹åŒ–ç»„ä»¶ setTimeout(()=&gt; &#123; this._initScroll(); &#125;, 20) &#125;, methods: &#123; _initScroll()&#123; if (!this.$refs.wrapper) &#123; return; &#125; // åˆ›å»ºä¸€ä¸ªscroll this.scroll = new BScroll(this.$refs.wrapper, &#123; probeType: this.probeType, click: this.click &#125;); // æ´¾å‘æ»šåŠ¨äº‹ä»¶ if (this.listenScroll) &#123; let me = this; this.scroll.on('scroll', (pos) =&gt; &#123; me.$emit('scroll', pos); &#125;); &#125; // æ´¾å‘æ»šåŠ¨åˆ°åº•éƒ¨äº‹ä»¶ if(this.pullup)&#123; this.scroll.on('scrollEnd',()=&gt;&#123; if(this.scroll.y&lt;=(this.scroll.maxScrollY+50))&#123; this.$emit('scrollToEnd'); &#125; &#125;); &#125; // æ´¾å‘beforeScrolläº‹ä»¶ if(this.beforeScroll)&#123; this.scroll.on('beforeScrollStart',()=&gt;&#123; this.$emit('beforeScroll'); &#125;); &#125; &#125;, // ä»£ç†å¹¶æš´éœ²ä¸€äº›å¸¸ç”¨æ¥å£ enable()&#123; this.scroll &amp;&amp; this.enable(); &#125;, disable()&#123; this.scroll &amp;&amp; this.disable(); &#125;, refresh()&#123; console.log('refresh'); this.scroll &amp;&amp; this.scroll.refresh(); &#125;, scrollTo()&#123; this.scroll&amp;&amp;this.scroll.scrollTo.apply(this.scroll,arguments); &#125;, scrollToElement()&#123; this.scroll&amp;&amp;this.scroll.scrollToElement.apply(this.scroll,arguments); &#125; &#125; &#125;&lt;/script&gt; æ³¨æ„:fastclickä¼šæ‹¦æˆªclickäº‹ä»¶ï¼Œå¦‚æœä¸€ä¸ªç»„ä»¶å†…éƒ¨éœ€è¦ç›‘å¬clickäº‹ä»¶æ—¶ï¼Œå¯åœ¨å¯¹åº”DOMèŠ‚ç‚¹ä¸Šæ·»åŠ needsclickæ ·å¼ç±»å‘Šè¯‰fastclickä¸æ‹¦æˆªæ­¤DOMçš„clickäº‹ä»¶ lazy-load å¯ä»¥ä½¿ç”¨vue-lazyloadå®ç°1234567891011// main.jsimport VueLazyLoad from 'vue-lazyload';Vue.use(VueLazyLoad,&#123; loading:require('common/image/default.png')&#125;);// ä½¿ç”¨æ—¶ &lt;div class="icon"&gt; &lt;img v-lazy="item.imgurl" alt="" width="60" height="60"&gt;&lt;/div&gt; loadingç»„ä»¶123456789101112131415161718192021222324252627&lt;template&gt; &lt;div class="loading"&gt; &lt;img width="24" height="24" src="./loading.gif"&gt; &lt;p class="desc"&gt;&#123;&#123;title&#125;&#125;&lt;/p&gt; &lt;/div&gt;&lt;/template&gt;&lt;script type="text/ecmascript-6"&gt; export default &#123; props: &#123; title: &#123; type: String, default: 'æ­£åœ¨è½½å…¥...' &#125; &#125; &#125;&lt;/script&gt;&lt;style scoped lang="stylus" rel="stylesheet/stylus"&gt; @import "~common/stylus/variable" .loading width: 100% text-align: center .desc line-height: 20px font-size: $font-size-small color: $color-text-l&lt;/style&gt; vuex1234567891011121314151617181920const store = new Vuex.Store(&#123; state: &#123; // éœ€è¦å…¨å±€å…±äº«çš„æ•°æ® count: 1 &#125;, mutations: &#123; // æ³¨å†Œä¸€ä¸ªincrement mutations increment (state,payload) &#123; // å˜æ›´çŠ¶æ€ state.count += payload.amount &#125; &#125;, actions: &#123; incrementAsync (context,payload) &#123; setTimeout(() =&gt; &#123; context.commit('increment') &#125;, 1000) &#125; &#125;&#125;) states éœ€è¦å…¨å±€å…±äº«çš„æ•°æ® getters ç±»ä¼¼è®¡ç®—å±æ€§ï¼Œå¯ä»¥ç”¨æ¥è®¿é—®åŸºäºstateæ´¾ç”Ÿå‡ºçš„ä¸€äº›stateï¼Œä¸»è¦ç”¨æ¥è®¿é—®states mutations å¾ˆç±»ä¼¼äº‹ä»¶ï¼Œåªèƒ½é€šè¿‡æäº¤mutationsæ¥æ”¹å˜state(æ–¹ä¾¿å¼€å‘å·¥å…·è·Ÿè¸ª)ï¼Œä¸»è¦ç”¨æ¥è®¾ç½®states æäº¤mutaionsæ˜¯æ”¹å˜stateçš„å”¯ä¸€æ–¹å¼ åªèƒ½æ˜¯åŒæ­¥ä»»åŠ¡ï¼Œå¼‚æ­¥ä»»åŠ¡éœ€è¦actionsæ¥å®Œæˆ æ¯ä¸€ä¸ªmutationï¼Œstoreä¼šä¼ å…¥stateå’Œå¯é€‰çš„payload commit ç”¨æ¥æäº¤mutaions å¯ä»¥ä¼ é€’é¢å¤–çš„å‚æ•°payloadç»™mutaions123store.commit('increment', &#123; amount: 10&#125;) actions ä¸»è¦ç”¨æ¥å®Œæˆå¼‚æ­¥ä»»åŠ¡;éœ€è¦è¯·æ±‚åå°çš„ä»»åŠ¡å…¨éƒ¨æ”¾åœ¨actionsä¸­ actionä¸ä¼šç›´æ¥å˜æ›´çŠ¶æ€ï¼Œè€Œæ˜¯é€šè¿‡æäº¤mutationæ¥æ”¹å˜stateï¼Œ æ¯ä¸ªactionï¼Œstoreä¼šä¼ å…¥ä¸€ä¸ªcontextå’Œå¯é€‰çš„payloadï¼ŒcontextåŒ…å«storeå®ä¾‹çš„æ‰€æœ‰æ–¹æ³•å’Œå±æ€§ã€‚å› æ­¤ä½ å¯ä»¥è°ƒç”¨ context.commit æäº¤ä¸€ä¸ª mutationï¼Œæˆ–è€…é€šè¿‡ context.state å’Œ context.getters æ¥è·å– state å’Œ getters dispatch ç”¨æ¥åˆ†å‘(æäº¤)action å¯ä»¥ä¼ é€’é¢å¤–çš„å‚æ•°(payload)ç»™actions123store.dispatch('incrementAsync', &#123; amount: 10&#125;) è¾…åŠ©å‡½æ•° 123456789101112131415161718192021222324252627282930313233343536// mapStateã€mapGettersã€mapMutationsã€mapActionsï¼Œéƒ½æ˜¯è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨æ‰©å±•é¢„ç®—ç¬¦è§£æå‡ºæ¥new Vue(&#123; el:'#app', store, computed: &#123; localComputed () &#123;&#125;, // ä½¿ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦å°†æ­¤å¯¹è±¡æ··å…¥åˆ°å¤–éƒ¨å¯¹è±¡ä¸­ ...mapState([ count,// å°†this.count æ˜ å°„ä¸º store.state.count ]), ...mapGetters([ 'doneTodosCount',// å°†this.doneTodosCount æ˜ å°„ä¸º store.getters.doneTodosCount 'anotherGetter',// å°†this.anotherGetter æ˜ å°„ä¸º store.getters.anotherGetter ]) &#125;, methods: &#123; ...mapMutations([ 'increment', // å°† `this.increment()` æ˜ å°„ä¸º `this.$store.commit('increment')` // `mapMutations` ä¹Ÿæ”¯æŒè½½è·ï¼š 'incrementBy' // å°† `this.incrementBy(amount)` æ˜ å°„ä¸º `this.$store.commit('incrementBy', amount)` ]), ...mapMutations(&#123; add: 'SET_INCREMENT' // å°† `this.add()` æ˜ å°„ä¸º `this.$store.commit('SET_INCREMENT')` &#125;), ...mapActions([ 'increment', // å°† `this.increment()` æ˜ å°„ä¸º `this.$store.dispatch('increment')` // `mapActions` ä¹Ÿæ”¯æŒè½½è·ï¼š 'incrementBy' // å°† `this.incrementBy(amount)` æ˜ å°„ä¸º `this.$store.dispatch('incrementBy', amount)` ]), ...mapActions(&#123; add: 'increment' // å°† `this.add()` æ˜ å°„ä¸º `this.$store.dispatch('increment')` &#125;) &#125;&#125;); å®é™…é¡¹ç›®ç›®å½• 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313|---store/ actions.js // ä¿å­˜æ‰€æœ‰å¼‚æ­¥ä»»åŠ¡ getters.js // ä¿å­˜æ‰€æœ‰getters index.js // å¯¼å…¥stateã€getter...æ¥å®ä¾‹åŒ–vuex mutations-type.js // ä¿å­˜æ‰€æœ‰mutationsç±»å‹ mutations.js // å®é™…çš„mutationå‡½æ•° state.js // æ‰€æœ‰éœ€è¦å…±äº«çš„æ•°æ®// state.js// é¦–å…ˆç¡®å®šå“ªäº›æ•°æ®éœ€è¦vuexæ¥ç®¡ç†ï¼Œå¹¶ç»™å®šé»˜è®¤å€¼import &#123;playMode&#125; from 'common/js/config'import &#123;loadSearch,loadPlay,loadFavorite&#125; from 'common/js/cache'// stateåªæ”¾ä¸€äº›åŸºç¡€æ•°æ®ï¼Œæ´¾ç”Ÿçš„æ•°æ®å¯æ”¾åœ¨getterä¸­ï¼Œå¦‚currentSongå¯é€šè¿‡palyListå’ŒcurrentIndexè®¡ç®—è€Œæ¥const state = &#123; singer: &#123;&#125;, playing: false, fullScreen: false, playlist: [], sequenceList: [], mode: playMode.sequence, currentIndex: -1, disc:&#123;&#125;, topList:&#123;&#125;, searchHistory:loadSearch(), playHistory:loadPlay(), favoriteList:loadFavorite(),&#125;;export default state;// å¯¼å‡ºstateå¯¹è±¡// mutation-types.js// ç¡®å®šé’ˆå¯¹stateçš„ä¿®æ”¹export const SET_SINGER = 'SET_SINGER'export const SET_PLAYING_STATE = 'SET_PLAYING_STATE'export const SET_FULL_SCREEN = 'SET_FULL_SCREEN'export const SET_PLAYLIST = 'SET_PLAYLIST'export const SET_SEQUENCE_LIST = 'SET_SEQUENCE_LIST'export const SET_PLAY_MODE = 'SET_PLAY_MODE'export const SET_CURRENT_INDEX = 'SET_CURRENT_INDEX'export const SET_DISC = 'SET_DISC'export const SET_TOP_LIST = 'SET_TOP_LIST'export const SET_SEARCH_HISTORY = 'SET_SEARCH_HISTORY'export const SET_PLAY_HISTORY = 'SET_PLAY_HISTORY'export const SET_FAVORITE_LIST = 'SET_FAVORITE_LIST'// mutations.js// æ ¹æ®mutaion-typesç¼–å†™å…·ä½“çš„mutationæ¥è®¾ç½®stateimport * as types from './mutation-types'const mutations = &#123; [types.SET_SINGER](state, singer) &#123; state.singer = singer &#125;, [types.SET_PLAYING_STATE](state, flag) &#123; state.playing = flag &#125;, [types.SET_FULL_SCREEN](state, flag) &#123; state.fullScreen = flag &#125;, [types.SET_PLAYLIST](state, list) &#123; state.playlist = list &#125;, [types.SET_SEQUENCE_LIST](state, list) &#123; state.sequenceList = list &#125;, [types.SET_PLAY_MODE](state, mode) &#123; state.mode = mode &#125;, [types.SET_CURRENT_INDEX](state, index) &#123; state.currentIndex = index &#125;, [types.SET_DISC](state, disc) &#123; state.disc = disc &#125;, [types.SET_TOP_LIST](state, topList) &#123; state.topList = topList &#125;, [types.SET_SEARCH_HISTORY](state, history) &#123; state.searchHistory = history &#125;, [types.SET_PLAY_HISTORY](state, history) &#123; state.playHistory = history &#125;, [types.SET_FAVORITE_LIST](state, list) &#123; state.favoriteList = list &#125;,&#125;export default mutations; // å¯¼å‡ºmutationså¯¹è±¡// getters.js// ç¼–å†™getteræ¥è¯»å–stateexport const singer = state =&gt; state.singerexport const playing = state=&gt;state.playingexport const fullScreen = state=&gt;state.fullScreenexport const playlist = state=&gt;state.playlistexport const sequenceList = state=&gt;state.sequenceListexport const mode = state=&gt;state.modeexport const currentIndex = state=&gt;state.currentIndex// é€šè¿‡playlistã€currentIndexè®¡ç®—è€Œæ¥export const currentSong = (state)=&gt; &#123; return state.playlist[state.currentIndex] || &#123;&#125;;&#125;export const disc = state=&gt;state.discexport const topList = state=&gt;state.topListexport const searchHistory = state=&gt;state.searchHistoryexport const playHistory = state=&gt;state.playHistoryexport const favoriteList = state=&gt;state.favoriteList// actions.js// å¼‚æ­¥æ“ä½œimport * as types from './mutation-types'import &#123; playMode &#125; from 'common/js/config'import &#123; shuffle &#125; from 'common/js/util'import &#123; saveSearch, deleteSearch, clearSearch, savePlay, saveFavorite, deleteFavorite &#125; from 'common/js/cache'function findIndex(list, song) &#123; return list.findIndex((item) =&gt; &#123; return item.id === song.id; &#125;)&#125;export const selectPlay = function(&#123; commit, state &#125;, &#123; list, index &#125;) &#123; commit(types.SET_SEQUENCE_LIST, list); if (state.mode === playMode.random) &#123; let randomList = shuffle(list); commit(types.SET_PLAYLIST, randomList); index = findIndex(randomList, list[index]); &#125; else &#123; commit(types.SET_PLAYLIST, list); &#125; commit(types.SET_CURRENT_INDEX, index); commit(types.SET_FULL_SCREEN, true); commit(types.SET_PLAYING_STATE, true);&#125;;export const randomPlay = function(&#123; commit &#125;, &#123; list &#125;) &#123; commit(types.SET_PLAY_MODE, playMode.random); commit(types.SET_SEQUENCE_LIST, list); let randomList = shuffle(list); commit(types.SET_PLAYLIST, randomList); commit(types.SET_CURRENT_INDEX, 0); commit(types.SET_FULL_SCREEN, true); commit(types.SET_PLAYING_STATE, true);&#125;;export const insertSong = function(&#123; commit, state &#125;, song) &#123; let playlist = state.playlist.slice(); let sequenceList = state.sequenceList.slice(); let currentIndex = state.currentIndex; // è®°å½•å½“å‰æ­Œæ›² let currentSong = playlist[currentIndex]; // ä¿®æ”¹playlist // æŸ¥è¯¢å½“å‰åˆ—è¡¨ä¸­æ˜¯å¦æœ‰å¾…æ’å…¥çš„æ­Œæ›²å¹¶è¿”å›å…¶ç´¢å¼• let fpIndex = findIndex(playlist, song); // å› ä¸ºæ˜¯æ’å…¥æ­Œæ›²ï¼Œæ‰€ä»¥ç´¢å¼•è¦+1 currentIndex++; // æ’å…¥è¿™é¦–æ­Œå½“å½“å‰ç´¢å¼•ä½ç½® playlist.splice(currentIndex, 0, song); // å¦‚æœå·²ç»åŒ…å«è¿™é¦–æ­Œæ›² if (fpIndex &gt; -1) &#123; // å¦‚æœå½“å‰æ’å…¥çš„ç´¢å¼•å¤§äºåˆ—è¡¨ä¸­çš„åºå· if (currentIndex &gt; fpIndex) &#123; playlist.splice(fpIndex, 1); currentIndex--; &#125; else &#123; playlist.splice(fpIndex + 1, 1); &#125; &#125; // ä¿®æ”¹sequenceList let currentSIndex = findIndex(sequenceList, currentSong) + 1; let fsIndex = findIndex(sequenceList, song); sequenceList.splice(currentSIndex, 0, song); if (fsIndex &gt; -1) &#123; if (currentSIndex &gt; fsIndex) &#123; sequenceList.splice(fsIndex, 1); &#125; else &#123; sequenceList.splice(fsIndex + 1, 1); &#125; &#125; commit(types.SET_PLAYLIST, playlist); commit(types.SET_SEQUENCE_LIST, sequenceList); commit(types.SET_CURRENT_INDEX, currentIndex); commit(types.SET_FULL_SCREEN, true); commit(types.SET_PLAYING_STATE, true);&#125;;export const saveSearchHistory = function(&#123; commit &#125;, query) &#123; commit(types.SET_SEARCH_HISTORY, saveSearch(query));&#125;;export const deleteSearchHistory = function(&#123; commit &#125;, query) &#123; commit(types.SET_SEARCH_HISTORY, deleteSearch(query));&#125;;export const clearSearchHistory = function(&#123; commit &#125;) &#123; commit(types.SET_SEARCH_HISTORY, clearSearch());&#125;;export const deleteSong = function(&#123; commit, state &#125;, song) &#123; let playlist = state.playlist.slice() let sequenceList = state.sequenceList.slice() let currentIndex = state.currentIndex let pIndex = findIndex(playlist, song) playlist.splice(pIndex, 1) let sIndex = findIndex(sequenceList, song) sequenceList.splice(sIndex, 1) if (currentIndex &gt; pIndex || currentIndex === playlist.length) &#123; currentIndex-- &#125; commit(types.SET_PLAYLIST, playlist) commit(types.SET_SEQUENCE_LIST, sequenceList) commit(types.SET_CURRENT_INDEX, currentIndex) if (!playlist.length) &#123; commit(types.SET_PLAYING_STATE, false) &#125; else &#123; commit(types.SET_PLAYING_STATE, true) &#125;&#125;export const deleteSongList = function(&#123; commit &#125;) &#123; commit(types.SET_CURRENT_INDEX, -1) commit(types.SET_PLAYLIST, []) commit(types.SET_SEQUENCE_LIST, []) commit(types.SET_PLAYING_STATE, false)&#125;export const savePlayHistory = function(&#123; commit &#125;, song) &#123; commit(types.SET_PLAY_HISTORY, savePlay(song))&#125;export const saveFavoriteList = function(&#123; commit &#125;, song) &#123; commit(types.SET_FAVORITE_LIST, saveFavorite(song))&#125;export const deleteFavoriteList = function(&#123; commit &#125;, song) &#123; commit(types.SET_FAVORITE_LIST, deleteFavorite(song))&#125;// index.js// å…¥å£æ–‡ä»¶ï¼Œå®ä¾‹åŒ–vueximport Vue from 'vue'import Vuex from 'vuex'import * as actions from './actions'import * as getters from './getters'import state from './state'import mutations from './mutations'import createLogger from 'vuex/dist/logger';// è°ƒè¯•å·¥å…·ï¼Œå¯ä»¥æ‰“å°å‡ºlogVue.use(Vuex);// vuexæ˜¯ä¸ªæ’ä»¶ï¼Œéœ€è¦useconst debug = process.env.NODE_ENV !== 'production';// å¯¼å‡ºä¸€ä¸ªstoreå®ä¾‹ï¼Œä¾›main.jsä½¿ç”¨export default new Vuex.Store(&#123; actions, getters, state, mutations, strict: debug,// strictæ¨¡å¼ä¼šé’ˆå¯¹ä¸é€šè¿‡commitæäº¤mutationæŠ¥é”™ plugins: debug ? [createLogger()] : [],// ä½¿ç”¨æ‰“å°logæ’ä»¶&#125;)// main.js// å¯¼å…¥vuexçš„stroeå®ä¾‹ï¼Œå¹¶æ³¨å…¥åˆ°vueæ ¹ç»„ä»¶ä¸­import store from './store'...new Vue(&#123; el: '#app', router, store,// å¯¼å…¥vuexçš„stroeå®ä¾‹ render: h =&gt; h(App)&#125;); js prefix12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758// common/js/dom.js// èƒ½åŠ›æ£€æµ‹ï¼Œåˆ¤æ–­æ˜¯å“ªç§å‰ç¼€let elementStyle = document.createElement('div').style;// åˆ©ç”¨IIFEå¾—åˆ°æ”¯æŒçš„å‰ç¼€let vendor = (()=&gt; &#123; // åˆ©ç”¨transformåšèƒ½åŠ›æ£€æµ‹ï¼Œæ¥åˆ¤æ–­æ”¯æŒå“ªç§å‰ç¼€ let transformNames = &#123; webkit: 'webkitTransform', Moz: 'MozTransform', O: 'OTransform', ms: 'msTransform', standard: 'transform' &#125;; for (let key in transformNames) &#123; // æ”¯æŒæŸç§å‰ç¼€åˆ™ç›´æ¥è¿”å› if (elementStyle[transformNames[key]] !== undefined) &#123; return key; &#125; &#125; // å¦‚æœæ²¡æœ‰åŒ¹é…ï¼Œåˆ™è¿”å›false return false;&#125;)();// æ·»åŠ å‰ç¼€export function prefixStyle(style) &#123; if (vendor === false) &#123; return false; &#125; // æ”¯æŒæ ‡å‡†ï¼Œåˆ™ç›´æ¥è¿”å› if (vendor === 'standard') &#123; return style; &#125; // å¦åˆ™è¿”å›prefixåçš„å­—ç¬¦ä¸² return vendor + style.charAt(0).toUpperCase() + style.substr(1);&#125;// å®é™…è°ƒç”¨// musicList.js...import &#123;prefixStyle&#125; from 'common/js/dom';...const transform=prefixStyle('transform');const backdrop=prefixStyle('backdrop-filter');...watch:&#123; scrollY(newY)&#123; ... this.$refs.layer.style[transform]=`translate3d(0,$&#123;translateY&#125;px,0)`; ... this.$refs.filter.style[backdrop]=`blur($&#123;blur&#125;px)`; ... &#125;&#125; ç”¨jsåˆ›å»ºanimationåŠ¨ç”» ä½¿ç”¨create-keyframe-animation1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071&lt;!-- ç›‘å¬ä¸€äº›é’©å­ --&gt;&lt;transition name="normal" @enter="enter" @after-enter="afterEnter" @leave="leave" @after-leave="afterLeave"&gt;... &lt;/transition&gt;// æ ·å¼&amp;.normal-enter-active, &amp;.normal-leave-active transition: all 0.4s .top, .bottom transition: all 0.4s cubic-bezier(0.86, 0.18, 0.82, 1.32)&amp;.normal-enter, &amp;.normal-leave-to opacity: 0 .top transform: translate3d(0, -100px, 0) .bottom transform: translate3d(0, 100px, 0)// js...import animations from 'create-keyframe-animation'...methods:&#123; enter(el,done)&#123; const &#123;x,y,scale&#125;=this._getPosAndScale(); let animation=&#123; 0:&#123; transform:`translate3d($&#123;x&#125;px,$&#123;y&#125;px,0) scale($&#123;scale&#125;)`, &#125;, 60:&#123; transform:`translate3d(0,0,0) scale(1.1)`, &#125;, 100:&#123; transform:`translate3d(0,0,0) scale(1)`, &#125; &#125;; // æ³¨å†Œä¸€ä¸ªmoveåŠ¨ç”» animations.registerAnimation(&#123; name:'move', animation, presets:&#123; duration:400, easing:'linear' &#125; &#125;); // åœ¨cdWrapperä¸Šè°ƒç”¨moveåŠ¨ç”»ï¼Œç»“æŸæ—¶ä¸€å®šè¦è°ƒç”¨done animations.runAnimation(this.$refs.cdWrapper,'move',done); &#125;, afterEnter()&#123; // è¿åŠ¨ç»“æŸæ³¨é”€move animations.unregisterAnimation('move'); this.$refs.cdWrapper.style.animation = ''; &#125;, leave(el,done)&#123; // leaveåŠ¨ç”»ç”¨æ™®é€šçš„è¿‡æ¸¡åŠ¨ç”»å®ç°å³å¯ this.$refs.cdWrapper.style.transition='all .3s'; const &#123;x,y,scale&#125;=this._getPosAndScale(); this.$refs.cdWrapper.style[transform]=`translate3d($&#123;x&#125;px,$&#123;y&#125;px,0)`; // ç»“æŸæ—¶ï¼Œè°ƒç”¨done this.$refs.cdWrapper.addEventListener('transitionend',done); &#125;, afterLeave()&#123; this.$refs.cdWrapper.style.transition = '' this.$refs.cdWrapper.style[transform] = '' &#125;&#125; åˆ©ç”¨svgå®ç°åœ†å½¢è¿›åº¦ åˆ©ç”¨dasharrayé…åˆstroke-dashoffsetæ¥å®ç°è¿›åº¦123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;template&gt; &lt;div class="progress-circle"&gt; &lt;svg :width="radius" :height="radius" viewBox="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg"&gt; &lt;circle class="progress-background" r="50" cx="50" cy="50" fill="transparent"/&gt; &lt;circle class="progress-bar" r="50" cx="50" cy="50" fill="transparent" :stroke-dasharray="dashArray" :stroke-dashoffset="dashOffset"/&gt; &lt;/svg&gt; &lt;slot&gt;&lt;/slot&gt; &lt;/div&gt;&lt;/template&gt;&lt;script type="text/ecmascript-6"&gt; export default&#123; props:&#123; radius:&#123; type:Number, default:100 &#125;, percent:&#123; type:Number, default:0 &#125; &#125;, data()&#123; return &#123; dashArray:Math.PI * 100 &#125; &#125;, computed:&#123; dashOffset()&#123; return (1-this.percent)*this.dashArray &#125; &#125; &#125;&lt;/script&gt;&lt;style scoped lang="stylus" rel="stylesheet/stylus"&gt; @import "~common/stylus/variable" .progress-circle position: relative circle stroke-width: 8px transform-origin: center &amp;.progress-background transform: scale(0.9) stroke: $color-theme-d &amp;.progress-bar transform: scale(0.9) rotate(-90deg) stroke: $color-theme&lt;/style&gt; åˆ©ç”¨mixinå¤ç”¨ç»„ä»¶é€‰é¡¹ å½“ç»„ä»¶çš„é€‰é¡¹ç±»ä¼¼æ˜¯ï¼Œå¯ä»¥å°†å…¶æŠ½å–æˆä¸€ä¸ªå…¬ç”¨mixinï¼Œç„¶ååœ¨ç»„ä»¶mixinså­—æ®µä¸­å¼•å…¥å³å¯123456789101112131415161718192021222324252627282930313233343536373839// mixins.jsimport &#123;mapGetters, mapMutations, mapActions&#125; from 'vuex'...export const playlistMixin = &#123; // ä¸‹é¢å®šä¹‰çš„é€‰é¡¹å°†åœ¨ä¸åŒç»„ä»¶ä¸­å¤ç”¨ computed: &#123; ...mapGetters([ 'playlist' ]) &#125;, mounted() &#123; this.handlePlaylist(this.playlist) &#125;, activated() &#123; this.handlePlaylist(this.playlist) &#125;, watch: &#123; playlist(newVal) &#123; this.handlePlaylist(newVal) &#125; &#125;, methods: &#123; handlePlaylist() &#123; throw new Error('component must implement handlePlaylist method') &#125; &#125;&#125;;// playList.vue... import &#123;playerMixin&#125; from 'common/js/mixin'...export default &#123; mixins:[playerMixin], ...&#125; ç¼–è¯‘æ‰“åŒ… ç›´æ¥ä½¿ç”¨npm run build æ‰“åŒ…ä¼˜åŒ– è·¯ç”±æ‡’åŠ è½½ vueå®˜æ–¹æ¨èä½¿ç”¨webpackçš„ensure(è¿™æ˜¯webpack1.xç‰ˆæœ¬çš„ï¼Œ2.xæ¨èä½¿ç”¨import)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110import Vue from 'vue'import Router from 'vue-router'// import Recommend from 'components/recommend/recommend'// import Singer from 'components/singer/singer'// import Rank from 'components/rank/rank'// import Search from 'components/search/search'// import SingerDetail from 'components/singer-detail/singer-detail'// import Disc from 'components/disc/disc'// import TopList from 'components/top-list/top-list'// import UserCenter from 'components/user-center/user-center'Vue.use(Router)// ä½¿ç”¨importåŠ¨æ€åŠ è½½ç»„ä»¶ï¼Œå¹¶åœ¨æˆåŠŸåï¼Œresolveç»„ä»¶ä¼ é€’ç»™è·¯ç”±const Recommend = (resolve) =&gt; &#123; import('components/recommend/recommend').then((module) =&gt; &#123; resolve(module) &#125;)&#125;const Singer = (resolve) =&gt; &#123; import('components/singer/singer').then((module) =&gt; &#123; resolve(module) &#125;)&#125;const Rank = (resolve) =&gt; &#123; import('components/rank/rank').then((module) =&gt; &#123; resolve(module) &#125;)&#125;const Search = (resolve) =&gt; &#123; import('components/search/search').then((module) =&gt; &#123; resolve(module) &#125;)&#125;const SingerDetail = (resolve) =&gt; &#123; import('components/singer-detail/singer-detail').then((module) =&gt; &#123; resolve(module) &#125;)&#125;const Disc = (resolve) =&gt; &#123; import('components/disc/disc').then((module) =&gt; &#123; resolve(module) &#125;)&#125;const TopList = (resolve) =&gt; &#123; import('components/top-list/top-list').then((module) =&gt; &#123; resolve(module) &#125;)&#125;const UserCenter = (resolve) =&gt; &#123; import('components/user-center/user-center').then((module) =&gt; &#123; resolve(module) &#125;)&#125;export default new Router(&#123; routes: [&#123; path: '/', redirect: '/recommend' &#125;, &#123; path: '/recommend', name: 'Recommend', component: Recommend, children: [&#123; path: ':id', name: 'Disc', component: Disc &#125;] &#125;, &#123; path: '/singer', name: 'Singer', component: Singer, children: [&#123; path: ':id', name: 'SingerDetail', component: SingerDetail &#125;] &#125;, &#123; path: '/rank', name: 'Rank', component: Rank, children:[&#123; path:':id', name: 'TopList', component:TopList &#125;] &#125;, &#123; path: '/search', name: 'Search', component: Search, children: [&#123; path: ':id', name: 'SingerDetail', component: SingerDetail &#125;] &#125;,&#123; path:'/user', name:'User', component:UserCenter &#125; ]&#125;) ç§»åŠ¨ç«¯è°ƒè¯•å·¥å…·vConsole åœ¨ä»£ç å…¥å£æ–‡ä»¶main.jsä¸­å¯¼å…¥å¹¶å®ä¾‹åŒ– vconsoleæ˜¯ä¸éœ€è¦è°ƒç”¨çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ç‰¹å®šæ³¨é‡Šè§„é¿æ‰eslintæ£€æŸ¥ ä¸Šçº¿æ—¶ï¼Œè®°å¾—æ¸…é™¤æ‰vConsole123456789101112131415161718// main.js...import VConsole from 'vconsole'...// vconsoleæ˜¯ä¸éœ€è¦è°ƒç”¨çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ç‰¹å®šæ³¨é‡Šè§„é¿æ‰eslintæ£€æŸ¥/* eslint-disable no-unused-vars */var vConsole=new VConsole();console.log('test');.../* eslint-disable no-new */new Vue(&#123; el: '#app', router, store, render: h =&gt; h(App)&#125;) æŠ“åŒ…å·¥å…· winä¸Šä½¿ç”¨fiddlerå·¥å…·]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[websocket_chat]]></title>
    <url>%2F2018%2F01%2F18%2Fwebsocket-chat%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘åœ¨çœ‹webç«¯å³æ—¶é€šä¿¡æ–¹é¢ä¸œè¥¿ï¼Œç”¨nodejsç»“åˆwebsocket(socket.io)åšäº†ä¸€ä¸ªç®€å•çš„webèŠå¤©å®¤ã€‚ç‰¹åœ¨æ­¤åšä¸ªè®°å½•å®Œæ•´ä»£ç å¯ä»¥æŸ¥çœ‹(https://github.com/BryanAdamss/SourceSave/tree/master/WebSocket/ws-socketiodemo) ä½¿ç”¨NodeJsã€Socket.ioæ­å»ºä¸€ä¸ªwebèŠå¤©å®¤å‰ç½®çŸ¥è¯†Webç«¯å®ç°å³æ—¶é€šä¿¡ä¸»è¦æœ‰å››ç§æ–¹å¼ï¼šçŸ­è½®è¯¢(polling)ã€cometã€Websocketã€SSE çŸ­è½®è¯¢ å‰å°è®¾ç½®ä¸ªå®šæ—¶å™¨ä¸æ–­å‘é€è¯·æ±‚å»è¯·æ±‚åå°æ•°æ® ç¼ºç‚¹:ä¼šæœ‰å¤§é‡æ— æ•ˆè¯·æ±‚ã€æµªè´¹æœåŠ¡å™¨èµ„æºã€æœ‰å»¶è¿Ÿ Comet å…¶å®æ˜¯ä¸€ç§hackæŠ€æœ¯ï¼Œä¸»è¦æ˜¯ä¸€ç§åŸºäºhttpé•¿è¿æ¥çš„â€æœåŠ¡å™¨æ¨â€çš„æŠ€æœ¯ ä¸»è¦æœ‰ä¸¤ç§å®ç°æ–¹å¼ ajaxé•¿è½®è¯¢(long-polling) å®¢æˆ·ç«¯å‘å‡ºajaxè¯·æ±‚ï¼ŒæœåŠ¡ç«¯æ¥æ”¶åˆ°è¯·æ±‚åï¼Œä¼šé˜»å¡è¯·æ±‚ç›´åˆ°æœ‰æ•°æ®æˆ–è€…è¶…æ—¶æ‰è¿”å›ï¼Œå®¢æˆ·ç«¯åœ¨åœ¨å¤„ç†ä¿¡æ¯åå†æ¬¡å‘å‡ºè¯·æ±‚ï¼Œé‡æ–°å»ºç«‹è¿æ¥ã€‚ ä¼˜ç‚¹:ç›¸æ¯”çŸ­è½®è¯¢å‡å°‘äº†æ— æ•ˆè¯·æ±‚ã€å®æ—¶æ€§æé«˜ ç¼ºç‚¹:ä¿æŒè¿æ¥ä¹Ÿä¼šæ¶ˆè€—æœåŠ¡å™¨èµ„æº åŸºäºiframeåŠhtmlfileçš„æµæ–¹å¼ iframeçš„srcå±æ€§ä¼šä¿æŒå¯¹æŒ‡å®šæœåŠ¡å™¨çš„é•¿è¿æ¥è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯åˆ™å¯ä»¥ä¸åœåœ°è¿”å›æ•°æ® ç¼ºç‚¹:ieã€ffä¸‹ä¼šæ˜¾ç¤ºé¡µé¢æœªåŠ è½½å®Œæˆ åˆ©ç”¨htmlfileçš„ActiveXè§£å†³äº†IEä¸Šçš„åŠ è½½æ˜¾ç¤ºé—®é¢˜ WebSocket Websocketæ˜¯ä¸€ä¸ªå…¨æ–°çš„ã€ç‹¬ç«‹çš„åè®®ï¼ŒåŸºäºTCPåè®®ï¼Œä¸httpåè®®å…¼å®¹ã€‚ Websocketåœ¨å»ºç«‹è¿æ¥ä¹‹å‰æœ‰ä¸€ä¸ªHandshakeè¿‡ç¨‹ï¼Œåœ¨å…³é—­è¿æ¥å‰ä¹Ÿæœ‰ä¸€ä¸ªHandshakeè¿‡ç¨‹ï¼Œå»ºç«‹è¿æ¥ä¹‹åï¼ŒåŒæ–¹å³å¯åŒå‘é€šä¿¡ã€‚ ä¼˜ç‚¹:å…¨åŒå·¥ç›¸äº’é€šä¿¡ SSE Server-Sent Event æœåŠ¡å™¨æ¨é€äº‹ä»¶ï¼Œå…è®¸æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯æ¨é€æ–°æ•°æ®ã€‚ ä¼ ç»Ÿæƒ…å†µä¸‹æœåŠ¡ç«¯å¯ä»¥é€šè¿‡flash(Flash XMLSocket)æˆ–è€…Java Applet å¥—æ¥å£æ¥å®ç°æ¨é€ ä¸€èˆ¬è¯´websocketå’Œsseéƒ½èƒ½åšå½¼æ­¤èƒ½åšçš„äº‹æƒ…ï¼Œä¸è¿‡sseæ›´å¤šçš„æ˜¯ä¸“æ³¨æœåŠ¡ç«¯å‘å®¢æˆ·ç«¯æ¨ï¼Œå®¢æˆ·ç«¯æƒ³å‘é€æ¶ˆæ¯ç»™æœåŠ¡ç«¯å¿…é¡»é€šè¿‡ajaxæ¥å‘é€ï¼Œè€Œwebsocketè¿æ¥ä¸Šåï¼ŒåŒæ–¹å°±å¯ä»¥ç›´æ¥é€šè¿‡websocketé€šä¿¡äº†ã€‚ éœ€æ±‚ å…è®¸åŒåç™»å½• æŸ¥çœ‹åœ¨çº¿äººæ•°åŠåˆ—è¡¨ åŒºåˆ†è‡ªå·±å‘è¨€å’Œä»–äººå‘è¨€ åŠ å…¥ã€é€€å‡ºèŠå¤©å®¤æœ‰æç¤º å°½é‡å…¼å®¹ä½ç‰ˆæœ¬æµè§ˆå™¨ websocket API é€šè¿‡åˆ†æå¯¹æ¯”å‡ ç§åŠæ—¶é€šä¿¡çš„å®ç°æ–¹å¼ï¼Œå®¢æˆ·ç«¯é€‰æ‹©ä½¿ç”¨websocketæ¥å®ç°è¾ƒä¸ºç®€å•ã€‚ å¸¸ç”¨APIï¼Œå…·ä½“å¯å‚è€ƒ(https://developer.mozilla.org/zh-CN/docs/Web/API/WebSocket); 1234567891011121314151617var socket=new Socket('http://xxxx.com:port');socket.onopen=function()&#123; // è¿æ¥ä¸ŠæœåŠ¡å™¨æ—¶è§¦å‘(æ­¤æ—¶è¡¨ç¤ºå®¢æˆ·ç«¯å¯ä»¥æ¥å—å’Œå‘é€æ•°æ®)&#125;;socket.onerror=function()&#123; // å½“é”™è¯¯å‘ç”Ÿæ—¶ç”¨äºç›‘å¬erroräº‹ä»¶çš„äº‹ä»¶ç›‘å¬å™¨ã€‚ä¼šæ¥å—ä¸€ä¸ªåä¸ºâ€œerrorâ€çš„eventå¯¹è±¡ã€‚&#125;;socket.onmessage=function()&#123; // å½“æœ‰æ¶ˆæ¯åˆ°è¾¾çš„æ—¶å€™è¯¥äº‹ä»¶ä¼šè§¦å‘&#125;;socket.close();// ä¸»åŠ¨å…³é—­è¿æ¥socket.send();// å‘é€ä¿¡æ¯ç»™æœåŠ¡ç«¯ï¼Œå¯æ¥å—DOMString dataã€ArrayBuffer dataã€Blob data åˆ†æ åŸç”Ÿçš„websocketåªèƒ½æ”¯æŒIE10+ã€ç§»åŠ¨ç«¯åªèƒ½æ”¯æŒåˆ°å®‰å“4.4ï¼Œæ‰€ä»¥æœ€åé‡‡ç”¨socket.ioæ¥å®ç°ã€‚ socket.ioæ˜¯è¿è¡Œåœ¨nodeç¯å¢ƒä¸Šçš„ï¼Œå¯ä»¥å…¼é¡¾åˆ°å‰åå°ï¼Œå®ƒå¯ä»¥åšåˆ°ä¼˜é›…é™çº§ï¼Œå½“ä¸æ”¯æŒwebsocketçš„æµè§ˆå™¨ä¼šè‡ªåŠ¨ä½¿ç”¨è½®è¯¢çš„æ–¹å¼æ¥å®ç°å³æ—¶é€šä¿¡ã€‚å…·ä½“å¯å‚è€ƒ(https://socket.io/docs/); ä»£ç å®ç° å®Œæ•´ä»£ç å¯ä»¥æŸ¥çœ‹(https://github.com/BryanAdamss/SourceSave/tree/master/WebSocket/ws-socketiodemo) æœåŠ¡ç«¯ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263var express = require('express');var app = express();var path = require('path');var server = require('http').createServer(app);var io = require('socket.io')(server);var port = process.env.PORT || 3000;server.listen(port, function() &#123; console.log('æœåŠ¡å¯åŠ¨åœ¨:%d', port);&#125;);app.use(express.static(path.join(__dirname, './public')));var onlineUsers = &#123;&#125;; //åœ¨çº¿ç”¨æˆ·var onlineCount = 0; //å½“å‰åœ¨çº¿äººæ•°// ç›‘å¬ç”¨æˆ·è¿æ¥io.on('connection', function(socket) &#123; console.log('æœ‰ç”¨æˆ·è¿æ¥!'); // è¿æ¥åç›‘å¬ç›¸åº”äº‹ä»¶ // ç›‘å¬å®¢æˆ·ç«¯çš„ç™»å½•äº‹ä»¶ socket.on('login', function(obj) &#123; // ä¿å­˜è¿æ¥çš„idï¼Œé€€å‡ºæ—¶ä¼šç”¨åˆ° socket.id = obj.userId; // å°†æ–°çš„è¿æ¥åŠ å…¥åˆ°åœ¨çº¿åˆ—è¡¨ä¸­ if (!onlineUsers.hasOwnProperty(obj.userId)) &#123; onlineUsers[obj.userId] = obj.userName; onlineCount++; &#125; // å‘æ‰€æœ‰å®¢æˆ·ç«¯å¹¿æ’­æœ‰æ–°ç”¨æˆ·åŠ å…¥ï¼Œå¹¶å°†æ–°ç”¨æˆ·åŠæœ€æ–°çš„åœ¨çº¿äººæ•°å’Œåœ¨çº¿åˆ—è¡¨ä¼ è¿‡å» io.emit('newIn', &#123; onlineUsers: onlineUsers, onlineCount: onlineCount, user: obj &#125;); console.log(obj.userName + 'åŠ å…¥äº†èŠå¤©å®¤'); &#125;); // ç›‘å¬å®¢æˆ·ç«¯çš„å‘é€äº‹ä»¶ï¼Œå°†å…¶å¹¿æ’­ç»™æ‰€æœ‰ç”¨æˆ· socket.on('message', function(obj) &#123; console.log('%sè¯´äº†:%s', obj.name, obj.message); io.emit('message', obj); &#125;); // ç›‘å¬å®¢æˆ·ç«¯çš„ç¦»çº¿äº‹ä»¶ socket.on('disconnect', function() &#123; // åœ¨çº¿åˆ—è¡¨ä¸­åˆ é™¤å¯¹åº”çš„è¿æ¥ if (onlineUsers.hasOwnProperty(socket.id)) &#123; var obj = &#123; userId: socket.id, userName: onlineUsers[socket.id] &#125;; delete onlineUsers[socket.id]; onlineCount--; // å‘æ‰€æœ‰å®¢æˆ·ç«¯å¹¿æ’­æœ‰ç”¨æˆ·é€€å‡º io.emit('logout', &#123; onlineUsers: onlineUsers, onlineCount: onlineCount, user: obj &#125;); console.log(obj.userName + 'é€€å‡ºäº†èŠå¤©å®¤'); console.log('ç°åœ¨èŠå¤©å®¤é‡Œæœ‰:', onlineUsers); &#125; &#125;);&#125;); å®¢æˆ·ç«¯ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155(function() &#123; function addEvent(ele, type, handler) &#123; if (ele.addEventListener) &#123; ele.addEventListener(type, handler, false); &#125; else if (ele.attachEvent) &#123; ele.attachEvent("on" + type, handler); &#125; else &#123; ele["on" + type] = handler; &#125; &#125; function trim(str) &#123; if (!str.trim) &#123; return str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, ''); &#125; return str.trim(); &#125; window.onload = function() &#123; main(); &#125;; function main() &#123; var loginInput = document.querySelector('#js_loginInput'), loginBox = document.querySelector('#js_loginBox'); loginInput.focus(); // ç™»å½•æ¡†é»˜è®¤èšç„¦ var URL = 'http://192.168.23.27:3000'; addEvent(loginInput, 'keydown', function(e) &#123; var e = e || window.e; if (e.keyCode === 13) &#123; var val = trim(loginInput.value); if (val !== '') &#123; // éšè—ç™»å½•æ¡† loginInput.value = ''; loginBox.className = loginBox.className + ' is-hide'; // åˆ›å»ºä¸€ä¸ªwsè¿æ¥ var link = new Link(URL, val); &#125; &#125; &#125;); &#125; function Link(url, name) &#123; this.url = url; this.userName = trim(name); this.init(); &#125; Link.prototype = &#123; constructor: Link, init: function() &#123; var self = this; this.socket = io.connect(this.url); this.userId = this.genUid(); this.submitInput = document.querySelector('#js_chatInput'); this.list = document.querySelector('#js_chatList'); this.hd = document.querySelector('#js_chatHd'); this.submitInput.focus(); this.socket.emit('login', &#123; userName: this.userName, userId: this.userId &#125;); // å‘Šè¯‰æœåŠ¡ç«¯ï¼Œå½“å‰å®¢æˆ·ç«¯ç™»å½•äº† this.socket.on('newIn', function(o) &#123; // ç›‘å¬æœåŠ¡ç«¯æ´¾å‘çš„ç”¨æˆ·ç™»å½•äº‹ä»¶ var li = self.makeTips(o.user.userName); self.updateList(li); self.updateOnline(o.onlineUsers, o.onlineCount); &#125;); addEvent(this.submitInput, 'keydown', function(e) &#123; var e = e || window.e; var text = trim(self.submitInput.value); if (e.keyCode === 13) &#123; if (text !== '') &#123; self.submitInput.value = ''; self.socket.emit('message', &#123; message: text, name: self.userName, id: self.userId &#125;); // å‘Šè¯‰æœåŠ¡ç«¯ï¼Œå½“å‰å®¢æˆ·ç«¯å‘é€äº†ä¸€ä¸ªmessage &#125; &#125; &#125;); this.socket.on('message', function(o) &#123; // ç›‘å¬æœåŠ¡ç«¯æ´¾å‘çš„messageäº‹ä»¶ var isMe = o.id === self.userId ? true : false; // åˆ¤æ–­æ¶ˆæ¯æ˜¯å¦æ˜¯å½“å‰å®¢æˆ·ç«¯å‘é€çš„ var li = self.makeMessage(o.name, o.message, isMe); self.updateList(li); &#125;); this.socket.on('logout', function(o) &#123; // ç›‘å¬æœåŠ¡ç«¯æ´¾å‘çš„logoutäº‹ä»¶ var li = self.makeTips(o.user.userName, true); self.updateList(li); self.updateOnline(o.onlineUsers, o.onlineCount); &#125;); &#125;, genUid: function() &#123; return new Date().getTime() + "" + Math.floor(Math.random() * 899 + 100); // ç”Ÿæˆå”¯ä¸€idï¼Œç”¨äºåé¢çš„åˆ¤æ–­ &#125;, makeTips: function(name, logout) &#123; if (typeof name === 'undefined') &#123; return; &#125; var li = document.createElement('li'); li.className = 'c-ChatList-item is-tips'; if (logout) &#123; li.innerHTML = '&lt;span class="c-ChatList-tip"&gt;' + name + 'é€€å‡ºäº†èŠå¤©å®¤&lt;/span&gt;'; &#125; else &#123; li.innerHTML = '&lt;span class="c-ChatList-tip"&gt;' + name + 'åŠ å…¥äº†èŠå¤©å®¤&lt;/span&gt;'; &#125; return li; &#125;, makeMessage: function(name, text, me) &#123; if (typeof name === 'undefined' || typeof text === 'undefined') &#123; return; &#125; var li = document.createElement('li'); if (me) &#123; li.className = 'c-ChatList-item fadeInRight is-me'; li.innerHTML = '&lt;div class="c-ChatList-cont"&gt;&lt;div class="c-ChatList-text"&gt;' + text + '&lt;/div&gt;&lt;div class="c-ChatList-name"&gt;' + name + '&lt;/div&gt;&lt;/div&gt;'; &#125; else &#123; li.className = 'c-ChatList-item fadeInLeft'; li.innerHTML = '&lt;div class="c-ChatList-cont"&gt;&lt;div class="c-ChatList-name"&gt;' + name + '&lt;/div&gt;&lt;div class="c-ChatList-text"&gt;' + text + '&lt;/div&gt;&lt;/div&gt;'; &#125; return li; &#125;, updateList: function(li) &#123; this.list.appendChild(li); li.scrollIntoView(); &#125;, updateOnline: function(users, count) &#123; var html = 'åœ¨çº¿äººæ•°ï¼š' + count + 'äººï¼›åœ¨çº¿åˆ—è¡¨ï¼š'; var arr = []; for (var key in users) &#123; if (users.hasOwnProperty(key)) &#123; arr.push(users[key]); &#125; &#125; html += arr.join('ã€'); this.hd.innerHTML = html; &#125; &#125;;&#125;)(); ç›¸å…³é“¾æ¥ http://www.52im.net/thread-336-1-1.htmlhttps://segmentfault.com/a/1190000002496055https://socket.io]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>èŠå¤©å®¤</tag>
        <tag>websocket</tag>
        <tag>nodejs</tag>
        <tag>im</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[webpack-multi-page]]></title>
    <url>%2F2018%2F01%2F02%2Fwebpack-multi-page%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘åœ¨çœ‹webpackçš„é…ç½®ï¼Œè‡ªå·±å°è¯•å†™äº†ä¸ªå¤šé¡µé¢çš„é…ç½®æ–‡ä»¶ã€‚åœ¨æ­¤åšä¸ªè®°å½•ï¼Œæ–¹ä¾¿æ—¥åæŸ¥æ‰¾ã€‚è¯¦ç»†ä»£ç å¯ä»¥æŸ¥çœ‹(https://github.com/BryanAdamss/WebpackTemplate) Webpackå¤šé¡µé¢é…ç½®æƒ³å®ç°çš„åŠŸèƒ½ å¼€å‘ç¯å¢ƒã€ç”Ÿäº§ç¯å¢ƒé…ç½®åˆ†ç¦» å¼€å‘ç¯å¢ƒ HMR è‡ªåŠ¨ç”ŸæˆHTMLæ–‡ä»¶ source map ç”Ÿäº§ç¯å¢ƒ æå–cssã€sass æå–å…¬å…±æ¨¡å— å‹ç¼©ä»£ç  hash ç¼“å­˜ ä¸SPAçš„ä¸åŒ å•é¡µé¢åº”ç”¨åœ¨å…¥å£å¤„å¼•å…¥æ‰€æœ‰çš„jsæ–‡ä»¶ å¤šé¡µé¢åº”ç”¨éœ€è¦åœ¨æ¯ä¸ªé¡µé¢ä¸­å¼•å…¥å…¬å…±çš„jsæ–‡ä»¶å’Œè‡ªèº«çš„jsæ–‡ä»¶(å…¬å…±ä»£ç ã€å¤šå…¥å£) é¡¹ç›®ç»“æ„123456789101112131415161718|---config/| config.jsâ”‚ webpack.config.base.jsâ”‚ webpack.config.dev.jsâ”‚ webpack.config.prod.js|---dist/|---node_modules/|---src/| css/| html/| img/| sass/| vendors/| a.js| b.js|---.babelrc|---package.json|---postcss.config.js ä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œå°†é…ç½®æ–‡ä»¶æ‹†åˆ†ä¸º4ä¸ªå¹¶å…¨éƒ¨æ”¾ç½®åœ¨configæ–‡ä»¶å¤¹ä¸‹ distæ–‡ä»¶å¤¹ä¸»è¦æ”¾ç½®æ‰“åŒ…åçš„æ–‡ä»¶ srcä¸»è¦æ˜¯æºæ–‡ä»¶å’Œä¸€äº›ç¬¬ä¸‰æ–¹ç»„ä»¶ .babelrcä¸ºbabelé…ç½®æ–‡ä»¶ postcss.config.jsä¸ºpostcssçš„é…ç½®æ–‡ä»¶ package.json123456789101112131415161718192021222324252627282930313233343536&#123; "name": "WebpackTemplate", "version": "1.0.0", "description": "", "main": "index.js", "scripts": &#123; "build": "webpack --progress --color --config ./config/webpack.config.prod.js", "dev": "webpack-dev-server --progress --color --open --config ./config/webpack.config.dev.js" &#125;, "keywords": [], "author": "", "license": "ISC", "devDependencies": &#123; "auto-prefixer": "^0.4.2", "babel-core": "^6.26.0", "babel-loader": "^7.1.2", "babel-preset-env": "^1.6.1", "clean-webpack-plugin": "^0.1.17", "css-loader": "^0.28.7", "extract-text-webpack-plugin": "^3.0.2", "file-loader": "^1.1.6", "html-webpack-plugin": "^2.30.1", "node-sass": "^4.7.2", "postcss-loader": "^2.0.9", "sass-loader": "^6.0.6", "style-loader": "^0.19.1", "uglifyjs-webpack-plugin": "^1.1.5", "url-loader": "^0.6.2", "webpack": "^3.10.0", "webpack-dev-server": "^2.9.7", "webpack-merge": "^4.1.1" &#125;, "dependencies": &#123; "babel-polyfill": "^6.26.0" &#125;&#125; post-css-loaderã€auto-prefixeré…åˆå®Œæˆå‰ç¼€ä¿®å¤å·¥ä½œ babel-coreã€babel-preset-envã€babel-polyfillæ˜¯babelç¼–è¯‘es6æ‰€å¿…é¡»çš„æ–‡ä»¶ï¼›babel-loaderæ˜¯ç”¨æ¥å¤„ç†es6çš„ï¼›babel-polyfillæ˜¯å«ç‰‡æ–‡ä»¶ clean-webpack-pluginæ˜¯æ¸…é™¤æ–‡ä»¶å¤¹çš„ css-loaderã€style-loaderæ˜¯åŠ è½½æ ·å¼çš„ extract-text-webpack-pluginç”¨æ¥æå–cssåˆ°ä¸€ä¸ªå•ç‹¬æ–‡ä»¶çš„ file-loaderå¯ä»¥ç”¨æ¥åŠ è½½å›¾ç‰‡å­—ä½“ç­‰èµ„æº url-loaderä½œç”¨ç±»ä¼¼file-loaderï¼Œä¸åŒçš„æ˜¯å¯ä»¥å°†ä½äºæŸå¤§å°çš„æ–‡ä»¶ç›´æ¥è½¬æˆdataUrlæ’å…¥åˆ°é¡µé¢ä¸­ html-webpack-pluginå¯æ ¹æ®æ¨¡æ¿è‡ªåŠ¨ç”Ÿæˆhtmlé¡µé¢ï¼Œå¹¶æ’å…¥éœ€è¦çš„jsæ–‡ä»¶ node-sassã€sass-loaderé…åˆå®Œæˆç¼–è¯‘sass(scss)çš„å·¥ä½œ uglifyjs-webpack-pluginç”¨æ¥å‹ç¼©jsæ–‡ä»¶ webpack-dev-serverç”Ÿäº§ç¯å¢ƒç”¨çš„é™æ€æœåŠ¡å™¨ webpack-mergeç”¨æ¥åˆå¹¶ä¸åŒçš„é…ç½®æ–‡ä»¶ é…ç½®æ–‡ä»¶ config.jsä¸»è¦æ”¾ç½®äº†ä¸€äº›å…¨å±€é…ç½®æ–‡ä»¶ï¼Œå¦‚å„ç§è·¯å¾„â€¦ 12345678910111213141516171819202122232425// å…¨å±€é…ç½®ï¼Œæ¯”å¦‚ HTML æ–‡ä»¶çš„è·¯å¾„ã€publicPath ç­‰const path = require('path');// __dirnameæ˜¯å½“å‰æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼Œprocess.cwd()æ˜¯nodeå½“å‰å·¥ä½œçš„ç›®å½•ï¼Œå³package.jsonæ‰€åœ¨ç›®å½•const PROJECT_PATH = process.cwd(); // é¡¹ç›®ç›®å½•const config = &#123; PROJECT_PATH, // é¡¹ç›®ç›®å½• CONFIG_PATH: path.join(__dirname), // é…ç½®æ–‡ä»¶ç›®å½• SRC_PATH: path.join(PROJECT_PATH, './src/'), // æºæ–‡ä»¶ç›®å½• BUILD_PATH: path.join(PROJECT_PATH, './dist/'), // æ‰“åŒ…ç›®å½• PUBLIC_PATH: '/assets/', // é™æ€æ–‡ä»¶å­˜æ”¾ç›®å½• HTML_PATH: path.join(PROJECT_PATH, './src/html/'), VENDORS_PATH: path.join(PROJECT_PATH, './src/vendors/'), // vendorsç›®å½• NODE_MODULES_PATH: path.join(PROJECT_PATH, './node_modules/'), // node_modulesç›®å½• ignorePages: ['test'], // æ²¡æœ‰å…¥å£jsæ–‡ä»¶çš„html&#125;;console.log('\n/-----ç›¸å…³è·¯å¾„-----/\n');console.log(config);console.log('\n/-----ç›¸å…³è·¯å¾„-----/\n');module.exports = config; webpack.config.base.jsæ˜¯åŸºç¡€é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«äº†ä¸€äº›é€šç”¨é…ç½® 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788// åŸºç¡€é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«äº†ä¸åŒç¯å¢ƒé€šç”¨é…ç½®const path = require('path'); // nodejsè·¯å¾„æ¨¡å—ï¼Œç”¨äºè¯»å–è·¯å¾„const fs = require('fs'); // nodejsæ–‡ä»¶æ¨¡å—ï¼Œç”¨äºè¯»å–æ–‡ä»¶const config = require('./config.js'); // è·å–é…ç½®const HTMLWebpackPlugin = require('html-webpack-plugin'); // ç”¨äºç”Ÿæˆhtml// è·å–htmlæ–‡ä»¶åï¼Œç”¨äºç”Ÿæˆå…¥å£const getFileNameList = (path) =&gt; &#123; let fileList = []; let dirList = fs.readdirSync(path); dirList.forEach(item =&gt; &#123; if (item.indexOf('html') &gt; -1) &#123; fileList.push(item.split('.')[0]); &#125; &#125;); return fileList;&#125;;let htmlDirs = getFileNameList(config.HTML_PATH);let HTMLPlugins = []; // ä¿å­˜HTMLWebpackPluginå®ä¾‹let Entries = &#123;&#125;; // ä¿å­˜å…¥å£åˆ—è¡¨// ç”ŸæˆHTMLWebpackPluginå®ä¾‹å’Œå…¥å£åˆ—è¡¨htmlDirs.forEach((page) =&gt; &#123; let htmlConfig = &#123; filename: `$&#123;page&#125;.html`, template: path.join(config.HTML_PATH, `./$&#123;page&#125;.html`) // æ¨¡æ¿æ–‡ä»¶ &#125;; let found = config.ignorePages.findIndex((val) =&gt; &#123; return val === page; &#125;); if (found === -1) &#123; // æœ‰å…¥å£jsæ–‡ä»¶çš„htmlï¼Œæ·»åŠ æœ¬é¡µçš„å…¥å£jså’Œå…¬ç”¨jsï¼Œå¹¶å°†å…¥å£jså†™å…¥Entriesä¸­ htmlConfig.chunks = [page, 'commons']; Entries[page] = `./src/$&#123;page&#125;.js`; &#125; else &#123; // æ²¡æœ‰å…¥å£jsæ–‡ä»¶ï¼Œchunkä¸ºç©º htmlConfig.chunks = []; &#125; const htmlPlugin = new HTMLWebpackPlugin(htmlConfig); HTMLPlugins.push(htmlPlugin);&#125;);module.exports = &#123; context: config.PROJECT_PATH, // å…¥å£ã€æ’ä»¶è·¯å¾„ä¼šåŸºäºcontextæŸ¥æ‰¾ entry: Entries, output: &#123; path: config.BUILD_PATH, // æ‰“åŒ…è·¯å¾„ï¼Œæœ¬åœ°ç‰©ç†è·¯å¾„ &#125;, module: &#123; rules: [&#123; test: /\.(woff|woff2|eot|ttf|otf)$/, include: [config.SRC_PATH], exclude: [config.VENDORS_PATH], // å¿½ç•¥ç¬¬ä¸‰æ–¹çš„ä»»ä½•ä»£ç  use: [&#123; // å¯¼å…¥å­—ä½“æ–‡ä»¶ï¼Œå¹¶æœ€æ‰“åŒ…åˆ°output.path+ options.nameå¯¹åº”çš„è·¯å¾„ä¸­ loader: 'file-loader', options: &#123; name: 'fonts/[name].[ext]' &#125; &#125;] &#125;, &#123; test: /\.(png|jpg|gif|svg)$/, include: [config.SRC_PATH], exclude: [config.VENDORS_PATH], use: [&#123; // å›¾ç‰‡æ–‡ä»¶å°äº8kæ—¶ç¼–è¯‘æˆdataUrlç›´æ¥åµŒå…¥é¡µé¢ï¼Œè¶…è¿‡8kå›é€€ä½¿ç”¨file-loader loader: 'url-loader', options: &#123; limit: 8192, // 8k name: 'img/[name].[ext]', // å›é€€ä½¿ç”¨file-loaderæ—¶çš„åç§° fallback: 'file-loader', // å½“è¶…è¿‡8192byteæ—¶ï¼Œä¼šå›é€€ä½¿ç”¨file-loader &#125; &#125;] &#125;, &#123; test: /\.js$/, include: [config.SRC_PATH], exclude: [config.VENDORS_PATH, config.NODE_MODULES_PATH], use: ['babel-loader'] &#125;] &#125;, plugins: [ ...HTMLPlugins, // æ‰©å±•è¿ç®—ç¬¦ç”Ÿæˆæ‰€æœ‰HTMLPlugins ]&#125;; è‡ªåŠ¨ç”Ÿæˆhtmlæ–‡ä»¶æ˜¯é€šè¿‡getFileNameListå‡½æ•°æ¥å®ç°çš„ï¼Œä¸»è¦åˆ©ç”¨nodeçš„fsæ¨¡å—ï¼Œè¯»å–src/html/ä¸‹çš„æ‰€æœ‰ç›´æ¥å­æ–‡ä»¶ï¼Œå¹¶é€šè¿‡åç¼€ç»“åˆconfig.jsä¸­ignoreè¿›è¡Œç­›é€‰è¿‡æ»¤ï¼Œè¿”å›éœ€è¦ç”Ÿæˆçš„htmlçš„åå­—æ•°ç»„ï¼Œéå†æ­¤æ•°ç»„ç”Ÿæˆç›¸å…³å…¥å£æ–‡ä»¶è·¯å¾„å’ŒHTMLWebpackPluginå®ä¾‹ webpack.config.dev.jså¼€å‘ç¯å¢ƒé…ç½®æ–‡ä»¶ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546// å¼€å‘ç¯å¢ƒé…ç½®æ–‡ä»¶const webpackBase = require('./webpack.config.base.js'); // å¼•å…¥åŸºç¡€é…ç½®const config = require('./config.js'); // å¼•å…¥é…ç½®const webpack = require('webpack'); // ç”¨äºå¼•ç”¨å®˜æ–¹æ’ä»¶const webpackMerge = require('webpack-merge'); // ç”¨äºåˆå¹¶é…ç½®æ–‡ä»¶const webpackDev = &#123; // å¼€å‘é…ç½®æ–‡ä»¶ output: &#123; filename: 'js/[name].[hash:8].bundle.js', // å¼€å‘ç¯å¢ƒç”¨hash &#125;, devtool: 'cheap-module-eval-source-map', // å¼€å‘ç¯å¢ƒè®¾ç½®sourceMapï¼Œç”Ÿäº§ç¯å¢ƒä¸ä½¿ç”¨ devServer: &#123; // å¯åŠ¨devServerï¼Œä¸ä¼šåœ¨æœ¬åœ°ç”Ÿæˆæ–‡ä»¶ï¼Œæ‰€æœ‰æ–‡ä»¶ä¼šç¼–è¯‘åœ¨å†…å­˜ä¸­(è¯»å–é€Ÿåº¦å¿«) contentBase: './dist/', // è¿™ä¸ªç›®å½•ä¸‹çš„å†…å®¹å¯è¢«è®¿é—® overlay: true, // é”™è¯¯ä¿¡æ¯ç›´æ¥æ˜¾ç¤ºåœ¨æµè§ˆå™¨çª—å£ä¸­ inline: true, // å®æ—¶é‡è½½çš„è„šæœ¬è¢«æ’å…¥åˆ°ä½ çš„åŒ…(bundle)ä¸­ï¼Œå¹¶ä¸”æ„å»ºæ¶ˆæ¯å°†ä¼šå‡ºç°åœ¨æµè§ˆå™¨æ§åˆ¶å° hot: true, // é…åˆwebpack.NamedModulesPluginã€webpack.HotModuleReplacementPluginå®ŒæˆMHR // publicPath: config.PUBLIC_PATH, // é™æ€èµ„æºå­˜æ”¾ä½ç½®ï¼Œæ ¹ç›®å½•çš„assetsæ–‡ä»¶å¤¹ï¼Œç¡®ä¿publicPathæ€»æ˜¯ä»¥æ–œæ (/)å¼€å¤´å’Œç»“å°¾ã€‚å¯ä»¥è®¾ç½®ä¸ºCDNåœ°å€ã€‚è¿™ä¸ªé€‰é¡¹ç±»ä¼¼url-prefix host: "0.0.0.0", // è®¾ç½®ä¸º0.0.0.0å¹¶é…åˆuseLocalIpå¯ä»¥å±€åŸŸç½‘è®¿é—® useLocalIp: true, // ä½¿ç”¨æœ¬æœºIPæ‰“å¼€devServerï¼Œè€Œä¸æ˜¯localhost // proxy: &#123;// å¯ä»¥é€šè¿‡proxyä»£ç†å…¶ä»–æœåŠ¡å™¨çš„api // "/api": "http://localhost:3000" // &#125; &#125;, module: &#123; rules: [&#123; test: /\.css$/, // å¼€å‘ç¯å¢ƒä¸æå–css include: [config.SRC_PATH], exclude: [config.VENDORS_PATH], use: ['style-loader', 'css-loader', 'postcss-loader'] &#125;, &#123; test: /\.scss$/, // å¼€å‘ç¯å¢ƒä¸æå–css include: [config.SRC_PATH], exclude: [config.VENDORS_PATH], use: ['style-loader', 'css-loader', 'postcss-loader', 'sass-loader'] &#125;] &#125;, plugins: [ new webpack.NamedModulesPlugin(), // å¼€å‘ç¯å¢ƒç”¨äºæ ‡è¯†æ¨¡å—id new webpack.HotModuleReplacementPlugin(), // çƒ­æ›¿æ¢æ’ä»¶ ]&#125;;module.exports = webpackMerge(webpackBase, webpackDev); webpack.config.prod.jsç”Ÿäº§ç¯å¢ƒé…ç½®æ–‡ä»¶ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576// ç”Ÿäº§ç¯å¢ƒé…ç½®æ–‡ä»¶const webpackBase = require('./webpack.config.base.js'); // å¼•å…¥åŸºç¡€é…ç½®const config = require('./config.js'); // å¼•å…¥é…ç½®const webpack = require('webpack'); // ç”¨äºå¼•ç”¨å®˜æ–¹æ’ä»¶const webpackMerge = require('webpack-merge'); // ç”¨äºåˆå¹¶é…ç½®æ–‡ä»¶const CleanWebpackPlugin = require('clean-webpack-plugin'); // ç”¨äºæ¸…é™¤æ–‡ä»¶å¤¹const UglifyJSPlugin = require('uglifyjs-webpack-plugin'); // ç”¨äºå‹ç¼©æ–‡ä»¶const ExtractTextWebpackPlugin = require('extract-text-webpack-plugin'); // æå–cssï¼Œæå–å¤šä¸ªæ¥æºæ—¶ï¼Œéœ€è¦å®ä¾‹åŒ–å¤šä¸ªï¼Œå¹¶ç”¨extractæ–¹æ³•const cssExtracter = new ExtractTextWebpackPlugin(&#123; filename: './css/[name]-css.[contenthash:8].css', // ç›´æ¥å¯¼å…¥çš„cssæ–‡ä»¶ï¼Œæå–æ—¶æ·»åŠ -cssæ ‡è¯† allChunks: true, // ä»æ‰€æœ‰çš„chunkä¸­æå–ï¼Œå½“æœ‰CommonsChunkPluginæ—¶ï¼Œå¿…é¡»ä¸ºtrue&#125;);const sassExtracter = new ExtractTextWebpackPlugin(&#123; filename: './css/[name]-sass.[contenthash:8].css', // ç›´æ¥å¯¼å…¥çš„sassæ–‡ä»¶ï¼Œæå–æ—¶æ·»åŠ -sassæ ‡è¯† allChunks: true,&#125;);const webpackProd = &#123; // ç”Ÿäº§é…ç½®æ–‡ä»¶ output: &#123; filename: 'js/[name].[chunkhash:8].bundle.js', // ç”Ÿäº§ç¯å¢ƒç”¨chunkhash &#125;, module: &#123; rules: [&#123; test: /\.css$/, // ç”Ÿäº§ç¯å¢ƒæå–css include: [config.SRC_PATH], exclude: [config.VENDORS_PATH], use: cssExtracter.extract(&#123; fallback: 'style-loader', use: [&#123; loader: 'css-loader', options: &#123; minimize: true //csså‹ç¼© &#125; &#125;, 'postcss-loader'] &#125;) &#125;, &#123; test: /\.scss$/, // ç”Ÿäº§ç¯å¢ƒæå–css include: [config.SRC_PATH], exclude: [config.VENDORS_PATH], use: sassExtracter.extract(&#123; fallback: 'style-loader', use: [&#123; loader: 'css-loader', options: &#123; minimize: true //csså‹ç¼© &#125; &#125;, 'postcss-loader', 'sass-loader'] &#125;) &#125; ] &#125;, plugins: [ cssExtracter, sassExtracter, new webpack.DefinePlugin(&#123; // æŒ‡å®šä¸ºç”Ÿäº§ç¯å¢ƒï¼Œè¿›è€Œè®©ä¸€äº›libraryå¯ä»¥åšä¸€äº›ä¼˜åŒ– 'process.env.NODE_ENV': JSON.stringify('production') &#125;), new webpack.HashedModuleIdsPlugin(), // ç”Ÿäº§ç¯å¢ƒç”¨äºæ ‡è¯†æ¨¡å—id new CleanWebpackPlugin(['./dist/'], &#123; root: config.PROJECT_PATH, // é»˜è®¤ä¸º__dirnameï¼Œæ‰€ä»¥éœ€è¦è°ƒæ•´ &#125;), new webpack.optimize.CommonsChunkPlugin(&#123; // æŠ½å–å…¬å…±chunk name: 'commons', // æŒ‡å®šå…¬å…± bundle çš„åç§°ã€‚HTMLWebpackPluginæ‰èƒ½è¯†åˆ« filename: 'js/commons.[chunkhash:8].bundle.js' &#125;), new UglifyJSPlugin(), ]&#125;;module.exports = webpackMerge(webpackBase, webpackProd); .babelrcä¸ºbabelé…ç½®æ–‡ä»¶ 1234567891011121314&#123; "presets": [ ["env", &#123; "targets": &#123; "browsers": ["android&gt;=4.0", "ios&gt;=7.0", "ie&gt;=8", "&gt; 1% in CN"] &#125;, "useBuiltIns": "usage", "modules": false, "loose": true &#125;] ]&#125; ä½¿ç”¨babel-preset-envé¢„è®¾ï¼Œå®ƒåŒ…å«äº†babel-preset-es2015, babel-preset-es2016,babel-preset-es2017ï¼Œå¹¶å¯è®¾ç½®targetsè®©å…¶è‡ªåŠ¨ä¸ºç›®æ ‡æµè§ˆå™¨è¿›è¡Œpolyfillå’Œä»£ç è½¬æ¢å·¥ä½œï¼› &quot;useBuiltIns&quot;: &quot;usage&quot;ä½¿ç”¨è‡ªå¸¦çš„polyfillå³babel-polyfillï¼Œå¹¶åªåœ¨ä½¿ç”¨äº†æŸä¸ªç›®æ ‡æµè§ˆå™¨ä¸æ”¯æŒçš„es6è¯­æ³•æ—¶è‡ªåŠ¨importç›¸å…³å«ç‰‡ï¼›https://github.com/babel/babel/tree/master/packages/babel-preset-env 1234567891011121314151617//å…¥å£æ–‡ä»¶a.jsvar a = new Promise();b.jsvar b = new Map();//Out (å¦‚æœç›®æ ‡æµè§ˆå™¨ä¸æ”¯æŒ)import "core-js/modules/es6.promise";var a = new Promise();import "core-js/modules/es6.map";var b = new Map();//Out (å¦‚æœç›®æ ‡æµè§ˆå™¨æ”¯æŒ)var a = new Promise();var b = new Map(); &quot;modules&quot;: falseä¸å°†ES6çš„æ¨¡å—è½¬ä¸ºå…¶ä»–æ¨¡å—ç±»å‹(AMDã€UMDâ€¦) &quot;loose&quot;:trueä½¿ç”¨æ›´ç®€å• ES5 ä»£ç æ¥å…¼å®¹è€æµè§ˆå™¨ postcss.config.jspostcssé…ç½®æ–‡ä»¶1234567891011module.exports = &#123; plugins: &#123; 'autoprefixer': &#123; browsers: ["android&gt;=4.0", "ios&gt;=7.0", "ie&gt;=8", "&gt; 1% in CN"], //æ˜¯å¦ç¾åŒ–å±æ€§å€¼ é»˜è®¤ï¼štrue cascade: true, //æ˜¯å¦å»æ‰ä¸å¿…è¦çš„å‰ç¼€ é»˜è®¤ï¼štrue remove: true &#125; &#125;&#125;; æ€»ç»“ webpackå·²ç»æˆä¸ºå‰ç«¯å¿…é¡»ä¼šçš„ä¸œè¥¿ï¼Œç½‘ä¸Šä¹Ÿæœ‰å¾ˆå¤šç°æˆçš„é…ç½®æ–‡ä»¶å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä½†æ˜¯æƒ³é…ä¸€ä¸ªé€‚åˆè‡ªå·±çš„è¿˜æ˜¯éœ€è¦èŠ±è´¹å¾ˆå¤šæ—¶é—´çš„ï¼Œå› ä¸ºå®˜æ–¹æ–‡æ¡£æš´éœ²å‡ºçš„ç»†èŠ‚å¤ªå°‘ï¼Œå¿…é¡»æŸ¥é˜…å¤§é‡èµ„æ–™ã€é˜…è¯»ç›¸å…³æºç å†åŠ ä¸Šå¤§é‡çš„å®è·µæ‰èƒ½åŸºæœ¬äº†è§£ã€‚ å‚è€ƒ https://www.jianshu.com/p/2cc4a1078953https://zhuanlan.zhihu.com/p/29161762https://segmentfault.com/a/1190000006843916https://doc.webpack-china.org/api/]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>webpack</tag>
        <tag>å·¥ç¨‹åŒ–</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[webpack]]></title>
    <url>%2F2017%2F12%2F21%2Fwebpack%2F</url>
    <content type="text"><![CDATA[webpackå®˜æ–¹æŒ‡å—å­¦ä¹ ç¬”è®° webpackå®˜æ–¹æŒ‡å—å­¦ä¹ ç¬”è®°èµ·æ­¥ packagejson.jså¿…é¡»æ˜¯çº¯æ­£çš„jsonæ–‡ä»¶ï¼Œç”¨åŒå¼•å·ï¼Œç»“å°¾ä¸èƒ½æœ‰é€—å· npm init -yä¼šé»˜è®¤å…¨é€‰yesæ¥åˆå§‹åŒ–package.json npmä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨æ¨¡å—åæ¥å¼•ç”¨æœ¬åœ°å®‰è£…çš„åŒ…ï¼Œè€Œä¸éœ€è¦å†™å‡ºå®Œæ•´è·¯å¾„ ./node_modules/.bin/webpack src/index.js dist/bundle.jså¯æ›¿æ¢ä¸ºwebpack src/index.js dist/bundle.js webpackå‘½ä»¤é»˜è®¤ä¼šæŸ¥æ‰¾webpack.config.jsé…ç½®æ–‡ä»¶ã€‚å¯ä»¥é€šè¿‡--configæ¥ä½¿ç”¨å…¶ä»–é…ç½®æ–‡ä»¶æ‰“åŒ… å¯ä»¥ä½¿ç”¨npm run å‘½ä»¤åçš„å½¢å¼æ¥è¿ç”¨package.jsonä¸­scriptså£°æ˜çš„è‡ªå®šä¹‰å‘½ä»¤ 1234567 ... "scripts": &#123; "build": "webpack" &#125;,// ä½¿ç”¨npm run build ç®¡ç†èµ„æº åŠ è½½css åœ¨webpackæ‰€æœ‰èµ„æºéƒ½å¯ä»¥çœ‹æˆæ¨¡å—ï¼Œcssä¹Ÿä¸ä¾‹å¤– é€šè¿‡css-loaderå¯ä»¥åœ¨jsæ–‡ä»¶ä¸­ä½¿ç”¨import &#39;./css/style.css&#39;çš„å½¢å¼å¯¼å…¥æ ·å¼ é€šè¿‡style-loaderå¯ä»¥å°†æ ·å¼æ–‡ä»¶æå–å‡ºæ¥ç”Ÿæˆä¸€ä¸ª&lt;style&gt;æ ‡ç­¾æ’å…¥åˆ°&lt;head&gt;ä¸­ï¼Œå¦‚æœæ˜¯å•é¡µé¢åº”ç”¨ï¼Œåˆ™å¯ä»¥å‡å°‘è¯·æ±‚(å½“å‰ä¹Ÿå¯ä»¥åˆ†ç¦»æ ·å¼åˆ°å•ç‹¬çš„æ–‡ä»¶ä¸­)12345678910111213141516// nodejsè·å–è·¯å¾„const path = require('path');module.exports = &#123; entry: './src/index.js', // å…¥å£ output: &#123; // å‡ºå£ filename: 'bundle.js', path: path.resolve(__dirname, 'dist'), //__dirnameæ˜¯nodejsä¸­çš„å…¨å±€å˜é‡ç”¨äºè·å–å½“å‰æ–‡ä»¶çš„å®Œæ•´ç»å¯¹è·¯å¾„ &#125;, module: &#123; rules: [&#123; // é’ˆå¯¹æ”¶é›†åˆ°çš„.cssç»“å°¾çš„ä¾èµ–ï¼Œå…ˆä½¿ç”¨css-loaderï¼Œå†ä½¿ç”¨style-loader test: /\.css$/, use: ['style-loader', 'css-loader'],// åŒä¸€ä¸ªä¾èµ–ä¾æ¬¡ä½¿ç”¨å¤šä¸ªloaderæ—¶è¦æŒ‰ç…§ä»å³å¾€å·¦çš„é¡ºåº &#125;] &#125;&#125;; åŠ è½½å›¾ç‰‡ é€šè¿‡file-loaderå¯ä»¥åœ¨jsæ–‡ä»¶ä¸­ä½¿ç”¨import Img from &#39;./img/icon.jpg&#39;å½¢å¼æ¥ä½¿ç”¨å›¾ç‰‡ï¼Œå¹¶Imgå˜é‡åŒ…å«è¯¥å›¾åƒåœ¨å¤„ç†åçš„æœ€ç»ˆurlï¼›å½“ä½¿ç”¨äº†css-loaderåï¼Œcssä¸­çš„url(&quot;./img/icon/jpg&quot;)è·¯å¾„ä¹Ÿä¼šè¢«æ›¿æ¢ï¼›å½“ä½¿ç”¨html-loaderåï¼Œhtmlä¸­çš„&lt;img src=&quot;./my-image.png&quot; /&gt;è·¯å¾„ä¹Ÿä¼šè¢«æ›¿æ¢123456789101112131415161718192021222324252627 import Cat from './img/cat.jpg'; function component() &#123; ... var image = new Image(); image.src = Cat; image.onload = function() &#123; element.appendChild(image); &#125;; return element; &#125; ``` - åŠ è½½å­—ä½“ - åŠ è½½å­—ä½“çš„ç­–ç•¥å’ŒåŠ è½½å›¾ç‰‡çš„ç­–ç•¥åŸºæœ¬ä¸€è‡´ï¼Œå¯ä»¥é€šè¿‡`file-loader`å®ç°- åŠ è½½CSVã€XML - å¯ä»¥é€šè¿‡å¯¹åº”çš„loaderæ¥å¤„ç†## ç®¡ç†è¾“å‡º- ç”Ÿæˆæ¨¡æ¿ - ä½¿ç”¨`html-webpack-plugin`æ’ä»¶ï¼Œå¯ä»¥åŠ¨æ€ç”Ÿæˆhtmlæ–‡ä»¶ï¼Œå¹¶è‡ªåŠ¨æ·»åŠ ä¸Šç”Ÿæˆçš„åŒ… ```javascript plugins: [ new HtmlWebpackPlugin(&#123; title: 'æˆ‘æ˜¯æ ‡é¢˜' &#125;) ], æ¸…ç†æ–‡ä»¶å¤¹ ä½¿ç”¨clean-webpack-pluginæ’ä»¶ï¼Œæ¥æ¸…ç†æŒ‡å®šæ–‡ä»¶å¤¹123456plugins: [ new CleanWebpackPlugin(['dist']),// æŒ‡å®šè¦æ¸…ç†çš„æ–‡ä»¶å¤¹ new HtmlWebpackPlugin(&#123; title: 'Output Management' &#125;)], ä½¿ç”¨webpackè‡ªå¸¦æ’ä»¶æ—¶ï¼Œéœ€è¦å…ˆrequire(&#39;webpack&#39;) å¼€å‘ sourceMap å¯ä»¥å°†ç¼–è¯‘åçš„ä»£ç æ˜ å°„å›åŸå§‹æºä»£ç  é€šè¿‡é…ç½®webpackçš„devtool devtool: &#39;inline-source-map&#39;, è‡ªåŠ¨ç¼–è¯‘ webpack watchæ¨¡å¼ ä½¿ç”¨webpack --watchè§‚æµ‹æ–‡ä»¶çš„å˜åŠ¨ï¼Œæœ‰å˜åŠ¨ï¼Œåˆ™è‡ªåŠ¨ç¼–è¯‘ï¼Œå¯ä»¥å°†webpack --watchå†™å…¥åˆ°package.jsonçš„scriptsä¸­ï¼›ç¼ºç‚¹æ˜¯æ— æ³•è‡ªåŠ¨åˆ·æ–°æµè§ˆå™¨ï¼Œé‡æ–°ç¼–è¯‘åéœ€è¦æ‰‹åŠ¨åˆ·æ–°æµè§ˆå™¨12345"scripts": &#123; "test": "echo \"Error: no test specified\" &amp;&amp; exit 1", "watch": "webpack --watch", "build": "webpack" &#125;, ä½¿ç”¨webpack-dev-server åŒ…å«ä¸€ä¸ªç®€å•webæœåŠ¡å™¨ï¼Œå¹¶èƒ½å®ç°è‡ªåŠ¨åˆ·æ–° éœ€é…ç½®devServer 123devServer: &#123; contentBase: './dist' // å°†distæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ä½œä¸ºå¯è®¿é—®æ–‡ä»¶&#125;, ä½¿ç”¨webpack-dev-server --openå¯åŠ¨ï¼Œå¯å°†å…¶å†™åˆ°package.jsonçš„scriptsä¸­ ä½¿ç”¨webpack-dev-middleware å®ƒæ˜¯ä¸€ä¸ªä¸­é—´ä»¶å®¹å™¨ï¼Œå¯ä»¥å°†webpackå¤„ç†åçš„æ–‡ä»¶å‘å¸ƒåˆ°å¦å¤–ä¸€ä¸ªæœåŠ¡å™¨ä¸­ï¼Œwebpack-dev-serverä¸­ä¹Ÿä½¿ç”¨äº†å®ƒï¼Œå¯ä»¥é…åˆexpressæ¥ä½¿ç”¨ æ¨¡å—çƒ­æ›¿æ¢MHR å¯ä»¥åœ¨ä¸åˆ·æ–°æµè§ˆå™¨çš„æƒ…å†µä¸‹æ›¿æ¢æ¨¡å—ï¼Œå¦‚cssã€å›¾ç‰‡ã€jsã€‚é‡è¦çš„æ˜¯åœ¨æ›¿æ¢jsæ¨¡å—æ—¶è¿˜èƒ½ä¿ç•™jsæ¨¡å—è¿è¡Œæ—¶çš„ç›¸å…³ç¯å¢ƒ ä½¿ç”¨ webpack-dev-serverä¸­å¯ä»¥é€šè¿‡é…ç½®devServerçš„hotä¸ºtrueï¼Œå¹¶ä½¿ç”¨webpackè‡ªå¸¦çš„HotModuleReplacementPluginæ’ä»¶æ¥å®ç° Tree Shaking é€šè¿‡uglifyjs-webpack-pluginæ’ä»¶å®ç°ï¼Œæ­¤æ’ä»¶è‡ªå¸¦Tree ShakingåŠŸèƒ½ï¼Œèƒ½å‰”é™¤æ‰æœªç”¨åˆ°çš„æ¨¡å— ä½¿ç”¨Tree ShakingåŠŸèƒ½å¿…é¡»ä½¿ç”¨ES2015çš„æ¨¡å—è¯­æ³• ç”Ÿäº§ç¯å¢ƒæ„å»º ä¸ºäº†åŒºåˆ†å¼€å‘ç¯å¢ƒå’Œç”Ÿäº§ç¯å¢ƒï¼Œå¯ä»¥æå–å‡ºä¸€ä¸ªå…¬ç”¨é…ç½®æ–‡ä»¶å¹¶åˆ†åˆ«é…ç½®ä¸åŒçš„é…ç½®æ–‡ä»¶ã€‚ ä¸åŒé…ç½®æ–‡ä»¶çš„åˆå¹¶éœ€è¦ä½¿ç”¨åˆ°webpack-mergeå·¥å…· å¯ä»¥ä½¿ç”¨webpackè‡ªå¸¦çš„DefinePluginæ’ä»¶æŒ‡å®šç¯å¢ƒ12345new webpack.DefinePlugin(&#123; 'process.env': &#123; 'NODE_ENV': JSON.stringify('production'),// å®šä¹‰çš„NODE_ENVå¯ä»¥è¢«/srcä¸‹çš„æ‰€æœ‰æ–‡ä»¶è®¿é—®åˆ° &#125;&#125;) ä»£ç åˆ†ç¦» åˆ†ç¦»ä»£ç çš„æ–¹æ³• é…ç½®ä¸åŒçš„å…¥å£èµ·ç‚¹ï¼Œæ‰‹åŠ¨åˆ†ç¦»ä»£ç  1234entry: &#123; index: './src/index.js', another: './src/another-module.js'&#125;, ä½¿ç”¨CommonsChunkPluginå»é‡å’Œåˆ†ç¦»å— ä¸åŒæ¨¡å—Aã€Bï¼Œå¯èƒ½ä¼šå¼•ç”¨åŒä¸€ä¸ªæ¨¡å—C,æ‰“åŒ…åçš„Aã€Bä¼šé»˜è®¤åŒ…å«Cï¼Œä½¿ç”¨webpackè‡ªå¸¦çš„CommonsChunkPluginæ’ä»¶å¯ä»¥æå–ç›¸åŒä»£ç åˆ°åŒä¸€ä¸ªåŒ…ä¸­ 123new webpack.optimize.CommonsChunkPlugin(&#123; name: 'common' // æŒ‡å®šå…¬å…± bundle çš„åç§°ã€‚&#125;) å¯ä»¥ä½¿ç”¨ExtractTextPluginå°†cssä»ä¸»ç¨‹åºä¸­åˆ†ç¦»å‡ºæ¥ promise-loaderç”¨äºåˆ†ç¦»ä»£ç å’Œå»¶è¿ŸåŠ è½½ç”Ÿæˆçš„ bundleï¼Œä¸»è¦ç”¨promise åŠ¨æ€å¯¼å…¥ ä½¿ç”¨import()å‡½æ•°ï¼Œå¹¶è®¾ç½®chunkFilename æ‡’åŠ è½½ åœ¨éœ€è¦æŸä¸ªæ¨¡å—çš„æ—¶å€™ä½¿ç”¨import()åŠ¨æ€å¯¼å…¥ æ³¨æ„å½“è°ƒç”¨ ES6 æ¨¡å—çš„ import() æ–¹æ³•ï¼ˆå¼•å…¥æ¨¡å—ï¼‰æ—¶ï¼Œå¿…é¡»æŒ‡å‘æ¨¡å—çš„ .default å€¼ï¼Œå› ä¸ºå®ƒæ‰æ˜¯ promise è¢«å¤„ç†åè¿”å›çš„å®é™…çš„ module å¯¹è±¡ã€‚ ç¼“å­˜ [hash]å¯ä»¥ç»™æ–‡ä»¶æ‰“ä¸Šç»Ÿä¸€çš„é¡¹ç›®æŒ‡çº¹ [chunkhash]å¯ä»¥ç»™æ–‡ä»¶æ‰“ä¸Šå”¯ä¸€çš„æ–‡ä»¶æŒ‡çº¹ åˆ›å»ºLibrary å¯ä»¥é€šè¿‡æŒ‡å®šexternalsæ¥å¤–éƒ¨åŒ–ä¸€äº›ä¾èµ– Shimming å¯ä»¥ä½¿ç”¨ProvidePluginåœ¨åˆé€‚æ—¶æœºåŠ è½½ä¸€äº›å…¨å±€å˜é‡ã€‚ Typescript å¯ä»¥ä½¿ç”¨ts-loaderæ¥ç¼–è¯‘typescript æ„å»ºæ€§èƒ½ åæœŸè¡¥ ç¯å¢ƒå˜é‡ åæœŸè¡¥ ç®¡ç†ä¾èµ– åæœŸè¡¥ Public Path åæœŸè¡¥ é›†æˆ åæœŸè¡¥]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>webpack</tag>
        <tag>æ„å»º</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CSS_Secrets]]></title>
    <url>%2F2017%2F12%2F13%2FCSS-Secrets%2F</url>
    <content type="text"><![CDATA[å¦‚æœè®©æˆ‘æ¨èåŸºæœ¬cssæ–¹é¢çš„ä¹¦ç±ï¼Œæˆ‘ä¼šæ¨èç²¾é€šCSSï¼ˆç¬¬2ç‰ˆï¼‰ã€CSSæƒå¨æŒ‡å—ä»¥åŠLea Verouå¤§ç¥çš„CSS Secretsæœ€è¿‘èŠ±äº†ç‚¹æ—¶é—´å°†CSS Secretsçœ‹äº†éï¼Œå°†æ‰€æœ‰ä»£ç æ•²äº†ä¸€éã€‚ç‰¹åœ¨æ­¤åšä¸ªè®°å½•ï¼Œå¯ä»¥å³é”®æŸ¥çœ‹æºç ï¼Œç»å¤§éƒ¨åˆ†éƒ½å†™äº†æ³¨é‡Šã€‚æºç å¯ä»¥æŸ¥çœ‹(https://github.com/BryanAdamss/SourceSave/tree/master/CssSecrets) CSS_Scerts00_å‡å°‘ä»£ç é‡å¤ 01_currentColor 02_ä½¿ç”¨inheritå®Œæˆä¸€äº›reset 03_åŠé€æ˜è¾¹æ¡† 04_å¤šé‡è¾¹æ¡† 05_å¤šé‡è¾¹æ¡†_outline 06_çµæ´»èƒŒæ™¯å›¾å®šä½ 07_çµæ´»èƒŒæ™¯å›¾å®šä½_origin 08_çµæ´»èƒŒæ™¯å›¾å®šä½_calc 09_è¾¹æ¡†å†…åœ†è§’_ä¸¤ä¸ªå…ƒç´ å®ç° 10_è¾¹æ¡†å†…åœ†è§’_ä¸€ä¸ªå…ƒç´ å®ç° 11_æ°´å¹³æ¡çº¹ 12_å‚ç›´æ¡çº¹ 13_æ–œå‘æ¡çº¹ 14_æ›´å¥½çš„æ–œå‘æ¡çº¹ 15_çµæ´»çš„åŒè‰²ç³»æ¡çº¹ 16_æ¸å˜ç”Ÿæˆç½‘æ ¼ 17_æ ¼å­å¯è°ƒçš„ç½‘æ ¼ 18_æ›´åŠ é€¼çœŸçš„å¯è°ƒç½‘æ ¼ 19_å¾„å‘æ¸å˜ç”Ÿæˆæ³¢ç‚¹ 20_é”™è½æœ‰è‡´çš„æ³¢ç‚¹ 21_æ¸å˜ç”Ÿæˆæ£‹ç›˜ 22_æ¸å˜ç”Ÿæˆæ£‹ç›˜ä¼˜åŒ– 23_ä¼ªéšæœºèƒŒæ™¯ 24_è¿ç»­çš„èƒŒæ™¯è¾¹æ¡† 25_è€å¼ä¿¡å° 26_èš‚èšè¡Œå†›è¾¹æ¡† 27_è„šæ³¨ 28_æ¤­åœ† 29_å¹³è¡Œå››è¾¹å½¢ 30_è±å½¢å›¾ç‰‡ 31_æ–œå‘åˆ‡è§’ 32_å¼§å½¢åˆ‡è§’ 33_æ¢¯å½¢æ ‡ç­¾é¡µ 34_é¥¼å›¾ 35_é¥¼å›¾_svg 36_é¥¼å›¾_svgä¼˜åŒ– 37_å•ä¾§ã€é‚»è¾¹ã€åŒä¾§æŠ•å½± 38_ä¸è§„åˆ™æŠ•å½± 39_æŸ“è‰²æ•ˆæœ_æ»¤é•œ 40_æŸ“è‰²æ•ˆæœ_æ··åˆæ¨¡å¼ 41_æ¯›ç»ç’ƒ 42_æŠ˜è§’æ•ˆæœ 43_å…¶å®ƒè§’åº¦æŠ˜è§’ 44_æ›´åŠ é€¼çœŸçš„æŠ˜è§’ 45_æ’å…¥æ¢è¡Œ 46_ä»£ç æ–‘é©¬çº¹ 47_æ§åˆ¶tabçš„å¤§å° 48_è‡ªå®šä¹‰ä¸‹åˆ’çº¿ 49_å‡¸ç‰ˆæ–‡å­— 50_ç©ºå¿ƒæ–‡å­— 51_æ–‡å­—å‘å…‰æ•ˆæœ 52_ä¼ª3dæ–‡å­— 53_é•¿é˜´å½±æ–‡å­— 54_ç¯å½¢æ–‡å­— 55_ä½¿ç”¨ç¦ç”¨æ ‡å¿—æ ‡è¯†ç¦ç”¨æŒ‰é’® 56_æ‰©å¤§ç‚¹å‡»åŒºåŸŸ 57_è‡ªå®šä¹‰å¤é€‰æ¡† 58_æ¨¡ç³ŠèƒŒæ™¯ 59_æ»šåŠ¨é˜´å½±æç¤º 60_å›¾ç‰‡å¯¹æ¯”æ§ä»¶ 61_èŒƒå›´è¾“å…¥çš„å›¾ç‰‡å¯¹æ¯”æ§ä»¶ 62_è‡ªé€‚åº”å†…éƒ¨å…ƒç´  63_æ ¹æ®å…„å¼Ÿå…ƒç´ çš„æ•°é‡æ¥è®¾ç½®æ ·å¼ 64_æ ¹æ®å…„å¼Ÿå…ƒç´ æ•°é‡èŒƒå›´æ¥åŒ¹é…å…ƒç´  65_æ»¡å¹…èƒŒæ™¯å®šå®½å†…å®¹ 66_å¼¹æ€§è¿‡æ¸¡ 67_å»¶æ—¶è¿‡æ¸¡ 68_é€å¸§åŠ¨ç”» 69_æ–‡å­—é—ªçƒåŠ¨ç”» 70_æ‰“å­—åŠ¨ç”» 71_çŠ¶æ€å¹³æ»‘çš„åŠ¨ç”» 72_ç”¨ä¸¤ä¸ªå…ƒç´ å®ç°æ²¿ç¯å½¢è·¯å¾„å¹³ç§»çš„åŠ¨ç”»]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ES6-learning]]></title>
    <url>%2F2017%2F09%2F26%2FES6-learning%2F</url>
    <content type="text"><![CDATA[ES6å­¦ä¹ ç¬”è®° æœ€è¿‘åœ¨çœ‹é˜®è€å¸ˆçš„ES6æ•™ç¨‹ï¼Œæ‰€ä»¥ç‰¹æ­¤è®°å½•ä¸€äº›é‡ç‚¹ã€‚ä¾‹å­ä½¿ç”¨çš„å¤§éƒ½æ˜¯é˜®è€å¸ˆçš„ä¾‹å­ï¼Œæ„Ÿè°¢é˜®è€å¸ˆçš„æ— ç§å¥‰çŒ®ã€‚ ç®€ä»‹ es6æ³›æŒ‡ä¸‹ä¸€ä»£jsæ ‡å‡†ï¼Œä¸»è¦æ¶µç›–äº†es2015,es2016,es2017ï¼›ä¸€èˆ¬è¯´çš„es6ä¸»è¦æŒ‡çš„es2015 let letå®é™…ä¸ºjsæä¾›äº†å—çº§ä½œç”¨åŸŸï¼Œç”¨æ³•ç±»ä¼¼varï¼Œä½†å®ƒæ‰€å£°æ˜çš„å˜é‡ï¼Œä»…åœ¨letæ‰€åœ¨çš„ä»£ç å—ä¸­æœ‰æ•ˆã€‚ 1234if(true)&#123; let a=3;&#125;console.log(a);// æŠ¥é”™ forå¾ªç¯ä¸­çš„è®¡æ•°å˜é‡éå¸¸é€‚åˆä½¿ç”¨let ä½¿ç”¨varå£°æ˜çš„ 1234567var a = [];for (var i = 0; i &lt; 10; i++) &#123; a[i] = function () &#123; console.log(i); &#125;;&#125;a[6](); // 10ï¼Œå› ä¸ºiæ˜¯å…¨å±€å˜é‡ï¼Œå…¨å±€æœ‰æ•ˆï¼Œè°ƒç”¨æ—¶å¾—åˆ°çš„æ˜¯æœ€åä¸€æ¬¡çš„å€¼ ä½¿ç”¨letå£°æ˜çš„ 1234567var a = [];for (let i = 0; i &lt; 10; i++) &#123; a[i] = function () &#123; console.log(i); &#125;;&#125;a[6](); // 6ï¼Œä½¿ç”¨letåï¼Œæ¯è½®å¾ªç¯çš„iï¼Œä»…åœ¨æœ¬è½®å¾ªç¯ä¸­æœ‰æ•ˆï¼Œè¿™æ ·å…¶å®æ¯è½®å¾ªç¯éƒ½æœ‰ä¸€ä¸ªæ–°çš„iå€¼ã€‚åå°è´Ÿè´£è®°å½•ä¸Šä¸€æ¬¡çš„iå€¼ï¼› forå¾ªç¯è®¾ç½®å¾ªç¯å˜é‡çš„éƒ¨åˆ†æ˜¯ä¸€ä¸ªçˆ¶ä½œç”¨åŸŸï¼Œå¾ªç¯ä½“æ˜¯ä¸€ä¸ªå­ä½œç”¨åŸŸï¼Œä½¿ç”¨letå£°æ˜ç›¸åŒçš„å˜é‡ä¸ä¼šç›¸äº’å¹²æ‰° 1234567for (let i = 0; i &lt; 3; i++) &#123; let i = 'abc'; console.log(i);&#125;// abc// abc// abc ä½¿ç”¨letï¼Œä¸å­˜åœ¨å˜é‡å£°æ˜æå‡ 1234567// var çš„æƒ…å†µconsole.log(foo); // è¾“å‡ºundefinedï¼Œå› ä¸ºå­˜åœ¨var foo;è¢«æå‡äº†var foo = 2;// let çš„æƒ…å†µconsole.log(bar); // æŠ¥é”™ReferenceErrorlet bar = 2; æš‚æ—¶æ€§æ­»åŒº ä¸ªäººç†è§£ï¼šES6åœ¨æ‰§è¡Œæ—¶ï¼Œå¯èƒ½å­˜åœ¨ä¸€ä¸ªé¢„å…ˆæ£€æŸ¥çš„è¿‡ç¨‹ï¼Œåªè¦æ£€æŸ¥åˆ°æŸä¸ªä»£ç å—ä¸­ä½¿ç”¨letå£°æ˜æŸå˜é‡åï¼Œé‚£åœ¨letå£°æ˜ä¹‹å‰ä»»ä½•ä½¿ç”¨æ­¤å˜é‡çš„æ“ä½œ(åŒ…æ‹¬å¸¦æœ‰å®‰å…¨é˜²èŒƒæœºåˆ¶çš„typeof)éƒ½å°†æŠ¥é”™ã€‚ 123456var tmp = 123;if (true) &#123; tmp = 'abc'; // ReferenceErrorï¼Œæ£€æŸ¥åˆ°è¿™ä¸ªä»£ç å—ä½¿ç”¨äº†letå£°æ˜äº†tempï¼Œæ‰€ä»¥åœ¨letå£°æ˜ä¹‹å‰ä½¿ç”¨tmpæŠ¥é”™ï¼Œå³ä½¿å¤–éƒ¨æœ‰å…¨å±€å˜é‡ã€‚ let tmp;&#125; ä½¿ç”¨typeofä¹Ÿä¼šæŠ¥é”™ 12typeof x;// æŠ¥é”™ï¼Œæ˜¾ç¤ºxè¿˜æœªå®šä¹‰ï¼Œå¦‚æœæ²¡æœ‰letï¼Œå› ä¸ºtypeofå­˜åœ¨å®‰å…¨é˜²èŒƒæœºåˆ¶ï¼Œæ‰€ä»¥è¿”å›çš„æ˜¯'undefined'let x; ä¸å…è®¸é‡å¤å£°æ˜ letä¸å…è®¸åœ¨ç›¸åŒä½œç”¨åŸŸå†…ï¼Œé‡å¤å£°æ˜åŒä¸€ä¸ªå˜é‡ 1234567891011// æŠ¥é”™function func() &#123; let a = 10; var a = 1;&#125;// æŠ¥é”™function func() &#123; let a = 10; let a = 1;&#125; ä¸èƒ½åœ¨å‡½æ•°å†…éƒ¨é‡æ–°å£°æ˜å‚æ•° 123456789function func(arg) &#123; let arg; // æŠ¥é”™&#125;function func(arg) &#123; &#123; let arg; // ä¸æŠ¥é”™ &#125;&#125; ES6å—çº§ä½œç”¨åŸŸ letå®é™…ä¸Šä¸º JavaScript æ–°å¢äº†å—çº§ä½œç”¨åŸŸ å—çº§ä½œç”¨åŸŸçš„ä»»æ„åµŒå¥— 1&#123;&#123;&#123;&#123;&#123;let insane = 'Hello World'&#125;&#125;&#125;&#125;&#125;; å¤–å±‚ä½œç”¨åŸŸæ— æ³•è¯»å–å†…å±‚ä½œç”¨åŸŸçš„å˜é‡ï¼Œå†…å±‚ä½œç”¨åŸŸå¯ä»¥å®šä¹‰å¤–å±‚ä½œç”¨åŸŸçš„åŒåå˜é‡ 123456789&#123;&#123;&#123;&#123; &#123;let insane = &apos;Hello World&apos;&#125; console.log(insane); // æŠ¥é”™&#125;&#125;&#125;&#125;;&#123;&#123;&#123;&#123; let insane = &apos;Hello World&apos;; &#123;let insane = &apos;Hello World&apos;&#125;&#125;&#125;&#125;&#125;; æœ€å¥½ä¸è¦åœ¨å—çº§ä½œç”¨åŸŸä¸­ä½¿ç”¨functionå£°æ˜å‡½æ•°(å¯ä»¥ä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼æ¥åˆ›å»ºå‡½æ•°) const conståŸºæœ¬å’Œletç±»ä¼¼ï¼Œåªåœ¨å£°æ˜æ‰€åœ¨çš„å—çº§ä½œç”¨åŸŸå†…æœ‰æ•ˆã€å­˜åœ¨æš‚æ—¶æ€§æ­»åŒºã€åŒä¸€ä½œç”¨åŸŸä¸å¯é‡å¤å£°æ˜ï¼›é‡è¦çš„æ˜¯ä¸€æ—¦å£°æ˜ï¼Œå¸¸é‡çš„å€¼å°±ä¸èƒ½æ”¹å˜ã€‚ 1234const PI = 3.1415;PI // 3.1415PI = 3; constå£°æ˜ä¸€ä¸ªå˜é‡æ—¶ï¼Œå¿…é¡»ç«‹å³ç»™å…¶èµ‹å€¼ï¼Œä¸èƒ½å…ˆå£°æ˜ï¼ŒåæœŸå†èµ‹å€¼ 12const foo;// SyntaxError: Missing initializer in const declarationfoo=3; è§£æ„èµ‹å€¼ ES6å…è®¸æŒ‰ç…§ä¸€å®šçš„æ¨¡å¼ï¼Œä»æ•°ç»„å’Œå¯¹è±¡ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¿‡ç¨‹ç§°ä¹‹ä¸ºè§£æ„è¿‡ç¨‹Destructuring æ•°ç»„çš„è§£æ„èµ‹å€¼1let [a, b, c] = [1, 2, 3]; è¿™ç§å†™æ³•å±äºâ€œæ¨¡å¼åŒ¹é…â€ï¼Œåªè¦ç­‰å·ä¸¤è¾¹çš„æ¨¡å¼ç›¸åŒï¼Œå·¦è¾¹çš„å˜é‡å°±ä¼šè¢«èµ‹äºˆå¯¹åº”çš„å€¼ã€‚ 1234567891011121314151617181920let [foo, [[bar], baz]] = [1, [[2], 3]];foo // 1bar // 2baz // 3let [ , , third] = ["foo", "bar", "baz"];third // "baz"let [x, , y] = [1, 2, 3];x // 1y // 3let [head, ...tail] = [1, 2, 3, 4];head // 1tail // [2, 3, 4]let [x, y, ...z] = ['a'];x // "a"y // undefinedz // [] è§£æ„ä¸æˆåŠŸæ—¶ï¼Œå˜é‡çš„å€¼å°±ç­‰äºundefined 1let [bar, foo] = [1];// barä¸º1ï¼Œfooä¸ºundefined ä¸å®Œå…¨è§£æ„ ç­‰å·å·¦è¾¹çš„æ¨¡å¼ï¼ŒåªåŒ¹é…ä¸€éƒ¨åˆ†çš„ç­‰å·å³è¾¹çš„æ•°ç»„ï¼›è§£æ„ä¾ç„¶ä¼šæˆåŠŸ12345678let [x, y] = [1, 2, 3];x // 1y // 2let [a, [b], d] = [1, [2, 3], 4];a // 1b // 2d // 4 å¦‚æœç­‰å·çš„å³è¾¹ä¸æ˜¯æ•°ç»„ï¼ˆæˆ–è€…ä¸¥æ ¼åœ°è¯´ï¼Œä¸æ˜¯å¯éå†çš„ç»“æ„ï¼Œå‚è§ã€ŠIteratorã€‹ä¸€ç« ï¼‰ï¼Œé‚£ä¹ˆå°†ä¼šæŠ¥é”™ 1234567// æŠ¥é”™let [foo] = 1;// è½¬ä¸ºå¯¹è±¡ä»¥åä¸å…·å¤‡ Iterator æ¥å£let [foo] = false;// è½¬ä¸ºå¯¹è±¡ä»¥åä¸å…·å¤‡ Iterator æ¥å£let [foo] = NaN;// è½¬ä¸ºå¯¹è±¡ä»¥åä¸å…·å¤‡ Iterator æ¥å£let [foo] = undefined;// è½¬ä¸ºå¯¹è±¡ä»¥åä¸å…·å¤‡ Iterator æ¥å£let [foo] = null;// è½¬ä¸ºå¯¹è±¡ä»¥åä¸å…·å¤‡ Iterator æ¥å£let [foo] = &#123;&#125;;// æœ¬èº«å°±ä¸å…·å¤‡ Iterator æ¥å£ è§£æ„æ—¶å¯ä»¥æœ‰é»˜è®¤å€¼ 12345let [foo = true] = [];foo // truelet [x, y = 'b'] = ['a']; // x='a', y='b'let [x, y = 'b'] = ['a', undefined]; // x='a', y='b' é»˜è®¤å€¼åªæœ‰åœ¨å½“ä¸€ä¸ªæˆå‘˜ä¸¥æ ¼ç›¸ç­‰äº(===)undefinedæ—¶(æœ¬èº«å€¼ä¸ºundefinedï¼Œæˆ–è€…æ²¡æœ‰å€¼)ï¼Œæ‰ä¼šç”Ÿæ•ˆï¼Œè¿™å°±æ˜¯ä¸Šé¢ï¼Œæœ€åçš„yä¸º&#39;b&#39;çš„åŸå› 12345678let [a = 1] = [];// æ— å€¼ï¼Œé»˜è®¤å€¼ç”Ÿæ•ˆa // 1let [x = 1] = [undefined];// å€¼ä¸ºundefinedï¼Œé»˜è®¤å€¼ç”Ÿæ•ˆx // 1let [x = 1] = [null];// å› ä¸ºnull!==undefinedï¼Œé»˜è®¤å€¼å¹¶æœªç”Ÿæ•ˆx // null å¯¹è±¡çš„è§£æ„èµ‹å€¼123let &#123; foo, bar &#125; = &#123; foo: "aaa", bar: "bbb" &#125;;foo // "aaa"bar // "bbb" æ•°ç»„æ˜¯æœ‰é¡ºåºçš„ï¼Œæ‰€ä»¥è§£æ„æ˜¯æŒ‰ç…§é¡ºåºæ¥åŒ¹é…ï¼Œè€Œå¯¹è±¡æ²¡æœ‰å›ºå®šçš„é¡ºåºï¼Œæ‰€ä»¥ç»“æ„æ—¶å˜é‡å¿…é¡»å’Œå±æ€§åŒåï¼Œæ‰èƒ½å–åˆ°æ­£ç¡®çš„å€¼ 123456let &#123; bar, foo &#125; = &#123; foo: "aaa", bar: "bbb" &#125;;// åŒ¹é…å’Œé¡ºåºæ— å…³foo // "aaa"bar // "bbb"let &#123; baz &#125; = &#123; foo: "aaa", bar: "bbb" &#125;;// æ‰¾ä¸åˆ°åŒåçš„å±æ€§ï¼Œæ‰€ä»¥å˜é‡å–å€¼ä¸æˆåŠŸbaz // undefined å¦‚æœæƒ³æŠŠå–åˆ°çš„å€¼èµ‹ç»™å¦å¤–ä¸€ä¸ªå˜é‡åˆ™å¿…é¡»ç”¨ä¸‹é¢çš„å†™æ³• 1234567let &#123; foo: baz &#125; = &#123; foo: 'aaa', bar: 'bbb' &#125;;// fooå–åˆ°çš„å€¼'aaa'è¢«èµ‹ç»™äº†bazå˜é‡baz // "aaa"let obj = &#123; first: 'hello', last: 'world' &#125;;let &#123; first: f, last: l &#125; = obj;f // 'hello'l // 'world' å¯¹è±¡è§£æ„èµ‹å€¼çš„æœ¬è´¨ {æ¨¡å¼å:å˜é‡å,æ¨¡å¼å:å˜é‡åâ€¦}={å±æ€§å:å€¼,å±æ€§å:å€¼â€¦} é€šè¿‡å·¦ä¾§æ¨¡å¼åå»æ‰¾å¯¹åº”çš„å±æ€§åï¼Œå–åˆ°å¯¹åº”å±æ€§åçš„å€¼åï¼Œå°†å€¼èµ‹å€¼ç»™æ¨¡å¼ååé¢çš„å˜é‡åï¼› å½“å·¦ä¾§æ¨¡å¼åé¢çš„å˜é‡åæ²¡æœ‰æ—¶ï¼Œä¼šå–æ¨¡å¼çš„åå­—ï¼› 12let &#123; foo, bar &#125; = &#123; foo: "aaa", bar: "bbb" &#125;;// å’Œä¸‹é¢çš„æ˜¯ç­‰ä»·çš„let &#123; foo: foo, bar: bar &#125; = &#123; foo: "aaa", bar: "bbb" &#125;; å¯¹åº”å…³ç³»:æ¨¡å¼å-&gt;å±æ€§åï¼›å˜é‡å-&gt;å€¼ 123let &#123; foo: baz &#125; = &#123; foo: "aaa", bar: "bbb" &#125;;baz // "aaa"foo // error: foo is not definedï¼Œfooä¸æ˜¯å˜é‡è€Œæ˜¯ä¸€ä¸ªæ¨¡å¼ å¯¹è±¡è§£æ„å’Œæ•°ç»„è§£æ„ä¸€æ ·å¯ä»¥åµŒå¥—è§£æ„ è¿™æ—¶çš„pæ˜¯æ¨¡å¼å¹¶éå˜é‡ 12345678910let obj = &#123; p: [ 'Hello', &#123; y: 'World' &#125; ]&#125;;let &#123; p: [x, &#123; y &#125;] &#125; = obj;x // "Hello"y // "World" å–å¾—pçš„å€¼ 1234567891011let obj = &#123; p: [ 'Hello', &#123; y: 'World' &#125; ]&#125;;let &#123; p, p: [x, &#123; y &#125;] &#125; = obj;// ç›¸å½“äºlet &#123; p:p, p: [x, &#123; y &#125;] &#125; = objx // "Hello"y // "World"p // ["Hello", &#123;y: "World"&#125;] å¤šå±‚åµŒå¥— 12345678910111213const node = &#123; loc: &#123; start: &#123; line: 1, column: 5 &#125; &#125;&#125;;let &#123; loc, loc: &#123; start &#125;, loc: &#123; start: &#123; line &#125;&#125; &#125; = node;// ç›¸å½“äºlet &#123; loc:loc, loc: &#123; start:start &#125;, loc: &#123; start: &#123; line:line &#125;&#125; &#125; = nodeline // 1loc // Object &#123;start: Object&#125;start // Object &#123;line: 1, column: 5&#125; é»˜è®¤å€¼ 123456789101112131415var &#123;x = 3&#125; = &#123;&#125;;x // 3var &#123;x, y = 5&#125; = &#123;x: 1&#125;;x // 1y // 5var &#123;x: y = 3&#125; = &#123;&#125;;y // 3var &#123;x: y = 3&#125; = &#123;x: 5&#125;;// æ¨¡å¼æ˜¯xï¼Œå˜é‡æ˜¯yï¼Œå¹¶ä¸”yæœ‰ä¸ªé»˜è®¤å€¼3y // 5var &#123; message: msg = 'Something went wrong' &#125; = &#123;&#125;;msg // "Something went wrong" é»˜è®¤å€¼ç”Ÿæ•ˆçš„æ¡ä»¶æ˜¯ï¼Œå¯¹è±¡çš„å±æ€§å€¼ä¸¥æ ¼ç­‰äºundefined12345var &#123;x = 3&#125; = &#123;x: undefined&#125;;x // 3var &#123;x = 3&#125; = &#123;x: null&#125;;// null!==undefinedï¼Œæ‰€ä»¥é»˜è®¤å€¼ä¸ç”Ÿæ•ˆx // null è§£æ„å¤±è´¥ï¼Œåˆ™å˜é‡çš„å€¼ä¸ºundefined 12let &#123;foo&#125; = &#123;bar: 'baz'&#125;;foo // undefined å¦‚æœè§£æ„æ¨¡å¼æ˜¯åµŒå¥—çš„å¯¹è±¡ï¼Œè€Œä¸”å­å¯¹è±¡æ‰€åœ¨çš„çˆ¶å±æ€§ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°†ä¼šæŠ¥é”™ 12// æŠ¥é”™let &#123;foo: &#123;bar&#125;&#125; = &#123;baz: 'baz'&#125;;// å› ä¸ºfooæ ¹æœ¬å°±æ²¡æ‰¾åˆ°æ­¤æ—¶fooä¸ºundefinedï¼Œåœ¨undefinedä¸‹æ‰¾barè‚¯å®šæŠ¥é”™ é’ˆå¯¹å·²ç»å£°æ˜çš„å˜é‡ä½¿ç”¨è§£æ„èµ‹å€¼æ—¶ï¼Œéœ€è¦åœ¨æœ€å¤–å›´åŠ ä¸Šæ‹¬å· 1234567// é”™è¯¯çš„å†™æ³•let x;&#123;x&#125; = &#123;x: 1&#125;;// SyntaxError: syntax error è¯­æ³•å—ä¸èƒ½è¢«èµ‹å€¼// æ­£ç¡®çš„å†™æ³•let x;(&#123;x&#125; = &#123;x: 1&#125;); å¯ä»¥å°†åŸç”Ÿå¯¹è±¡çš„å±æ€§æ–¹æ³•è§£æ„åˆ°å˜é‡ä¸Š 1let &#123; log, sin, cos &#125; = Math; è¿ç”¨è§£æ„è·å–æ•°ç»„çš„é¦–ä¸ªå’Œæœ«å°¾å…ƒç´  1234let arr = [1, 2, 3];let &#123;0 : first, [arr.length - 1] : last&#125; = arr;first // 1last // 3 éå¯¹è±¡çš„è§£æ„èµ‹å€¼ è§£æ„èµ‹å€¼çš„è§„åˆ™æ˜¯ï¼Œåªè¦ç­‰å·å³è¾¹çš„å€¼ä¸æ˜¯å¯¹è±¡æˆ–æ•°ç»„ï¼Œå°±å…ˆå°†å…¶è½¬ä¸ºå¯¹è±¡ã€‚ç”±äºundefinedå’Œnullæ— æ³•è½¬ä¸ºå¯¹è±¡ï¼Œæ‰€ä»¥å¯¹å®ƒä»¬è¿›è¡Œè§£æ„èµ‹å€¼ï¼Œéƒ½ä¼šæŠ¥é”™ã€‚ 12let &#123; prop: x &#125; = undefined; // TypeErrorlet &#123; prop: y &#125; = null; // TypeError å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼ å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥è§£æ„èµ‹å€¼ã€‚è¿™æ˜¯å› ä¸ºæ­¤æ—¶ï¼Œå­—ç¬¦ä¸²è¢«è½¬æ¢æˆäº†ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡(åŒ…è£…å¯¹è±¡)ã€‚12345678const [a, b, c, d, e] = 'hello';a // "h"b // "e"c // "l"d // "l"e // "o"let &#123;length : len&#125; = 'hello';len // 5 æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼ è§£æ„èµ‹å€¼æ—¶ï¼Œå¦‚æœç­‰å·å³è¾¹æ˜¯æ•°å€¼å’Œå¸ƒå°”å€¼ï¼Œåˆ™ä¼šå…ˆè½¬ä¸ºå¯¹è±¡ã€‚12345let &#123;toString: s&#125; = 123;s === Number.prototype.toString // truelet &#123;toString: s&#125; = true;s === Boolean.prototype.toString // true å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼ ä¾‹å­ 1234567function add([x, y])&#123; return x + y;&#125;add([1, 2]); // 3[[1, 2], [3, 4]].map(([a, b]) =&gt; a + b);// [ 3, 7 ] å‚æ•°è§£æ„ä½¿ç”¨é»˜è®¤å€¼ 123456789101112131415161718function move(&#123;x = 0, y = 0&#125; = &#123;&#125;) &#123; return [x, y];&#125;move(&#123;x: 3, y: 8&#125;); // [3, 8]ï¼›&#123;x = 0, y = 0&#125;=&#123;x: 3, y: 8&#125;move(&#123;x: 3&#125;); // [3, 0]ï¼›&#123;x = 0, y = 0&#125;=&#123;x: 3&#125;move(&#123;&#125;); // [0, 0]ï¼›&#123;x = 0, y = 0&#125;=&#123;&#125;move(); // [0, 0]ï¼›&#123;x = 0, y = 0&#125;=&#123;&#125;// å¦ä¸€ç§å†™æ³•function move(&#123;x, y&#125; = &#123; x: 0, y: 0 &#125;) &#123; return [x, y];&#125;move(&#123;x: 3, y: 8&#125;); // [3, 8]ï¼›&#123;x, y&#125;=&#123;x: 3, y: 8&#125;move(&#123;x: 3&#125;); // [3, undefined]ï¼›&#123;x, y&#125;=&#123;x: 3&#125;move(&#123;&#125;); // [undefined, undefined]ï¼›&#123;x, y&#125;=&#123;&#125;move(); // [0, 0]ï¼›&#123;x, y&#125;=&#123; x: 0, y: 0 &#125; undefinedä¼šè§¦å‘å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ 12[1, undefined, 3].map((x = 'yes') =&gt; x);// ç´¢å¼•1ä¸ºundefinedï¼Œæ‰€ä»¥é»˜è®¤å€¼ç”Ÿæ•ˆ// [ 1, 'yes', 3 ] åœ†æ‹¬å·é—®é¢˜ å¯¹äºç¼–è¯‘å™¨æ¥è¯´ï¼Œä¸€ä¸ªå¼å­åˆ°åº•æ˜¯æ¨¡å¼ï¼Œè¿˜æ˜¯è¡¨è¾¾å¼ï¼Œæ²¡æœ‰åŠæ³•ä»ä¸€å¼€å§‹å°±çŸ¥é“ï¼Œå¿…é¡»è§£æåˆ°ï¼ˆæˆ–è§£æä¸åˆ°ï¼‰ç­‰å·æ‰èƒ½çŸ¥é“.ES6 çš„è§„åˆ™æ˜¯ï¼Œåªè¦æœ‰å¯èƒ½å¯¼è‡´è§£æ„çš„æ­§ä¹‰ï¼Œå°±ä¸å¾—ä½¿ç”¨åœ†æ‹¬å·ã€‚å»ºè®®åªè¦æœ‰å¯èƒ½ï¼Œå°±ä¸è¦åœ¨æ¨¡å¼ä¸­æ”¾ç½®åœ†æ‹¬å·ã€‚ ä¸èƒ½ç”¨åœ†æ‹¬å·çš„æƒ…å†µ å˜é‡å£°æ˜è¯­å¥ 123456789// å…¨éƒ¨æŠ¥é”™let [(a)] = [1];let &#123;x: (c)&#125; = &#123;&#125;;let (&#123;x: c&#125;) = &#123;&#125;;let &#123;(x: c)&#125; = &#123;&#125;;let &#123;(x): c&#125; = &#123;&#125;;let &#123; o: (&#123; p: p &#125;) &#125; = &#123; o: &#123; p: 2 &#125; &#125;; å‡½æ•°å‚æ•° å‡½æ•°å‚æ•°ä¹Ÿå±äºå˜é‡å£°æ˜ï¼Œå› æ­¤ä¸èƒ½å¸¦æœ‰åœ†æ‹¬å·1234// æŠ¥é”™function f([(z)]) &#123; return z; &#125;// æŠ¥é”™function f([z,(x)]) &#123; return x; &#125; èµ‹å€¼è¯­å¥çš„æ¨¡å¼ä¸­ 123456// å…¨éƒ¨æŠ¥é”™(&#123; p: a &#125;) = &#123; p: 42 &#125;;([a]) = [5];// æŠ¥é”™[(&#123; p: a &#125;), &#123; x: c &#125;] = [&#123;&#125;, &#123;&#125;]; å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ èµ‹å€¼è¯­å¥çš„éæ¨¡å¼éƒ¨åˆ†ï¼Œå¯ä»¥ä½¿ç”¨åœ†æ‹¬å·ã€‚ 123[(b)] = [3]; // æ­£ç¡®(&#123; p: (d) &#125; = &#123;&#125;); // æ­£ç¡®[(parseInt.prop)] = [3]; // æ­£ç¡® è§£æ„èµ‹å€¼çš„ç”¨é€” äº¤æ¢å˜é‡çš„å€¼ 1234let x = 1;let y = 2;[x, y] = [y, x]; ä»å‡½æ•°è¿”å›å¤šä¸ªå€¼ 123456789101112131415// è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œç„¶åé€šè¿‡è§£æ„èµ‹å€¼èµ‹å€¼ç»™å˜é‡function example() &#123; return [1, 2, 3];&#125;let [a, b, c] = example();// è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œç„¶åé€šè¿‡è§£æ„èµ‹å€¼èµ‹å€¼ç»™å˜é‡function example() &#123; return &#123; foo: 1, bar: 2 &#125;;&#125;let &#123; foo, bar &#125; = example(); å‡½æ•°å‚æ•°çš„å®šä¹‰ 1234567// å‚æ•°æ˜¯ä¸€ç»„æœ‰æ¬¡åºçš„å€¼function f([x, y, z]) &#123; ... &#125;f([1, 2, 3]);// å‚æ•°æ˜¯ä¸€ç»„æ— æ¬¡åºçš„å€¼function f(&#123;x, y, z&#125;) &#123; ... &#125;f(&#123;z: 3, y: 2, x: 1&#125;); æå–JSONæ•°æ® 12345678910let jsonData = &#123; id: 42, status: "OK", data: [867, 5309]&#125;;let &#123; id, status, data: number &#125; = jsonData;console.log(id, status, number);// 42, "OK", [867, 5309] å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ 1234567891011jQuery.ajax = function (url, &#123; async = true, beforeSend = function () &#123;&#125;, cache = true, complete = function () &#123;&#125;, crossDomain = false, global = true, // ... more config&#125;) &#123; // ... do stuff&#125;; éå†Mapç»“æ„ 12345678910111213141516171819const map = new Map();map.set('first', 'hello');map.set('second', 'world');for (let [key, value] of map) &#123; console.log(key + " is " + value);&#125;// first is hello// second is world// è·å–é”®åfor (let [key] of map) &#123; // ...&#125;// è·å–é”®å€¼for (let [,value] of map) &#123; // ...&#125; è¾“å…¥æ¨¡å—çš„æŒ‡å®šæ–¹æ³• 1const &#123; SourceMapConsumer, SourceNode &#125; = require("source-map"); å­—ç¬¦ä¸²çš„æ‰©å±•ä½¿ç”¨å¤§æ‹¬å·è¡¨ç¤ºè¶…è¿‡ffffçš„å­—ç¬¦1234567"ğ ®·"çš„unicodeç¼–ç ä¸º\u20BB7ï¼Œè¶…è¿‡ffffï¼Œåœ¨es5ä¸­å¿…é¡»æ‹†åˆ†æˆä¸¤ä¸ªæ¥å†™"\uD842\uDFB7"// "ğ ®·"es6ä¸­å¯ä»¥ä½¿ç”¨&#123;&#125;åŒ…è£¹æ¥å®Œæˆè¶…è¿‡ffffå­—ç¬¦çš„æ˜¾ç¤º"\u&#123;20BB7&#125;"// "ğ ®·" codePointAt codePointAtæ–¹æ³•ä¼šæ­£ç¡®è¿”å›32ä½çš„UTF-16å­—ç¬¦çš„åè¿›åˆ¶è¡¨ç¤ºã€‚å¯¹äºé‚£äº›ä¸¤ä¸ªå­—èŠ‚å‚¨å­˜çš„å¸¸è§„å­—ç¬¦ï¼Œå®ƒçš„è¿”å›ç»“æœä¸charCodeAtæ–¹æ³•ç›¸åŒ 123let s = 'ğ ®·a';s.codePointAt(0).toString(16) // "20bb7" codePointAtæ–¹æ³•æ˜¯æµ‹è¯•ä¸€ä¸ªå­—ç¬¦ç”±ä¸¤ä¸ªå­—èŠ‚è¿˜æ˜¯ç”±å››ä¸ªå­—èŠ‚ç»„æˆçš„æœ€ç®€å•æ–¹æ³•ã€‚ 123456function is32Bit(c) &#123; return c.codePointAt(0) &gt; 0xFFFF;&#125;is32Bit("ğ ®·") // trueis32Bit("a") // false String.fromCodePoin String.fromCharCodeçš„å‡çº§ç‰ˆæœ¬èƒ½å°†è¶…è¿‡ffffçš„ç¼–ç è½¬æ¢æˆå­—ç¬¦1234String.fromCharCode(0x20BB7)// "à®·"String.fromCodePoint(0x20BB7)// "ğ ®·" at charAtçš„å‡çº§ç‰ˆï¼Œè¿”å›å¯¹åº”ä½ç½®å­—ç¬¦ï¼Œå¯è¯†åˆ«è¶…è¿‡ffffçš„å­—ç¬¦12345'abc'.charAt(0) // "a"'ğ ®·'.charAt(0) // "\uD842",ğ ®·æ˜¯32bitçš„ï¼Œå®ƒè¿”å›çš„æ˜¯é«˜16ä½çš„ç¼–ç 'abc'.at(0) // "a"'ğ ®·'.at(0) // "ğ ®·" å­—ç¬¦ä¸²çš„éå†å™¨æ¥å£ es6ä¸ºå­—ç¬¦ä¸²æä¾›éå†æ¥å£ï¼Œå¯ä»¥ä½¿ç”¨forâ€¦oféå†ï¼Œå¹¶èƒ½éå†è¶…è¿‡ffffç¼–ç çš„å­—ç¬¦123456789101112131415161718for (let codePoint of 'foo') &#123; console.log(codePoint)&#125;// "f"// "o"// "o"let text = String.fromCodePoint(0x20BB7);for (let i = 0; i &lt; text.length; i++) &#123; console.log(text[i]);&#125;// " "// " "for (let i of text) &#123; console.log(i);&#125;// "ğ ®·" includes(), startsWith(), endsWith() includesè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ‰¾åˆ°äº†å‚æ•°å­—ç¬¦ä¸² startsWithè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨åŸå­—ç¬¦ä¸²çš„å¤´éƒ¨ã€‚ endsWithè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨åŸå­—ç¬¦ä¸²çš„å°¾éƒ¨ã€‚12345let s = 'Hello world!';s.startsWith('Hello') // trues.endsWith('!') // trues.includes('o') // true repeat é‡å¤æŸä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›æ–°çš„å­—ç¬¦ä¸²123'x'.repeat(3) // "xxx"'hello'.repeat(2) // "hellohello"'na'.repeat(0) // "" padStart(),padEnd() è¡¥é½å­—ç¬¦ä¸²é•¿åº¦ 123456789101112131415'x'.padStart(5, 'ab') // 'ababx''x'.padStart(4, 'ab') // 'abax''x'.padEnd(5, 'ab') // 'xabab''x'.padEnd(4, 'ab') // 'xaba'// å¦‚æœåŸå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œç­‰äºæˆ–å¤§äºæŒ‡å®šçš„æœ€å°é•¿åº¦ï¼Œåˆ™è¿”å›åŸå­—ç¬¦ä¸²ã€‚'xxx'.padStart(2, 'ab') // 'xxx''xxx'.padEnd(2, 'ab') // 'xxx'// å¦‚æœç”¨æ¥è¡¥å…¨çš„å­—ç¬¦ä¸²ä¸åŸå­—ç¬¦ä¸²ï¼Œä¸¤è€…çš„é•¿åº¦ä¹‹å’Œè¶…è¿‡äº†æŒ‡å®šçš„æœ€å°é•¿åº¦ï¼Œåˆ™ä¼šæˆªå»è¶…å‡ºä½æ•°çš„è¡¥å…¨å­—ç¬¦ä¸²ã€‚'abc'.padStart(10, '0123456789')// '0123456abc'// å¦‚æœçœç•¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œé»˜è®¤ä½¿ç”¨ç©ºæ ¼è¡¥å…¨é•¿åº¦ã€‚'x'.padStart(4) // ' x''x'.padEnd(4) // 'x ' padStartçš„å¸¸è§ç”¨é€”æ˜¯ä¸ºæ•°å€¼è¡¥å…¨æŒ‡å®šä½æ•° 123'1'.padStart(10, '0') // "0000000001"'12'.padStart(10, '0') // "0000000012"'123456'.padStart(10, '0') // "0000123456" æ¨¡æ¿å­—ç¬¦ä¸² æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆtemplate stringï¼‰æ˜¯å¢å¼ºç‰ˆçš„å­—ç¬¦ä¸²ï¼Œç”¨åå¼•å·ï¼ˆ`ï¼‰æ ‡è¯†ã€‚å®ƒå¯ä»¥å½“ä½œæ™®é€šå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼Œæˆ–è€…åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ 12345678910111213// æ™®é€šå­—ç¬¦ä¸²`In JavaScript '\n' is a line-feed.`// å¤šè¡Œå­—ç¬¦ä¸²`In JavaScript this is not legal.`console.log(`string text line 1string text line 2`);// å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡let name = "Bob", time = "today";`Hello $&#123;name&#125;, how are you $&#123;time&#125;?` æ¨¡æ¿å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ï¼Œéœ€è¦å°†å˜é‡åå†™åœ¨${}ä¹‹ä¸­ã€‚ 12345678910111213141516171819202122232425262728293031323334function authorize(user, action) &#123; if (!user.hasPrivilege(action)) &#123; throw new Error( // ä¼ ç»Ÿå†™æ³•ä¸º // 'User ' // + user.name // + ' is not authorized to do ' // + action // + '.' `User $&#123;user.name&#125; is not authorized to do $&#123;action&#125;.`); &#125;&#125;// å¤§æ‹¬å·å†…éƒ¨å¯ä»¥æ”¾å…¥ä»»æ„çš„JavaScriptè¡¨è¾¾å¼ï¼Œå¯ä»¥è¿›è¡Œè¿ç®—ï¼Œä»¥åŠå¼•ç”¨å¯¹è±¡å±æ€§let x = 1;let y = 2;`$&#123;x&#125; + $&#123;y&#125; = $&#123;x + y&#125;`// "1 + 2 = 3"`$&#123;x&#125; + $&#123;y * 2&#125; = $&#123;x + y * 2&#125;`// "1 + 4 = 5"let obj = &#123;x: 1, y: 2&#125;;`$&#123;obj.x + obj.y&#125;`// "3"// æ¨¡æ¿å­—ç¬¦ä¸²ä¹‹ä¸­è¿˜èƒ½è°ƒç”¨å‡½æ•°function fn() &#123; return "Hello World";&#125;`foo $&#123;fn()&#125; bar`// foo Hello World bar æ¨¡æ¿å­—ç¬¦ä¸²ç”šè‡³è¿˜èƒ½åµŒå¥— 123456789101112131415161718192021222324const tmpl = addrs =&gt; ` &lt;table&gt; $&#123;addrs.map(addr =&gt; ` &lt;tr&gt;&lt;td&gt;$&#123;addr.first&#125;&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;$&#123;addr.last&#125;&lt;/td&gt;&lt;/tr&gt; `).join('')&#125; &lt;/table&gt;`;const data = [ &#123; first: '&lt;Jane&gt;', last: 'Bond' &#125;, &#123; first: 'Lars', last: '&lt;Croft&gt;' &#125;,];console.log(tmpl(data));// &lt;table&gt;//// &lt;tr&gt;&lt;td&gt;&lt;Jane&gt;&lt;/td&gt;&lt;/tr&gt;// &lt;tr&gt;&lt;td&gt;Bond&lt;/td&gt;&lt;/tr&gt;//// &lt;tr&gt;&lt;td&gt;Lars&lt;/td&gt;&lt;/tr&gt;// &lt;tr&gt;&lt;td&gt;&lt;Croft&gt;&lt;/td&gt;&lt;/tr&gt;//// &lt;/table&gt; æ ‡ç­¾æ¨¡æ¿ å‡½æ•°ååç´§è·Ÿä¸€ä¸ªæ¨¡æ¿å­—ç¬¦ä¸² æ ‡ç­¾æ¨¡æ¿å…¶å®ä¸æ˜¯æ¨¡æ¿ï¼Œè€Œæ˜¯å‡½æ•°è°ƒç”¨çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ã€‚â€œæ ‡ç­¾â€æŒ‡çš„å°±æ˜¯å‡½æ•°ï¼Œç´§è·Ÿåœ¨åé¢çš„æ¨¡æ¿å­—ç¬¦ä¸²å°±æ˜¯å®ƒçš„å‚æ•°ã€‚ 123alert`123`// ç­‰åŒäºalert(123) å¦‚æœæ¨¡æ¿å­—ç¬¦é‡Œé¢æœ‰å˜é‡ï¼Œå°±ä¸æ˜¯ç®€å•çš„è°ƒç”¨äº†ï¼Œè€Œæ˜¯ä¼šå°†æ¨¡æ¿å­—ç¬¦ä¸²å…ˆå¤„ç†æˆå¤šä¸ªå‚æ•°ï¼Œå†è°ƒç”¨å‡½æ•° ä¼šå°†é™¤æ¨¡æ¿å­—ç¬¦ä¸²ä¸­å˜é‡ä»¥å¤–çš„å­—ç¬¦ä¸²åˆ†éš”æˆä¸€ä¸ªä¸ªå­—ç¬¦ä¸²ä¿å­˜åˆ°æ•°ç»„ä¸­å¹¶ä¼ å…¥å‡½æ•°ä¸­ï¼Œå¹¶å°†æ¨¡æ¿å­—ç¬¦ä¸²ä¸­å˜é‡æŒ‰é¡ºåºä¾æ¬¡ä¼ å…¥å‡½æ•°ä¸­ 1234567891011121314151617let a = 5;let b = 10;tag`Hello $&#123; a + b &#125; world $&#123; a * b &#125;`;// ç­‰åŒäºtag(['Hello ', ' world ', ''], 15, 50);function tag(stringArr, value1, value2)&#123; // stringArrä¸º['Hello ', ' world ', ''],value1ä¸º15,value2ä¸º50 // ...&#125;// ç­‰åŒäºfunction tag(stringArr, ...values)&#123; // stringArrä¸º['Hello ', ' world ', ''],values[15,20] // ...&#125; ç”¨é€” è¿‡æ»¤ç”¨æˆ·æ¶æ„è¾“å…¥ã€i18nå›½é™…åŒ–12345678910111213141516171819202122232425// ä¸€èˆ¬$&#123;sender&#125;ä¸ºç”¨æˆ·çš„è¾“å…¥let message = SaferHTML`&lt;p&gt;$&#123;sender&#125; has sent you a message.&lt;/p&gt;`;function SaferHTML(templateData) &#123; let s = templateData[0];// åŸæœ‰å­—ç¬¦ä¸²æ•°ç»„ for (let i = 1; i &lt; arguments.length; i++) &#123;// iä»1å¼€å§‹ let arg = String(arguments[i]);// å®é™…å–åˆ°çš„ä¸ºç”¨æˆ·è¾“å…¥ // è½¬ä¹‰ç”¨æˆ·è¾“å…¥ä¸­çš„ç‰¹æ®Šç¬¦å· s += arg.replace(/&amp;/g, "&amp;amp;") .replace(/&lt;/g, "&amp;lt;") .replace(/&gt;/g, "&amp;gt;"); // æ‹¼æ¥ä¸ŠåŸæœ‰å­—ç¬¦ä¸²çš„åé¢éƒ¨åˆ† s += templateData[i]; &#125; return s;&#125;let sender = '&lt;script&gt;alert("abc")&lt;/script&gt;'; // æ¶æ„ä»£ç let message = SaferHTML`&lt;p&gt;$&#123;sender&#125; has sent you a message.&lt;/p&gt;`;console.log(message);// &lt;p&gt;&amp;lt;script&amp;gt;alert("abc")&amp;lt;/script&amp;gt; has sent you a message.&lt;/p&gt; String.raw è¿”å›ç”¨\è½¬ç§»çš„å­—ç¬¦ä¸²ä¸²12345String.raw`Hi\n$&#123;2+3&#125;!`;// "Hi\\n5!"String.raw`Hi\u000A!`;// 'Hi\\u000A!' æ­£åˆ™çš„æ‰©å±• è€æ­£åˆ™è¿˜ä¸ä¼šç”¨â€¦å…ˆæ”¾ç€ï¼ŒåæœŸå†è¡¥å§(å¸Œæœ›æˆ‘èƒ½æƒ³èµ·æ¥å§â€¦) æ•°å€¼çš„æ‰©å±• æ‰©å±•äº†ä¸€å¤§æ‰¹æ–¹æ³•â€¦(å…ˆè¿‡ä¸€éï¼Œç•™ä¸ªå°è±¡ï¼Œç”¨çš„æ—¶å€™å†æŸ¥å§) å‡½æ•°çš„æ‰©å±•å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ åˆ©ç”¨=ç›´æ¥å†™åœ¨å½¢å‚åé¢ 1234567function log(x, y = 'World') &#123;// yå¦‚æœ===undefinedï¼Œåˆ™yçš„é»˜è®¤å€¼ç”Ÿæ•ˆ console.log(x, y);&#125;log('Hello') // Hello Worldlog('Hello', 'China') // Hello Chinalog('Hello', '') // Hello å‚æ•°å˜é‡æ˜¯é»˜è®¤å£°æ˜çš„ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨letæˆ–constå†æ¬¡å£°æ˜ã€‚ 1234function foo(x = 5) &#123; let x = 1; // error const x = 2; // error&#125; å‚æ•°é»˜è®¤å€¼ä¸æ˜¯ä¼ å€¼çš„ï¼Œè€Œæ˜¯æ¯æ¬¡éƒ½é‡æ–°è®¡ç®—é»˜è®¤å€¼è¡¨è¾¾å¼çš„å€¼ 123456789let x = 99;function foo(p = x + 1) &#123; console.log(p);&#125;foo() // 100x = 100;foo() // 101 ä¸è§£æ„èµ‹å€¼é»˜è®¤å€¼ç»“åˆä½¿ç”¨ 1234567891011121314function foo(&#123;x, y = 5&#125;) &#123;// è§£æ„èµ‹å€¼é»˜è®¤å€¼ console.log(x, y);&#125;foo(&#123;&#125;) // undefined 5ï¼›&#123;x, y = 5&#125;=&#123;&#125;foo(&#123;x: 1&#125;) // 1 5ï¼›&#123;x, y = 5&#125;=&#123;x:1&#125;foo(&#123;x: 1, y: 2&#125;) // 1 2ï¼›&#123;x, y = 5&#125;:&#123;x:1,y:2&#125;foo() // TypeError: Cannot read property 'x' of undefinedï¼›&#123;x, y = 5&#125;=undefinedæ‰€ä»¥æŠ¥é”™function foo(&#123;x, y = 5&#125; = &#123;&#125;) &#123;// è§£æ„èµ‹å€¼é»˜è®¤å€¼+å½¢å‚é»˜è®¤å€¼ï¼Œå°±ä¸ä¼šå‡ºç°æŠ¥é”™ console.log(x, y);&#125;foo() // undefined 5 ä¸åŒå†™æ³•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475// å†™æ³•1function m1(x,y) &#123;// å½¢å‚(æ— é»˜è®¤å€¼) return [x, y];&#125;m1(1,3);//[1,3]m1();//[undefined,undefined]// å†™æ³•2function m1(x,y=5) &#123;// å½¢å‚(æœ‰é»˜è®¤å€¼) return [x, y];&#125;m1(1,3);//[1,3]m1(3);//[3,5]m1();//[undefined,5]// å†™æ³•3function m1(&#123;x , y&#125;) &#123;// è§£æ„èµ‹å€¼(æ— é»˜è®¤å€¼) return [x, y];&#125;m1(1,3);//[undefined,undefined];&#123;x,y&#125;=1,3;å·¦å³æ¨¡å¼ä¸ä¸€è‡´ï¼Œæ‰€ä»¥è§£æ„èµ‹å€¼ä¸æˆåŠŸï¼Œå¾—åˆ°undefinedm1(&#123;x:1,y:3&#125;);//[1,3]ï¼›&#123;x,y&#125;=&#123;x:1,y:3&#125;m1(&#123;x:1&#125;);//[1,undefined]ï¼›&#123;x,y&#125;=&#123;x:1&#125;m1(&#123;&#125;);[undefined,undefined]ï¼›&#123;x , y&#125;=&#123;&#125;ï¼›æœªæ‰¾åˆ°å¯¹åº”å±æ€§åï¼Œæ‰€ä»¥å¾—åˆ°undefinedm1();// errï¼›&#123;x,y&#125;=undefined-&gt;æ‰€ä»¥æŠ¥é”™// å†™æ³•4function m1(&#123;x = 0, y = 5&#125;) &#123;// è§£æ„èµ‹å€¼(æœ‰é»˜è®¤å€¼) return [x, y];&#125;m1(1,3);//[0,5];&#123;x = 0, y = 5&#125;=1,3ï¼›å·¦å³æ¨¡å¼ä¸åŒ¹é…ï¼Œå¾—åˆ°undefinedï¼Œå› è€Œè§£æ„é»˜è®¤å€¼ç”Ÿæ•ˆm1(&#123;x:1,y:3&#125;);//[1,3]ï¼›&#123;x = 0, y = 5&#125;=&#123;x:1,y:3&#125;m1(&#123;x:1&#125;);//[1,undefined]ï¼›&#123;x,y&#125;=&#123;x:1&#125;m1(&#123;&#125;);//[0,5]ï¼›&#123;x = 0, y = 5&#125;=&#123;&#125;ï¼›æœªæ‰¾åˆ°å¯¹åº”å±æ€§åï¼Œæ‰€ä»¥å¾—åˆ°undefinedï¼Œå› è€Œè§£æ„é»˜è®¤å€¼ç”Ÿæ•ˆm1();// errï¼›&#123;x = 0, y = 5&#125;=undefined-&gt;æ‰€ä»¥æŠ¥é”™// å†™æ³•5function m1(&#123;x , y&#125;=&#123;&#125;) &#123;// è§£æ„èµ‹å€¼(æ— é»˜è®¤å€¼)+å½¢å‚(æœ‰é»˜è®¤å€¼ï¼Œç©ºå¯¹è±¡) return [x, y];&#125;m1(1,3);//[undefined,undefined];&#123;x,y&#125;=1,3;å·¦å³æ¨¡å¼ä¸ä¸€è‡´ï¼Œæ‰€ä»¥è§£æ„èµ‹å€¼ä¸æˆåŠŸï¼Œå¾—åˆ°undefinedm1(&#123;x:1,y:3&#125;);//[1,3]ï¼›&#123;x , y&#125;=&#123;x:1,y:3&#125;m1(&#123;x:1&#125;);//[1,undefined]ï¼›&#123;x , y&#125;=&#123;x:1&#125;m1(&#123;&#125;);//[undefined,undefined]ï¼›&#123;x , y&#125;=&#123;&#125;ï¼›æœªæ‰¾åˆ°å¯¹åº”å±æ€§åï¼Œæ‰€ä»¥å¾—åˆ°undefinedm1();//[undefined,undefined]ï¼›&#123;x , y&#125;=&#123;&#125;// å†™æ³•6function m1(&#123;x , y&#125;=&#123;x:3,y:4&#125;) &#123;// è§£æ„èµ‹å€¼(æ— é»˜è®¤å€¼)+å½¢å‚(æœ‰é»˜è®¤å€¼ï¼Œéç©ºå¯¹è±¡) return [x, y];&#125;m1(1,3);//[undefined,undefined];&#123;x,y&#125;=1,3;å·¦å³æ¨¡å¼ä¸ä¸€è‡´ï¼Œæ‰€ä»¥è§£æ„èµ‹å€¼ä¸æˆåŠŸï¼Œå¾—åˆ°undefinedm1(&#123;x:1,y:3&#125;);//[1,3]ï¼›&#123;x , y&#125;=&#123;x:1,y:3&#125;m1(&#123;x:1&#125;);//[1,undefined]ï¼›&#123;x , y&#125;=&#123;x:1&#125;m1(&#123;&#125;);//[undefined,undefined]ï¼›&#123;x , y&#125;=&#123;&#125;ï¼›æœªæ‰¾åˆ°å¯¹åº”å±æ€§åï¼Œæ‰€ä»¥å¾—åˆ°undefinedm1();//[3,4]ï¼›&#123;x , y&#125;=&#123;x:3,y:4&#125;ï¼›æœªä¼ å‚æ•°ï¼Œæ‰€ä»¥å½¢å‚çš„é»˜è®¤å€¼&#123;x:3,y:4&#125;ç”Ÿæ•ˆï¼Œå‚ä¸è§£æ„// å†™æ³•7function m1(&#123;x = 0, y = 5&#125;=&#123;&#125;) &#123;// è§£æ„èµ‹å€¼(æœ‰é»˜è®¤å€¼)+å½¢å‚(æœ‰é»˜è®¤å€¼ï¼Œç©ºå¯¹è±¡) return [x, y];&#125;m1(1,3);//[0,5];ä¼ å…¥å‚æ•°è·Ÿæƒ³è¦çš„ç±»å‹ä¸ä¸€è‡´ï¼Œæ‰€ä»¥è¡Œå‚é»˜è®¤å€¼ç”Ÿæ•ˆ&#123;x = 0, y = 5&#125;=&#123;&#125;;æœªæ‰¾åˆ°å¯¹åº”å±æ€§åï¼Œæ‰€ä»¥è§£æ„é»˜è®¤å€¼ç”Ÿæ•ˆm1(&#123;x:1,y:3&#125;);//[1,3]ï¼›&#123;x = 0, y = 5&#125;=&#123;x:1,y:3&#125;// é»˜è®¤å€¼&#123;&#125;ä¸ç”Ÿæ•ˆm1(&#123;x:1&#125;);//[1,5]ï¼›&#123;x = 0, y = 5&#125;=&#123;x:1&#125; m1(&#123;&#125;);//[0,5]ï¼›&#123;x = 0, y = 5&#125;=&#123;&#125;ï¼›æœªæ‰¾åˆ°å¯¹åº”å±æ€§åï¼Œæ‰€ä»¥å¾—åˆ°undefinedï¼Œè§£æ„çš„é»˜è®¤å€¼ç”Ÿæ•ˆm1();//[0,5]ï¼›&#123;x = 0, y = 5&#125;=&#123;&#125;ï¼›æœªä¼ å‚æ•°ï¼Œæ‰€ä»¥å½¢å‚çš„é»˜è®¤å€¼&#123;&#125;ç”Ÿæ•ˆï¼Œå‚ä¸è§£æ„ï¼Œæœªè§£æ„åˆ°å¯¹åº”å±æ€§åï¼Œæ‰€ä»¥è§£æ„çš„é»˜è®¤å€¼ç”Ÿæ•ˆ// å†™æ³•8function m1(&#123;x = 0, y = 5&#125;=&#123;x:4,y:8&#125;) &#123;// è§£æ„èµ‹å€¼(æœ‰é»˜è®¤å€¼)+å½¢å‚(æœ‰é»˜è®¤å€¼ï¼Œéç©ºå¯¹è±¡) return [x, y];&#125;m1(1,3);//[0,5];ä¼ å…¥å‚æ•°è·Ÿæƒ³è¦çš„ç±»å‹ä¸ä¸€è‡´ï¼Œæ‰€ä»¥è¡Œå‚é»˜è®¤å€¼ç”Ÿæ•ˆ&#123;x = 0, y = 5&#125;=&#123;&#125;;æœªæ‰¾åˆ°å¯¹åº”å±æ€§åï¼Œæ‰€ä»¥è§£æ„é»˜è®¤å€¼ç”Ÿæ•ˆm1(&#123;x:1,y:3&#125;);//[1,3]ï¼›&#123;x = 0, y = 5&#125;=&#123;x:1,y:3&#125;m1(&#123;x:1&#125;);//[1,5]ï¼›&#123;x = 0, y = 5&#125;=&#123;x:1&#125; m1(&#123;&#125;);//[0,5]ï¼›&#123;x = 0, y = 5&#125;=&#123;&#125;ï¼›æœªæ‰¾åˆ°å¯¹åº”å±æ€§åï¼Œæ‰€ä»¥å¾—åˆ°undefinedï¼Œè§£æ„çš„é»˜è®¤å€¼ç”Ÿæ•ˆm1();//[4,8]ï¼›&#123;x = 0, y = 5&#125;=&#123;x:4,y:8&#125;ï¼›æœªä¼ å‚æ•°ï¼Œæ‰€ä»¥å½¢å‚çš„é»˜è®¤å€¼&#123;x:4,y:8&#125;ç”Ÿæ•ˆï¼Œå‚ä¸è§£æ„ å‚æ•°é»˜è®¤å€¼çš„ä½ç½® è¦è®¾ç½®é»˜è®¤å€¼çš„å‚æ•°ï¼Œåº”è¯¥æ”¾åœ¨å‚æ•°åˆ—è¡¨çš„å°¾éƒ¨ï¼Œå› ä¸ºè¿™æ ·æ–¹ä¾¿çœ‹å‡ºè°ƒç”¨æ—¶çœç•¥äº†å“ªäº›å‚æ•°12345678910111213141516171819// ä¾‹ä¸€function f(x = 1, y) &#123; return [x, y];&#125;f() // [1, undefined]f(2) // [2, undefined])f(, 1) // æŠ¥é”™f(undefined, 1) // [1, 1]// ä¾‹äºŒfunction f(x, y = 5, z) &#123; return [x, y, z];&#125;f() // [undefined, 5, undefined]f(1) // [1, 5, undefined]f(1, ,2) // æŠ¥é”™f(1, undefined, 2) // [1, 5, 2] å‡½æ•°çš„length è¿”å›æ²¡æœ‰æŒ‡å®šé»˜è®¤å€¼çš„å‚æ•°ä¸ªæ•°ï¼ŒæŒ‡å®šäº†é»˜è®¤å€¼åï¼Œlengthå±æ€§å°†å¤±çœŸ 123(function (a) &#123;&#125;).length // 1(function (a = 5) &#123;&#125;).length // 0(function (a, b, c = 5) &#123;&#125;).length // 2 å¦‚æœè®¾ç½®äº†é»˜è®¤å€¼çš„å‚æ•°ä¸æ˜¯å°¾å‚æ•°ï¼Œé‚£ä¹ˆlengthå±æ€§ä¹Ÿä¸å†è®¡å…¥åé¢çš„å‚æ•°äº†ã€‚ 12(function (a = 0, b, c) &#123;&#125;).length // 0(function (a, b = 1, c) &#123;&#125;).length // 1 ä½œç”¨åŸŸ ä¸€æ—¦è®¾ç½®äº†å‚æ•°çš„é»˜è®¤å€¼ï¼Œå‡½æ•°è¿›è¡Œå£°æ˜åˆå§‹åŒ–æ—¶ï¼Œå‚æ•°ä¼šå½¢æˆä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸï¼ˆcontextï¼‰ã€‚ç­‰åˆ°åˆå§‹åŒ–ç»“æŸï¼Œè¿™ä¸ªä½œç”¨åŸŸå°±ä¼šæ¶ˆå¤±ã€‚è¿™ç§è¯­æ³•è¡Œä¸ºï¼Œåœ¨ä¸è®¾ç½®å‚æ•°é»˜è®¤å€¼æ—¶ï¼Œæ˜¯ä¸ä¼šå‡ºç°çš„ï¼› è®¾ç½®é»˜è®¤å€¼æ—¶ï¼Œä¼šåœ¨å½¢å‚å£°æ˜å¤„ç”Ÿæˆä¸€ä¸ªå•ç‹¬çš„ä½œç”¨åŸŸã€‚å®ƒåªå¯ä»¥å—å…¨å±€ä½œç”¨å½±å“ï¼Œä¸å—å‡½æ•°ä½“å†…çš„ä½œç”¨åŸŸå½±å“123456789101112131415161718192021222324252627282930313233var x = 1;function f(x, y = x) &#123;// ç­‰ä»·äºlet x;let y=x;å› ä¸ºå½¢å‚å¤„å·²ç»å£°æ˜äº†xï¼Œæ‰€ä»¥y=xåï¼Œxyéƒ½ä¸ºåŒä¸€ä¸ªå€¼-&gt;å®é™…ä¼ è¿›æ¥çš„å€¼ï¼Œè€Œä¸æ˜¯å…¨å±€çš„x console.log(x,y);&#125;f(2) // 2function f(y = x) &#123;// let y=x;å¤–éƒ¨æ²¡æœ‰å®šä¹‰xæ‰€ä»¥æŠ¥é”™(å½¢å‚ä¸å—å‡½æ•°ä½“å†…å½±å“) let x = 2; console.log(y);&#125;f() // ReferenceError: x is not definedvar x = 1;function foo(x = x) &#123;// let x=x;ç”±äºtdzï¼Œxåœ¨å£°æ˜ç»“æŸå‰æ— æ³•ä½¿ç”¨x // ...&#125;foo() // ReferenceError: x is not definedlet foo = 'outer';function bar(func = () =&gt; foo) &#123; let foo = 'inner'; console.log(func());&#125;bar(); // outervar x = 1;function foo(x, y = function() &#123; x = 2; &#125;) &#123;// å› ä¸ºå½¢å‚å‡ºå·²ç»æœ‰äº†x,æ‰€ä»¥yçš„åŒ¿åå‡½æ•°ä¸­çš„xæŒ‡å‘çš„ä¹Ÿå°±æ˜¯å½¢å‚å¤„çš„xï¼Œå®ƒå°±ä¸ä¼šå†å—å¤–ç•Œå½±å“äº† var x = 3;// åœ¨å‡½æ•°ä½“å†…é‡æ–°å£°æ˜äº†ä¸€ä¸ªxå’Œå¤–ç•Œçš„xä¸æ˜¯åŒä¸€ä¸ª y();//è°ƒç”¨åï¼Œæ”¹å˜çš„æ˜¯å½¢å‚çš„x console.log(x);// æ ¹æ®å°±è¿‘åŸåˆ™ï¼Œæ‰¾åˆ°çš„æ˜¯å‡½æ•°ä½“ä¸­çš„xï¼Œæ‰€ä»¥æ‰“å°ä¸æ˜¯è¡Œå‚çš„xï¼Œå¦‚æœå»æ‰var x=3;åˆ™æ‰“å°çš„æ˜¯å½¢å‚çš„x&#125;foo() // 3x // 1 å‚æ•°é»˜è®¤å€¼çš„åº”ç”¨ åˆ©ç”¨å‚æ•°é»˜è®¤å€¼ï¼Œå¯ä»¥æŒ‡å®šæŸä¸€ä¸ªå‚æ•°ä¸å¾—çœç•¥ï¼Œå¦‚æœçœç•¥å°±æŠ›å‡ºä¸€ä¸ªé”™è¯¯12345678910function throwIfMissing() &#123; throw new Error('Missing parameter');&#125;function foo(mustBeProvided = throwIfMissing()) &#123; return mustBeProvided;&#125;foo()// Error: Missing parameter restå‚æ•° ç”¨äºè·å–å‡½æ•°çš„å‰©ä½™å‚æ•°ï¼Œå°†å…¶ä¿å­˜åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä½¿ç”¨argumentså¯¹è±¡äº† 1234567891011function add(...values) &#123; let sum = 0; for (var val of values) &#123; sum += val; &#125; return sum;&#125;add(2, 5, 3) // 10 å’Œargumentsçš„åŒºåˆ« argumentsæ˜¯ä¸€ä¸ªç±»æ•°ç»„ï¼Œå¹¶ä¸æ˜¯çœŸæ­£çš„æ•°ç»„ restå¾—åˆ°çš„æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ•°ç»„ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨æ•°ç»„çš„æ–¹æ³•1234567// argumentså˜é‡çš„å†™æ³•function sortNumbers() &#123; return Array.prototype.slice.call(arguments).sort();&#125;// restå‚æ•°çš„å†™æ³•const sortNumbers = (...numbers) =&gt; numbers.sort(); restå‚æ•°å¿…é¡»æ”¾åœ¨å½¢å‚åˆ—è¡¨çš„å°¾éƒ¨ 1234// æŠ¥é”™function f(a, ...b, c) &#123; // ...&#125; å‡½æ•°çš„lengthå±æ€§ï¼Œä¸åŒ…æ‹¬ rest å‚æ•°ã€‚ 123(function(a) &#123;&#125;).length // 1(function(...a) &#123;&#125;).length // 0(function(a, ...b) &#123;&#125;).length // 1 ä¸¥æ ¼æ¨¡å¼ åªè¦å‡½æ•°å‚æ•°ä½¿ç”¨äº†é»˜è®¤å€¼ã€è§£æ„èµ‹å€¼ã€æˆ–è€…æ‰©å±•è¿ç®—ç¬¦ï¼Œé‚£ä¹ˆå‡½æ•°å†…éƒ¨å°±ä¸èƒ½æ˜¾å¼è®¾å®šä¸ºä¸¥æ ¼æ¨¡å¼ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ 12345678910111213141516171819202122232425// æŠ¥é”™function doSomething(a, b = a) &#123; 'use strict'; // code&#125;// æŠ¥é”™const doSomething = function (&#123;a, b&#125;) &#123; 'use strict'; // code&#125;;// æŠ¥é”™const doSomething = (...a) =&gt; &#123; 'use strict'; // code&#125;;const obj = &#123; // æŠ¥é”™ doSomething(&#123;a, b&#125;) &#123; 'use strict'; // code &#125;&#125;; è§£å†³æ–¹æ³• è®¾ç½®å…¨å±€çš„ä¸¥æ ¼æ¨¡å¼ï¼Œä¸æ¨è 12345'use strict';function doSomething(a, b = a) &#123; // code&#125; å‡½æ•°åŒ…åœ¨ä¸€ä¸ªæ— å‚æ•°çš„ç«‹å³æ‰§è¡Œå‡½æ•°é‡Œé¢ 123456const doSomething = (function () &#123; 'use strict'; return function(value = 42) &#123; return value; &#125;;&#125;()); nameå±æ€§ è¿”å›å‡½æ•°åï¼Œes5å°±æœ‰ï¼Œä½†es6åšäº†ä¸€äº›ä¿®æ”¹123456789101112131415161718var f = function () &#123;&#125;;// ES5f.name // ""// ES6f.name // "f"const bar = function baz() &#123;&#125;;// ES5bar.name // "baz"// ES6bar.name // "baz"(new Function).name // "anonymous"function foo() &#123;&#125;;foo.bind(&#123;&#125;).name // "bound foo"(function()&#123;&#125;).bind(&#123;&#125;).name // "bound " ç®­å¤´å‡½æ•° åŸºç¡€è¯­æ³• 1234567891011(param1, param2, paramN) =&gt; &#123; å¤šæ¡è¯­å¥ï¼›return è¡¨è¾¾å¼; &#125;(param1, param2, paramN) =&gt; è¡¨è¾¾å¼// ç­‰ä»·äºï¼š(param1, param2, paramN) =&gt; &#123; return è¡¨è¾¾å¼; &#125;/* å½“åˆ é™¤å¤§æ‹¬å·æ—¶ï¼Œå®ƒå°†æ˜¯ä¸€ä¸ªéšå¼çš„è¿”å›å€¼ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¸éœ€è¦æŒ‡å®šæˆ‘ä»¬è¿”å›*/// å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œåœ†æ‹¬å·æ˜¯å¯é€‰çš„:(singleParam) =&gt; &#123; statements;return è¡¨è¾¾å¼; &#125;singleParam =&gt; &#123; statements; return è¡¨è¾¾å¼;&#125;// å¦‚æœç®­å¤´å‡½æ•° æ— å‚æ•° , å¿…é¡»ä½¿ç”¨ ()åœ†æ‹¬å·:() =&gt; &#123; statements; return è¡¨è¾¾å¼;&#125; é«˜çº§è¯­æ³• 123456789//è¿”å›ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå‡½æ•°ä½“å¤–è¦åŠ åœ†æ‹¬å·ï¼Œå¦åˆ™ä¼šè¢«å½“æˆè¯­æ³•å—ï¼Œè¿›è€Œè¯­æ³•é”™è¯¯params =&gt; (&#123;foo: bar&#125;)// æ”¯æŒ å‰©ä½™å‚æ•°å’Œé»˜è®¤å‚æ•°:(param1, param2, ...rest) =&gt; &#123; statements; return è¡¨è¾¾å¼; &#125;(param1 = defaultValue1, param2, â€¦, paramN = defaultValueN) =&gt; &#123; statements; return è¡¨è¾¾å¼; &#125;// ä¹Ÿæ”¯æŒå‚æ•°åˆ—è¡¨ä¸­çš„è§£æ„èµ‹å€¼let f = ([a, b] = [1, 2], &#123;x: c&#125; = &#123;x: a + b&#125;) =&gt; a + b + c; // a=1; b=2; x=c; c=a+b=3;f(); // 6 æ³¨æ„äº‹é¡¹ å‡½æ•°ä½“å†…çš„thiså¯¹è±¡ï¼Œå°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ å‡†ç¡®çš„è¯´åº”è¯¥æ˜¯ï¼Œç®­å¤´å‡½æ•°æœ¬èº«æ²¡æœ‰thisï¼Œå®ƒçš„thisæ˜¯ç»§æ‰¿æœ€è¿‘çˆ¶ä½œç”¨åŸŸçš„(æ›´å‡†ç¡®çš„è¯´æ˜¯ç›´æ¥ä½¿ç”¨çš„æœ€è¿‘çˆ¶ä½œç”¨åŸŸçš„this)ï¼Œå³æœ€è¿‘çˆ¶ä½œç”¨åŸŸè¢«è°ƒç”¨æ—¶çš„thisæ˜¯ä»€ä¹ˆï¼Œå®ƒçš„thiså°±æ˜¯ä»€ä¹ˆï¼›è¿™è¿‡ç¨‹ç±»ä¼¼å˜é‡çš„æº¯æºæŸ¥æ‰¾è¿‡ç¨‹ã€‚ 1234567891011121314151617181920212223242526// æ­£å¸¸æƒ…å†µfunction foo()&#123; setTimeout(function()&#123; console.log('id',this.id); &#125;,100); // ä¼šè¾“å‡º21ï¼ŒsetTimeoutå†…éƒ¨æ˜¯è¿™æ ·çš„ function setTimeout(fn,delay)&#123; fn();// fnä¸æ˜¯åšä¸ºæ–¹æ³•è°ƒç”¨ï¼Œä¹Ÿä¸æ˜¯newï¼Œæ›´æ²¡æœ‰ä½¿ç”¨callã€applyã€bindåšæ˜¾ç¤ºç»‘å®šï¼Œè€Œæ˜¯å±äºç›´æ¥è°ƒç”¨ï¼Œæ‰€ä»¥å†…éƒ¨thisæŒ‡å‘äº†windowï¼Œè¿›è€Œæœ€ç»ˆè¾“å‡º21 &#125;&#125;var id = 21;foo.call(&#123; id: 42 &#125;);// 21// ç®­å¤´å‡½æ•°function foo() &#123; setTimeout(() =&gt; &#123; console.log('id:', this.id); &#125;, 100); // ç®­å¤´å‡½æ•°æ²¡æœ‰this,å®ƒçš„thisæ˜¯ç”¨çš„æœ€è¿‘çˆ¶ä½œç”¨åŸŸfooè¢«è°ƒç”¨æ—¶çš„thisï¼Œ // fooè°ƒç”¨æ—¶ï¼Œthisè¢«ç»‘å®šåˆ°äº†&#123; id: 42 &#125;ï¼Œæ‰€ä»¥ç®­å¤´å‡½æ•°ç”¨çš„thisä¹Ÿæ˜¯&#123; id: 42 &#125;ï¼Œè¿›è€Œæœ€ç»ˆè¾“å‡ºäº†42&#125;var id = 21;foo.call(&#123; id: 42 &#125;);// 42 å¦‚ä½•å¿«é€Ÿåˆ¤æ–­ç®­å¤´å‡½æ•°çš„thisï¼Œç›´æ¥æ‰¾å®ƒå®šä¹‰æ—¶çš„ç›´æ¥çˆ¶å‡½æ•°æˆ–è€…ç›´æ¥çˆ¶å¯¹è±¡ 12345678function foo() &#123; setTimeout(() =&gt; &#123;// è¿™ä¸ªç®­å¤´å‡½æ•°å®šä¹‰æ—¶ï¼Œç›´æ¥çˆ¶å‡½æ•°ä¸ºfooï¼Œæ‰€ä»¥å®ƒçš„thisæ˜¯fooè¢«è°ƒç”¨æ—¶çš„this console.log(&apos;id:&apos;, this.id); &#125;, 100);&#125;var id = 21;foo.call(&#123; id: 42 &#125;);// 42 ç®­å¤´å‡½æ•°æ²¡æœ‰argumentsã€superã€new.targetï¼Œå¦‚æœè¦ä½¿ç”¨argumentsï¼Œå¯ä»¥ç”¨restå‚æ•°ä»£æ›¿ 12345678function foo() &#123; setTimeout(() =&gt; &#123; console.log('args:', arguments); &#125;, 100);&#125;foo(2, 4, 6, 8)// args: [2, 4, 6, 8] ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„thisï¼Œæ‰€ä»¥æ›´ä¸èƒ½ä½¿ç”¨callã€applyã€bindï¼Œè¿™äº›æ–¹æ³•æ— æ³•æ”¹å˜thisçš„æŒ‡å‘ 123456(function() &#123; return [ (() =&gt; this.x).bind(&#123; x: &apos;inner&apos; &#125;)() ];&#125;).call(&#123; x: &apos;outer&apos; &#125;);// [&apos;outer&apos;] ç®­å¤´å‡½æ•°ä¸èƒ½ä½¿ç”¨newï¼Œå¦åˆ™ä¼šæŠ¥é”™ å°¾è°ƒç”¨ä¼˜åŒ– å°¾è°ƒç”¨ æŒ‡æŸä¸ªå‡½æ•°çš„æœ€åä¸€æ­¥æ˜¯è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•° 12345678910111213141516171819function f(x)&#123; return g(x);&#125;// æƒ…å†µä¸€function f(x)&#123; let y = g(x); return y;&#125;// æƒ…å†µäºŒfunction f(x)&#123; return g(x) + 1;&#125;// æƒ…å†µä¸‰function f(x)&#123; g(x);&#125; å°¾è°ƒç”¨ä¸ä¸€å®šå‡ºç°åœ¨å‡½æ•°å°¾éƒ¨ï¼Œåªè¦æ˜¯æœ€åä¸€æ­¥æ“ä½œå³å¯ 123456function f(x) &#123; if (x &gt; 0) &#123; return m(x) &#125; return n(x);&#125; å°¾è°ƒç”¨ä¼˜åŒ– å¦‚æœåœ¨å‡½æ•°Açš„å†…éƒ¨è°ƒç”¨å‡½æ•°Bï¼Œé‚£ä¹ˆåœ¨Açš„è°ƒç”¨å¸§ä¸Šæ–¹ï¼Œè¿˜ä¼šå½¢æˆä¸€ä¸ªBçš„è°ƒç”¨å¸§ã€‚ç­‰åˆ°Bè¿è¡Œç»“æŸï¼Œå°†ç»“æœè¿”å›åˆ°Aï¼ŒBçš„è°ƒç”¨å¸§æ‰ä¼šæ¶ˆå¤±ã€‚å¦‚æœå‡½æ•°Bå†…éƒ¨è¿˜è°ƒç”¨å‡½æ•°Cï¼Œé‚£å°±è¿˜æœ‰ä¸€ä¸ªCçš„è°ƒç”¨å¸§ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ‰€æœ‰çš„è°ƒç”¨å¸§ï¼Œå°±å½¢æˆä¸€ä¸ªâ€œè°ƒç”¨æ ˆâ€ï¼ˆcall stackï¼‰ã€‚ å°¾è°ƒç”¨ç”±äºæ˜¯å‡½æ•°çš„æœ€åä¸€æ­¥æ“ä½œï¼Œæ‰€ä»¥ä¸éœ€è¦ä¿ç•™å¤–å±‚å‡½æ•°çš„è°ƒç”¨å¸§ï¼Œå› ä¸ºè°ƒç”¨ä½ç½®ã€å†…éƒ¨å˜é‡ç­‰ä¿¡æ¯éƒ½ä¸ä¼šå†ç”¨åˆ°äº†ï¼Œåªè¦ç›´æ¥ç”¨å†…å±‚å‡½æ•°çš„è°ƒç”¨å¸§ï¼Œå–ä»£å¤–å±‚å‡½æ•°çš„è°ƒç”¨å¸§å°±å¯ä»¥äº†ã€‚ 123456789101112131415function f() &#123; let m = 1; let n = 2; return g(m + n);&#125;f();// ç­‰åŒäºfunction f() &#123; return g(3);&#125;f();// ç­‰åŒäºg(3); ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœå‡½æ•°gä¸æ˜¯å°¾è°ƒç”¨ï¼Œå‡½æ•°få°±éœ€è¦ä¿å­˜å†…éƒ¨å˜é‡må’Œnçš„å€¼ã€gçš„è°ƒç”¨ä½ç½®ç­‰ä¿¡æ¯ã€‚ä½†ç”±äºè°ƒç”¨gä¹‹åï¼Œå‡½æ•°få°±ç»“æŸäº†ï¼Œæ‰€ä»¥æ‰§è¡Œåˆ°æœ€åä¸€æ­¥ï¼Œå®Œå…¨å¯ä»¥åˆ é™¤f(x)çš„è°ƒç”¨å¸§ï¼Œåªä¿ç•™g(3)çš„è°ƒç”¨å¸§ã€‚ åªæœ‰ä¸å†ç”¨åˆ°å¤–å±‚å‡½æ•°çš„å†…éƒ¨å˜é‡ï¼Œå†…å±‚å‡½æ•°çš„è°ƒç”¨å¸§æ‰ä¼šå–ä»£å¤–å±‚å‡½æ•°çš„è°ƒç”¨å¸§ï¼Œå¦åˆ™å°±æ— æ³•è¿›è¡Œâ€œå°¾è°ƒç”¨ä¼˜åŒ–â€ã€‚ å°¾é€’å½’ å‡½æ•°è°ƒç”¨è‡ªèº«ï¼Œç§°ä¸ºé€’å½’ã€‚å¦‚æœå°¾è°ƒç”¨è‡ªèº«ï¼Œå°±ç§°ä¸ºå°¾é€’å½’ é€’å½’éå¸¸è€—è´¹å†…å­˜ï¼Œå› ä¸ºéœ€è¦åŒæ—¶ä¿å­˜æˆåƒä¸Šç™¾ä¸ªè°ƒç”¨å¸§ï¼Œå¾ˆå®¹æ˜“å‘ç”Ÿâ€œæ ˆæº¢å‡ºâ€é”™è¯¯ï¼ˆstack overflowï¼‰ã€‚ä½†å¯¹äºå°¾é€’å½’æ¥è¯´ï¼Œç”±äºåªå­˜åœ¨ä¸€ä¸ªè°ƒç”¨å¸§ï¼Œæ‰€ä»¥æ°¸è¿œä¸ä¼šå‘ç”Ÿâ€œæ ˆæº¢å‡ºâ€é”™è¯¯1234567891011121314// æ™®é€šé€’å½’function factorial(n) &#123; if (n === 1) return 1; return n * factorial(n - 1);&#125;factorial(5) // 120// å°¾é€’å½’function factorial(n, total) &#123; if (n === 1) return total; return factorial(n - 1, n * total);&#125;factorial(5, 1) // 120 é€’å½’å‡½æ•°çš„æ”¹å†™ å°¾é€’å½’çš„å®ç°ï¼Œå¾€å¾€éœ€è¦æ”¹å†™é€’å½’å‡½æ•°ï¼Œç¡®ä¿æœ€åä¸€æ­¥åªè°ƒç”¨è‡ªèº«ã€‚åšåˆ°è¿™ä¸€ç‚¹çš„æ–¹æ³•ï¼Œå°±æ˜¯æŠŠæ‰€æœ‰ç”¨åˆ°çš„å†…éƒ¨å˜é‡æ”¹å†™æˆå‡½æ•°çš„å‚æ•°ã€‚ æ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œé˜¶ä¹˜å‡½æ•° factorial éœ€è¦ç”¨åˆ°ä¸€ä¸ªä¸­é—´å˜é‡totalï¼Œé‚£å°±æŠŠè¿™ä¸ªä¸­é—´å˜é‡æ”¹å†™æˆå‡½æ•°çš„å‚æ•°ã€‚123456function factorial(n, total = 1) &#123; if (n === 1) return total; return factorial(n - 1, n * total);&#125;factorial(5) // 120 ES6 çš„å°¾è°ƒç”¨ä¼˜åŒ–åªåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹å¼€å¯ï¼Œæ­£å¸¸æ¨¡å¼æ˜¯æ— æ•ˆçš„ éä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå¯ä»¥é€šè¿‡å°†é€’å½’æ”¹å†™æˆå¾ªç¯ï¼Œè¿›è€Œæ¨¡æ‹Ÿå°¾é€’å½’è°ƒç”¨çš„ä¼˜åŒ–æ•ˆæœ(å‡å°‘è°ƒç”¨å¸§) æ•°ç»„çš„æ‰©å±•æ‰©å±•è¿ç®—ç¬¦ å¯ä»¥ç†è§£ä¸ºrestå‚æ•°çš„é€†è¿ç®—ï¼›restå‚æ•°æ˜¯å°†é€—å·åˆ†éš”çš„å‚æ•°åˆ—è¡¨è½¬æ¢æˆæ•°ç»„ï¼Œè€Œæ‰©å±•è¿ç®—ç¬¦å·åˆ™æ˜¯å°†æ•°ç»„è½¬æ¢æˆé€—å·åˆ†éš”çš„åˆ—è¡¨ 1234567891011121314151617console.log(...[1, 2, 3])// 1 2 3console.log(1, ...[2, 3, 4], 5)// 1 2 3 4 5[...document.querySelectorAll('div')]// [&lt;div&gt;, &lt;div&gt;, &lt;div&gt;]let arr=[];const numbers = [4, 38];function push(array, ...items) &#123;// arr,[4,38] array.push(...items);// itemsä¸ºæ•°ç»„ï¼Œæ— æ³•åšä¸ºpushçš„å‚æ•°ï¼Œæ‰€ä»¥ä½¿ç”¨äº†æ‰©å±•è¿ç®—ç¬¦ï¼Œè½¬æ¢æˆäº†å‚æ•°åˆ—è¡¨&#125;push(arr,...numbers);// ç›¸å½“äºpush(arr,4,38)console.log(arr);//[4,38] æ‰©å±•è¿ç®—ç¬¦ä¸æ­£å¸¸çš„å‡½æ•°å‚æ•°å¯ä»¥ç»“åˆä½¿ç”¨ï¼Œéå¸¸çµæ´» 123function f(v, w, x, y, z) &#123; &#125;const args = [0, 1];f(-1, ...args, 2, ...[3]); ç”¨é€” æ›¿ä»£æ•°ç»„çš„applyæ–¹æ³• 1234567891011121314151617181920212223// ES5 çš„å†™æ³•function f(x, y, z) &#123; // ...&#125;var args = [0, 1, 2];f.apply(null, args);// ES6çš„å†™æ³•function f(x, y, z) &#123; // ...&#125;let args = [0, 1, 2];f(...args);// å–æœ€å¤§å€¼// ES5 çš„å†™æ³•Math.max.apply(null, [14, 3, 77])// ES6 çš„å†™æ³•Math.max(...[14, 3, 77])// ç­‰åŒäºMath.max(14, 3, 77); åˆå¹¶æ•°ç»„ 12345678910111213141516// ES5[1, 2].concat(more)// ES6[1, 2, ...more]var arr1 = ['a', 'b'];var arr2 = ['c'];var arr3 = ['d', 'e'];// ES5çš„åˆå¹¶æ•°ç»„arr1.concat(arr2, arr3);// [ 'a', 'b', 'c', 'd', 'e' ]// ES6çš„åˆå¹¶æ•°ç»„[...arr1, ...arr2, ...arr3]// [ 'a', 'b', 'c', 'd', 'e' ] æ‰©å±•è¿ç®—ç¬¦å¯ä»¥ä¸è§£æ„èµ‹å€¼ç»“åˆèµ·æ¥ï¼Œç”¨äºç”Ÿæˆæ•°ç»„ 12345678910111213141516// ES5a = list[0], rest = list.slice(1)// ES6[a, ...rest] = listconst [first, ...rest] = [1, 2, 3, 4, 5];first // 1rest // [2, 3, 4, 5]const [first, ...rest] = [];first // undefinedrest // []const [first, ...rest] = ["foo"];first // "foo"rest // [] å¦‚æœå°†æ‰©å±•è¿ç®—ç¬¦ç”¨äºæ•°ç»„èµ‹å€¼ï¼Œåªèƒ½æ”¾åœ¨å‚æ•°çš„æœ€åä¸€ä½ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚12345const [...butLast, last] = [1, 2, 3, 4, 5];// æŠ¥é”™const [first, ...middle, last] = [1, 2, 3, 4, 5];// æŠ¥é”™ å‡½æ•°è¿”å›å€¼ 12let dateFields = readDateFields(database);let d = new Date(...dateFields);// Dataä¸æ¥æ”¶æ•°ç»„ï¼Œæ‰€ä»¥è½¬æ¢æˆå‚æ•°åˆ—è¡¨ å­—ç¬¦ä¸²è½¬æ•°ç»„ 12[...'hello']// [ "h", "e", "l", "l", "o" ] å®ç°äº†Iteratoræ¥å£çš„å¯¹è±¡ï¼Œéƒ½èƒ½è½¬æ¢æˆæ•°ç»„ 12345678910111213141516let nodeList = document.querySelectorAll('div');// nodelistæœ‰Iteratoræ¥å£ï¼Œæ‰€ä»¥å¯ä»¥è½¬æ¢æˆæ•°ç»„let array = [...nodeList];let map = new Map([// Mapæœ‰Iteratoræ¥å£ [1, 'one'], [2, 'two'], [3, 'three'],]);let arr = [...map.keys()]; // [1, 2, 3]const go = function*()&#123;// Generator å‡½æ•°è¿è¡Œåï¼Œè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œå› æ­¤ä¹Ÿå¯ä»¥ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ã€‚ yield 1; yield 2; yield 3;&#125;;[...go()] // [1, 2, 3] Array.from å°†ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼ˆarray-like objectï¼‰å’Œå¯éå†ï¼ˆiterableï¼‰çš„å¯¹è±¡ï¼ˆåŒ…æ‹¬ES6æ–°å¢çš„æ•°æ®ç»“æ„Setå’ŒMapï¼‰è½¬æ¢æˆæ•°ç»„ æ‰€è°“ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæœ¬è´¨ç‰¹å¾åªæœ‰ä¸€ç‚¹ï¼Œå³å¿…é¡»æœ‰lengthå±æ€§ã€‚å› æ­¤ï¼Œä»»ä½•æœ‰lengthå±æ€§çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥é€šè¿‡Array.fromæ–¹æ³•è½¬ä¸ºæ•°ç»„ï¼Œè€Œæ­¤æ—¶æ‰©å±•è¿ç®—ç¬¦å°±æ— æ³•è½¬æ¢12345678910111213141516171819202122232425262728293031let arrayLike = &#123; '0': 'a', '1': 'b', '2': 'c', length: 3&#125;;// ES5çš„å†™æ³•var arr1 = [].slice.call(arrayLike); // ['a', 'b', 'c']// ES6çš„å†™æ³•let arr2 = Array.from(arrayLike); // ['a', 'b', 'c']// NodeListå¯¹è±¡let ps = document.querySelectorAll('p');Array.from(ps).forEach(function (p) &#123; console.log(p);&#125;);// argumentså¯¹è±¡function foo() &#123; var args = Array.from(arguments); // ...&#125;Array.from('hello')// es6ä¸­å­—ç¬¦ä¸²æœ‰Iteratoræ¥å£// ['h', 'e', 'l', 'l', 'o']let namesSet = new Set(['a', 'b'])Array.from(namesSet) // ['a', 'b']Array.from(&#123; length: 2 &#125;, () =&gt; 'jack')// å¯¹è±¡æœ‰lengthï¼Œæ‰€ä»¥æ˜¯ç±»æ•°ç»„å¯¹è±¡ï¼Œå¯ä»¥ç”¨fromè½¬æ¢// ['jack', 'jack'] Array.of() Array.ofæ–¹æ³•ç”¨äºå°†ä¸€ç»„å€¼ï¼Œè½¬æ¢ä¸ºæ•°ç»„ã€‚å¼¥è¡¥æ•°ç»„æ„é€ å‡½æ•°Array()çš„ä¸è¶³ï¼Œå› ä¸ºå‚æ•°ä¸ªæ•°çš„ä¸åŒï¼Œä¼šå¯¼è‡´Array()çš„è¡Œä¸ºæœ‰å·®å¼‚ã€‚ Array.ofæ€»æ˜¯è¿”å›å‚æ•°å€¼ç»„æˆçš„æ•°ç»„ã€‚å¦‚æœæ²¡æœ‰å‚æ•°ï¼Œå°±è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ã€‚1234567Array() // []Array(3) // [, , ,]ï¼Œåªæœ‰ä¸€ä¸ªå‚æ•°æ—¶ï¼Œæ˜¯æŒ‡å®šçš„æ•°ç»„é•¿åº¦Array(3, 11, 8) // [3, 11, 8]Array.of(3, 11, 8) // [3,11,8]Array.of(3) // [3]Array.of(3).length // 1 æ•°ç»„å®ä¾‹çš„ copyWithin() å°†æŒ‡å®šä½ç½®çš„æˆå‘˜å¤åˆ¶åˆ°å…¶ä»–ä½ç½®ï¼ˆä¼šè¦†ç›–åŸæœ‰æˆå‘˜ï¼‰ï¼Œç„¶åè¿”å›å½“å‰æ•°ç»„ï¼Œæ‰€ä»¥ä¼šä¿®æ”¹å½“å‰æ•°ç»„1234567891011121314151617181920212223242526272829Array.prototype.copyWithin(target, start = 0, end = this.length)targetï¼ˆå¿…éœ€ï¼‰ï¼šä»è¯¥ä½ç½®å¼€å§‹æ›¿æ¢æ•°æ®ã€‚startï¼ˆå¯é€‰ï¼‰ï¼šä»è¯¥ä½ç½®å¼€å§‹è¯»å–æ•°æ®ï¼Œé»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºå€’æ•°ã€‚endï¼ˆå¯é€‰ï¼‰ï¼šåˆ°è¯¥ä½ç½®å‰åœæ­¢è¯»å–æ•°æ®ï¼Œé»˜è®¤ç­‰äºæ•°ç»„é•¿åº¦ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºå€’æ•°ã€‚[1, 2, 3, 4, 5].copyWithin(0, 3)// è¯»å–ä»ç´¢å¼•3å¼€å§‹åˆ°ç»“æŸçš„æ•°æ®4,5å¹¶æ›¿æ¢ä»0å¼€å§‹çš„æ•°æ®// [4, 5, 3, 4, 5]// å°†3å·ä½å¤åˆ¶åˆ°0å·ä½[1, 2, 3, 4, 5].copyWithin(0, 3, 4)// [4, 2, 3, 4, 5]// -2ç›¸å½“äº3å·ä½ï¼Œ-1ç›¸å½“äº4å·ä½[1, 2, 3, 4, 5].copyWithin(0, -2, -1)// [4, 2, 3, 4, 5]// å°†3å·ä½å¤åˆ¶åˆ°0å·ä½[].copyWithin.call(&#123;length: 5, 3: 1&#125;, 0, 3)// &#123;0: 1, 3: 1, length: 5&#125;// å°†2å·ä½åˆ°æ•°ç»„ç»“æŸï¼Œå¤åˆ¶åˆ°0å·ä½let i32a = new Int32Array([1, 2, 3, 4, 5]);i32a.copyWithin(0, 2);// Int32Array [3, 4, 5, 4, 5]// å¯¹äºæ²¡æœ‰éƒ¨ç½² TypedArray çš„ copyWithin æ–¹æ³•çš„å¹³å°// éœ€è¦é‡‡ç”¨ä¸‹é¢çš„å†™æ³•[].copyWithin.call(new Int32Array([1, 2, 3, 4, 5]), 0, 3, 4);// Int32Array [4, 2, 3, 4, 5] æ•°ç»„å®ä¾‹çš„ find() å’Œ findIndex() æ•°ç»„å®ä¾‹çš„findæ–¹æ³•ï¼Œç”¨äºæ‰¾å‡ºç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ•°ç»„æˆå‘˜ã€‚å®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ‰€æœ‰æ•°ç»„æˆå‘˜ä¾æ¬¡æ‰§è¡Œè¯¥å›è°ƒå‡½æ•°ï¼Œç›´åˆ°æ‰¾å‡ºç¬¬ä¸€ä¸ªè¿”å›å€¼ä¸ºtrueçš„æˆå‘˜ï¼Œç„¶åè¿”å›è¯¥æˆå‘˜ã€‚å¦‚æœæ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„æˆå‘˜ï¼Œåˆ™è¿”å›undefined 123456[1, 4, -5, 10].find((n) =&gt; n &lt; 0)// -5[1, 5, 10, 15].find(function(value, index, arr) &#123;//å½“å‰å€¼ï¼Œç´¢å¼•ï¼ŒåŸæ•°ç»„ return value &gt; 9;&#125;) // 10 è¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ•°ç»„æˆå‘˜çš„ä½ç½®ï¼Œå¦‚æœæ‰€æœ‰æˆå‘˜éƒ½ä¸ç¬¦åˆæ¡ä»¶ï¼Œåˆ™è¿”å›-1 123[1, 5, 10, 15].findIndex(function(value, index, arr) &#123; return value &gt; 9;&#125;) // 2 æ•°ç»„å®ä¾‹çš„fill() fillæ–¹æ³•ä½¿ç”¨ç»™å®šå€¼ï¼Œå¡«å……ä¸€ä¸ªæ•°ç»„ã€‚12345678['a', 'b', 'c'].fill(7)// [7, 7, 7]new Array(3).fill(7)// [7, 7, 7]['a', 'b', 'c'].fill(7, 1, 2)// å°†7å¡«å……åˆ°[1,2)åŒºé—´// ['a', 7, 'c'] æ•°ç»„å®ä¾‹çš„ entries()ï¼Œkeys() å’Œ values() entries()ï¼Œkeys()å’Œvalues()â€”â€”ç”¨äºéå†æ•°ç»„ã€‚å®ƒä»¬éƒ½è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œå¯ä»¥ç”¨forâ€¦ofå¾ªç¯è¿›è¡Œéå†ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯keys()æ˜¯å¯¹é”®åçš„éå†ã€values()æ˜¯å¯¹é”®å€¼çš„éå†ï¼Œentries()æ˜¯å¯¹é”®å€¼å¯¹çš„éå†ã€‚1234567891011121314151617for (let index of ['a', 'b'].keys()) &#123; console.log(index);&#125;// 0// 1for (let elem of ['a', 'b'].values()) &#123; console.log(elem);&#125;// 'a'// 'b'for (let [index, elem] of ['a', 'b'].entries()) &#123; console.log(index, elem);&#125;// 0 "a"// 1 "b" æ•°ç»„å®ä¾‹çš„ includes() Array.prototype.includesæ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªæ•°ç»„æ˜¯å¦åŒ…å«ç»™å®šçš„å€¼ï¼Œä¸å­—ç¬¦ä¸²çš„includesæ–¹æ³•ç±»ä¼¼123[1, 2, 3].includes(2) // true[1, 2, 3].includes(4) // false[1, 2, NaN].includes(NaN) // true æ•°ç»„çš„ç©ºä½ æ•°ç»„çš„ç©ºä½æŒ‡ï¼Œæ•°ç»„çš„æŸä¸€ä¸ªä½ç½®æ²¡æœ‰ä»»ä½•å€¼ã€‚æ¯”å¦‚ï¼ŒArrayæ„é€ å‡½æ•°è¿”å›çš„æ•°ç»„éƒ½æ˜¯ç©ºä½ã€‚ 1Array(3) // [, , ,] ç©ºä½ä¸æ˜¯undefinedï¼Œä¸€ä¸ªä½ç½®çš„å€¼ç­‰äºundefinedï¼Œä¾ç„¶æ˜¯æœ‰å€¼çš„ã€‚ç©ºä½æ˜¯æ²¡æœ‰ä»»ä½•å€¼ï¼Œinè¿ç®—ç¬¦å¯ä»¥è¯´æ˜è¿™ä¸€ç‚¹ 120 in [undefined, undefined, undefined] // true0 in [, , ,] // false ES5 å¯¹ç©ºä½çš„å¤„ç†ï¼Œå·²ç»å¾ˆä¸ä¸€è‡´äº†ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ä¼šå¿½ç•¥ç©ºä½ï¼›ES6 åˆ™æ˜¯æ˜ç¡®å°†ç©ºä½è½¬ä¸ºundefinedã€‚ 12345678910111213141516171819202122232425262728293031Array.from(['a',,'b'])// [ "a", undefined, "b" ][...['a',,'b']]// [ "a", undefined, "b" ][,'a','b',,].copyWithin(2,0) // [,"a",,"a"]new Array(3).fill('a') // ["a","a","a"]let arr = [, ,];for (let i of arr) &#123; console.log(1);&#125;// 1// 1// entries()[...[,'a'].entries()] // [[0,undefined], [1,"a"]]// keys()[...[,'a'].keys()] // [0,1]// values()[...[,'a'].values()] // [undefined,"a"]// find()[,'a'].find(x =&gt; true) // undefined// findIndex()[,'a'].findIndex(x =&gt; true) // 0 å¯¹è±¡çš„æ‰©å±•å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³• ES6å…è®¸ç›´æ¥å†™å…¥å˜é‡å’Œå‡½æ•°ï¼Œä½œä¸ºå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576const foo = 'bar';const baz = &#123;foo&#125;;baz // &#123;foo: "bar"&#125;// ç­‰åŒäºconst baz = &#123;foo: foo&#125;;// å±æ€§ç®€å†™function f(x, y) &#123; return &#123;x, y&#125;;&#125;// ç­‰åŒäºfunction f(x, y) &#123; return &#123;x: x, y: y&#125;;&#125;f(1, 2) // Object &#123;x: 1, y: 2&#125;// æ–¹æ³•ç®€å†™const o = &#123; method() &#123; return "Hello!"; &#125;&#125;;// ç­‰åŒäºconst o = &#123; method: function() &#123; return "Hello!"; &#125;&#125;;// å®é™…ä¾‹å­let birth = '2000/01/01';const Person = &#123; name: 'å¼ ä¸‰', //ç­‰åŒäºbirth: birth birth, // ç­‰åŒäºhello: function ()... hello() &#123; console.log('æˆ‘çš„åå­—æ˜¯', this.name); &#125;&#125;;// ç”¨åœ¨å‡½æ•°è¿”å›å€¼function getPoint() &#123; const x = 1; const y = 10; return &#123;x, y&#125;;&#125;getPoint()// &#123;x:1, y:10&#125;// å±æ€§çš„èµ‹å€¼å™¨ï¼ˆsetterï¼‰å’Œå–å€¼å™¨ï¼ˆgetterï¼‰ï¼Œäº‹å®ä¸Šä¹Ÿæ˜¯é‡‡ç”¨è¿™ç§å†™æ³•const cart = &#123; _wheels: 4, get wheels () &#123; return this._wheels; &#125;, set wheels (value) &#123; if (value &lt; this._wheels) &#123; throw new Error('æ•°å€¼å¤ªå°äº†ï¼'); &#125; this._wheels = value; &#125;&#125;// ç®€æ´å†™æ³•çš„å±æ€§åæ€»æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™ä¼šå¯¼è‡´ä¸€äº›çœ‹ä¸Šå»æ¯”è¾ƒå¥‡æ€ªçš„ç»“æœconst obj = &#123; class () &#123;&#125;&#125;;// ç­‰åŒäºvar obj = &#123; 'class': function() &#123;&#125;&#125;;// å¦‚æœæŸä¸ªæ–¹æ³•çš„å€¼æ˜¯ä¸€ä¸ª Generator å‡½æ•°ï¼Œå‰é¢éœ€è¦åŠ ä¸Šæ˜Ÿå·const obj = &#123; * m() &#123; yield 'hello world'; &#125;&#125;; å±æ€§åè¡¨è¾¾å¼ ES6 å…è®¸å­—é¢é‡å®šä¹‰å¯¹è±¡æ—¶ï¼Œç”¨è¡¨è¾¾å¼ä½œä¸ºå¯¹è±¡çš„å±æ€§åï¼Œå³æŠŠè¡¨è¾¾å¼æ”¾åœ¨æ–¹æ‹¬å·å†…ã€‚12345678910111213141516171819202122232425262728293031323334let lastWord = 'last word';const a = &#123; 'first word': 'hello', [lastWord]: 'world'&#125;;a['first word'] // "hello"a[lastWord] // "world"a['last word'] // "world"// è¡¨è¾¾å¼è¿˜å¯ä»¥ç”¨äºå®šä¹‰æ–¹æ³•ålet obj = &#123; ['h' + 'ello']() &#123; return 'hi'; &#125;&#125;;obj.hello() // hi// å±æ€§åè¡¨è¾¾å¼ä¸ç®€æ´è¡¨ç¤ºæ³•ï¼Œä¸èƒ½åŒæ—¶ä½¿ç”¨ï¼Œä¼šæŠ¥é”™// æŠ¥é”™const foo = 'bar';const bar = 'abc';const baz = &#123; [foo] &#125;;// æ­£ç¡®const foo = 'bar';const baz = &#123; [foo]: 'abc'&#125;;// å±æ€§åè¡¨è¾¾å¼å¦‚æœæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šè‡ªåŠ¨å°†å¯¹è±¡è½¬ä¸ºå­—ç¬¦ä¸²[object Object]const keyA = &#123;a: 1&#125;;const keyB = &#123;b: 2&#125;;const myObject = &#123; [keyA]: 'valueA', [keyB]: 'valueB'&#125;;myObject // Object &#123;[object Object]: "valueB"&#125; æ–¹æ³•çš„ name å±æ€§ å‡½æ•°çš„nameå±æ€§ï¼Œè¿”å›å‡½æ•°åã€‚å¯¹è±¡æ–¹æ³•ä¹Ÿæ˜¯å‡½æ•°ï¼Œå› æ­¤ä¹Ÿæœ‰nameå±æ€§123456789101112const person = &#123; sayName() &#123; console.log('hello!'); &#125;,&#125;;person.sayName.name // "sayName"(new Function()).name // "anonymous"var doSomething = function() &#123; // ...&#125;;doSomething.bind().name // "bound doSomething" Object.is() ES5 æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œåªæœ‰ä¸¤ä¸ªè¿ç®—ç¬¦ï¼šç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ==ï¼‰å’Œä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ===ï¼‰ã€‚å®ƒä»¬éƒ½æœ‰ç¼ºç‚¹ï¼Œå‰è€…ä¼šè‡ªåŠ¨è½¬æ¢æ•°æ®ç±»å‹ï¼Œåè€…çš„NaNä¸ç­‰äºè‡ªèº«ï¼Œä»¥åŠ+0ç­‰äº-0ã€‚ Object.iså®ƒç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ä¸¥æ ¼ç›¸ç­‰ï¼Œä¸ä¸¥æ ¼æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆ===ï¼‰çš„è¡Œä¸ºåŸºæœ¬ä¸€è‡´ã€‚å’Œ===ä¸åŒç‚¹åœ¨äºä¸€æ˜¯+0ä¸ç­‰äº-0ï¼ŒäºŒæ˜¯NaNç­‰äºè‡ªèº«12345+0 === -0 //trueNaN === NaN // falseObject.is(+0, -0) // falseObject.is(NaN, NaN) // true Object.assign() ç±»ä¼¼jQueryçš„$.extend()æ–¹æ³•ï¼Œå¯ç”¨æ¥åˆå¹¶å¯¹è±¡ 1234567891011121314const target = &#123; a: 1 &#125;;const source1 = &#123; b: 2 &#125;;const source2 = &#123; c: 3 &#125;;Object.assign(target, source1, source2);target // &#123;a:1, b:2, c:3&#125;// é‡åå±æ€§ï¼Œåé¢å¯¹è±¡ä¼šè¦†ç›–å‰é¢çš„const target = &#123; a: 1, b: 1 &#125;;const source1 = &#123; b: 2, c: 2 &#125;;const source2 = &#123; c: 3 &#125;;Object.assign(target, source1, source2);target // &#123;a:1, b:2, c:3&#125; Object.assignæ‹·è´çš„å±æ€§æ˜¯æœ‰é™åˆ¶çš„ï¼Œåªæ‹·è´æºå¯¹è±¡çš„è‡ªèº«å±æ€§ï¼ˆä¸æ‹·è´ç»§æ‰¿å±æ€§ï¼‰ï¼Œä¹Ÿä¸æ‹·è´ä¸å¯æšä¸¾çš„å±æ€§ï¼ˆenumerable: falseï¼‰ 1234567Object.assign(&#123;b: 'c'&#125;, Object.defineProperty(&#123;&#125;, 'invisible', &#123; enumerable: false, value: 'hello' &#125;))// &#123; b: 'c' &#125; Object.assignæ–¹æ³•å®è¡Œçš„æ˜¯æµ…æ‹·è´ï¼Œè€Œä¸æ˜¯æ·±æ‹·è´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæºå¯¹è±¡æŸä¸ªå±æ€§çš„å€¼æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆç›®æ ‡å¯¹è±¡æ‹·è´å¾—åˆ°çš„æ˜¯è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ 12345678910const obj1 = &#123;a: &#123;b: 1&#125;&#125;;const obj2 = Object.assign(&#123;&#125;, obj1);obj1.a.b = 2;obj2.a.b // 2// åŒåå±æ€§ï¼Œç›´æ¥æ›¿æ¢å¼•ç”¨const target = &#123; a: &#123; b: 'c', d: 'e' &#125; &#125;const source = &#123; a: &#123; b: 'hello' &#125; &#125;Object.assign(target, source);// &#123; a: &#123; b: 'hello' &#125; &#125; Object.assignå¯ä»¥ç”¨æ¥å¤„ç†æ•°ç»„ï¼Œä½†æ˜¯ä¼šæŠŠæ•°ç»„è§†ä¸ºå¯¹è±¡ 12Object.assign([1, 2, 3], [4, 5])// [4, 5, 3] ç”¨é€” ä¸ºå¯¹è±¡æ·»åŠ å±æ€§ 12345class Point &#123; constructor(x, y) &#123; Object.assign(this, &#123;x, y&#125;);// å°†xå±æ€§å’Œyå±æ€§æ·»åŠ åˆ°Pointç±»çš„å¯¹è±¡å®ä¾‹ &#125;&#125; ä¸ºå¯¹è±¡æ·»åŠ æ–¹æ³• 12345678910111213141516Object.assign(SomeClass.prototype, &#123; someMethod(arg1, arg2) &#123; Â·Â·Â· &#125;, anotherMethod() &#123; Â·Â·Â· &#125;&#125;);// ç­‰åŒäºä¸‹é¢çš„å†™æ³•SomeClass.prototype.someMethod = function (arg1, arg2) &#123; Â·Â·Â·&#125;;SomeClass.prototype.anotherMethod = function () &#123; Â·Â·Â·&#125;; å…‹éš†å¯¹è±¡ 12345678910// å…‹éš†åŸå§‹å¯¹è±¡è‡ªèº«çš„å€¼ï¼Œä¸èƒ½å…‹éš†å®ƒç»§æ‰¿çš„å€¼function clone(origin) &#123; return Object.assign(&#123;&#125;, origin);&#125;// å…‹éš†åŒæ—¶ä¿æŒç»§æ‰¿é“¾function clone(origin) &#123; let originProto = Object.getPrototypeOf(origin); return Object.assign(Object.create(originProto), origin);&#125; åˆå¹¶å¤šä¸ªå¯¹è±¡ 12345// å°†å¤šä¸ªå¯¹è±¡åˆå¹¶åˆ°æŸä¸ªå¯¹è±¡const merge = (target, ...sources) =&gt; Object.assign(target, ...sources);// åˆå¹¶åè¿”å›ä¸€ä¸ªæ–°å¯¹è±¡const merge = (...sources) =&gt; Object.assign(&#123;&#125;, ...sources); ä¸ºå±æ€§æŒ‡å®šé»˜è®¤å€¼ 12345678910const DEFAULTS = &#123; logLevel: 0, outputFormat: 'html'&#125;;function processContent(options) &#123; options = Object.assign(&#123;&#125;, DEFAULTS, options); console.log(options); // ...&#125; å±æ€§çš„å¯æšä¸¾æ€§å’Œéå† Object.getOwnPropertyDescriptoræ–¹æ³•å¯ä»¥è·å–è¯¥å±æ€§çš„æè¿°å¯¹è±¡ 12345678let obj = &#123; foo: 123 &#125;;Object.getOwnPropertyDescriptor(obj, 'foo')// &#123;// value: 123,// writable: true,// enumerable: true,// configurable: true// &#125; å››ä¸ªæ“ä½œä¼šå¿½ç•¥enumerableä¸ºfalseçš„å±æ€§ forâ€¦inå¾ªç¯ï¼šåªéå†å¯¹è±¡è‡ªèº«çš„å’Œç»§æ‰¿çš„å¯æšä¸¾çš„å±æ€§ã€‚ Object.keys()ï¼šè¿”å›å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å¯æšä¸¾çš„å±æ€§çš„é”®åã€‚ JSON.stringify()ï¼šåªä¸²è¡ŒåŒ–å¯¹è±¡è‡ªèº«çš„å¯æšä¸¾çš„å±æ€§ã€‚ Object.assign()ï¼š å¿½ç•¥enumerableä¸ºfalseçš„å±æ€§ï¼Œåªæ‹·è´å¯¹è±¡è‡ªèº«çš„å¯æšä¸¾çš„å±æ€§ã€‚ åªæœ‰forâ€¦inä¼šè¿”å›ç»§æ‰¿çš„å±æ€§ï¼Œå…¶ä»–ä¸‰ä¸ªæ–¹æ³•éƒ½ä¼šå¿½ç•¥ç»§æ‰¿çš„å±æ€§ï¼Œåªå¤„ç†å¯¹è±¡è‡ªèº«çš„å±æ€§ æ€»çš„æ¥è¯´ï¼Œæ“ä½œä¸­å¼•å…¥ç»§æ‰¿çš„å±æ€§ä¼šè®©é—®é¢˜å¤æ‚åŒ–ï¼Œå¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬åªå…³å¿ƒå¯¹è±¡è‡ªèº«çš„å±æ€§ã€‚æ‰€ä»¥ï¼Œå°½é‡ä¸è¦ç”¨forâ€¦inå¾ªç¯ï¼Œè€Œç”¨Object.keys()ä»£æ›¿ã€‚ å±æ€§éå† forâ€¦in forâ€¦inå¾ªç¯éå†å¯¹è±¡è‡ªèº«çš„å’Œç»§æ‰¿çš„å¯æšä¸¾å±æ€§ï¼ˆä¸å« Symbol å±æ€§ï¼‰ Object.keys(obj) Object.keysè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…æ‹¬å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼ˆä¸å« Symbol å±æ€§ï¼‰ Object.getOwnPropertyNames(obj) Object.getOwnPropertyNamesè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å±æ€§ï¼ˆä¸å« Symbol å±æ€§ï¼Œä½†æ˜¯åŒ…æ‹¬ä¸å¯æšä¸¾å±æ€§ï¼‰ Object.getOwnPropertySymbols(obj) Object.getOwnPropertySymbolsè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰ Symbol å±æ€§ã€‚ Reflect.ownKeys(obj) Reflect.ownKeysè¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å±æ€§ï¼Œä¸ç®¡å±æ€§åæ˜¯ Symbol æˆ–å­—ç¬¦ä¸²ï¼Œä¹Ÿä¸ç®¡æ˜¯å¦å¯æšä¸¾ã€‚ éå†è§„åˆ™ é¦–å…ˆéå†æ‰€æœ‰å±æ€§åä¸ºæ•°å€¼çš„å±æ€§ï¼ŒæŒ‰ç…§æ•°å­—æ’åºã€‚ å…¶æ¬¡éå†æ‰€æœ‰å±æ€§åä¸ºå­—ç¬¦ä¸²çš„å±æ€§ï¼ŒæŒ‰ç…§ç”Ÿæˆæ—¶é—´æ’åºã€‚ æœ€åéå†æ‰€æœ‰å±æ€§åä¸º Symbol å€¼çš„å±æ€§ï¼ŒæŒ‰ç…§ç”Ÿæˆæ—¶é—´æ’åºã€‚12Reflect.ownKeys(&#123; [Symbol()]:0, b:0, 10:0, 2:0, a:0 &#125;)// ['2', '10', 'b', 'a', Symbol()] Object.getOwnPropertyDescriptors è¿”å›æŒ‡å®šå¯¹è±¡æ‰€æœ‰è‡ªèº«å±æ€§ï¼ˆéç»§æ‰¿å±æ€§ï¼‰çš„æè¿°å¯¹è±¡ã€‚ 12345678910111213141516const obj = &#123; foo: 123, get bar() &#123; return 'abc' &#125;&#125;;Object.getOwnPropertyDescriptors(obj)// &#123; foo:// &#123; value: 123,// writable: true,// enumerable: true,// configurable: true &#125;,// bar:// &#123; get: [Function: bar],// set: undefined,// enumerable: true,// configurable: true &#125; &#125; ä¸»è¦æ˜¯ä¸ºäº†è§£å†³Object.assign()æ— æ³•æ­£ç¡®æ‹·è´getå±æ€§å’Œsetå±æ€§çš„é—®é¢˜ã€‚ 1234567891011121314151617181920212223242526272829303132const source = &#123; set foo(value) &#123; console.log(value); &#125;&#125;;const target1 = &#123;&#125;;Object.assign(target1, source);Object.getOwnPropertyDescriptor(target1, 'foo')// &#123; value: undefined,// writable: true,// enumerable: true,// configurable: true &#125;// æ­£ç¡®æ‹·è´setæ–¹æ³•const source = &#123; set foo(value) &#123; console.log(value); &#125;&#125;;const target2 = &#123;&#125;;Object.defineProperties(target2, Object.getOwnPropertyDescriptors(source));Object.getOwnPropertyDescriptor(target2, 'foo')// &#123; get: undefined,// set: [Function: foo],// enumerable: true,// configurable: true &#125;// ä¸Šé¢ä»£ç ä¸­ï¼Œä¸¤ä¸ªå¯¹è±¡åˆå¹¶çš„é€»è¾‘å¯ä»¥å†™æˆä¸€ä¸ªå‡½æ•°ã€‚const shallowMerge = (target, source) =&gt; Object.defineProperties( target, Object.getOwnPropertyDescriptors(source)); é…åˆObject.createæ–¹æ³•ï¼Œå°†å¯¹è±¡å±æ€§å…‹éš†åˆ°ä¸€ä¸ªæ–°å¯¹è±¡ã€‚è¿™å±äºæµ…æ‹·è´ 1234567const clone = Object.create(Object.getPrototypeOf(obj), Object.getOwnPropertyDescriptors(obj));// æˆ–è€…const shallowClone = (obj) =&gt; Object.create( Object.getPrototypeOf(obj), Object.getOwnPropertyDescriptors(obj)); protoå±æ€§ï¼ŒObject.setPrototypeOf()ï¼ŒObject.getPrototypeOf() protoå±æ€§ï¼ˆå‰åå„ä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰ï¼Œç”¨æ¥è¯»å–æˆ–è®¾ç½®å½“å‰å¯¹è±¡çš„prototypeå¯¹è±¡ï¼Œæµè§ˆå™¨å†…éƒ¨æ–¹æ³• 123456789// es6çš„å†™æ³•const obj = &#123; method: function() &#123; ... &#125;&#125;;obj.__proto__ = someOtherObj;// es5çš„å†™æ³•var obj = Object.create(someOtherObj);obj.method = function() &#123; ... &#125;; Object.setPrototypeOf() Object.setPrototypeOfæ–¹æ³•çš„ä½œç”¨ä¸protoç›¸åŒï¼Œç”¨æ¥è®¾ç½®ä¸€ä¸ªå¯¹è±¡çš„prototypeå¯¹è±¡ï¼Œè¿”å›å‚æ•°å¯¹è±¡æœ¬èº«ã€‚å®ƒæ˜¯ ES6 æ­£å¼æ¨èçš„è®¾ç½®åŸå‹å¯¹è±¡çš„æ–¹æ³•12345678910// æ ¼å¼Object.setPrototypeOf(object, prototype)// ç”¨æ³•const o = Object.setPrototypeOf(&#123;&#125;, null);// ç­‰åŒäºfunction (obj, proto) &#123; obj.__proto__ = proto; return obj;&#125; Object.getPrototypeOf() è¯¥æ–¹æ³•ä¸Object.setPrototypeOfæ–¹æ³•é…å¥—ï¼Œç”¨äºè¯»å–ä¸€ä¸ªå¯¹è±¡çš„åŸå‹å¯¹è±¡123456789101112function Rectangle() &#123; // ...&#125;const rec = new Rectangle();Object.getPrototypeOf(rec) === Rectangle.prototype// trueObject.setPrototypeOf(rec, Object.prototype);Object.getPrototypeOf(rec) === Rectangle.prototype// false Object.keys()ï¼ŒObject.values()ï¼ŒObject.entries() Object.keysæ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‚æ•°å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å¯éå†ï¼ˆenumerableï¼‰å±æ€§çš„é”®å Object.valuesæ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‚æ•°å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å¯éå†ï¼ˆenumerableï¼‰å±æ€§çš„é”®å€¼ Object.entriesæ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‚æ•°å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å¯éå†ï¼ˆenumerableï¼‰å±æ€§çš„é”®å€¼å¯¹æ•°ç»„ 123456789101112131415161718var obj = &#123; foo: 'bar', baz: 42 &#125;;Object.keys(obj)// ["foo", "baz"]let &#123;keys, values, entries&#125; = Object;let obj = &#123; a: 1, b: 2, c: 3 &#125;;for (let key of keys(obj)) &#123; console.log(key); // 'a', 'b', 'c'&#125;for (let value of values(obj)) &#123; console.log(value); // 1, 2, 3&#125;for (let [key, value] of entries(obj)) &#123; console.log([key, value]); // ['a', 1], ['b', 2], ['c', 3]&#125; Object.entriesçš„åŸºæœ¬ç”¨é€”æ˜¯éå†å¯¹è±¡çš„å±æ€§ 12345678let obj = &#123; one: 1, two: 2 &#125;;for (let [k, v] of Object.entries(obj)) &#123; console.log( `$&#123;JSON.stringify(k)&#125;: $&#123;JSON.stringify(v)&#125;` );&#125;// "one": 1// "two": 2 å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦ è§£æ„èµ‹å€¼ 123456789101112let &#123; x, y, ...z &#125; = &#123; x: 1, y: 2, a: 3, b: 4 &#125;;x // 1y // 2z // &#123; a: 3, b: 4 &#125;// è§£æ„èµ‹å€¼ä¸ä¼šæ‹·è´ç»§æ‰¿è‡ªåŸå‹å¯¹è±¡çš„å±æ€§ã€‚let o1 = &#123; a: 1 &#125;;let o2 = &#123; b: 2 &#125;;o2.__proto__ = o1;let &#123; ...o3 &#125; = o2;o3 // &#123; b: 2 &#125;o3.a // undefined å¯ç”¨äºå–å‡ºå‚æ•°å¯¹è±¡çš„æ‰€æœ‰å¯éå†å±æ€§ï¼Œæ‹·è´åˆ°å½“å‰å¯¹è±¡ä¹‹ä¸­ï¼Œè¿™ç­‰åŒäºä½¿ç”¨Object.assignæ–¹æ³•ã€‚å®ƒåªæ‹·è´äº†å¯¹è±¡å®ä¾‹çš„å±æ€§ 1234567891011121314151617181920let z = &#123; a: 3, b: 4 &#125;;let n = &#123; ...z &#125;;n // &#123; a: 3, b: 4 &#125;let aClone = &#123; ...a &#125;;// ç­‰åŒäºlet aClone = Object.assign(&#123;&#125;, a);// æƒ³å®Œæ•´å…‹éš†ä¸€ä¸ªå¯¹è±¡ï¼Œè¿˜æ‹·è´å¯¹è±¡åŸå‹çš„å±æ€§// å†™æ³•ä¸€const clone1 = &#123; __proto__: Object.getPrototypeOf(obj), ...obj&#125;;// å†™æ³•äºŒconst clone2 = Object.assign( Object.create(Object.getPrototypeOf(obj)), obj); ç”¨äºåˆå¹¶ä¸¤ä¸ªå¯¹è±¡ 123let ab = &#123; ...a, ...b &#125;;// ç­‰åŒäºlet ab = Object.assign(&#123;&#125;, a, b); Null ä¼ å¯¼è¿ç®—ç¬¦ å¦‚æœè¯»å–å¯¹è±¡å†…éƒ¨çš„æŸä¸ªå±æ€§ï¼Œå¾€å¾€éœ€è¦åˆ¤æ–­ä¸€ä¸‹è¯¥å¯¹è±¡æ˜¯å¦å­˜åœ¨ 123456789101112131415// ä»¥å‰å†™æ³•const firstName = (message &amp;&amp; message.body &amp;&amp; message.body.user &amp;&amp; message.body.user.firstName) || 'default';// ç°åœ¨å†™æ³•// å¦‚æœ a æ˜¯ null æˆ– undefined, è¿”å› undefined// å¦åˆ™è¿”å› a.b.c().da?.b.c().d// å¦‚æœ a æ˜¯ null æˆ– undefinedï¼Œä¸‹é¢çš„è¯­å¥ä¸äº§ç”Ÿä»»ä½•æ•ˆæœ// å¦åˆ™æ‰§è¡Œ a.b = 42a?.b = 42// å¦‚æœ a æ˜¯ null æˆ– undefinedï¼Œä¸‹é¢çš„è¯­å¥ä¸äº§ç”Ÿä»»ä½•æ•ˆæœdelete a?.b Symbolæ˜¯å•¥ï¼Ÿ Symbol æ˜¯ä¸€ç§ç‰¹æ®Šçš„ã€ä¸å¯å˜çš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥ä½œä¸ºå¯¹è±¡å±æ€§çš„æ ‡è¯†ç¬¦ä½¿ç”¨ï¼Œç”¨å®ƒåˆ›å»ºçš„å±æ€§åæ˜¯ç»å¯¹å”¯ä¸€çš„ï¼Œä¸ä¼šäº§ç”Ÿå†²çªï¼›Symbol æ•°æ®ç±»å‹æ˜¯ä¸€ä¸ªåŸå§‹æ•°æ®ç±»å‹ï¼› åˆ›å»º 12345let s = Symbol();typeof s // "symbol"let s1 = Symbol('foo');s1 // Symbol(foo) é€šè¿‡Symbol()åˆ›å»ºçš„symbolä¸å…¶ä»–ä»»ä½•å€¼éƒ½ä¸ç›¸ç­‰ 123456789// æ²¡æœ‰å‚æ•°çš„æƒ…å†µlet s1 = Symbol();let s2 = Symbol();s1 === s2 // false// æœ‰å‚æ•°çš„æƒ…å†µlet s1 = Symbol('foo');let s2 = Symbol('foo');s1 === s2 // false Symbol å€¼ä¸èƒ½ä¸å…¶ä»–ç±»å‹çš„å€¼è¿›è¡Œè¿ç®— 12345let sym = Symbol('My symbol');"your symbol is " + sym// TypeError: can't convert symbol to string`your symbol is $&#123;sym&#125;`// TypeError: can't convert symbol to string Symbol å€¼å¯ä»¥æ˜¾å¼è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥è½¬ä¸ºå¸ƒå°”å€¼ï¼Œä½†æ˜¯ä¸èƒ½è½¬ä¸ºæ•°å€¼ã€‚ 123456789101112131415// Symbol å€¼å¯ä»¥æ˜¾å¼è½¬ä¸ºå­—ç¬¦ä¸²let sym = Symbol('My symbol');String(sym) // 'Symbol(My symbol)'sym.toString() // 'Symbol(My symbol)'let sym = Symbol();Boolean(sym) // true!sym // falseif (sym) &#123; // ...&#125;Number(sym) // TypeErrorsym + 2 // TypeError åšä¸ºå±æ€§åä½¿ç”¨ 1234567891011121314151617let mySymbol = Symbol();// ç¬¬ä¸€ç§å†™æ³•let a = &#123;&#125;;a[mySymbol] = 'Hello!';// ç¬¬äºŒç§å†™æ³•let a = &#123;// å¯¹è±¡çš„å¢å¼ºå±æ€§åå†™æ³• [mySymbol]: 'Hello!'&#125;;// ç¬¬ä¸‰ç§å†™æ³•let a = &#123;&#125;;Object.defineProperty(a, mySymbol, &#123; value: 'Hello!' &#125;);// ä»¥ä¸Šå†™æ³•éƒ½å¾—åˆ°åŒæ ·ç»“æœa[mySymbol] // "Hello!" åšä¸ºå±æ€§åä½¿ç”¨æ—¶ï¼Œä¸èƒ½ä½¿ç”¨.è¯­æ³•ï¼Œä½¿ç”¨ç‚¹è¯­æ³•ä¼šè¢«å½“æˆå­—ç¬¦ä¸²å¤„ç†123456const mySymbol = Symbol();const a = &#123;&#125;;a.mySymbol = 'Hello!';a[mySymbol] // undefineda['mySymbol'] // "Hello!" å±æ€§åçš„éå† Symbol ä½œä¸ºå±æ€§åï¼Œè¯¥å±æ€§ä¸ä¼šå‡ºç°åœ¨forâ€¦inã€forâ€¦ofå¾ªç¯ä¸­ï¼Œä¹Ÿä¸ä¼šè¢«Object.keys()ã€Object.getOwnPropertyNames()ã€JSON.stringify()è¿”å›ã€‚ä½†æ˜¯ï¼Œå®ƒä¹Ÿä¸æ˜¯ç§æœ‰å±æ€§ï¼Œæœ‰ä¸€ä¸ªObject.getOwnPropertySymbolsæ–¹æ³•ï¼Œå¯ä»¥è·å–æŒ‡å®šå¯¹è±¡çš„æ‰€æœ‰ Symbol å±æ€§åã€‚1234567891011const obj = &#123;&#125;;let a = Symbol('a');let b = Symbol('b');obj[a] = 'Hello';obj[b] = 'World';const objectSymbols = Object.getOwnPropertySymbols(obj);objectSymbols// [Symbol(a), Symbol(b)] Symbolçš„å…±äº«(é‡å¤ä½¿ç”¨) æœ‰æ—¶ï¼Œæˆ‘ä»¬æƒ³é‡å¤ä½¿ç”¨æŸä¸ªSymbolï¼Œæˆ‘ä»¬çŸ¥é“é€šè¿‡Symbol()æ–¹æ³•ï¼Œç”Ÿæˆçš„symbolæ˜¯ç»å¯¹å”¯ä¸€çš„ï¼Œå³ä½¿æè¿°ç¬¦ä¸€æ · 123let s1 = Symbol('foo');let s2 = Symbol('foo');s1===s2 // false Symbol.foræ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚å®ƒæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œç„¶åæœç´¢æœ‰æ²¡æœ‰ä»¥è¯¥å‚æ•°ä½œä¸ºåç§°çš„Symbolå€¼ã€‚å¦‚æœæœ‰ï¼Œå°±è¿”å›è¿™ä¸ªSymbolå€¼ï¼Œå¦åˆ™å°±æ–°å»ºå¹¶è¿”å›ä¸€ä¸ªä»¥è¯¥å­—ç¬¦ä¸²ä¸ºåç§°çš„Symbolå€¼ 123456789let s1 = Symbol.for('foo');let s2 = Symbol.for('foo');s1 === s2 // trueSymbol.for("bar") === Symbol.for("bar")// trueSymbol("bar") === Symbol("bar")// false ç”¨Symbolå®ç°å•ä¾‹æ¨¡å¼ ä¼ ç»Ÿå®ç° 123456789101112// mod.jsfunction A() &#123; this.foo = 'hello';&#125;if (!global._foo) &#123; global._foo = new A();&#125;module.exports = global._foo;// åŠ è½½const a = require('./mod.js');console.log(a.foo); å…¨å±€å˜é‡global._fooæ˜¯å¯å†™çš„ï¼Œä»»ä½•æ–‡ä»¶éƒ½å¯ä»¥ä¿®æ”¹ ä½¿ç”¨Symbol 123456789101112// mod.jsconst FOO_KEY = Symbol.for('foo');function A() &#123; this.foo = 'hello';&#125;if (!global[FOO_KEY]) &#123; global[FOO_KEY] = new A();&#125;module.exports = global[FOO_KEY]; ä¸Šé¢ä»£ç ä¸­ï¼Œå¯ä»¥ä¿è¯global[FOO_KEY]ä¸ä¼šè¢«æ— æ„é—´è¦†ç›–ï¼Œä½†è¿˜æ˜¯å¯ä»¥è¢«æ”¹å†™12const a = require('./mod.js');global[Symbol.for('foo')] = 123; Setå’ŒMapæ•°æ®ç»“æ„Setæ•°æ®ç»“æ„ å®ƒç±»ä¼¼äºæ•°ç»„ï¼Œä½†æ˜¯æˆå‘˜çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œæ²¡æœ‰é‡å¤çš„å€¼ã€‚ ä½¿ç”¨new Set()åˆ›å»º 12345678const s = new Set();[2, 3, 5, 4, 5, 2, 2].forEach(x =&gt; s.add(x));for (let i of s) &#123; console.log(i);&#125;// 2 3 5 4ï¼Œé‡å¤å€¼ä¸ä¼šè¢«ä¿ç•™ Set å‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„ï¼ˆæˆ–è€…å…·æœ‰ iterable æ¥å£çš„å…¶ä»–æ•°æ®ç»“æ„ï¼‰ä½œä¸ºå‚æ•°ï¼Œç”¨æ¥åˆå§‹åŒ– 1234567891011121314151617181920// ä¾‹ä¸€const set = new Set([1, 2, 3, 4, 4]);[...set]// [1, 2, 3, 4]ï¼Œè‡ªåŠ¨åˆ é™¤äº†é‡å¤çš„å€¼ï¼Œå¯åˆ©ç”¨è¿™æ–¹æ³•å®ç°æ•°ç»„å»é‡// ä¾‹äºŒconst items = new Set([1, 2, 3, 4, 5, 5, 5, 5]);items.size // 5// ä¾‹ä¸‰function divs () &#123; return [...document.querySelectorAll('div')];&#125;const set = new Set(divs());set.size // 56// ç±»ä¼¼äºdivs().forEach(div =&gt; set.add(div));set.size // 56 Setåˆ¤æ–­å€¼æ˜¯å¦é‡å¤ï¼Œç±»ä¼¼===ï¼Œä¸è¿‡NaNç­‰äºè‡ªèº«ï¼›ä»»æ„ä¸¤ä¸ªå¯¹è±¡æ˜¯ä¸ç›¸ç­‰çš„ 123456789101112let set = new Set();let a = NaN;let b = NaN;set.add(a);set.add(b);set // Set &#123;NaN&#125;let set = new Set();set.add(&#123;&#125;);set.size // 1set.add(&#123;&#125;);set.size // 2 å±æ€§å’Œæ–¹æ³• å±æ€§ Set.prototype.constructorï¼šæ„é€ å‡½æ•°ï¼Œé»˜è®¤å°±æ˜¯Setå‡½æ•°ã€‚ Set.prototype.sizeï¼šè¿”å›Setå®ä¾‹çš„æˆå‘˜æ€»æ•°ã€‚ æ“ä½œæ–¹æ³• add(value)ï¼šæ·»åŠ æŸä¸ªå€¼ï¼Œè¿”å›Setç»“æ„æœ¬èº«ã€‚ delete(value)ï¼šåˆ é™¤æŸä¸ªå€¼ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºåˆ é™¤æ˜¯å¦æˆåŠŸã€‚ has(value)ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥å€¼æ˜¯å¦ä¸ºSetçš„æˆå‘˜ã€‚ clear()ï¼šæ¸…é™¤æ‰€æœ‰æˆå‘˜ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚ éå†æ–¹æ³• keys()ï¼šè¿”å›é”®åçš„éå†å™¨ values()ï¼šè¿”å›é”®å€¼çš„éå†å™¨ entries()ï¼šè¿”å›é”®å€¼å¯¹çš„éå†å™¨ forEach()ï¼šä½¿ç”¨å›è°ƒå‡½æ•°éå†æ¯ä¸ªæˆå‘˜12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455s.add(1).add(2).add(2);// æ³¨æ„2è¢«åŠ å…¥äº†ä¸¤æ¬¡s.size // 2s.has(1) // trues.has(2) // trues.has(3) // falses.delete(2);s.has(2) // falselet set = new Set(['red', 'green', 'blue']);for (let item of set.keys()) &#123; console.log(item);&#125;// red// green// bluefor (let item of set.values()) &#123; console.log(item);&#125;// red// green// bluefor (let item of set.entries()) &#123; console.log(item);&#125;// ["red", "red"]// ["green", "green"]// ["blue", "blue"]// å¯ç›´æ¥ä½¿ç”¨for..oféå†let set = new Set(['red', 'green', 'blue']);for (let x of set) &#123; console.log(x);&#125;// red// green// bluelet set = new Set([1, 2, 3]);set.forEach((value, key) =&gt; console.log(value * 2) )// ä½¿ç”¨forEachåšé™„åŠ æ“ä½œ// 2// 4// 6// seté…åˆfilterå®Œæˆäº¤é›†ã€å¹¶é›†ã€å·®é›†let a = new Set([1, 2, 3]);let b = new Set([4, 3, 2]);// å¹¶é›†let union = new Set([...a, ...b]);// Set &#123;1, 2, 3, 4&#125;// äº¤é›†let intersect = new Set([...a].filter(x =&gt; b.has(x)));// set &#123;2, 3&#125;// å·®é›†let difference = new Set([...a].filter(x =&gt; !b.has(x)));// Set &#123;1&#125; Array.fromæ–¹æ³•å¯ä»¥å°† Set ç»“æ„è½¬ä¸ºæ•°ç»„ã€‚ 12345678const items = new Set([1, 2, 3, 4, 5]);const array = Array.from(items);// åˆ©ç”¨fromæ–¹æ³•å®Œæˆæ•°ç»„çš„å»é‡function dedupe(array) &#123; return Array.from(new Set(array));&#125;dedupe([1, 1, 2, 3]) // [1, 2, 3] WeakSet WeakSet ç»“æ„ä¸ Set ç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸é‡å¤çš„å€¼çš„é›†åˆã€‚ä½†æ˜¯ï¼Œå®ƒä¸ Set æœ‰ä¸¤ä¸ªåŒºåˆ« WeakSet çš„æˆå‘˜åªèƒ½æ˜¯å¯¹è±¡ï¼Œè€Œä¸èƒ½æ˜¯å…¶ä»–ç±»å‹çš„å€¼ åƒåœ¾å›æ”¶æœºåˆ¶ä¸è€ƒè™‘ WeakSet å¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨ï¼›å¦‚æœå…¶ä»–å¯¹è±¡éƒ½ä¸å†å¼•ç”¨è¯¥å¯¹è±¡ï¼Œé‚£ä¹ˆåƒåœ¾å›æ”¶æœºåˆ¶ä¼šè‡ªåŠ¨å›æ”¶è¯¥å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ï¼Œä¸è€ƒè™‘è¯¥å¯¹è±¡è¿˜å­˜åœ¨äº WeakSet ä¹‹ä¸­ WeakSet é€‚åˆä¸´æ—¶å­˜æ”¾ä¸€ç»„å¯¹è±¡ï¼Œä»¥åŠå­˜æ”¾è·Ÿå¯¹è±¡ç»‘å®šçš„ä¿¡æ¯ã€‚åªè¦è¿™äº›å¯¹è±¡åœ¨å¤–éƒ¨æ¶ˆå¤±ï¼Œå®ƒåœ¨ WeakSet é‡Œé¢çš„å¼•ç”¨å°±ä¼šè‡ªåŠ¨æ¶ˆå¤± WeakSet çš„æˆå‘˜æ˜¯ä¸é€‚åˆå¼•ç”¨çš„ï¼Œå› ä¸ºå®ƒä¼šéšæ—¶æ¶ˆå¤± ç”±äº WeakSet å†…éƒ¨æœ‰å¤šå°‘ä¸ªæˆå‘˜ï¼Œå–å†³äºåƒåœ¾å›æ”¶æœºåˆ¶æœ‰æ²¡æœ‰è¿è¡Œï¼Œè¿è¡Œå‰åå¾ˆå¯èƒ½æˆå‘˜ä¸ªæ•°æ˜¯ä¸ä¸€æ ·çš„ï¼Œè€Œåƒåœ¾å›æ”¶æœºåˆ¶ä½•æ—¶è¿è¡Œæ˜¯ä¸å¯é¢„æµ‹çš„ï¼Œå› æ­¤ ES6 è§„å®š WeakSet ä¸å¯éå†1234567891011121314const ws = new WeakSet();ws.add(1)// TypeError: Invalid value used in weak setws.add(Symbol())// TypeError: invalid value used in weak set// WeakSet å¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„æˆ–ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ä½œä¸ºå‚æ•°(å®é™…ä¸Šï¼Œä»»ä½•å…·æœ‰ Iterable æ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ä½œä¸º WeakSet çš„å‚æ•°)const a = [[1, 2], [3, 4]];const ws = new WeakSet(a);// ä¼šå°†aæ•°ç»„çš„æˆå‘˜æ·»åŠ åˆ°wsä¸­ï¼Œè€Œä¸æ˜¯aæ•°ç»„è‡ªèº«ï¼›æ‰€ä»¥æ•°ç»„æˆå‘˜å¿…é¡»æ˜¯å¯¹è±¡// WeakSet &#123;[1, 2], [3, 4]&#125;const b = [3, 4];const ws = new WeakSet(b); // bçš„æˆå‘˜ä¸æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ä¼šå‡ºé”™// Uncaught TypeError: Invalid value used in weak set(â€¦) æ–¹æ³• addã€deleteã€hasï¼ŒåŒsetç›¸æ¯”æ²¡æœ‰clearæ–¹æ³•1234567891011121314151617const ws = new WeakSet();const obj = &#123;&#125;;const foo = &#123;&#125;;ws.add(window);ws.add(obj);ws.has(window); // truews.has(foo); // falsews.delete(window);ws.has(window); // false// WeakSetæ²¡æœ‰sizeå±æ€§ï¼Œæ²¡æœ‰åŠæ³•éå†å®ƒçš„æˆå‘˜ã€‚ws.size // undefinedws.forEach // undefinedws.forEach(function(item)&#123; console.log('WeakSet has ' + item)&#125;)// TypeError: undefined is not a function Mapæ•°æ®ç»“æ„ ç±»ä¼¼Objectç»“æ„ï¼Œéƒ½æ˜¯key-valueç»“æ„ï¼Œä¸åŒçš„åœ°æ–¹æ˜¯â€œé”®â€çš„èŒƒå›´ä¸é™äºå­—ç¬¦ä¸²ï¼Œå„ç§ç±»å‹çš„å€¼ï¼ˆåŒ…æ‹¬å¯¹è±¡ï¼‰éƒ½å¯ä»¥å½“ä½œé”®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒObject ç»“æ„æä¾›äº†â€œå­—ç¬¦ä¸²â€”å€¼â€çš„å¯¹åº”ï¼ŒMapç»“æ„æä¾›äº†â€œå€¼â€”å€¼â€çš„å¯¹åº”ï¼Œæ˜¯ä¸€ç§æ›´å®Œå–„çš„ Hash ç»“æ„å®ç°ã€‚å¦‚æœä½ éœ€è¦â€œé”®å€¼å¯¹â€çš„æ•°æ®ç»“æ„ï¼ŒMap æ¯” Object æ›´åˆé€‚ã€‚ æä¾›äº†ä¸€ç§æ›´åŠ çµæ´»æ–¹ä¾¿çš„ä¸€ä¸€æ˜ å°„çš„ç»“æ„ 123456789101112131415161718192021222324252627282930const m = new Map();const o = &#123;p: 'Hello World'&#125;;m.set(o, 'content')m.get(o) // "content"m.has(o) // truem.delete(o) // truem.has(o) // false// æ¥æ”¶æ•°ç»„åšä¸ºå‚æ•°const map = new Map([ ['name', 'å¼ ä¸‰'], ['title', 'Author']]);map.size // 2map.has('name') // truemap.get('name') // "å¼ ä¸‰"map.has('title') // truemap.get('title') // "Author"// ä¸Šé¢çš„ç­‰åŒäºconst items = [ ['name', 'å¼ ä¸‰'], ['title', 'Author']];const map = new Map();items.forEach(// å–å¾—æ¯ä¸ªitemçš„key,valueï¼Œç„¶åå†æ·»åŠ åˆ°mapä¸­ ([key, value]) =&gt; map.set(key, value)); å±æ€§å’Œæ–¹æ³• å±æ€§ sizeå±æ€§è¿”å› Map ç»“æ„çš„æˆå‘˜æ€»æ•°ã€‚ æ“ä½œæ–¹æ³• setæ–¹æ³•è®¾ç½®é”®åkeyå¯¹åº”çš„é”®å€¼ä¸ºvalueï¼Œç„¶åè¿”å›æ•´ä¸ª Map ç»“æ„ã€‚å¦‚æœkeyå·²ç»æœ‰å€¼ï¼Œåˆ™é”®å€¼ä¼šè¢«æ›´æ–°ï¼Œå¦åˆ™å°±æ–°ç”Ÿæˆè¯¥é”®ã€‚ getæ–¹æ³•è¯»å–keyå¯¹åº”çš„é”®å€¼ï¼Œå¦‚æœæ‰¾ä¸åˆ°keyï¼Œè¿”å›undefinedã€‚ hasæ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªé”®æ˜¯å¦åœ¨å½“å‰ Map å¯¹è±¡ä¹‹ä¸­ã€‚ deleteæ–¹æ³•åˆ é™¤æŸä¸ªé”®ï¼Œè¿”å›trueã€‚å¦‚æœåˆ é™¤å¤±è´¥ï¼Œè¿”å›falseã€‚ clearæ–¹æ³•æ¸…é™¤æ‰€æœ‰æˆå‘˜ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚ éå†æ–¹æ³• keys()ï¼šè¿”å›é”®åçš„éå†å™¨ã€‚ values()ï¼šè¿”å›é”®å€¼çš„éå†å™¨ã€‚ entries()ï¼šè¿”å›æ‰€æœ‰æˆå‘˜çš„éå†å™¨ã€‚ forEach()ï¼šéå† Map çš„æ‰€æœ‰æˆå‘˜12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697// sizeconst map = new Map();map.set('foo', true);map.set('bar', false);map.size // 2// setconst m = new Map();m.set('edition', 6) // é”®æ˜¯å­—ç¬¦ä¸²m.set(262, 'standard') // é”®æ˜¯æ•°å€¼m.set(undefined, 'nah') // é”®æ˜¯ undefined// setæ–¹æ³•è¿”å›çš„æ˜¯å½“å‰çš„Mapå¯¹è±¡ï¼Œå› æ­¤å¯ä»¥é‡‡ç”¨é“¾å¼å†™æ³•ã€‚let map = new Map() .set(1, 'a') .set(2, 'b') .set(3, 'c');// getconst m = new Map();const hello = function() &#123;console.log('hello');&#125;;m.set(hello, 'Hello ES6!') // é”®æ˜¯å‡½æ•°m.get(hello) // Hello ES6!// hasconst m = new Map();m.set('edition', 6);m.set(262, 'standard');m.set(undefined, 'nah');m.has('edition') // truem.has('years') // falsem.has(262) // truem.has(undefined) // true// deleteconst m = new Map();m.set(undefined, 'nah');m.has(undefined) // truem.delete(undefined)m.has(undefined) // false// clearlet map = new Map();map.set('foo', true);map.set('bar', false);map.size // 2map.clear()map.size // 0// éå†æ–¹æ³•const map = new Map([ ['F', 'no'], ['T', 'yes'],]);for (let key of map.keys()) &#123; console.log(key);&#125;// "F"// "T"for (let value of map.values()) &#123; console.log(value);&#125;// "no"// "yes"for (let item of map.entries()) &#123; console.log(item[0], item[1]);&#125;// "F" "no"// "T" "yes"// æˆ–è€…for (let [key, value] of map.entries()) &#123; console.log(key, value);&#125;// "F" "no"// "T" "yes"// ç­‰åŒäºä½¿ç”¨map.entries()for (let [key, value] of map) &#123; console.log(key, value);&#125;// "F" "no"// "T" "yes"// forEachï¼Œç¬¬äºŒä¸ªå‚æ•°å¯ä»¥ç»‘å®šthisconst reporter = &#123; report: function(key, value) &#123; console.log("Key: %s, Value: %s", key, value); &#125;&#125;;map.forEach(function(value, key, map) &#123; this.report(key, value);&#125;, reporter); mapè½¬æ•°ç»„å¯ä»¥ä½¿ç”¨...æ‰©å±•è¿ç®—ç¬¦ 1234567891011121314151617const map = new Map([ [1, 'one'], [2, 'two'], [3, 'three'],]);[...map.keys()]// [1, 2, 3][...map.values()]// ['one', 'two', 'three'][...map.entries()]// [[1,'one'], [2, 'two'], [3, 'three']][...map]// [[1,'one'], [2, 'two'], [3, 'three']] ç»“åˆæ•°ç»„çš„mapæ–¹æ³•ã€filteræ–¹æ³•ï¼Œå¯ä»¥å®ç° Map çš„éå†å’Œè¿‡æ»¤ï¼ˆMap æœ¬èº«æ²¡æœ‰mapå’Œfilteræ–¹æ³•ï¼‰ 1234567891011121314const map0 = new Map() .set(1, 'a') .set(2, 'b') .set(3, 'c');const map1 = new Map( [...map0].filter(([k, v]) =&gt; k &lt; 3));// äº§ç”Ÿ Map ç»“æ„ &#123;1 =&gt; 'a', 2 =&gt; 'b'&#125;const map2 = new Map( [...map0].map(([k, v]) =&gt; [k * 2, '_' + v]) );// äº§ç”Ÿ Map ç»“æ„ &#123;2 =&gt; '_a', 4 =&gt; '_b', 6 =&gt; '_c'&#125; ä¸å…¶ä»–æ•°æ®ç»“æ„çš„äº’ç›¸è½¬æ¢ Map è½¬ä¸ºæ•°ç»„ 12345const myMap = new Map() .set(true, 7) .set(&#123;foo: 3&#125;, ['abc']);[...myMap]// [ [ true, 7 ], [ &#123; foo: 3 &#125;, [ 'abc' ] ] ] æ•°ç»„ è½¬ä¸º Map 12345678new Map([ [true, 7], [&#123;foo: 3&#125;, ['abc']]])// Map &#123;// true =&gt; 7,// Object &#123;foo: 3&#125; =&gt; ['abc']// &#125; Map è½¬ä¸ºå¯¹è±¡ 12345678910111213function strMapToObj(strMap) &#123; let obj = Object.create(null); for (let [k,v] of strMap) &#123; obj[k] = v; &#125; return obj;&#125;const myMap = new Map() .set('yes', true) .set('no', false);strMapToObj(myMap)// &#123; yes: true, no: false &#125; å¯¹è±¡è½¬ä¸º Map 12345678910function objToStrMap(obj) &#123; let strMap = new Map(); for (let k of Object.keys(obj)) &#123; strMap.set(k, obj[k]); &#125; return strMap;&#125;objToStrMap(&#123;yes: true, no: false&#125;)// Map &#123;"yes" =&gt; true, "no" =&gt; false&#125; Map è½¬ä¸º JSON 12345678910111213141516// Map çš„é”®åéƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™æ—¶å¯ä»¥é€‰æ‹©è½¬ä¸ºå¯¹è±¡ JSONã€‚function strMapToJson(strMap) &#123; return JSON.stringify(strMapToObj(strMap));&#125;let myMap = new Map().set('yes', true).set('no', false);strMapToJson(myMap)// '&#123;"yes":true,"no":false&#125;'// Map çš„é”®åæœ‰éå­—ç¬¦ä¸²ï¼Œè¿™æ—¶å¯ä»¥é€‰æ‹©è½¬ä¸ºæ•°ç»„ JSONfunction mapToArrayJson(map) &#123; return JSON.stringify([...map]);&#125;let myMap = new Map().set(true, 7).set(&#123;foo: 3&#125;, ['abc']);mapToArrayJson(myMap)// '[[true,7],[&#123;"foo":3&#125;,["abc"]]]' JSON è½¬ä¸º Map 123456function jsonToStrMap(jsonStr) &#123; return objToStrMap(JSON.parse(jsonStr));&#125;jsonToStrMap('&#123;"yes": true, "no": false&#125;')// Map &#123;'yes' =&gt; true, 'no' =&gt; false&#125; WeakMap ç±»ä¼¼WeakSet 123456789101112// WeakMap å¯ä»¥ä½¿ç”¨ set æ–¹æ³•æ·»åŠ æˆå‘˜const wm1 = new WeakMap();const key = &#123;foo: 1&#125;;wm1.set(key, 2);wm1.get(key) // 2// WeakMap ä¹Ÿå¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„ï¼Œ// ä½œä¸ºæ„é€ å‡½æ•°çš„å‚æ•°const k1 = [1, 2, 3];const k2 = [4, 5, 6];const wm2 = new WeakMap([[k1, 'foo'], [k2, 'bar']]);wm2.get(k2) // "bar" WeakMapä¸Mapçš„åŒºåˆ«æœ‰ä¸¤ç‚¹ã€‚ WeakMapåªæ¥å—å¯¹è±¡ä½œä¸ºé”®åï¼ˆnullé™¤å¤–ï¼‰ï¼Œä¸æ¥å—å…¶ä»–ç±»å‹çš„å€¼ä½œä¸ºé”®å WeakMapçš„é”®åæ‰€æŒ‡å‘çš„å¯¹è±¡ï¼Œä¸è®¡å…¥åƒåœ¾å›æ”¶æœºåˆ¶1234567const map = new WeakMap();map.set(1, 2)// TypeError: 1 is not an object!map.set(Symbol(), 2)// TypeError: Invalid value used as weak map keymap.set(null, 2)// TypeError: Invalid value used as weak map key WeakMapçš„ä¸“ç”¨åœºåˆå°±æ˜¯ï¼Œå®ƒçš„é”®æ‰€å¯¹åº”çš„å¯¹è±¡ï¼Œå¯èƒ½ä¼šåœ¨å°†æ¥æ¶ˆå¤±ã€‚WeakMapç»“æ„æœ‰åŠ©äºé˜²æ­¢å†…å­˜æ³„æ¼ WeakMap åº”ç”¨çš„å…¸å‹åœºåˆå°±æ˜¯ DOM èŠ‚ç‚¹ä½œä¸ºé”®å 1234567891011let myElement = document.getElementById('logo');let myWeakmap = new WeakMap();myWeakmap.set(myElement, &#123;timesClicked: 0&#125;);myElement.addEventListener('click', function() &#123; let logoData = myWeakmap.get(myElement); logoData.timesClicked++;&#125;, false);// ä¸Šé¢ä»£ç ä¸­ï¼ŒmyElementæ˜¯ä¸€ä¸ª DOM èŠ‚ç‚¹ï¼Œæ¯å½“å‘ç”Ÿclickäº‹ä»¶ï¼Œå°±æ›´æ–°ä¸€ä¸‹çŠ¶æ€ã€‚æˆ‘ä»¬å°†è¿™ä¸ªçŠ¶æ€ä½œä¸ºé”®å€¼æ”¾åœ¨ WeakMap é‡Œï¼Œå¯¹åº”çš„é”®åå°±æ˜¯myElementã€‚ä¸€æ—¦è¿™ä¸ª DOM èŠ‚ç‚¹åˆ é™¤ï¼Œè¯¥çŠ¶æ€å°±ä¼šè‡ªåŠ¨æ¶ˆå¤±ï¼Œä¸å­˜åœ¨å†…å­˜æ³„æ¼é£é™©ã€‚ éƒ¨ç½²ç§æœ‰å±æ€§ 123456789101112131415161718192021222324const _counter = new WeakMap();const _action = new WeakMap();class Countdown &#123; constructor(counter, action) &#123; _counter.set(this, counter); _action.set(this, action); &#125; dec() &#123; let counter = _counter.get(this); if (counter &lt; 1) return; counter--; _counter.set(this, counter); if (counter === 0) &#123; _action.get(this)(); &#125; &#125;&#125;const c = new Countdown(2, () =&gt; console.log('DONE'));c.dec()c.dec()// DONE Proxy Proxy å¯ä»¥ç†è§£æˆï¼Œåœ¨ç›®æ ‡å¯¹è±¡ä¹‹å‰æ¶è®¾ä¸€å±‚â€œæ‹¦æˆªâ€ï¼Œå¤–ç•Œå¯¹è¯¥å¯¹è±¡çš„è®¿é—®ï¼Œéƒ½å¿…é¡»å…ˆé€šè¿‡è¿™å±‚æ‹¦æˆªï¼Œå› æ­¤æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥å¯¹å¤–ç•Œçš„è®¿é—®è¿›è¡Œè¿‡æ»¤å’Œæ”¹å†™ã€‚Proxy è¿™ä¸ªè¯çš„åŸæ„æ˜¯ä»£ç†ï¼Œç”¨åœ¨è¿™é‡Œè¡¨ç¤ºç”±å®ƒæ¥â€œä»£ç†â€æŸäº›æ“ä½œï¼Œå¯ä»¥è¯‘ä¸ºâ€œä»£ç†å™¨â€ Proxyç›¸å½“äºåœ¨ç›®æ ‡å¯¹è±¡ä¸Šæ·»åŠ äº†ä¸€å±‚æ‹¦æˆªå™¨ï¼Œåœ¨æŸäº›æ“ä½œç”Ÿæ•ˆä¹‹å‰ï¼Œå¯ä»¥åœ¨æ‹¦æˆªå™¨ä¸­åšä¸€äº›æ“ä½œï¼Œä¾‹å¦‚åœ¨è®¾ç½®æŸä¸ªå€¼å‰ï¼Œæ£€æŸ¥å€¼æ˜¯å¦ç¬¦åˆè¦æ±‚123456789101112131415161718192021222324252627282930313233343536var proxy = new Proxy(&#123;&#125;, &#123;// ä»£ç†äº†&#123;&#125;å¯¹è±¡çš„æ‰€æœ‰getæ“ä½œï¼Œåœ¨å®é™…æ“ä½œç”Ÿæ•ˆå‰ï¼Œæ‹¦æˆªäº†å¹¶è¿”å›æ–°å€¼ get: function(target, property) &#123; return 35; &#125;&#125;);proxy.time // 35proxy.name // 35proxy.title // 35// æ‹¦æˆªå™¨å¯ä»¥ä»£ç†å¾ˆå¤šç±»å‹çš„æ“ä½œï¼Œåœ¨è¿™äº›æ“ä½œçœŸæ­£ç”Ÿæ•ˆå‰ï¼Œè¿›è¡Œæ‹¦æˆªvar handler = &#123; get: function(target, name) &#123; if (name === 'prototype') &#123; return Object.prototype; &#125; return 'Hello, ' + name; &#125;, apply: function(target, thisBinding, args) &#123; return args[0]; &#125;, construct: function(target, args) &#123; return &#123;value: args[1]&#125;; &#125;&#125;;var fproxy = new Proxy(function(x, y) &#123; return x + y;&#125;, handler);fproxy(1, 2) // 1new fproxy(1,2) // &#123;value: 2&#125;fproxy.prototype === Object.prototype // truefproxy.foo // "Hello, foo" Proxyä¸­çš„thisé—®é¢˜ åœ¨ Proxy ä»£ç†çš„æƒ…å†µä¸‹ï¼Œç›®æ ‡å¯¹è±¡å†…éƒ¨çš„thiså…³é”®å­—ä¼šæŒ‡å‘ Proxy ä»£ç†ã€‚1234567891011const target = &#123; m: function () &#123; console.log(this === proxy); &#125;&#125;;const handler = &#123;&#125;;const proxy = new Proxy(target, handler);target.m() // falseproxy.m() // trueï¼Œä»£ç†åï¼ŒthisæŒ‡å‘äº†proxyè€Œä¸æ˜¯åŸå…ˆçš„target Reflect åº”è¯¥æ˜¯jsåœ¨è®¾è®¡ä¹‹åˆæœ‰äº›ä¸åˆç†çš„åœ°æ–¹ï¼Œä¾‹å¦‚å°†ä¸€äº›æ˜æ˜¾æ˜¯è¯­è¨€å†…éƒ¨çš„æ–¹æ³•æ”¾åˆ°äº†Objectä¸Šï¼Œç°åœ¨è¦æ”¹æ­£ï¼Œéœ€è¦ä¸€ä¸ªå®¹å™¨æ¥è£…è½½è¿™äº›æ–¹æ³•ï¼Œæ‰€ä»¥å°†è¿™äº›æ”¹è‰¯æ–¹æ³•éƒ½æ”¾åœ¨äº†Reflectå¯¹è±¡ä¸Š ç‰¹ç‚¹ ç°é˜¶æ®µï¼ŒæŸäº›æ–¹æ³•åŒæ—¶åœ¨Objectå’ŒReflectå¯¹è±¡ä¸Šéƒ¨ç½²ï¼Œæœªæ¥çš„æ–°æ–¹æ³•å°†åªéƒ¨ç½²åœ¨Reflectå¯¹è±¡ä¸Šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»Reflectå¯¹è±¡ä¸Šå¯ä»¥æ‹¿åˆ°è¯­è¨€å†…éƒ¨çš„æ–¹æ³•ã€‚ ä¿®æ”¹æŸäº›Objectæ–¹æ³•çš„è¿”å›ç»“æœï¼Œè®©å…¶å˜å¾—æ›´åˆç†ã€‚ è®©Objectæ“ä½œéƒ½å˜æˆå‡½æ•°è¡Œä¸ºã€‚ Reflectå¯¹è±¡çš„æ–¹æ³•ä¸Proxyå¯¹è±¡çš„æ–¹æ³•ä¸€ä¸€å¯¹åº”ï¼Œåªè¦æ˜¯Proxyå¯¹è±¡çš„æ–¹æ³•ï¼Œå°±èƒ½åœ¨Reflectå¯¹è±¡ä¸Šæ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•ã€‚ Promiseå¯¹è±¡ å¯ä»¥å’ŒjQueryä¸­çš„å»¶è¿Ÿå¯¹è±¡ä»¥åŠpromiseå¯¹æ¯”ç†è§£ åŸºæœ¬ç”¨æ³• 123456789101112131415var promise = new Promise(function(resolve, reject) &#123; // ... some code if (/* å¼‚æ­¥æ“ä½œæˆåŠŸ */)&#123; return resolve(value); &#125; else &#123; return reject(error); &#125;&#125;);promise.then(function(value) &#123; // success&#125;, function(error) &#123; // failure&#125;); Promiseæ–°å»ºåå°±ä¼šç«‹å³æ‰§è¡Œ 1234567891011121314let promise = new Promise(function(resolve, reject) &#123; console.log('Promise'); return resolve();&#125;);promise.then(function() &#123; console.log('resolved.');&#125;);console.log('Hi!');// Promise// Hi!// resolved è¿”å›å¦ä¸€ä¸ªå¼‚æ­¥æ“ä½œ 12345678var p1 = new Promise(function (resolve, reject) &#123; // ...&#125;);var p2 = new Promise(function (resolve, reject) &#123; // ... return resolve(p1);// p1å’Œp2éƒ½æ˜¯ Promise çš„å®ä¾‹ï¼Œä½†æ˜¯p2çš„resolveæ–¹æ³•å°†p1ä½œä¸ºå‚æ•°ï¼Œå³ä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœæ˜¯è¿”å›å¦ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œè¿™æ—¶p1çš„çŠ¶æ€å°±ä¼šä¼ é€’ç»™p2ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œp1çš„çŠ¶æ€å†³å®šäº†p2çš„çŠ¶æ€ã€‚å¦‚æœp1çš„çŠ¶æ€æ˜¯pendingï¼Œé‚£ä¹ˆp2çš„å›è°ƒå‡½æ•°å°±ä¼šç­‰å¾…p1çš„çŠ¶æ€æ”¹å˜ï¼›å¦‚æœp1çš„çŠ¶æ€å·²ç»æ˜¯resolvedæˆ–è€…rejectedï¼Œé‚£ä¹ˆp2çš„å›è°ƒå‡½æ•°å°†ä¼šç«‹åˆ»æ‰§è¡Œ&#125;); p.then promise.then(resolvedFn,rejectFn); åŸºäºå‰ä¸€ä¸ªpromiseçš„çŠ¶æ€åˆ†åˆ«è°ƒç”¨ä¸åŒçš„å›è°ƒå‡½æ•°1234567getJSON("/post/1.json").then(function(post) &#123; return getJSON(post.commentURL);&#125;).then(function funcA(comments) &#123; console.log("resolved: ", comments);&#125;, function funcB(err)&#123; console.log("rejected: ", err);&#125;); p.catch Promise.prototype.catchæ–¹æ³•æ˜¯.then(null, rejection)çš„åˆ«åï¼Œç”¨äºæŒ‡å®šå‘ç”Ÿé”™è¯¯æ—¶çš„å›è°ƒå‡½æ•°ã€‚123456p.then((val) =&gt; console.log('fulfilled:', val)) .catch((err) =&gt; console.log('rejected', err));// ç­‰åŒäºp.then((val) =&gt; console.log('fulfilled:', val)) .then(null, (err) =&gt; console.log("rejected:", err)); p.all Promise.allæ–¹æ³•ç”¨äºå°†å¤šä¸ª Promise å®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ã€‚ å½“å¤šä¸ªpromiseéƒ½resolveäº†ï¼Œåˆ™è°ƒç”¨thençš„resolvFnï¼Œå¦åˆ™éƒ½è°ƒç”¨rejectFn1234567891011// promisesæ˜¯åŒ…å«6ä¸ª Promise å®ä¾‹çš„æ•°ç»„ï¼Œåªæœ‰è¿™6ä¸ªå®ä¾‹çš„çŠ¶æ€éƒ½å˜æˆfulfilledï¼Œæˆ–è€…å…¶ä¸­æœ‰ä¸€ä¸ªå˜ä¸ºrejectedï¼Œæ‰ä¼šè°ƒç”¨Promise.allæ–¹æ³•åé¢çš„å›è°ƒå‡½æ•°ã€‚// ç”Ÿæˆä¸€ä¸ªPromiseå¯¹è±¡çš„æ•°ç»„var promises = [2, 3, 5, 7, 11, 13].map(function (id) &#123; return getJSON('/post/' + id + ".json");&#125;);Promise.all(promises).then(function (posts) &#123; // ...&#125;).catch(function(reason)&#123; // ...&#125;); p.race Promise.raceæ–¹æ³•åŒæ ·æ˜¯å°†å¤šä¸ªPromiseå®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ï¼Œå“ªä¸ªpromiseçŠ¶æ€å…ˆæ”¹å˜ï¼Œåˆ™åé¢çš„å›è°ƒå°†æ ¹æ®å…¶çŠ¶æ€åšä¸åŒçš„è°ƒç”¨123456789101112var p = Promise.race([p1, p2, p3]);// åªè¦p1ã€p2ã€p3ä¹‹ä¸­æœ‰ä¸€ä¸ªå®ä¾‹ç‡å…ˆæ”¹å˜çŠ¶æ€ï¼Œpçš„çŠ¶æ€å°±è·Ÿç€æ”¹å˜ã€‚é‚£ä¸ªç‡å…ˆæ”¹å˜çš„ Promise å®ä¾‹çš„è¿”å›å€¼ï¼Œå°±ä¼ é€’ç»™pçš„å›è°ƒå‡½æ•°ã€‚const p = Promise.race([ fetch('/resource-that-may-take-a-while'), new Promise(function (resolve, reject) &#123; setTimeout(() =&gt; reject(new Error('request timeout')), 5000) &#125;)]);p.then(response =&gt; console.log(response));p.catch(error =&gt; console.log(error));// å¦‚æœ5ç§’ä¹‹å†…fetchæ–¹æ³•æ— æ³•è¿”å›ç»“æœï¼Œå˜é‡pçš„çŠ¶æ€å°±ä¼šå˜ä¸ºrejectedï¼Œä»è€Œè§¦å‘catchæ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•° Promise.resolve ç”¨æ¥å°†ä¸€ä¸ªå¯¹è±¡è½¬æ¢æˆES6çš„Promiseå¯¹è±¡ å‚æ•°æ˜¯ä¸€ä¸ªPromiseå®ä¾‹ï¼Œåˆ™ç›´æ¥è¿”å›è¿™ä¸ªPromiseå®ä¾‹ å‚æ•°æ˜¯ä¸€ä¸ªthenableå¯¹è±¡ï¼ŒPromise.resolveæ–¹æ³•ä¼šå°†è¿™ä¸ªå¯¹è±¡è½¬ä¸ºPromiseå¯¹è±¡ï¼Œç„¶åå°±ç«‹å³æ‰§è¡Œthenableå¯¹è±¡çš„thenæ–¹æ³• 12345678910let thenable = &#123; then: function(resolve, reject) &#123; resolve(42); &#125;&#125;;let p1 = Promise.resolve(thenable);p1.then(function(value) &#123; console.log(value); // 42&#125;); å‚æ•°ä¸æ˜¯å…·æœ‰thenæ–¹æ³•çš„å¯¹è±¡ï¼Œæˆ–æ ¹æœ¬å°±ä¸æ˜¯å¯¹è±¡ï¼Œåˆ™Promise.resolveæ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡ï¼ŒçŠ¶æ€ä¸ºresolved 123456var p = Promise.resolve('Hello');p.then(function (s)&#123; console.log(s)&#125;);// Hello ä¸å¸¦æœ‰ä»»ä½•å‚æ•°ï¼Œç›´æ¥è¿”å›ä¸€ä¸ªresolvedçŠ¶æ€çš„Promiseå¯¹è±¡ã€‚ 12345var p = Promise.resolve();p.then(function () &#123; // ...&#125;); Promise.reject() Promise.reject(reason)æ–¹æ³•ä¹Ÿä¼šè¿”å›ä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ï¼Œè¯¥å®ä¾‹çš„çŠ¶æ€ä¸ºrejectedã€‚12345678var p = Promise.reject('å‡ºé”™äº†');// ç­‰åŒäºvar p = new Promise((resolve, reject) =&gt; reject('å‡ºé”™äº†'))p.then(null, function (s) &#123; console.log(s)&#125;);// å‡ºé”™äº† Iterator å’Œ forâ€¦of å¾ªç¯Iterator éå†å™¨ï¼ˆIteratorï¼‰å®ƒæ˜¯ä¸€ç§æ¥å£ï¼Œä¸ºå„ç§ä¸åŒçš„æ•°æ®ç»“æ„æä¾›ç»Ÿä¸€çš„è®¿é—®æœºåˆ¶ï¼› é»˜è®¤çš„ Iterator æ¥å£éƒ¨ç½²åœ¨æ•°æ®ç»“æ„çš„Symbol.iteratorå±æ€§ï¼Œæˆ–è€…è¯´ï¼Œä¸€ä¸ªæ•°æ®ç»“æ„åªè¦å…·æœ‰Symbol.iteratorå±æ€§ï¼Œå°±å¯ä»¥è®¤ä¸ºæ˜¯â€œå¯éå†çš„â€ï¼ˆiterableï¼‰ 123456let arr = ['a', 'b', 'c'];let iter = arr[Symbol.iterator]();iter.next() // &#123; value: 'a', done: false &#125;iter.next() // &#123; value: 'b', done: false &#125;iter.next() // &#123; value: 'c', done: false &#125;iter.next() // &#123; value: undefined, done: true &#125;// doneè¡¨ç¤ºæœ¬æ¬¡éå†ç»“æŸ åŸç”Ÿå…·å¤‡ Iterator æ¥å£çš„æ•°æ®ç»“æ„å¦‚ä¸‹ï¼Œå¯¹äºåŸç”Ÿéƒ¨ç½² Iterator æ¥å£çš„æ•°æ®ç»“æ„ï¼Œä¸ç”¨è‡ªå·±å†™éå†å™¨ç”Ÿæˆå‡½æ•°ï¼ŒåŸç”Ÿçš„Objä¸å…·å¤‡éå†å™¨æ¥å£ Array Map Set String TypedArray å‡½æ•°çš„ arguments å¯¹è±¡ NodeList å¯¹è±¡ æŸäº›æƒ…å†µä¸‹ï¼Œä¼šé»˜è®¤è°ƒç”¨Iterator æ¥å£ è§£æ„èµ‹å€¼ æ‰©å±•è¿ç®—ç¬¦ yield* ä»»ä½•æ¥å—æ•°ç»„ä½œä¸ºå‚æ•°çš„åœºåˆï¼Œå…¶å®éƒ½è°ƒç”¨äº†éå†å™¨æ¥å£ forâ€¦of æ‰€æœ‰éƒ¨ç½²äº†Iteratoræ¥å£çš„æ•°æ®ç»“æ„ï¼Œéƒ½å¯ä»¥ä½¿ç”¨forâ€¦ofæ¥è¿›è¡Œéå† æ‰€æœ‰åŸç”Ÿå…·å¤‡Iteratoræ¥å£çš„éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨forâ€¦oféå† 123456789101112131415161718192021222324252627282930313233// æ•°ç»„const arr = ['red', 'green', 'blue'];for(let v of arr) &#123; console.log(v); // red green blue&#125;const obj = &#123;&#125;;obj[Symbol.iterator] = arr[Symbol.iterator].bind(arr);for(let v of obj) &#123; console.log(v); // red green blue&#125;// Setã€Mapvar engines = new Set(["Gecko", "Trident", "Webkit", "Webkit"]);for (var e of engines) &#123; console.log(e);&#125;// Gecko// Trident// Webkitvar es6 = new Map();es6.set("edition", 6);es6.set("committee", "TC39");es6.set("standard", "ECMA-262");for (var [name, value] of es6) &#123; console.log(name + ": " + value);&#125;// edition: 6// committee: TC39// standard: ECMA-262 æœ‰äº›æ•°æ®ç»“æ„æ˜¯åœ¨ç°æœ‰æ•°æ®ç»“æ„çš„åŸºç¡€ä¸Šï¼Œè®¡ç®—ç”Ÿæˆçš„ã€‚æ¯”å¦‚ï¼ŒES6çš„æ•°ç»„ã€Setã€Map éƒ½éƒ¨ç½²äº†keys()ã€values()ã€entriesæ–¹æ³•ï¼Œè°ƒç”¨åéƒ½è¿”å›éå†å™¨å¯¹è±¡ 1234567let arr = ['a', 'b', 'c'];for (let pair of arr.entries()) &#123; console.log(pair);&#125;// [0, 'a']// [1, 'b']// [2, 'c'] ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ 1234567891011121314151617181920212223// å­—ç¬¦ä¸²let str = "hello";for (let s of str) &#123; console.log(s); // h e l l o&#125;// DOM NodeListå¯¹è±¡let paras = document.querySelectorAll("p");for (let p of paras) &#123; p.classList.add("test");&#125;// argumentså¯¹è±¡function printArgs() &#123; for (let x of arguments) &#123; console.log(x); &#125;&#125;printArgs('a', 'b');// 'a'// 'b' å¯¹è±¡ä¸å¯ç›´æ¥ä½¿ç”¨forâ€¦oféå† 1234567891011121314151617let es6 = &#123; edition: 6, committee: "TC39", standard: "ECMA-262"&#125;;for (let e in es6) &#123; console.log(e);&#125;// edition// committee// standardfor (let e of es6) &#123; console.log(e);&#125;// TypeError: es6[Symbol.iterator] is not a function ä½¿ç”¨Object.keysæ–¹æ³•å°†å¯¹è±¡çš„é”®åç”Ÿæˆä¸€ä¸ªæ•°ç»„ï¼Œç„¶åéå†è¿™ä¸ªæ•°ç»„ã€‚123for (var key of Object.keys(someObject)) &#123; console.log(key + ': ' + someObject[key]);&#125; éå†è¯­æ³•çš„å¯¹æ¯” for ç¹ç123for (var index = 0; index &lt; myArray.length; index++) &#123; console.log(myArray[index]);&#125; forEachæ–¹æ³• æ— æ³•ä¸­é€”è·³å‡ºforEachå¾ªç¯ï¼Œbreakå‘½ä»¤æˆ–returnå‘½ä»¤éƒ½ä¸èƒ½å¥æ•ˆã€‚123myArray.forEach(function (value) &#123; console.log(value);&#125;); forâ€¦in forâ€¦inå¾ªç¯ä¸ä»…éå†æ•°å­—é”®åï¼Œè¿˜ä¼šéå†æ‰‹åŠ¨æ·»åŠ çš„å…¶ä»–é”®ï¼Œç”šè‡³åŒ…æ‹¬åŸå‹é“¾ä¸Šçš„é”® éå†é¡ºåºåœ¨æŸäº›æƒ…å†µä¸‹è¿˜ä¸å›ºå®š ä¸»è¦æ˜¯ä¸ºå¯¹è±¡éƒ¨ç½²çš„ forâ€¦of åªè¦éƒ¨ç½²äº†éå†æ¥å£çš„æ•°æ®ç»“æ„éƒ½å¯ä½¿ç”¨ ä¸åŒäºforEachæ–¹æ³•ï¼Œå®ƒå¯ä»¥ä¸breakã€continueå’Œreturné…åˆä½¿ç”¨ã€‚12345for (var n of fibonacci) &#123; if (n &gt; 1000) break; console.log(n);&#125; Generator å‡½æ•°çš„è¯­æ³•åŸºæœ¬æ¦‚å¿µ Generatorå‡½æ•°æ€»æ˜¯è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œé€šè¿‡è°ƒç”¨éå†å™¨å¯¹è±¡çš„next()æ–¹æ³•ï¼Œè®©å‡½æ•°ä¸€æ­¥ä¸€æ­¥çš„æ‰§è¡Œ è¯­æ³•å½¢å¼ 123456789101112131415161718function* helloWorldGenerator() &#123;// functionåè·Ÿä¸€ä¸ª* yield 'hello'; yield 'world'; return 'ending';&#125;var hw = helloWorldGenerator();// è¢«è°ƒç”¨æ—¶ï¼Œè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œå¯åœ¨éå†å™¨å¯¹è±¡ä¸Šè°ƒç”¨next()æ–¹æ³•hw.next() // æ¯æ¬¡è°ƒç”¨next()è¿”å›çš„å¯¹è±¡çš„valueå€¼éƒ½æ˜¯yieldåè¡¨è¾¾å¼å¯¹åº”çš„å€¼// &#123; value: 'hello', done: false &#125;hw.next() // æ¯æ¬¡è°ƒç”¨next()æ—¶ï¼Œä¼šå¯»æ‰¾ä¸‹ä¸€ä¸ªyieldè¡¨è¾¾å¼// &#123; value: 'world', done: false &#125;hw.next()// &#123; value: 'ending', done: true &#125;hw.next()// &#123; value: undefined, done: true &#125; yield è¡¨è¾¾å¼ yieldæ˜¯æš‚åœæ ‡å¿—ï¼Œè°ƒç”¨next()æ—¶ï¼Œé‡åˆ°yieldä¼šæš‚åœï¼Œå¹¶å°†åé¢è¡¨è¾¾å¼çš„å€¼è¿”å›ï¼Œä¸‹æ¬¡è°ƒç”¨next()æ—¶ä¼šæŒ‰é¡ºåºå¯»æ‰¾ä¸‹ä¸€ä¸ªyieldï¼›å¦‚æœæ˜¯æœ€åä¸€ä¸ªyieldï¼Œåˆ™ç»§ç»­æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°returnï¼Œå°†returnåé¢çš„å€¼åšä¸ºè¿”å›çš„å¯¹è±¡çš„valueå€¼ï¼Œå¦‚æœæ²¡æœ‰returnï¼Œåˆ™è¿”å›å¯¹è±¡çš„valueå€¼ä¸ºundefined yieldåé¢çš„è¡¨è¾¾å¼æ˜¯æƒ°æ€§æ±‚å€¼ 123function* gen() &#123; yield 123 + 456; // yieldåé¢çš„è¡¨è¾¾å¼123 + 456ï¼Œä¸ä¼šç«‹å³æ±‚å€¼ï¼Œåªä¼šåœ¨nextæ–¹æ³•å°†æŒ‡é’ˆç§»åˆ°è¿™ä¸€å¥æ—¶ï¼Œæ‰ä¼šæ±‚å€¼&#125; yieldè¡¨è¾¾å¼åªèƒ½ç”¨åœ¨ Generator å‡½æ•°é‡Œé¢ï¼Œç”¨åœ¨å…¶ä»–åœ°æ–¹éƒ½ä¼šæŠ¥é”™ã€‚ 1234(function ()&#123; yield 1;&#125;)()// SyntaxError: Unexpected number ä¸ Iterator æ¥å£çš„å…³ç³» ç”±äºGenerator å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥æŠŠ Generator èµ‹å€¼ç»™å¯¹è±¡çš„Symbol.iteratorå±æ€§ï¼Œä»è€Œä½¿å¾—è¯¥å¯¹è±¡å…·æœ‰ Iterator æ¥å£12345678var myIterable = &#123;&#125;;myIterable[Symbol.iterator] = function* () &#123; yield 1; yield 2; yield 3;&#125;;[...myIterable] // [1, 2, 3] nextæ–¹æ³•çš„å‚æ•° yieldè¡¨è¾¾å¼æœ¬èº«æ²¡æœ‰è¿”å›å€¼ï¼Œæˆ–è€…è¯´æ€»æ˜¯è¿”å›undefined nextæ–¹æ³•çš„å‚æ•°ä»£è¡¨ä¸Šä¸€ä¸ªyieldè¡¨è¾¾å¼è¿”å›çš„å€¼123456789101112function* f() &#123; for(var i = 0; true; i++) &#123; var reset = yield i; if(reset) &#123; i = -1; &#125; &#125;&#125;var g = f();g.next() // &#123; value: 0, done: false &#125;ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨nextï¼Œæ‰¾åˆ°yieldï¼Œæ­¤æ—¶iä¸º0ï¼Œæš‚åœåé¢çš„æ‰§è¡Œå¹¶è¿”å›0åšä¸ºè¿”å›å¯¹è±¡çš„valueå€¼g.next() // &#123; value: 1, done: false &#125;ï¼Œåœ¨ä¸Šä¸€æ¬¡yieldåç»§ç»­æ‰§è¡Œå¯»æ‰¾ä¸‹ä¸€ä¸ªyieldï¼Œç”±äºç¬¬ä¸€æ¬¡yieldé»˜è®¤è¿”å›undefinedï¼Œæ‰€ä»¥restä¸ºundefined,æ‰€ä»¥i=-1å¹¶æœªæ‰§è¡Œï¼Œè¿›å…¥ç¬¬äºŒè½®å¾ªç¯ï¼Œæ‰¾åˆ°yieldï¼Œæ­¤æ—¶iä¸º1ï¼Œæš‚åœåé¢çš„æ‰§è¡Œå¹¶è¿”å›1åšä¸ºè¿”å›å¯¹è±¡çš„valueå€¼g.next(true) // &#123; value: 0, done: false &#125;ï¼Œä¼ å…¥å‚æ•°trueï¼Œtrueè¢«å½“æˆä¸Šä¸€ä¸ªyieldè¡¨è¾¾å¼çš„è¿”å›å€¼ï¼Œæ‰€ä»¥restä¸ºtrueï¼Œè¿›è€Œi=-1è¢«æ‰§è¡Œï¼Œè¿›å…¥ç¬¬ä¸‰æ¬¡å¾ªç¯(æ­¤æ—¶iå·²ç»åŠ 1äº†ä¸º0)ï¼Œæ‰¾åˆ°yieldï¼Œæ­¤æ—¶iä¸º0ï¼Œæš‚åœåé¢çš„æ‰§è¡Œå¹¶è¿”å›0åšä¸ºè¿”å›å¯¹è±¡çš„valueå€¼ forâ€¦of forâ€¦ofå¾ªç¯å¯ä»¥è‡ªåŠ¨éå† Generator å‡½æ•°æ—¶ç”Ÿæˆçš„Iteratorå¯¹è±¡ï¼Œä¸”æ­¤æ—¶ä¸å†éœ€è¦è°ƒç”¨nextæ–¹æ³•12345678910111213function *foo() &#123; yield 1; yield 2; yield 3; yield 4; yield 5; return 6;&#125;for (let v of foo()) &#123; console.log(v);&#125;// 1 2 3 4 5ï¼Œä¸ä¼šè¿”å›returnåçš„å€¼ï¼Œæ‰€ä»¥for...ofåªä¼šæŒ‰é¡ºåºè¿”å›yieldåçš„å€¼ Generator.prototype.throw()ã€Generator.prototype.return() throwç”¨æ¥æŠ›å‡ºé”™è¯¯ returnå¯ä»¥è¿”å›ç»™å®šçš„å€¼ï¼Œå¹¶ä¸”ç»ˆç»“éå† Generator å‡½æ•° åœ¨Generatorå‡½æ•°å†…è°ƒç”¨å¦å¤–ä¸€ä¸ªGeneratorå‡½æ•° ä½¿ç”¨yield*è¡¨è¾¾å¼12345678910111213141516171819202122232425function* inner() &#123; yield 'hello!';&#125;function* outer1() &#123; yield 'open'; yield inner(); yield 'close';&#125;var gen = outer1()gen.next().value // "open"gen.next().value // è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡gen.next().value // "close"function* outer2() &#123; yield 'open' yield* inner() yield 'close'&#125;var gen = outer2()gen.next().value // "open"gen.next().value // "hello!"gen.next().value // "close" ä½œä¸ºå¯¹è±¡å±æ€§çš„Generatorå‡½æ•°å¯ä»¥é‡‡ç”¨ç®€å†™å½¢å¼ 123456789101112let obj = &#123; myGeneratorMethod: function* () &#123; // Â·Â·Â· &#125;&#125;;// ç®€å†™å½¢å¼let obj = &#123; * myGeneratorMethod() &#123; Â·Â·Â· &#125;&#125;; åº”ç”¨ å¼‚æ­¥æ“ä½œçš„åŒæ­¥åŒ–è¡¨è¾¾ 1234567891011121314function* main() &#123; var result = yield request("http://some.url");// 1.æ­¤å¤„è¢«æš‚åœï¼Œè¿›è¡Œrequestå¼‚æ­¥è¯·æ±‚ var resp = JSON.parse(result);// å¯¹2å¤„å¼‚æ­¥è¯·æ±‚çš„è¿”å›å€¼åšç›¸åº”å¤„ç† console.log(resp.value);&#125;function request(url) &#123; makeAjaxCall(url, function(response)&#123;// å¼‚æ­¥è¯·æ±‚æˆåŠŸ it.next(response);// 2.æ‰‹åŠ¨è°ƒç”¨nextï¼Œå¹¶å°†å¼‚æ­¥è¯·æ±‚çš„è¿”å›å€¼åšä¸ºä¸Šä¸€æ¬¡yieldè¡¨è¾¾å¼çš„å€¼ &#125;);&#125;var it = main();// è¿”å›éå†å™¨å¯¹è±¡it.next();// æ‰§è¡Œnextï¼Œå¯»æ‰¾ç¬¬ä¸€ä¸ªyield æ§åˆ¶æµç®¡ç† 123456789101112131415161718192021222324252627282930313233343536373839404142434445step1(function (value1) &#123; step2(value1, function(value2) &#123; step3(value2, function(value3) &#123; step4(value3, function(value4) &#123; // Do something with value4 &#125;); &#125;); &#125;);&#125;);// promiseæ”¹å†™Promise.resolve(step1) .then(step2) .then(step3) .then(step4) .then(function (value4) &#123; // Do something with value4 &#125;, function (error) &#123; // Handle any error from step1 through step4 &#125;) .done();// generatoræ”¹å†™function* longRunningTask(value1) &#123; try &#123; var value2 = yield step1(value1); var value3 = yield step2(value2); var value4 = yield step3(value3); var value5 = yield step4(value4); // Do something with value4 &#125; catch (e) &#123; // Handle any error from step1 through step4 &#125;&#125;scheduler(longRunningTask(initialValue));function scheduler(task) &#123; var taskObj = task.next(task.value); // å¦‚æœGeneratorå‡½æ•°æœªç»“æŸï¼Œå°±ç»§ç»­è°ƒç”¨ if (!taskObj.done) &#123; task.value = taskObj.value scheduler(task); &#125;&#125; éƒ¨ç½² Iterator æ¥å£ åŸç”Ÿobjä¸Šå› ä¸ºæ²¡æœ‰Iterator æ¥å£æ— æ³•ä½¿ç”¨forâ€¦ofï¼Œå¯ä»¥åˆ©ç”¨Generator å‡½æ•°ï¼Œå¯ä»¥åœ¨ä»»æ„å¯¹è±¡ä¸Šéƒ¨ç½² Iterator æ¥å£ã€‚12345678910111213141516function* iterEntries(obj) &#123; let keys = Object.keys(obj); for (let i=0; i &lt; keys.length; i++) &#123; let key = keys[i]; yield [key, obj[key]]; &#125;&#125;let myObj = &#123; foo: 3, bar: 7 &#125;;for (let [key, value] of iterEntries(myObj)) &#123; console.log(key, value);&#125;// foo 3// bar 7 ä½œä¸ºæ•°æ®ç»“æ„ Generator å¯ä»¥çœ‹ä½œæ˜¯æ•°æ®ç»“æ„ï¼Œæ›´ç¡®åˆ‡åœ°è¯´ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæ•°ç»„ç»“æ„ï¼Œå› ä¸º Generator å‡½æ•°å¯ä»¥è¿”å›ä¸€ç³»åˆ—çš„å€¼ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥å¯¹ä»»æ„è¡¨è¾¾å¼ï¼Œæä¾›ç±»ä¼¼æ•°ç»„çš„æ¥å£ã€‚123456789function *doStuff() &#123; yield fs.readFile.bind(null, 'hello.txt'); yield fs.readFile.bind(null, 'world.txt'); yield fs.readFile.bind(null, 'and-such.txt');&#125;for (task of doStuff()) &#123; // taskæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥åƒå›è°ƒå‡½æ•°é‚£æ ·ä½¿ç”¨å®ƒ&#125; Generator å‡½æ•°çš„å¼‚æ­¥åº”ç”¨ä¼ ç»Ÿæ–¹æ³•å®Œæˆå¼‚æ­¥ å›è°ƒ å®¹æ˜“å‡ºç°callback hell12345fs.readFile(fileA, 'utf-8', function (err, data) &#123; fs.readFile(fileB, 'utf-8', function (err, data) &#123; // ... &#125;);&#125;); Promise å…è®¸å°†å›è°ƒå‡½æ•°çš„åµŒå¥—ï¼Œæ”¹æˆé“¾å¼è°ƒç”¨ 123456789101112131415var readFile = require('fs-readfile-promise');readFile(fileA).then(function (data) &#123; console.log(data.toString());&#125;).then(function () &#123; return readFile(fileB);&#125;).then(function (data) &#123; console.log(data.toString());&#125;).catch(function (err) &#123; console.log(err);&#125;); Promise çš„æœ€å¤§é—®é¢˜æ˜¯ä»£ç å†—ä½™ï¼ŒåŸæ¥çš„ä»»åŠ¡è¢« Promise åŒ…è£…äº†ä¸€ä¸‹ï¼Œä¸ç®¡ä»€ä¹ˆæ“ä½œï¼Œä¸€çœ¼çœ‹å»éƒ½æ˜¯ä¸€å †thenï¼ŒåŸæ¥çš„è¯­ä¹‰å˜å¾—å¾ˆä¸æ¸…æ¥š Generator å‡½æ•°å®Œæˆå¼‚æ­¥ä»»åŠ¡ åˆ©ç”¨Generatorä¸­çš„yieldæš‚åœå‡½æ•°çš„æ‰§è¡Œï¼Œç­‰åˆ°æ¢å¤åï¼Œç»§ç»­ä»æ­¤å¤„æ‰§è¡Œï¼› é‡åˆ°yieldå‘½ä»¤å°±æš‚åœï¼Œç­‰åˆ°æ‰§è¡Œæƒè¿”å›ï¼Œå†ä»æš‚åœçš„åœ°æ–¹ç»§ç»­å¾€åæ‰§è¡Œã€‚å®ƒçš„æœ€å¤§ä¼˜ç‚¹ï¼Œå°±æ˜¯ä»£ç çš„å†™æ³•éå¸¸åƒåŒæ­¥æ“ä½œï¼Œå¦‚æœå»é™¤yieldå‘½ä»¤ï¼Œç®€ç›´ä¸€æ¨¡ä¸€æ · æ•´ä¸ª Generator å‡½æ•°å°±æ˜¯ä¸€ä¸ªå°è£…çš„å¼‚æ­¥ä»»åŠ¡ï¼Œæˆ–è€…è¯´æ˜¯å¼‚æ­¥ä»»åŠ¡çš„å®¹å™¨ã€‚å¼‚æ­¥æ“ä½œéœ€è¦æš‚åœçš„åœ°æ–¹ï¼Œéƒ½ç”¨yieldè¯­å¥æ³¨æ˜ã€‚ é€šè¿‡nextæ–¹æ³•æ¥æ”¶å‚æ•°ï¼Œå‘Generatorå‡½æ•°ä½“å†…è¾“å…¥æ•°æ®ã€‚12345678910111213141516var fetch = require('node-fetch');function* gen()&#123; var url = 'https://api.github.com/users/github'; var result = yield fetch(url);// è¿”å›çš„ç»“æœä¿å­˜åœ¨resultä¸­ console.log(result.bio);&#125;var g = gen();var result = g.next();// å¾—åˆ°å¼‚æ­¥è¯»å–çš„ç»“æœresult.value.then(function(data)&#123;// Fetchæ¨¡å—è¿”å›çš„æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œå› æ­¤è¦ç”¨thenæ–¹æ³•è°ƒç”¨ä¸‹ä¸€ä¸ªnextæ–¹æ³•ã€‚ return data.json();// è½¬æ¢ä¸ºjson&#125;).then(function(data)&#123; g.next(data);// ä¼ å…¥Generatorå‡½æ•°&#125;); async å‡½æ•°asyncå‡½æ•°æ˜¯Generatorå‡½æ•°çš„è¯­æ³•ç³–12345678910111213141516171819202122232425const fs = require('fs');const readFile = function (fileName) &#123; return new Promise(function (resolve, reject) &#123; fs.readFile(fileName, function(error, data) &#123; if (error) return reject(error); resolve(data); &#125;); &#125;);&#125;;const gen = function* () &#123; const f1 = yield readFile('/etc/fstab'); const f2 = yield readFile('/etc/shells'); console.log(f1.toString()); console.log(f2.toString());&#125;;// ä½¿ç”¨asyncæ”¹å†™const asyncReadFile = async function () &#123; const f1 = await readFile('/etc/fstab'); const f2 = await readFile('/etc/shells'); console.log(f1.toString()); console.log(f2.toString());&#125;; æ”¹è¿› å†…ç½®æ‰§è¡Œå™¨ Generatorå¿…é¡»æ‰‹åŠ¨ä¸€æ­¥ä¸€æ­¥çš„è°ƒç”¨next()æ–¹æ³•æˆ–è€…æ˜¯ç”¨ç¬¬ä¸‰æ–¹çš„æ‰§è¡Œå™¨è‡ªåŠ¨æ‰§è¡Œï¼Œè€Œasyncå‡½æ•°å†…éƒ¨äº†æ‰§è¡Œå™¨ï¼Œèƒ½è‡ªåŠ¨æ‰§è¡Œ æ›´å¥½çš„è¯­ä¹‰ æ›´å¹¿çš„é€‚ç”¨æ€§ å¦‚æœä½¿ç”¨ç¬¬ä¸‰æ”¾çš„æ‰§è¡Œå™¨ï¼Œä¾‹å¦‚coåˆ™yieldååªèƒ½æ˜¯Thunk å‡½æ•°æˆ– Promise å¯¹è±¡ï¼Œè€Œasyncå‡½æ•°å†…çš„awaitå‘½ä»¤åé¢ï¼Œå¯ä»¥æ˜¯Promise å¯¹è±¡å’ŒåŸå§‹ç±»å‹çš„å€¼ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²å’Œå¸ƒå°”å€¼ï¼Œä½†è¿™æ—¶ç­‰åŒäºåŒæ­¥æ“ä½œï¼‰ asyncè¿”å›å€¼æ˜¯Promiseï¼Œè¿™æ¯” Generator å‡½æ•°çš„è¿”å›å€¼æ˜¯ Iterator å¯¹è±¡æ–¹ä¾¿å¤šäº†ã€‚ä½ å¯ä»¥ç”¨thenæ–¹æ³•æŒ‡å®šä¸‹ä¸€æ­¥çš„æ“ä½œ asyncå‡½æ•°å®Œå…¨å¯ä»¥çœ‹ä½œå¤šä¸ªå¼‚æ­¥æ“ä½œï¼ŒåŒ…è£…æˆçš„ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè€Œawaitå‘½ä»¤å°±æ˜¯å†…éƒ¨thenå‘½ä»¤çš„è¯­æ³•ç³– åŸºæœ¬ç”¨æ³• asyncå‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨thenæ–¹æ³•æ·»åŠ å›è°ƒå‡½æ•°ã€‚å½“å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€æ—¦é‡åˆ°awaitå°±ä¼šå…ˆè¿”å›ï¼Œç­‰åˆ°å¼‚æ­¥æ“ä½œå®Œæˆï¼Œå†æ¥ç€æ‰§è¡Œå‡½æ•°ä½“å†…åé¢çš„è¯­å¥ 123456789async function getStockPriceByName(name) &#123; const symbol = await getStockSymbol(name);// ç­‰å¾…getStockSymbolå¼‚æ­¥å®Œæˆï¼Œå†æ‰§è¡Œä¸‹é¢çš„ const stockPrice = await getStockPrice(symbol); return stockPrice;&#125;getStockPriceByName('goog').then(function (result) &#123;// getStockPriceByNameæ˜¯ä¸€ä¸ªasyncå‡½æ•°ï¼Œæ‰€ä»¥è¿”å›çš„æ˜¯Promiseï¼Œå¯ä»¥ä½¿ç”¨then console.log(result);&#125;); async å‡½æ•°æœ‰å¤šç§ä½¿ç”¨å½¢å¼ 123456789101112131415161718192021222324252627// å‡½æ•°å£°æ˜async function foo() &#123;&#125;// å‡½æ•°è¡¨è¾¾å¼const foo = async function () &#123;&#125;;// å¯¹è±¡çš„æ–¹æ³•let obj = &#123; async foo() &#123;&#125; &#125;;obj.foo().then(...)// Class çš„æ–¹æ³•class Storage &#123; constructor() &#123; this.cachePromise = caches.open('avatars'); &#125; async getAvatar(name) &#123; const cache = await this.cachePromise; return cache.match(`/avatars/$&#123;name&#125;.jpg`); &#125;&#125;const storage = new Storage();storage.getAvatar('jake').then(â€¦);// ç®­å¤´å‡½æ•°const foo = async () =&gt; &#123;&#125;; è¯­æ³• asyncå‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚asyncå‡½æ•°å†…éƒ¨returnè¯­å¥è¿”å›çš„å€¼ï¼Œä¼šæˆä¸ºthenæ–¹æ³•å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚ 123456async function f() &#123;// æ•´ä½“è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ return 'hello world';// å†…éƒ¨çš„returnè¿”å›çš„å€¼å°†å½“åšthenæ–¹æ³•å›è°ƒçš„å‚æ•°&#125;f().then(v =&gt; console.log(v))// 'heollo world'ä¼ é€’ç»™äº†v// "hello world" æ­£å¸¸æƒ…å†µä¸‹ï¼Œawaitå‘½ä»¤åé¢æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ã€‚å¦‚æœä¸æ˜¯ï¼Œä¼šè¢«è½¬æˆä¸€ä¸ªç«‹å³resolveçš„ Promise å¯¹è±¡ 123456async function f() &#123; return await 123;// 123ä¼šè¢«è½¬æ¢æˆPromiseå¯¹è±¡ï¼Œå¹¶ç«‹å³resolved&#125;f().then(v =&gt; console.log(v))// 123 asyncå‡½æ•°è¿”å›çš„ Promise å¯¹è±¡ï¼Œå¿…é¡»ç­‰åˆ°å†…éƒ¨æ‰€æœ‰awaitå‘½ä»¤åé¢çš„ Promise å¯¹è±¡æ‰§è¡Œå®Œï¼Œæ‰ä¼šå‘ç”ŸçŠ¶æ€æ”¹å˜ï¼Œé™¤éé‡åˆ°returnè¯­å¥æˆ–è€…æŠ›å‡ºé”™è¯¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰asyncå‡½æ•°å†…éƒ¨çš„å¼‚æ­¥æ“ä½œæ‰§è¡Œå®Œï¼Œæ‰ä¼šæ‰§è¡Œthenæ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•° 1234567async function getTitle(url) &#123;// æ‰€æœ‰awaitå‘½ä»¤éƒ½æ‰§è¡Œå®Œæˆï¼Œæ‰ä¼šæ‰§è¡Œthençš„å›è°ƒ let response = await fetch(url); let html = await response.text(); return html.match(/&lt;title&gt;([\s\S]+)&lt;\/title&gt;/i)[1];&#125;getTitle('https://tc39.github.io/ecma262/').then(console.log)// "ECMAScript 2017 Language Specification" æ³¨æ„ç‚¹ asyncå‡½æ•°å†…éƒ¨æŠ›å‡ºé”™è¯¯ï¼Œä¼šå¯¼è‡´è¿”å›çš„ Promise å¯¹è±¡å˜ä¸ºrejectçŠ¶æ€ã€‚æŠ›å‡ºçš„é”™è¯¯å¯¹è±¡ä¼šè¢«catchæ–¹æ³•å›è°ƒå‡½æ•°æ¥æ”¶åˆ° 123456789async function f() &#123; throw new Error('å‡ºé”™äº†');&#125;f().then( v =&gt; console.log(v), e =&gt; console.log(e))// Error: å‡ºé”™äº† awaitå‘½ä»¤åé¢çš„ Promise å¯¹è±¡å¦‚æœå˜ä¸ºrejectçŠ¶æ€ï¼Œåˆ™rejectçš„å‚æ•°ä¼šè¢«catchæ–¹æ³•çš„å›è°ƒå‡½æ•°æ¥æ”¶åˆ°ã€‚ 12345678async function f() &#123; await Promise.reject('å‡ºé”™äº†');&#125;f().then(v =&gt; console.log(v)).catch(e =&gt; console.log(e))// å‡ºé”™äº† åªè¦ä¸€ä¸ªawaitè¯­å¥åé¢çš„ Promise å˜ä¸ºrejectï¼Œé‚£ä¹ˆæ•´ä¸ªasyncå‡½æ•°éƒ½ä¼šä¸­æ–­æ‰§è¡Œ 1234async function f() &#123; await Promise.reject('å‡ºé”™äº†'); await Promise.resolve('hello world'); // ä¸ä¼šæ‰§è¡Œ&#125; å‰ä¸€ä¸ªå¼‚æ­¥æ“ä½œå¤±è´¥ï¼Œä¹Ÿä¸è¦ä¸­æ–­åé¢çš„å¼‚æ­¥æ“ä½œï¼Œå¯ä»¥å°†ç¬¬ä¸€ä¸ªawaitæ”¾åœ¨tryâ€¦catchç»“æ„é‡Œé¢ï¼Œè¿™æ ·ä¸ç®¡è¿™ä¸ªå¼‚æ­¥æ“ä½œæ˜¯å¦æˆåŠŸï¼Œç¬¬äºŒä¸ªawaitéƒ½ä¼šæ‰§è¡Œã€‚æˆ–è€…awaitåé¢çš„ Promise å¯¹è±¡å†è·Ÿä¸€ä¸ªcatchæ–¹æ³•ï¼Œå¤„ç†å‰é¢å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚ 123456789101112131415161718192021async function f() &#123; try &#123; await Promise.reject('å‡ºé”™äº†'); &#125; catch(e) &#123; &#125; return await Promise.resolve('hello world');&#125;f().then(v =&gt; console.log(v))// hello world// awaitåé¢çš„ Promise å¯¹è±¡å†è·Ÿä¸€ä¸ªcatchæ–¹æ³•ï¼Œå¤„ç†å‰é¢å¯èƒ½å‡ºç°çš„é”™è¯¯async function f() &#123; await Promise.reject('å‡ºé”™äº†') .catch(e =&gt; console.log(e)); return await Promise.resolve('hello world');&#125;f().then(v =&gt; console.log(v))// å‡ºé”™äº†// hello world å¤šä¸ªawaitå‘½ä»¤åé¢çš„å¼‚æ­¥æ“ä½œï¼Œå¦‚æœä¸å­˜åœ¨ç»§å‘å…³(ä¾èµ–)ç³»ï¼Œæœ€å¥½è®©å®ƒä»¬åŒæ—¶è§¦å‘ã€‚ 123456// getBarã€getFooè¿™ä¸¤ä¸ªå¼‚æ­¥è¯·æ±‚å¹¶æ— ä¾èµ–å…³ç³»ï¼Œä½†è¿™ç§å†™æ³•getBarå¿…é¡»åœ¨getFooå®Œæˆåå†è¯·æ±‚let foo = await getFoo();let bar = await getBar();// ä½¿ç”¨Promise.alllet [foo, bar] = await Promise.all([getFoo(), getBar()]);// äºŒè€…å¯ä»¥åŒæ—¶è¯·æ±‚ awaitå‘½ä»¤åªèƒ½ç”¨åœ¨asyncå‡½æ•°ä¹‹ä¸­ï¼Œå¦‚æœç”¨åœ¨æ™®é€šå‡½æ•°ï¼Œå°±ä¼šæŠ¥é”™ 12345678async function dbFuc(db) &#123; let docs = [&#123;&#125;, &#123;&#125;, &#123;&#125;]; // æŠ¥é”™ docs.forEach(function (doc) &#123;// forEachå‚æ•°ä¸ºæ™®é€šå‡½æ•°ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨await await db.post(doc); &#125;);&#125; å®ä¾‹:æŒ‰é¡ºåºå®Œæˆå¼‚æ­¥æ“ä½œ Promise çš„å†™æ³•å¦‚ä¸‹ 12345678910111213// ä½¿ç”¨fetchæ–¹æ³•ï¼ŒåŒæ—¶è¿œç¨‹è¯»å–ä¸€ç»„ URLã€‚æ¯ä¸ªfetchæ“ä½œéƒ½è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œæ”¾å…¥textPromisesæ•°ç»„ã€‚ç„¶åï¼Œreduceæ–¹æ³•ä¾æ¬¡å¤„ç†æ¯ä¸ª Promise å¯¹è±¡ï¼Œç„¶åä½¿ç”¨thenï¼Œå°†æ‰€æœ‰ Promise å¯¹è±¡è¿èµ·æ¥ï¼Œå› æ­¤å°±å¯ä»¥ä¾æ¬¡è¾“å‡ºç»“æœfunction logInOrder(urls) &#123; // è¿œç¨‹è¯»å–æ‰€æœ‰URL const textPromises = urls.map(url =&gt; &#123; return fetch(url).then(response =&gt; response.text()); &#125;); // æŒ‰æ¬¡åºè¾“å‡º textPromises.reduce((chain, textPromise) =&gt; &#123; return chain.then(() =&gt; textPromise) .then(text =&gt; console.log(text)); &#125;, Promise.resolve());&#125; asyncå†™æ³• 1234567891011121314151617181920async function logInOrder(urls) &#123; for (const url of urls) &#123; const response = await fetch(url); console.log(await response.text()); &#125;&#125;// ä¸Šé¢çš„ä»£ç ï¼Œä¸‹ä¸€ä¸ªè¯·æ±‚å¿…é¡»åœ¨ä¸Šä¸€ä¸ªè¯·æ±‚å®Œæˆåå†è¯·æ±‚ï¼Œè€Œè¯·æ±‚ä¹‹é—´æ— ä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥å¯ä»¥åŒæ—¶è¯·æ±‚ï¼Œä¼˜åŒ–å¦‚ä¸‹async function logInOrder(urls) &#123; // å¹¶å‘è¯»å–è¿œç¨‹URL const textPromises = urls.map(async url =&gt; &#123; const response = await fetch(url); return response.text(); &#125;); // æŒ‰æ¬¡åºè¾“å‡º for (const textPromise of textPromises) &#123; console.log(await textPromise); &#125;&#125;// ä¸Šé¢ä»£ç ä¸­ï¼Œè™½ç„¶mapæ–¹æ³•çš„å‚æ•°æ˜¯asyncå‡½æ•°ï¼Œä½†å®ƒæ˜¯å¹¶å‘æ‰§è¡Œçš„ï¼Œå› ä¸ºåªæœ‰asyncå‡½æ•°å†…éƒ¨æ˜¯ç»§å‘æ‰§è¡Œï¼Œå¤–éƒ¨ä¸å—å½±å“ã€‚åé¢çš„for..ofå¾ªç¯å†…éƒ¨ä½¿ç”¨äº†awaitï¼Œå› æ­¤å®ç°äº†æŒ‰é¡ºåºè¾“å‡ºã€‚ å¼‚æ­¥éå†å™¨ ç±»ä¼¼åŒæ­¥éå†å™¨ï¼Œä¸è¿‡å®ƒè°ƒç”¨next()æ–¹æ³•åè¿”å›çš„æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨thenæ–¹æ³• 12345asyncIterator .next() .then( (&#123; value, done &#125;) =&gt; /* ... */ ); å¼‚æ­¥éå†å™¨æ¥å£è¿”å›çš„æ˜¯ä¸€ä¸ªå¼‚æ­¥éå†å™¨ï¼Œå¯ä»¥ä½¿ç”¨for await...ofæ¥éå† 1234567async function f() &#123; for await (const x of createAsyncIterable(['a', 'b'])) &#123; console.log(x); &#125;&#125;// a// b å¼‚æ­¥ Generator å‡½æ•° Generator å‡½æ•°è¿”å›ä¸€ä¸ªåŒæ­¥éå†å™¨å¯¹è±¡ä¸€æ ·ï¼Œå¼‚æ­¥ Generator å‡½æ•°çš„ä½œç”¨ï¼Œæ˜¯è¿”å›ä¸€ä¸ªå¼‚æ­¥éå†å™¨å¯¹è±¡ã€‚ è¯­æ³•ä¸Šï¼Œå¼‚æ­¥ Generator å‡½æ•°å°±æ˜¯asyncå‡½æ•°ä¸ Generator å‡½æ•°çš„ç»“åˆ 123456789101112131415161718192021222324252627// genæ˜¯ä¸€ä¸ªå¼‚æ­¥ Generator å‡½æ•°ï¼Œæ‰§è¡Œåè¿”å›ä¸€ä¸ªå¼‚æ­¥ Iterator å¯¹è±¡ã€‚å¯¹è¯¥å¯¹è±¡è°ƒç”¨nextæ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡async function* gen() &#123; yield 'hello';&#125;const genObj = gen();genObj.next().then(x =&gt; console.log(x));// &#123; value: 'hello', done: false &#125;// åŒæ­¥ Generator å‡½æ•°function* map(iterable, func) &#123; const iter = iterable[Symbol.iterator](); while (true) &#123; const &#123;value, done&#125; = iter.next(); if (done) break; yield func(value); &#125;&#125;// å¼‚æ­¥ Generator å‡½æ•°async function* map(iterable, func) &#123; const iter = iterable[Symbol.asyncIterator](); while (true) &#123; const &#123;value, done&#125; = await iter.next(); if (done) break; yield func(value); &#125;&#125; å¼‚æ­¥ Generator å‡½æ•°å‡ºç°ä»¥åï¼ŒJavaScript å°±æœ‰äº†å››ç§å‡½æ•°å½¢å¼ï¼šæ™®é€šå‡½æ•°ã€async å‡½æ•°ã€Generator å‡½æ•°å’Œå¼‚æ­¥ Generator å‡½æ•°ã€‚è¯·æ³¨æ„åŒºåˆ†æ¯ç§å‡½æ•°çš„ä¸åŒä¹‹å¤„ã€‚åŸºæœ¬ä¸Šï¼Œå¦‚æœæ˜¯ä¸€ç³»åˆ—æŒ‰ç…§é¡ºåºæ‰§è¡Œçš„å¼‚æ­¥æ“ä½œï¼ˆæ¯”å¦‚è¯»å–æ–‡ä»¶ï¼Œç„¶åå†™å…¥æ–°å†…å®¹ï¼Œå†å­˜å…¥ç¡¬ç›˜ï¼‰å­˜åœ¨æ˜æ˜¾çš„å…ˆåé¡ºåºæ‰èƒ½å¾—åˆ°æ­£ç¡®ç»“æœæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ async å‡½æ•°ï¼›å¦‚æœæ˜¯ä¸€ç³»åˆ—äº§ç”Ÿç›¸åŒæ•°æ®ç»“æ„çš„å¼‚æ­¥æ“ä½œï¼ˆæ¯”å¦‚ä¸€è¡Œä¸€è¡Œè¯»å–æ–‡ä»¶ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨å¼‚æ­¥ Generator å‡½æ•° Classçš„åŸºæœ¬è¯­æ³•Class ES6çš„class(ç±»)å¯ä»¥çœ‹åšæ˜¯ES5ä¸­ç±»å†™æ³•çš„ä¸€ä¸ªè¯­æ³•ç³– 12345678910111213141516171819202122232425//ES5function Point(x, y) &#123; this.x = x; this.y = y;&#125;Point.prototype.toString = function () &#123; return '(' + this.x + ', ' + this.y + ')';&#125;;var p = new Point(1, 2);//ES6class Point &#123; constructor(x, y) &#123;// ä½¿ç”¨newæ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³• this.x = x; this.y = y; &#125; toString() &#123;// toStringå®é™…æ˜¯å®šä¹‰åœ¨åŸå‹å¯¹è±¡ä¸Šçš„ï¼Œæ‰€ä»¥æ‰€æœ‰å®ä¾‹å¯¹è±¡éƒ½å¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³• return '(' + this.x + ', ' + this.y + ')'; &#125;&#125;var p=new Point(1,2); ç±»çš„æ‰€æœ‰æ–¹æ³•éƒ½å®šä¹‰åœ¨ç±»çš„prototypeå±æ€§ä¸Šé¢ï¼Œæ‰€ä»¥æ‰€æœ‰å®ä¾‹å¯¹è±¡éƒ½å¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³• 123456789101112131415161718192021class Point &#123; constructor() &#123; // ... &#125; toString() &#123; // ... &#125; toValue() &#123; // ... &#125;&#125;// ç­‰åŒäºPoint.prototype = &#123; constructor() &#123;&#125;, toString() &#123;&#125;, toValue() &#123;&#125;,&#125;; ç±»çš„å†…éƒ¨æ‰€æœ‰å®šä¹‰çš„æ–¹æ³•ï¼Œéƒ½æ˜¯ä¸å¯æšä¸¾çš„ï¼ˆnon-enumerableï¼‰ 1234567891011121314151617181920212223242526272829// ES6class Point &#123; constructor(x, y) &#123; // ... &#125; toString() &#123; // ... &#125;&#125;Object.keys(Point.prototype)// []Object.getOwnPropertyNames(Point.prototype)// ["constructor","toString"]//ES5å†™æ³•ä¸­ï¼Œæ–¹æ³•æ˜¯å¯æšä¸¾çš„var Point = function (x, y) &#123; // ...&#125;;Point.prototype.toString = function() &#123; // ...&#125;;Object.keys(Point.prototype)// ["toString"]Object.getOwnPropertyNames(Point.prototype)// ["constructor","toString"] ç±»å†…ï¼Œé»˜è®¤é‡‡ç”¨ä¸¥æ ¼æ¨¡å¼ ä¸å‡½æ•°ä¸€æ ·ï¼Œç±»ä¹Ÿå¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼çš„å½¢å¼å®šä¹‰ã€‚123456789101112const MyClass = class Me &#123; getClassName() &#123; return Me.name; &#125;&#125;;let inst = new MyClass();inst.getClassName() // MeMe.name // ReferenceError: Me is not defined// å¦‚æœç±»çš„å†…éƒ¨æ²¡ç”¨åˆ°çš„è¯ï¼Œå¯ä»¥çœç•¥Meï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼const MyClass = class &#123; /* ... */ &#125;; constructoræ–¹æ³• ç±»ä¸­çš„constructoræ–¹æ³•æ˜¯ç±»çš„é»˜è®¤æ–¹æ³•ï¼Œé€šè¿‡newå‘½ä»¤ç”Ÿæˆå¯¹è±¡å®ä¾‹æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ï¼›ä¸€ä¸ªç±»å¿…é¡»æœ‰constructoræ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼å®šä¹‰ï¼Œä¸€ä¸ªç©ºçš„constructoræ–¹æ³•ä¼šè¢«é»˜è®¤æ·»åŠ ï¼›constructoræ–¹æ³•é»˜è®¤è¿”å›çš„å®ä¾‹å¯¹è±¡ 12345678// æ²¡æœ‰æ˜¾ç¤ºæ·»åŠ constructoræ–¹æ³•ï¼Œä¼šé»˜è®¤æ·»åŠ class Point &#123;&#125;// ç­‰åŒäºclass Point &#123; constructor() &#123;&#125;&#125; ç±»å¿…é¡»ä½¿ç”¨newè°ƒç”¨ï¼Œå¦åˆ™ä¼šå‡ºé”™ 12class B&#123;&#125;B();// error ä¸å­˜åœ¨å˜é‡æå‡ ç±»ä¸å­˜åœ¨å˜é‡æå‡ï¼ˆhoistï¼‰ï¼Œè¿™ä¸€ç‚¹ä¸ ES5 å®Œå…¨ä¸åŒã€‚12new Foo(); // ReferenceErrorclass Foo &#123;&#125; ç§æœ‰å±æ€§ã€æ–¹æ³• ES6æš‚ä¸æä¾›ç§æœ‰å±æ€§ã€æ–¹æ³•ï¼Œä¸è¿‡å¯ä»¥æ¨¡æ‹Ÿ123456789101112131415161718192021// ç§æœ‰æ–¹æ³•class Widget &#123; foo (baz) &#123; bar.call(this, baz); &#125; // ...&#125;function bar(baz) &#123; return this.snaf = baz;&#125;// ç§æœ‰å±æ€§ï¼Œæ–°ææ¡ˆä½¿ç”¨#æ ‡è¯†class Point &#123; #x; constructor(x = 0) &#123; #x = +x; // å†™æˆ this.#x äº¦å¯ &#125;&#125; this ç±»çš„æ–¹æ³•å†…éƒ¨å¦‚æœå«æœ‰thisï¼Œå®ƒé»˜è®¤æŒ‡å‘ç±»çš„å®ä¾‹ã€‚ä½†æ˜¯ï¼Œå¿…é¡»éå¸¸å°å¿ƒï¼Œä¸€æ—¦å•ç‹¬ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œå¾ˆå¯èƒ½æŠ¥é”™123456789101112131415161718192021222324252627282930313233class Logger &#123; printName(name = 'there') &#123; this.print(`Hello $&#123;name&#125;`); &#125; print(text) &#123; console.log(text); &#125;&#125;const logger = new Logger();const &#123; printName &#125; = logger;// å°†loggerçš„printNameæ–¹æ³•å•ç‹¬æå–å‡ºæ¥printName(); // TypeError: Cannot read property 'print' of undefinedï¼Œå› ä¸ºæ­¤æ—¶thiså·²ç»ä¸æŒ‡å‘loggerå®ä¾‹äº†ï¼Œæ‰€ä»¥æ‰¾ä¸åˆ°printæ–¹æ³•ï¼Œè§£å†³æ–¹æ³•å¦‚ä¸‹// ç›´æ¥ç»‘å®šthisclass Logger &#123; constructor() &#123; this.printName = this.printName.bind(this); &#125; // ...&#125;// ä½¿ç”¨ç®­å¤´å‡½æ•°class Logger &#123; constructor() &#123; this.printName = (name = 'there') =&gt; &#123; this.print(`Hello $&#123;name&#125;`); &#125;; &#125; // ...&#125; Class çš„å–å€¼å‡½æ•°ï¼ˆgetterï¼‰å’Œå­˜å€¼å‡½æ•°ï¼ˆsetterï¼‰ å­˜å€¼å‡½æ•°å’Œå–å€¼å‡½æ•°æ˜¯è®¾ç½®åœ¨å±æ€§çš„ Descriptor å¯¹è±¡ä¸Šçš„1234567891011121314151617181920class CustomHTMLElement &#123; constructor(element) &#123; this.element = element; &#125; get html() &#123; return this.element.innerHTML; &#125; set html(value) &#123; this.element.innerHTML = value; &#125;&#125;var descriptor = Object.getOwnPropertyDescriptor( CustomHTMLElement.prototype, "html");"get" in descriptor // true"set" in descriptor // true Class çš„ Generator æ–¹æ³• å¦‚æœæŸä¸ªæ–¹æ³•ä¹‹å‰åŠ ä¸Šæ˜Ÿå·ï¼ˆ*ï¼‰ï¼Œå°±è¡¨ç¤ºè¯¥æ–¹æ³•æ˜¯ä¸€ä¸ª Generator å‡½æ•°12345678910111213141516class Foo &#123; constructor(...args) &#123; this.args = args; &#125; * [Symbol.iterator]() &#123;// è¿”å›ä¸€ä¸ªåŒæ­¥éå†å™¨å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨for...oféå† for (let arg of this.args) &#123; yield arg; &#125; &#125;&#125;for (let x of new Foo('hello', 'world')) &#123; console.log(x);&#125;// hello// world ç±»çš„é™æ€æ–¹æ³• å¦‚æœåœ¨ä¸€ä¸ªæ–¹æ³•å‰ï¼ŒåŠ ä¸Šstaticå…³é”®å­—ï¼Œå°±è¡¨ç¤ºè¯¥æ–¹æ³•ä¸ä¼šè¢«å®ä¾‹ç»§æ‰¿ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡ç±»æ¥è°ƒç”¨ï¼Œè¿™å°±ç§°ä¸ºâ€œé™æ€æ–¹æ³•â€ã€‚ 1234567891011class Foo &#123; static classMethod() &#123; return 'hello'; &#125;&#125;Foo.classMethod() // 'hello'var foo = new Foo();foo.classMethod()// TypeError: foo.classMethod is not a functionï¼Œæ— æ³•åœ¨å®ä¾‹ä¸Šè°ƒç”¨ é™æ€æ–¹æ³•åŒ…å«thiså…³é”®å­—ï¼Œè¿™ä¸ªthisæŒ‡çš„æ˜¯ç±»ï¼Œè€Œä¸æ˜¯å®ä¾‹ 12345678910111213class Foo &#123; static bar () &#123; this.baz(); &#125; static baz () &#123; console.log('hello'); &#125; baz () &#123; console.log('world'); &#125;&#125;Foo.bar() // hello çˆ¶ç±»çš„é™æ€æ–¹æ³•ï¼Œå¯ä»¥è¢«å­ç±»ç»§æ‰¿ 12345678910class Foo &#123; static classMethod() &#123; return 'hello'; &#125;&#125;class Bar extends Foo &#123;&#125;Bar.classMethod() // 'hello' ç±»çš„é™æ€å±æ€§ é™æ€å±æ€§æŒ‡çš„æ˜¯ Class æœ¬èº«çš„å±æ€§ï¼Œå³Class.propNameï¼Œè€Œä¸æ˜¯å®šä¹‰åœ¨å®ä¾‹å¯¹è±¡ï¼ˆthisï¼‰ä¸Šçš„å±æ€§ã€‚ 1234567891011121314151617// æš‚æ—¶åªèƒ½ç”¨ä¸‹é¢è¿™ç§å†™æ³•class Foo &#123;&#125;Foo.prop = 1;Foo.prop // 1// ä»¥ä¸‹ä¸¤ç§å†™æ³•éƒ½æ— æ•ˆclass Foo &#123; // å†™æ³•ä¸€ prop: 2 // å†™æ³•äºŒ static prop: 2&#125;Foo.prop // undefined æ–°ææ¡ˆå¯¹å®ä¾‹å±æ€§å’Œé™æ€å±æ€§éƒ½è§„å®šäº†æ–°çš„å†™æ³• 1234567891011121314151617// ç±»çš„å®ä¾‹å±æ€§å¯ä»¥ç”¨ç­‰å¼ï¼Œå†™å…¥ç±»çš„å®šä¹‰ä¹‹ä¸­ã€‚ä»¥å‰ï¼Œæˆ‘ä»¬å®šä¹‰å®ä¾‹å±æ€§ï¼Œåªèƒ½å†™åœ¨ç±»çš„constructoræ–¹æ³•é‡Œé¢ã€‚class MyClass &#123; myProp = 42; constructor() &#123; console.log(this.myProp); // 42 &#125;&#125;// ç±»çš„é™æ€å±æ€§ï¼Œç±»çš„é™æ€å±æ€§åªè¦åœ¨ä¸Šé¢çš„å®ä¾‹å±æ€§å†™æ³•å‰é¢ï¼ŒåŠ ä¸Šstaticå…³é”®å­—å°±å¯ä»¥äº†ã€‚class MyClass &#123; static myStaticProp = 42; constructor() &#123; console.log(MyClass.myStaticProp); // 42 &#125;&#125; new.targetå±æ€§ ä¸€èˆ¬ç”¨åœ¨æ„é€ å‡½æ•°ä¹‹ä¸­ï¼Œè¿”å›newå‘½ä»¤è°ƒç”¨çš„é‚£ä¸ªæ„é€ å‡½æ•°ã€‚å¦‚æœæ„é€ å‡½æ•°ä¸æ˜¯é€šè¿‡newå‘½ä»¤è°ƒç”¨çš„ï¼Œnew.targetä¼šè¿”å›undefinedï¼Œå› æ­¤è¿™ä¸ªå±æ€§å¯ä»¥ç”¨æ¥ç¡®å®šæ„é€ å‡½æ•°æ˜¯æ€ä¹ˆè°ƒç”¨çš„ã€‚ 12345678910111213141516171819function Person(name) &#123; if (new.target !== undefined) &#123; this.name = name; &#125; else &#123; throw new Error('å¿…é¡»ä½¿ç”¨newç”Ÿæˆå®ä¾‹'); &#125;&#125;// å¦ä¸€ç§å†™æ³•function Person(name) &#123; if (new.target === Person) &#123; this.name = name; &#125; else &#123; throw new Error('å¿…é¡»ä½¿ç”¨ new ç”Ÿæˆå®ä¾‹'); &#125;&#125;var person = new Person('å¼ ä¸‰'); // æ­£ç¡®var notAPerson = Person.call(person, 'å¼ ä¸‰'); // æ„é€ å‡½æ•°ä¸æ˜¯é€šè¿‡newè°ƒç”¨çš„ï¼ŒæŠ¥é”™ ç”¨åœ¨ES6ä¸­çš„classæ—¶ï¼Œnew.targetè¿”å›çš„æ˜¯newåè·Ÿç€çš„ç±»å(å…¶å®æœ¬è´¨ä¸€æ ·) 123456789class Rectangle &#123; constructor(length, width) &#123; console.log(new.target === Rectangle); this.length = length; this.width = width; &#125;&#125;var obj = new Rectangle(3, 4); // è¾“å‡º true å­ç±»ç»§æ‰¿çˆ¶ç±»æ—¶ï¼Œnew.targetä¼šè¿”å›å­ç±»ï¼Œè€Œä¸æ˜¯çˆ¶ç±»ã€‚ 1234567891011121314class Rectangle &#123; constructor(length, width) &#123; console.log(new.target === Rectangle); // ... &#125;&#125;class Square extends Rectangle &#123; constructor(length) &#123; super(length, length); &#125;&#125;var obj = new Square(3); // Square===Rectangleï¼Œæ‰€ä»¥è¾“å‡º falseï¼Œ åˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹ï¼Œå¯ä»¥å†™å‡ºä¸èƒ½ç‹¬ç«‹ä½¿ç”¨ã€å¿…é¡»ç»§æ‰¿åæ‰èƒ½ä½¿ç”¨çš„ç±» 1234567891011121314151617class Shape &#123; constructor() &#123; if (new.target === Shape) &#123; throw new Error('æœ¬ç±»ä¸èƒ½å®ä¾‹åŒ–'); &#125; &#125;&#125;class Rectangle extends Shape &#123; constructor(length, width) &#123; super(); // ... &#125;&#125;var x = new Shape(); // æŠ¥é”™var y = new Rectangle(3, 4); // æ­£ç¡® classçš„ç»§æ‰¿extends Class å¯ä»¥é€šè¿‡extendså…³é”®å­—å®ç°ç»§æ‰¿ï¼Œè¿™æ¯” ES5 çš„é€šè¿‡ä¿®æ”¹åŸå‹é“¾å®ç°ç»§æ‰¿ï¼Œè¦æ¸…æ™°å’Œæ–¹ä¾¿å¾ˆå¤šã€‚123456// å®šä¹‰äº†ä¸€ä¸ªColorPointç±»ï¼Œè¯¥ç±»é€šè¿‡extendså…³é”®å­—ï¼Œç»§æ‰¿äº†Pointç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚class Point &#123;&#125;class ColorPoint extends Point &#123;&#125; super ES5 çš„ç»§æ‰¿ï¼Œå®è´¨æ˜¯å…ˆåˆ›é€ å­ç±»çš„å®ä¾‹å¯¹è±¡thisï¼Œç„¶åå†å°†çˆ¶ç±»çš„æ–¹æ³•æ·»åŠ åˆ°thisä¸Šé¢ï¼ˆParent.apply(this)ï¼‰ã€‚ES6 çš„ç»§æ‰¿æœºåˆ¶å®Œå…¨ä¸åŒï¼Œå®è´¨æ˜¯å…ˆåˆ›é€ çˆ¶ç±»çš„å®ä¾‹å¯¹è±¡thisï¼ˆæ‰€ä»¥å¿…é¡»å…ˆè°ƒç”¨superæ–¹æ³•ï¼‰ï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®æ”¹thisã€‚ 123456class ColorPoint extends Point &#123; constructor(x, y, color) &#123; super(x, y); // è°ƒç”¨çˆ¶ç±»çš„constructor(x, y)ï¼Œè·å–çˆ¶ç±»çš„å®ä¾‹(thiså¯¹è±¡) this.color = color; &#125;&#125; å­ç±»å¿…é¡»åœ¨constructoræ–¹æ³•ä¸­è°ƒç”¨superæ–¹æ³•ï¼Œå¦åˆ™æ–°å»ºå®ä¾‹æ—¶ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºå­ç±»æ²¡æœ‰è‡ªå·±çš„thiså¯¹è±¡ï¼Œè€Œæ˜¯ç»§æ‰¿çˆ¶ç±»çš„thiså¯¹è±¡ï¼Œç„¶åå¯¹å…¶è¿›è¡ŒåŠ å·¥ã€‚å¦‚æœä¸è°ƒç”¨superæ–¹æ³•ï¼Œå­ç±»å°±å¾—ä¸åˆ°thiså¯¹è±¡ã€‚ 12345678class Point &#123; /* ... */ &#125;class ColorPoint extends Point &#123; constructor() &#123;// æŒ‡å®šäº†constructorï¼Œä½†æ²¡æœ‰è°ƒç”¨superæ–¹æ³• &#125;&#125;let cp = new ColorPoint(); // ReferenceError å½“æœªæ˜¾ç¤ºæŒ‡å®šconstructoræ–¹æ³•æ—¶ï¼Œä¼šé»˜è®¤æ·»åŠ constructoræ–¹æ³•ï¼Œå¹¶åœ¨å†…éƒ¨è‡ªåŠ¨è°ƒç”¨superæ–¹æ³• 123456789class ColorPoint extends Point &#123;&#125;// ç­‰åŒäºclass ColorPoint extends Point &#123; constructor(...args) &#123; super(...args); &#125;&#125; åªæœ‰è°ƒç”¨superä¹‹åï¼Œæ‰å¯ä»¥ä½¿ç”¨thiså…³é”®å­—ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºå­ç±»å®ä¾‹çš„æ„å»ºï¼Œæ˜¯åŸºäºå¯¹çˆ¶ç±»å®ä¾‹åŠ å·¥ï¼Œåªæœ‰superæ–¹æ³•æ‰èƒ½è¿”å›çˆ¶ç±»å®ä¾‹ 1234567891011121314class Point &#123; constructor(x, y) &#123; this.x = x; this.y = y; &#125;&#125;class ColorPoint extends Point &#123; constructor(x, y, color) &#123; this.color = color; // ReferenceErrorï¼Œå­ç±»æ²¡æœ‰è‡ªå·±çš„thisï¼Œå¿…é¡»å…ˆè·å¾—çˆ¶ç±»çš„this super(x, y); this.color = color; // æ­£ç¡® &#125;&#125; superçš„ä½¿ç”¨ superå…³é”®å­—å¯ä»¥å½“å‡½æ•°ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å½“ä½œå¯¹è±¡ä½¿ç”¨ superä½œä¸ºå‡½æ•°è°ƒç”¨æ—¶ï¼Œä»£è¡¨çˆ¶ç±»çš„æ„é€ å‡½æ•° 1234567class A &#123;&#125;class B extends A &#123; constructor() &#123; super();// è°ƒç”¨çˆ¶ç±»çš„constructorï¼Œå¾—åˆ°çˆ¶ç±»çš„this(å®ä¾‹å¯¹è±¡)ï¼Œè¿›è€Œå¯ä»¥è¿›è¡ŒåŠ å·¥å¾—åˆ°è‡ªå·±çš„å®ä¾‹å¯¹è±¡ &#125;&#125; superè™½ç„¶ä»£è¡¨äº†çˆ¶ç±»Açš„æ„é€ å‡½æ•°ï¼Œä½†æ˜¯è¿”å›çš„æ˜¯å­ç±»Bçš„å®ä¾‹ï¼Œå³superå†…éƒ¨çš„thisæŒ‡çš„æ˜¯Bï¼Œå› æ­¤super()åœ¨è¿™é‡Œç›¸å½“äºA.prototype.constructor.call(this)ã€‚è¿™é‡Œå…¶å®å°±å¯ä»¥ç†è§£ä¸ºï¼Œå…ˆè°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°æ–¹æ³•åˆ›å»ºä¸€ä¸ªçˆ¶ç±»çš„å®ä¾‹å¯¹è±¡ï¼Œç„¶åæ‹·è´ä¸€ä»½ç»™å­ç±»ï¼Œè¿™æ ·å­ç±»å°±æ‹¥æœ‰äº†è‡ªå·±çš„å®ä¾‹å¯¹è±¡ï¼Œç„¶åé€šè¿‡å­ç±»è‡ªå·±çš„æ„é€ å‡½æ•°å¯¹æ‹·è´è¿‡æ¥çš„å®ä¾‹å¯¹è±¡è¿›è¡Œä¿®æ”¹åŠ å·¥ã€‚ 123456789101112class A &#123; constructor() &#123; console.log(new.target.name); &#125;&#125;class B extends A &#123; constructor() &#123; super(); &#125;&#125;new A() // Anew B() // B ä½œä¸ºå‡½æ•°æ—¶ï¼Œsuper()åªèƒ½ç”¨åœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¹‹ä¸­ï¼Œç”¨åœ¨å…¶ä»–åœ°æ–¹å°±ä¼šæŠ¥é”™ã€‚ 1234567class A &#123;&#125;class B extends A &#123; m() &#123; super(); // æŠ¥é”™ &#125;&#125; superä½œä¸ºå¯¹è±¡æ—¶ï¼Œåœ¨æ™®é€šæ–¹æ³•ä¸­ï¼ŒæŒ‡å‘çˆ¶ç±»çš„åŸå‹å¯¹è±¡ï¼›åœ¨é™æ€æ–¹æ³•ä¸­ï¼ŒæŒ‡å‘çˆ¶ç±»ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445// æ™®é€šæ–¹æ³•ä¸­// å­ç±»Bå½“ä¸­çš„super.p()ï¼Œå°±æ˜¯å°†superå½“ä½œä¸€ä¸ªå¯¹è±¡ä½¿ç”¨ã€‚è¿™æ—¶ï¼Œsuperåœ¨æ™®é€šæ–¹æ³•ä¹‹ä¸­ï¼ŒæŒ‡å‘A.prototypeï¼Œæ‰€ä»¥super.p()å°±ç›¸å½“äºA.prototype.p()class A &#123; p() &#123; return 2; &#125;&#125;class B extends A &#123; constructor() &#123; super(); console.log(super.p()); // 2 &#125;&#125;let b = new B();// ç”±äºsuperæŒ‡å‘çˆ¶ç±»çš„åŸå‹å¯¹è±¡ï¼Œæ‰€ä»¥å®šä¹‰åœ¨çˆ¶ç±»å®ä¾‹ä¸Šçš„æ–¹æ³•æˆ–å±æ€§ï¼Œæ˜¯æ— æ³•é€šè¿‡superè°ƒç”¨çš„class A &#123; constructor() &#123; this.p = 2; &#125;&#125;class B extends A &#123; get m() &#123; return super.p;// superä»£è¡¨çš„æ˜¯A.prototypeï¼Œå®ä¾‹æ–¹æ³•æ— æ³•å¼•ç”¨åˆ° &#125;&#125;let b = new B();b.m // undefined// å¦‚æœå±æ€§å®šä¹‰åœ¨çˆ¶ç±»çš„åŸå‹å¯¹è±¡ä¸Šï¼Œsuperå°±å¯ä»¥å–åˆ°ã€‚class A &#123;&#125;A.prototype.x = 2;class B extends A &#123; constructor() &#123; super(); console.log(super.x) // 2 &#125;&#125;let b = new B(); ES6 è§„å®šï¼Œé€šè¿‡superè°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œsuperä¼šç»‘å®šå­ç±»çš„this 123456789101112131415161718192021class A &#123; constructor() &#123; this.x = 1; &#125; print() &#123; console.log(this.x); &#125;&#125;class B extends A &#123; constructor() &#123; super(); this.x = 2; &#125; m() &#123; super.print();// è°ƒç”¨çˆ¶ç±»åŸå‹å¯¹è±¡ä¸Šçš„printæ–¹æ³•ï¼Œä½†æ˜¯thisç»‘å®šçš„æ˜¯å­ç±»çš„ï¼Œå®é™…ä¸Šæ‰§è¡Œçš„æ˜¯super.print.call(this) &#125;&#125;let b = new B();b.m() // 2 ç”±äºç»‘å®šå­ç±»çš„thisï¼Œæ‰€ä»¥å¦‚æœé€šè¿‡superå¯¹æŸä¸ªå±æ€§èµ‹å€¼ï¼Œè¿™æ—¶superå°±æ˜¯thisï¼Œèµ‹å€¼çš„å±æ€§ä¼šå˜æˆå­ç±»å®ä¾‹çš„å±æ€§ 1234567891011121314151617class A &#123; constructor() &#123; this.x = 1; &#125;&#125;class B extends A &#123; constructor() &#123; super(); this.x = 2; super.x = 3; console.log(super.x); // undefined console.log(this.x); // 3 &#125;&#125;let b = new B(); å¦‚æœsuperä½œä¸ºå¯¹è±¡ï¼Œç”¨åœ¨é™æ€æ–¹æ³•ä¹‹ä¸­ï¼Œè¿™æ—¶superå°†æŒ‡å‘çˆ¶ç±»ï¼Œè€Œä¸æ˜¯çˆ¶ç±»çš„åŸå‹å¯¹è±¡ 123456789101112131415161718192021222324class Parent &#123; static myMethod(msg) &#123; console.log('static', msg); &#125; myMethod(msg) &#123; console.log('instance', msg); &#125;&#125;class Child extends Parent &#123; static myMethod(msg) &#123; super.myMethod(msg); &#125; myMethod(msg) &#123; super.myMethod(msg); &#125;&#125;Child.myMethod(1); // static 1var child = new Child();child.myMethod(2); // instance 2 ä½¿ç”¨superçš„æ—¶å€™ï¼Œå¿…é¡»æ˜¾å¼æŒ‡å®šæ˜¯ä½œä¸ºå‡½æ•°ã€è¿˜æ˜¯ä½œä¸ºå¯¹è±¡ä½¿ç”¨ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ 12345678class A &#123;&#125;class B extends A &#123; constructor() &#123; super(); console.log(super); // æŠ¥é”™ &#125;&#125; åŸç”Ÿæ„é€ å‡½æ•°çš„ç»§æ‰¿ ES5ä¸­æ˜¯æ— æ³•ç»§æ‰¿åŸç”Ÿæ„é€ å‡½æ•°ï¼Œæˆ–è€…ç»§æ‰¿å‡ºæ¥çš„è¡Œä¸ºä¸ä¸€è‡´ 123456789101112131415161718192021// å­ç±»æ— æ³•è·å¾—åŸç”Ÿæ„é€ å‡½æ•°çš„å†…éƒ¨å±æ€§ï¼Œé€šè¿‡Array.apply()æˆ–è€…åˆ†é…ç»™åŸå‹å¯¹è±¡éƒ½ä¸è¡Œã€‚åŸç”Ÿæ„é€ å‡½æ•°ä¼šå¿½ç•¥applyæ–¹æ³•ä¼ å…¥çš„thisï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸç”Ÿæ„é€ å‡½æ•°çš„thisæ— æ³•ç»‘å®šï¼Œå¯¼è‡´æ‹¿ä¸åˆ°å†…éƒ¨å±æ€§ã€‚// ES5 æ˜¯å…ˆæ–°å»ºå­ç±»çš„å®ä¾‹å¯¹è±¡thisï¼Œå†å°†çˆ¶ç±»çš„å±æ€§æ·»åŠ åˆ°å­ç±»ä¸Šï¼Œç”±äºçˆ¶ç±»çš„å†…éƒ¨å±æ€§æ— æ³•è·å–ï¼Œå¯¼è‡´æ— æ³•ç»§æ‰¿åŸç”Ÿçš„æ„é€ å‡½æ•°ã€‚æ¯”å¦‚ï¼ŒArrayæ„é€ å‡½æ•°æœ‰ä¸€ä¸ªå†…éƒ¨å±æ€§[[DefineOwnProperty]]ï¼Œç”¨æ¥å®šä¹‰æ–°å±æ€§æ—¶ï¼Œæ›´æ–°lengthå±æ€§ï¼Œè¿™ä¸ªå†…éƒ¨å±æ€§æ— æ³•åœ¨å­ç±»è·å–ï¼Œå¯¼è‡´å­ç±»çš„lengthå±æ€§è¡Œä¸ºä¸æ­£å¸¸function MyArray() &#123; Array.apply(this, arguments);&#125;MyArray.prototype = Object.create(Array.prototype, &#123; constructor: &#123; value: MyArray, writable: true, configurable: true, enumerable: true &#125;&#125;);var colors = new MyArray();colors[0] = "red";colors.length // 0colors.length = 0;colors[0] // "red" ES6 å…è®¸ç»§æ‰¿åŸç”Ÿæ„é€ å‡½æ•°å®šä¹‰å­ç±»ï¼Œå› ä¸º ES6 æ˜¯å…ˆæ–°å»ºçˆ¶ç±»çš„å®ä¾‹å¯¹è±¡thisï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®é¥°thisï¼Œä½¿å¾—çˆ¶ç±»çš„æ‰€æœ‰è¡Œä¸ºéƒ½å¯ä»¥ç»§æ‰¿ã€‚ 123456789101112class MyArray extends Array &#123; constructor(...args) &#123; super(...args); &#125;&#125;var arr = new MyArray();arr[0] = 12;arr.length // 1arr.length = 0;arr[0] // undefined Decoratorä¿®é¥°å™¨ ç”¨æ¥ä¿®æ”¹ç±»ã€æ–¹æ³•çš„è¡Œä¸º ä¿®é¥°ç±» 1234567891011121314151617181920212223242526272829303132@testableclass MyTestableClass &#123; // ...&#125;function testable(target) &#123;// targetå°±æ˜¯è¦ä¿®é¥°çš„ç±» target.isTestable = true;&#125;MyTestableClass.isTestable // true// ç­‰åŒäºclass MyTestableClass &#123; // ...&#125;MyTestableClass = testable(MyTestableClass) || MyTestableClass;// ä¸€ä¸ªå‚æ•°ä¸å¤Ÿç”¨ï¼Œå¯ä»¥åœ¨ä¿®é¥°å™¨å¤–é¢å†å°è£…ä¸€å±‚å‡½æ•°function testable(isTestable) &#123; return function(target) &#123; target.isTestable = isTestable; &#125;&#125;@testable(true) // è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œç”¨è¿™ä¸ªå‡½æ•°æ¥ä¿®é¥°MyTestableClassclass MyTestableClass &#123;&#125;MyTestableClass.isTestable // true@testable(false)class MyClass &#123;&#125;MyClass.isTestable // false ä¿®é¥°æ–¹æ³• 1234567891011121314151617181920class Person &#123; @readonly name() &#123; return `$&#123;this.first&#125; $&#123;this.last&#125;` &#125;&#125;function readonly(target, name, descriptor)&#123; // descriptorå¯¹è±¡åŸæ¥çš„å€¼å¦‚ä¸‹ // &#123; // value: specifiedFunction, // enumerable: false, // configurable: true, // writable: true // &#125;; descriptor.writable = false; return descriptor;&#125;readonly(Person.prototype, 'name', descriptor);// ç±»ä¼¼äºObject.defineProperty(Person.prototype, 'name', descriptor); ä¿®é¥°å™¨åªèƒ½ç”¨äºç±»å’Œç±»çš„æ–¹æ³•ï¼Œä¸èƒ½ç”¨äºå‡½æ•°ï¼Œå› ä¸ºå­˜åœ¨å‡½æ•°æå‡ 1234567891011121314151617181920212223var counter = 0;var add = function () &#123; counter++;&#125;;@addfunction foo() &#123;&#125;// ç­‰åŒäº@addfunction foo() &#123;&#125;var counter;var add;counter = 0;add = function () &#123; counter++;&#125;; Moduleè¯­æ³•ç®€ä»‹ ES6 æ¨¡å—ä¸æ˜¯å¯¹è±¡ï¼Œè€Œæ˜¯é€šè¿‡exportå‘½ä»¤æ˜¾å¼æŒ‡å®šè¾“å‡ºçš„ä»£ç ï¼Œå†é€šè¿‡importå‘½ä»¤è¾“å…¥ã€‚ importã€exportå‘½ä»¤å®ç°çš„æ˜¯é™æ€åŠ è½½ï¼Œæ˜¯åœ¨ç¼–è¯‘é˜¶æ®µåŠ è½½ï¼Œè€Œä¸æ˜¯è¿è¡Œæ—¶å†åŠ è½½ï¼Œæ‰€ä»¥æ•ˆç‡è¦æ¯”CommonJS æ¨¡å—çš„åŠ è½½æ–¹å¼é«˜12// ES6æ¨¡å—import &#123; stat, exists, readFile &#125; from 'fs'; ä¸¥æ ¼æ¨¡å¼ ES6 çš„æ¨¡å—è‡ªåŠ¨é‡‡ç”¨ä¸¥æ ¼æ¨¡å¼ ES6 æ¨¡å—ä¹‹ä¸­ï¼Œé¡¶å±‚çš„thisæŒ‡å‘undefinedï¼Œå³ä¸åº”è¯¥åœ¨é¡¶å±‚ä»£ç ä½¿ç”¨thisã€‚ exportå‘½ä»¤ exportå‘½ä»¤ç”¨äºè§„å®šæ¨¡å—çš„å¯¹å¤–æ¥å£ 123456789101112// profile.jsexport var firstName = 'Michael';export var lastName = 'Jackson';export var year = 1958;// ç­‰åŒäºä¸‹é¢çš„// profile.jsvar firstName = 'Michael';var lastName = 'Jackson';var year = 1958;export &#123;firstName, lastName, year&#125;; exportå‘½ä»¤é™¤äº†è¾“å‡ºå˜é‡ï¼Œè¿˜å¯ä»¥è¾“å‡ºå‡½æ•°æˆ–ç±»ï¼ˆclassï¼‰ã€‚ 1234567export function multiply(x, y) &#123; return x * y;&#125;;export class Person&#123; ...&#125; ä½¿ç”¨aså…³é”®å­—ç»™å¯¹å¤–æ¥å£é‡æ–°å–å 12345678function v1() &#123; ... &#125;function v2() &#123; ... &#125;export &#123;// v2å¯¹å¤–æœ‰ä¸¤ä¸ªæ¥å£å v1 as streamV1, v2 as streamV2, v2 as streamLatestVersion&#125;; exportå‘½ä»¤è§„å®šçš„æ˜¯å¯¹å¤–çš„æ¥å£ï¼Œå¿…é¡»ä¸æ¨¡å—å†…éƒ¨çš„å˜é‡å»ºç«‹ä¸€ä¸€å¯¹åº”å…³ç³»ã€‚ 123456789101112131415161718192021222324252627282930// æŠ¥é”™export 1;// æŠ¥é”™var m = 1;export m;// æ­£ç¡®å†™æ³•// å†™æ³•ä¸€export var m = 1;// å†™æ³•äºŒvar m = 1;export &#123;m&#125;;// å†™æ³•ä¸‰var n = 1;export &#123;n as m&#125;;// functionã€classä¹Ÿå¿…é¡»éµå®ˆ// æŠ¥é”™function f() &#123;&#125;export f;// æ­£ç¡®export function f() &#123;&#125;;// æ­£ç¡®function f() &#123;&#125;export &#123;f&#125;; exportè¯­å¥è¾“å‡ºçš„æ¥å£ï¼Œä¸å…¶å¯¹åº”çš„å€¼æ˜¯åŠ¨æ€ç»‘å®šå…³ç³»ï¼Œå³é€šè¿‡è¯¥æ¥å£ï¼Œå¯ä»¥å–åˆ°æ¨¡å—å†…éƒ¨å®æ—¶çš„å€¼ 12export var foo = 'bar';setTimeout(() =&gt; foo = 'baz', 500); exportã€importå‘½ä»¤å¯ä»¥å‡ºç°åœ¨æ¨¡å—çš„ä»»ä½•ä½ç½®ï¼Œåªè¦å¤„äºæ¨¡å—é¡¶å±‚å°±å¯ä»¥ã€‚å¦‚æœå¤„äºå—çº§ä½œç”¨åŸŸå†…ï¼Œå°±ä¼šæŠ¥é”™ 1234function foo() &#123; export default 'bar' // SyntaxError&#125;foo() importå‘½ä»¤ ä½¿ç”¨exportå‘½ä»¤å®šä¹‰äº†æ¨¡å—çš„å¯¹å¤–æ¥å£ä»¥åï¼Œå…¶ä»– JS æ–‡ä»¶å°±å¯ä»¥é€šè¿‡importå‘½ä»¤åŠ è½½è¿™ä¸ªæ¨¡å— 123456// main.jsimport &#123;firstName, lastName, year&#125; from './profile';// ä½¿ç”¨è§£æ„èµ‹å€¼è·å¾—./profileå¯¼å‡ºå€¼function setName(element) &#123; element.textContent = firstName + ' ' + lastName;&#125; åŒexportä¸€æ ·ï¼Œå¯å¯¹å¯¼å…¥çš„å˜é‡ä½¿ç”¨asé‡æ–°å–å 1import &#123; lastName as surname &#125; from './profile'; importå‘½ä»¤å…·æœ‰æå‡æ•ˆæœï¼Œä¼šæå‡åˆ°æ•´ä¸ªæ¨¡å—çš„å¤´éƒ¨ï¼Œé¦–å…ˆæ‰§è¡Œ 123foo();import &#123; foo &#125; from 'my_module'; importå‘½ä»¤æ˜¯é™æ€æ‰§è¡Œï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨è¡¨è¾¾å¼å’Œå˜é‡ï¼Œè¿™äº›åªæœ‰åœ¨è¿è¡Œæ—¶æ‰èƒ½å¾—åˆ°ç»“æœçš„è¯­æ³•ç»“æ„ 12345678910111213// æŠ¥é”™import &#123; 'f' + 'oo' &#125; from 'my_module';// æŠ¥é”™let module = 'my_module';import &#123; foo &#125; from module;// æŠ¥é”™if (x === 1) &#123; import &#123; foo &#125; from 'module1';&#125; else &#123; import &#123; foo &#125; from 'module2';&#125; æ¨¡å—çš„æ•´ä½“åŠ è½½ ç”¨æ˜Ÿå·ï¼ˆ*ï¼‰æŒ‡å®šä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€æœ‰exportè¾“å‡ºå€¼éƒ½åŠ è½½åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šé¢ã€‚ 12345678910111213141516171819// circle.jsexport function area(radius) &#123; return Math.PI * radius * radius;&#125;export function circumference(radius) &#123; return 2 * Math.PI * radius;&#125;// main.jsï¼Œå•ç‹¬åŠ è½½import &#123; area, circumference &#125; from './circle';console.log('åœ†é¢ç§¯ï¼š' + area(4));console.log('åœ†å‘¨é•¿ï¼š' + circumference(14));// main.jsï¼Œæ•´ä½“åŠ è½½import * as circle from './circle';console.log('åœ†é¢ç§¯ï¼š' + circle.area(4));console.log('åœ†å‘¨é•¿ï¼š' + circle.circumference(14)); ç”¨äºæŒ‚è½½è¾“å‡ºå€¼çš„å¯¹è±¡ä¸å¯ä»¥æ”¹å†™ 12345import * as circle from './circle';// ä¸‹é¢ä¸¤è¡Œéƒ½æ˜¯ä¸å…è®¸çš„circle.foo = 'hello';circle.area = function () &#123;&#125;; æ³¨æ„ï¼Œç›´æ¥ä½¿ç”¨import * as xxxæ—¶ï¼Œæ˜¯ä¸ä¼šå¯¼å…¥é»˜è®¤å€¼ï¼Œä¼šå¿½ç•¥é»˜è®¤å€¼ï¼Œå¦‚æœéœ€è¦åŒæ—¶å¯¼å…¥é»˜è®¤å€¼å’Œæ‰€æœ‰çš„éé»˜è®¤å€¼éœ€è¦è¿™ä¹ˆå†™ 1import myDefault,* as myObj from './a' export default å‘½ä»¤ ä½¿ç”¨exportå‘½ä»¤æ—¶ï¼Œå¯ä»¥æ·»åŠ defaultæ¥æŒ‡å®šé»˜è®¤è¾“å‡ºå€¼ï¼ŒimportåŠ è½½æ—¶å¯ç”¨ä»»æ„çš„å˜é‡åæ¥æ¥æ”¶è¾“å‡ºå€¼ æ˜¾ç„¶ï¼Œä¸€ä¸ªæ¨¡å—åªèƒ½æœ‰ä¸€ä¸ªé»˜è®¤è¾“å‡ºï¼Œå› æ­¤export defaultå‘½ä»¤åªèƒ½ä½¿ç”¨ä¸€æ¬¡ 12345678910111213141516171819202122// export-default.jsexport default function () &#123; console.log('foo');&#125;// import-default.jsimport customName from './export-default';// è¿™æ—¶importå‘½ä»¤åé¢ï¼Œä¸ä½¿ç”¨å¤§æ‹¬å·ã€‚customName(); // 'foo'// export defaultå¯ç”¨åœ¨éåŒ¿åå‡½æ•°å‰ï¼ŒåŠ è½½çš„æ—¶å€™ï¼Œè§†åŒåŒ¿åå‡½æ•°åŠ è½½ã€‚// export-default.jsexport default function foo() &#123; console.log('foo');&#125;// æˆ–è€…å†™æˆfunction foo() &#123; console.log('foo');&#125;export default foo; é»˜è®¤è¾“å‡ºå€¼ï¼Œåœ¨å¯¼å…¥æ—¶ï¼Œä¸ç”¨åŠ {}ï¼Œéé»˜è®¤å¯¼å‡ºå€¼éœ€è¦æ·»åŠ {} 12345678910111213// ç¬¬ä¸€ç»„export default function crc32() &#123; // è¾“å‡º // ...&#125;import crc32 from 'crc32'; // è¾“å…¥// ç¬¬äºŒç»„export function crc32() &#123; // è¾“å‡º // ...&#125;;import &#123;crc32&#125; from 'crc32'; // è¾“å…¥ æœ¬è´¨ä¸Šï¼Œexport defaultå°±æ˜¯è¾“å‡ºä¸€ä¸ªå«åšdefaultçš„å˜é‡æˆ–æ–¹æ³•ï¼Œç„¶åç³»ç»Ÿå…è®¸ä½ ä¸ºå®ƒå–ä»»æ„åå­— 123456789101112// modules.jsfunction add(x, y) &#123; return x * y;&#125;export &#123;add as default&#125;;// ç­‰åŒäº// export default add;// app.jsimport &#123; default as xxx &#125; from 'modules';// ç­‰åŒäº// import xxx from 'modules'; å¦‚æœæƒ³åœ¨ä¸€æ¡importè¯­å¥ä¸­ï¼ŒåŒæ—¶è¾“å…¥é»˜è®¤æ–¹æ³•å’Œå…¶ä»–æ¥å£ï¼Œå¯ä»¥å†™æˆä¸‹é¢è¿™æ · 1import _, &#123; each, each as forEach &#125; from 'lodash'; export ä¸ import çš„å¤åˆå†™æ³• ç”¨åœ¨ä¸€ä¸ªæ¨¡å—ä¹‹ä¸­ï¼Œå…ˆè¾“å…¥åè¾“å‡ºåŒä¸€ä¸ªæ¨¡å— æ³¨æ„ï¼Œexport *å‘½ä»¤ä¼šå¿½ç•¥æ¨¡å—çš„defaultæ–¹æ³•1234567891011121314151617181920212223export &#123; foo, bar &#125; from 'my_module';// ç­‰åŒäºimport &#123; foo, bar &#125; from 'my_module';export &#123; foo, bar &#125;;// æ¨¡å—çš„æ¥å£æ”¹åå’Œæ•´ä½“è¾“å‡ºï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨è¿™ç§å†™æ³•// æ¥å£æ”¹åexport &#123; foo as myFoo &#125; from 'my_module';// æ•´ä½“è¾“å‡ºexport * from 'my_module';// é»˜è®¤æ¥å£çš„å†™æ³•export &#123; default &#125; from 'foo';// å…·åæ¥å£æ”¹ä¸ºé»˜è®¤æ¥å£çš„å†™æ³•export &#123; es6 as default &#125; from './someModule';// ç­‰åŒäºimport &#123; es6 &#125; from './someModule';export default es6;// é»˜è®¤æ¥å£ä¹Ÿå¯ä»¥æ”¹åä¸ºå…·åæ¥å£export &#123; default as es6 &#125; from './someModule'; æ¨¡å—çš„ç»§æ‰¿123456789101112131415// circle.jsexport function area(radius) &#123; return Math.PI * radius * radius;&#125;export function circumference(radius) &#123; return 2 * Math.PI * radius;&#125;// circleplus.jsexport * from 'circle';export var e = 2.71828182846;export default function(x) &#123; return Math.exp(x);&#125;// ä¸Šé¢ä»£ç ä¸­çš„export *ï¼Œè¡¨ç¤ºå†è¾“å‡ºcircleæ¨¡å—çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚æ³¨æ„ï¼Œexport *å‘½ä»¤ä¼šå¿½ç•¥circleæ¨¡å—çš„defaultæ–¹æ³•(å› ä¸ºåé¢æœ‰è‡ªå·±çš„é»˜è®¤æ–¹æ³•)ã€‚ç„¶åï¼Œä¸Šé¢ä»£ç åˆè¾“å‡ºäº†è‡ªå®šä¹‰çš„eå˜é‡å’Œé»˜è®¤æ–¹æ³•ã€‚ è·¨æ¨¡å—å¸¸é‡ å¯ä»¥å°†ä¸åŒå¸¸é‡æ”¾åœ¨ä¸åŒçš„jsæ–‡ä»¶ä¸­ï¼Œç„¶åé›†ä¸­å¯¼å…¥åˆ°ä¸€ä¸ªjsæ–‡ä»¶ä¸­ï¼Œå¹¶é›†ä½“è¾“å‡ºï¼›ä½¿ç”¨æ—¶åªç”¨å¯¼å…¥é›†ä¸­çš„jsæ–‡ä»¶å³å¯12345678910111213141516// constants/db.jsexport const db = &#123; url: 'http://my.couchdbserver.local:5984', admin_username: 'admin', admin_password: 'admin password'&#125;;// constants/user.jsexport const users = ['root', 'admin', 'staff', 'ceo', 'chief', 'moderator'];// constants/index.jsï¼Œå°†ä¸åŒå¸¸é‡å¯¼å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶åˆ°å¤„export &#123;db&#125; from './db';export &#123;users&#125; from './users';// script.jsï¼Œä½¿ç”¨æ—¶ç›´æ¥å¯¼å…¥é›†ä¸­çš„æ–‡ä»¶import &#123;db, users&#125; from './index'; import() importå‘½ä»¤æ˜¯ç¼–è¯‘æ—¶åŠ è½½ï¼Œæ— æ³•åšåˆ°è¿è¡Œæ—¶åŠ è½½(åŠ¨æ€åŠ è½½)ï¼Œæ–°ææ¡ˆé€šè¿‡import()å‡½æ•°å®ç°è¿è¡Œæ—¶åŠ è½½ import()è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ 123456789const main = document.querySelector('main');import(`./section-modules/$&#123;someVariable&#125;.js`) .then(module =&gt; &#123; module.loadPageInto(main); &#125;) .catch(err =&gt; &#123; main.textContent = err.message; &#125;); åœºæ™¯ 123456789101112131415161718192021// æŒ‰éœ€åŠ è½½button.addEventListener('click', event =&gt; &#123; import('./dialogBox.js') .then(dialogBox =&gt; &#123; dialogBox.open(); &#125;) .catch(error =&gt; &#123; /* Error handling */ &#125;)&#125;);// æ¡ä»¶åŠ è½½if (condition) &#123; import('moduleA').then(...);&#125; else &#123; import('moduleB').then(...);&#125;// åŠ¨æ€çš„æ¨¡å—è·¯å¾„import(f()).then(...); Module çš„åŠ è½½å®ç°æµè§ˆå™¨åŠ è½½ES6æ¨¡å— ä¼ ç»Ÿæ–¹æ³•ï¼ŒåŠ è½½æ™®é€šæ¨¡å— 12345678910111213&lt;!-- é¡µé¢å†…åµŒçš„è„šæœ¬ --&gt;&lt;script type="application/javascript"&gt; // module code&lt;/script&gt;&lt;!-- å¤–éƒ¨è„šæœ¬ --&gt;&lt;script type="application/javascript" src="path/to/myModule.js"&gt;&lt;/script&gt;&lt;!-- deferæ˜¯â€œæ¸²æŸ“å®Œå†æ‰§è¡Œâ€ --&gt;&lt;script src="path/to/myModule.js" defer&gt;&lt;/script&gt;&lt;!-- asyncæ˜¯â€œä¸‹è½½å®Œå°±æ‰§è¡Œâ€ --&gt;&lt;script src="path/to/myModule.js" async&gt;&lt;/script&gt; æµè§ˆå™¨ä¸ŠåŠ è½½ES6æ¨¡å— 12345&lt;!-- éœ€è¦æŒ‡å®štypeä¸ºmoduleï¼Œå¼‚æ­¥åŠ è½½ï¼Œä¸ä¼šé€ æˆå µå¡æµè§ˆå™¨ï¼Œå³ç­‰åˆ°æ•´ä¸ªé¡µé¢æ¸²æŸ“å®Œï¼Œå†æ‰§è¡Œæ¨¡å—è„šæœ¬ï¼Œç­‰åŒäºæ‰“å¼€äº†&lt;script&gt;æ ‡ç­¾çš„deferå±æ€§ã€‚ --&gt;&lt;script type="module" src="foo.js"&gt;&lt;/script&gt;&lt;!-- ç­‰åŒäº --&gt;&lt;script type="module" src="foo.js" defer&gt;&lt;/script&gt; å¯¹äºå¤–éƒ¨çš„æ¨¡å—è„šæœ¬ï¼ˆä¸Šä¾‹æ˜¯foo.jsï¼‰ï¼Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ã€‚ ä»£ç æ˜¯åœ¨æ¨¡å—ä½œç”¨åŸŸä¹‹ä¸­è¿è¡Œï¼Œè€Œä¸æ˜¯åœ¨å…¨å±€ä½œç”¨åŸŸè¿è¡Œã€‚æ¨¡å—å†…éƒ¨çš„é¡¶å±‚å˜é‡ï¼Œå¤–éƒ¨ä¸å¯è§ã€‚ æ¨¡å—è„šæœ¬è‡ªåŠ¨é‡‡ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œä¸ç®¡æœ‰æ²¡æœ‰å£°æ˜use strictã€‚ æ¨¡å—ä¹‹ä¸­ï¼Œå¯ä»¥ä½¿ç”¨importå‘½ä»¤åŠ è½½å…¶ä»–æ¨¡å—ï¼ˆ.jsåç¼€ä¸å¯çœç•¥ï¼Œéœ€è¦æä¾›ç»å¯¹ URL æˆ–ç›¸å¯¹ URLï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨exportå‘½ä»¤è¾“å‡ºå¯¹å¤–æ¥å£ã€‚ æ¨¡å—ä¹‹ä¸­ï¼Œé¡¶å±‚çš„thiså…³é”®å­—è¿”å›undefinedï¼Œè€Œä¸æ˜¯æŒ‡å‘windowã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ¨¡å—é¡¶å±‚ä½¿ç”¨thiså…³é”®å­—ï¼Œæ˜¯æ— æ„ä¹‰çš„ã€‚ åŒä¸€ä¸ªæ¨¡å—å¦‚æœåŠ è½½å¤šæ¬¡ï¼Œå°†åªæ‰§è¡Œä¸€æ¬¡ã€‚12345678import utils from 'https://example.com/js/utils.js';const x = 1;console.log(x === window.x); //falseconsole.log(this === undefined); // truedelete x; // å¥æ³•é”™è¯¯ï¼Œä¸¥æ ¼æ¨¡å¼ç¦æ­¢åˆ é™¤å˜é‡ ES6 æ¨¡å—ä¸ CommonJS æ¨¡å—çš„å·®å¼‚ CommonJS æ¨¡å—è¾“å‡ºçš„æ˜¯ä¸€ä¸ªå€¼çš„æ‹·è´ï¼ŒES6 æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„å¼•ç”¨ã€‚ES6æ¨¡å—è¾“å‡ºçš„å˜é‡æ˜¯å®æ—¶æ›´æ–°çš„ CommonJS æ¨¡å—æ˜¯è¿è¡Œæ—¶åŠ è½½ï¼ŒES6 æ¨¡å—æ˜¯ç¼–è¯‘æ—¶è¾“å‡ºæ¥å£ã€‚ ES6æ¨¡å—çš„å¾ªç¯åŠ è½½ æ³¨æ„ï¼ŒES6è¾“å‡ºçš„æ˜¯ä¸€ä¸ªå¼•ç”¨ å½“ä¸€ä¸ªæ¨¡å—å·²ç»åŠ è½½åï¼Œä¸ä¼šé‡å¤æ‰§è¡Œ12345678910111213141516171819202122// a.jså¦‚ä¸‹import &#123;bar&#125; from './b.js';console.log('a.js');console.log(bar);export let foo = 'foo';// b.jsimport &#123;foo&#125; from './a.js';console.log('b.js');console.log(foo);export let bar = 'bar';// æ‰§è¡Œa.js$ babel-node a.jsb.jsundefineda.jsbar// ç”±äºa.jsçš„ç¬¬ä¸€è¡Œæ˜¯åŠ è½½b.jsï¼Œæ‰€ä»¥å…ˆæ‰§è¡Œçš„æ˜¯b.jsã€‚è€Œb.jsçš„ç¬¬ä¸€è¡Œåˆæ˜¯åŠ è½½a.jsï¼Œè¿™æ—¶ç”±äºa.jså·²ç»å¼€å§‹æ‰§è¡Œäº†ï¼Œæ‰€ä»¥ä¸ä¼šé‡å¤æ‰§è¡Œï¼Œè€Œæ˜¯ç»§ç»­å¾€ä¸‹æ‰§è¡Œb.jsï¼Œæ‰€ä»¥ç¬¬ä¸€è¡Œè¾“å‡ºçš„æ˜¯b.jsã€‚// æ¥ç€ï¼Œb.jsè¦æ‰“å°å˜é‡fooï¼Œè¿™æ—¶a.jsè¿˜æ²¡æ‰§è¡Œå®Œï¼Œå–ä¸åˆ°fooçš„å€¼ï¼Œå¯¼è‡´æ‰“å°å‡ºæ¥æ˜¯undefinedã€‚b.jsæ‰§è¡Œå®Œï¼Œå¼€å§‹æ‰§è¡Œa.jsï¼Œè¿™æ—¶å°±ä¸€åˆ‡æ­£å¸¸äº†ã€‚ ArrayBufferç®€ä»‹ å…ˆåšä¸ªç®€å•äº†è§£ï¼ŒåæœŸç”¨åˆ°å†è¡¥ ArrayBufferå¯¹è±¡ã€TypedArrayè§†å›¾å’ŒDataViewè§†å›¾æ˜¯ JavaScript æ“ä½œäºŒè¿›åˆ¶æ•°æ®çš„ä¸€ä¸ªæ¥å£ è¿™ä¸ªæ¥å£çš„åŸå§‹è®¾è®¡ç›®çš„ï¼Œä¸ WebGL é¡¹ç›®æœ‰å…³ï¼Œä¸æ˜¾å¡äº¤æ¢æ•°æ®ä½¿ç”¨ä¼ ç»Ÿæ–‡æœ¬æ ¼å¼ï¼Œéœ€è¦è½¬æ¢æ•ˆç‡ä½ä¸‹ï¼Œç›´æ¥ä½¿ç”¨äºŒè¿›åˆ¶äº¤æµï¼Œæ•ˆç‡é«˜ ç¼–ç¨‹é£æ ¼å—çº§ä½œç”¨åŸŸ let å–ä»£ var 123456789'use strict';if (true) &#123; let x = 'hello';&#125;for (let i = 0; i &lt; 10; i++) &#123; console.log(i);&#125; åœ¨å…¨å±€ç¯å¢ƒï¼Œä¸åº”è¯¥è®¾ç½®å˜é‡ï¼Œåªåº”è®¾ç½®å¸¸é‡ã€‚å»ºè®®ä¼˜å…ˆä½¿ç”¨const æ‰€æœ‰çš„å‡½æ•°éƒ½åº”è¯¥è®¾ç½®ä¸ºå¸¸é‡123456789101112// badvar a = 1, b = 2, c = 3;// goodconst a = 1;const b = 2;const c = 3;// bestconst [a, b, c] = [1, 2, 3];const add=(x,y)=&gt;x+y; å­—ç¬¦ä¸² é™æ€å­—ç¬¦ä¸²ä¸€å¾‹ä½¿ç”¨å•å¼•å·æˆ–åå¼•å·ï¼Œä¸ä½¿ç”¨åŒå¼•å·ã€‚åŠ¨æ€å­—ç¬¦ä¸²ä½¿ç”¨åå¼•å·ã€‚1234567891011// badconst a = "foobar";const b = 'foo' + a + 'bar';// acceptableconst c = `foobar`;// goodconst a = 'foobar';const b = `foo$&#123;a&#125;bar`;const c = 'foobar'; è§£æ„èµ‹å€¼ ä½¿ç”¨æ•°ç»„æˆå‘˜å¯¹å˜é‡èµ‹å€¼æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨è§£æ„èµ‹å€¼ã€‚ 12345678const arr = [1, 2, 3, 4];// badconst first = arr[0];const second = arr[1];// goodconst [first, second] = arr; å‡½æ•°çš„å‚æ•°å¦‚æœæ˜¯å¯¹è±¡çš„æˆå‘˜ï¼Œä¼˜å…ˆä½¿ç”¨è§£æ„èµ‹å€¼ã€‚ 1234567891011121314// badfunction getFullName(user) &#123; const firstName = user.firstName; const lastName = user.lastName;&#125;// goodfunction getFullName(obj) &#123; const &#123; firstName, lastName &#125; = obj;&#125;// bestfunction getFullName(&#123; firstName, lastName &#125;) &#123;&#125; å¦‚æœå‡½æ•°è¿”å›å¤šä¸ªå€¼ï¼Œä¼˜å…ˆä½¿ç”¨å¯¹è±¡çš„è§£æ„èµ‹å€¼ï¼Œè€Œä¸æ˜¯æ•°ç»„çš„è§£æ„èµ‹å€¼ã€‚è¿™æ ·ä¾¿äºä»¥åæ·»åŠ è¿”å›å€¼ï¼Œä»¥åŠæ›´æ”¹è¿”å›å€¼çš„é¡ºåº 1234567891011// badfunction processInput(input) &#123; return [left, right, top, bottom];&#125;// goodfunction processInput(input) &#123; return &#123; left, right, top, bottom &#125;;&#125;const &#123; left, right &#125; = processInput(input); å¯¹è±¡ å¤šè¡Œå®šä¹‰çš„å¯¹è±¡ï¼Œæœ€åä¸€ä¸ªæˆå‘˜ä»¥é€—å·ç»“å°¾ã€‚ 12345678910111213// badconst a = &#123; k1: v1, k2: v2, &#125;;const b = &#123; k1: v1, k2: v2&#125;;// goodconst a = &#123; k1: v1, k2: v2 &#125;;const b = &#123; k1: v1, k2: v2,&#125;; å¯¹è±¡å°½é‡é™æ€åŒ–ï¼Œä¸€æ—¦å®šä¹‰ï¼Œå°±ä¸å¾—éšæ„æ·»åŠ æ–°çš„å±æ€§ã€‚å¦‚æœæ·»åŠ å±æ€§ä¸å¯é¿å…ï¼Œè¦ä½¿ç”¨Object.assignæ–¹æ³• 1234567891011// badconst a = &#123;&#125;;a.x = 3;// if reshape unavoidableconst a = &#123;&#125;;Object.assign(a, &#123; x: 3 &#125;);// goodconst a = &#123; x: null &#125;;a.x = 3; å¦‚æœå¯¹è±¡çš„å±æ€§åæ˜¯åŠ¨æ€çš„ï¼Œå¯ä»¥åœ¨åˆ›é€ å¯¹è±¡çš„æ—¶å€™ï¼Œä½¿ç”¨å±æ€§è¡¨è¾¾å¼å®šä¹‰ 12345678910111213// badconst obj = &#123; id: 5, name: 'San Francisco',&#125;;obj[getKey('enabled')] = true;// goodconst obj = &#123; id: 5, name: 'San Francisco', [getKey('enabled')]: true,&#125;; å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œå°½é‡é‡‡ç”¨ç®€æ´è¡¨è¾¾æ³•ï¼Œè¿™æ ·æ˜“äºæè¿°å’Œä¹¦å†™ 1234567891011121314151617181920212223var ref = 'some value';// badconst atom = &#123; ref: ref, value: 1, addValue: function (value) &#123; return atom.value + value; &#125;,&#125;;// goodconst atom = &#123; ref, value: 1, addValue(value) &#123; return atom.value + value; &#125;,&#125;; æ•°ç»„ ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼ˆâ€¦ï¼‰æ‹·è´æ•°ç»„ 1234567891011// badconst len = items.length;const itemsCopy = [];let i;for (i = 0; i &lt; len; i++) &#123; itemsCopy[i] = items[i];&#125;// goodconst itemsCopy = [...items]; Array.fromæ–¹æ³•ï¼Œå°†ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡è½¬ä¸ºæ•°ç»„ã€‚ 12const foo = document.querySelectorAll('.foo');const nodes = Array.from(foo); å‡½æ•° ç«‹å³æ‰§è¡Œå‡½æ•°å¯ä»¥å†™æˆç®­å¤´å‡½æ•°çš„å½¢å¼ 123(() =&gt; &#123; console.log('Welcome to the Internet.');&#125;)(); é‚£äº›éœ€è¦ä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼çš„åœºåˆï¼Œå°½é‡ç”¨ç®­å¤´å‡½æ•°ä»£æ›¿ 123456789101112// bad[1, 2, 3].map(function (x) &#123; return x * x;&#125;);// good[1, 2, 3].map((x) =&gt; &#123; return x * x;&#125;);// best[1, 2, 3].map(x =&gt; x * x); ç®­å¤´å‡½æ•°å–ä»£Function.prototype.bindï¼Œä¸åº”å†ç”¨self/_this/thatç»‘å®š this 1234567891011// badconst self = this;const boundMethod = function(...params) &#123; return method.apply(self, params);&#125;// acceptableconst boundMethod = method.bind(this);// bestconst boundMethod = (...params) =&gt; method.apply(this, params); æ‰€æœ‰é…ç½®é¡¹éƒ½åº”è¯¥é›†ä¸­åœ¨ä¸€ä¸ªå¯¹è±¡ï¼Œæ”¾åœ¨æœ€åä¸€ä¸ªå‚æ•°ï¼Œå¸ƒå°”å€¼ä¸å¯ä»¥ç›´æ¥ä½œä¸ºå‚æ•° 1234567// badfunction divide(a, b, option = false ) &#123;&#125;// goodfunction divide(a, b, &#123; option = false &#125; = &#123;&#125;) &#123;&#125; ä¸è¦åœ¨å‡½æ•°ä½“å†…ä½¿ç”¨argumentså˜é‡ï¼Œä½¿ç”¨restè¿ç®—ç¬¦ï¼ˆâ€¦ï¼‰ä»£æ›¿ 12345678910// badfunction concatenateAll() &#123; const args = Array.prototype.slice.call(arguments); return args.join('');&#125;// goodfunction concatenateAll(...args) &#123; return args.join('');&#125; ä½¿ç”¨é»˜è®¤å€¼è¯­æ³•è®¾ç½®å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ 123456789// badfunction handleThings(opts) &#123; opts = opts || &#123;&#125;;&#125;// goodfunction handleThings(opts = &#123;&#125;) &#123; // ...&#125; Map åªæœ‰æ¨¡æ‹Ÿç°å®ä¸–ç•Œçš„å®ä½“å¯¹è±¡æ—¶ï¼Œæ‰ä½¿ç”¨Objectã€‚å¦‚æœåªæ˜¯éœ€è¦key: valueçš„æ•°æ®ç»“æ„ï¼Œä½¿ç”¨Mapç»“æ„ã€‚å› ä¸ºMapæœ‰å†…å»ºçš„éå†æœºåˆ¶12345678910111213let map = new Map(arr);for (let key of map.keys()) &#123; console.log(key);&#125;for (let value of map.values()) &#123; console.log(value);&#125;for (let item of map.entries()) &#123; console.log(item[0], item[1]);&#125; Class æ€»æ˜¯ç”¨Classï¼Œå–ä»£éœ€è¦prototypeçš„æ“ä½œï¼› 123456789101112131415161718192021// badfunction Queue(contents = []) &#123; this._queue = [...contents];&#125;Queue.prototype.pop = function() &#123; const value = this._queue[0]; this._queue.splice(0, 1); return value;&#125;// goodclass Queue &#123; constructor(contents = []) &#123; this._queue = [...contents]; &#125; pop() &#123; const value = this._queue[0]; this._queue.splice(0, 1); return value; &#125;&#125; ä½¿ç”¨extendså®ç°ç»§æ‰¿ 12345678910111213141516// badconst inherits = require('inherits');function PeekableQueue(contents) &#123; Queue.apply(this, contents);&#125;inherits(PeekableQueue, Queue);PeekableQueue.prototype.peek = function() &#123; return this._queue[0];&#125;// goodclass PeekableQueue extends Queue &#123; peek() &#123; return this._queue[0]; &#125;&#125; æ¨¡å— Moduleè¯­æ³•æ˜¯JavaScriptæ¨¡å—çš„æ ‡å‡†å†™æ³•ï¼ŒåšæŒä½¿ç”¨è¿™ç§å†™æ³•ã€‚ä½¿ç”¨importå–ä»£requireï¼Œä½¿ç”¨exportå–ä»£module.exportsã€‚ 1234567891011121314151617181920212223242526272829// badconst moduleA = require('moduleA');const func1 = moduleA.func1;const func2 = moduleA.func2;// goodimport &#123; func1, func2 &#125; from 'moduleA';// commonJSçš„å†™æ³•var React = require('react');var Breadcrumbs = React.createClass(&#123; render() &#123; return &lt;nav /&gt;; &#125;&#125;);module.exports = Breadcrumbs;// ES6çš„å†™æ³•import React from 'react';class Breadcrumbs extends React.Component &#123; render() &#123; return &lt;nav /&gt;; &#125;&#125;;export default Breadcrumbs; å¦‚æœæ¨¡å—åªæœ‰ä¸€ä¸ªè¾“å‡ºå€¼ï¼Œå°±ä½¿ç”¨export defaultï¼Œå¦‚æœæ¨¡å—æœ‰å¤šä¸ªè¾“å‡ºå€¼ï¼Œå°±ä¸ä½¿ç”¨export defaultï¼Œexport defaultä¸æ™®é€šçš„exportä¸è¦åŒæ—¶ä½¿ç”¨ 12345678910111213// badconst add=(x,y)=&gt;x+y;const PI=3.14;export add;export default PI;// goodconst add=(x,y)=&gt;x+y;const PI=3.14;export add;export PI; ä¸è¦åœ¨æ¨¡å—è¾“å…¥ä¸­ä½¿ç”¨é€šé…ç¬¦ã€‚å› ä¸ºè¿™æ ·å¯ä»¥ç¡®ä¿ä½ çš„æ¨¡å—ä¹‹ä¸­ï¼Œæœ‰ä¸€ä¸ªé»˜è®¤è¾“å‡ºï¼ˆexport defaultï¼‰ã€‚å› ä¸ºimport *ä¼šå¿½ç•¥æ¨¡å—çš„é»˜è®¤å€¼ 12345// badimport * as myObject from './importModule';// goodimport myObject from './importModule'; ä¸œè¥¿å¾ˆå¤šï¼Œå…ˆåšä¸ªå¤§æ¦‚äº†è§£ï¼ŒåæœŸç”¨åˆ°å†åšæ›´åŠ ç»†è‡´çš„äº†è§£ã€‚ä»¥ä¸Šã€‚]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>ES6</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Deferred_Promise]]></title>
    <url>%2F2017%2F09%2F07%2FDeferred-Promise%2F</url>
    <content type="text"><![CDATA[åœ¨æœ€è¿‘é¡¹ç›®ä¸­ç»å¸¸ä¼šé‡åˆ°å¼‚æ­¥å¤„ç†çš„ç›¸å…³é—®é¢˜ï¼Œåœ¨æŸ¥é˜…ç›¸å…³èµ„æ–™åï¼Œç‰¹åœ¨æ­¤åšä¸€ç¯‡ç¬”è®°ã€‚ ä½¿ç”¨Deferredã€Promiseè§£å†³jQueryä¸­å¼‚æ­¥ç›¸å…³é—®é¢˜é—®é¢˜ ABCæ˜¯3ä¸ªå¼‚æ­¥è¯·æ±‚ï¼Œç°åœ¨è¦æ±‚Cåœ¨ABä¸‰ä¸ªå¼‚æ­¥è¯·æ±‚éƒ½æˆåŠŸè¿”å›çš„æƒ…å†µä¸‹å†æ‰§è¡Œã€‚è¿™ç§å°±æ¯”è¾ƒéº»çƒ¦ï¼Œå¯ä»¥å°è¯•è®¾ç½®è¯·æ±‚å®ŒæˆçŠ¶æ€å˜é‡ï¼Œå½“ABçš„è¯·æ±‚å®Œæˆå˜é‡éƒ½trueæ—¶å†è¯·æ±‚Cï¼›å¦‚æœä¸åª3ä¸ªè¯·æ±‚ï¼Œè¿™ç§æ–¹æ³•å°±ä¼šå¾ˆç³Ÿç³•ã€‚ ABCæ˜¯3ä¸ªå¼‚æ­¥è¯·æ±‚ï¼Œç°åœ¨è¦æ±‚ABC3ä¸ªè¯·æ±‚æŒ‰é¡ºåºä¾æ¬¡æ‰§è¡Œï¼ŒA-&gt;B-&gt;Cã€‚è¿™ç§ç”¨ä¼ ç»Ÿæ–¹æ³•å¯èƒ½å°±éœ€è¦ç”¨å›è°ƒåµŒå¥—çš„æ–¹æ³•æ¥å®ç° ä»¥ä¸Šä¸¤ç§æƒ…å†µæ˜¯åœ¨å¼‚æ­¥ä¸­ç»å¸¸é‡åˆ°çš„ï¼Œç”¨ä¼ ç»Ÿæ–¹æ³•ç¼–å†™ï¼Œä¼šå¯¼è‡´åµŒå¥—å±‚æ¬¡è¿‡å¤šï¼Œä¸ä»…å½±å“å¯è¯»æ€§ï¼Œè¿˜ä¸æ˜“äºç»´æŠ¤ã€‚ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ï¼ŒCommonJsç»„ç»‡åˆ¶å®šäº†å¼‚æ­¥ç¼–ç¨‹è§„èŒƒPromises/Aã€‚è¿™ä¸ªè§„èŒƒæœ‰å¾ˆå¤šå®ç°ï¼Œå¦‚when.jsã€ES6çš„Promiseç­‰ã€‚ä»Šå¤©å°±å€ŸåŠ©jQueryçš„Deferredã€Promiseå¯¹è±¡æ¥åšä¸ªç®€å•äº†è§£ã€‚ PromiseçŠ¶æ€Promiseå¯¹è±¡å­˜åœ¨3ç§çŠ¶æ€ pending(æœªå®ŒæˆçŠ¶æ€) resolved(è‚¯å®šçŠ¶æ€) rejected(å¦å®šçŠ¶æ€) è¿™ä¸‰ç§çŠ¶æ€çš„è½¬æ¢å…³ç³» pending-&gt;resolved pending-&gt;rejected pending-&gt;pending å½“è½¬æ¢åˆ°resolvedæˆ–è€…rejectedçŠ¶æ€æ—¶ï¼ŒçŠ¶æ€æ˜¯æ— æ³•å†å‘ç”Ÿå˜åŒ–ï¼Œå³ä¸‹é¢çš„çŠ¶æ€è½¬æ¢éƒ½æ˜¯ä¸å¯è¡Œçš„ resolved-&gt;rejected resolved-&gt;pending rejected-&gt;resolved rejected-&gt;pending åˆ›å»ºä¸€ä¸ªPromiseå¯¹è±¡åœ¨jQueryä¸­Deferredå¯ä»¥ç†è§£ä¸ºPromiseçš„åŠ å¼ºç‰ˆï¼Œå…ˆä¸åšåŒºåˆ†ï¼Œå¯ä»¥å°†Deferredå½“æˆå°±æ˜¯Promiseï¼Œåé¢ä¼šä»‹ç»äºŒè€…åŒºåˆ«ã€‚123456789var dfr=$.Deferred();// åˆ›å»ºä¸€ä¸ªDeferredå¯¹è±¡(å°±æ˜¯Promiseå¯¹è±¡)console.log(dfr.state());// è·å–å½“å‰çŠ¶æ€,pendingdfr.resolve();// å°†Deferredå¯¹è±¡çŠ¶æ€æ”¹å˜ä¸ºresolvedconsole.log(dfr.state());// resolvedvar dfr2=$.Deferred();console.log(dfr2.state());// è·å–å½“å‰çŠ¶æ€,pendingdfr.reject();// å°†Deferredå¯¹è±¡çŠ¶æ€æ”¹å˜ä¸ºrejectedconsole.log(dfr2.state());// rejected çŠ¶æ€çš„ä½œç”¨ é€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå¯ä»¥äººä¸ºçš„æ”¹å˜Deferredå¯¹è±¡çš„çŠ¶æ€ã€‚çŠ¶æ€ä¸ä¸€æ ·æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥æ ¹æ®ä¸åŒçš„çŠ¶æ€è¿›è¡Œä¸åŒçš„æ“ä½œ(æ·»åŠ ä¸åŒçš„å›è°ƒå‡½æ•°)ã€‚ ç»™Promiseå¯¹è±¡æ·»åŠ å›è°ƒæ·»åŠ å›è°ƒï¼Œå¹¶è§¦å‘12345678910111213var dfr=$.Deferred();// åˆ›å»ºDeferredå¯¹è±¡dfr.done(function()&#123;// Deferredå¯¹è±¡çŠ¶æ€å˜ä¸ºresolvedæ—¶çš„å›è°ƒ alert('æˆåŠŸ');&#125;).fail(function()&#123;// Deferredå¯¹è±¡çŠ¶æ€å˜ä¸ºrejectæ—¶çš„å›è°ƒ alert('å¤±è´¥');&#125;).progress(function()&#123;// Deferredå¯¹è±¡çŠ¶æ€ä¸ºpendingæ—¶çš„å›è°ƒ alert('è¿›è¡Œä¸­...');&#125;);dfr.notify(); // è§¦å‘Deferredå¯¹è±¡pendingçŠ¶æ€çš„å›è°ƒdfr.resolve();// è§¦å‘Deferredå¯¹è±¡resolvedçŠ¶æ€çš„å›è°ƒ é€šè¿‡done()ã€fail()ã€progress()ç»™Deferredå¯¹è±¡çš„ä¸åŒçŠ¶æ€åˆ†åˆ«æ·»åŠ äº†å›è°ƒï¼Œå¹¶é€šè¿‡notify()ã€resolveè§¦å‘äº†å“åº”çš„å›è°ƒ ä¼ é€’æ•°æ® é€šè¿‡done()ã€fail()ã€progress()è§¦å‘Deferredå¯¹è±¡çš„å›è°ƒæ—¶ï¼Œå¯ä¼ é€’ä¸€äº›æ•°æ®(ä»»ä½•ç±»å‹)ç»™å›è°ƒå‡½æ•°12345678910111213var dfr2=$.Deferred();// åˆ›å»ºDeferredå¯¹è±¡dfr2.done(function(msg)&#123;// Deferredå¯¹è±¡çŠ¶æ€å˜ä¸ºresolvedæ—¶çš„å›è°ƒ alert(msg+'æˆåŠŸ');&#125;).fail(function(msg)&#123;// Deferredå¯¹è±¡çŠ¶æ€å˜ä¸ºrejectæ—¶çš„å›è°ƒ alert(msg+'å¤±è´¥');&#125;).progress(function(msg)&#123;// Deferredå¯¹è±¡çŠ¶æ€ä¸ºpendingæ—¶çš„å›è°ƒ alert(msg+'è¿›è¡Œä¸­...');&#125;);dfr2.notify('dfr2'); // dfr2è¿›è¡Œä¸­...dfr2.reject('dfr2');// dfr2å¤±è´¥ é“¾å¼è°ƒç”¨ done()ã€fail()ã€progress()ä¼šè¿”å›è°ƒç”¨è€…å¯¹è±¡Deferredå¯¹è±¡ï¼Œå› æ­¤å¯ä»¥è¿›è¡Œæ— é™çš„é“¾å¼è°ƒç”¨ï¼›å¯ä»¥åœ¨done()åå†æ·»åŠ done()ã€fail()ã€progress()ï¼Œä»–ä»¬ä¼šåœ¨å¯¹åº”çŠ¶æ€è¢«æ¿€æ´»æ—¶ï¼Œä¾æ¬¡æŒ‰ç…§æ·»åŠ é¡ºåºè°ƒç”¨ã€‚12345678910111213141516var dfr=$.Deferred();dfr.done(function()&#123; // å›è°ƒ1 alert('æˆåŠŸ1');&#125;).fail(function()&#123; alert('å¤±è´¥');&#125;).progress(function()&#123; alert('è¿›è¡Œä¸­...');&#125;).done(function()&#123;// å›è°ƒ2 alert('æˆåŠŸ2');&#125;);dfr.resolve();// æˆåŠŸ1-&gt;æˆåŠŸ2 deferred.always() é€šè¿‡deferred.always()æ·»åŠ çš„å›è°ƒï¼Œæ— è®ºçŠ¶æ€æ˜¯resolvedè¿˜æ˜¯rejectedéƒ½ä¼šåœ¨æœ€åè¢«è°ƒç”¨12345678910111213141516var dfr=$.Deferred();dfr.done(function()&#123;// alert('æˆåŠŸ1');&#125;).fail(function()&#123; alert('å¤±è´¥');&#125;).progress(function()&#123; alert('è¿›è¡Œä¸­...');&#125;).always(function()&#123; alert('æˆ‘æ€»ä¼šè¢«æ‰§è¡Œ');&#125;);dfr.resolve();// æˆåŠŸ1-&gt;æˆ‘æ€»ä¼šè¢«æ‰§è¡Œ Deferredå¯¹è±¡ä½¿ç”¨æ–¹å¼1234567891011var dfr = $.Deferred();// åˆ›å»ºä¸€ä¸ªDeferredå¯¹è±¡var task = function(dtd) &#123; setTimeout(function() &#123; console.log('timeOut'); dtd.resolve(); // å¼‚æ­¥ä»»åŠ¡ç»“æŸï¼Œæ‰‹åŠ¨resolve &#125;, 3000); return dtd;// è¿”å›Deferredå¯¹è±¡ï¼Œä¾›$.when()ä½¿ç”¨&#125;;$.when(task(dfr)).done(function() &#123; alert('success');// 3såå¼¹å‡º&#125;); ä¸Šé¢ä¾‹å­ç”±äºdfræ˜¯å…¨å±€å¯¹è±¡ï¼Œå¹¶ä¸”åŒ…å«æ”¹å˜çŠ¶æ€çš„æ–¹æ³•resolveã€rejectï¼Œæ‰€ä»¥å¯ä»¥åœ¨å¤–éƒ¨æå‰ç»ˆæ­¢ä»»åŠ¡ 123456789101112var dfr = $.Deferred();// åˆ›å»ºä¸€ä¸ªDeferredå¯¹è±¡var task = function(dtd) &#123; setTimeout(function() &#123; console.log('timeOut'); dtd.resolve(); // å¼‚æ­¥ä»»åŠ¡ç»“æŸï¼Œæ‰‹åŠ¨resolve &#125;, 3000); return dtd;// è¿”å›Deferredå¯¹è±¡ï¼Œä¾›$.when()ä½¿ç”¨&#125;;$.when(task(dfr)).done(function() &#123; alert('success');// ç«‹å³å¼¹å‡º&#125;);dfr.resolve();// å¤–éƒ¨resolveåä¼šç«‹å³æ‰§è¡Œdone é˜²æ­¢å¤–éƒ¨ç»ˆæ­¢ï¼Œå¯ä»¥å°†å…¨å±€çš„dfræ”¾åˆ°å‡½æ•°å†…éƒ¨ 123456789101112var task = function() &#123; var dfr = $.Deferred();// åˆ›å»ºä¸€ä¸ªDeferredå¯¹è±¡ setTimeout(function() &#123; console.log('timeOut'); dfr.resolve(); // å¼‚æ­¥ä»»åŠ¡ç»“æŸï¼Œæ‰‹åŠ¨resolve &#125;, 3000); return dfr;// è¿”å›Deferredå¯¹è±¡ï¼Œä¾›$.when()ä½¿ç”¨&#125;;$.when(task()).done(function() &#123; alert('success');// ç«‹å³å¼¹å‡º&#125;);dfr.resolve();// æ— æ³•è°ƒç”¨ jQueryä¸­Deferredå’ŒPromiseçš„åŒºåˆ« Deferredå¯¹è±¡å¯ä»¥ç†è§£ä¸ºPromiseå¯¹è±¡çš„åŠ å¼ºç‰ˆã€‚ Deferredå¯¹è±¡åŒ…å«æ”¹å˜çŠ¶æ€çš„æ–¹æ³•ï¼Œå¦‚dfr.resolve()ã€dfr.reject()ã€dfr.notify() Promiseå¯¹è±¡åˆ™ä¸åŒ…å«ä»¥ä¸Šæ–¹æ³•ï¼› è¦æƒ³æ”¹å˜çŠ¶æ€å¿…é¡»åœ¨Deferredå¯¹è±¡ä¸Šè°ƒç”¨ç›¸å…³æ–¹æ³•ï¼ŒPromiseå¯¹è±¡æ²¡æœ‰ç›¸å…³æ–¹æ³•ã€‚ é€šè¿‡deferred.promise()å¯ä»¥å°†Deferredå¯¹è±¡è½¬æ¢ä¸ºPromiseå¯¹è±¡ åœ¨ajaxä¸­ä½¿ç”¨Promiseajaxå’ŒPromiseçš„å…³ç³» åœ¨jQuery1.5ä¹‹å‰$.ajax()è¿”å›çš„æ˜¯ä¸€ä¸ªjqXHRå¯¹è±¡ï¼Œ1.5ä¹‹åè¿”å›çš„æ˜¯ä¸€ä¸ªç±»Promiseå¯¹è±¡ï¼Œå®ƒåœ¨åŸå…ˆçš„jqXHRå¯¹è±¡åŸºç¡€ä¸Šåˆæ·»åŠ ä¸€äº›Promiseæ–¹æ³•ï¼Œå› æ­¤æˆ‘ä»¬èƒ½åœ¨$.ajax()ä¹‹åé“¾å¼è°ƒç”¨Promiseç›¸å…³æ–¹æ³•ï¼› æ³¨æ„è¿”å›çš„æ˜¯ä¸€ä¸ªç±»Promiseå¯¹è±¡ï¼Œå› æ­¤å®ƒä¸åŒ…å«æ”¹å˜çŠ¶æ€çš„ç›¸å…³æ–¹æ³•ï¼› æ”¹å˜ç›¸å…³çŠ¶æ€ç”±ajaxå†…éƒ¨å®Œæˆï¼Œæ— éœ€æ‰‹åŠ¨è°ƒç”¨ç›¸å…³æ–¹æ³•(ä¹Ÿæ— æ³•è°ƒç”¨)ï¼›1234567891011121314151617// è€çš„ajaxå†™æ³• $.ajax(&#123; url: "a.html", success: function()&#123; alert("æˆåŠŸ"); &#125;, error:function()&#123; alert("é”™è¯¯"); &#125; &#125;); // ä½¿ç”¨promiseåçš„å†™æ³• $.ajax("test.html") .done(function()&#123;&#125;) .fail(function()&#123;&#125;) .done(function()&#123;&#125;) .fail(function()&#123;&#125;); è§£å†³é—®é¢˜1 é—®é¢˜1è¦æ±‚Cåœ¨ABéƒ½æ‰§è¡Œå®Œåå†æ‰§è¡Œã€‚å³A&amp;&amp;B-&gt;Cï¼›è¿™æ—¶å€™å°±éœ€è¦ä½¿ç”¨jQueryæä¾›çš„$.when()å‡½æ•°ã€‚$.when()è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ã€‚æ‰€ä»¥å¯ä»¥è°ƒç”¨doneã€failã€progressç­‰å‡½æ•° 12345678$.when($.ajax(url1),$.ajax(url2)).done(function()&#123; console.log('url1ã€url2éƒ½è¯·æ±‚æˆåŠŸ'); $.ajax(url3)&#125;).fail(function()&#123; console.log('url1ã€url2æœ‰ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªæ²¡è¯·æ±‚æˆåŠŸ');&#125;); $.when()å®ç°äº†å¤šä¸ªajaxè¯·æ±‚å®Œæˆåå†æ‰§è¡ŒæŸäº›æ“ä½œï¼›å³å®ç°äº†A&amp;&amp;B-&gt;Cçš„æ•ˆæœ è§£å†³é—®é¢˜2 é—®é¢˜2çš„è¦æ±‚æ˜¯ABC3ä¸ªå¼‚æ­¥è¯·æ±‚é¡ºåºæ‰§è¡Œã€‚ä¼ ç»Ÿå†™æ³•å¯èƒ½æ˜¯ 1234567891011121314$.ajax(&#123; url:'a.json', success:function()&#123; $.ajax(&#123; url:'b.json', success:function()&#123; $.ajax(&#123; url:'c.json', success:function()&#123; console.log('gg'); &#125; &#125; &#125;&#125;); å¯è¯»æ€§å¾ˆå·®ï¼Œè¿˜ä¸æ–¹ä¾¿ç»´æŠ¤ã€‚ä¸ºè§£å†³é—®é¢˜2éœ€è¦ä½¿ç”¨åˆ°jQueryæä¾›çš„Deferred.then()æ–¹æ³•ï¼› thenæ–¹æ³•å¯ä»¥ä¼ å…¥3ä¸ªå›è°ƒï¼Œåˆ†åˆ«æ˜¯resolvedã€rejectedã€pendingçŠ¶æ€çš„å›è°ƒï¼› 123456789101112131415161718192021222324252627function success(data) &#123; alert("success data = " + data); &#125; function fail(data) &#123; alert("fail data = " + data); &#125; function progress(data) &#123; alert("progress data = " + data); &#125; var deferred = $.Deferred(); // ä¸€èµ·æ³¨å†Œå›è°ƒ deferred.then(success, fail, progress); // åˆ†åˆ«æ³¨å†Œå›è°ƒ deferred.done(success); deferred.fail(fail); deferred.progress(progress); deferred.notify("10%"); deferred.resolve("ok"); å…¶å®åœ¨æ‰§è¡Œthenæ–¹æ³•åå°†è¿”å›ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡ å¯ä»¥åœ¨åé¢æ— é™çº§è”è°ƒç”¨ç›¸å…³Promiseæ–¹æ³•.then().then().done().fail()â€¦. è¿™å°±æ„å‘³ç€åœ¨thenåå°±æ— æ³•åœ¨è¿”å›å¯¹è±¡(è¿”å›çš„æ˜¯Promiseå¯¹è±¡)ä¸Šæ‰‹åŠ¨æ”¹å˜çŠ¶æ€äº†ã€‚ å¿…é¡»åœ¨åŸå…ˆçš„Deferredå¯¹è±¡ä¸Šè°ƒç”¨æ–¹æ³•æ”¹å˜çŠ¶æ€12345678910111213141516171819202122232425function success(data) &#123; alert("success data = " + data); &#125; function fail(data) &#123; alert("fail data = " + data); &#125; function progress(data) &#123; alert("progress data = " + data); &#125; var dfr=$.Deferred();var pro=dfr.then(success,fail,progress);console.log(dfr===pro);// false// æ²¡æœ‰æ”¹å˜çŠ¶æ€çš„æ–¹æ³•console.log('resolve' in pro); // falseconsole.log('reject' in pro); // falseconsole.log('notify' in pro); // false// åªèƒ½åœ¨åŸå…ˆçš„Deferredå¯¹è±¡è°ƒç”¨ç›¸å…³æ–¹æ³•dfr.resolve('resolved'); // success data = resolved å…¶å®then()ä¸­ä¼ å…¥çš„ä¸æ˜¯å›è°ƒå‡½æ•°ï¼Œå®˜æ–¹è¯´æ³•åˆå«åšè¿‡æ»¤å‡½æ•°ï¼›å‰é¢è¯´è¿‡Deferredå¯¹è±¡åœ¨è°ƒç”¨æ”¹å˜çŠ¶æ€æ–¹æ³•æ—¶ï¼Œå¯ä»¥ä¼ é€’æ•°æ®ï¼Œå…¶å®é€šè¿‡thenæ³¨å†Œçš„å›è°ƒå¯ä»¥å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤ï¼Œç„¶åé€šè¿‡returnå°†æ•°æ®ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå›è°ƒå‡½æ•°(doneã€failã€progress)ï¼Œå¦‚æœä¸‹ä¸€ä¸ªå›è°ƒå‡½æ•°æ˜¯é€šè¿‡thenæ³¨å†Œçš„ï¼Œåˆ™å¯ä»¥ç»§ç»­å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤ï¼Œå¹¶ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå¯¹åº”çŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼› æˆ‘ä»¬çŸ¥é“deferred.resolve()ã€deferred.reject()ã€deferred.notify()å¯ä»¥æŒ‡å®šå‚æ•°å€¼ï¼Œè¿™ä¸ªå‚æ•°ä¼šä¼ é€’ç»™ç›¸åº”çŠ¶æ€ä¸‹çš„å›è°ƒå‡½æ•°ã€‚ å¦‚æœæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯done()ã€fail()ã€progress()æ³¨å†Œçš„å›è°ƒå‡½æ•°ï¼Œé‚£ä¹ˆæŸä¸ªçŠ¶æ€ä¸‹çš„æ‰€æœ‰å›è°ƒå‡½æ•°å¾—åˆ°çš„éƒ½æ˜¯ç›¸åŒå‚æ•°ã€‚ ä¸æ˜¯é€šè¿‡thenæ³¨å†Œçš„å›è°ƒå‡½æ•°ï¼Œæ— æ³•å¯¹æ•°æ®è¿‡æ»¤å¹¶é€šè¿‡returnä¼ é€’ç»™ä¸‹ä¸€ä¸ªå›è°ƒï¼Œä»–ä»¬å¾—åˆ°çš„éƒ½æ˜¯ç›¸åŒå€¼ï¼Œå¯çœ‹ä¸‹é¢ä¾‹å­ 1234567891011121314var dfr = $.Deferred();dfr.done(function(type) &#123; console.log(type);// resolved return type + 'first';&#125;).done(function(type) &#123; console.log(type);// resolved return type + 'last';&#125;).done(function(type) &#123; console.log(type);// resolved&#125;);dfr.resolve('resolved'); ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä½¿ç”¨äº†then()æ³¨å†Œå›è°ƒå‡½æ•°ï¼Œé‚£ä¹ˆç¬¬ä¸€å›è°ƒå‡½æ•°çš„è¿”å›å€¼å°†ä½œä¸ºç¬¬äºŒä¸ªå›è°ƒå‡½æ•°çš„å‚æ•°ï¼ŒåŒæ ·çš„ç¬¬äºŒä¸ªå‡½æ•°çš„è¿”å›å€¼æ˜¯ç¬¬ä¸‰ä¸ªå›è°ƒå‡½æ•°çš„å‚æ•°ã€‚ 12345678910111213141516var deferred = $.Deferred(); // then()è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°Promiseå¯¹è±¡ //thenæ³¨å†Œçš„å›è°ƒå‡½æ•°çš„è¿”å›å€¼å°†ä½œä¸ºè¿™ä¸ªæ–°Promiseçš„å‚æ•° var then_ret = deferred.then(function(data)&#123; alert("data="+data);//5 å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤ return 2 * data; // å¹¶é€šè¿‡return ä¼ é€’ç»™ä¸‹ä¸€ä¸ªdone&#125;); alert(then_ret == deferred);//false then_ret.done(function(data)&#123; alert("data="+data);//10 &#125;); deferred.resolve( 5 ); å¦‚æœä»”ç»†è§‚å¯Ÿï¼Œä¼šå‘ç°åœ¨ä¸Šé¢ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬è¿”å›çš„æ˜¯æ™®é€šå€¼ï¼Œå¦‚æœæˆ‘ä»¬è¿”å›çš„æ˜¯Deferredæˆ–è€…Promiseå¯¹è±¡ï¼Œå®ƒä¼šå°†è¿”å›çš„Deferredã€Promiseå¯¹è±¡çš„çŠ¶æ€å’Œè¿”å›å€¼ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œåšä¸ºå…¶è§¦å‘ä¾æ®å’Œå‚æ•°ã€‚å¯ä»¥ç”¨è¿™ç§æ–¹æ³•è§£å†³é—®é¢˜2 12345678910var promise1 = $.ajax(url1); var promise2 = promise1.then(function(data)&#123; return $.ajax(url2, &#123; "data": data &#125;);// è¿”å›ä¸€ä¸ªpromiseï¼Œå®ƒçš„çŠ¶æ€å°†å†³å®šè§¦å‘promise2.thenä¸­çš„å“ªä¸ªå›è°ƒï¼Œå®ƒçš„è¿”å›å€¼å°†ä¼ é€’ç»™å¯¹åº”çš„å›è°ƒå‡½æ•°&#125;); var promise3 = promise2.then(function(data)&#123; return $.ajax(url3);// è¿”å›ä¸€ä¸ªpromiseï¼Œå®ƒçš„çŠ¶æ€å°†å†³å®šè§¦å‘promise3ä¸­çš„å“ªä¸ªå›è°ƒï¼Œå®ƒçš„è¿”å›å€¼å°†ä¼ é€’ç»™å¯¹åº”çš„å›è°ƒå‡½æ•°&#125;); promise3.done(function(data)&#123; console.log(data);&#125;); è¿™æ ·å…¶å®æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªèŒƒå¼ï¼Œå¤„ç†æœ‰ä¾èµ–å…³ç³»çš„å¼‚æ­¥è¯·æ±‚æ—¶ï¼Œå¯ä»¥.then().then().done().fail()ï¼Œé€šè¿‡thenä¸­çš„å›è°ƒ(è¿‡æ»¤)å‡½æ•°ï¼Œå¯¹æ•°æ®è¿›è¡ŒåŠ å·¥ï¼Œæœ€åäº¤ç»™ä¸æ˜¯é€šè¿‡thenæ³¨å†Œçš„doneæˆ–è€…failæ¥è¿›è¡Œæœ€åå¤„ç†ï¼›doneå…¶å®å°±é¢„ç¤ºç€å¯¹ä¼ è¿‡æ¥çš„æ•°æ®ä¸è¿›è¡ŒåŠ å·¥äº†ï¼› æ€»ç»“ jQueryä¸­çš„Deferredã€Promiseå¯¹è±¡ä¸»è¦ç”¨æ¥è§£å†³å¼‚æ­¥ä»»åŠ¡ä¸­åµŒå¥—é—®é¢˜ Deferredå¯ä»¥ç†è§£ä¸ºPromiseå¯¹è±¡çš„åŠ å¼ºç‰ˆ Deferredå¯¹è±¡æ‹¥æœ‰æ–¹æ³•resolveã€rejectã€notifyæ¥æ‰‹åŠ¨æ”¹å˜çŠ¶æ€ Promiseå¯¹è±¡æ— æ³•æ‰‹åŠ¨æ”¹å˜çŠ¶æ€ deferred.promise()å¯ä»¥å°†ä¸€ä¸ªDeferredå¯¹è±¡è½¬æ¢æˆPromiseå¯¹è±¡ jQueryä¸­å¼‚æ­¥ä»»åŠ¡è¿”å›çš„éƒ½æ˜¯Promiseå¯¹è±¡æˆ–è€…ç±»Promiseå¯¹è±¡(ajaxè¿”å›çš„)ï¼Œå®ƒä»¬éƒ½æ— æ³•æ‰‹åŠ¨æ”¹å˜çŠ¶æ€ï¼Œå®ƒä»¬çŠ¶æ€çš„æ”¹å˜æ˜¯jQueryåœ¨å†…éƒ¨è‡ªåŠ¨å®Œæˆçš„ $.Deferred()è¿”å›ä¸€ä¸ªDeferredå¯¹è±¡ deferred.doneã€deferred.failã€deferred.progressç”¨æ¥å®šä¹‰Deferredå¯¹è±¡çŠ¶æ€å¯¹åº”çš„å›è°ƒå‡½æ•° deferred.always()æ¥ç”¨å®šä¹‰æ— è®ºæˆåŠŸè¿˜æ˜¯å¤±è´¥éƒ½ä¼šè°ƒç”¨å›è°ƒå‡½æ•° deferred.resolve()ã€deferred.reject()æ‰‹åŠ¨æ”¹å˜Deferredå¯¹è±¡çš„çŠ¶æ€ æ”¹å˜çŠ¶æ€æ—¶ï¼Œå¯ä»¥ä¼ é€’æ•°æ®ç»™å›è°ƒå‡½æ•° deferred.resolve(â€˜msgâ€™) é˜²æ­¢æ”¹å˜çŠ¶æ€æ–¹æ³•åœ¨å¼‚æ­¥ä»»åŠ¡å¤–è°ƒç”¨ å¯å°†Deferredå¯¹è±¡å®šä¹‰ä¸ºå¼‚æ­¥ä»»åŠ¡å†…çš„å±€éƒ¨å˜é‡ å¯ä»¥ä½¿ç”¨deferred.promise()è½¬æ¢æˆPromiseå¯¹è±¡ deferred.notify()ç”¨æ¥è§¦å‘deferred.progresså®šä¹‰çš„å›è°ƒå‡½æ•°ï¼Œå®é™…å¯ä»¥ç”¨æ¥å®Œæˆè¿›åº¦æ¡æ•ˆæœ deferred.then()ä¼šè¿”å›ä¸€ä¸ªæ–°çš„promiseå¯¹è±¡ thenä¸­å®šä¹‰çš„å›è°ƒå‡½æ•°å¯ä»¥ç†è§£ä¸ºè¿‡æ»¤å‡½æ•°ï¼Œå¯å¯¹resolveã€rejectä¸­ä¼ é€’çš„æ•°æ®è¿›è¡ŒåŠ å·¥ã€è¿‡æ»¤ï¼Œç„¶åé€šè¿‡returnä¼ é€’ç»™ä¸‹ä¸€ä¸ªå›è°ƒå‡½æ•° å¦‚æœreturnçš„æ˜¯Deferredæˆ–è€…Promiseå¯¹è±¡ï¼Œå®ƒä¼šå°†è¿”å›çš„Deferredã€Promiseå¯¹è±¡çš„çŠ¶æ€å’Œè¿”å›å€¼ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œåšä¸ºå…¶è§¦å‘ä¾æ®å’Œå‚æ•°ã€‚ A&amp;&amp;B-&gt;Cç±»å‹å¼‚æ­¥ä»»åŠ¡å¯ä»¥ä½¿ç”¨$.when()æ¥è§£å†³ï¼›è§ä¸Šé¢ä¾‹å­ èŒƒå¼123456$.when($.ajax(url1),$.ajax(url2)).done(function()&#123; $.ajax(url3);&#125;).fail(function()&#123; console.log('å‡ºé”™');); A-&gt;B-&gt;Cç±»å‹å¼‚æ­¥ä»»åŠ¡å¯ä»¥ä½¿ç”¨Promiseå¯¹è±¡çš„then()æ¥è§£å†³ï¼›è§ä¸Šé¢ä¾‹å­ èŒƒå¼12345678910111213$.ajax(url1).then(function(url1Data)&#123; return $.ajax(url2);&#125;).then(function(url2Data)&#123; return $.ajax(url3);&#125;).done(function(url3Data)&#123; // æœ€ç»ˆæˆåŠŸå¤„ç†&#125;).fail(function(url3Data)&#123; // æœ€ç»ˆå¤±è´¥å¤„ç†&#125;);]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>å¼‚æ­¥</tag>
        <tag>Promise</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Bootstrap-table_API]]></title>
    <url>%2F2017%2F09%2F07%2FBootstrap-table-API%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘åœ¨é¡¹ç›®ä¸­éœ€è¦ä½¿ç”¨åˆ°è¡¨æ ¼æ§ä»¶ï¼Œè°ƒç ”å‡ ä¸ªå¸¸ç”¨çš„è¡¨æ ¼æ§ä»¶(jquery-dataTableã€list.jsã€jqGridã€Bootstrap-table)åï¼Œå†³å®šä½¿ç”¨Bootstrap-tableï¼Œç‰¹æ„å°†å¸¸ç”¨APIè®°å½•ä¸‹æ¥ï¼Œä»¥å¤‡åç”¨ã€‚æºç å¯åœ¨è¿™https://github.com/BryanAdamss/SourceSave/tree/master/Practice 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt; &lt;!-- å¼•å…¥bootstrapæ ·å¼ --&gt; &lt;link rel="stylesheet" href="./vendors/bootstrap-3.3.7-dist/css/bootstrap.min.css"&gt; &lt;!-- å¼•å…¥bootstrap-tableæ ·å¼ --&gt; &lt;link rel="stylesheet" href="./vendors/bootstrap-table/bootstrap-table.css"&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="btn-group hidden-xs" id="js_caremaTableToolBar" role="group"&gt; &lt;a href="#" class="btn btn-outline btn-default"&gt;&lt;i class="glyphicon glyphicon-plus" aria-hidden="true"&gt;&lt;/i&gt;&lt;/a&gt; &lt;/div&gt; &lt;table id="js_caremaTable" data-height="400" data-icon-size="outline" data-striped="true"&gt; &lt;/table&gt; &lt;script src="./js/jquery.min.js"&gt;&lt;/script&gt; &lt;!-- å¼•å…¥bootstrap.js --&gt; &lt;script src="./vendors/bootstrap-3.3.7-dist/js/bootstrap.min.js"&gt;&lt;/script&gt; &lt;!-- bootstrap-tableä¸»js --&gt; &lt;script src="./vendors/bootstrap-table/bootstrap-table.js"&gt;&lt;/script&gt; &lt;!-- bootstrap-tableæœ¬åœ°åŒ–æ–‡ä»¶ --&gt; &lt;script src="./vendors/bootstrap-table/locale/bootstrap-table-zh-CN.js"&gt;&lt;/script&gt; &lt;script&gt; var caremaTable = $('#js_caremaTable').bootstrapTable(&#123; url: './json/bootstrap_table_test.json', method: 'get', // è¯·æ±‚æ–¹å¼ uniqueId: 'id', // æ¯ä¸€è¡Œçš„å”¯ä¸€idï¼Œä¸€èˆ¬è®¾ç½®ä¸ºä¸»é”®åˆ—ï¼Œæ­¤å¤„ç”¨æ•°æ®ä¸­çš„'id'åšä¸ºæ¯ä¸€è¡Œçš„å”¯ä¸€æ ‡è¯†ï¼›å¯ç”¨åœ¨ä¸€äº›æ–¹æ³•ä¸­å¦‚removeByUniqueIdï¼Œä¸è®¾ç½®uniqueIdæ—¶ï¼Œè°ƒç”¨æ­¤ç±»æ–¹æ³•ä¼šå‡ºé”™ search: true, // å¯ç”¨æœç´¢ sortable: true, // å…¨å±€é…ç½®ï¼Œæ˜¯å¦å¯ç”¨åˆ—æ’åºï¼›è‹¥ä¸ºfalseï¼Œå³ä½¿åˆ—ä¸Šè®¾ç½®äº†sortable:trueï¼Œåˆ—ä¹Ÿæ— æ³•è¿›è¡Œæ’åº pagination: true, // å¯ç”¨åˆ†é¡µ sidePagination: 'client', // è®¾ç½®åœ¨å“ªé‡Œè¿›è¡Œåˆ†é¡µï¼Œå¯é€‰å€¼ä¸º 'client' æˆ–è€… 'server'ã€‚è®¾ç½® 'server'æ—¶ï¼Œå¿…é¡»è®¾ç½® æœåŠ¡å™¨æ•°æ®åœ°å€ï¼ˆurlï¼‰æˆ–è€…é‡å†™ajaxæ–¹æ³• showRefresh: true, // å¯ç”¨åˆ·æ–° showColumns: true, // å¯ç”¨å†…å®¹åˆ—ä¸‹æ‹‰æ¡† showToggle: true, // æ˜¯å¦æ˜¾ç¤º åˆ‡æ¢è¯•å›¾ï¼ˆtable/cardï¼‰æŒ‰é’® showPaginationSwitch: true, // æ˜¯å¦æ˜¾ç¤ºåˆ‡æ¢åˆ†é¡µæŒ‰é’® toolbar: '#js_caremaTableToolBar', // å·¥å…·æ  cache: true, // è®¾ç½®ä¸º false ç¦ç”¨ AJAX æ•°æ®ç¼“å­˜ singleSelect: false, // è®¾ç½®True å°†ç¦æ­¢radioã€checkboxå¤šé€‰ï¼Œå¹¶éšè—é€‰æ‹©å…¨éƒ¨æŒ‰é’® class: 'cgh_dfjakdjfklasjdfklajslkdfjlkaf', columns: [&#123; checkbox: true, // æ­¤åˆ—ä¸ºcheckbox &#125;, // &#123; // radio: true // æ­¤åˆ—ä¸ºradio // &#125;, &#123; field: 'id', title: 'ç¼–å·', sortable: true, // æ­¤åˆ—è¡¨å¤´ç‚¹å‡»ï¼Œå¯è¿›è¡Œæ’åºï¼Œå‰æå¿…é¡»æ˜¯è¡¨æ ¼çš„sortableä¸ºtrue titleTooltip: 'ç‚¹å‡»å¯è¿›è¡Œæ’åº', // æ‚¬åœtooltip width: '100px' &#125;, &#123; field: 'name', title: 'åç§°', &#125;, &#123; field: 'place', title: 'é¢„ç½®ä½' &#125;, &#123; field: 'userName', title: 'è¿æ¥ç”¨æˆ·å' &#125;, &#123; field: 'password', title: 'è¿æ¥å¯†ç ' &#125;, &#123; field: 'channel', title: 'è¿œç¨‹é¢‘é“' &#125;, &#123; field: 'lng', title: 'ç»åº¦' &#125;, &#123; field: 'lat', title: 'çº¬åº¦', &#125;, &#123; title: 'æ“ä½œ', formatter: function(value, row, index) &#123; return '&lt;a href="javascript:;" class="text-danger m-l js_delete"&gt;åˆ é™¤&lt;/a&gt;' &#125;, events: &#123; // æŒ‰é’®ç‚¹å‡»äº‹ä»¶ 'click .js_delete': function(e, value, row, index) &#123; console.log(e, value, row, index); if (confirm('ç¡®å®šåˆ é™¤æ­¤è¡Œå—ï¼Ÿ')) &#123; caremaTable.bootstrapTable('removeByUniqueId', row.id); // å½“è¡¨æ ¼é…ç½®äº†uniqueId: 'id'æ—¶ï¼Œå¯é€šè¿‡removeByUniqueIdæ¥åˆ é™¤å½“å‰è¡Œ // caremaTable.bootstrapTable('remove', &#123; // åˆ é™¤nameåˆ—å€¼ä¸º'æµ‹è¯•0'çš„è¡Œ // field: 'name', // values: ['æµ‹è¯•0'] // æ³¨æ„valueså¿…é¡»æ˜¯ä¸€ä¸ªæ•°ç»„ // &#125;); // caremaTable.bootstrapTable('remove', &#123; // åˆ é™¤å½“å‰è¡Œï¼Œç”±äºidåœ¨åˆ›å»ºæ•°æ®æ—¶æ˜¯å”¯ä¸€çš„ï¼Œæ‰€ä»¥é€šè¿‡ç‚¹å‡»è·å–rowä¸­çš„idæ•°æ®ï¼Œç„¶ååˆ é™¤idåˆ—å€¼ä¸ºrow.idçš„è¡Œï¼›ä¸è¿‡è¿˜æ˜¯å»ºè®®é€šè¿‡é…ç½®uniqueIdç„¶åé€šè¿‡removeByUniqueIdæ–¹æ³•æ¥åˆ é™¤ // field: 'id', // values: [row.id] // &#125;); &#125; &#125; &#125; &#125; ], onCheck: function(row) &#123; // å•ç‹¬é€‰ä¸­æŸä¸€ä¸ªcheckæ—¶è§¦å‘ console.log('onCheck', row); &#125;, onUncheck: function(row) &#123; console.log('onUncheck', row); // uncheckæŸä¸€ä¸ªcheckæ—¶è§¦å‘ &#125;, onCheckAll: function(rows) &#123; console.log('onCheckAll', rows); // å…¨é€‰checkæ—¶è§¦å‘ &#125;, onUncheckAll: function(rows) &#123; console.log('onUncheckAll', rows); // uncheckæ‰€æœ‰checkæ—¶è§¦å‘ &#125; &#125;); // å¸¸ç”¨æ–¹æ³• // è°ƒç”¨æ–¹æ³•çš„è¯­æ³•ï¼š$('#table').bootstrapTable('method', parameter); // å…¨éƒ¨æ–¹æ³•è¯·å‚é˜…http://bootstrap-table.wenzhixin.net.cn/zh-cn/documentation/#æ–¹æ³• // caremaTable.bootstrapTable('getSelections'); // è¿”å›æ‰€é€‰çš„è¡Œï¼Œå½“æ²¡æœ‰é€‰æ‹©ä»»ä½•è¡Œçš„æ—¶å€™è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ã€‚ // caremaTable.bootstrapTable('getAllSelections'); // è¿”å›æ‰€æœ‰é€‰æ‹©çš„è¡Œï¼ŒåŒ…æ‹¬æœç´¢è¿‡æ»¤å‰çš„ï¼Œå½“æ²¡æœ‰é€‰æ‹©ä»»ä½•è¡Œçš„æ—¶å€™è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ã€‚ // caremaTable.bootstrapTable('getData'); // è·å–å½“å‰åŠ è½½çš„æ•°æ®ã€‚ // caremaTable.bootstrapTable('getRowByUniqueId', 3); // æ ¹æ® uniqueId è·å–è¡Œæ•°æ®ã€‚ // caremaTable.bootstrapTable('load', data); // åŠ è½½æ•°æ®åˆ°è¡¨æ ¼ä¸­ï¼Œæ—§æ•°æ®ä¼šè¢«æ›¿æ¢ã€‚ // caremaTable.bootstrapTable('showAllColumns'); // æ˜¾ç¤ºæ‰€æœ‰åˆ—ã€‚ // caremaTable.bootstrapTable('hideAllColumns'); // éšè—æ‰€æœ‰åˆ—ã€‚ // caremaTable.bootstrapTable('append'); // æ·»åŠ æ•°æ®åˆ°è¡¨æ ¼åœ¨ç°æœ‰æ•°æ®ä¹‹åã€‚ // caremaTable.bootstrapTable('prepend'); // æ’å…¥æ•°æ®åˆ°è¡¨æ ¼åœ¨ç°æœ‰æ•°æ®ä¹‹å‰ã€‚ // caremaTable.bootstrapTable('remove', &#123; field: 'id', values: someArr &#125;); // ä»è¡¨æ ¼ä¸­åˆ é™¤æ•°æ®ï¼ŒåŒ…æ‹¬ä¸¤ä¸ªå‚æ•°ï¼š field: éœ€è¦åˆ é™¤çš„è¡Œçš„ field åç§°ã€‚values: éœ€è¦åˆ é™¤çš„è¡Œçš„å€¼ï¼Œç±»å‹ä¸ºæ•°ç»„ã€‚ // caremaTable.bootstrapTable('removeAll'); // åˆ é™¤è¡¨æ ¼æ‰€æœ‰æ•°æ®ã€‚ // caremaTable.bootstrapTable('removeByUniqueId'); // æ ¹æ® uniqueId åˆ é™¤æŒ‡å®šçš„è¡Œã€‚ // caremaTable.bootstrapTable('insertRow', &#123; index: 1, row: row &#125;); // æ’å…¥æ–°è¡Œï¼Œå‚æ•°åŒ…æ‹¬ï¼šindex: è¦æ’å…¥çš„è¡Œçš„ indexã€‚row: è¡Œçš„æ•°æ®ï¼ŒObject å¯¹è±¡ã€‚ // caremaTable.bootstrapTable('updateRow', &#123; index: 1, row: row &#125;); // æ›´æ–°æŒ‡å®šçš„è¡Œï¼Œå‚æ•°åŒ…æ‹¬ï¼šindex: è¦æ›´æ–°çš„è¡Œçš„ indexã€‚row: è¡Œçš„æ•°æ®ï¼ŒObject å¯¹è±¡ã€‚ // caremaTable.bootstrapTable('showRow', &#123; index: 1 &#125;); // æ˜¾ç¤ºæŒ‡å®šçš„è¡Œï¼Œå‚æ•°åŒ…æ‹¬ï¼šindex: è¦æ›´æ–°çš„è¡Œçš„ index æˆ–è€… uniqueIdã€‚isIdField: æŒ‡å®š index æ˜¯å¦ä¸º uniqueidã€‚ // caremaTable.bootstrapTable('hideRow', &#123; index: 1 &#125;); // éšè—æŒ‡å®šçš„è¡Œï¼Œå‚æ•°åŒ…æ‹¬ï¼šindex: è¦æ›´æ–°çš„è¡Œçš„ index æˆ–è€… uniqueIdã€‚isIdField: æŒ‡å®š index æ˜¯å¦ä¸º uniqueidã€‚ // caremaTable.bootstrapTable('checkAll'); // é€‰ä¸­æ‰€æœ‰è¡Œ // caremaTable.bootstrapTable('uncheckAll'); // uncheckæ‰€æœ‰è¡Œ // caremaTable.bootstrapTable('check', 0); // é€‰ä¸­ç¬¬ä¸€è¡Œ // caremaTable.bootstrapTable('uncheck', 0); // å–æ¶ˆé€‰ä¸­ç¬¬ä¸€è¡Œ // caremaTable.bootstrapTable('checkBy', &#123; field: "field_name", values: ["value1", "value2", "value3"] &#125;); // é€‰ä¸­field_nameä¸ºvalue1ã€value2ã€value3çš„è¡Œ // caremaTable.bootstrapTable('uncheckBy', &#123; field: "field_name", values: ["value1", "value2", "value3"] &#125;); // å–æ¶ˆé€‰ä¸­field_nameä¸ºvalue1ã€value2ã€value3çš„è¡Œ $(window).resize(function() &#123; // é˜²æ­¢theadå’Œtbodyåœ¨ç¼©æ”¾æƒ…å†µä¸‹ä¸å¯¹é½ caremaTable.bootstrapTable('resetView'); &#125;); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt;]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>è¡¨æ ¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[type-existence]]></title>
    <url>%2F2017%2F08%2F04%2Ftype-existence%2F</url>
    <content type="text"><![CDATA[æœ¬æ¥åœ¨ã€Šç¼–å†™å¯ç»´æŠ¤æ€§çš„javascriptã€‹ä¸­å·²ç»åšè¿‡æ€»ç»“ï¼Œä½†æœ€è¿‘åœ¨ä½¿ç”¨ä¸Šåˆå‡ºç°ä¸€ç‚¹é—®é¢˜ï¼Œæ‰€ä»¥æ¨ç¿»ä»¥å‰çš„å•ç‹¬å†™ç¯‡å…³äºç±»å‹æ£€æµ‹å’Œå­˜åœ¨æ€§æ£€æµ‹çš„æ–‡ç«  ç±»å‹æ£€æµ‹å’Œå­˜åœ¨æ€§æ£€æµ‹å¿…å¤‡çŸ¥è¯†ç‚¹ å“ªäº›å€¼ä¼šè¢«è½¬æˆfalse â€œâ€ã€0ã€NaNã€falseã€nullã€undefinedä¼šåœ¨æœŸå¾…å¸ƒå°”å€¼çš„åœ°æ–¹è¢«è½¬æˆfalse; éä¸Šé¢æåŠçš„å€¼éƒ½ä¼šè¢«è½¬æˆtrueï¼› æ³¨æ„ç©ºå¯¹è±¡(æ²¡æœ‰ä»»ä½•å±æ€§/æ–¹æ³•çš„å¯¹è±¡)ä¹Ÿä¼šè§†ä¸ºtrue1234var a=&#123;&#125;;if(a)&#123; console.log(true);// true&#125; å£°æ˜å’Œèµ‹å€¼ æœªå£°æ˜(æ›´æœªèµ‹å€¼)çš„å˜é‡ ç›´æ¥ä½¿ç”¨ï¼Œä¼šæŠ¥é”™ 1console.log(b);// Uncaught ReferenceError: b is not defined å¦‚æœé€šè¿‡typeof bæ¥ä½¿ç”¨ï¼Œåˆ™ä¸ä¼šæŠ¥é”™ï¼›å› ä¸ºtypeofå­˜åœ¨ä¸€ä¸ªç‰¹æ®Šçš„å®‰å…¨é˜²èŒƒæœºåˆ¶ï¼› å·²å£°æ˜æœªèµ‹å€¼çš„å˜é‡ ä¼šæœ‰é»˜è®¤å€¼undefined123var a;console.log(a===undefined);// trueconsole.log(typeof a);// 'undefined' æ³¨æ„:å½“æœªå£°æ˜çš„å˜é‡ä½¿ç”¨typeofæ£€æµ‹æ—¶ï¼Œå¹¶ä¸ä¼šæŠ¥é”™ï¼Œè€Œä¸”è¿”å›&#39;undefined&#39;ï¼›å› ä¸ºtypeofå­˜åœ¨ä¸€ä¸ªç‰¹æ®Šçš„å®‰å…¨é˜²èŒƒæœºåˆ¶ï¼› 1console.log(typeof b);// 'undefined'ï¼Œå¹¶æ²¡æœ‰æŠ¥é”™ æ€»ç»“ æœªå£°æ˜å’Œå·²å£°æ˜æœªèµ‹å€¼çš„å˜é‡ä½¿ç”¨typeofæ£€æµ‹æ—¶ï¼Œéƒ½ä¼šè¿”å›&#39;undefined&#39; è®¿é—®å¯¹è±¡ä¸Šä¸å­˜åœ¨çš„å±æ€§/æ–¹æ³•æ—¶ï¼Œå¹¶ä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªundefined 1234var obj=&#123; a:3&#125;;console.log(obj.b);// undefined ç±»å‹æ£€æµ‹-&gt;(åˆ¤æ–­å€¼çš„ç±»å‹) é¦–å…ˆå˜é‡æ˜¯æ²¡æœ‰ç±»å‹çš„ï¼Œç±»å‹æœ¬è´¨æŒ‡çš„æ˜¯å˜é‡æŒæœ‰çš„å€¼çš„ç±»å‹ï¼Œä¸€èˆ¬è¯´çš„å˜é‡ç±»å‹ï¼Œå®é™…æŒ‡çš„æ˜¯å˜é‡æŒæœ‰çš„å€¼çš„ç±»å‹ åˆ¤æ–­ç±»å‹ä¸»è¦ç”¨æ¥ï¼Œæ£€æµ‹è¾“å…¥çš„å‚æ•°æ˜¯å¦ä¸ºæƒ³è¦çš„ç±»å‹ 12345function test(fn)&#123; if(typeof fn==='function')&#123; // xxxxx &#125;&#125; ä¸€èˆ¬å€¼ stringã€numberã€booleanã€undefined-&gt;typeofæ¥åˆ¤æ–­ nullä¸€èˆ¬ä¸ç”¨åšç±»å‹æ£€æµ‹ï¼Œåªæœ‰åœ¨å˜é‡æ˜¯ä¸€ä¸ªå¯é¢„æœŸçš„nullå€¼æ—¶ï¼Œæ‰ç”¨æ¥åˆ¤æ–­1234var obj=null;if(obj===null)&#123; // xxx&#125; å¼•ç”¨å€¼ è‡ªå®šä¹‰ã€éæ•°ç»„ã€éå‡½æ•°-&gt;ä½¿ç”¨obj instanceof constructor 12345678function People(name)&#123; this.name=name;&#125;var p=new People();console.log(p instanceof People);// truevar date=new Date();console.log(date instanceof Date);// true å‡½æ•°-&gt;typeof 12function fn()&#123;&#125;console.log(typeof fn==='function');// 'function' æ•°ç»„ es5çš„isArray 12var arr=[];console.log(Array.isArray(arr));// true Object.prototype.call(arr); 12var arr=[];console.log(Object.prototype.toString.call(arr)==='[object Array]'); å­˜åœ¨æ€§ å¸¸ç”¨æ£€æµ‹å­˜åœ¨æ€§çš„ä¸è¶³ 12345var obj=&#123; b:0&#125;;if(b)&#123;&#125;// å¦‚æœbå­˜åœ¨ï¼Œåˆ™xxxï¼›å½“bä¸º"",0,NaN,false,null,undefinedæ—¶ï¼Œå°±æ— æ³•æ£€æµ‹ï¼›åŒç†b&amp;&amp;b()ä¹Ÿä¼šå‡ºç°ç±»ä¼¼é—®é¢˜ï¼Œæ‰€ä»¥åªæœ‰åœ¨æ˜ç¡®çŸ¥é“è¦æ£€æµ‹çš„å€¼ä¸ä¼šæ˜¯"",0,NaN,false,null,undefinedä¸­çš„ä¸€ç§æ—¶æ‰èƒ½ç”¨ å˜é‡æ˜¯å¦å­˜åœ¨(æ˜¯å¦å·²ç»å£°æ˜) å…¨å±€å˜é‡çš„å­˜åœ¨æ€§ 1console.log('a' in window);// false;åˆ¤æ–­å˜é‡aåœ¨å…¨å±€ç¯å¢ƒä¸‹æ˜¯å¦å£°æ˜ å±€éƒ¨å˜é‡çš„å­˜åœ¨æ€§ å±€éƒ¨å˜é‡æ— æ³•ç”¨inåˆ¤æ–­ï¼Œåªèƒ½é€€è€Œæ±‚å…¶æ¬¡ç”¨typeofï¼Œtypeofæ— æ³•å‡†ç¡®åˆ¤æ–­å‡ºæ˜¯æœªå£°æ˜è¿˜æ˜¯å·²å£°æ˜æœªèµ‹å€¼ï¼Œå¦‚ä¸‹123var a;console.log(typeof a==='undefined');// true;aå·²ç»å£°æ˜ä½†æœªèµ‹å€¼ console.log(typeof b==='undefined');// true;bæ²¡æœ‰å£°æ˜ å¯¹è±¡çš„å±æ€§æ˜¯å¦å­˜åœ¨ ä¸€èˆ¬å±æ€§-&gt;ç»Ÿä¸€ä½¿ç”¨in å®ä¾‹å±æ€§å­˜åœ¨æ€§-&gt;ç»Ÿä¸€ä½¿ç”¨hasOwnProperty IE8åŠä»¥ä¸‹åˆ¤æ–­å®ä¾‹å±æ€§å­˜åœ¨æ€§-&gt;å…ˆåˆ¤æ–­hasOwnPropertyçš„å­˜åœ¨æ€§ï¼Œå†è°ƒç”¨hasOwnProperty123456var obj_a=&#123; test:'æµ‹è¯•'&#125;;console.log('test' in obj_a);// trueconsole.log('toString' in obj_a);// trueï¼Œèƒ½æ£€æµ‹åˆ°åŸå‹é“¾ä¸Šçš„æ–¹æ³•console.log(obj_a.hasOwnProperty('toString'));//false,obj_aå¹¶æ²¡æœ‰å®ä¾‹å±æ€§(æ–¹æ³•)`toString`ï¼Œ`toString`å­˜åœ¨äºå…¶åŸå‹å¯¹è±¡ä¸Šï¼ŒhasOwnPropertyæ— æ³•æ£€æµ‹åˆ°]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>ç±»å‹æ£€æµ‹</tag>
        <tag>å­˜åœ¨æ€§</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Vue-guide]]></title>
    <url>%2F2017%2F08%2F01%2FVue-guide%2F</url>
    <content type="text"><![CDATA[VueJså®˜ç½‘æ•™ç¨‹å­¦ä¹ ç¬”è®°å®‰è£… å…¼å®¹æ€§:ä¸æ”¯æŒIE8åŠä»¥ä¸‹ç‰ˆæœ¬æµè§ˆå™¨ï¼›å› ä¸ºä½¿ç”¨äº†IE8æ— æ³•æ¨¡æ‹Ÿçš„Object.defineProperty å¼€å‘ç‰ˆæœ¬-&gt;åŒ…å«äº†å®Œæ•´çš„è­¦å‘Šå’Œè°ƒè¯•æ¨¡å¼ CLI-&gt;å¯ä»¥æ„å»ºä¸€ä¸ªå®Œæ•´çš„vueé¡¹ç›® ä»‹ç» æ˜¯ä¸€å¥—æ„å»ºç”¨æˆ·ç•Œé¢çš„æ¡†æ¶ï¼Œæœ¬èº«åªå…³æ³¨è§†å›¾å±‚ï¼Œä½†å¯ä»¥å’Œç¬¬ä¸‰æ–¹åº“ç»“åˆæ¥æ„å»ºå¤æ‚çš„spa Vueå®ä¾‹ æ„é€ å™¨ Vue(é€‰é¡¹å¯¹è±¡) 123var vm = new Vue(&#123; // é€‰é¡¹&#125;); å¯æ‰©å±•Vueæ„é€ å™¨ 12345var MyComponent = Vue.extend(&#123; // æ‰©å±•é€‰é¡¹&#125;)// æ‰€æœ‰çš„ `MyComponent` å®ä¾‹éƒ½å°†ä»¥é¢„å®šä¹‰çš„æ‰©å±•é€‰é¡¹è¢«åˆ›å»ºvar myComponentInstance = new MyComponent() å±æ€§ä¸æ–¹æ³• æ¯ä¸ªvueå®ä¾‹ä¼šä»£ç†å…¶dataå¯¹è±¡é‡Œæœ‰æ‰€æœ‰å±æ€§ï¼Œè¿™äº›å±æ€§éƒ½æ˜¯å“åº”å¼çš„ï¼› $å¼€å¤´çš„ä¸ºvueå®ä¾‹å±æ€§/æ–¹æ³• ä¸è¦åœ¨å®ä¾‹å±æ€§æˆ–è€…å›è°ƒå‡½æ•°ä¸­ä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œç®­å¤´å‡½æ•°ä¼šç»‘å®šä¸Šçº§contextï¼Œthisé¢„æœŸå°†ä¸ä¼šæ˜¯vueå®ä¾‹ å®ä¾‹ç”Ÿå‘½å‘¨æœŸ ç”Ÿå‘½å‘¨æœŸé’©å­-&gt;è‡ªå®šä¹‰äº‹ä»¶ å¯ä»¥åœ¨é€‰é¡¹å¯¹è±¡ä¸­è¿›è¡Œé…ç½® ç”Ÿå‘½å‘¨æœŸé’©å­ä¸­çš„thisæŒ‡å‘å®ä¾‹åŒ–åçš„å¯¹è±¡12345678910var vm = new Vue(&#123; data: &#123; a: 1 &#125;, created: function () &#123; // `this` æŒ‡å‘ vm å®ä¾‹ console.log('a is: ' + this.a) &#125;&#125;)// -&gt; "a is: 1" æ¨¡æ¿è¯­æ³•æ’å€¼ æ–‡æœ¬ ç»‘å®šæ–‡æœ¬ v-text ä¼šå°†å¯¹åº”è¡¨è¾¾å¼æ±‚å€¼åï¼Œå½“åšå­—ç¬¦ä¸²æ›¿æ¢å…ƒç´ å†…çš„å†…å®¹ {{ msg }} msg æ”¹å˜æ—¶ï¼Œè§†å›¾ä¹Ÿä¼šå‘ç”Ÿæ”¹å˜;æ˜¯v-textçš„ç®€å†™ï¼Œæ±‚å€¼åï¼Œå½“åšå­—ç¬¦ä¸²æ›¿æ¢ {{ }}å¤„çš„å†…å®¹;{{ }}ä¸­å¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼ï¼Œä½†ä¸èƒ½ä½¿ç”¨è¯­å¥ï¼Œæµç¨‹æ§åˆ¶ä¹Ÿä¸èƒ½ç”¨(ä½¿ç”¨ä¸‰å…ƒè¡¨è¾¾å¼ä»£æ›¿) {{ }}å½¢å¼ä¼šå’Œngä¸­çš„ä¸€æ ·ï¼Œå­˜åœ¨é¦–æ¬¡åŠ è½½é—ªçƒçš„é—®é¢˜ï¼Œå¦‚æœæ˜¯é¦–å±å†…å®¹ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨v-textç»‘å®š ä¸€æ¬¡æ€§æ’å€¼ åœ¨å…ƒç´ ä¸Šä½¿ç”¨v-onceæŒ‡ä»¤ï¼Œè¿™æ ·å…ƒç´ å†…éƒ¨çš„æ‰€æœ‰æ•°æ®ç»‘å®šï¼Œåªä¼šæ˜¾ç¤ºç¬¬ä¸€æ¬¡ç»‘å®šæ—¶çš„æ•°æ®ï¼Œå½“æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒä»¬éƒ½ä¸ä¼šå¾—åˆ°æ›´æ–°ï¼Œå¯ä»¥ç”¨åœ¨ä¸ä¼šå‘ç”Ÿæ”¹å˜çš„æ•°æ®çš„ç»‘å®šï¼›1&lt;span v-once&gt;This will never change: &#123;&#123; msg &#125;&#125;,&#123;&#123; test &#125;&#125;&lt;/span&gt; çº¯html v-html {{ }}å’Œv-textä¼šå°†æ•°æ®å½“åšçº¯æ–‡æœ¬å¤„ç†ï¼Œä¸ä¼šå¯¹å…¶åšhtmlè§£æ;v-htmlä¼šå°†å¯¹åº”è¡¨è¾¾è¡¨è¾¾å¼å½“åšhtmlè§£æåï¼Œè¾“å‡ºåˆ°å…ƒç´ å†… å±æ€§(ç‰¹æ€§) v-bind ä¸»è¦ç”¨æ¥ç»‘å®šç‰¹æ€§ v-bind:title=&quot;test&quot; å°†testç»‘å®šåˆ°å…ƒç´ çš„titleç‰¹æ€§ä¸Šï¼› ç¼©å†™ v-bind:href=&quot;url&quot;-&gt;:href=&quot;url&quot; æŒ‡ä»¤ æŒ‡ä»¤æ˜¯v-å¼€å¤´(ngä¸­ä»¥ng-å¼€å¤´)ï¼Œå®ƒçš„é¢„æœŸæ˜¯ä¸€ä¸ªå•ä¸€jsè¡¨è¾¾å¼(v-foré™¤å¤–) å¯ä»¥å¸¦å‚æ•° 12&lt;a v-bind:href="url"&gt;&lt;/a&gt;&lt;a v-on:click="doSomething"&gt; ä¿®é¥°ç¬¦ æŒ‡ä»¤åé€šè¿‡æ·»åŠ .æ¥é™„åŠ ä¿®é¥°ç¬¦ï¼ˆModifiersï¼‰ï¼Œç”¨äºæŒ‡å‡ºä¸€ä¸ªæŒ‡ä»¤åº”è¯¥ä»¥ç‰¹æ®Šæ–¹å¼ç»‘å®šã€‚1&lt;form v-on:submit.prevent="onSubmit"&gt;&lt;/form&gt;// submitæ—¶é˜»æ­¢é»˜è®¤è¡Œä¸º è¿‡æ»¤å™¨ vue2.0ä¸­æ²¡æœ‰é¢„å®šä¹‰çš„è¿‡æ»¤å™¨äº†ï¼Œæ‰€æœ‰filteréƒ½éœ€è¦è‡ªå®šä¹‰ ä¸»è¦ç”¨åœ¨{{ }}å’Œv-bindä¸­ï¼Œè¾¾åˆ°æ ¼å¼åŒ–è¾“å‡ºæ–‡æœ¬çš„ä½œç”¨ å¯çº§è”ä½¿ç”¨ å¯å¸¦å‚æ•°1234567891011121314151617181920//ä½¿ç”¨&lt;!-- in mustaches --&gt;&#123;&#123; message | capitalize &#125;&#125;&lt;!-- in v-bind --&gt;&lt;div v-bind:id="rawId | formatId"&gt;&lt;/div&gt;// å®šä¹‰new Vue(&#123; // ... filters: &#123; capitalize: function (value) &#123; if (!value) return '' value = value.toString() return value.charAt(0).toUpperCase() + value.slice(1) &#125; &#125;&#125;)// çº§è”ä½¿ç”¨&#123;&#123; message | filterA | filterB &#125;&#125;// å¸¦å‚æ•°&#123;&#123; message | filterA('arg1', arg2) &#125;&#125;// è¿™é‡Œï¼ŒfilterA æ˜¯ä¸ªæ‹¥æœ‰ä¸‰ä¸ªå‚æ•°çš„å‡½æ•°ã€‚message çš„å€¼å°†ä¼šä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥ã€‚å­—ç¬¦ä¸² 'arg1' å°†ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ ç»™ filterAï¼Œè¡¨è¾¾å¼ arg2 çš„å€¼å°†ä½œä¸ºç¬¬ä¸‰ä¸ªå‚æ•°ã€‚ ç¼©å†™ v-bind 1234&lt;!-- å®Œæ•´è¯­æ³• --&gt;&lt;a v-bind:href="url"&gt;&lt;/a&gt;&lt;!-- ç¼©å†™ --&gt;&lt;a :href="url"&gt;&lt;/a&gt; v-on 1234&lt;!-- å®Œæ•´è¯­æ³• --&gt;&lt;a v-on:click="doSomething"&gt;&lt;/a&gt;&lt;!-- ç¼©å†™ --&gt;&lt;a @click="doSomething"&gt;&lt;/a&gt; è®¡ç®—å±æ€§è®¡ç®—å±æ€§ å¯ä»¥å°†è®¡ç®—å±æ€§å½“æˆdataä¸­å±æ€§æ·»åŠ äº†ä¸€ä¸ªgetteræ–¹æ³•ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°å±æ€§ï¼Œä½†æ–°å±æ€§ä¾èµ–dataä¸­çš„å±æ€§ï¼› 123456789101112131415// jsvar vm = new Vue(&#123; el: '#example', data: &#123; message: 'Hello' &#125;, computed: &#123; // a computed getter reversedMessage: function () &#123; // `this` æŒ‡å‘vmå®ä¾‹ï¼Œç”±äºvmå®ä¾‹ä»£ç†äº†æ‰€æœ‰dataä¸­çš„å±æ€§ï¼Œæ‰€ä»¥this.messageèƒ½è¢«è®¿é—®åˆ° return this.message.split('').reverse().join('') &#125; &#125;&#125;);// å½“dataä¸­çš„messageå‘ç”Ÿå˜åŒ–æ—¶ï¼ŒreversedMessageä¹Ÿä¼šé‡æ–°è®¡ç®— è®¡ç®—å±æ€§vsMethods 1&lt;p&gt;Reversed message: "&#123;&#123; reversedMessage() &#125;&#125;"&lt;/p&gt; 123456methods: &#123; reversedMessage: function () &#123; return this.message.split('').reverse().join('') &#125;&#125;// è¿™æ ·ä¹Ÿèƒ½å®ç°åè½¬çš„æ•ˆæœ ä¸åŒç‚¹ è®¡ç®—å±æ€§æ˜¯åŸºäºå®ƒä»¬çš„ä¾èµ–è¿›è¡Œç¼“å­˜çš„ï¼›å¦‚ä¸Šé¢è®¡ç®—å±æ€§çš„ä¾‹å­ï¼Œåªè¦dataä¸­çš„messageæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œcomputedä¸­çš„reversedMessageéƒ½ä¸ä¼šé‡æ–°è®¡ç®—ï¼Œæ¯æ¬¡è®¿é—®reversedMessageéƒ½å°†ä¼šæ˜¯ä¹‹å‰ç¼“å­˜çš„æ•°æ®ï¼› methodsåˆ™ä¸å­˜åœ¨ç¼“å­˜ä¸€è¯´ï¼Œå¦‚ä¸Šé¢methodsä¾‹å­ï¼Œåªè¦`Reversed message: "{{ reversedMessage() }}"`éœ€è¦é‡æ–°æ¸²æŸ“ï¼ŒreversedMessageå°±ä¼šè¢«é‡æ–°è°ƒç”¨å¹¶è®¡ç®—ä¸€æ¬¡ è®¡ç®—setter è®¡ç®—å±æ€§é»˜è®¤åªæœ‰getterï¼Œå¯ä»¥æä¾›setteræ–¹æ³•12345678910111213141516// ...computed: &#123; fullName: &#123; // getter get: function () &#123; return this.firstName + ' ' + this.lastName &#125;, // setter set: function (newValue) &#123; var names = newValue.split(' ') this.firstName = names[0] this.lastName = names[names.length - 1] &#125; &#125;&#125;// ... watch ä¸»è¦ç”¨æ¥è§‚æµ‹æ•°æ®çš„å˜åŒ–ï¼Œå¹¶è¿›è¡Œä¸€ç³»åˆ—çš„æ“ä½œ 1234567&lt;div id="watch-example"&gt; &lt;p&gt; Ask a yes/no question: &lt;input v-model="question"&gt; &lt;/p&gt; &lt;p&gt;&#123;&#123; answer &#125;&#125;&lt;/p&gt;&lt;/div&gt; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;!-- Since there is already a rich ecosystem of ajax libraries --&gt;&lt;!-- and collections of general-purpose utility methods, Vue core --&gt;&lt;!-- is able to remain small by not reinventing them. This also --&gt;&lt;!-- gives you the freedom to just use what you're familiar with. --&gt;&lt;script src="https://unpkg.com/axios@0.12.0/dist/axios.min.js"&gt;&lt;/script&gt;&lt;script src="https://unpkg.com/lodash@4.13.1/lodash.min.js"&gt;&lt;/script&gt;&lt;script&gt;var watchExampleVM = new Vue(&#123; el: '#watch-example', data: &#123; question: '', answer: 'I cannot give you an answer until you ask a question!' &#125;, watch: &#123; // å¦‚æœ question å‘ç”Ÿæ”¹å˜ï¼Œè¿™ä¸ªå‡½æ•°å°±ä¼šè¿è¡Œ question: function (newQuestion) &#123; this.answer = 'Waiting for you to stop typing...' this.getAnswer() &#125; &#125;, methods: &#123; // _.debounce æ˜¯ä¸€ä¸ªé€šè¿‡ lodash é™åˆ¶æ“ä½œé¢‘ç‡çš„å‡½æ•°ã€‚ // åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›é™åˆ¶è®¿é—®yesno.wtf/apiçš„é¢‘ç‡ // ajaxè¯·æ±‚ç›´åˆ°ç”¨æˆ·è¾“å…¥å®Œæ¯•æ‰ä¼šå‘å‡º // å­¦ä¹ æ›´å¤šå…³äº _.debounce function (and its cousin // _.throttle), å‚è€ƒ: https://lodash.com/docs#debounce getAnswer: _.debounce( function () &#123; if (this.question.indexOf('?') === -1) &#123; this.answer = 'Questions usually contain a question mark. ;-)' return &#125; this.answer = 'Thinking...' var vm = this axios.get('https://yesno.wtf/api') .then(function (response) &#123; vm.answer = _.capitalize(response.data.answer) &#125;) .catch(function (error) &#123; vm.answer = 'Error! Could not reach the API. ' + error &#125;) &#125;, // è¿™æ˜¯æˆ‘ä»¬ä¸ºç”¨æˆ·åœæ­¢è¾“å…¥ç­‰å¾…çš„æ¯«ç§’æ•° 500 ) &#125;&#125;)&lt;/script&gt; ä»€ä¹ˆæ—¶å€™ç”¨computedã€methodsã€watch computedä¸»è¦ç”¨åœ¨æ ¹æ®åŸæœ‰å±æ€§ï¼Œè¿›è¡Œè®¡ç®—ï¼Œè¿”å›æ–°å±æ€§çš„æ“ä½œï¼›å³é€‚åˆç”¨åœ¨å¯¹æ•°æ®(å±æ€§)çš„setå’Œgetä¸Š methodsä¸»è¦ç”¨æ¥ç¼–å†™ä¸€äº›é€šç”¨ï¼Œæ²¡æœ‰ä»€ä¹ˆä¾èµ–çš„æ–¹æ³•ã€‚ watchä¸»è¦ç”¨æ¥è§‚æµ‹æ•°æ®(å±æ€§)çš„å˜åŒ–ï¼Œå½“å˜åŒ–æ—¶è¿›è¡Œä¸€ç³»åˆ—æ“ä½œï¼ˆå¼‚æ­¥æ“ä½œæˆ–å¼€é”€è¾ƒå¤§çš„æ“ä½œï¼‰ æ€»ç»“ computedé€‚åˆç”¨æ¥å¯¹æ•°æ®è¿›è¡Œsetã€get watché€‚åˆç”¨æ¥åœ¨æ•°æ®å˜åŒ–æ—¶ï¼Œè¿›è¡Œå¤§å¼€é”€çš„æ“ä½œ methods ç”¨æ¥ç¼–å†™é€šç”¨çš„æ–¹æ³• Classä¸Styleç»‘å®šç»‘å®š HTML Classç±»ä¼¼ng-class å¯¹è±¡è¯­æ³• ä¼ ä¸€ä¸ªå¯¹è±¡ï¼Œä»¥åŠ¨æ€åˆ‡æ¢class 1&lt;div v-bind:class="&#123; active: isActive &#125;"&gt;&lt;/div&gt;// isActiveä¸ºtrueæ—¶ï¼Œåˆ™æ·»åŠ activeæ ·å¼ç±»ï¼Œä¸ºfalseåˆ™å»é™¤ å¯ä»¥ä¼ å¤šä¸ªå±æ€§ï¼Œè¿›è¡ŒåŠ¨æ€åˆ‡æ¢classï¼›å¹¶v-bind:classå¯ä»¥å’Œæ™®é€šclasså±æ€§å…±å­˜ 123&lt;div class="static" v-bind:class="&#123; active: isActive, 'text-danger': hasError &#125;"&gt;&lt;/div&gt; å¯ä»¥ç›´æ¥ç»‘å®šdataé‡Œçš„ä¸€ä¸ªå¯¹è±¡ 12345678&lt;div v-bind:class="classObject"&gt;&lt;/div&gt;// jsdata: &#123; classObject: &#123; active: true, 'text-danger': false &#125;&#125; ä¹Ÿå¯ä»¥ç»‘å®šä¸€ä¸ªcomputedé‡Œçš„å¯¹è±¡ 1234567891011121314&lt;div v-bind:class="classObject"&gt;&lt;/div&gt;// jsdata: &#123; isActive: true, error: null&#125;,computed: &#123; classObject: function () &#123; return &#123; active: this.isActive &amp;&amp; !this.error, 'text-danger': this.error &amp;&amp; this.error.type === 'fatal', &#125; &#125;&#125; æ•°ç»„è¯­æ³• å¯ä»¥æŠŠæ•°ç»„ä¼ é€’ç»™v-bind:classï¼Œä»¥åº”ç”¨ä¸€ä¸ªclassåˆ—è¡¨ 123456&lt;div v-bind:class="[activeClass, errorClass]"&gt;// jsdata: &#123; activeClass: 'active', errorClass: 'text-danger'&#125; å¯ä»¥åœ¨æ•°ç»„ä¸­ä½¿ç”¨æ¡ä»¶è¡¨è¾¾å¼ 1&lt;div v-bind:class="[isActive ? activeClass : '', errorClass]"&gt; å¯ä»¥åœ¨æ•°ç»„ä¸­ä½¿ç”¨å¯¹è±¡è¯­æ³• 1&lt;div v-bind:class="[&#123; active: isActive &#125;, errorClass]"&gt; ç»‘å®šå†…è”æ ·å¼ç±»ä¼¼ng-style å¯¹è±¡è¯­æ³• ç›´æ¥ç»‘å®šä¸€ä¸ªå¯¹è±¡ï¼ŒCSSå±æ€§åç”¨é©¼å³°å¼(camelCase) 123456&lt;div v-bind:style="&#123; color: activeColor, fontSize: fontSize + 'px' &#125;"&gt;&lt;/div&gt;// jsdata: &#123; activeColor: 'red', fontSize: 30&#125; æ•°ç»„è¯­æ³• v-bind:style çš„æ•°ç»„è¯­æ³•å¯ä»¥å°†å¤šä¸ªæ ·å¼å¯¹è±¡åº”ç”¨åˆ°ä¸€ä¸ªå…ƒç´ ä¸Š1&lt;div v-bind:style="[baseStyles, overridingStyles]"&gt; å¤šé‡å€¼ ä» 2.3.0 èµ·ä½ å¯ä»¥ä¸º style ç»‘å®šä¸­çš„å±æ€§æä¾›ä¸€ä¸ªåŒ…å«å¤šä¸ªå€¼çš„æ•°ç»„ï¼Œå¸¸ç”¨äºæä¾›å¤šä¸ªå¸¦å‰ç¼€çš„å€¼1&lt;div :style="&#123; display: ['-webkit-box', '-ms-flexbox', 'flex'] &#125;"&gt; æ¡ä»¶æ¸²æŸ“ç±»ä¼¼ng-if v-if æ¡ä»¶ä¸ºtrueæ—¶ï¼Œåˆ™æ¸²æŸ“ï¼Œå°†å…ƒç´ æ·»åŠ åˆ°DOMä¸­ï¼Œä¸ºfalseï¼Œåˆ™å°†å…¶ä»domä¸­åˆ é™¤ 1&lt;h1 v-if="ok"&gt;Yes&lt;/h1&gt; æ¡ä»¶æ¸²æŸ“ä¸€ç»„ å¯ä»¥å°†éœ€è¦æ¡ä»¶æ¸²æŸ“çš„å…ƒç´ æ”¾åˆ°&lt;template&gt;å…ƒç´ ä¸­ï¼Œç„¶åç”¨v-ifæ¡ä»¶æ¸²æŸ“12345&lt;template v-if="ok"&gt; &lt;h1&gt;Title&lt;/h1&gt; &lt;p&gt;Paragraph 1&lt;/p&gt; &lt;p&gt;Paragraph 2&lt;/p&gt;&lt;/template&gt; v-else å¯ä»¥ä½¿ç”¨v-elseæŒ‡ä»¤æ¥è¡¨ç¤ºv-ifçš„â€elseå—â€ 123456&lt;div v-if="Math.random() &gt; 0.5"&gt; Now you see me&lt;/div&gt;&lt;div v-else&gt; Now you don't&lt;/div&gt; v-elseå…ƒç´ å¿…é¡»ç´§è·Ÿåœ¨v-ifæˆ–è€…v-else-ifå…ƒç´ çš„åé¢â€”â€”å¦åˆ™å®ƒå°†ä¸ä¼šè¢«è¯†åˆ« v-else-if å……å½“â€else ifå—â€ï¼›å¯é“¾å¼è°ƒç”¨ 123456789101112&lt;div v-if="type === 'A'"&gt; A&lt;/div&gt;&lt;div v-else-if="type === 'B'"&gt; B&lt;/div&gt;&lt;div v-else-if="type === 'C'"&gt; C&lt;/div&gt;&lt;div v-else&gt; Not A/B/C&lt;/div&gt; ç±»ä¼¼äº v-elseï¼Œv-else-if å¿…é¡»ç´§è·Ÿåœ¨ v-if æˆ–è€… v-else-if å…ƒç´ ä¹‹å ç”¨ key ç®¡ç†å¯å¤ç”¨çš„å…ƒç´  é»˜è®¤æƒ…å†µä¸‹ï¼Œvueä¼šå°½å¯èƒ½çš„é«˜æ•ˆæ¸²æŸ“å…ƒç´ ï¼Œé€šå¸¸ä¼šå¤ç”¨å·²æœ‰å…ƒç´ è€Œä¸æ˜¯ä»å¤´å¼€å§‹æ¸²æŸ“ã€‚ 123456789&lt;template v-if="loginType === 'username'"&gt; &lt;label&gt;Username&lt;/label&gt; &lt;input placeholder="Enter your username"&gt;&lt;/template&gt;&lt;template v-else&gt; &lt;label&gt;Email&lt;/label&gt; &lt;input placeholder="Enter your email address"&gt;&lt;/template&gt;// è¿™é‡Œçš„inputä¼šè¢«å¤ç”¨ï¼Œå¹¶ä¸ä¼šå› ä¸ºifå’Œelseè€Œæ¸²æŸ“ä¸¤ä¸ªï¼Œåªæ˜¯æ”¹å˜placeholderï¼Œè¿™æ ·æ•ˆç‡æ›´é«˜ æœ‰æ—¶ï¼Œæˆ‘ä»¬å°±æ˜¯éœ€è¦æ¸²æŸ“ä¸¤ä¸ªï¼Œè¿™æ˜¯å°±éœ€è¦ä½¿ç”¨keyï¼›å¦‚ä¸Šé¢ä¾‹å­ï¼Œä¸ºè¿™ä¸¤ä¸ªinputåˆ†åˆ«æ·»åŠ ä¸€ä¸ªå”¯ä¸€çš„keyå€¼æ—¶ï¼Œåˆ‡æ¢æ—¶ï¼Œvueå°±ä¸ä¼šå¤ç”¨ä»–ä»¬ï¼Œè€Œæ˜¯é‡æ–°æ¸²æŸ“ä¸€ä¸ª 123456789&lt;template v-if="loginType === 'username'"&gt; &lt;label&gt;Username&lt;/label&gt; &lt;input placeholder="Enter your username" key="username-input"&gt;&lt;/template&gt;&lt;template v-else&gt; &lt;label&gt;Email&lt;/label&gt; &lt;input placeholder="Enter your email address" key="email-input"&gt;&lt;/template&gt;// æ³¨æ„, &lt;label&gt; å…ƒç´ ä»ç„¶ä¼šè¢«é«˜æ•ˆåœ°å¤ç”¨ï¼Œå› ä¸ºå®ƒä»¬æ²¡æœ‰æ·»åŠ  key å±æ€§ã€‚ v-show é€šè¿‡åˆ‡æ¢å…ƒç´ çš„displayå±æ€§ï¼Œå…ƒç´ ä¼šä¸€ç›´ä¿ç•™åœ¨DOMä¸­ï¼Œå¹¶ä¸ä¼šå› ä¸ºä¸ºfalseï¼Œå°±æŠŠå…ƒç´ ä»DOMä¸­åˆ é™¤ï¼Œè¿™ç‚¹å’Œv-ifä¸åŒ v-ifå’Œv-show v-ifæ˜¯é€šè¿‡å¢åŠ ã€åˆ é™¤å…ƒç´ æ¥è¾¾åˆ°æ˜¾ç¤º/éšè— v-if ä¹Ÿæ˜¯æƒ°æ€§çš„ï¼šå¦‚æœåœ¨åˆå§‹æ¸²æŸ“æ—¶æ¡ä»¶ä¸ºå‡ï¼Œåˆ™ä»€ä¹ˆä¹Ÿä¸åšâ€”â€”ç›´åˆ°æ¡ä»¶ç¬¬ä¸€æ¬¡å˜ä¸ºçœŸæ—¶ï¼Œæ‰ä¼šå¼€å§‹æ¸²æŸ“æ¡ä»¶å—ã€‚ v-showé€šè¿‡cssåˆ‡æ¢(displayå±æ€§)æ¥æ˜¾ç¤º/éšè— v-showä¸ç®¡åˆå§‹æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Œå…ƒç´ æ€»æ˜¯ä¼šè¢«æ¸²æŸ“ï¼Œå¹¶ä¸”åªæ˜¯ç®€å•åœ°åŸºäº CSS è¿›è¡Œåˆ‡æ¢ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œ v-if æœ‰æ›´é«˜çš„åˆ‡æ¢å¼€é”€ï¼Œè€Œ v-show æœ‰æ›´é«˜çš„åˆå§‹æ¸²æŸ“å¼€é”€ã€‚å› æ­¤ï¼Œå¦‚æœéœ€è¦éå¸¸é¢‘ç¹åœ°åˆ‡æ¢ï¼Œåˆ™ä½¿ç”¨ v-show è¾ƒå¥½ï¼›å¦‚æœåœ¨è¿è¡Œæ—¶æ¡ä»¶ä¸å¤ªå¯èƒ½æ”¹å˜ï¼Œåˆ™ä½¿ç”¨ v-if è¾ƒå¥½ã€‚ v-ifå’Œv-forä¸€èµ·ä½¿ç”¨ v-for å…·æœ‰æ¯” v-if æ›´é«˜çš„ä¼˜å…ˆçº§ï¼›å…ˆå¾ªç¯ï¼Œå†åˆ¤æ–­æ˜¾ç¤ºéšè— åˆ—è¡¨æ¸²æŸ“v-for æ•°ç»„è¿­ä»£ 12345678910111213141516&lt;ul id="example-2"&gt; &lt;li v-for="(item, index) in items"&gt; &#123;&#123; parentMessage &#125;&#125; - &#123;&#123; index &#125;&#125; - &#123;&#123; item.message &#125;&#125; &lt;/li&gt;&lt;/ul&gt;// jsvar example2 = new Vue(&#123; el: '#example-2', data: &#123; parentMessage: 'Parent', items: [ &#123; message: 'Foo' &#125;, &#123; message: 'Bar' &#125; ] &#125;&#125;); æ¸²æŸ“å¤šä¸ªå…ƒç´ å—-&gt;ä½¿ç”¨&lt;template&gt;åŒ…è£¹ 123456&lt;ul&gt; &lt;template v-for="item in items"&gt; &lt;li&gt;&#123;&#123; item.msg &#125;&#125;&lt;/li&gt; &lt;li class="divider"&gt;&lt;/li&gt; &lt;/template&gt;&lt;/ul&gt; å¯¹è±¡è¿­ä»£ åœ¨éå†å¯¹è±¡æ—¶ï¼Œæ˜¯æŒ‰ Object.keys() çš„ç»“æœéå†ï¼Œä½†æ˜¯ä¸èƒ½ä¿è¯å®ƒçš„ç»“æœåœ¨ä¸åŒçš„ JavaScript å¼•æ“ä¸‹æ˜¯ä¸€è‡´çš„ã€‚1234567891011121314&lt;div v-for="(value, key, index) in object"&gt; &#123;&#123; index &#125;&#125;. &#123;&#123; key &#125;&#125; : &#123;&#123; value &#125;&#125;&lt;/div&gt;// jsnew Vue(&#123; el: '#repeat-object', data: &#123; object: &#123; firstName: 'John', lastName: 'Doe', age: 30 &#125; &#125;&#125;); æ•´æ•°è¿­ä»£ 1234&lt;div&gt; &lt;!-- spanä¼šé‡å¤10æ¬¡ --&gt; &lt;span v-for="n in 10"&gt;&#123;&#123; n &#125;&#125; &lt;/span&gt;&lt;/div&gt; v-forå’Œv-if å½“å®ƒä»¬å¤„äºåŒä¸€èŠ‚ç‚¹ï¼Œ v-for çš„ä¼˜å…ˆçº§æ¯” v-if æ›´é«˜ï¼Œè¿™æ„å‘³ç€ v-if å°†åˆ†åˆ«é‡å¤è¿è¡Œäºæ¯ä¸ª v-for å¾ªç¯ä¸­ã€‚ç›¸å½“äºåœ¨forå¾ªç¯ä¸­ï¼Œå†ç”¨ifåˆ¤æ–­ï¼› 123&lt;li v-for="todo in todos" v-if="!todo.isComplete"&gt; &#123;&#123; todo &#125;&#125;&lt;/li&gt; å¦‚æœæƒ³æ¡ä»¶åˆ¤æ–­äº†å†å¾ªç¯ï¼Œå¯ä»¥å…ˆifå†for 12345&lt;ul v-if="shouldRenderTodos"&gt; &lt;li v-for="todo in todos"&gt; &#123;&#123; todo &#125;&#125; &lt;/li&gt;&lt;/ul&gt; key vueé»˜è®¤ä¼šé‡‡å–â€å°±åœ°å¤ç”¨â€çš„ç­–ç•¥,å¦‚æœæ•°æ®é¡¹çš„é¡ºåºè¢«æ”¹å˜ï¼ŒVueå°†ä¸æ˜¯ç§»åŠ¨ DOM å…ƒç´ æ¥åŒ¹é…æ•°æ®é¡¹çš„é¡ºåºï¼Œ è€Œæ˜¯ç®€å•å¤ç”¨æ­¤å¤„æ¯ä¸ªå…ƒç´ ï¼Œå¹¶ä¸”ç¡®ä¿å®ƒåœ¨ç‰¹å®šç´¢å¼•ä¸‹æ˜¾ç¤ºå·²è¢«æ¸²æŸ“è¿‡çš„æ¯ä¸ªå…ƒç´ ã€‚ä¸ºäº†ç»™ Vue ä¸€ä¸ªæç¤ºï¼Œä»¥ä¾¿å®ƒèƒ½è·Ÿè¸ªæ¯ä¸ªèŠ‚ç‚¹çš„èº«ä»½ï¼Œä»è€Œé‡ç”¨å’Œé‡æ–°æ’åºç°æœ‰å…ƒç´ ï¼Œä½ éœ€è¦ä¸ºæ¯é¡¹æä¾›ä¸€ä¸ªå”¯ä¸€ key å±æ€§ã€‚123&lt;div v-for="item in items" :key="item.id"&gt; &lt;!-- å†…å®¹ --&gt;&lt;/div&gt; å»ºè®®å°½å¯èƒ½ä½¿ç”¨ v-for æ¥æä¾› key ï¼Œé™¤éè¿­ä»£ DOM å†…å®¹è¶³å¤Ÿç®€å•ï¼Œæˆ–è€…ä½ æ˜¯æ•…æ„è¦ä¾èµ–äºé»˜è®¤è¡Œä¸ºæ¥è·å¾—æ€§èƒ½æå‡ã€‚å› ä¸ºå®ƒæ˜¯ Vue è¯†åˆ«èŠ‚ç‚¹çš„ä¸€ä¸ªé€šç”¨æœºåˆ¶ï¼Œ key å¹¶ä¸ç‰¹åˆ«ä¸ v-for å…³è”ï¼Œkey è¿˜å…·æœ‰å…¶ä»–ç”¨é€”ï¼Œæˆ‘ä»¬å°†åœ¨åé¢çš„æŒ‡å—ä¸­çœ‹åˆ°å…¶ä»–ç”¨é€”ã€‚ æ•°ç»„æ›´æ–°æ£€æµ‹ å˜å¼‚æ–¹æ³• ä¼šæ”¹å˜åŸæ•°ç»„çš„æ–¹æ³•éƒ½ä¸ºå˜å¼‚æ–¹æ³•push()ã€pop()ã€shift()ã€unshift()ã€splice()ã€sort()ã€reverse()ï¼›æ‰€æœ‰å˜å¼‚æ–¹æ³•(ä¼šæ”¹å˜åŸæ•°ç»„çš„æ–¹æ³•)éƒ½ä¼šè§¦å‘æ›´æ–°æ£€æµ‹,è‹¥å‘ç°æ•°ç»„æœ‰å˜åŒ–ï¼Œåˆ™ä¼šæ›´æ–°ä¾èµ–å®ƒçš„åœ°æ–¹ é‡å¡‘æ•°ç»„ ä¸ä¼šæ”¹å˜åŸæ•°ç»„çš„æ–¹æ³•ä¸ºéå˜å¼‚æ–¹æ³•ï¼Œéå˜å¼‚æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼›filter(), concat(), slice()éƒ½æ˜¯éå˜å¼‚æ–¹æ³•ï¼›å½“ä½¿ç”¨æ–°è¿”å›çš„æ•°ç»„æ›¿æ¢åŸå…ˆçš„æ•°ç»„æ—¶(é‡å¡‘æ•°ç»„)ï¼Œä¸ç”¨æ‹…å¿ƒvueä¼šä¸¢å¼ƒç°æœ‰DOMé‡æ–°æ¸²æŸ“ï¼Œvueä¼šæ™ºèƒ½çš„å¤ç”¨DOMå…ƒç´ ï¼Œ123example1.items = example1.items.filter(function (item) &#123; return item.message.match(/Foo/)&#125;); æ³¨æ„ ç”±äºjsçš„é™åˆ¶ï¼Œvueä¸èƒ½æ£€æµ‹ä¸‹é¢å˜åŠ¨çš„æ•°ç»„ï¼Œå°†ä¸ä¼šè§¦å‘æ›´æ–° å½“ä½ åˆ©ç”¨ç´¢å¼•ç›´æ¥è®¾ç½®ä¸€ä¸ªé¡¹æ—¶ï¼Œä¾‹å¦‚ï¼š vm.items[indexOfItem] = newValue å½“ä½ ä¿®æ”¹æ•°ç»„çš„é•¿åº¦æ—¶ï¼Œä¾‹å¦‚ï¼š vm.items.length = newLength è§£å†³æ–¹æ³• ç¬¬ä¸€ç§é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨Vue.setæˆ–è€…spliceæ–¹æ³• 1234// Vue.setVue.set(example1.items, indexOfItem, newValue)// spliceæ–¹æ³•example1.items.splice(indexOfItem, 1, newValue) ç¬¬äºŒç§é—®é¢˜å¯ä»¥ä½¿ç”¨splice 1example1.items.splice(newLength) æ˜¾ç¤ºè¿‡æ»¤/æ’åºç»“æœ æˆ‘ä»¬æƒ³è¦æ˜¾ç¤ºä¸€ä¸ªæ•°ç»„çš„è¿‡æ»¤æˆ–æ’åºå‰¯æœ¬ï¼Œè€Œä¸å®é™…æ”¹å˜æˆ–é‡ç½®åŸå§‹æ•°æ®ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥åˆ›å»ºè¿”å›è¿‡æ»¤æˆ–æ’åºæ•°ç»„çš„è®¡ç®—å±æ€§ã€‚123456789101112&lt;li v-for="n in evenNumbers"&gt;&#123;&#123; n &#125;&#125;&lt;/li&gt;// jsdata: &#123; numbers: [ 1, 2, 3, 4, 5 ]&#125;,computed: &#123; evenNumbers: function () &#123; return this.numbers.filter(function (number) &#123; return number % 2 === 0 &#125;) &#125;&#125; äº‹ä»¶å¤„ç†å™¨ç›‘å¬äº‹ä»¶ v-on ä½¿ç”¨v-onç›‘å¬äº‹ä»¶ 1234&lt;div id="example-1"&gt; &lt;button v-on:click="counter += 1"&gt;å¢åŠ  1&lt;/button&gt; &lt;p&gt;è¿™ä¸ªæŒ‰é’®è¢«ç‚¹å‡»äº† &#123;&#123; counter &#125;&#125; æ¬¡ã€‚&lt;/p&gt;&lt;/div&gt; ç¼©å†™ v-on:click=&quot;xxx&quot;-&gt;@click=&quot;xxx&quot; æ–¹æ³•äº‹ä»¶å¤„ç†å™¨ ä¸ºäº‹ä»¶æŒ‡å®šä¸€ä¸ªå¤„ç†å‡½æ•°123456789101112131415161718192021222324&lt;div id="example-2"&gt; &lt;!-- `greet` æ˜¯åœ¨ä¸‹é¢å®šä¹‰çš„æ–¹æ³•å --&gt; &lt;button v-on:click="greet"&gt;Greet&lt;/button&gt;&lt;/div&gt;// jsvar example2 = new Vue(&#123; el: '#example-2', data: &#123; name: 'Vue.js' &#125;, // åœ¨ `methods` å¯¹è±¡ä¸­å®šä¹‰æ–¹æ³• methods: &#123; greet: function (event) &#123; // `this` åœ¨æ–¹æ³•é‡ŒæŒ‡å½“å‰ Vue å®ä¾‹ alert('Hello ' + this.name + '!') // `event` æ˜¯åŸç”Ÿ DOM äº‹ä»¶ if (event) &#123; alert(event.target.tagName) &#125; &#125; &#125;&#125;)// ä¹Ÿå¯ä»¥ç”¨ JavaScript ç›´æ¥è°ƒç”¨æ–¹æ³•example2.greet() // -&gt; 'Hello Vue.js!' å†…è”å¤„ç†å™¨æ–¹æ³• ç›´æ¥å°†å¤„ç†é€»è¾‘å†™åœ¨v-on:click=ä¹‹å 1234&lt;div id="example-3"&gt; &lt;button v-on:click="say('hi')"&gt;Say hi&lt;/button&gt; &lt;button v-on:click="say('what')"&gt;Say what&lt;/button&gt;&lt;/div&gt; ä¼ é€’eventç»™å†…è”å¤„ç†å™¨éœ€è¦ä½¿ç”¨$event 1234567891011&lt;button v-on:click="warn('Form cannot be submitted yet.', $event)"&gt; Submit&lt;/button&gt;// jsmethods: &#123; warn: function (message, event) &#123; // ç°åœ¨æˆ‘ä»¬å¯ä»¥è®¿é—®åŸç”Ÿäº‹ä»¶å¯¹è±¡ if (event) event.preventDefault() alert(message) &#125;&#125; äº‹ä»¶ä¿®é¥°ç¬¦ äº‹ä»¶ä¸­ç»å¸¸éœ€è¦è°ƒç”¨event.preventDefault() æˆ– event.stopPropagation()ï¼Œä¸ºäº†ç®€åŒ–æ“ä½œï¼Œä¹Ÿä¸ºäº†è®©å¤„ç†å‡½æ•°ä¸­åªæœ‰ä¸šåŠ¡é€»è¾‘æ²¡æœ‰äº‹ä»¶ç›¸å…³ç»†èŠ‚ï¼Œæ‰€ä»¥vueåœ¨v-on:ä¸Šæ·»åŠ ä¿®é¥°ç¬¦ .stop,.prevent,.capture,.self,.once 1234567891011121314&lt;!-- é˜»æ­¢å•å‡»äº‹ä»¶å†’æ³¡ --&gt;&lt;a v-on:click.stop="doThis"&gt;&lt;/a&gt;&lt;!-- æäº¤äº‹ä»¶ä¸å†é‡è½½é¡µé¢ --&gt;&lt;form v-on:submit.prevent="onSubmit"&gt;&lt;/form&gt;&lt;!-- ä¿®é¥°ç¬¦å¯ä»¥ä¸²è” --&gt;&lt;a v-on:click.stop.prevent="doThat"&gt;&lt;/a&gt;&lt;!-- åªæœ‰ä¿®é¥°ç¬¦ --&gt;&lt;form v-on:submit.prevent&gt;&lt;/form&gt;&lt;!-- æ·»åŠ äº‹ä»¶ä¾¦å¬å™¨æ—¶ä½¿ç”¨äº‹ä»¶æ•è·æ¨¡å¼ --&gt;&lt;div v-on:click.capture="doThis"&gt;...&lt;/div&gt;&lt;!-- åªå½“äº‹ä»¶åœ¨è¯¥å…ƒç´ æœ¬èº«ï¼ˆæ¯”å¦‚ä¸æ˜¯å­å…ƒç´ ï¼‰è§¦å‘æ—¶è§¦å‘å›è°ƒ --&gt;&lt;div v-on:click.self="doThat"&gt;...&lt;/div&gt;&lt;!-- ç‚¹å‡»äº‹ä»¶å°†åªä¼šè§¦å‘ä¸€æ¬¡ --&gt;&lt;a v-on:click.once="doThis"&gt;&lt;/a&gt; ä½¿ç”¨ä¿®é¥°ç¬¦æ—¶ï¼Œé¡ºåºå¾ˆé‡è¦ï¼›ç›¸åº”çš„ä»£ç ä¼šä»¥åŒæ ·çš„é¡ºåºäº§ç”Ÿã€‚å› æ­¤ï¼Œç”¨ @click.prevent.self ä¼šé˜»æ­¢æ‰€æœ‰çš„ç‚¹å‡»ï¼Œè€Œ @click.self.prevent åªä¼šé˜»æ­¢å…ƒç´ ä¸Šçš„ç‚¹å‡»ã€‚ é”®å€¼ä¿®é¥°ç¬¦ Vue å…è®¸ä¸º v-on åœ¨ç›‘å¬é”®ç›˜äº‹ä»¶æ—¶æ·»åŠ å…³é”®ä¿®é¥°ç¬¦ 123456&lt;!-- åªæœ‰åœ¨ keyCode æ˜¯ 13 æ—¶è°ƒç”¨ vm.submit() --&gt;&lt;input v-on:keyup.13="submit"&gt;&lt;!-- åŒä¸Š --&gt;&lt;input v-on:keyup.enter="submit"&gt;&lt;!-- ç¼©å†™è¯­æ³• --&gt;&lt;input @keyup.enter="submit"&gt; æŒ‰é”®åˆ«å .enter,.tab,.delete(æ•è·â€œåˆ é™¤â€å’Œâ€œé€€æ ¼â€é”®),.esc,.space,.up,.down,.left,.right å¯ä»¥é€šè¿‡å…¨å±€ config.keyCodes å¯¹è±¡è‡ªå®šä¹‰é”®å€¼ä¿®é¥°ç¬¦åˆ«å12// å¯ä»¥ä½¿ç”¨ v-on:keyup.f1Vue.config.keyCodes.f1 = 112 ä¿®é¥°é”® .ctrl,.alt,.shift,.meta 1234&lt;!-- Alt + C --&gt;&lt;input @keyup.alt.67="clear"&gt;&lt;!-- Ctrl + Click --&gt;&lt;div @click.ctrl="doSomething"&gt;Do something&lt;/div&gt; æ»‘é¼ æŒ‰é”®ä¿®é¥°ç¬¦ .left,.right,.middle è¡¨å•æ§ä»¶ç»‘å®šåŸºç¡€ç”¨æ³• v-model v-modelå¯ä»¥å®ç°è¡¨å•æ§ä»¶çš„åŒå‘ç»‘å®šï¼›å®ƒä¼šæ ¹æ®æ§ä»¶ç±»å‹è‡ªåŠ¨é€‰å–æ­£ç¡®çš„æ–¹æ³•æ¥æ›´æ–°å…ƒç´ ï¼›ç±»ä¼¼ng-model v-modelä¼šå¿½ç•¥æ‰€æœ‰è¡¨å•å…ƒç´ çš„valueã€checkedã€selectedç‰¹æ€§çš„åˆå§‹å€¼ã€‚å› ä¸ºå®ƒä¼šé€‰æ‹©Vueå®ä¾‹æ•°æ®æ¥ä½œä¸ºå…·ä½“çš„å€¼ã€‚åº”è¯¥é€šè¿‡dataé€‰é¡¹å£°æ˜åˆå§‹å€¼ã€‚ v-modelåœ¨ä¸­æ–‡è¾“å…¥(IME)æ—¶ä¸ä¼šæ›´æ–°ï¼Œå¯ä»¥ç›‘å¬inputäº‹ä»¶ ç®€å•çš„è¡¨å• 12345678&lt;!-- æ–‡æœ¬ --&gt;&lt;input v-model="message" placeholder="edit me"&gt;&lt;p&gt;Message is: &#123;&#123; message &#125;&#125;&lt;/p&gt;&lt;!-- å¤šè¡Œæ–‡æœ¬ --&gt;&lt;span&gt;Multiline message is:&lt;/span&gt;&lt;p style="white-space: pre-line"&gt;&#123;&#123; message &#125;&#125;&lt;/p&gt;&lt;br&gt;&lt;textarea v-model="message" placeholder="add multiple lines"&gt;&lt;/textarea&gt;&lt;!-- åœ¨æ–‡æœ¬åŒºåŸŸæ’å€¼( &lt;textarea&gt;&lt;/textarea&gt; ) å¹¶ä¸ä¼šç”Ÿæ•ˆï¼Œåº”ç”¨ v-model æ¥ä»£æ›¿ --&gt; å¤é€‰æ¡† å•ä¸ªå¤é€‰æ¡†ï¼Œé€»è¾‘å€¼ 12&lt;input type="checkbox" id="checkbox" v-model="checked"&gt;&lt;label for="checkbox"&gt;&#123;&#123; checked &#125;&#125;&lt;/label&gt; å¤šä¸ªå¤é€‰æ¡†ï¼Œv-modeléœ€è¦ç»‘å®šåˆ°åŒä¸€ä¸ªæ•°ç»„ä¸Š 123456789101112131415&lt;input type="checkbox" id="jack" value="Jack" v-model="checkedNames"&gt;&lt;label for="jack"&gt;Jack&lt;/label&gt;&lt;input type="checkbox" id="john" value="John" v-model="checkedNames"&gt;&lt;label for="john"&gt;John&lt;/label&gt;&lt;input type="checkbox" id="mike" value="Mike" v-model="checkedNames"&gt;&lt;label for="mike"&gt;Mike&lt;/label&gt;&lt;br&gt;&lt;span&gt;Checked names: &#123;&#123; checkedNames &#125;&#125;&lt;/span&gt;// jsnew Vue(&#123; el: '...', data: &#123; checkedNames: [] &#125;&#125;); å•é€‰æŒ‰é’® åŒä¸€ç»„ï¼Œv-modeléœ€è¦ç»‘å®šåˆ°åŒä¸€ä¸ªæ•°ç»„ä¸Š12345678910111213141516&lt;div id="example-4"&gt; &lt;input type="radio" id="one" value="One" v-model="picked"&gt; &lt;label for="one"&gt;One&lt;/label&gt; &lt;br&gt; &lt;input type="radio" id="two" value="Two" v-model="picked"&gt; &lt;label for="two"&gt;Two&lt;/label&gt; &lt;br&gt; &lt;span&gt;Picked: &#123;&#123; picked &#125;&#125;&lt;/span&gt;&lt;/div&gt;// jsnew Vue(&#123; el: '#example-4', data: &#123; picked: '' &#125;&#125;); select å•é€‰ 12345678910&lt;div id="example-5"&gt; &lt;select v-model="selected"&gt; &lt;option disabled value=""&gt;è¯·é€‰æ‹©&lt;/option&gt; &lt;option&gt;A&lt;/option&gt; &lt;option&gt;B&lt;/option&gt; &lt;option&gt;C&lt;/option&gt; &lt;/select&gt; &lt;span&gt;Selected: &#123;&#123; selected &#125;&#125;&lt;/span&gt;&lt;/div&gt;// å¦‚æœ v-model è¡¨è¾¾åˆå§‹çš„å€¼ä¸åŒ¹é…ä»»ä½•çš„é€‰é¡¹ï¼Œ&lt;select&gt; å…ƒç´ å°±ä¼šä»¥â€æœªé€‰ä¸­â€çš„çŠ¶æ€æ¸²æŸ“ã€‚åœ¨ iOS ä¸­ï¼Œè¿™ä¼šä½¿ç”¨æˆ·æ— æ³•é€‰æ‹©ç¬¬ä¸€ä¸ªé€‰é¡¹ï¼Œå› ä¸ºè¿™æ ·çš„æƒ…å†µä¸‹ï¼ŒiOS ä¸ä¼šå¼•å‘ change äº‹ä»¶ã€‚å› æ­¤ï¼Œåƒä»¥ä¸Šæä¾› disabled é€‰é¡¹æ˜¯å»ºè®®çš„åšæ³•ã€‚ å¤šé€‰åˆ—è¡¨ï¼ˆç»‘å®šåˆ°ä¸€ä¸ªæ•°ç»„ï¼‰ 12345678910111213141516&lt;div id="example-6"&gt; &lt;select v-model="selected" multiple style="width: 50px"&gt; &lt;option&gt;A&lt;/option&gt; &lt;option&gt;B&lt;/option&gt; &lt;option&gt;C&lt;/option&gt; &lt;/select&gt; &lt;br&gt; &lt;span&gt;Selected: &#123;&#123; selected &#125;&#125;&lt;/span&gt;&lt;/div&gt;// jsnew Vue(&#123; el: '#example-6', data: &#123; selected: [] &#125;&#125;); åŠ¨æ€é€‰é¡¹(ä½¿ç”¨v-foræ¸²æŸ“) 123456789101112131415161718&lt;select v-model="selected"&gt; &lt;option v-for="option in options" v-bind:value="option.value"&gt; &#123;&#123; option.text &#125;&#125; &lt;/option&gt;&lt;/select&gt;&lt;span&gt;Selected: &#123;&#123; selected &#125;&#125;&lt;/span&gt;// jsnew Vue(&#123; el: '...', data: &#123; selected: 'A', options: [ &#123; text: 'One', value: 'A' &#125;, &#123; text: 'Two', value: 'B' &#125;, &#123; text: 'Three', value: 'C' &#125; ] &#125;&#125;); ç»‘å®švalue å¯¹äºå•é€‰æŒ‰é’®ï¼Œå‹¾é€‰æ¡†åŠé€‰æ‹©åˆ—è¡¨é€‰é¡¹ï¼Œ v-model ç»‘å®šçš„ value é€šå¸¸æ˜¯é™æ€å­—ç¬¦ä¸²ï¼ˆå¯¹äºå‹¾é€‰æ¡†æ˜¯é€»è¾‘å€¼ï¼‰;ä½†æœ‰æ—¶æˆ‘ä»¬æƒ³ç»‘å®švalueåˆ°Vueå®ä¾‹çš„ä¸€ä¸ªåŠ¨æ€å±æ€§ä¸Š å¤é€‰æ¡† 123456&lt;input type="checkbox" v-model="toggle" v-bind:true-value="a" v-bind:false-value="b"&gt;// å½“é€‰ä¸­æ—¶vm.toggle === vm.a// å½“æ²¡æœ‰é€‰ä¸­æ—¶vm.toggle === vm.b å•é€‰æŒ‰é’® 123&lt;input type="radio" v-model="pick" v-bind:value="a"&gt;// å½“é€‰ä¸­æ—¶vm.pick === vm.a select 1234567&lt;select v-model="selected"&gt; &lt;!-- å†…è”å¯¹è±¡å­—é¢é‡ --&gt; &lt;option v-bind:value="&#123; number: 123 &#125;"&gt;123&lt;/option&gt;&lt;/select&gt;// å½“é€‰ä¸­æ—¶typeof vm.selected // -&gt; 'object'vm.selected.number // -&gt; 123 v-modelçš„ä¿®é¥°ç¬¦ .lazyåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œ v-model åœ¨ input äº‹ä»¶ä¸­åŒæ­¥è¾“å…¥æ¡†çš„å€¼ä¸æ•°æ® (é™¤äº† ä¸Šè¿° IME éƒ¨åˆ†)ï¼Œä½†ä½ å¯ä»¥æ·»åŠ ä¸€ä¸ªä¿®é¥°ç¬¦ lazy ï¼Œä»è€Œè½¬å˜ä¸ºåœ¨ change äº‹ä»¶ä¸­åŒæ­¥ 12&lt;!-- åœ¨ "change" è€Œä¸æ˜¯ "input" äº‹ä»¶ä¸­æ›´æ–° --&gt;&lt;input v-model.lazy="msg" &gt; .numberå¦‚æœæƒ³è‡ªåŠ¨å°†ç”¨æˆ·çš„è¾“å…¥å€¼è½¬ä¸º Number ç±»å‹ï¼ˆå¦‚æœåŸå€¼çš„è½¬æ¢ç»“æœä¸º NaN åˆ™è¿”å›åŸå€¼ï¼‰ï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªä¿®é¥°ç¬¦ number ç»™ v-model æ¥å¤„ç†è¾“å…¥å€¼ 1&lt;input v-model.number="age" type="number"&gt; .trimå¦‚æœè¦è‡ªåŠ¨è¿‡æ»¤ç”¨æˆ·è¾“å…¥çš„é¦–å°¾ç©ºæ ¼ï¼Œå¯ä»¥æ·»åŠ  trim ä¿®é¥°ç¬¦åˆ° v-model ä¸Šè¿‡æ»¤è¾“å…¥ 1&lt;input v-model.trim="msg"&gt; ç»„ä»¶vueä¸­çš„ç»„ä»¶å¾ˆç±»ä¼¼ng1ä¸­çš„directiveï¼Œé€šè¿‡è‡ªå®šä¹‰çš„htmlå…ƒç´ æ‰©å±•åŠŸèƒ½ ä½¿ç”¨ç»„ä»¶ æ³¨å†Œ å…¨å±€æ³¨å†Œ 123456789101112131415161718// Vue.component('ç»„ä»¶å',é€‰é¡¹å¯¹è±¡ );// é€‰é¡¹å¯¹è±¡å’Œnew Vue()ä¸­çš„å‡ ä¹ä¸€æ ·ï¼Œåªæœ‰ä¸ªåˆ«å±æ€§ä½¿ç”¨ä¸ä¸€æ ·ï¼›//ç»„ä»¶åå»ºè®®ä½¿ç”¨kebab-case(çŸ­æ¨ªçº¿éš”å¼€å¼)è¿æ¥ï¼Œä¸è¦ä½¿ç”¨camelCased(é©¼å³°å¼)ï¼Œå› ä¸ºhtmlç‰¹æ€§ä¸åŒºåˆ†å¤§å°å†™ï¼Œç±»ä¼¼ng1ä¸­çš„directiveå‘½åï¼Œä¸ºæ–¹ä¾¿ï¼ŒåŒæ„ä½¿ç”¨kebab-caseå½¢å¼// Vue.component()ï¼›ä¸å­˜åœ¨ç±»ä¼¼å‡½æ•°çš„å£°æ˜æå‡æœºåˆ¶ï¼Œæ‰€ä»¥å…¨å±€ç»„ä»¶å¿…é¡»åœ¨æ ¹å®ä¾‹ä¹‹å‰æ³¨å†Œ&lt;div id="example"&gt; &lt;my-component&gt;&lt;/my-component&gt;&lt;/div&gt;// æ³¨å†Œ-&gt;åœ¨åˆ›å»ºæ ¹å®ä¾‹ä¹‹å‰æ³¨å†ŒVue.component('my-component', &#123; template: '&lt;div&gt;A custom component!&lt;/div&gt;' // templateå¿…é¡»åªæœ‰ä¸€ä¸ªè·ŸèŠ‚ç‚¹ï¼Œç±»ä¼¼ng1&#125;)// åˆ›å»ºæ ¹å®ä¾‹new Vue(&#123; el: '#example'&#125;);// æ¸²æŸ“ä¸º&lt;div id="example"&gt; &lt;div&gt;A custom component!&lt;/div&gt; // vueä¸­è‡ªå®šä¹‰å…ƒç´ å°†ç›´æ¥è¢«æ›¿æ¢ï¼Œç±»ä¼¼ng1ä¸­å®šä¹‰æŒ‡ä»¤æ—¶é…ç½®äº†replace:true&lt;/div&gt; å±€éƒ¨æ³¨å†Œ é€šè¿‡ä½¿ç”¨ç»„ä»¶é€‰é¡¹å¯¹è±¡ä¸­çš„componentsæ¥æ³¨å†Œï¼Œè®©å…¶ä»…åœ¨ä¸€ä¸ªå®ä¾‹/ç»„ä»¶çš„ä½œç”¨åŸŸä¸­å¯ç”¨12345678910var Child = &#123; template: '&lt;div&gt;A custom component!&lt;/div&gt;'&#125;;new Vue(&#123; el:'#test', components: &#123; // &lt;my-component&gt; å°†åªåœ¨çˆ¶æ¨¡æ¿å¯ç”¨(#testå®ä¾‹çš„èŒƒå›´ä¸­ä½¿ç”¨) 'my-component': Child &#125;&#125;); is åœ¨ç°æœ‰htmlä¸Šæ·»åŠ åŠŸèƒ½ï¼Œç±»ä¼¼ng1æŒ‡ä»¤ä¸­çš„restrict:A-&gt;å› ä¸ºhtmlçš„é™åˆ¶ï¼ŒæŸäº›æ ‡ç­¾ä¸‹åªèƒ½å‡ºç°ç‰¹å®šçš„æ ‡ç­¾ï¼Œå‡ºç°å…¶ä»–æ ‡ç­¾è§†ä¸ºæ— æ•ˆï¼Œå¦‚selectä¸‹åªèƒ½æ˜¯optionï¼›æ‰€ä»¥å˜é€šçš„æ–¹æ³•æ˜¯é‡‡ç”¨isç‰¹æ€§ 12345678// æ— æ•ˆ&lt;table&gt; &lt;my-row&gt;...&lt;/my-row&gt;&lt;/table&gt;// æœ‰æ•ˆ&lt;table&gt; &lt;tr is="my-row"&gt;&lt;/tr&gt;&lt;/table&gt; ä¸‹æ¥æºä¹‹ä¸€çš„å­—ç¬¦ä¸²æ¨¡æ¿ï¼Œæ­¤é™åˆ¶å°†ä¸é€‚ç”¨ï¼š &lt;script type=&quot;text/x-template&quot;&gt; JavaScript å†…è”æ¨¡ç‰ˆå­—ç¬¦ä¸² .vueç»„ä»¶ dataå¿…é¡»æ˜¯å‡½æ•° é€šè¿‡ Vue æ„é€ å™¨ä¼ å…¥çš„å„ç§é€‰é¡¹å¤§å¤šæ•°éƒ½å¯ä»¥åœ¨ç»„ä»¶é‡Œç”¨ã€‚dataæ˜¯ä¸€ä¸ªä¾‹å¤–ï¼Œå®ƒå¿…é¡»æ˜¯å‡½æ•°ï¼Œè‹¥ä¸æ˜¯å‡½æ•°ï¼ŒVueå°†å‘å‡ºè­¦å‘Š å¦‚æœé€šè¿‡dataå‡½æ•°è¿”å›ä¸€ä¸ªå¯¹è±¡(å¼•ç”¨å€¼)ï¼Œé‚£ä¹ˆæ³¨å†Œçš„æ‰€æœ‰ç»„ä»¶éƒ½å°†å…±ç”¨è¿™ä¸ªå¯¹è±¡1234567891011121314151617&lt;div id="example-2"&gt; &lt;simple-counter&gt;&lt;/simple-counter&gt; &lt;simple-counter&gt;&lt;/simple-counter&gt; &lt;simple-counter&gt;&lt;/simple-counter&gt;&lt;/div&gt;var data = &#123; counter: 0 &#125;;Vue.component('simple-counter', &#123; template: '&lt;button v-on:click="counter += 1"&gt;&#123;&#123; counter &#125;&#125;&lt;/button&gt;', // æŠ€æœ¯ä¸Š data çš„ç¡®æ˜¯ä¸€ä¸ªå‡½æ•°äº†ï¼Œå› æ­¤ Vue ä¸ä¼šè­¦å‘Šï¼Œ // ä½†æ˜¯æˆ‘ä»¬è¿”å›ç»™æ¯ä¸ªç»„ä»¶çš„å®ä¾‹çš„å´å¼•ç”¨äº†åŒä¸€ä¸ªdataå¯¹è±¡ data: function () &#123; return data &#125;&#125;);new Vue(&#123; el: '#example-2'&#125;); çˆ¶å­ç»„ä»¶å¦‚ä½•é€šä¿¡ props down, events up; çˆ¶ç»„ä»¶é€šè¿‡å­ç»„ä»¶çš„propsæ¥å£ï¼Œå°†æ•°æ®ä¼ é€’ç»™å­ç»„ä»¶ï¼›å­ç»„ä»¶é€šè¿‡äº‹ä»¶çš„å½¢å¼ç»™çˆ¶ç»„ä»¶å‘é€æ¶ˆæ¯ proprs ç»„ä»¶æœŸæœ›è·å¾—çš„æ•°æ®ï¼Œæœ‰ç‚¹ç±»ä¼¼ng1æŒ‡ä»¤ä¸­çš„scopeå±æ€§ 123456789Vue.component('child', &#123; // å£°æ˜ props props: ['message'], // å°±åƒ data ä¸€æ ·ï¼Œprop å¯ä»¥ç”¨åœ¨æ¨¡æ¿å†… // åŒæ ·ä¹Ÿå¯ä»¥åœ¨ vm å®ä¾‹ä¸­åƒâ€œthis.messageâ€è¿™æ ·ä½¿ç”¨ template: '&lt;span&gt;&#123;&#123; message &#125;&#125;&lt;/span&gt;'&#125;);// é€šè¿‡childç»„ä»¶çš„messageæ¥å£å°†æ•°æ®ä¼ å…¥&lt;child message="hello!"&gt;&lt;/child&gt; åŠ¨æ€prop åœ¨æ¨¡æ¿ä¸­ï¼Œè¦åŠ¨æ€åœ°ç»‘å®šçˆ¶ç»„ä»¶çš„æ•°æ®åˆ°å­æ¨¡æ¿çš„ propsï¼Œä¸ç»‘å®šåˆ°ä»»ä½•æ™®é€šçš„HTMLç‰¹æ€§ç›¸ç±»ä¼¼ï¼Œå°±æ˜¯ç”¨ v-bindã€‚æ¯å½“çˆ¶ç»„ä»¶çš„æ•°æ®å˜åŒ–æ—¶ï¼Œè¯¥å˜åŒ–ä¹Ÿä¼šä¼ å¯¼ç»™å­ç»„ä»¶ 12345&lt;div&gt; &lt;input v-model="parentMsg"&gt; &lt;br&gt; &lt;child v-bind:my-message="parentMsg"&gt;&lt;/child&gt;&lt;/div&gt; ç”¨v-bindç»‘å®šçš„æ•°æ®å‘ç”Ÿå‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šå°†å˜åŒ–ä¼ å¯¼åˆ°å­ç»„ä»¶ 123456789101112131415161718192021222324&lt;div id="app"&gt; &lt;child message='çº¯æ–‡æœ¬'&gt;&lt;/child&gt; &lt;child message='test1'&gt;&lt;/child&gt; &lt;child message='test2'&gt;&lt;/child&gt; &lt;child v-bind:message='test2'&gt;&lt;/child&gt;&lt;/div&gt;&lt;button&gt;ç‚¹å‡»&lt;/button&gt;var vm = new Vue(&#123; el: '#app', data: &#123; test1: 'æˆ‘æ˜¯å˜é‡1', test2: 'æˆ‘æ˜¯å˜é‡2' &#125;, components: &#123; 'child': &#123; props: ['message'], template: '&lt;h1&gt;&#123;&#123;message&#125;&#125;&lt;/h1&gt;' &#125; &#125;&#125;);document.querySelector('button').onclick = function() &#123; vm.test2 = 'æˆ‘æ˜¯å˜é‡2ï¼Œæˆ‘è¢«æ”¹å˜äº†'; console.log(vm);&#125;; ä¸è¦ä½¿ç”¨å­—é¢é‡å½¢å¼ä¼ é€’æ•°å€¼ï¼Œä½¿ç”¨v-bindå°†å…¶è½¬åŒ–æˆè¡¨è¾¾å¼ï¼›ä¸‹é¢ä¾‹å­ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå­—é¢ propï¼Œå®ƒçš„å€¼æ˜¯å­—ç¬¦ä¸² â€œ1â€ è€Œä¸æ˜¯ numberã€‚å¦‚æœæƒ³ä¼ é€’ä¸€ä¸ªå®é™…çš„ numberï¼Œéœ€è¦ä½¿ç”¨ v-bindï¼Œä»è€Œè®©å®ƒçš„å€¼è¢«å½“ä½œ JavaScript è¡¨è¾¾å¼è®¡ç®— 1234&lt;!-- ä¼ é€’äº†ä¸€ä¸ªå­—ç¬¦ä¸² "1" --&gt;&lt;comp some-prop="1"&gt;&lt;/comp&gt;&lt;!-- ä¼ é€’å®é™…çš„ number --&gt;&lt;comp v-bind:some-prop="1"&gt;&lt;/comp&gt; å•å‘æ•°æ®æµ propæ˜¯å•å‘çš„ï¼Œåªèƒ½çˆ¶ä¼ é€’åˆ°å­ï¼Œåä¹‹åˆ™ä¸è¡Œ çˆ¶ç»„ä»¶æ›´æ–°æ—¶ï¼Œå­ç»„ä»¶çš„æ‰€æœ‰propä¹Ÿå°†å¾—åˆ°æ›´æ–° é‡åˆ°ä¸‹é¢æƒ…å†µï¼Œå¯èƒ½éœ€è¦ä¿®æ”¹propä¸­çš„æ•°æ® prop ä½œä¸ºåˆå§‹å€¼ä¼ å…¥åï¼Œå­ç»„ä»¶æƒ³æŠŠå®ƒå½“ä½œå±€éƒ¨æ•°æ®æ¥ç”¨ è§£å†³æ–¹æ³• å®šä¹‰ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œå¹¶ç”¨ prop çš„å€¼åˆå§‹åŒ–å®ƒ1234props: ['initialCounter'],data: function () &#123; return &#123; counter: this.initialCounter &#125;&#125; prop ä½œä¸ºåˆå§‹å€¼ä¼ å…¥ï¼Œç”±å­ç»„ä»¶å¤„ç†æˆå…¶å®ƒæ•°æ®è¾“å‡º è§£å†³æ–¹æ³• å®šä¹‰ä¸€ä¸ªè®¡ç®—å±æ€§ï¼Œå¤„ç† prop çš„å€¼å¹¶è¿”å›123456props: ['size'],computed: &#123; normalizedSize: function () &#123; return this.size.trim().toLowerCase() &#125;&#125; æ³¨æ„åœ¨ JavaScript ä¸­å¯¹è±¡å’Œæ•°ç»„æ˜¯å¼•ç”¨ç±»å‹ï¼ŒæŒ‡å‘åŒä¸€ä¸ªå†…å­˜ç©ºé—´ï¼Œå¦‚æœ prop æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–æ•°ç»„ï¼Œåœ¨å­ç»„ä»¶å†…éƒ¨æ”¹å˜å®ƒä¼šå½±å“çˆ¶ç»„ä»¶çš„çŠ¶æ€ã€‚ propéªŒè¯ æœ‰æ—¶éœ€è¦å¯¹ä¼ å…¥ç»„ä»¶çš„æ•°æ®å…ˆè¿›è¡ŒéªŒè¯å†æ“ä½œ 12345678910111213141516171819202122232425262728293031Vue.component('example', &#123; props: &#123; // åŸºç¡€ç±»å‹æ£€æµ‹ (`null` æ„æ€æ˜¯ä»»ä½•ç±»å‹éƒ½å¯ä»¥) propA: Number, // å¤šç§ç±»å‹ propB: [String, Number], // å¿…ä¼ ä¸”æ˜¯å­—ç¬¦ä¸² propC: &#123; type: String, required: true &#125;, // æ•°å­—ï¼Œæœ‰é»˜è®¤å€¼ propD: &#123; type: Number, default: 100 &#125;, // æ•°ç»„/å¯¹è±¡çš„é»˜è®¤å€¼åº”å½“ç”±ä¸€ä¸ªå·¥å‚å‡½æ•°è¿”å› propE: &#123; type: Object,// æ³¨æ„æ˜¯æ„é€ å™¨ï¼Œå¹¶ä¸æ˜¯å­—ç¬¦ä¸² default: function () &#123; return &#123; message: 'hello' &#125; &#125; &#125;, // è‡ªå®šä¹‰éªŒè¯å‡½æ•° propF: &#123; validator: function (value) &#123; return value &gt; 10 &#125; &#125; &#125;&#125;); éªŒè¯æ—¶çš„typeå¯ä»¥æ˜¯:Stringã€Numberã€Booleanã€Functionã€Objectã€Arrayã€Symbol æ³¨æ„æ˜¯æ„é€ å™¨ï¼Œä¸æ˜¯å­—ç¬¦ä¸²1234// è¿™æ ·æ˜¯é”™è¯¯çš„type:'Boolean'// è¿™æ ·æ˜¯å¯¹çš„type:Boolean å½“ prop éªŒè¯å¤±è´¥ï¼ŒVue ä¼šåœ¨æŠ›å‡ºè­¦å‘Š (å¦‚æœä½¿ç”¨çš„æ˜¯å¼€å‘ç‰ˆæœ¬)ã€‚æ³¨æ„ props ä¼šåœ¨ç»„ä»¶å®ä¾‹åˆ›å»ºä¹‹å‰è¿›è¡Œæ ¡éªŒï¼Œæ‰€ä»¥åœ¨ default æˆ– validator å‡½æ•°é‡Œï¼Œè¯¸å¦‚ dataã€computed æˆ– methods ç­‰å®ä¾‹å±æ€§è¿˜æ— æ³•ä½¿ç”¨ã€‚ éPropå±æ€§ æ‰€è°“é prop å±æ€§ï¼Œå°±æ˜¯å®ƒå¯ä»¥ç›´æ¥ä¼ å…¥ç»„ä»¶ï¼Œè€Œä¸éœ€è¦å®šä¹‰ç›¸åº”çš„ propã€‚ æ˜ç¡®ç»™ç»„ä»¶å®šä¹‰ prop æ˜¯ä¼ å‚çš„æ¨èæ–¹å¼ épropå±æ€§ï¼Œå°†ä¼šè¢«è‡ªåŠ¨æ·»åŠ åˆ°æ¨¡æ¿çš„æ ¹å…ƒç´ ä¸Š 123456&lt;!-- æœ‰ä¸ªépropå±æ€§ï¼Œdata-3d-data-picker --&gt;&lt;bs-date-input data-3d-date-picker="true"&gt;&lt;/bs-date-input&gt;&lt;!-- bs-data-inputçš„æ¨¡æ¿ --&gt;&lt;input type="date" class="form-control"&gt;&lt;!-- æ¸²æŸ“å --&gt;&lt;input type="date" class="form-control" data-3d-date-picker="true"&gt; æ›¿æ¢/è¦†ç›–ç°æœ‰çš„ç‰¹æ€§ é»˜è®¤æƒ…å†µä¸‹ï¼Œåœ¨å‘ç”Ÿç‰¹æ€§å†²çªæ—¶ï¼Œä¼šé‡‡å–è¦†ç›–ç­–ç•¥ï¼Œä¼ é€’ç»™ç»„ä»¶çš„å€¼ä¼šè¦†ç›–ç»„ä»¶æœ¬èº«è®¾å®šçš„å€¼ã€‚å³ä¾‹å¦‚ä¼ é€’ type=â€largeâ€ å°†ä¼šè¦†ç›– type=â€dateâ€ classå’Œstyleç‰¹æ€§ï¼Œåœ¨å‘ç”Ÿå†²çªæ—¶ï¼Œä¼šé‡‡å–åˆå¹¶ç­–ç•¥ï¼Œè€Œä¸æ˜¯è¦†ç›–ç­–ç•¥12345&lt;bs-date-input type="num" data-3d-date-picker="true" class="date-picker-theme-dark"&gt;&lt;/bs-date-input&gt;&lt;!-- æ¨¡æ¿ --&gt;&lt;input type="date" class="form-control"&gt;&lt;!-- æ¸²æŸ“åï¼Œä¼ è¿›æ¥çš„typeè¦†ç›–äº†åŸå…ˆçš„typeï¼Œclasså®ç°äº†åˆå¹¶ --&gt;&lt;input type="num" class="form-control date-picker-theme-dark" data-3d-date-picker="true"&gt; è‡ªå®šä¹‰äº‹ä»¶ å¯ä»¥é€šè¿‡propså‘å­ç»„ä»¶ä¼ é€’æ•°æ®ï¼Œå­ç»„ä»¶å¯ä»¥é€šè¿‡è‡ªå®šä¹‰äº‹ä»¶å‘çˆ¶ç»„ä»¶å‘æ¶ˆæ¯ æ¯ä¸ªvueå®ä¾‹éƒ½å®ç°äº†äº‹ä»¶æ¥å£ vm.$on(eventName)ç›‘å¬äº‹ä»¶ vm.$emit(eventName)è§¦å‘äº‹ä»¶ çˆ¶ç»„ä»¶å¯ä»¥åœ¨ä½¿ç”¨å­ç»„ä»¶çš„åœ°æ–¹ç›´æ¥ç”¨v-onæ¥ç›‘å¬å­ç»„ä»¶è§¦å‘çš„è‡ªå®šä¹‰äº‹ä»¶ï¼Œæ³¨æ„åœ¨å­ç»„ä»¶çš„è‡ªå®šä¹‰æ ‡ç­¾ä¸Šç›´æ¥ä½¿ç”¨v-onåªèƒ½ç»‘å®šå­ç»„ä»¶ä¸»åŠ¨åˆ†å‘(é€šè¿‡$emitè§¦å‘)çš„äº‹ä»¶ï¼Œè¿™æ˜¯ä¸€ç§ç‰¹æ®Šå†™æ³•,å‘Šè¯‰çˆ¶ç»„ä»¶è¦ç›‘å¬æŸä¸ªè‡ªå®šä¹‰äº‹ä»¶ã€‚å¦‚æœæƒ³ç›´æ¥ä½¿ç”¨v-onä¸ºå­ç»„ä»¶ç»‘å®šäº‹ä»¶ï¼Œå°†æ— æ³•è§¦å‘ï¼›ä¾‹å­è§ä¸‹ä¸€å°èŠ‚ ä¸èƒ½ç”¨ $on ä¾¦å¬å­ç»„ä»¶æŠ›å‡ºçš„äº‹ä»¶ï¼Œè€Œå¿…é¡»åœ¨æ¨¡æ¿é‡Œç›´æ¥ç”¨ v-on ç»‘å®š 12345678910111213141516171819202122232425262728293031323334353637&lt;div id="counter-event-example"&gt; &lt;p&gt;&#123;&#123; total &#125;&#125;&lt;/p&gt; &lt;!-- è¿™é‡Œçš„v-on:increment="incrementTotal"ï¼Œå…¶å®åœ¨å‘Šè¯‰çˆ¶ç»„ä»¶(è¿™é‡Œæ˜¯æ ¹å®ä¾‹)è¦ç›‘å¬incrementäº‹ä»¶äº† --&gt; &lt;button-counter v-on:increment="incrementTotal"&gt;&lt;/button-counter&gt; &lt;button-counter v-on:increment="incrementTotal"&gt;&lt;/button-counter&gt;&lt;/div&gt;// jsVue.component('button-counter', &#123; template: '&lt;button v-on:click="incrementCounter"&gt;&#123;&#123; counter &#125;&#125;&lt;/button&gt;', data: function () &#123; return &#123; counter: 0 &#125; &#125;, methods: &#123; incrementCounter: function () &#123; this.counter += 1; this.$emit('increment');// åˆ†å‘'increment'è‡ªå®šä¹‰äº‹ä»¶ &#125; &#125;,&#125;);new Vue(&#123; el: '#counter-event-example', data: &#123; total: 0 &#125;, methods: &#123; incrementTotal: function () &#123;// æ¥æ”¶åˆ°å­ç»„ä»¶åˆ†å‘'increment'è‡ªå®šä¹‰äº‹ä»¶åè§¦å‘ this.total += 1 &#125; &#125;&#125;);// åœ¨v1ç‰ˆæœ¬ä¸­ï¼Œå­ç»„ä»¶åˆ†å‘çš„è‡ªå®šä¹‰äº‹ä»¶çš„è§¦å‘å‡½æ•°æ˜¯å†™åœ¨çˆ¶ç»„ä»¶çš„eventsä¸­;// è¿™æ ·å†™ï¼Œæœ‰ä¸ªä¸å¥½çš„åœ°æ–¹å°±æ˜¯çˆ¶ç»„ä»¶ä¸çŸ¥é“è¿™ä¸ªäº‹ä»¶åˆ°åº•æ˜¯å“ªä¸ªå­ç»„ä»¶åˆ†å‘çš„ï¼Œå¦‚æœå¤šä¸ªå­ç»„ä»¶åˆ†å‘äº†åŒä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œå°±æ— æ³•åˆ†è¾¨ã€‚// æ‰€ä»¥ä½œè€…ä¸ºäº†æ¸…æ™°çš„çŸ¥é“å…·ä½“æ˜¯å“ªä¸ªç»„ä»¶åˆ†å‘äº†äº‹ä»¶ï¼Œå°±å°†v-onç§»åˆ°äº†å­ç»„ä»¶çš„è‡ªå®šä¹‰æ ‡ç­¾ä¸Š// https://v1.vuejs.org/guide/components.html#Custom-Events// https://segmentfault.com/q/1010000004486740/a-1020000004487413 ç»™ç»„ä»¶ç»‘å®šåŸç”Ÿäº‹ä»¶ æœ‰æ—¶å€™ï¼Œä½ å¯èƒ½æƒ³åœ¨æŸä¸ªç»„ä»¶çš„æ ¹å…ƒç´ ä¸Šç›‘å¬ä¸€ä¸ªåŸç”Ÿäº‹ä»¶ã€‚ æ³¨æ„ï¼šåœ¨å­ç»„ä»¶çš„è‡ªå®šä¹‰æ ‡ç­¾ä¸Šç›´æ¥ä½¿ç”¨v-on:mouseenterï¼Œè¿™ç§äº‹ä»¶æ˜¯æ— æ³•ç›´æ¥è§¦å‘çš„(åªæœ‰å­ç»„ä»¶ä¸»åŠ¨$emitäº†mouseenteräº‹ä»¶ï¼Œæ‰ä¼šè§¦å‘)ï¼Œåœ¨å­ç»„ä»¶ä¸Šç›´æ¥ä½¿ç”¨v-onç»‘å®šçš„åªèƒ½æ˜¯å­ç»„ä»¶ä¸»åŠ¨åˆ†å‘çš„äº‹ä»¶ï¼Œå®ƒæ˜¯åœ¨å‘Šè¯‰çˆ¶ç»„ä»¶è¦ç›‘å¬æŸä¸ªè‡ªå®šä¹‰äº‹ä»¶ï¼Œæ˜¯ä¸€ç§ç‰¹æ®Šå†™æ³•ï¼› æƒ³ä¸ºæŸä¸ªç»„ä»¶ç»‘å®šä¸€ä¸ªåŸç”Ÿäº‹ä»¶(åœ¨æŸä¸ªç»„ä»¶çš„æ ¹å…ƒç´ ä¸Šç›‘å¬ä¸€ä¸ªåŸç”Ÿäº‹ä»¶)ï¼Œå¿…é¡»åœ¨è‡ªå®šä¹‰æ ‡ç­¾ä¸Šä½¿ç”¨v-on:äº‹ä»¶.native=xxx 1234&lt;!-- è¿™ä¸ªmouseenterç»‘å®šçš„å›è°ƒæ— æ³•è§¦å‘ï¼Œé™¤éå­ç»„ä»¶ä¸»åŠ¨$emitäº†mouseenterï¼Œcountæ‰ä¼šè¢«è°ƒç”¨ --&gt;&lt;button-counter v-on:child_increment="incrementTotal" v-on:mouseenter="count"&gt;&lt;/button-counter&gt;&lt;!-- v-on:mouseenter.nativeè¿™ç§å†™æ³•ï¼Œç»™button-counterçš„æ ¹æ ‡ç­¾ç»‘å®šäº†ä¸€ä¸ªåŸç”Ÿmouseenteräº‹ä»¶ï¼Œé¼ æ ‡ç§»å…¥ï¼Œå°±ä¼šè§¦å‘count --&gt;&lt;button-counter v-on:child_increment="incrementTotal" v-on:mouseenter.native="count"&gt;&lt;/button-counter&gt; å°ç»“ å­ç»„ä»¶çš„è‡ªå®šä¹‰æ ‡ç­¾ä¸Šç›´æ¥ä½¿ç”¨v-onåªé€‚åˆå­ç»„ä»¶å‘æ¶ˆæ¯ç»™çˆ¶ç»„ä»¶è¿™ç§æƒ…å†µï¼Œå¹¶ä¸”éœ€è¦å­ç»„ä»¶ä¸»åŠ¨$emité…åˆï¼Œç»è¿‡è¿™ä¸¤æ­¥æ‰èƒ½å®Œæˆå­ç»„ä»¶ç»™çˆ¶ç»„å‘æ¶ˆæ¯ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ å­ç»„ä»¶çš„è‡ªå®šä¹‰æ ‡ç­¾ä¸Šç›´æ¥ä½¿ç”¨v-on:å­ç»„ä»¶ä¸»åŠ¨åˆ†å‘çš„äº‹ä»¶å=xxx å­ç»„ä»¶åœ¨æ¡ä»¶åˆé€‚æ—¶ä¸»åŠ¨$emit(äº‹ä»¶å) æƒ³åœ¨å­ç»„ä»¶è‡ªå®šä¹‰æ ‡ç­¾ä¸Šç›´æ¥ä½¿ç”¨v-onç»™ç»„ä»¶æ ¹å…ƒç´ ç»‘å®šäº‹ä»¶ï¼Œå¿…é¡»æ·»åŠ .nativeä¿®é¥°ç¬¦ åŒå‘ç»‘å®š.sync å½“ä¸€ä¸ªå­ç»„ä»¶æ”¹å˜äº†ä¸€ä¸ª prop çš„å€¼æ—¶ï¼Œè¿™ä¸ªå˜åŒ–ä¹Ÿä¼šåŒæ­¥åˆ°çˆ¶ç»„ä»¶ä¸­æ‰€ç»‘å®šçš„å€¼ã€‚123456&lt;comp :foo.sync="bar"&gt;&lt;/comp&gt;&lt;!-- æœ¬è´¨ä¸ºä¸‹é¢çš„ --&gt;&lt;comp :foo="bar" @update:foo="val =&gt; bar = val"&gt;&lt;/comp&gt;&lt;!-- å­ç»„ä»¶å€¼å˜åŒ–æ—¶ï¼Œä¸»åŠ¨è§¦å‘updateäº‹ä»¶ --&gt;this.$emit('update:foo', newValue)&lt;!-- å…¶å®è¿™é‡Œçš„.syncä¹Ÿä½è¯äº†è‡ªå®šä¹‰æ ‡ç­¾ä¸Šç›´æ¥ä½¿ç”¨v-onç»‘å®šçš„äº‹ä»¶ï¼Œéœ€è¦é…åˆ$emitæ‰èƒ½è§¦å‘ --&gt; v-model v-modelå¸¸ç”¨æ¥é’ˆå¯¹è¡¨å•å®è¡ŒåŒå‘æ•°æ®ç»‘å®šï¼Œå®ƒçš„æœ¬è´¨æ˜¯ä¸ªè¯­æ³•ç³–ï¼›valueå±æ€§+inputäº‹ä»¶ 123&lt;input v-model="something"&gt;&lt;!-- æœ¬è´¨å¦‚ä¸‹ --&gt;&lt;input v-bind:value="something" v-on:input="something = $event.target.value"&gt; åˆ›å»ºè‡ªå®šä¹‰inputç»„ä»¶æ—¶ 12345678910111213141516171819202122232425262728293031323334353637&lt;!-- ä¸‹é¢2ç§æ•ˆæœä¸€æ · --&gt;&lt;currency-input v-model="price"&gt;&lt;/currency-input&gt;&lt;currency-input v-bind:value="price" v-on:input="price = arguments[0]"&gt;&lt;/currency-input&gt;Vue.component('currency-input', &#123; template: '&lt;span&gt;$&lt;input ref="input" v-bind:value="value" v-on:input="updateValue($event.target.value)"&gt;&lt;/span&gt;', props: &#123; value: Number &#125;, methods: &#123; // ä¸æ˜¯ç›´æ¥æ›´æ–°å€¼ï¼Œè€Œæ˜¯ä½¿ç”¨æ­¤æ–¹æ³•æ¥å¯¹è¾“å…¥å€¼è¿›è¡Œæ ¼å¼åŒ–å’Œä½æ•°é™åˆ¶ updateValue: function(value) &#123; var formattedValue = value // åˆ é™¤ä¸¤ä¾§çš„ç©ºæ ¼ç¬¦ .trim() // ä¿ç•™ 2 å°æ•°ä½ .slice( 0, value.indexOf('.') === -1 ? value.length : value.indexOf('.') + 3 ) // å¦‚æœå€¼ä¸ç»Ÿä¸€ï¼Œæ‰‹åŠ¨è¦†ç›–ä»¥ä¿æŒä¸€è‡´ if (formattedValue !== value) &#123; this.$refs.input.value = formattedValue &#125; // é€šè¿‡ input äº‹ä»¶å‘å‡ºæ•°å€¼ this.$emit('input', Number(formattedValue)) &#125; &#125;&#125;);var vm = new Vue(&#123; el: '#app', data: &#123; price: 3 &#125;&#125;); å®šåˆ¶v-model ä»ä¸ŠèŠ‚å¯çŸ¥ï¼Œv-modeléœ€è¦ä½¿ç”¨åˆ°è¡¨å•çš„valueå±æ€§å’Œinputäº‹ä»¶ï¼Œä½†å•é€‰ã€å¤é€‰ä¹‹ç±»çš„è¡¨å•ä¼šæŠŠvalueç”¨åšåˆ«çš„ç›®çš„ï¼›æ­¤æ—¶ä½¿ç”¨ç»„ä»¶é€‰é¡¹å¯¹è±¡çš„modelé€‰é¡¹å³å¯é¿å…å†²çª1234567891011121314151617181920Vue.component('my-checkbox', &#123; model: &#123;// v-modelä½¿ç”¨checkedå±æ€§å’Œchangeäº‹ä»¶å®ŒæˆåŒå‘ç»‘å®šï¼Œè€Œä¸ç”¨åŸæ¥çš„valueå±æ€§å’Œinputå±æ€§ prop: 'checked', event: 'change' &#125;, props: &#123; checked: Boolean, // this allows using the `value` prop for a different purposeï¼Œvalueå±æ€§å¯ä»¥ç”¨åšå…¶ä»–ç”¨é€” value: String &#125;, // ...&#125;);&lt;my-checkbox v-model="foo" value="some value"&gt;&lt;/my-checkbox&gt;&lt;!-- ç­‰ä»·äº --&gt;&lt;my-checkbox :checked="foo" @change="val =&gt; &#123; foo = val &#125;" value="some value"&gt;&lt;/my-checkbox&gt; éçˆ¶å­ç»„ä»¶é€šä¿¡ æœ‰æ—¶ï¼Œéçˆ¶å­å…³ç³»çš„ç»„ä»¶ä¹Ÿéœ€è¦é€šä¿¡ï¼Œè¿™æ—¶éœ€è¦ä¸€ä¸ªä¸­ä»‹æ¥ä¼ é€’ä¿¡æ¯ï¼Œåœ¨ç®€å•çš„åœºæ™¯ä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªç©ºçš„ Vue å®ä¾‹ä½œä¸ºä¸­å¤®äº‹ä»¶æ€»çº¿ 1234567var bus = new Vue();// è§¦å‘ç»„ä»¶ A ä¸­çš„äº‹ä»¶bus.$emit('id-selected', 1);// åœ¨ç»„ä»¶ B åˆ›å»ºçš„é’©å­ä¸­ç›‘å¬äº‹ä»¶bus.$on('id-selected', function (id) &#123; // ...&#125;); æ¡ˆä¾‹ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748&lt;div id="app"&gt; &lt;my-num :init-num="price"&gt;&lt;/my-num&gt; &lt;my-div&gt;&lt;/my-div&gt;&lt;/div&gt;Vue.component('my-num', &#123; template: '&lt;input type="num" v-model="num" @input="numChanged"&gt;', props: &#123; 'initNum': &#123; type: Number &#125; &#125;, data: function() &#123; return &#123; num: this.initNum &#125;; &#125;, methods: &#123; numChanged: function() &#123; console.log(this.num); bus.$emit('my-num-change', this.num); // é€šè¿‡busè§¦å‘my-num-change &#125; &#125;&#125;);Vue.component('my-div', &#123; template: '&lt;h1&gt;&#123;&#123;text&#125;&#125;&lt;/h1&gt;', data: function() &#123; return &#123; text: 'æˆ‘å°†å±•ç¤ºä¸Šé¢inputçš„å†…å®¹' &#125;; &#125;, created: function() &#123; // åˆ›å»ºå var _self = this; bus.$on('my-num-change', function(str) &#123; // ç›‘å¬my-num-changeäº‹ä»¶ _self.text = str; &#125;); &#125;&#125;);var bus = new Vue();var vm = new Vue(&#123; el: '#app', data: &#123; price: 3 &#125;&#125;); ä½¿ç”¨Slotåˆ†å‘å†…å®¹ç±»ä¼¼ng1ä¸­æŒ‡ä»¤çš„transcludeï¼Œç”¨æ¥æ··åˆçˆ¶ç»„ä»¶çš„å†…å®¹å’Œå­ç»„ä»¶çš„æ¨¡æ¿ ç¼–è¯‘ä½œç”¨åŸŸ çˆ¶ç»„ä»¶æ¨¡æ¿çš„å†…å®¹åœ¨çˆ¶ç»„ä»¶ä½œç”¨åŸŸå†…ç¼–è¯‘ï¼›å­ç»„ä»¶æ¨¡æ¿çš„å†…å®¹åœ¨å­ç»„ä»¶ä½œç”¨åŸŸå†…ç¼–è¯‘ã€‚1234567891011121314151617181920212223242526272829// messageå°†åœ¨çˆ¶ç»„ä»¶/å®ä¾‹çš„ä½œç”¨åŸŸä¸­ç¼–è¯‘ï¼Œå› ä¸º&#123;&#123;message&#125;&#125;å®é™…æ˜¯åœ¨çˆ¶ç»„ä»¶æ¨¡æ¿çš„å†…å®¹ä¸­ï¼Œè€Œä¸æ˜¯åœ¨å­ç»„ä»¶çš„æ¨¡æ¿å†…å®¹ä¸­&lt;child-component&gt; &#123;&#123; message &#125;&#125;&lt;/child-component&gt;// ä¸‹ä¾‹&#123;&#123;test&#125;&#125;ã€&#123;&#123;test2&#125;&#125;éƒ½å°†åœ¨æ ¹å®ä¾‹çš„ä½œç”¨åŸŸä¸‹ç¼–è¯‘&lt;div id="app"&gt; &lt;parent-comp&gt; &#123;&#123;test&#125;&#125; &lt;br&gt; &lt;child-comp&gt; &#123;&#123;test2&#125;&#125; &lt;/child-comp&gt; &lt;/parent-comp&gt;&lt;/div&gt;// å‡è®¾someChildPropertyæ˜¯å­ç»„ä»¶ä¸Šçš„å±æ€§ï¼Œä¸‹é¢ä¾‹å­æ— æ•ˆï¼Œå°†åœ¨çˆ¶ç»„ä»¶/å®ä¾‹çš„ä½œç”¨åŸŸä¸­æŸ¥æ‰¾someChildPropertyï¼Œä½ å¿…é¡»åœ¨child-componentä½œç”¨åŸŸä¸­ä½¿ç”¨someChildProperty&lt;child-component v-show="someChildProperty"&gt;&lt;/child-component&gt;// ä¸‹é¢æœ‰æ•ˆVue.component('child-component', &#123; // æœ‰æ•ˆï¼Œå› ä¸ºæ˜¯åœ¨æ­£ç¡®çš„ä½œç”¨åŸŸå†… template: '&lt;div v-show="someChildProperty"&gt;Child&lt;/div&gt;', data: function () &#123; return &#123; someChildProperty: true &#125; &#125;&#125;); åˆ†å‘å†…å®¹ çˆ¶ç»„ä»¶/å®ä¾‹ä¸­åµŒå¥—åœ¨å­ç»„ä»¶è‡ªå®šä¹‰ä¾¿ç­¾ä¸­çš„å†…å®¹éƒ½ç§°ä¸ºåˆ†å‘å†…å®¹ åˆ†å‘å†…å®¹æ˜¯åœ¨çˆ¶ä½œç”¨åŸŸå†…ç¼–è¯‘ åˆ†å‘å†…å®¹é€‚åˆæ··åˆ/åµŒå¥—å¤šä¸ªç»„ä»¶æ—¶ä½¿ç”¨1234&lt;!-- &#123;&#123;message&#125;&#125;å±äºåˆ†å‘å†…å®¹ï¼Œä»–å°†åœ¨child-componentçš„çˆ¶ä½œç”¨åŸŸä¸­ç¼–è¯‘ --&gt;&lt;child-component&gt; &#123;&#123; message &#125;&#125;&lt;/child-component&gt; slot é™¤éå­ç»„ä»¶æ¨¡æ¿åŒ…å«è‡³å°‘ä¸€ä¸ª&lt;slot&gt;æ’å£ï¼Œå¦åˆ™çˆ¶ç»„ä»¶çš„å†…å®¹å°†ä¼šè¢«ä¸¢å¼ƒã€‚ç±»ä¼¼ng1ä¸­directiveæ¨¡æ¿ä¸­ä¼šæŒ‡å®šä¸€ä¸ªæ ‡ç­¾ï¼Œæ·»åŠ ng-transcludeç‰¹æ€§ä¸€æ ·ï¼Œè¿™ä¸ªæ ‡ç­¾å°†æ¥æ”¶åœ¨çˆ¶ä½œç”¨åŸŸä¸­ç¼–è¯‘å¥½çš„åˆ†å‘å†…å®¹ å½“å­ç»„ä»¶æ¨¡æ¿åªæœ‰ä¸€ä¸ªæ²¡æœ‰å±æ€§çš„slotæ—¶ï¼Œçˆ¶ç»„ä»¶æ•´ä¸ªå†…å®¹ç‰‡æ®µå°†æ’å…¥åˆ°slotæ‰€åœ¨çš„DOMä½ç½®ï¼Œå¹¶æ›¿æ¢æ‰slotæ ‡ç­¾æœ¬èº« æœ€åˆåœ¨ æ ‡ç­¾ä¸­çš„ä»»ä½•å†…å®¹éƒ½è¢«è§†ä¸ºå¤‡ç”¨å†…å®¹ã€‚å¤‡ç”¨å†…å®¹åœ¨å­ç»„ä»¶çš„ä½œç”¨åŸŸå†…ç¼–è¯‘ï¼Œå¹¶ä¸”åªæœ‰åœ¨å®¿ä¸»å…ƒç´ ä¸ºç©ºï¼Œä¸”æ²¡æœ‰è¦æ’å…¥çš„å†…å®¹æ—¶æ‰æ˜¾ç¤ºå¤‡ç”¨å†…å®¹ã€‚12345678910111213141516171819202122232425// çˆ¶ç»„ä»¶æ¨¡æ¿ &lt;div&gt; &lt;h1&gt;æˆ‘æ˜¯çˆ¶ç»„ä»¶çš„æ ‡é¢˜&lt;/h1&gt; &lt;my-component&gt; &lt;p&gt;è¿™æ˜¯ä¸€äº›åˆå§‹å†…å®¹&lt;/p&gt; &lt;p&gt;è¿™æ˜¯æ›´å¤šçš„åˆå§‹å†…å®¹&lt;/p&gt; &lt;/my-component&gt;&lt;/div&gt;// å­ç»„ä»¶my-componentçš„æ¨¡æ¿&lt;div&gt; &lt;h2&gt;æˆ‘æ˜¯å­ç»„ä»¶çš„æ ‡é¢˜&lt;/h2&gt; &lt;slot&gt; åªæœ‰åœ¨æ²¡æœ‰è¦åˆ†å‘çš„å†…å®¹æ—¶æ‰ä¼šæ˜¾ç¤ºã€‚&lt;slot&gt;æ•´ä¸ªæ ‡ç­¾å°†è¢«åˆ†å‘å†…å®¹æ›¿æ¢ &lt;/slot&gt;&lt;/div&gt;// æ¸²æŸ“å&lt;div&gt; &lt;h1&gt;æˆ‘æ˜¯çˆ¶ç»„ä»¶çš„æ ‡é¢˜&lt;/h1&gt; &lt;div&gt; &lt;h2&gt;æˆ‘æ˜¯å­ç»„ä»¶çš„æ ‡é¢˜&lt;/h2&gt; &lt;!-- ä¸‹é¢æ˜¯åˆ†å‘å†…å®¹æ›¿æ¢äº†&lt;slot&gt; --&gt; &lt;p&gt;è¿™æ˜¯ä¸€äº›åˆå§‹å†…å®¹&lt;/p&gt; &lt;p&gt;è¿™æ˜¯æ›´å¤šçš„åˆå§‹å†…å®¹&lt;/p&gt; &lt;/div&gt;&lt;/div&gt; å…·åslot &lt;slot&gt;å…ƒç´ å¯ä»¥ç”¨ä¸€ä¸ªç‰¹æ®Šçš„å±æ€§ name æ¥é…ç½®å¦‚ä½•åˆ†å‘å†…å®¹ã€‚å¤šä¸ª slot å¯ä»¥æœ‰ä¸åŒçš„åå­—ã€‚å…·å slot å°†åŒ¹é…å†…å®¹ç‰‡æ®µä¸­æœ‰å¯¹åº” slot ç‰¹æ€§çš„å…ƒç´  ä»ç„¶å¯ä»¥æœ‰ä¸€ä¸ªåŒ¿å slotï¼Œå®ƒæ˜¯é»˜è®¤ slotï¼Œä½œä¸ºæ‰¾ä¸åˆ°åŒ¹é…çš„å†…å®¹ç‰‡æ®µçš„å¤‡ç”¨æ’æ§½ã€‚å¦‚æœæ²¡æœ‰é»˜è®¤çš„ slotï¼Œè¿™äº›æ‰¾ä¸åˆ°åŒ¹é…çš„å†…å®¹ç‰‡æ®µå°†è¢«æŠ›å¼ƒã€‚ å­ç»„ä»¶æ¨¡æ¿ä¸Šæœ‰ä¸ª&lt;slot&gt;æ ‡ç­¾ï¼Œé€šè¿‡æ ‡ç­¾ä¸Šçš„nameå±æ€§æ¥ç»™&lt;slot&gt;èµ·ä¸ªåå­—ï¼Œåˆ†å‘å†…å®¹ä¸Šæœ‰ä¸ªslotç‰¹æ€§ï¼Œé€šè¿‡è¿™ä¸ªslotç‰¹æ€§çš„å€¼æ‰¾åˆ°å­ç»„ä»¶ä¸­å¯¹åº”åå­—çš„&lt;slot&gt;æ ‡ç­¾ï¼Œå¹¶ç”¨åˆ†å‘å†…å®¹å°†å…¶æ›¿æ¢æ‰ã€‚1234567891011121314151617181920212223242526272829303132// app-layoutç»„ä»¶&lt;div class="container"&gt; &lt;header&gt; &lt;slot name="header"&gt;&lt;/slot&gt; // è¿™é‡Œå°†è¦æ”¾åå­—ä¸ºheaderçš„åˆ†å‘å†…å®¹ &lt;/header&gt; &lt;main&gt; &lt;slot&gt;&lt;/slot&gt;// è¿™é‡Œå°†è¦æ‰¾ä¸åˆ°åŒ¹é…çš„åˆ†å‘å†…å®¹ &lt;/main&gt; &lt;footer&gt; &lt;slot name="footer"&gt;&lt;/slot&gt;// è¿™é‡Œå°†è¦æ”¾åå­—ä¸ºfooterçš„åˆ†å‘å†…å®¹ &lt;/footer&gt;&lt;/div&gt;// çˆ¶ç»„ä»¶æ¨¡æ¿&lt;app-layout&gt;// è¿™é‡Œé¢çš„éƒ½æ˜¯åˆ†å‘å†…å®¹ &lt;h1 slot="header"&gt;è¿™é‡Œå¯èƒ½æ˜¯ä¸€ä¸ªé¡µé¢æ ‡é¢˜&lt;/h1&gt; // è¿™ä¸ªå°†æ”¾åˆ°headerçš„slotä¸­ &lt;p&gt;ä¸»è¦å†…å®¹çš„ä¸€ä¸ªæ®µè½ã€‚&lt;/p&gt; &lt;p&gt;å¦ä¸€ä¸ªä¸»è¦æ®µè½ã€‚&lt;/p&gt; &lt;p slot="footer"&gt;è¿™é‡Œæœ‰ä¸€äº›è”ç³»ä¿¡æ¯&lt;/p&gt;// è¿™ä¸ªå°†æ”¾åˆ°footerçš„slotä¸­&lt;/app-layout&gt;// æ¸²æŸ“å&lt;div class="container"&gt; &lt;header&gt; &lt;h1&gt;è¿™é‡Œå¯èƒ½æ˜¯ä¸€ä¸ªé¡µé¢æ ‡é¢˜&lt;/h1&gt; &lt;/header&gt; &lt;main&gt; &lt;p&gt;ä¸»è¦å†…å®¹çš„ä¸€ä¸ªæ®µè½ã€‚&lt;/p&gt; &lt;p&gt;å¦ä¸€ä¸ªä¸»è¦æ®µè½ã€‚&lt;/p&gt; &lt;/main&gt; &lt;footer&gt; &lt;p&gt;è¿™é‡Œæœ‰ä¸€äº›è”ç³»ä¿¡æ¯&lt;/p&gt; &lt;/footer&gt;&lt;/div&gt; ä½œç”¨åŸŸæ’æ§½(Scoped Slot) æ­£å¸¸æƒ…å†µä¸‹ï¼Œåˆ†å‘å†…å®¹æ˜¯åœ¨çˆ¶ç»„ä»¶çš„ä½œç”¨åŸŸä¸­ç¼–è¯‘çš„ï¼›è€ƒè™‘ä¸‹é¢æƒ…å†µ:æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªç»„ä»¶ï¼Œèƒ½ä½¿ç”¨åŒä¸€ä»½æ•°æ®ï¼Œæ ¹æ®DOMçš„ä¸åŒæ¸²æŸ“å‡ºä¸ä¸€æ ·çš„ç•Œé¢ï¼›åŒä¸€ä¸ªç»„ä»¶ï¼Œæœ‰ä¸åŒçš„DOMç»“æ„ï¼Œæˆ‘ä»¬è‚¯å®šä¸èƒ½å°†DOMç»“æ„å›ºæ­»åœ¨ç»„ä»¶å†…éƒ¨ï¼Œè‚¯å®šéœ€è¦å¤–éƒ¨ä¼ å…¥ï¼Œæˆ‘ä»¬å¾ˆå¿«å°±æƒ³åˆ°éœ€è¦ä½¿ç”¨åˆ†å‘å†…å®¹å’ŒSlotæ¥å®Œæˆï¼Œä½†è¿™æ ·ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬çš„DOMç»“æ„æ˜¯é€šè¿‡åˆ†å‘å†…å®¹ä¼ å…¥ç»„ä»¶å†…éƒ¨çš„ï¼Œä½†æ˜¯åˆ†å‘å†…å®¹åœ¨ä¼ å…¥å­ç»„ä»¶æ—¶ï¼Œå·²ç»åœ¨çˆ¶ç»„ä»¶çš„ä½œç”¨åŸŸä¸­ç¼–è¯‘è¿‡äº†ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒç”¨çš„æ•°æ®æ˜¯çˆ¶ç»„ä»¶çš„è€Œä¸æ˜¯å­ç»„ä»¶çš„ã€‚Scoped Slotå°±èƒ½è§£å†³è¿™ä¸€é—®é¢˜ï¼Œå®ƒèƒ½è®©åˆ†å‘å†…å®¹åœ¨ä¼ å…¥å­ç»„ä»¶å‰ä½¿ç”¨å­ç»„ä»¶çš„æ•°æ®ï¼›ä»¥å‰åˆ†å‘å†…å®¹åªèƒ½åœ¨çˆ¶ç»„ä»¶ä½œç”¨åŸŸä¸­ç¼–è¯‘ï¼Œæ ¹æœ¬æ— æ³•ä½¿ç”¨åˆ°å­ç»„ä»¶çš„æ•°æ®ï¼Œç°åœ¨ä½¿ç”¨Scoped Slotèƒ½å®ç°åˆ†å‘å†…å®¹ä½¿ç”¨å­ç»„ä»¶çš„æ•°æ®ç¼–è¯‘ã€‚è¿™æ ·èƒ½æé«˜ç»„ä»¶çš„å¤ç”¨æ€§ã€‚ å¦‚ä½•ä½¿ç”¨ åœ¨å­ç»„ä»¶æ¨¡æ¿&lt;slot&gt;æ ‡ç­¾ä¸Šç»‘å®šéœ€è¦æš´éœ²çš„æ•°æ®(æä¾›ç»™çˆ¶ç»„ä»¶ä½¿ç”¨çš„æ•°æ®)ï¼Œè¿™äº›æ•°æ®ä¼šè¢«å°è£…åˆ°ä¸€ä¸ªå¯¹è±¡ä¸Šï¼Œä¼ é€’ç»™çˆ¶çº§ åœ¨çˆ¶çº§ä¸Šï¼Œå¿…é¡»æœ‰ä¸€ä¸ªåŒ…å«scopeå±æ€§çš„&lt;template&gt;å…ƒç´ ï¼Œè¡¨ç¤ºå®ƒæ˜¯ä½œç”¨åŸŸæ’æ§½çš„æ¨¡æ¿ scopeçš„å€¼å¯¹åº”ä¸€ä¸ªä¸´æ—¶å˜é‡åï¼Œæ­¤å˜é‡æ¥æ”¶ä»å­ç»„ä»¶ä¸­ä¼ é€’è¿‡æ¥çš„å¯¹è±¡ å®é™…ä¾‹å­ ç°åœ¨è¦å®ç°ä¸€ä¸ªåˆ—è¡¨ç»„ä»¶ï¼Œå¯ä»¥è®©ç”¨æˆ·è‡ªå®šä¹‰DOMç»“æ„12345678910111213141516171819202122232425262728293031&lt;div id="app"&gt; &lt;my-awesome-list :items="items"&gt; &lt;!-- ä½œç”¨åŸŸæ’æ§½ä¹Ÿå¯ä»¥æ˜¯å…·åçš„,componPropå°±æ˜¯å­ç»„ä»¶ä¼ é€’è¿‡æ¥çš„å¯¹è±¡ --&gt; &lt;template slot="list-item" scope="componProp"&gt; &lt;!-- è¿™é‡Œæˆ‘å¯ä»¥ä½¿ç”¨ä»»æ„çš„ç»“æ„æ¥æ¸²æŸ“list --&gt; &lt;!-- &lt;h1&gt;&#123;&#123; componProp.text &#125;&#125;&lt;/h1&gt; --&gt; &lt;div style="font-style: italic;"&gt;&#123;&#123; componProp.text &#125;&#125;&lt;/div&gt; &lt;/template&gt; &lt;/my-awesome-list&gt;&lt;/div&gt; Vue.component('my-awesome-list', &#123; props: &#123; items: &#123; type: Array, required: true &#125; &#125;, template: '&lt;div&gt;&lt;slot name="list-item" v-for="item in items" :text="item.text"&gt;&lt;/slot&gt;&lt;/div&gt;'// æš´éœ²textç»™åˆ†å‘å†…å®¹ä½¿ç”¨&#125;); var vm = new Vue(&#123; el: '#app', data: &#123; items: [&#123; text: '11111' &#125;, &#123; text: '22222' &#125;] &#125;&#125;); åŠ¨æ€ç»„ä»¶ é€šè¿‡ä½¿ç”¨ä¿ç•™çš„ å…ƒç´ ï¼ŒåŠ¨æ€åœ°ç»‘å®šåˆ°å®ƒçš„ is ç‰¹æ€§ï¼Œæˆ‘ä»¬è®©å¤šä¸ªç»„ä»¶å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªæŒ‚è½½ç‚¹ï¼Œå¹¶åŠ¨æ€åˆ‡æ¢ 123456789101112131415&lt;component v-bind:is="currentView"&gt; &lt;!-- ç»„ä»¶åœ¨ vm.currentview å˜åŒ–æ—¶æ”¹å˜ï¼ --&gt;&lt;/component&gt;var vm = new Vue(&#123; el: '#example', data: &#123; currentView: 'home' &#125;, components: &#123; home: &#123; /* ... */ &#125;, posts: &#123; /* ... */ &#125;, archive: &#123; /* ... */ &#125; &#125;&#125;); ä¹Ÿå¯ä»¥ç›´æ¥ç»‘å®šåˆ°ç»„ä»¶å¯¹è±¡ä¸Š 123456789var Home = &#123; template: &apos;&lt;p&gt;Welcome home!&lt;/p&gt;&apos;&#125;var vm = new Vue(&#123; el: &apos;#example&apos;, data: &#123; currentView: Home &#125;&#125;) åŠ¨æ€ç»„ä»¶é…åˆä½¿ç”¨&lt;keep-alive&gt;æ¥ç¼“å­˜éæ´»åŠ¨ç»„ä»¶ï¼Œé¿å…é‡æ–°æ¸²æŸ“ 12345&lt;keep-alive&gt; &lt;component :is=&quot;currentView&quot;&gt; &lt;!-- éæ´»åŠ¨ç»„ä»¶å°†è¢«ç¼“å­˜ï¼ --&gt; &lt;/component&gt;&lt;/keep-alive&gt; æ‚é¡¹ ç¼–å†™å¯å¤ç”¨ç»„ä»¶ Props å…è®¸å¤–éƒ¨ç¯å¢ƒä¼ é€’æ•°æ®ç»™ç»„ä»¶ Events å…è®¸ä»å¤–éƒ¨ç¯å¢ƒåœ¨ç»„ä»¶å†…è§¦å‘å‰¯ä½œç”¨ Slots å…è®¸å¤–éƒ¨ç¯å¢ƒå°†é¢å¤–çš„å†…å®¹ç»„åˆåœ¨ç»„ä»¶ä¸­ å­ç»„ä»¶ç´¢å¼• å°½ç®¡æœ‰ props å’Œ eventsï¼Œä½†æ˜¯æœ‰æ—¶ä»ç„¶éœ€è¦åœ¨ JavaScript ä¸­ç›´æ¥è®¿é—®å­ç»„ä»¶ã€‚ä¸ºæ­¤å¯ä»¥ä½¿ç”¨ ref ä¸ºå­ç»„ä»¶æŒ‡å®šä¸€ä¸ªç´¢å¼• ID 123456&lt;div id="parent"&gt; &lt;user-profile ref="profile"&gt;&lt;/user-profile&gt;&lt;/div&gt;var parent = new Vue(&#123; el: '#parent' &#125;);// è®¿é—®å­ç»„ä»¶var child = parent.$refs.profile å½“ ref å’Œ v-for ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œref æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«ç›¸åº”çš„å­ç»„ä»¶ $refs åªåœ¨ç»„ä»¶æ¸²æŸ“å®Œæˆåæ‰å¡«å……ï¼Œå¹¶ä¸”å®ƒæ˜¯éå“åº”å¼çš„ã€‚å®ƒä»…ä»…ä½œä¸ºä¸€ä¸ªç›´æ¥è®¿é—®å­ç»„ä»¶çš„åº”æ€¥æ–¹æ¡ˆâ€”â€”åº”å½“é¿å…åœ¨æ¨¡ç‰ˆæˆ–è®¡ç®—å±æ€§ä¸­ä½¿ç”¨ $refsã€‚ å¼‚æ­¥ç»„ä»¶ åœ¨å¤§å‹åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦å°†åº”ç”¨æ‹†åˆ†ä¸ºå¤šä¸ªå°æ¨¡å—ï¼ŒæŒ‰éœ€ä»æœåŠ¡å™¨ä¸‹è½½ã€‚ä¸ºäº†è®©äº‹æƒ…æ›´ç®€å•ï¼ŒVue.js å…è®¸å°†ç»„ä»¶å®šä¹‰ä¸ºä¸€ä¸ªå·¥å‚å‡½æ•°ï¼ŒåŠ¨æ€åœ°è§£æç»„ä»¶çš„å®šä¹‰ã€‚Vue.js åªåœ¨ç»„ä»¶éœ€è¦æ¸²æŸ“æ—¶è§¦å‘å·¥å‚å‡½æ•°ï¼Œå¹¶ä¸”æŠŠç»“æœç¼“å­˜èµ·æ¥ï¼Œç”¨äºåé¢çš„å†æ¬¡æ¸²æŸ“ã€‚ 12345678Vue.component(&apos;async-example&apos;, function (resolve, reject) &#123; setTimeout(function () &#123; // Pass the component definition to the resolve callback resolve(&#123; template: &apos;&lt;div&gt;I am async!&lt;/div&gt;&apos; &#125;) &#125;, 1000)&#125;) å·¥å‚å‡½æ•°æ¥æ”¶ä¸€ä¸ª resolve å›è°ƒï¼Œåœ¨æ”¶åˆ°ä»æœåŠ¡å™¨ä¸‹è½½çš„ç»„ä»¶å®šä¹‰æ—¶è°ƒç”¨ã€‚ä¹Ÿå¯ä»¥è°ƒç”¨ reject(reason) æŒ‡ç¤ºåŠ è½½å¤±è´¥ã€‚è¿™é‡Œ setTimeout åªæ˜¯ä¸ºäº†æ¼”ç¤ºã€‚æ€ä¹ˆè·å–ç»„ä»¶å®Œå…¨ç”±ä½ å†³å®šã€‚æ¨èé…åˆä½¿ç”¨ ï¼šWebpack çš„ä»£ç åˆ†å‰²åŠŸèƒ½ 123456Vue.component(&apos;async-webpack-example&apos;, function (resolve) &#123; // è¿™ä¸ªç‰¹æ®Šçš„ require è¯­æ³•å‘Šè¯‰ webpack // è‡ªåŠ¨å°†ç¼–è¯‘åçš„ä»£ç åˆ†å‰²æˆä¸åŒçš„å—ï¼Œ // è¿™äº›å—å°†é€šè¿‡ Ajax è¯·æ±‚è‡ªåŠ¨ä¸‹è½½ã€‚ require([&apos;./my-async-component&apos;], resolve)&#125;) ä½ å¯ä»¥ä½¿ç”¨ Webpack 2 + ES2015 çš„è¯­æ³•è¿”å›ä¸€ä¸ª Promise resolve å‡½æ•° 1234Vue.component( &apos;async-webpack-example&apos;, () =&gt; import(&apos;./my-async-component&apos;)) å½“ä½¿ç”¨å±€éƒ¨æ³¨å†Œæ—¶ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥æä¾›ä¸€ä¸ªè¿”å› Promise çš„å‡½æ•° 123456new Vue(&#123; // ... components: &#123; &apos;my-component&apos;: () =&gt; import(&apos;./my-async-component&apos;) &#125;&#125;) å¦‚æœä½ æ˜¯ Browserify ç”¨æˆ·,å¯èƒ½å°±æ— æ³•ä½¿ç”¨å¼‚æ­¥ç»„ä»¶äº†,å®ƒçš„ä½œè€…å·²ç»è¡¨æ˜ Browserify æ˜¯ä¸æ”¯æŒå¼‚æ­¥åŠ è½½çš„ã€‚Browserify ç¤¾åŒºå‘ç° ä¸€äº›è§£å†³æ–¹æ³•ï¼Œå¯èƒ½æœ‰åŠ©äºå·²å­˜åœ¨çš„å¤æ‚åº”ç”¨ã€‚å¯¹äºå…¶ä»–åœºæ™¯ï¼Œæˆ‘ä»¬æ¨èç®€å•å®ç”¨ Webpack æ„å»ºï¼Œä¸€æµçš„å¼‚æ­¥æ”¯æŒ é«˜çº§å¼‚æ­¥ç»„ä»¶ è‡ª 2.3.0 èµ·ï¼Œå¼‚æ­¥ç»„ä»¶çš„å·¥å‚å‡½æ•°ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ªå¦‚ä¸‹çš„å¯¹è±¡ 123456789101112const AsyncComp = () =&gt; (&#123; // éœ€è¦åŠ è½½çš„ç»„ä»¶. åº”å½“æ˜¯ä¸€ä¸ª Promise component: import(&apos;./MyComp.vue&apos;), // loading æ—¶åº”å½“æ¸²æŸ“çš„ç»„ä»¶ loading: LoadingComp, // å‡ºé”™æ—¶æ¸²æŸ“çš„ç»„ä»¶ error: ErrorComp, // æ¸²æŸ“ loading ç»„ä»¶å‰çš„ç­‰å¾…æ—¶é—´ã€‚é»˜è®¤ï¼š200ms. delay: 200, // æœ€é•¿ç­‰å¾…æ—¶é—´ã€‚è¶…å‡ºæ­¤æ—¶é—´åˆ™æ¸²æŸ“ error ç»„ä»¶ã€‚é»˜è®¤ï¼šInfinity timeout: 3000&#125;) æ³¨æ„ï¼Œå½“ä¸€ä¸ªå¼‚æ­¥ç»„ä»¶è¢«ä½œä¸º vue- çš„è·¯ç”±ç»„ä»¶ä½¿ç”¨æ—¶ï¼Œè¿™äº›é«˜çº§é€‰é¡¹éƒ½æ˜¯æ— æ•ˆçš„ï¼Œå› ä¸ºåœ¨è·¯ç”±åˆ‡æ¢å‰å°±ä¼šæå‰åŠ è½½æ‰€éœ€è¦çš„å¼‚æ­¥ç»„ä»¶ã€‚å¦å¤–ï¼Œå¦‚æœä½ è¦åœ¨è·¯ç”±ç»„ä»¶ä¸­ä½¿ç”¨ä¸Šè¿°å†™æ³•ï¼Œéœ€è¦ä½¿ç”¨ 2.4.0+ã€‚ ç»„ä»¶å‘½åçº¦å®š æ³¨å†Œç»„ä»¶ (æˆ–è€… props) æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ kebab-case(çŸ­æ¨ªçº¿è¿æ¥)ï¼ŒcamelCaseï¼Œæˆ– PascalCase åœ¨ HTML æ¨¡ç‰ˆä¸­ï¼Œä½¿ç”¨ç»„ä»¶æ¨è kebab-case å½¢å¼ é€’å½’ç»„ä»¶ ç»„ä»¶åœ¨å®ƒçš„æ¨¡æ¿å†…å¯ä»¥é€’å½’åœ°è°ƒç”¨è‡ªå·±ï¼Œä¸è¿‡ï¼Œåªæœ‰å½“å®ƒæœ‰ name é€‰é¡¹æ—¶æ‰å¯ä»¥ å½“ä½ åˆ©ç”¨Vue.componentå…¨å±€æ³¨å†Œäº†ä¸€ä¸ªç»„ä»¶, å…¨å±€çš„IDä½œä¸ºç»„ä»¶çš„ name é€‰é¡¹ï¼Œè¢«è‡ªåŠ¨è®¾ç½®.å±€éƒ¨æ³¨å†Œéœ€è¦æ‰‹åŠ¨è®¾ç½® é€’å½’æ—¶ï¼Œä¸€å®šè¦è®¾ç½®ç»ˆæ­¢æ¡ä»¶ ç»„ä»¶é—´çš„å¾ªç¯å¼•ç”¨ å‡è®¾ä½ æ­£åœ¨æ„å»ºä¸€ä¸ªæ–‡ä»¶ç›®å½•æ ‘ï¼Œåƒåœ¨Finderæˆ–æ–‡ä»¶èµ„æºç®¡ç†å™¨ä¸­ã€‚ä½ å¯èƒ½æœ‰ä¸€ä¸ª tree-folderç»„ä»¶12345678910111213// tree-folderç»„ä»¶&lt;p&gt; &lt;span&gt;&#123;&#123; folder.name &#125;&#125;&lt;/span&gt; &lt;tree-folder-contents :children=&quot;folder.children&quot;/&gt;&lt;/p&gt;// ç„¶å ä¸€ä¸ªtree-folder-contentsç»„ä»¶&lt;ul&gt; &lt;li v-for=&quot;child in children&quot;&gt; &lt;tree-folder v-if=&quot;child.children&quot; :folder=&quot;child&quot;/&gt; &lt;span v-else&gt;&#123;&#123; child.name &#125;&#125;&lt;/span&gt; &lt;/li&gt;&lt;/ul&gt;// å½“ä½ ä»”ç»†çœ‹æ—¶ï¼Œä¼šå‘ç°åœ¨æ¸²æŸ“æ ‘ä¸Šè¿™ä¸¤ä¸ªç»„ä»¶åŒæ—¶ä¸ºå¯¹æ–¹çš„çˆ¶èŠ‚ç‚¹å’Œå­èŠ‚ç‚¹â€“è¿™ç‚¹æ˜¯çŸ›ç›¾çš„ã€‚å½“ä½¿ç”¨Vue.componentå°†è¿™ä¸¤ä¸ªç»„ä»¶æ³¨å†Œä¸ºå…¨å±€ç»„ä»¶çš„æ—¶å€™ï¼Œæ¡†æ¶ä¼šè‡ªåŠ¨ä¸ºä½ è§£å†³è¿™ä¸ªçŸ›ç›¾ å†…è”æ¨¡ç‰ˆ å¦‚æœå­ç»„ä»¶æœ‰ inline-template ç‰¹æ€§ï¼Œç»„ä»¶å°†æŠŠå®ƒçš„å†…å®¹å½“ä½œå®ƒçš„æ¨¡æ¿ï¼Œè€Œä¸æ˜¯æŠŠå®ƒå½“ä½œåˆ†å‘å†…å®¹ 123456&lt;my-component inline-template&gt; &lt;div&gt; &lt;p&gt;These are compiled as the component&apos;s own template.&lt;/p&gt; &lt;p&gt;Not parent&apos;s transclusion content.&lt;/p&gt; &lt;/div&gt;&lt;/my-component&gt; ä½†æ˜¯ inline-template è®©æ¨¡æ¿çš„ä½œç”¨åŸŸéš¾ä»¥ç†è§£ã€‚æœ€ä½³å®è·µæ˜¯ä½¿ç”¨ template é€‰é¡¹åœ¨ç»„ä»¶å†…å®šä¹‰æ¨¡æ¿æˆ–è€…åœ¨ .vue æ–‡ä»¶ä¸­ä½¿ç”¨ template å…ƒç´  X-Templates å¦ä¸€ç§å®šä¹‰æ¨¡ç‰ˆçš„æ–¹å¼æ˜¯åœ¨ JavaScript æ ‡ç­¾é‡Œä½¿ç”¨ text/x-template ç±»å‹ï¼Œå¹¶ä¸”æŒ‡å®šä¸€ä¸ª id 123456&lt;script type=&quot;text/x-template&quot; id=&quot;hello-world-template&quot;&gt; &lt;p&gt;Hello hello hello&lt;/p&gt;&lt;/script&gt;Vue.component(&apos;hello-world&apos;, &#123; template: &apos;#hello-world-template&apos;&#125;) è¿™åœ¨æœ‰å¾ˆå¤šæ¨¡ç‰ˆæˆ–è€…å°çš„åº”ç”¨ä¸­æœ‰ç”¨ï¼Œå¦åˆ™åº”è¯¥é¿å…ä½¿ç”¨ï¼Œå› ä¸ºå®ƒå°†æ¨¡ç‰ˆå’Œç»„ä»¶çš„å…¶ä»–å®šä¹‰éš”ç¦»äº†ã€‚ å¯¹ä½å¼€é”€çš„é™æ€ç»„ä»¶ä½¿ç”¨ v-once å°½ç®¡åœ¨ Vue ä¸­æ¸²æŸ“ HTML å¾ˆå¿«ï¼Œä¸è¿‡å½“ç»„ä»¶ä¸­åŒ…å«å¤§é‡é™æ€å†…å®¹æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ v-once å°†æ¸²æŸ“ç»“æœç¼“å­˜èµ·æ¥ï¼Œå°±åƒè¿™æ ·12345678Vue.component(&apos;terms-of-service&apos;, &#123; template: &apos;\ &lt;div v-once&gt;\ &lt;h1&gt;Terms of Service&lt;/h1&gt;\ ... a lot of static content ...\ &lt;/div&gt;\ &apos;&#125;) æ·±å…¥å“åº”å¼åŸç†å¦‚ä½•è¿½è¸ªå˜åŒ– Vueé€šè¿‡Object.definePropertyå°†å±æ€§è½¬åŒ–ä¸ºsetter/getterï¼Œåœ¨setter/getterä¸­è¿›è¡Œä¾èµ–è¿½è¸ª æŠŠä¸€ä¸ªæ™®é€š JavaScript å¯¹è±¡ä¼ ç»™ Vue å®ä¾‹çš„ data é€‰é¡¹ï¼ŒVue å°†éå†æ­¤å¯¹è±¡æ‰€æœ‰çš„å±æ€§ï¼Œå¹¶ä½¿ç”¨ Object.defineProperty æŠŠè¿™äº›å±æ€§å…¨éƒ¨è½¬ä¸º getter/setterã€‚ ç”¨æˆ·çœ‹ä¸åˆ° getter/setterï¼Œä½†æ˜¯åœ¨å†…éƒ¨å®ƒä»¬è®© Vue è¿½è¸ªä¾èµ–ï¼Œåœ¨å±æ€§è¢«è®¿é—®å’Œä¿®æ”¹æ—¶é€šçŸ¥å˜åŒ– æ¯ä¸ªç»„ä»¶å®ä¾‹éƒ½æœ‰ç›¸åº”çš„ watcher å®ä¾‹å¯¹è±¡ï¼Œå®ƒä¼šåœ¨ç»„ä»¶æ¸²æŸ“çš„è¿‡ç¨‹ä¸­æŠŠå±æ€§è®°å½•ä¸ºä¾èµ–ï¼Œä¹‹åå½“ä¾èµ–é¡¹çš„ setter è¢«è°ƒç”¨æ—¶ï¼Œä¼šé€šçŸ¥ watcher é‡æ–°è®¡ç®—ï¼Œä»è€Œè‡´ä½¿å®ƒå…³è”çš„ç»„ä»¶å¾—ä»¥æ›´æ–° å˜åŒ–æ£€æµ‹é—®é¢˜ å—ç°ä»£ JavaScript çš„é™åˆ¶ï¼ˆä»¥åŠåºŸå¼ƒ Object.observeï¼‰ï¼ŒVue ä¸èƒ½æ£€æµ‹åˆ°å¯¹è±¡å±æ€§çš„æ·»åŠ æˆ–åˆ é™¤ã€‚ç”±äº Vue ä¼šåœ¨åˆå§‹åŒ–å®ä¾‹æ—¶å¯¹å±æ€§æ‰§è¡Œ getter/setter è½¬åŒ–è¿‡ç¨‹ï¼Œæ‰€ä»¥å±æ€§å¿…é¡»åœ¨ data å¯¹è±¡ä¸Šå­˜åœ¨æ‰èƒ½è®© Vue è½¬æ¢å®ƒï¼Œè¿™æ ·æ‰èƒ½è®©å®ƒæ˜¯å“åº”çš„ 12345678var vm = new Vue(&#123; data:&#123; a:1 &#125;&#125;)// `vm.a` æ˜¯å“åº”çš„vm.b = 2// `vm.b` æ˜¯éå“åº”çš„ å¯ä»¥ä½¿ç”¨Vue.set(target,key,value)æˆ–è€…vm.$set(target,key,value)æ¥æ·»åŠ å“åº”å¼å±æ€§;æ³¨æ„targetä¸èƒ½æ˜¯ Vue å®ä¾‹ï¼Œæˆ–è€… Vue å®ä¾‹çš„æ ¹æ•°æ®å¯¹è±¡ æœ‰æ—¶ä½ æƒ³å‘å·²æœ‰å¯¹è±¡ä¸Šæ·»åŠ ä¸€äº›å±æ€§ï¼Œä¾‹å¦‚ä½¿ç”¨ Object.assign() æˆ– _.extend() æ–¹æ³•æ¥æ·»åŠ å±æ€§ã€‚ä½†æ˜¯ï¼Œæ·»åŠ åˆ°å¯¹è±¡ä¸Šçš„æ–°å±æ€§ä¸ä¼šè§¦å‘æ›´æ–°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œè®©å®ƒåŒ…å«åŸå¯¹è±¡çš„å±æ€§å’Œæ–°çš„å±æ€§12// ä»£æ›¿ `Object.assign(this.someObject, &#123; a: 1, b: 2 &#125;)`this.someObject = Object.assign(&#123;&#125;, this.someObject, &#123; a: 1, b: 2 &#125;) å£°æ˜å“åº”å¼å±æ€§ ç”±äº Vue ä¸å…è®¸åŠ¨æ€æ·»åŠ æ ¹çº§å“åº”å¼å±æ€§ï¼Œæ‰€ä»¥ä½ å¿…é¡»åœ¨åˆå§‹åŒ–å®ä¾‹å‰å£°æ˜æ ¹çº§å“åº”å¼å±æ€§ï¼Œå“ªæ€•åªæ˜¯ä¸€ä¸ªç©ºå€¼123456789var vm = new Vue(&#123; data: &#123; // å£°æ˜ message ä¸ºä¸€ä¸ªç©ºå€¼å­—ç¬¦ä¸² message: '' &#125;, template: '&lt;div&gt;&#123;&#123; message &#125;&#125;&lt;/div&gt;'&#125;)// ä¹‹åè®¾ç½® `message` vm.message = 'Hello!' å¼‚æ­¥æ›´æ–°é˜Ÿåˆ— Vueä¸­çš„DOMæ›´æ–°æ˜¯å¼‚æ­¥çš„ï¼›å®é™…çš„DOMæ›´æ–°æ˜¯å‘ç”Ÿåœ¨è§‚å¯Ÿåˆ°æ•°æ®å˜åŒ–åä¸‹ä¸€ä¸ªeventLoopçš„tickä¸­ åªè¦è§‚å¯Ÿåˆ°æ•°æ®å˜åŒ–ï¼ŒVue å°†å¼€å¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¹¶ç¼“å†²åœ¨åŒä¸€äº‹ä»¶å¾ªç¯ä¸­å‘ç”Ÿçš„æ‰€æœ‰æ•°æ®æ”¹å˜ã€‚å¦‚æœåŒä¸€ä¸ª watcher è¢«å¤šæ¬¡è§¦å‘ï¼Œåªä¼šä¸€æ¬¡æ¨å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚è¿™ç§åœ¨ç¼“å†²æ—¶å»é™¤é‡å¤æ•°æ®å¯¹äºé¿å…ä¸å¿…è¦çš„è®¡ç®—å’Œ DOM æ“ä½œä¸Šéå¸¸é‡è¦ã€‚ç„¶åï¼Œåœ¨ä¸‹ä¸€ä¸ªçš„äº‹ä»¶å¾ªç¯â€œtickâ€ä¸­ï¼ŒVue åˆ·æ–°é˜Ÿåˆ—å¹¶æ‰§è¡Œå®é™…ï¼ˆå·²å»é‡çš„ï¼‰å·¥ä½œã€‚(æ•°æ®å˜åŒ–-&gt;å¼€å¯é˜Ÿåˆ—-&gt;å»é‡å¤/ç¼“å†²)-&gt;(DOMæ›´æ–°)ï¼Œåœ¨åŒä¸€ä¸ªæ‹¬å·ä¸­ï¼Œä»£è¡¨å‘ç”Ÿåœ¨åŒä¸€ä¸ªtickä¸­ Vue åœ¨å†…éƒ¨å°è¯•å¯¹å¼‚æ­¥é˜Ÿåˆ—ä½¿ç”¨åŸç”Ÿçš„ Promise.then å’Œ MutationObserverï¼Œå¦‚æœæ‰§è¡Œç¯å¢ƒä¸æ”¯æŒï¼Œä¼šé‡‡ç”¨ setTimeout(fn, 0) ä»£æ›¿ã€‚ä¾‹å¦‚ï¼Œå½“ä½ è®¾ç½® vm.someData = â€˜new valueâ€™ ï¼Œè¯¥ç»„ä»¶ä¸ä¼šç«‹å³é‡æ–°æ¸²æŸ“ã€‚å½“åˆ·æ–°é˜Ÿåˆ—æ—¶ï¼Œç»„ä»¶ä¼šåœ¨äº‹ä»¶å¾ªç¯é˜Ÿåˆ—æ¸…ç©ºæ—¶çš„ä¸‹ä¸€ä¸ªâ€œtickâ€æ›´æ–°ã€‚ å¯ä»¥ä½¿ç”¨Vue.nextTick(callback),åœ¨ DOM æ›´æ–°å®Œæˆåç«‹å³è°ƒç”¨callback 123456789101112&lt;div id="example"&gt;&#123;&#123;message&#125;&#125;&lt;/div&gt;var vm = new Vue(&#123; el: '#example', data: &#123; message: '123' &#125;&#125;)vm.message = 'new message' // æ›´æ”¹æ•°æ®vm.$el.textContent === 'new message' // falseVue.nextTick(function () &#123; vm.$el.textContent === 'new message' // true&#125;) ç»„ä»¶å†…ä½¿ç”¨vm.$nextTick(callback),callbackä¸­çš„ this å°†è‡ªåŠ¨ç»‘å®šåˆ°å½“å‰çš„ Vue å®ä¾‹ä¸Š 1234567891011121314151617Vue.component(&apos;example&apos;, &#123; template: &apos;&lt;span&gt;&#123;&#123; message &#125;&#125;&lt;/span&gt;&apos;, data: function () &#123; return &#123; message: &apos;æ²¡æœ‰æ›´æ–°&apos; &#125; &#125;, methods: &#123; updateMessage: function () &#123; this.message = &apos;æ›´æ–°å®Œæˆ&apos; console.log(this.$el.textContent) // =&gt; &apos;æ²¡æœ‰æ›´æ–°&apos; this.$nextTick(function () &#123; console.log(this.$el.textContent) // =&gt; &apos;æ›´æ–°å®Œæˆ&apos; &#125;) &#125; &#125;&#125;) è¿‡æ¸¡æ•ˆæœå•å…ƒç´ /ç»„ä»¶çš„è¿‡æ¸¡ Vue æä¾›äº† transition çš„å°è£…ç»„ä»¶ï¼Œåœ¨ä¸‹åˆ—æƒ…å½¢ä¸­ï¼Œå¯ä»¥ç»™ä»»ä½•å…ƒç´ å’Œç»„ä»¶æ·»åŠ  entering/leaving è¿‡æ¸¡ æ¡ä»¶æ¸²æŸ“ ï¼ˆä½¿ç”¨ v-ifï¼‰ æ¡ä»¶å±•ç¤º ï¼ˆä½¿ç”¨ v-showï¼‰ åŠ¨æ€ç»„ä»¶ ç»„ä»¶æ ¹èŠ‚ç‚¹ 12345678910111213141516171819202122&lt;div id="demo"&gt; &lt;button v-on:click="show = !show"&gt; Toggle &lt;/button&gt; &lt;transition name="fade"&gt; &lt;p v-if="show"&gt;hello&lt;/p&gt; &lt;/transition&gt;&lt;/div&gt;.fade-enter-active, .fade-leave-active &#123; transition: opacity 0.5s&#125;.fade-enter, .fade-leave-to &#123; opacity: 0&#125;new Vue(&#123; el: '#demo', data: &#123; show: true &#125;&#125;); å½“æ’å…¥æˆ–åˆ é™¤åŒ…å«åœ¨&lt;transition&gt;ç»„ä»¶ä¸­çš„å…ƒç´ æ—¶ï¼ŒVue å°†ä¼šåšä»¥ä¸‹å¤„ç† è‡ªåŠ¨å—…æ¢ç›®æ ‡å…ƒç´ æ˜¯å¦åº”ç”¨äº† CSS è¿‡æ¸¡æˆ–åŠ¨ç”»ï¼Œå¦‚æœæ˜¯ï¼Œåœ¨æ°å½“çš„æ—¶æœºæ·»åŠ /åˆ é™¤ CSS ç±»åã€‚ å¦‚æœè¿‡æ¸¡ç»„ä»¶æä¾›äº† JavaScript é’©å­å‡½æ•°ï¼Œè¿™äº›é’©å­å‡½æ•°å°†åœ¨æ°å½“çš„æ—¶æœºè¢«è°ƒç”¨ å¦‚æœæ²¡æœ‰æ‰¾åˆ° JavaScript é’©å­å¹¶ä¸”ä¹Ÿæ²¡æœ‰æ£€æµ‹åˆ° CSS è¿‡æ¸¡/åŠ¨ç”»ï¼ŒDOM æ“ä½œï¼ˆæ’å…¥/åˆ é™¤ï¼‰åœ¨ä¸‹ä¸€å¸§ä¸­ç«‹å³æ‰§è¡Œã€‚(æ³¨æ„ï¼šæ­¤æŒ‡æµè§ˆå™¨é€å¸§åŠ¨ç”»æœºåˆ¶ï¼Œå’ŒVueçš„ nextTick æ¦‚å¿µä¸åŒ) è¿‡æ¸¡çš„cssç±»åç±»ä¼¼ngä¸­åŠ¨ç”»ä¼šæ·»åŠ åˆé€‚çš„class ä¼šæœ‰ 6 ä¸ª(CSS)ç±»ååœ¨ enter/leave çš„è¿‡æ¸¡ä¸­åˆ‡æ¢ v-enter-&gt;å®šä¹‰å¼€å§‹çŠ¶æ€ï¼Œä¼šåœ¨å…ƒç´ æ’å…¥æ—¶ç”Ÿæ•ˆï¼Œå¹¶åœ¨ä¸‹ä¸€frameè¢«åˆ é™¤ v-enter-active-&gt;å®šä¹‰è¿‡æ¸¡çŠ¶æ€ï¼Œæ’å…¥æ—¶ç”Ÿæ•ˆï¼Œè¿‡æ¸¡ç»“æŸæ—¶åˆ é™¤ï¼›è¿™ä¸ªå¯ä»¥è¢«ç”¨æ¥å®šä¹‰è¿‡æ¸¡çš„è¿‡ç¨‹æ—¶é—´ï¼Œå»¶è¿Ÿå’Œæ›²çº¿å‡½æ•°ã€‚ v-enter-to-&gt;å®šä¹‰è¿‡æ¸¡ç»“æŸçŠ¶æ€ï¼Œåœ¨å…ƒç´ æ’å…¥åçš„ä¸‹ä¸€frameè¢«åŠ å…¥(v-enteræ­£å¥½åˆ é™¤),è¿‡æ¸¡ç»“æŸæ—¶åˆ é™¤ åŒç†ï¼Œleaveä¹Ÿä¸€æ ·ï¼Œæœ‰v-leaveã€v-leave-activeã€v-leave-to è¿‡æ¸¡ä¸­çš„ç±»åå‰ç¼€æ˜¯å¯ä»¥æ›´æ¢çš„ï¼Œé€šè¿‡&lt;transtion&gt;ç»„ä»¶çš„nameç‰¹æ€§å¯ä»¥æŒ‡å®šè¿‡æ¸¡ç±»çš„å‰ç¼€12// å¯¹åº”çš„è¿‡æ¸¡æ ·å¼ç±»å°±æ˜¯.testAnim-enterã€.testAnim-enter-activeã€.testAnim-enter-to&lt;transtion name=&quot;testAnim&quot;&gt;xxx&lt;/transition&gt; cssè¿‡æ¸¡æœ€å¸¸ç”¨çš„1234567891011121314151617181920212223242526&lt;div id=&quot;example-1&quot;&gt; &lt;button @click=&quot;show = !show&quot;&gt; Toggle render &lt;/button&gt; &lt;transition name=&quot;slide-fade&quot;&gt; &lt;p v-if=&quot;show&quot;&gt;hello&lt;/p&gt; &lt;/transition&gt;&lt;/div&gt;new Vue(&#123; el: &apos;#example-1&apos;, data: &#123; show: true &#125;&#125;);/* å¯ä»¥è®¾ç½®ä¸åŒçš„è¿›å…¥å’Œç¦»å¼€åŠ¨ç”» *//* è®¾ç½®æŒç»­æ—¶é—´å’ŒåŠ¨ç”»å‡½æ•° */.slide-fade-enter-active &#123; transition: all .3s ease;&#125;.slide-fade-leave-active &#123; transition: all .8s cubic-bezier(1.0, 0.5, 0.8, 1.0);&#125;.slide-fade-enter, .slide-fade-leave-to &#123; transform: translateX(10px); opacity: 0;&#125; cssåŠ¨ç”»animation CSS åŠ¨ç”»ç”¨æ³•åŒ CSS è¿‡æ¸¡ï¼ŒåŒºåˆ«æ˜¯åœ¨åŠ¨ç”»ä¸­v-enterç±»ååœ¨èŠ‚ç‚¹æ’å…¥ DOM åä¸ä¼šç«‹å³åˆ é™¤ï¼Œè€Œæ˜¯åœ¨ animationend äº‹ä»¶è§¦å‘æ—¶(åŠ¨ç”»ç»“æŸ)åˆ é™¤ã€‚1234567891011121314151617181920212223242526272829&lt;div id=&quot;example-2&quot;&gt; &lt;button @click=&quot;show = !show&quot;&gt;Toggle show&lt;/button&gt; &lt;transition name=&quot;bounce&quot;&gt; &lt;p v-if=&quot;show&quot;&gt;Look at me!&lt;/p&gt; &lt;/transition&gt;&lt;/div&gt;new Vue(&#123; el: &apos;#example-2&apos;, data: &#123; show: true &#125;&#125;);.bounce-enter-active &#123; animation: bounce-in .5s;&#125;.bounce-leave-active &#123; animation: bounce-in .5s reverse;&#125;@keyframes bounce-in &#123; 0% &#123; transform: scale(0); &#125; 50% &#123; transform: scale(1.5); &#125; 100% &#123; transform: scale(1); &#125;&#125; è‡ªå®šä¹‰è¿‡æ¸¡ç±»å å¯ä»¥é€šè¿‡ä»¥ä¸‹ç‰¹æ€§æ¥è‡ªå®šä¹‰è¿‡æ¸¡ç±»å;ä¸»è¦ç”¨æ¥é…åˆç¬¬ä¸‰æ–¹cssåŠ¨ç”»åº“ä½¿ç”¨;ä»–ä»¬çš„ä¼˜å…ˆçº§é«˜äºæ™®é€šçš„ç±»å enter-class enter-active-class enter-to-class (2.1.8+) leave-class leave-active-class leave-to-class (2.1.8+)123456789101112131415161718192021&lt;link href=&quot;https://unpkg.com/animate.css@3.5.1/animate.min.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;&lt;div id=&quot;example-3&quot;&gt; &lt;button @click=&quot;show = !show&quot;&gt; Toggle render &lt;/button&gt; &lt;!-- è¿›å…¥ç¦»å¼€æ—¶ç”¨ç‰¹æ®Šçš„class --&gt; &lt;transition name=&quot;custom-classes-transition&quot; enter-active-class=&quot;animated tada&quot; leave-active-class=&quot;animated bounceOutRight&quot; &gt; &lt;p v-if=&quot;show&quot;&gt;hello&lt;/p&gt; &lt;/transition&gt;&lt;/div&gt;new Vue(&#123; el: &apos;#example-3&apos;, data: &#123; show: true &#125;&#125;); åŒæ—¶ä½¿ç”¨ Transitions å’Œ Animations Vue ä¸ºäº†çŸ¥é“è¿‡æ¸¡çš„å®Œæˆï¼Œå¿…é¡»è®¾ç½®ç›¸åº”çš„äº‹ä»¶ç›‘å¬å™¨ã€‚å®ƒå¯ä»¥æ˜¯ transitionend æˆ– animationend ï¼Œè¿™å–å†³äºç»™å…ƒç´ åº”ç”¨çš„ CSS è§„åˆ™ã€‚å¦‚æœä½ ä½¿ç”¨å…¶ä¸­ä»»ä½•ä¸€ç§ï¼ŒVue èƒ½è‡ªåŠ¨è¯†åˆ«ç±»å‹å¹¶è®¾ç½®ç›‘å¬ã€‚ ä½†æ˜¯ï¼Œåœ¨ä¸€äº›åœºæ™¯ä¸­ï¼Œä½ éœ€è¦ç»™åŒä¸€ä¸ªå…ƒç´ åŒæ—¶è®¾ç½®ä¸¤ç§è¿‡æ¸¡åŠ¨æ•ˆï¼Œæ¯”å¦‚ animation å¾ˆå¿«çš„è¢«è§¦å‘å¹¶å®Œæˆäº†ï¼Œè€Œ transition æ•ˆæœè¿˜æ²¡ç»“æŸã€‚åœ¨è¿™ç§æƒ…å†µä¸­ï¼Œä½ å°±éœ€è¦ä½¿ç”¨ type ç‰¹æ€§å¹¶è®¾ç½® animation æˆ– transition æ¥æ˜ç¡®å£°æ˜ä½ éœ€è¦ Vue ç›‘å¬çš„ç±»å‹ã€‚ æ˜¾æ€§çš„è¿‡æ¸¡æ•ˆæœæŒç»­æ—¶é—´ åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼ŒVue å¯ä»¥è‡ªåŠ¨å¾—å‡ºè¿‡æ¸¡æ•ˆæœçš„å®Œæˆæ—¶æœºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒVue ä¼šç­‰å¾…å…¶åœ¨è¿‡æ¸¡æ•ˆæœçš„æ ¹å…ƒç´ çš„ç¬¬ä¸€ä¸ª transitionend æˆ– animationend äº‹ä»¶ã€‚ç„¶è€Œä¹Ÿå¯ä»¥ä¸è¿™æ ·è®¾å®šâ€”â€”æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æ‹¥æœ‰ä¸€ä¸ªç²¾å¿ƒç¼–æ’çš„ä¸€åºåˆ—è¿‡æ¸¡æ•ˆæœï¼Œå…¶ä¸­ä¸€äº›åµŒå¥—çš„å†…éƒ¨å…ƒç´ ç›¸æ¯”äºè¿‡æ¸¡æ•ˆæœçš„æ ¹å…ƒç´ æœ‰å»¶è¿Ÿçš„æˆ–æ›´é•¿çš„è¿‡æ¸¡æ•ˆæœã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ä½ å¯ä»¥ç”¨ ç»„ä»¶ä¸Šçš„ duration å±æ€§å®šåˆ¶ä¸€ä¸ªæ˜¾æ€§çš„è¿‡æ¸¡æ•ˆæœæŒç»­æ—¶é—´ (ä»¥æ¯«ç§’è®¡)ï¼š123&lt;transition :duration=&quot;1000&quot;&gt;...&lt;/transition&gt;// ä½ ä¹Ÿå¯ä»¥å®šåˆ¶è¿›å…¥å’Œç§»å‡ºçš„æŒç»­æ—¶é—´ï¼š&lt;transition :duration=&quot;&#123; enter: 500, leave: 800 &#125;&quot;&gt;...&lt;/transition&gt; ###JavaScript é’©å­(JsåŠ¨ç”»)å¯ä»¥åœ¨å±æ€§ä¸­å£°æ˜ JavaScript é’©å­ï¼Œé€šè¿‡é’©å­åœ¨ç‰¹å®šæ—¶é—´è°ƒç”¨ç‰¹å®šåŠ¨ç”»å‡½æ•°æ¥å®ç°jsåŠ¨ç”» beforeEnter-&gt;è¿›å…¥å‰ enter-&gt;è¿›å…¥ä¸­ after-enter-&gt;è¿›å…¥å enter-cancelled-&gt;å–æ¶ˆå åŒç†leaveä¹Ÿæœ‰ç±»ä¼¼é’©å­ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;transition v-on:before-enter=&quot;beforeEnter&quot; v-on:enter=&quot;enter&quot; v-on:after-enter=&quot;afterEnter&quot; v-on:enter-cancelled=&quot;enterCancelled&quot; v-on:before-leave=&quot;beforeLeave&quot; v-on:leave=&quot;leave&quot; v-on:after-leave=&quot;afterLeave&quot; v-on:leave-cancelled=&quot;leaveCancelled&quot;&gt; &lt;!-- ... --&gt;&lt;/transition&gt;// ...methods: &#123; // -------- // è¿›å…¥ä¸­ // -------- beforeEnter: function (el) &#123; // ... &#125;, // æ­¤å›è°ƒå‡½æ•°æ˜¯å¯é€‰é¡¹çš„è®¾ç½® // ä¸ CSS ç»“åˆæ—¶ä½¿ç”¨ enter: function (el, done) &#123; // ... done() &#125;, afterEnter: function (el) &#123; // ... &#125;, enterCancelled: function (el) &#123; // ... &#125;, // -------- // ç¦»å¼€æ—¶ // -------- beforeLeave: function (el) &#123; // ... &#125;, // æ­¤å›è°ƒå‡½æ•°æ˜¯å¯é€‰é¡¹çš„è®¾ç½® // ä¸ CSS ç»“åˆæ—¶ä½¿ç”¨ leave: function (el, done) &#123; // ... done() &#125;, afterLeave: function (el) &#123; // ... &#125;, // leaveCancelled åªç”¨äº v-show ä¸­ leaveCancelled: function (el) &#123; // ... &#125;&#125; è¿™äº›é’©å­å‡½æ•°å¯ä»¥ç»“åˆ CSS transitions/animations ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨ã€‚ å½“åªç”¨ JavaScript è¿‡æ¸¡çš„æ—¶å€™ï¼Œ åœ¨ enter å’Œ leave ä¸­ï¼Œå›è°ƒå‡½æ•° done æ˜¯å¿…é¡»çš„ ã€‚ å¦åˆ™ï¼Œå®ƒä»¬ä¼šè¢«åŒæ­¥è°ƒç”¨ï¼Œè¿‡æ¸¡ä¼šç«‹å³å®Œæˆã€‚ æ¨èå¯¹äºä»…ä½¿ç”¨ JavaScript è¿‡æ¸¡çš„å…ƒç´ æ·»åŠ  v-bind:css=â€falseâ€ï¼ŒVue ä¼šè·³è¿‡ CSS çš„æ£€æµ‹ã€‚è¿™ä¹Ÿå¯ä»¥é¿å…è¿‡æ¸¡è¿‡ç¨‹ä¸­ CSS çš„å½±å“ã€‚ åˆå§‹æ¸²æŸ“çš„è¿‡æ¸¡å®šä¹‰ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ï¼Œå¦‚ä½•è¿‡æ¸¡ é€šè¿‡æ·»åŠ appearç‰¹æ€§ï¼Œå¯ä»¥å¼€å¯åˆå§‹æ¸²æŸ“è¿‡æ¸¡åŠ¨ç”» å’Œenterã€leaveè¿‡æ¸¡ä¸€æ ·å¯ä»¥è‡ªå·±å®šä¹‰cssç±»å 12345678&lt;transition appear appear-class=&quot;custom-appear-class&quot; appear-to-class=&quot;custom-appear-to-class&quot; appear-active-class=&quot;custom-appear-active-class&quot;&gt; &lt;!-- ... --&gt;&lt;/transition&gt; ä¹Ÿæœ‰ç›¸åº”çš„jsé’©å­ 123456789&lt;transition appear v-on:before-appear=&quot;customBeforeAppearHook&quot; v-on:appear=&quot;customAppearHook&quot; v-on:after-appear=&quot;customAfterAppearHook&quot; v-on:appear-cancelled=&quot;customAppearCancelledHook&quot;&gt; &lt;!-- ... --&gt;&lt;/transition&gt; å¤šä¸ªå…ƒç´ çš„è¿‡æ¸¡ å¯¹äºåŸç”Ÿæ ‡ç­¾å¯ä»¥ä½¿ç”¨ v-if/v-else ã€‚æœ€å¸¸è§çš„å¤šæ ‡ç­¾è¿‡æ¸¡æ˜¯ä¸€ä¸ªåˆ—è¡¨å’Œæè¿°è¿™ä¸ªåˆ—è¡¨ä¸ºç©ºæ¶ˆæ¯çš„å…ƒç´  123456&lt;transition&gt; &lt;table v-if=&quot;items.length &gt; 0&quot;&gt; &lt;!-- ... --&gt; &lt;/table&gt; &lt;p v-else&gt;Sorry, no items found.&lt;/p&gt;&lt;/transition&gt; å½“æœ‰ç›¸åŒæ ‡ç­¾åçš„å…ƒç´ åˆ‡æ¢æ—¶ï¼Œéœ€è¦é€šè¿‡ key ç‰¹æ€§è®¾ç½®å”¯ä¸€çš„å€¼æ¥æ ‡è®°ä»¥è®© Vue åŒºåˆ†å®ƒä»¬ï¼Œå¦åˆ™ Vue ä¸ºäº†æ•ˆç‡åªä¼šæ›¿æ¢ç›¸åŒæ ‡ç­¾å†…éƒ¨çš„å†…å®¹ã€‚å³ä½¿åœ¨æŠ€æœ¯ä¸Šæ²¡æœ‰å¿…è¦ï¼Œç»™åœ¨ ç»„ä»¶ä¸­çš„å¤šä¸ªå…ƒç´ è®¾ç½® key æ˜¯ä¸€ä¸ªæ›´å¥½çš„å®è·µã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940 &lt;style type=&quot;text/css&quot;&gt; .fade-enter, .fade-leave &#123; opacity: 0; &#125; .fade-enter-active, .fade-leave-active &#123; transition: all .3s ease-in-out; &#125; &lt;/style&gt;&lt;div id=&quot;app&quot;&gt; &lt;transition name=&quot;fade&quot;&gt; &lt;!-- æ²¡æœ‰åŠ key,æ ¹æ®vueçš„å°±åœ°å¤ç”¨åŸåˆ™ï¼Œä»–ä»¬å°†åªæ›¿æ¢å†…å®¹ï¼Œå› æ­¤ä¸ä¼šäº§ç”Ÿè¿‡æ¸¡åŠ¨ç”» --&gt; &lt;!-- &lt;button v-if=&quot;isEditing&quot;&gt; Save &lt;/button&gt; &lt;button v-else&gt; Edit &lt;/button&gt; --&gt; &lt;!-- æ·»åŠ key --&gt; &lt;!-- &lt;button v-if=&quot;isEditing&quot; key=&quot;save&quot;&gt; Save &lt;/button&gt; &lt;button v-else key=&quot;edit&quot;&gt; Edit &lt;/button&gt; --&gt; &lt;!-- åœ¨ä¸€äº›åœºæ™¯ä¸­ï¼Œä¹Ÿå¯ä»¥ç»™é€šè¿‡ç»™åŒä¸€ä¸ªå…ƒç´ çš„ key ç‰¹æ€§è®¾ç½®ä¸åŒçš„çŠ¶æ€æ¥ä»£æ›¿ v-if å’Œ v-elseï¼Œä¸Šé¢çš„ä¾‹å­å¯ä»¥é‡å†™ä¸ºï¼š --&gt; &lt;button v-bind:key=&quot;isEditing&quot;&gt; &#123;&#123; isEditing ? &apos;Save&apos; : &apos;Edit&apos; &#125;&#125; &lt;/button&gt; &lt;/transition&gt; &lt;button @click=&quot;isEditing=!isEditing&quot;&gt;ç‚¹å‡»&lt;/button&gt;&lt;/div&gt;var vm = new Vue(&#123; el: &apos;#app&apos;, data: &#123; isEditing: true &#125; &#125;); ä½¿ç”¨å¤šä¸ª v-if çš„å¤šä¸ªå…ƒç´ çš„è¿‡æ¸¡å¯ä»¥é‡å†™ä¸ºç»‘å®šäº†åŠ¨æ€å±æ€§çš„å•ä¸ªå…ƒç´ è¿‡æ¸¡ 123456789101112131415161718192021222324252627&lt;transition&gt; &lt;button v-if=&quot;docState === &apos;saved&apos;&quot; key=&quot;saved&quot;&gt; Edit &lt;/button&gt; &lt;button v-if=&quot;docState === &apos;edited&apos;&quot; key=&quot;edited&quot;&gt; Save &lt;/button&gt; &lt;button v-if=&quot;docState === &apos;editing&apos;&quot; key=&quot;editing&quot;&gt; Cancel &lt;/button&gt;&lt;/transition&gt;&lt;!-- é‡å†™ --&gt;&lt;transition&gt; &lt;button v-bind:key=&quot;docState&quot;&gt; &#123;&#123; buttonMessage &#125;&#125; &lt;/button&gt;&lt;/transition&gt;// ...computed: &#123; buttonMessage: function () &#123; switch (this.docState) &#123; case &apos;saved&apos;: return &apos;Edit&apos; case &apos;edited&apos;: return &apos;Save&apos; case &apos;editing&apos;: return &apos;Cancel&apos; &#125; &#125;&#125; å¤šå…ƒç´ çš„è¿‡æ¸¡æ¨¡å¼å¤šå…ƒç´ è¿‡æ¸¡æ—¶(ä¸€ä¸ªenterã€ä¸€ä¸ªleave)é»˜è®¤æ˜¯è¿›å…¥å’Œç¦»å¼€åŒæ—¶å‘ç”Ÿï¼›è¿™æ ·å¯èƒ½ä¼šå‘ç”Ÿè¿‡æ¸¡æ—¶ç”»é¢æŠ–åŠ¨çš„é—®é¢˜ï¼›é€šè¿‡å¤šå…ƒç´ çš„è¿‡æ¸¡æ¨¡å¼å¯ä»¥è§£å†³ é€šè¿‡åœ¨&lt;transtion&gt;ä¸Šæ·»åŠ modeç‰¹æ€§ä¾¿å¯æŒ‡å®šè¿‡æ¸¡æ¨¡å¼ in-out: æ–°å…ƒç´ å…ˆè¿›è¡Œè¿‡æ¸¡è¿›å…¥ï¼Œå®Œæˆä¹‹åå½“å‰å…ƒç´ è¿‡æ¸¡ç¦»å¼€ã€‚-&gt;å…ˆenteråleave out-in: å½“å‰å…ƒç´ å…ˆè¿›è¡Œè¿‡æ¸¡ç¦»å¼€ï¼Œå®Œæˆä¹‹åæ–°å…ƒç´ è¿‡æ¸¡è¿›å…¥ã€‚-&gt;å…ˆleaveåenter1234567891011121314151617181920212223242526272829303132&lt;style type=&quot;text/css&quot;&gt; .fade-enter, .fade-leave-to &#123; opacity: 0; &#125; .fade-enter &#123; transform: translateX(10px); &#125; .fade-leave-to &#123; transform: translateX(-10px); &#125; .fade-enter-active, .fade-leave-active &#123; transition: all .3s ease-in-out; &#125;&lt;/style&gt;&lt;div id=&quot;app&quot;&gt; &lt;transition name=&quot;fade&quot; mode=&quot;in-out&quot;&gt; &lt;button :key=&quot;isEditing&quot; @click=&quot;isEditing=!isEditing&quot; :style=&quot;&#123;position:&apos;absolute&apos;&#125;&quot;&gt; &#123;&#123; isEditing &#125;&#125; &lt;/button&gt; &lt;/transition&gt;&lt;/div&gt; var vm = new Vue(&#123; el: &apos;#app&apos;, data: &#123; isEditing: true &#125;&#125;); å¤šä¸ªç»„ä»¶çš„è¿‡æ¸¡ å¤šä¸ªç»„ä»¶çš„è¿‡æ¸¡ç®€å•å¾ˆå¤š - æˆ‘ä»¬ä¸éœ€è¦ä½¿ç”¨ key ç‰¹æ€§ã€‚ç›¸åï¼Œæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨åŠ¨æ€ç»„ä»¶1234567891011121314151617181920212223&lt;transition name=&quot;component-fade&quot; mode=&quot;out-in&quot;&gt; &lt;component v-bind:is=&quot;view&quot;&gt;&lt;/component&gt;&lt;/transition&gt;new Vue(&#123; el: &apos;#transition-components-demo&apos;, data: &#123; view: &apos;v-a&apos; &#125;, components: &#123; &apos;v-a&apos;: &#123; template: &apos;&lt;div&gt;Component A&lt;/div&gt;&apos; &#125;, &apos;v-b&apos;: &#123; template: &apos;&lt;div&gt;Component B&lt;/div&gt;&apos; &#125; &#125;&#125;);.component-fade-enter-active, .component-fade-leave-active &#123; transition: opacity .3s ease;&#125;.component-fade-enter, .component-fade-leave-to&#123; opacity: 0;&#125; åˆ—è¡¨è¿‡æ¸¡ é‚£ä¹ˆæ€ä¹ˆåŒæ—¶æ¸²æŸ“æ•´ä¸ªåˆ—è¡¨ï¼Œæ¯”å¦‚ä½¿ç”¨ v-for ï¼Ÿåœ¨è¿™ç§åœºæ™¯ä¸­ï¼Œä½¿ç”¨&lt;transition-group&gt;ç»„ä»¶ã€‚ ä¸åŒäº&lt;transition&gt;ï¼Œå®ƒä¼šä»¥ä¸€ä¸ªçœŸå®å…ƒç´ å‘ˆç°ï¼šé»˜è®¤ä¸ºä¸€ä¸ª ã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡tagç‰¹æ€§æ›´æ¢ä¸ºå…¶ä»–å…ƒç´ ã€‚ å†…éƒ¨å…ƒç´  æ€»æ˜¯éœ€è¦ æä¾›å”¯ä¸€çš„ key å±æ€§å€¼1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;style type=&quot;text/css&quot;&gt; .list-item &#123; display: inline-block; margin-right: 10px; &#125; .list-enter-active, .list-leave-active &#123; transition: all 1s; &#125; .list-enter, .list-leave-to &#123; opacity: 0; transform: translateY(30px); &#125;&lt;/style&gt;&lt;div id=&quot;list-demo&quot; class=&quot;demo&quot;&gt; &lt;button v-on:click=&quot;add&quot;&gt;Add&lt;/button&gt; &lt;button v-on:click=&quot;remove&quot;&gt;Remove&lt;/button&gt; &lt;!-- å› ä¸ºæŒ‡å®šäº†tagç‰¹æ€§ï¼Œæ‰€ä»¥transition-groupå°†è¢«på–ä»£ --&gt; &lt;transition-group name=&quot;list&quot; tag=&quot;p&quot;&gt; &lt;!-- ç»‘å®šå”¯ä¸€çš„key --&gt; &lt;span v-for=&quot;item in items&quot; v-bind:key=&quot;item&quot; class=&quot;list-item&quot;&gt;&#123;&#123; item &#125;&#125;&lt;/span&gt; &lt;/transition-group&gt;&lt;/div&gt;new Vue(&#123; el: &apos;#list-demo&apos;, data: &#123; items: [1, 2, 3, 4, 5, 6, 7, 8, 9], nextNum: 10 &#125;, methods: &#123; randomIndex: function() &#123; return Math.floor(Math.random() * this.items.length) &#125;, add: function() &#123; this.items.splice(this.randomIndex(), 0, this.nextNum++) &#125;, remove: function() &#123; this.items.splice(this.randomIndex(), 1) &#125;, &#125;&#125;); åˆ—è¡¨çš„ä½ç§»è¿‡æ¸¡ ä¸Šé¢çš„ä¾‹å­ï¼Œå½“æ·»åŠ å’Œç§»é™¤å…ƒç´ çš„æ—¶å€™ï¼Œå‘¨å›´çš„å…ƒç´ ä¼šç¬é—´ç§»åŠ¨åˆ°ä»–ä»¬çš„æ–°å¸ƒå±€çš„ä½ç½®ï¼Œè€Œä¸æ˜¯å¹³æ»‘çš„è¿‡æ¸¡ &lt;transition-group&gt;ç»„ä»¶è¿˜æœ‰ä¸€ä¸ªç‰¹æ®Šä¹‹å¤„ã€‚ä¸ä»…å¯ä»¥è¿›å…¥å’Œç¦»å¼€åŠ¨ç”»ï¼Œè¿˜å¯ä»¥æ”¹å˜å®šä½ã€‚è¦ä½¿ç”¨è¿™ä¸ªæ–°åŠŸèƒ½åªéœ€äº†è§£æ–°å¢çš„v-moveç‰¹æ€§ï¼Œå®ƒä¼šåœ¨å…ƒç´ çš„æ”¹å˜å®šä½çš„è¿‡ç¨‹ä¸­åº”ç”¨ã€‚åƒä¹‹å‰çš„ç±»åä¸€æ ·ï¼Œå¯ä»¥é€šè¿‡nameå±æ€§æ¥è‡ªå®šä¹‰å‰ç¼€ï¼Œä¹Ÿå¯ä»¥é€šè¿‡move-classå±æ€§æ‰‹åŠ¨è®¾ç½® 12345678910111213141516171819202122232425&lt;style type=&quot;text/css&quot;&gt; /*è®¾ç½®-move*/ .flip-list-move &#123; transition: transform 1s; &#125;&lt;/style&gt;&lt;div id=&quot;flip-list-demo&quot; class=&quot;demo&quot;&gt; &lt;button v-on:click=&quot;shuffle&quot;&gt;æ´—ç‰Œ&lt;/button&gt; &lt;transition-group name=&quot;flip-list&quot; tag=&quot;ul&quot;&gt; &lt;li v-for=&quot;item in items&quot; v-bind:key=&quot;item&quot;&gt; &#123;&#123; item &#125;&#125; &lt;/li&gt; &lt;/transition-group&gt;&lt;/div&gt;new Vue(&#123; el: &apos;#flip-list-demo&apos;, data: &#123; items: [1, 2, 3, 4, 5, 6, 7, 8, 9] &#125;, methods: &#123; shuffle: function() &#123; this.items = _.shuffle(this.items) // æ‰“ä¹± &#125; &#125;&#125;) å†…éƒ¨çš„å®ç°ï¼ŒVue ä½¿ç”¨äº†ä¸€ä¸ªå« FLIP ç®€å•çš„åŠ¨ç”»é˜Ÿåˆ—ä½¿ç”¨ transforms å°†å…ƒç´ ä»ä¹‹å‰çš„ä½ç½®å¹³æ»‘è¿‡æ¸¡æ–°çš„ä½ç½®ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ä½¿ç”¨FLIPè¿‡æ¸¡çš„å…ƒç´ ä¸èƒ½è®¾ç½®ä¸º display: inline ã€‚ä½œä¸ºæ›¿ä»£æ–¹æ¡ˆï¼Œå¯ä»¥è®¾ç½®ä¸º display: inline-block æˆ–è€…æ”¾ç½®äº flex ä¸­ åˆ—è¡¨çš„æ¸è¿›è¿‡æ¸¡ é€šè¿‡ data å±æ€§ä¸ JavaScript é€šä¿¡ ï¼Œå°±å¯ä»¥å®ç°åˆ—è¡¨çš„æ¸è¿›è¿‡æ¸¡1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/velocity/1.2.3/velocity.min.js&quot;&gt;&lt;/script&gt;&lt;div id=&quot;staggered-list-demo&quot;&gt; &lt;input v-model=&quot;query&quot;&gt; &lt;!-- å› ä¸ºæ˜¯å…¨éƒ¨ç”¨jså®ŒæˆåŠ¨ç”»ï¼Œæ‰€ä»¥v-bind:css=&quot;false&quot;ï¼Œé¿å¼€cssåŠ¨ç”»æ£€æŸ¥ï¼Œæé«˜æ•ˆç‡ï¼›å¹¶åœ¨å„ä¸ªåŠ¨ç”»é’©å­å¤„ç»‘å®šåŠ¨ç”»å‡½æ•° --&gt; &lt;transition-group name=&quot;staggered-fade&quot; tag=&quot;ul&quot; v-bind:css=&quot;false&quot; v-on:before-enter=&quot;beforeEnter&quot; v-on:enter=&quot;enter&quot; v-on:leave=&quot;leave&quot;&gt; &lt;!-- ç»‘å®šå”¯ä¸€çš„keyå¹¶ç»‘å®šç´¢å¼• --&gt; &lt;li v-for=&quot;(item, index) in computedList&quot; v-bind:key=&quot;item.msg&quot; v-bind:data-index=&quot;index&quot;&gt;&#123;&#123; item.msg &#125;&#125;&lt;/li&gt; &lt;/transition-group&gt;&lt;/div&gt;new Vue(&#123; el: &apos;#staggered-list-demo&apos;, data: &#123; query: &apos;&apos;, list: [ &#123; msg: &apos;Bruce Lee&apos; &#125;, &#123; msg: &apos;Jackie Chan&apos; &#125;, &#123; msg: &apos;Chuck Norris&apos; &#125;, &#123; msg: &apos;Jet Li&apos; &#125;, &#123; msg: &apos;Kung Fury&apos; &#125; ] &#125;, computed: &#123; computedList: function() &#123; var vm = this return this.list.filter(function(item) &#123; return item.msg.toLowerCase().indexOf(vm.query.toLowerCase()) !== -1 &#125;) &#125; &#125;, methods: &#123; beforeEnter: function(el) &#123; el.style.opacity = 0 el.style.height = 0 &#125;, enter: function(el, done) &#123; // æ ¹æ®ç´¢å¼•åˆ›å»ºå»¶è¿Ÿ var delay = el.dataset.index * 150; setTimeout(function() &#123; Velocity( el, &#123; opacity: 1, height: &apos;1.6em&apos; &#125;, &#123; complete: done &#125; ) &#125;, delay) &#125;, leave: function(el, done) &#123; var delay = el.dataset.index * 150 setTimeout(function() &#123; Velocity( el, &#123; opacity: 0, height: 0 &#125;, &#123; complete: done &#125; ) &#125;, delay) &#125; &#125; &#125;) å¯å¤ç”¨çš„è¿‡æ¸¡ è¿‡æ¸¡å¯ä»¥é€šè¿‡ Vue çš„ç»„ä»¶ç³»ç»Ÿå®ç°å¤ç”¨ è¦åˆ›å»ºä¸€ä¸ªå¯å¤ç”¨è¿‡æ¸¡ç»„ä»¶ï¼Œä½ éœ€è¦åšçš„å°±æ˜¯å°† æˆ–è€… ä½œä¸ºæ ¹ç»„ä»¶ï¼Œç„¶åå°†ä»»ä½•å­ç»„ä»¶æ”¾ç½®åœ¨å…¶ä¸­å°±å¯ä»¥äº†ã€‚1234567891011121314151617181920Vue.component(&apos;my-special-transition&apos;, &#123; template: &apos;\ &lt;transition\ name=&quot;very-special-transition&quot;\ mode=&quot;out-in&quot;\ v-on:before-enter=&quot;beforeEnter&quot;\ v-on:after-enter=&quot;afterEnter&quot;\ &gt;\ &lt;slot&gt;&lt;/slot&gt;\ &lt;/transition&gt;\ &apos;, methods: &#123; beforeEnter: function (el) &#123; // ... &#125;, afterEnter: function (el) &#123; // ... &#125; &#125;&#125;) åŠ¨æ€è¿‡æ¸¡ Vue ä¸­å³ä½¿æ˜¯è¿‡æ¸¡ä¹Ÿæ˜¯æ•°æ®é©±åŠ¨çš„ï¼Œè¿‡æ¸¡ä¸­çš„å„ç§çŠ¶æ€èƒ½é€šè¿‡æ•°æ®åŠ¨æ€æ”¹å˜ã€‚ å½“ä½ æƒ³ç”¨ Vue çš„è¿‡æ¸¡ç³»ç»Ÿæ¥å®šä¹‰çš„ CSS è¿‡æ¸¡/åŠ¨ç”» åœ¨ä¸åŒè¿‡æ¸¡é—´åˆ‡æ¢ä¼šéå¸¸æœ‰ç”¨ æ‰€æœ‰çš„è¿‡æ¸¡ç‰¹æ€§éƒ½æ˜¯åŠ¨æ€ç»‘å®šã€‚ å®ƒä¸ä»…æ˜¯ç®€å•çš„ç‰¹æ€§ï¼Œé€šè¿‡äº‹ä»¶çš„é’©å­å‡½æ•°æ–¹æ³•ï¼Œå¯ä»¥åœ¨è·å–åˆ°ç›¸åº”ä¸Šä¸‹æ–‡æ•°æ®ã€‚ è¿™æ„å‘³ç€ï¼Œå¯ä»¥æ ¹æ®ç»„ä»¶çš„çŠ¶æ€é€šè¿‡ JavaScript è¿‡æ¸¡è®¾ç½®ä¸åŒçš„è¿‡æ¸¡æ•ˆæœã€‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/velocity/1.2.3/velocity.min.js&quot;&gt;&lt;/script&gt;&lt;div id=&quot;dynamic-fade-demo&quot; class=&quot;demo&quot;&gt; Fade In: &lt;input type=&quot;range&quot; v-model=&quot;fadeInDuration&quot; min=&quot;0&quot; v-bind:max=&quot;maxFadeDuration&quot;&gt; Fade Out: &lt;input type=&quot;range&quot; v-model=&quot;fadeOutDuration&quot; min=&quot;0&quot; v-bind:max=&quot;maxFadeDuration&quot;&gt; &lt;transition v-bind:css=&quot;false&quot; v-on:before-enter=&quot;beforeEnter&quot; v-on:enter=&quot;enter&quot; v-on:leave=&quot;leave&quot; &gt; &lt;p v-if=&quot;show&quot;&gt;hello&lt;/p&gt; &lt;/transition&gt; &lt;button v-if=&quot;stop&quot; v-on:click=&quot;stop = false; show = false&quot; &gt;Start animating&lt;/button&gt; &lt;button v-else v-on:click=&quot;stop = true&quot; &gt;Stop it!&lt;/button&gt;&lt;/div&gt;new Vue(&#123; el: &apos;#dynamic-fade-demo&apos;, data: &#123; show: true, fadeInDuration: 1000, fadeOutDuration: 1000, maxFadeDuration: 1500, stop: true &#125;, mounted: function () &#123; this.show = false &#125;, methods: &#123; beforeEnter: function (el) &#123; el.style.opacity = 0 &#125;, enter: function (el, done) &#123; var vm = this Velocity(el, &#123; opacity: 1 &#125;, &#123; duration: this.fadeInDuration,// æŒç»­æ—¶é—´ä¸ºåŠ¨æ€ç»‘å®š complete: function () &#123; done() if (!vm.stop) vm.show = false &#125; &#125; ) &#125;, leave: function (el, done) &#123; var vm = this Velocity(el, &#123; opacity: 0 &#125;, &#123; duration: this.fadeOutDuration,// æŒç»­æ—¶é—´ä¸ºåŠ¨æ€ç»‘å®š complete: function () &#123; done() vm.show = true &#125; &#125; ) &#125; &#125;&#125;) è¿‡æ¸¡çŠ¶æ€ Vue çš„è¿‡æ¸¡ç³»ç»Ÿæä¾›äº†éå¸¸å¤šç®€å•çš„æ–¹æ³•è®¾ç½®è¿›å…¥ã€ç¦»å¼€å’Œåˆ—è¡¨çš„åŠ¨æ•ˆã€‚æœ‰äº›å˜åŒ–ä¸­é—´çš„è¿‡æ¸¡çŠ¶æ€æ— æ³•é€šè¿‡vueç‹¬è‡ªå®Œæˆï¼Œä¾‹å¦‚ æ•°å­—å’Œè¿ç®—(æ•°å­—ä»1å˜ä¸º10ä¸­é—´çš„è¿‡æ¸¡) é¢œè‰²çš„æ˜¾ç¤º(ä»ä¸€ç§é¢œè‰²å˜åŒ–åˆ°å¦ä¸€ç§çš„è¿‡æ¸¡) SVG èŠ‚ç‚¹çš„ä½ç½® å…ƒç´ çš„å¤§å°å’Œå…¶ä»–çš„å±æ€§ æ‰€æœ‰çš„åŸå§‹æ•°å­—éƒ½è¢«äº‹å…ˆå­˜å‚¨èµ·æ¥ï¼Œå¯ä»¥ç›´æ¥è½¬æ¢åˆ°æ•°å­—ã€‚åšåˆ°è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»“åˆ Vue çš„å“åº”å¼å’Œç»„ä»¶ç³»ç»Ÿï¼Œä½¿ç”¨ç¬¬ä¸‰æ–¹åº“æ¥å®ç°åˆ‡æ¢å…ƒç´ çš„è¿‡æ¸¡çŠ¶æ€ï¼Œè¡¥é—´åŠ¨ç”» çŠ¶æ€åŠ¨ç”» ä¸ watcher é€šè¿‡ watcher æˆ‘ä»¬èƒ½ç›‘å¬åˆ°ä»»ä½•æ•°å€¼å±æ€§çš„æ•°å€¼æ›´æ–°ï¼Œç„¶åè°ƒç”¨ä¸€äº›è¾…åŠ©ç”¨çš„åŠ¨ç”»åº“(ä¾‹å¦‚tween.jsã€color.js)å®Œæˆç›¸åº”çš„ç‰¹æ®Šè¿‡æ¸¡123456789101112131415161718192021222324252627282930&lt;script src=&quot;https://unpkg.com/tween.js@16.3.4&quot;&gt;&lt;/script&gt;&lt;div id=&quot;animated-number-demo&quot;&gt; &lt;input v-model.number=&quot;number&quot; type=&quot;number&quot; step=&quot;20&quot;&gt; &lt;p&gt;&#123;&#123; animatedNumber &#125;&#125;&lt;/p&gt;&lt;/div&gt;new Vue(&#123; el: &apos;#animated-number-demo&apos;, data: &#123; number: 0, animatedNumber: 0 &#125;, watch: &#123; number: function(newValue, oldValue) &#123; var vm = this function animate () &#123; if (TWEEN.update()) &#123; requestAnimationFrame(animate) &#125; &#125; new TWEEN.Tween(&#123; tweeningNumber: oldValue &#125;) .easing(TWEEN.Easing.Quadratic.Out) .to(&#123; tweeningNumber: newValue &#125;, 500) .onUpdate(function () &#123; vm.animatedNumber = this.tweeningNumber.toFixed(0) &#125;) .start() animate() &#125; &#125;&#125;) åŠ¨æ€çŠ¶æ€è½¬æ¢ ç±»ä¼¼åŠ¨æ€è¿‡æ¸¡ï¼Œæ¯ä¸ªçŠ¶æ€éƒ½æ˜¯å¯å˜çš„(å“åº”å¼çš„) é€šè¿‡ç»„ä»¶ç»„ç»‡è¿‡æ¸¡ ç®¡ç†å¤ªå¤šçš„çŠ¶æ€è½¬æ¢ä¼šå¾ˆå¿«çš„å¢åŠ  Vue å®ä¾‹æˆ–è€…ç»„ä»¶çš„å¤æ‚æ€§ï¼Œå¹¸å¥½å¾ˆå¤šçš„åŠ¨ç”»å¯ä»¥æå–åˆ°ä¸“ç”¨çš„å­ç»„ä»¶ã€‚1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071&lt;script src=&quot;https://unpkg.com/tween.js@16.3.4&quot;&gt;&lt;/script&gt;&lt;div id=&quot;example-8&quot;&gt; &lt;input v-model.number=&quot;firstNumber&quot; type=&quot;number&quot; step=&quot;20&quot;&gt; + &lt;input v-model.number=&quot;secondNumber&quot; type=&quot;number&quot; step=&quot;20&quot;&gt; = &#123;&#123; result &#125;&#125; &lt;p&gt; &lt;!-- ä¼ å…¥è¾“å…¥æ¡†çš„å€¼ --&gt; &lt;animated-integer v-bind:value=&quot;firstNumber&quot;&gt;&lt;/animated-integer&gt; + &lt;animated-integer v-bind:value=&quot;secondNumber&quot;&gt;&lt;/animated-integer&gt; = &lt;animated-integer v-bind:value=&quot;result&quot;&gt;&lt;/animated-integer&gt; &lt;/p&gt;&lt;/div&gt;// è¿™ç§å¤æ‚çš„è¡¥é—´åŠ¨ç”»é€»è¾‘å¯ä»¥è¢«å¤ç”¨// ä»»ä½•æ•´æ•°éƒ½å¯ä»¥æ‰§è¡ŒåŠ¨ç”»// ç»„ä»¶åŒ–ä½¿æˆ‘ä»¬çš„ç•Œé¢ååˆ†æ¸…æ™°// å¯ä»¥æ”¯æŒæ›´å¤šæ›´å¤æ‚çš„åŠ¨æ€è¿‡æ¸¡Vue.component(&apos;animated-integer&apos;, &#123; template: &apos;&lt;span&gt;&#123;&#123; tweeningValue &#125;&#125;&lt;/span&gt;&apos;, props: &#123; value: &#123; // æ¥æ”¶çš„å€¼ type: Number, required: true &#125; &#125;, data: function() &#123; return &#123; tweeningValue: 0 &#125; &#125;, watch: &#123; // ä¼ è¿‡æ¥çš„å€¼æœ‰å˜åŒ–ï¼Œè§¦å‘tween value: function(newValue, oldValue) &#123; this.tween(oldValue, newValue) &#125; &#125;, mounted: function() &#123; // åˆšè½½å…¥ï¼Œè§¦å‘é»˜è®¤tween this.tween(0, this.value) &#125;, methods: &#123; tween: function(startValue, endValue) &#123; var vm = this; // raf function animate() &#123; if (TWEEN.update()) &#123; requestAnimationFrame(animate) &#125; &#125; // æ•°å€¼å˜åŒ–çš„è¡¥é—´åŠ¨ç”» new TWEEN.Tween(&#123; tweeningValue: startValue &#125;) .to(&#123; tweeningValue: endValue &#125;, 500) .onUpdate(function() &#123; vm.tweeningValue = this.tweeningValue.toFixed(0) &#125;) .start(); // è°ƒç”¨ä¸€æ¬¡ animate(); &#125; &#125;&#125;);new Vue(&#123; el: &apos;#example-8&apos;, data: &#123; firstNumber: 20, secondNumber: 40 &#125;, computed: &#123; result: function() &#123; return this.firstNumber + this.secondNumber &#125; &#125;&#125;) Renderå‡½æ•°-&gt;ç”¨åˆ°å†è¡¥è‡ªå®šä¹‰æŒ‡ä»¤ vue2ä¸­ä»£ç å¤ç”¨çš„ä¸»è¦å½¢å¼å’ŒæŠ½è±¡æ˜¯ç»„ä»¶,æœ‰çš„æƒ…å†µä¸‹,ä½ ä»ç„¶éœ€è¦å¯¹çº¯ DOM å…ƒç´ è¿›è¡Œåº•å±‚æ“ä½œ,è¿™æ—¶å€™å°±ä¼šç”¨åˆ°è‡ªå®šä¹‰æŒ‡ä»¤ã€‚ ç®€ä»‹ æ³¨å†Œ å…¨å±€æ³¨å†Œ 12345678// æ³¨å†Œä¸€ä¸ªå…¨å±€è‡ªå®šä¹‰æŒ‡ä»¤ v-focusVue.directive(&apos;focus&apos;, &#123; // å½“ç»‘å®šå…ƒç´ æ’å…¥åˆ° DOM ä¸­ã€‚ inserted: function (el) &#123; // èšç„¦å…ƒç´  el.focus() &#125;&#125;) å±€éƒ¨æ³¨å†Œ 12345directives: &#123; focus: &#123; // æŒ‡ä»¤çš„å®šä¹‰--- &#125;&#125; ä½¿ç”¨-&gt;&lt;input v-focus&gt; é’©å­å‡½æ•° è‡ªå®šä¹‰æŒ‡ä»¤æä¾›ä¸‹é¢é’©å­ bind-&gt;åªè°ƒç”¨ä¸€æ¬¡ï¼Œåªåœ¨ç¬¬ä¸€æ¬¡ç»‘å®šåˆ°å…ƒç´ æ—¶è°ƒç”¨ï¼Œä¸»è¦ç”¨åšåˆå§‹åŒ–å·¥ä½œ inserted-&gt;è¢«ç»‘å®šå…ƒç´ æ’å…¥çˆ¶èŠ‚ç‚¹æ—¶è°ƒç”¨ï¼ˆçˆ¶èŠ‚ç‚¹å­˜åœ¨å³å¯è°ƒç”¨ï¼Œä¸å¿…å­˜åœ¨äº document ä¸­ï¼‰ componentUpdated-&gt;æ‰€åœ¨ç»„ä»¶çš„ VNode åŠå…¶å­©å­çš„ VNode å…¨éƒ¨æ›´æ–°æ—¶è°ƒç”¨ã€‚ update-&gt;æ‰€åœ¨ç»„ä»¶çš„ VNode æ›´æ–°æ—¶è°ƒç”¨,ä½†æ˜¯å¯èƒ½å‘ç”Ÿåœ¨å…¶å­©å­çš„ VNode æ›´æ–°ä¹‹å‰ã€‚æŒ‡ä»¤çš„å€¼å¯èƒ½å‘ç”Ÿäº†æ”¹å˜ä¹Ÿå¯èƒ½æ²¡æœ‰ã€‚ä½†æ˜¯ä½ å¯ä»¥é€šè¿‡æ¯”è¾ƒæ›´æ–°å‰åçš„å€¼æ¥å¿½ç•¥ä¸å¿…è¦çš„æ¨¡æ¿æ›´æ–° unbind-&gt; åªè°ƒç”¨ä¸€æ¬¡ï¼Œ æŒ‡ä»¤ä¸å…ƒç´ è§£ç»‘æ—¶è°ƒç”¨ é’©å­å‡½æ•°å‚æ•° é’©å­å‡½æ•°çš„å›è°ƒåœ¨è¢«è°ƒç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨ä¼ å…¥ä¸€äº›å‚æ•°el,bingding,vnode,oldVnode -el: æŒ‡ä»¤æ‰€ç»‘å®šçš„å…ƒç´ ï¼Œå¯ä»¥ç”¨æ¥ç›´æ¥æ“ä½œ DOM ã€‚ binding: ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å±æ€§ name: æŒ‡ä»¤åï¼Œä¸åŒ…æ‹¬ v- å‰ç¼€ã€‚ value: æŒ‡ä»¤çš„ç»‘å®šå€¼ï¼Œ ä¾‹å¦‚ï¼š v-my-directive=â€1 + 1â€, value çš„å€¼æ˜¯ 2ã€‚ oldValue: æŒ‡ä»¤ç»‘å®šçš„å‰ä¸€ä¸ªå€¼ï¼Œä»…åœ¨ update å’Œ componentUpdated é’©å­ä¸­å¯ç”¨ã€‚æ— è®ºå€¼æ˜¯å¦æ”¹å˜éƒ½å¯ç”¨ã€‚ expression: ç»‘å®šå€¼çš„å­—ç¬¦ä¸²å½¢å¼ã€‚ ä¾‹å¦‚ v-my-directive=â€1 + 1â€ ï¼Œ expression çš„å€¼æ˜¯ â€œ1 + 1â€ã€‚ arg: ä¼ ç»™æŒ‡ä»¤çš„å‚æ•°ã€‚ä¾‹å¦‚ v-my-directive:fooï¼Œ arg çš„å€¼æ˜¯ â€œfooâ€ã€‚ modifiers: ä¸€ä¸ªåŒ…å«ä¿®é¥°ç¬¦çš„å¯¹è±¡ã€‚ ä¾‹å¦‚ï¼š v-my-directive.foo.bar, ä¿®é¥°ç¬¦å¯¹è±¡ modifiers çš„å€¼æ˜¯ { foo: true, bar: true }ã€‚ vnode: Vue ç¼–è¯‘ç”Ÿæˆçš„è™šæ‹ŸèŠ‚ç‚¹ oldVnode: ä¸Šä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼Œä»…åœ¨ update å’Œ componentUpdated é’©å­ä¸­å¯ç”¨ã€‚ é™¤äº† el ä¹‹å¤–ï¼Œå…¶å®ƒå‚æ•°éƒ½åº”è¯¥æ˜¯åªè¯»çš„ï¼Œå°½é‡ä¸è¦ä¿®æ”¹ä»–ä»¬ã€‚å¦‚æœéœ€è¦åœ¨é’©å­ä¹‹é—´å…±äº«æ•°æ®ï¼Œå»ºè®®é€šè¿‡å…ƒç´ çš„ dataset æ¥è¿›è¡Œã€‚12345678910111213141516171819&lt;div id=&quot;hook-arguments-example&quot; v-demo:foo.a.b=&quot;message&quot;&gt;&lt;/div&gt;Vue.directive(&apos;demo&apos;, &#123; bind: function (el, binding, vnode) &#123; var s = JSON.stringify el.innerHTML = &apos;name: &apos; + s(binding.name) + &apos;&lt;br&gt;&apos; + &apos;value: &apos; + s(binding.value) + &apos;&lt;br&gt;&apos; + &apos;expression: &apos; + s(binding.expression) + &apos;&lt;br&gt;&apos; + &apos;argument: &apos; + s(binding.arg) + &apos;&lt;br&gt;&apos; + &apos;modifiers: &apos; + s(binding.modifiers) + &apos;&lt;br&gt;&apos; + &apos;vnode keys: &apos; + Object.keys(vnode).join(&apos;, &apos;) &#125;&#125;);new Vue(&#123; el: &apos;#hook-arguments-example&apos;, data: &#123; message: &apos;hello!&apos; &#125;&#125;); å‡½æ•°ç®€å†™ å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³åœ¨ bind å’Œ update é’©å­ä¸Šåšé‡å¤åŠ¨ä½œï¼Œå¹¶ä¸”ä¸æƒ³å…³å¿ƒå…¶å®ƒçš„é’©å­å‡½æ•°ã€‚ ç¬¬äºŒä¸ªå‚æ•°ä¸ä¼ å…¥é€‰é¡¹å¯¹è±¡ï¼Œè€Œæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåˆ™è¡¨ç¤ºæ­¤å‡½æ•°åªä¼šåœ¨bindå’Œupdateæ—¶è¢«è°ƒç”¨123Vue.directive(&apos;color-swatch&apos;, function (el, binding) &#123; el.style.backgroundColor = binding.value&#125;) å¯¹è±¡å­—é¢é‡ å¦‚æœæŒ‡ä»¤éœ€è¦å¤šä¸ªå€¼ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ª JavaScript å¯¹è±¡å­—é¢é‡12345&lt;div v-demo=&quot;&#123; color: &apos;white&apos;, text: &apos;hello!&apos; &#125;&quot;&gt;&lt;/div&gt;Vue.directive(&apos;demo&apos;, function (el, binding) &#123; console.log(binding.value.color) // =&gt; &quot;white&quot; console.log(binding.value.text) // =&gt; &quot;hello!&quot;&#125;) æ··åˆ å½“å¤šä¸ªç»„ä»¶æ‹¥æœ‰ç›¸åŒçš„é€‰é¡¹æ—¶ï¼Œå¯ä»¥å°†è¿™äº›å…¬ç”¨é€‰é¡¹æŠ½è±¡æˆä¸€ä¸ªmixinå¯¹è±¡ï¼Œç„¶åé€šè¿‡é…ç½®ç»„ä»¶çš„mixinså­—æ®µæ¥æ··å…¥é€‰é¡¹(ç±»ä¼¼jQuery.extendæ–¹æ³•) æ··å…¥ç­–ç•¥ æ•°æ®å¯¹è±¡åœ¨å†…éƒ¨è¿›è¡Œåˆå¹¶ï¼›æ•°æ®å†²çªæ—¶ï¼Œä»¥ç»„ä»¶æ•°æ®ä¼˜å…ˆ 12345678910111213141516171819202122var mixin = &#123; data: function () &#123; return &#123; message: 'hello', foo: 'abc' &#125; &#125;&#125;new Vue(&#123; mixins: [mixin], data: function () &#123; return &#123; message: 'goodbye', bar: 'def' &#125; &#125;, created: function () &#123; console.log(this.$data) // =&gt; &#123; message: "goodbye", foo: "abc", bar: "def" &#125; &#125;&#125;) åŒåé’©å­å‡½æ•°ï¼Œå°†ä¼šæ··åˆæˆä¸€ä¸ªæ•°ç»„ï¼Œæ··å…¥çš„é’©å­å‡½æ•°å°†åœ¨ç»„ä»¶è‡ªèº«é’©å­å‡½æ•°ä¹‹å‰è°ƒç”¨ 123456789101112131415var mixin = &#123; created: function () &#123; console.log('æ··å…¥å¯¹è±¡çš„é’©å­è¢«è°ƒç”¨') &#125;&#125;new Vue(&#123; mixins: [mixin], created: function () &#123; console.log('ç»„ä»¶é’©å­è¢«è°ƒç”¨') &#125;&#125;)// =&gt; "æ··å…¥å¯¹è±¡çš„é’©å­è¢«è°ƒç”¨"// =&gt; "ç»„ä»¶é’©å­è¢«è°ƒç”¨" å€¼ä¸ºå¯¹è±¡çš„é€‰é¡¹ï¼Œä¾‹å¦‚ methods, components å’Œ directivesï¼Œå°†è¢«æ··åˆä¸ºåŒä¸€ä¸ªå¯¹è±¡ã€‚ä¸¤ä¸ªå¯¹è±¡é”®åå†²çªæ—¶ï¼Œå–ç»„ä»¶å¯¹è±¡çš„é”®å€¼å¯¹ 1234567891011121314151617181920212223242526var mixin = &#123; methods: &#123; foo: function () &#123; console.log('foo') &#125;, conflicting: function () &#123; console.log('from mixin') &#125; &#125;&#125;var vm = new Vue(&#123; mixins: [mixin], methods: &#123; bar: function () &#123; console.log('bar') &#125;, conflicting: function () &#123; console.log('from self') &#125; &#125;&#125;)vm.foo() // =&gt; "foo"vm.bar() // =&gt; "bar"vm.conflicting() // =&gt; "from self" æ’ä»¶1234import MyPlugin form 'xxxx';// æ’ä»¶ä¸€å®šè¦é€šè¿‡useæ¥æ³¨å†Œä¸€ä¸‹Vue.use(MyPlugin, &#123; someOption: true &#125;); å•æ–‡ä»¶ç»„ä»¶1234567891011121314151617181920212223&lt;!-- æ¯ä¸ª.vueæ–‡ä»¶åªèƒ½åŒ…å«ä¸€ä¸ªtemplateï¼Œtemplateå†…åªèƒ½æœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ --&gt;&lt;template&gt; &lt;div id="app"&gt; &lt;img src="./assets/logo.png"&gt; &lt;router-view/&gt; &lt;/div&gt;&lt;/template&gt;&lt;!-- æ¯ä¸ª .vue æ–‡ä»¶æœ€å¤šåŒ…å«ä¸€ä¸ª &lt;script&gt; å— --&gt;&lt;script&gt;export default &#123; name: 'app'&#125;&lt;/script&gt;&lt;!-- å¯ä»¥æœ‰å¤šä¸ªstyleï¼Œå¯ä»¥åœ¨æ ¹ç»„ä»¶ä¸­å¯¼å…¥ä¸€äº›å…¨å±€æ ·å¼ --&gt;&lt;style src="./assets/test.scss" lang="scss"&gt;&lt;/style&gt;&lt;style src="./assets/test2.scss" lang="scss"&gt;&lt;/style&gt;&lt;!-- å¯¼å…¥è·¯å¾„éƒ½æ˜¯åŸºäºå½“å‰ç›®å½•çš„ï¼Œä¸è¿‡å¯ä»¥ä»NPMåŒ…ä¸­ç›´æ¥å¯¼å…¥èµ„æºï¼Œå¦‚ä¸‹ --&gt;&lt;!-- &lt;style src="todomvc-app-css/index.css"&gt;&lt;/style&gt; --&gt;&lt;!-- å½“styleæ ‡ç­¾æœ‰ scoped å±æ€§æ—¶ï¼Œå®ƒçš„ CSS åªä½œç”¨äºå½“å‰ç»„ä»¶ä¸­çš„å…ƒç´  --&gt;&lt;!-- &lt;style scoped&gt;.example &#123;color: red;&#125;&lt;/style&gt; --&gt;&lt;!-- åœ¨ä½ çš„ &lt;style&gt; ä¸Šæ·»åŠ  module å±æ€§ï¼Œå°†ä¸º css-loader æ‰“å¼€ CSS Modules æ¨¡å¼ï¼Œç”Ÿæˆçš„ CSS å¯¹è±¡å°†ä¸ºç»„ä»¶æ³¨å…¥ä¸€ä¸ªåå« $style çš„è®¡ç®—å±æ€§ï¼Œä½ å¯ä»¥åœ¨ä½ çš„æ¨¡å—ä¸­ä½¿ç”¨åŠ¨æ€ class ç»‘å®š --&gt; ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æç¤º è®°å¾—å®šä¹‰process.env.NODE_ENV = &#39;production&#39; vue-cliçš„buildå‘½ä»¤å·²ç»é¢„å…ˆå®šä¹‰äº† è·¯ç”±ç®€å•è·¯ç”± HTML5 History API12345678910111213141516171819const NotFound = &#123; template: '&lt;p&gt;Page not found&lt;/p&gt;' &#125;const Home = &#123; template: '&lt;p&gt;home page&lt;/p&gt;' &#125;const About = &#123; template: '&lt;p&gt;about page&lt;/p&gt;' &#125;const routes = &#123; '/': Home, '/about': About&#125;new Vue(&#123; el: '#app', data: &#123; currentRoute: window.location.pathname &#125;, computed: &#123; ViewComponent () &#123; return routes[this.currentRoute] || NotFound &#125; &#125;, render (h) &#123; return h(this.ViewComponent) &#125;&#125;) å®˜æ–¹è·¯ç”±Vue-router åŸºç¡€ä½¿ç”¨ 1234567891011121314151617181920212223242526272829303132333435363738394041// router/index.jsimport Vue from 'vue';import Router from 'vue-router';// å¯¼å…¥vue-router..import Recommend from 'components/recommend/recommend'import Singer from 'components/singer/singer'...Vue.use(Router); // å¿…é¡»ä½¿ç”¨useæ–¹æ³•æ¥æ³¨å†Œç¬¬ä¸‰æ–¹æ’ä»¶export default new Router(&#123;// å¯¼å‡ºä¸€ä¸ªvue-routerå®ä¾‹ routes: [&#123; path: '/', redirect: '/recommend',// æ²¡æœ‰åŒ¹é…åˆ°çš„è·¯å¾„å…¨éƒ¨é‡å®šå‘åˆ°/recomend &#125;, &#123; path: '/recommend',// pathä¸€å®šæ˜¯ä¸ªè·¯å¾„ï¼Œå¼€å¤´å¿…é¡»æœ‰/ name: 'Recommend', component: Recommend, children: [&#123;// å­è·¯ç”± path: ':id',// ä¼ é€’çš„å‚æ•° name: 'Disc', component: Disc &#125;]&#125;)// src/main.jsimport Vue from 'vue'...import router from './router'; // å¯¼å…¥...new Vue(&#123; el: '#app', router,// æ³¨å†Œ store, render: h =&gt; h(App)&#125;) åŠ¨æ€è·¯ç”±åŒ¹é… 12345678910const User = &#123; template: '&lt;div&gt;User &#123;&#123; $route.params.id &#125;&#125;&lt;/div&gt;',// è·å–ä¼ é€’åŠ¨æ€è·¯ç”±å‚æ•°&#125;const router = new VueRouter(&#123; routes: [ // åŠ¨æ€è·¯å¾„å‚æ•° ä»¥å†’å·å¼€å¤´ &#123; path: '/user/:id', component: User &#125; ]&#125;) å“åº”è·¯ç”±å‚æ•°çš„å˜åŒ– ä½¿ç”¨åŠ¨æ€è·¯ç”±æ—¶ï¼Œå¦‚æœç»„ä»¶ç›¸åŒï¼Œä»…è·¯ç”±å‚æ•°ä¸åŒï¼Œvueä¼šå¤ç”¨ç»„ä»¶(å¯¼è‡´ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œæ— æ³•å†è¢«è§¦å‘)ï¼Œå¯ä»¥å¯¹è·¯ç”±å‚æ•°çš„å˜åŒ–åšä¸ªè§‚æµ‹ï¼Œæ¥å“åº”å˜åŒ–ï¼›1234567891011121314151617// ä½¿ç”¨watchè§‚æµ‹$routeçš„å˜åŒ–ï¼Œæ¥åšå“åº”const User = &#123; template: '...', watch: &#123; '$route' (to, from) &#123; // å¯¹è·¯ç”±å˜åŒ–ä½œå‡ºå“åº”... &#125; &#125;&#125;// æˆ–è€…ä½¿ç”¨2.2+çš„beforeRouteUpdateconst User = &#123; template: '...', beforeRouteUpdate (to, from, next) &#123; // react to route changes... // don't forget to call next() &#125;&#125; åµŒå¥—è·¯ç”± åœ¨å®šä¹‰routesä½¿ç”¨childrenå­—æ®µæ¥å®šä¹‰è‡ªè·¯ç”±ï¼Œå¹¶åœ¨ä¸Šå±‚è·¯ç”±å¯¹åº”çš„ç»„ä»¶ä¸­æ·»åŠ ä¸€ä¸ªrouter-view æ³¨æ„å­è·¯ç”±å¼€å¤´ä¸èƒ½ä»¥/å¼€å¤´ï¼Œè¿™ä»£è¡¨æ ¹ç›®å½•123456789101112131415161718192021222324252627282930// User.jsconst User = &#123; template: ` &lt;div class="user"&gt; &lt;h2&gt;User &#123;&#123; $route.params.id &#125;&#125;&lt;/h2&gt; &lt;router-view&gt;&lt;/router-view&gt; &lt;/div&gt; `&#125;const router = new VueRouter(&#123; routes: [ &#123; path: '/user/:id', component: User, children: [ &#123; // å½“ /user/:id/profile åŒ¹é…æˆåŠŸï¼Œ // UserProfile ä¼šè¢«æ¸²æŸ“åœ¨ User çš„ &lt;router-view&gt; ä¸­ path: 'profile', component: UserProfile &#125;, &#123; // å½“ /user/:id/posts åŒ¹é…æˆåŠŸ // UserPosts ä¼šè¢«æ¸²æŸ“åœ¨ User çš„ &lt;router-view&gt; ä¸­ path: 'posts', component: UserPosts &#125; ] &#125; ]&#125;) è·¯ç”±è·³è½¬api router.push()ï¼Œå‘å†å²è®°å½•æ ˆä¸­å‹å…¥ä¸€æ¡å†å²è®°å½• 123456789101112131415// å­—ç¬¦ä¸²router.push('home')// å¯¹è±¡router.push(&#123; path: 'home' &#125;)// å‘½åçš„è·¯ç”±router.push(&#123; name: 'user', params: &#123; userId: 123 &#125;&#125;)// å¸¦æŸ¥è¯¢å‚æ•°ï¼Œå˜æˆ /register?plan=privaterouter.push(&#123; path: 'register', query: &#123; plan: 'private' &#125;&#125;)// å¦‚æœæä¾›äº† pathï¼Œparamså°±ä¼šè¢«å¿½ç•¥ï¼Œä¸Šè¿°ä¾‹å­ä¸­çš„ query å¹¶ä¸å±äºè¿™ç§æƒ…å†µ// è¿™é‡Œçš„ params ä¸ç”Ÿæ•ˆrouter.push(&#123; path: '/user', params: &#123; userId &#125;&#125;) // -&gt; /user router.replace()æ›¿æ¢å½“å‰è®°å½•ï¼Œç”¨æ³•ç±»ä¼¼push router.go()å†å²è®°å½•å‰è¿›åå°å‡ æ­¥ å¯ä»¥ç»™è·¯ç”±å‘½å 12345678910111213const router = new VueRouter(&#123; routes: [ &#123; path: '/user/:userId', name: 'user',// å–ä¸ªåå­— component: User &#125; ]&#125;)// è°ƒç”¨&lt;router-link :to="&#123; name: 'user', params: &#123; userId: 123 &#125;&#125;"&gt;User&lt;/router-link&gt;router.push(&#123; name: 'user', params: &#123; userId: 123 &#125;&#125;) ä¹Ÿå¯ä»¥ç»™è§†å›¾å‘½åï¼Œæ–¹ä¾¿åˆ›å»ºsidebarã€mainåŒè§†å›¾çš„å¸ƒå±€ 1234567891011121314151617&lt;router-view class="view one"&gt;&lt;/router-view&gt; // é»˜è®¤è§†å›¾çš„nameä¸ºdefault&lt;router-view class="view two" name="a"&gt;&lt;/router-view&gt;&lt;router-view class="view three" name="b"&gt;&lt;/router-view&gt;const router = new VueRouter(&#123; routes: [ &#123; path: '/', components: &#123; // åŒ¹é…'/'è·¯å¾„æ—¶ï¼Œdefaultè§†å›¾æ¸²æŸ“Fooç»„ä»¶,aè§†å›¾æ¸²æŸ“Bar,bè§†å›¾æ¸²æŸ“Baz default: Foo, a: Bar, b: Baz &#125; &#125; ]&#125;) é‡å®šå‘ã€åˆ«å 1234567891011121314// é‡å®šå‘// å½“ç”¨æˆ·è®¿é—® /aæ—¶ï¼ŒURL å°†ä¼šè¢«æ›¿æ¢æˆ /bï¼Œç„¶ååŒ¹é…è·¯ç”±ä¸º /bconst router = new VueRouter(&#123; routes: [ &#123; path: '/a', redirect: '/b' &#125; ]&#125;)// åˆ«å// /a çš„åˆ«åæ˜¯ /bï¼Œæ„å‘³ç€ï¼Œå½“ç”¨æˆ·è®¿é—® /b æ—¶ï¼ŒURL ä¼šä¿æŒä¸º /bï¼Œä½†æ˜¯è·¯ç”±åŒ¹é…åˆ™ä¸º /aï¼Œå°±åƒç”¨æˆ·è®¿é—® /a ä¸€æ ·ã€‚const router = new VueRouter(&#123; routes: [ &#123; path: '/a', component: A, alias: '/b' &#125; ]&#125;) å‘ç»„ä»¶ä¼ é€’æ•°æ® 12345678910111213141516171819202122232425262728293031// åˆ©ç”¨åŠ¨æ€è·¯å¾„å‚æ•°æ¥ç›´æ¥ä¼ é€’ï¼Œç»„ä»¶å’Œè·¯ç”±è€¦åˆæ€§é«˜const User = &#123; template: '&lt;div&gt;User &#123;&#123; $route.params.id &#125;&#125;&lt;/div&gt;'&#125;const router = new VueRouter(&#123; routes: [ &#123; path: '/user/:id', component: User &#125; ]&#125;)// é€šè¿‡ props è§£è€¦const User = &#123; props: ['id'], template: '&lt;div&gt;User &#123;&#123; id &#125;&#125;&lt;/div&gt;'&#125;const router = new VueRouter(&#123; routes: [ &#123; path: '/user/:id', component: User, props: true,// å‚æ•°ä¼šåšä¸ºpropsä¼ å…¥åˆ°ç»„ä»¶ä¸­ &#125;, // å¯¹äºåŒ…å«å‘½åè§†å›¾çš„è·¯ç”±ï¼Œä½ å¿…é¡»åˆ†åˆ«ä¸ºæ¯ä¸ªå‘½åè§†å›¾æ·»åŠ  `props` é€‰é¡¹ï¼š &#123; path: '/user/:id', components: &#123; default: User, sidebar: Sidebar &#125;, props: &#123; default: true, sidebar: false &#125; &#125; ]&#125;) æ³¨å†Œå¯¼èˆªå®ˆå«(äº‹ä»¶) 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051const router = new VueRouter(&#123; ... &#125;)// å…¨å±€è·¯ç”±å®ˆå«// å…¨å±€å‰ç½®å®ˆå«ï¼Œè·¯ç”±ç¡®è®¤æ—¶è§¦å‘router.beforeEach((to, from, next) =&gt; &#123; // to: Route: å³å°†è¦è¿›å…¥çš„ç›®æ ‡ è·¯ç”±å¯¹è±¡ // from: Route: å½“å‰å¯¼èˆªæ­£è¦ç¦»å¼€çš„è·¯ç”± // next: Function: ä¸€å®šè¦è°ƒç”¨è¯¥æ–¹æ³•æ¥ resolve è¿™ä¸ªé’©å­ã€‚æ‰§è¡Œæ•ˆæœä¾èµ– next æ–¹æ³•çš„è°ƒç”¨å‚æ•°ã€‚&#125;)// å…¨å±€è§£æå®ˆå«ï¼Œè·¯ç”±ç¡®è®¤ä¹‹åï¼Œç»„å†…å®ˆå«ã€å¼‚æ­¥è·¯ç”±ç»„å»ºè¢«è§£æä¹‹åè§¦å‘router.beforeResolve()// å…¨å±€åç½®å®ˆå«ï¼Œè·¯ç”±åˆ°è¾¾åè§¦å‘router.afterEach((to, from) =&gt; &#123; // ...&#125;)// å•ç‹¬è·¯ç”±çš„å®ˆå«// å®šä¹‰åœ¨ä¸€ä¸ªå•ç‹¬è·¯ç”±ä¸Šconst router = new VueRouter(&#123; routes: [ &#123; path: '/foo', component: Foo, beforeEnter: (to, from, next) =&gt; &#123; // ... &#125; &#125; ]&#125;)// ç»„ä»¶å†…è·¯ç”±å®ˆå«const Foo = &#123; template: `...`, beforeRouteEnter (to, from, next) &#123; // åœ¨æ¸²æŸ“è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±è¢« confirm å‰è°ƒç”¨ // å› ä¸ºå½“å®ˆå«æ‰§è¡Œå‰ï¼Œç»„ä»¶å®ä¾‹è¿˜æ²¡è¢«åˆ›å»º // ä¸ï¼èƒ½ï¼è·å–ç»„ä»¶å®ä¾‹ `this`ï¼Œä¸è¿‡è¿™ä¸ªå®ˆå«ä¸­çš„nextå¾ˆç‰¹æ®Šï¼Œå¯ä»¥æ¥æ”¶ä¸€ä¸ªå›è°ƒï¼Œå›è°ƒä¼šæ¥æ”¶åˆ°vmå®ä¾‹ï¼Œå¯ä»¥é€šè¿‡vmå®ä¾‹æ¥è®¿é—®this next(vm=&gt;&#123; // do sth &#125;); &#125;, beforeRouteUpdate (to, from, next) &#123; // åœ¨å½“å‰è·¯ç”±æ”¹å˜ï¼Œä½†æ˜¯è¯¥ç»„ä»¶è¢«å¤ç”¨æ—¶è°ƒç”¨ // ä¸¾ä¾‹æ¥è¯´ï¼Œå¯¹äºä¸€ä¸ªå¸¦æœ‰åŠ¨æ€å‚æ•°çš„è·¯å¾„ /foo/:idï¼Œåœ¨ /foo/1 å’Œ /foo/2 ä¹‹é—´è·³è½¬çš„æ—¶å€™ï¼Œ // ç”±äºä¼šæ¸²æŸ“åŒæ ·çš„ Foo ç»„ä»¶ï¼Œå› æ­¤ç»„ä»¶å®ä¾‹ä¼šè¢«å¤ç”¨ã€‚è€Œè¿™ä¸ªé’©å­å°±ä¼šåœ¨è¿™ä¸ªæƒ…å†µä¸‹è¢«è°ƒç”¨ã€‚ // å¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹ `this` &#125;, beforeRouteLeave (to, from, next) &#123; // å¯¼èˆªç¦»å¼€è¯¥ç»„ä»¶çš„å¯¹åº”è·¯ç”±æ—¶è°ƒç”¨ // å¯ä»¥è®¿é—®ç»„ä»¶å®ä¾‹ `this` &#125;&#125; è·¯ç”±è§£ææµç¨‹ 1234567891011121.å¯¼èˆªè¢«è§¦å‘ã€‚2.åœ¨å¤±æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ç¦»å¼€å®ˆå«ã€‚3.è°ƒç”¨å…¨å±€çš„ beforeEach å®ˆå«ã€‚4.åœ¨é‡ç”¨çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteUpdate å®ˆå« (2.2+)ã€‚5.åœ¨è·¯ç”±é…ç½®é‡Œè°ƒç”¨ beforeEnterã€‚6.è§£æå¼‚æ­¥è·¯ç”±ç»„ä»¶ã€‚7.åœ¨è¢«æ¿€æ´»çš„ç»„ä»¶é‡Œè°ƒç”¨ beforeRouteEnterã€‚8.è°ƒç”¨å…¨å±€çš„ beforeResolve å®ˆå« (2.5+)ã€‚9.å¯¼èˆªè¢«ç¡®è®¤ã€‚10.è°ƒç”¨å…¨å±€çš„ afterEach é’©å­ã€‚11.è§¦å‘ DOM æ›´æ–°ã€‚12.ç”¨åˆ›å»ºå¥½çš„å®ä¾‹è°ƒç”¨ beforeRouteEnter å®ˆå«ä¸­ä¼ ç»™ next çš„å›è°ƒå‡½æ•°ã€‚ è·¯ç”±å…ƒä¿¡æ¯ï¼Œå¯ç”¨æ¥å®Œæˆé¡µé¢æ˜¯å¦ç™»å½•çš„éœ€æ±‚ 1234567891011121314151617181920212223242526272829303132333435363738const router = new VueRouter(&#123; routes: [ &#123; path: '/foo', component: Foo, children: [ &#123; path: 'bar', component: Bar, // a meta fieldï¼Œå®šä¹‰/foo/baréœ€è¦ç™»å½• meta: &#123; requiresAuth: true &#125; &#125; ] &#125; ]&#125;);// æ³¨å†Œå…¨å±€çš„è·¯ç”±å‰ç½®å®ˆå«router.beforeEach((to, from, next) =&gt; &#123; // ä¸€ä¸ªè·¯ç”±åŒ¹é…åˆ°çš„æ‰€æœ‰è·¯ç”±è®°å½•ä¼šæš´éœ²ä¸º $route å¯¹è±¡çš„ $route.matched æ•°ç»„ // éå†$route.matchedæ•°ç»„ï¼Œæ£€æŸ¥metaå­—æ®µ if (to.matched.some(record =&gt; record.meta.requiresAuth)) &#123; // this route requires auth, check if logged in // if not, redirect to login page. // æœªç™»å½•ï¼Œåˆ™è·³è½¬ç™»å½•ï¼Œå¹¶é™„å¸¦ä¸€ä¸ªè¿”å›çš„url if (!auth.loggedIn()) &#123; next(&#123; path: '/login', // ä¼ é€’ç»™ç™»å½•é¡µé¢ä¸€ä¸ªè¿”å›çš„urlåœ°å€ query: &#123; redirect: to.fullPath &#125; &#125;) &#125; else &#123; next() &#125; &#125; else &#123; next() // ç¡®ä¿ä¸€å®šè¦è°ƒç”¨ next() &#125;&#125;) è·¯ç”±è¿‡æ¸¡æ•ˆæœ 12345678910111213141516171819202122232425262728293031323334353637383940414243// æ‰€æœ‰è·¯ç”±è®¾ç½®ä¸€æ ·çš„è¿‡æ¸¡æ•ˆæœ&lt;transition&gt; &lt;router-view&gt;&lt;/router-view&gt;&lt;/transition&gt;// é…åˆkeep-alive&lt;transition&gt; &lt;keep-alive&gt; &lt;router-view&gt;&lt;/router-view&gt; &lt;/keep-alive&gt;&lt;/transition&gt;// å•ä¸ªè·¯ç”±è®¾ç½®è¿‡åº¦æ•ˆæœconst Foo = &#123; template: ` &lt;transition name="slide"&gt; &lt;div class="foo"&gt;...&lt;/div&gt; &lt;/transition&gt; `&#125;const Bar = &#123; template: ` &lt;transition name="fade"&gt; &lt;div class="bar"&gt;...&lt;/div&gt; &lt;/transition&gt; `&#125;// åŠ¨æ€è¿‡æ¸¡(è¿›å…¥ç”¨ä¸€ä¸ªæ•ˆæœï¼Œé€€å‡ºç”¨å¦ä¸€ä¸ªæ•ˆæœ)&lt;!-- ä½¿ç”¨åŠ¨æ€çš„ transition name --&gt;&lt;transition :name="transitionName"&gt; &lt;router-view&gt;&lt;/router-view&gt;&lt;/transition&gt;// æ¥ç€åœ¨çˆ¶ç»„ä»¶å†…// watch $route å†³å®šä½¿ç”¨å“ªç§è¿‡æ¸¡watch: &#123; '$route' (to, from) &#123; const toDepth = to.path.split('/').length const fromDepth = from.path.split('/').length this.transitionName = toDepth &lt; fromDepth ? 'slide-right' : 'slide-left' &#125;&#125; æ•°æ®è·å– 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849// å¯¼èˆªå®Œæˆåï¼Œåœ¨createdä¸­è·å–æ•°æ®export default &#123; data () &#123; return &#123; loading: false, post: null, error: null &#125; &#125;, created () &#123; // ç»„ä»¶åˆ›å»ºå®Œåè·å–æ•°æ®ï¼Œ // æ­¤æ—¶ data å·²ç»è¢« observed äº† this.fetchData() &#125;&#125;// å¯¼èˆªè¿›å…¥å‰è·å–æ•°æ®export default &#123; data () &#123; return &#123; post: null, error: null &#125; &#125;, beforeRouteEnter (to, from, next) &#123; getPost(to.params.id, (err, post) =&gt; &#123; next(vm =&gt; vm.setData(err, post)) &#125;) &#125;, // è·¯ç”±æ”¹å˜å‰ï¼Œç»„ä»¶å°±å·²ç»æ¸²æŸ“å®Œäº† // é€»è¾‘ç¨ç¨ä¸åŒ beforeRouteUpdate (to, from, next) &#123; this.post = null getPost(to.params.id, (err, post) =&gt; &#123; this.setData(err, post) next() &#125;) &#125;, methods: &#123; setData (err, post) &#123; if (err) &#123; this.error = err.toString() &#125; else &#123; this.post = post &#125; &#125; &#125;&#125; è®°å½•ä¸Šæ¬¡æ»šåŠ¨ä½ç½® 12345678910111213141516171819202122232425262728const router = new VueRouter(&#123; routes: [...], scrollBehavior (to, from, savedPosition) &#123; // return æœŸæœ›æ»šåŠ¨åˆ°å“ªä¸ªçš„ä½ç½® &#125;&#125;)const router = new VueRouter(&#123; routes: [...], scrollBehavior (to, from, savedPosition) &#123; // å¦‚æœsavedPositionï¼Œå­˜åœ¨åˆ™æ»šåŠ¨åˆ°ç‰¹å®šä½ç½®ï¼Œå¦åˆ™æ»šåŠ¨åˆ°é¡¶éƒ¨ if (savedPosition) &#123; return savedPosition &#125; else &#123; return &#123; x: 0, y: 0 &#125; &#125; &#125;&#125;)// å¦‚æœä½ è¦æ¨¡æ‹Ÿã€æ»šåŠ¨åˆ°é”šç‚¹ã€çš„è¡Œä¸ºscrollBehavior (to, from, savedPosition) &#123; if (to.hash) &#123; return &#123; selector: to.hash &#125; &#125;&#125; è·¯ç”±æ‡’åŠ è½½ è·¯ç”±è¢«è®¿é—®æ—¶ï¼Œæ‰åŠ è½½å¯¹åº”çš„ç»„ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101import Vue from 'vue'import Router from 'vue-router'Vue.use(Router)const Recommend = (resolve) =&gt; &#123; import('components/recommend/recommend').then((module) =&gt; &#123; resolve(module) &#125;)&#125;const Singer = (resolve) =&gt; &#123; import('components/singer/singer').then((module) =&gt; &#123; resolve(module) &#125;)&#125;const Rank = (resolve) =&gt; &#123; import('components/rank/rank').then((module) =&gt; &#123; resolve(module) &#125;)&#125;const Search = (resolve) =&gt; &#123; import('components/search/search').then((module) =&gt; &#123; resolve(module) &#125;)&#125;const SingerDetail = (resolve) =&gt; &#123; import('components/singer-detail/singer-detail').then((module) =&gt; &#123; resolve(module) &#125;)&#125;const Disc = (resolve) =&gt; &#123; import('components/disc/disc').then((module) =&gt; &#123; resolve(module) &#125;)&#125;const TopList = (resolve) =&gt; &#123; import('components/top-list/top-list').then((module) =&gt; &#123; resolve(module) &#125;)&#125;const UserCenter = (resolve) =&gt; &#123; import('components/user-center/user-center').then((module) =&gt; &#123; resolve(module) &#125;)&#125;export default new Router(&#123; routes: [&#123; path: '/', redirect: '/recommend' &#125;, &#123; path: '/recommend', name: 'Recommend', component: Recommend, children: [&#123; path: ':id', name: 'Disc', component: Disc &#125;] &#125;, &#123; path: '/singer', name: 'Singer', component: Singer, children: [&#123; path: ':id', name: 'SingerDetail', component: SingerDetail &#125;] &#125;, &#123; path: '/rank', name: 'Rank', component: Rank, children:[&#123; path:':id', name: 'TopList', component:TopList &#125;] &#125;, &#123; path: '/search', name: 'Search', component: Search, children: [&#123; path: ':id', name: 'SingerDetail', component: SingerDetail &#125;] &#125;,&#123; path:'/user', name:'User', component:UserCenter &#125; ]&#125;) router-link é»˜è®¤è¢«æ¸²æŸ“ä¸ºaæ ‡ç­¾ æ¿€æ´»æ—¶ï¼Œä¼šè‡ªåŠ¨åŠ ä¸Šrouter-link-activeæ ·å¼ç±»12345678910111213141516171819&lt;!-- å­—ç¬¦ä¸² --&gt;&lt;router-link to="home"&gt;Home&lt;/router-link&gt;&lt;!-- æ¸²æŸ“ç»“æœ --&gt;&lt;a href="home"&gt;Home&lt;/a&gt; &lt;!-- ä½¿ç”¨ v-bind çš„ JS è¡¨è¾¾å¼ --&gt;&lt;router-link v-bind:to="'home'"&gt;Home&lt;/router-link&gt; &lt;!-- ä¸å†™ v-bind ä¹Ÿå¯ä»¥ï¼Œå°±åƒç»‘å®šåˆ«çš„å±æ€§ä¸€æ · --&gt;&lt;router-link :to="'home'"&gt;Home&lt;/router-link&gt; &lt;!-- åŒä¸Š --&gt;&lt;router-link :to="&#123; path: 'home' &#125;"&gt;Home&lt;/router-link&gt; &lt;!-- å‘½åçš„è·¯ç”± --&gt;&lt;router-link :to="&#123; name: 'user', params: &#123; userId: 123 &#125;&#125;"&gt;User&lt;/router-link&gt; &lt;!-- å¸¦æŸ¥è¯¢å‚æ•°ï¼Œä¸‹é¢çš„ç»“æœä¸º /register?plan=private --&gt;&lt;router-link :to="&#123; path: 'register', query: &#123; plan: 'private' &#125;&#125;"&gt;Register&lt;/router-link&gt; router-view å¯ä»¥é€šè¿‡nameå®šä¹‰å‘½åè§†å›¾ é…åˆkeep-aliveã€transition12345&lt;transition&gt; &lt;keep-alive&gt; &lt;router-view&gt;&lt;/router-view&gt; &lt;/keep-alive&gt;&lt;/transition&gt; çŠ¶æ€ç®¡ç†ç±» Flux çŠ¶æ€ç®¡ç†çš„å®˜æ–¹å®ç° ç”±äºå¤šä¸ªçŠ¶æ€åˆ†æ•£çš„è·¨è¶Šåœ¨è®¸å¤šç»„ä»¶å’Œäº¤äº’é—´å„ä¸ªè§’è½ï¼Œå¤§å‹åº”ç”¨å¤æ‚åº¦ä¹Ÿç»å¸¸é€æ¸å¢é•¿ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒVue æä¾› vuexï¼š æˆ‘ä»¬æœ‰å—åˆ° Elm å¯å‘çš„çŠ¶æ€ç®¡ç†åº“ ç®€å•çŠ¶æ€ç®¡ç†èµ·æ­¥ä½¿ç”¨ Vue åº”ç”¨ä¸­åŸå§‹æ•°æ®å¯¹è±¡çš„å®é™…æ¥æº - å½“è®¿é—®æ•°æ®å¯¹è±¡æ—¶ï¼Œä¸€ä¸ª Vue å®ä¾‹åªæ˜¯ç®€å•çš„ä»£ç†è®¿é—®ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ æœ‰ä¸€å¤„éœ€è¦è¢«å¤šä¸ªå®ä¾‹é—´å…±äº«çš„çŠ¶æ€ï¼Œå¯ä»¥ç®€å•åœ°é€šè¿‡ç»´æŠ¤ä¸€ä»½æ•°æ®æ¥å®ç°å…±äº« 1234567const sourceOfTruth = &#123;&#125;const vmA = new Vue(&#123; data: sourceOfTruth&#125;)const vmB = new Vue(&#123; data: sourceOfTruth&#125;) ç°åœ¨å½“ sourceOfTruth å‘ç”Ÿå˜åŒ–ï¼ŒvmA å’Œ vmB éƒ½å°†è‡ªåŠ¨çš„æ›´æ–°å¼•ç”¨å®ƒä»¬çš„è§†å›¾ã€‚å­ç»„ä»¶ä»¬çš„æ¯ä¸ªå®ä¾‹ä¹Ÿä¼šé€šè¿‡ this.$root.$data å»è®¿é—®ã€‚ç°åœ¨æˆ‘ä»¬æœ‰äº†å”¯ä¸€çš„å®é™…æ¥æºï¼Œä½†æ˜¯ï¼Œè°ƒè¯•å°†ä¼šå˜ä¸ºå™©æ¢¦ã€‚ä»»ä½•æ—¶é—´ï¼Œæˆ‘ä»¬åº”ç”¨ä¸­çš„ä»»ä½•éƒ¨åˆ†ï¼Œåœ¨ä»»ä½•æ•°æ®æ”¹å˜åï¼Œéƒ½ä¸ä¼šç•™ä¸‹å˜æ›´è¿‡çš„è®°å½• ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é‡‡ç”¨ä¸€ä¸ªç®€å•çš„ store æ¨¡å¼ï¼š 1234567891011121314var store = &#123; debug: true, state: &#123; message: &apos;Hello!&apos; &#125;, setMessageAction (newValue) &#123; if (this.debug) console.log(&apos;setMessageAction triggered with&apos;, newValue) this.state.message = newValue &#125;, clearMessageAction () &#123; if (this.debug) console.log(&apos;clearMessageAction triggered&apos;) this.state.message = &apos;&apos; &#125;&#125; æ‰€æœ‰ store ä¸­ state çš„æ”¹å˜ï¼Œéƒ½æ”¾ç½®åœ¨ store è‡ªèº«çš„ action ä¸­å»ç®¡ç†,è¿™ç§é›†ä¸­å¼çŠ¶æ€ç®¡ç†èƒ½å¤Ÿè¢«æ›´å®¹æ˜“åœ°ç†è§£å“ªç§ç±»å‹çš„ mutation å°†ä¼šå‘ç”Ÿï¼Œä»¥åŠå®ƒä»¬æ˜¯å¦‚ä½•è¢«è§¦å‘ã€‚å½“é”™è¯¯å‡ºç°æ—¶ï¼Œæˆ‘ä»¬ç°åœ¨ä¹Ÿä¼šæœ‰ä¸€ä¸ª log è®°å½• bug ä¹‹å‰å‘ç”Ÿäº†ä»€ä¹ˆ æ­¤å¤–ï¼Œæ¯ä¸ªå®ä¾‹/ç»„ä»¶ä»ç„¶å¯ä»¥æ‹¥æœ‰å’Œç®¡ç†è‡ªå·±çš„ç§æœ‰çŠ¶æ€ï¼š123456789101112var vmA = new Vue(&#123; data: &#123; privateState: &#123;&#125;, sharedState: store.state &#125;&#125;)var vmB = new Vue(&#123; data: &#123; privateState: &#123;&#125;, sharedState: store.state &#125;&#125;) é‡è¦çš„æ˜¯ï¼Œæ³¨æ„ä½ ä¸åº”è¯¥åœ¨ action ä¸­ æ›¿æ¢åŸå§‹çš„çŠ¶æ€å¯¹è±¡ - ç»„ä»¶å’Œ store éœ€è¦å¼•ç”¨åŒä¸€ä¸ªå…±äº«å¯¹è±¡ï¼Œmutation æ‰èƒ½å¤Ÿè¢«è§‚å¯Ÿ æ¥ç€æˆ‘ä»¬ç»§ç»­å»¶ä¼¸çº¦å®šï¼Œç»„ä»¶ä¸å…è®¸ç›´æ¥ä¿®æ”¹å±äº store å®ä¾‹çš„ stateï¼Œè€Œåº”æ‰§è¡Œ action æ¥åˆ†å‘ (dispatch) äº‹ä»¶é€šçŸ¥ store å»æ”¹å˜ï¼Œæˆ‘ä»¬æœ€ç»ˆè¾¾æˆäº† Flux æ¶æ„ è¿™æ ·çº¦å®šçš„å¥½å¤„æ˜¯ï¼Œæˆ‘ä»¬èƒ½å¤Ÿè®°å½•æ‰€æœ‰ store ä¸­å‘ç”Ÿçš„ state æ”¹å˜ï¼ŒåŒæ—¶å®ç°èƒ½åšåˆ°è®°å½•å˜æ›´ (mutation) ã€ä¿å­˜çŠ¶æ€å¿«ç…§ã€å†å²å›æ»š/æ—¶å…‰æ—…è¡Œçš„å…ˆè¿›çš„è°ƒè¯•å·¥å…· vuex1234567891011121314151617181920const store = new Vuex.Store(&#123; state: &#123; // éœ€è¦å…¨å±€å…±äº«çš„æ•°æ® count: 1 &#125;, mutations: &#123; // æ³¨å†Œä¸€ä¸ªincrement mutations increment (state,payload) &#123; // å˜æ›´çŠ¶æ€ state.count += payload.amount &#125; &#125;, actions: &#123; incrementAsync (context,payload) &#123; setTimeout(() =&gt; &#123; context.commit('increment') &#125;, 1000) &#125; &#125;&#125;) states éœ€è¦å…¨å±€å…±äº«çš„åŸºç¡€æ•°æ®ï¼Œæ´¾ç”Ÿæ•°æ®(è®¡ç®—æ•°æ®)å¯ä»¥é€šè¿‡ç¼–å†™gettersæ¥å®ç° getters ç±»ä¼¼è®¡ç®—å±æ€§ï¼Œå¯ä»¥ç”¨æ¥è®¿é—®åŸºäºstateæ´¾ç”Ÿå‡ºçš„ä¸€äº›stateï¼Œä¸»è¦ç”¨æ¥è®¿é—®states mutations å¾ˆç±»ä¼¼äº‹ä»¶ï¼Œåªèƒ½é€šè¿‡æäº¤mutationsæ¥æ”¹å˜state(æ–¹ä¾¿å¼€å‘å·¥å…·è·Ÿè¸ª)ï¼Œä¸»è¦ç”¨æ¥è®¾ç½®states æäº¤mutaionsæ˜¯æ”¹å˜stateçš„å”¯ä¸€æ–¹å¼ åªèƒ½æ˜¯åŒæ­¥ä»»åŠ¡ï¼Œå¼‚æ­¥ä»»åŠ¡éœ€è¦actionsæ¥å®Œæˆ æ¯ä¸€ä¸ªmutationï¼Œstoreä¼šä¼ å…¥stateå’Œå¯é€‰çš„payload commit ç”¨æ¥æäº¤mutaions å¯ä»¥ä¼ é€’é¢å¤–çš„å‚æ•°payloadç»™mutaions123store.commit('increment', &#123; amount: 10&#125;) actions ä¸»è¦ç”¨æ¥å®Œæˆå¼‚æ­¥ä»»åŠ¡;éœ€è¦è¯·æ±‚åå°çš„ä»»åŠ¡å…¨éƒ¨æ”¾åœ¨actionsä¸­ actionä¸ä¼šç›´æ¥å˜æ›´çŠ¶æ€ï¼Œè€Œæ˜¯é€šè¿‡æäº¤mutationæ¥æ”¹å˜stateï¼Œ æ¯ä¸ªactionï¼Œstoreä¼šä¼ å…¥ä¸€ä¸ªcontextå’Œå¯é€‰çš„payloadï¼ŒcontextåŒ…å«storeå®ä¾‹çš„æ‰€æœ‰æ–¹æ³•å’Œå±æ€§ã€‚å› æ­¤ä½ å¯ä»¥è°ƒç”¨ context.commit æäº¤ä¸€ä¸ª mutationï¼Œæˆ–è€…é€šè¿‡ context.state å’Œ context.getters æ¥è·å– state å’Œ getters dispatch ç”¨æ¥åˆ†å‘(æäº¤)action å¯ä»¥ä¼ é€’é¢å¤–çš„å‚æ•°(payload)ç»™actions123store.dispatch('incrementAsync', &#123; amount: 10&#125;) è¾…åŠ©å‡½æ•° 123456789101112131415161718192021222324252627282930313233343536// mapStateã€mapGettersã€mapMutationsã€mapActionsï¼Œéƒ½æ˜¯è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨æ‰©å±•é¢„ç®—ç¬¦è§£æå‡ºæ¥new Vue(&#123; el:'#app', store, computed: &#123; localComputed () &#123;&#125;, // ä½¿ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦å°†æ­¤å¯¹è±¡æ··å…¥åˆ°å¤–éƒ¨å¯¹è±¡ä¸­ ...mapState([ count,// å°†this.count æ˜ å°„ä¸º store.state.count ]), ...mapGetters([ 'doneTodosCount',// å°†this.doneTodosCount æ˜ å°„ä¸º store.getters.doneTodosCount 'anotherGetter',// å°†this.anotherGetter æ˜ å°„ä¸º store.getters.anotherGetter ]) &#125;, methods: &#123; ...mapMutations([ 'increment', // å°† `this.increment()` æ˜ å°„ä¸º `this.$store.commit('increment')` // `mapMutations` ä¹Ÿæ”¯æŒè½½è·ï¼š 'incrementBy' // å°† `this.incrementBy(amount)` æ˜ å°„ä¸º `this.$store.commit('incrementBy', amount)` ]), ...mapMutations(&#123; add: 'increment' // å°† `this.add()` æ˜ å°„ä¸º `this.$store.commit('increment')` &#125;), ...mapActions([ 'increment', // å°† `this.increment()` æ˜ å°„ä¸º `this.$store.dispatch('increment')` // `mapActions` ä¹Ÿæ”¯æŒè½½è·ï¼š 'incrementBy' // å°† `this.incrementBy(amount)` æ˜ å°„ä¸º `this.$store.dispatch('incrementBy', amount)` ]), ...mapActions(&#123; add: 'increment' // å°† `this.add()` æ˜ å°„ä¸º `this.$store.dispatch('increment')` &#125;) &#125;&#125;); å®é™…é¡¹ç›®ç›®å½• 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311|---store/ actions.js // ä¿å­˜æ‰€æœ‰å¼‚æ­¥ä»»åŠ¡ getters.js // ä¿å­˜æ‰€æœ‰getters index.js // å¯¼å…¥stateã€getter...æ¥å®ä¾‹åŒ–vuex mutations-type.js // ä¿å­˜æ‰€æœ‰mutationsç±»å‹ mutations.js // å®é™…çš„mutationå‡½æ•° state.js // æ‰€æœ‰éœ€è¦å…±äº«çš„æ•°æ®// state.js// é¦–å…ˆç¡®å®šå“ªäº›æ•°æ®éœ€è¦vuexæ¥ç®¡ç†ï¼Œå¹¶ç»™å®šé»˜è®¤å€¼import &#123;playMode&#125; from 'common/js/config'import &#123;loadSearch,loadPlay,loadFavorite&#125; from 'common/js/cache'const state = &#123; singer: &#123;&#125;, playing: false, fullScreen: false, playlist: [], sequenceList: [], mode: playMode.sequence, currentIndex: -1, disc:&#123;&#125;, topList:&#123;&#125;, searchHistory:loadSearch(), playHistory:loadPlay(), favoriteList:loadFavorite(),&#125;;export default state;// å¯¼å‡ºstateå¯¹è±¡// mutation-types.js// ç¡®å®šé’ˆå¯¹stateçš„ä¿®æ”¹export const SET_SINGER = 'SET_SINGER'export const SET_PLAYING_STATE = 'SET_PLAYING_STATE'export const SET_FULL_SCREEN = 'SET_FULL_SCREEN'export const SET_PLAYLIST = 'SET_PLAYLIST'export const SET_SEQUENCE_LIST = 'SET_SEQUENCE_LIST'export const SET_PLAY_MODE = 'SET_PLAY_MODE'export const SET_CURRENT_INDEX = 'SET_CURRENT_INDEX'export const SET_DISC = 'SET_DISC'export const SET_TOP_LIST = 'SET_TOP_LIST'export const SET_SEARCH_HISTORY = 'SET_SEARCH_HISTORY'export const SET_PLAY_HISTORY = 'SET_PLAY_HISTORY'export const SET_FAVORITE_LIST = 'SET_FAVORITE_LIST'// mutations.js// æ ¹æ®mutaion-typesç¼–å†™å…·ä½“çš„mutationæ¥è®¾ç½®stateimport * as types from './mutation-types'const mutations = &#123; [types.SET_SINGER](state, singer) &#123; state.singer = singer &#125;, [types.SET_PLAYING_STATE](state, flag) &#123; state.playing = flag &#125;, [types.SET_FULL_SCREEN](state, flag) &#123; state.fullScreen = flag &#125;, [types.SET_PLAYLIST](state, list) &#123; state.playlist = list &#125;, [types.SET_SEQUENCE_LIST](state, list) &#123; state.sequenceList = list &#125;, [types.SET_PLAY_MODE](state, mode) &#123; state.mode = mode &#125;, [types.SET_CURRENT_INDEX](state, index) &#123; state.currentIndex = index &#125;, [types.SET_DISC](state, disc) &#123; state.disc = disc &#125;, [types.SET_TOP_LIST](state, topList) &#123; state.topList = topList &#125;, [types.SET_SEARCH_HISTORY](state, history) &#123; state.searchHistory = history &#125;, [types.SET_PLAY_HISTORY](state, history) &#123; state.playHistory = history &#125;, [types.SET_FAVORITE_LIST](state, list) &#123; state.favoriteList = list &#125;,&#125;export default mutations; // å¯¼å‡ºmutationså¯¹è±¡// getters.js// ç¼–å†™getteræ¥è¯»å–stateexport const singer = state =&gt; state.singerexport const playing = state=&gt;state.playingexport const fullScreen = state=&gt;state.fullScreenexport const playlist = state=&gt;state.playlistexport const sequenceList = state=&gt;state.sequenceListexport const mode = state=&gt;state.modeexport const currentIndex = state=&gt;state.currentIndexexport const currentSong = (state)=&gt; &#123; return state.playlist[state.currentIndex] || &#123;&#125;;&#125;export const disc = state=&gt;state.discexport const topList = state=&gt;state.topListexport const searchHistory = state=&gt;state.searchHistoryexport const playHistory = state=&gt;state.playHistoryexport const favoriteList = state=&gt;state.favoriteList// actions.js// å¼‚æ­¥æ“ä½œimport * as types from './mutation-types'import &#123; playMode &#125; from 'common/js/config'import &#123; shuffle &#125; from 'common/js/util'import &#123; saveSearch, deleteSearch, clearSearch, savePlay, saveFavorite, deleteFavorite &#125; from 'common/js/cache'function findIndex(list, song) &#123; return list.findIndex((item) =&gt; &#123; return item.id === song.id; &#125;)&#125;export const selectPlay = function(&#123; commit, state &#125;, &#123; list, index &#125;) &#123; commit(types.SET_SEQUENCE_LIST, list); if (state.mode === playMode.random) &#123; let randomList = shuffle(list); commit(types.SET_PLAYLIST, randomList); index = findIndex(randomList, list[index]); &#125; else &#123; commit(types.SET_PLAYLIST, list); &#125; commit(types.SET_CURRENT_INDEX, index); commit(types.SET_FULL_SCREEN, true); commit(types.SET_PLAYING_STATE, true);&#125;;export const randomPlay = function(&#123; commit &#125;, &#123; list &#125;) &#123; commit(types.SET_PLAY_MODE, playMode.random); commit(types.SET_SEQUENCE_LIST, list); let randomList = shuffle(list); commit(types.SET_PLAYLIST, randomList); commit(types.SET_CURRENT_INDEX, 0); commit(types.SET_FULL_SCREEN, true); commit(types.SET_PLAYING_STATE, true);&#125;;export const insertSong = function(&#123; commit, state &#125;, song) &#123; let playlist = state.playlist.slice(); let sequenceList = state.sequenceList.slice(); let currentIndex = state.currentIndex; // è®°å½•å½“å‰æ­Œæ›² let currentSong = playlist[currentIndex]; // ä¿®æ”¹playlist // æŸ¥è¯¢å½“å‰åˆ—è¡¨ä¸­æ˜¯å¦æœ‰å¾…æ’å…¥çš„æ­Œæ›²å¹¶è¿”å›å…¶ç´¢å¼• let fpIndex = findIndex(playlist, song); // å› ä¸ºæ˜¯æ’å…¥æ­Œæ›²ï¼Œæ‰€ä»¥ç´¢å¼•è¦+1 currentIndex++; // æ’å…¥è¿™é¦–æ­Œå½“å½“å‰ç´¢å¼•ä½ç½® playlist.splice(currentIndex, 0, song); // å¦‚æœå·²ç»åŒ…å«è¿™é¦–æ­Œæ›² if (fpIndex &gt; -1) &#123; // å¦‚æœå½“å‰æ’å…¥çš„ç´¢å¼•å¤§äºåˆ—è¡¨ä¸­çš„åºå· if (currentIndex &gt; fpIndex) &#123; playlist.splice(fpIndex, 1); currentIndex--; &#125; else &#123; playlist.splice(fpIndex + 1, 1); &#125; &#125; // ä¿®æ”¹sequenceList let currentSIndex = findIndex(sequenceList, currentSong) + 1; let fsIndex = findIndex(sequenceList, song); sequenceList.splice(currentSIndex, 0, song); if (fsIndex &gt; -1) &#123; if (currentSIndex &gt; fsIndex) &#123; sequenceList.splice(fsIndex, 1); &#125; else &#123; sequenceList.splice(fsIndex + 1, 1); &#125; &#125; commit(types.SET_PLAYLIST, playlist); commit(types.SET_SEQUENCE_LIST, sequenceList); commit(types.SET_CURRENT_INDEX, currentIndex); commit(types.SET_FULL_SCREEN, true); commit(types.SET_PLAYING_STATE, true);&#125;;export const saveSearchHistory = function(&#123; commit &#125;, query) &#123; commit(types.SET_SEARCH_HISTORY, saveSearch(query));&#125;;export const deleteSearchHistory = function(&#123; commit &#125;, query) &#123; commit(types.SET_SEARCH_HISTORY, deleteSearch(query));&#125;;export const clearSearchHistory = function(&#123; commit &#125;) &#123; commit(types.SET_SEARCH_HISTORY, clearSearch());&#125;;export const deleteSong = function(&#123; commit, state &#125;, song) &#123; let playlist = state.playlist.slice() let sequenceList = state.sequenceList.slice() let currentIndex = state.currentIndex let pIndex = findIndex(playlist, song) playlist.splice(pIndex, 1) let sIndex = findIndex(sequenceList, song) sequenceList.splice(sIndex, 1) if (currentIndex &gt; pIndex || currentIndex === playlist.length) &#123; currentIndex-- &#125; commit(types.SET_PLAYLIST, playlist) commit(types.SET_SEQUENCE_LIST, sequenceList) commit(types.SET_CURRENT_INDEX, currentIndex) if (!playlist.length) &#123; commit(types.SET_PLAYING_STATE, false) &#125; else &#123; commit(types.SET_PLAYING_STATE, true) &#125;&#125;export const deleteSongList = function(&#123; commit &#125;) &#123; commit(types.SET_CURRENT_INDEX, -1) commit(types.SET_PLAYLIST, []) commit(types.SET_SEQUENCE_LIST, []) commit(types.SET_PLAYING_STATE, false)&#125;export const savePlayHistory = function(&#123; commit &#125;, song) &#123; commit(types.SET_PLAY_HISTORY, savePlay(song))&#125;export const saveFavoriteList = function(&#123; commit &#125;, song) &#123; commit(types.SET_FAVORITE_LIST, saveFavorite(song))&#125;export const deleteFavoriteList = function(&#123; commit &#125;, song) &#123; commit(types.SET_FAVORITE_LIST, deleteFavorite(song))&#125;// index.js// å…¥å£æ–‡ä»¶ï¼Œå®ä¾‹åŒ–vueximport Vue from 'vue'import Vuex from 'vuex'import * as actions from './actions'import * as getters from './getters'import state from './state'import mutations from './mutations'import createLogger from 'vuex/dist/logger';// è°ƒè¯•å·¥å…·ï¼Œå¯ä»¥æ‰“å°å‡ºlogVue.use(Vuex);// vuexæ˜¯ä¸ªæ’ä»¶ï¼Œéœ€è¦useconst debug = process.env.NODE_ENV !== 'production';// å¯¼å‡ºä¸€ä¸ªstoreå®ä¾‹ï¼Œä¾›main.jsä½¿ç”¨export default new Vuex.Store(&#123; actions, getters, state, mutations, strict: debug,// strictæ¨¡å¼ä¼šé’ˆå¯¹ä¸é€šè¿‡commitæäº¤mutationæŠ¥é”™ plugins: debug ? [createLogger()] : [],// ä½¿ç”¨æ‰“å°logæ’ä»¶&#125;)// main.js// å¯¼å…¥vuexçš„stroeå®ä¾‹ï¼Œå¹¶æ³¨å…¥åˆ°vueæ ¹ç»„ä»¶ä¸­import store from './store'...new Vue(&#123; el: '#app', router, store,// å¯¼å…¥vuexçš„stroeå®ä¾‹ render: h =&gt; h(App)&#125;); å•å…ƒæµ‹è¯•-&gt;ç”¨åˆ°å†è¡¥æœåŠ¡å™¨ç«¯æ¸²æŸ“-&gt;ç”¨åˆ°å†è¡¥Typescriptæ”¯æŒ-&gt;ç”¨åˆ°å†è¡¥]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[how-does-timer-work]]></title>
    <url>%2F2017%2F07%2F31%2Fhow-does-timer-work%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘çœ‹äº†äº›å…³äºjsä¸­å®šæ—¶å™¨åŸç†è§£æçš„æ–‡ç« ï¼Œæ‰€ä»¥ç‰¹åœ¨æ­¤åšä¸€ä¸ªè®°å½•æœ¬æ–‡å¸¦æœ‰ä¸ªäººç†è§£ï¼Œè‹¥æœ‰é”™è¯¯ï¼Œæœ›æŒ‡æ­£ã€‚ JSä¸­çš„å®šæ—¶å™¨(setTimeout)æ˜¯å¦‚ä½•å·¥ä½œçš„?å®šæ—¶å™¨jsä¸­çš„setTimeoutä¸»è¦ç”¨æ¥å®Œæˆä¸€äº›è¶…æ—¶è°ƒç”¨çš„ä»»åŠ¡ï¼Œå¯ä»¥æŒ‡å®šå‡½æ•°åœ¨æœªæ¥çš„æŸä¸ªæ—¶é—´æ‰§è¡Œã€‚123setTimeout(function()&#123; console.log('hi');&#125;,500); ç†è®ºæƒ…å†µä¸‹ï¼Œâ€™hiâ€™ä¼šåœ¨500msåè¢«æ‰“å°å‡ºæ¥ã€‚ è€ƒè™‘ä¸‹é¢è¿™ç§æƒ…å†µ12345console.log(1);setTimeout(function()&#123; console.log(2);&#125;,1000);console.log(3); æœ€åè¾“å‡ºçš„é¡ºåºæ˜¯1,3,2ï¼Œä½ å¯èƒ½åœ¨æƒ³å› ä¸º2è¢«å»¶è¿Ÿäº†1000msï¼Œæ‰€ä»¥æœ€åè¾“å‡ºçš„ã€‚ å†çœ‹ä¸‹é¢çš„12345console.log(1);setTimeout(function()&#123; console.log(2);&#125;,0);console.log(3); è¿™æ¬¡æˆ‘ä»¬å°†å»¶è¿Ÿçš„æ—¶é—´ä»1000è°ƒæˆäº†0ï¼Œè¿™æ¬¡åº”è¯¥è¾“å‡º1,2,3äº†å§ï¼Œä½†å®é™…ä¸Šæœ€åçš„è¾“å‡ºç»“æœè¿˜æ˜¯1,3,2è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè¦è§£é‡Šæ¸…æ¥šè¿™ä¸ªå°±å¿…é¡»äº†è§£setTimeoutçš„å·¥ä½œåŸç†äº†ã€‚ å·¥ä½œåŸç†jsæ˜¯å•çº¿ç¨‹çš„ï¼Œå®ƒåŒä¸€æ—¶é—´å®ƒåªèƒ½å¹²ä¸€ä»¶äº‹æƒ…ã€‚é‚£ä½ å¯èƒ½ä¼šé—®ä¸ºä»€ä¹ˆä¸å¤šå¼„å‡ ä¸ªçº¿ç¨‹ï¼Œè¿™æ ·å¤šç®¡é½ä¸‹ï¼Œä¸æ˜¯æ‰§è¡Œæ•ˆç‡æ›´é«˜äº†å—ï¼Ÿå½“æ—¶jsçš„ç”¨é€”(äº¤äº’ã€æ“ä½œdom)å†³å®šäº†å®ƒåªèƒ½æ˜¯å•çº¿ç¨‹çš„ï¼Œå¦‚æœå¤šçº¿ç¨‹ï¼Œå°±ä¼šå­˜åœ¨å¤šçº¿ç¨‹åŒæ­¥çš„é—®é¢˜ã€‚æˆ‘åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­åˆ é™¤äº†èŠ‚ç‚¹aï¼Œå¦ä¸€ä¸ªçº¿ç¨‹åœ¨èŠ‚ç‚¹aä¸Šæ·»åŠ äº†ä¸€äº›å†…å®¹ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´å†²çªï¼Œå°†ä¸€ä¸ªç®€å•çš„é—®é¢˜è´Ÿè´£åŒ–äº†ï¼Œæ‰€ä»¥æœ€ç»ˆjsæ˜¯å•çº¿ç¨‹çš„ã€‚ è§£é‡Šä¸‹ä¸‹é¢ä»£ç çš„æ‰§è¡Œè¿‡ç¨‹12345console.log(1);setTimeout(function()&#123; console.log(2);&#125;,1000);console.log(3); é¦–å…ˆjsä¸­å­˜åœ¨ä¸€ä¸ªcallstack(è°ƒç”¨æ ˆ)çš„ä¸œè¥¿ï¼Œå®ƒä¼šå°†å‡½æ•°/æ–¹æ³•å‹å…¥(push)åˆ°æ ˆä¸­ï¼Œå¹¶ä¾æ¬¡å‡ºæ ˆ(pop)æ‰§è¡Œã€‚ é»˜è®¤ä¸Šé¢ä»£ç å¤–å›´æœ‰ä¸ªmainå‡½æ•° mainå…¥æ ˆ console.log(1)å…¥æ ˆ console.log(1)å‡ºæ ˆå¹¶è°ƒç”¨æ‰“å°å‡º1 setTimeoutå…¥æ ˆ å‘ç°setTimeoutæ˜¯ä¸ªå»¶è¿Ÿæ‰§è¡Œï¼Œå‡ºæ ˆæ—¶ï¼Œå°†éœ€è¦å»¶è¿Ÿæ‰§è¡Œçš„å›è°ƒå‡½æ•°äº¤ç»™æµè§ˆå™¨çš„timeræ¨¡å—ï¼Œtimeræ¨¡å—è´Ÿè´£è§‚å¯Ÿå»¶è¿Ÿæ‰§è¡Œçš„å›è°ƒå‡½æ•°æ˜¯å¦åˆ°è¾¾è§¦å‘æ¡ä»¶ï¼Œæ­¤æ—¶call stackä¼šç»§ç»­å°†åé¢çš„æ–¹æ³•å‹å…¥æ ˆä¸­ console.log(3)å…¥æ ˆ console.log(3)å‡ºæ ˆå¹¶è°ƒç”¨æ‰“å°å‡º3 mainå‡ºæ ˆ timeræ¨¡å—è§‚å¯Ÿåˆ°å»¶è¿Ÿæ‰§è¡Œçš„å‡½æ•°åˆ°è¾¾è§¦å‘æ¡ä»¶åï¼Œå°†å»¶è¿Ÿæ‰§è¡Œçš„å›è°ƒå‡½æ•°æ¨å…¥ä»»åŠ¡é˜Ÿåˆ—(task queue)ä¸­ å½“è°ƒç”¨æ ˆå¤„äºç©ºé—²çŠ¶æ€æ—¶ï¼Œå®ƒä¼šå°†ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªä»»åŠ¡å‹å…¥callstackä¸­ï¼Œå¹¶è°ƒç”¨ï¼Œå¹¶ä¸€ç›´é‡å¤è¿™ä¸ªè¿‡ç¨‹ç›´åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºevent loop ä¸Šé¢çš„setTimeoutçš„å»¶è¿Ÿæ˜¯1000ï¼Œä¸º0çš„æ—¶å€™å…¶å®ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡åœ¨timeræ¨¡å—ä¸­ï¼Œå®ƒä¼šç«‹å³åˆ°è¾¾è§¦å‘æ¡ä»¶ï¼Œå¹¶è¢«æ¨å…¥ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…call stackç©ºé—²æ—¶ï¼Œå†å‹å…¥åˆ°call stackä¸­å¹¶è°ƒç”¨ã€‚ ä¸Šé¢æ˜¯å…³äºsetTimeoutå»¶è¿Ÿå‡½æ•°çš„è°ƒç”¨è¿‡ç¨‹ï¼Œå…¶å®jsä¸­çš„äº‹ä»¶ã€ajaxçš„æ‰§è¡Œæµç¨‹ä¹Ÿä¸€æ ·(å…¶å®ä½ ä¼šå‘ç°ä»–ä»¬æœ‰ä¸ªå…±åŒç‚¹ï¼Œéƒ½æœ‰å›è°ƒå‡½æ•°)ã€‚åªä¸è¿‡setTimeoutæœ‰ä¸€ä¸ªå…·ä½“çš„å»¶è¿Ÿæ—¶é—´ï¼Œå»¶è¿Ÿæ—¶é—´åˆ°è¾¾äº†è§¦å‘ã€‚äº‹ä»¶æ˜¯åœ¨ç”¨æˆ·è¿›è¡ŒæŸç§æ“ä½œå(ç‚¹å‡»)ï¼Œç«‹å³å°†å›è°ƒå‡½æ•°æ¨å…¥ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œcall stackç©ºé—²æ—¶å–ç¬¬ä¸€ä¸ªå¹¶æ‰§è¡Œã€‚ajaxåˆ™æ˜¯åœ¨è¿”å›æ•°æ®å(æ»¡è¶³è§¦å‘æ¡ä»¶)ï¼Œå°†å›è°ƒæ¨å…¥ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œcall stackç©ºé—²æ—¶å–ç¬¬ä¸€ä¸ªå¹¶æ‰§è¡Œã€‚ å…¶å®jsçš„ä»»åŠ¡(ä»£ç )å¯ä»¥åˆ†ä¸ºåŒæ­¥ä»»åŠ¡å’Œå¼‚æ­¥ä»»åŠ¡(äº‹ä»¶ã€ajaxã€setTimeout)ï¼Œå¼‚æ­¥ä»»åŠ¡çš„å›è°ƒä¸€å®šæ˜¯åœ¨æ‰€æœ‰åŒæ­¥ä»»åŠ¡éƒ½æ‰§è¡Œå®Œäº†ä»¥åå†è¢«è°ƒç”¨;12345console.log(1);setTimeout(function()&#123; console.log(2);&#125;,0);console.log(3); å¦‚ä¸Šé¢ï¼Œå³ä½¿setTimeoutçš„å»¶è¿Ÿæ—¶é—´ä¸º0ï¼Œå®ƒçš„å›è°ƒå‡½æ•°ä¹Ÿæ²¡æœ‰ç›´æ¥è¢«è°ƒç”¨ï¼Œè€Œæ˜¯ç­‰åˆ°console.log(3)æ‰§è¡Œå®Œï¼Œcall stackä¸ºç©ºæ—¶ï¼Œå†è¢«è°ƒç”¨æ‰§è¡Œçš„ã€‚æ‰€ä»¥setTimeour(fn,0)å¸¸ç”¨æ¥åœ¨æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œåï¼Œå°½å¯èƒ½æ—©çš„æ‰§è¡Œï¼› å†çœ‹ä¸‹é¢çš„ä»£ç 12345var req = new XMLHttpRequest();req.open('GET', url); req.onload = function ()&#123;&#125;; req.onerror = function ()&#123;&#125;; req.send(); å’Œ12345var req = new XMLHttpRequest();req.open('GET', url);req.send();req.onload = function ()&#123;&#125;; req.onerror = function ()&#123;&#125;; äºŒè€…æ•ˆæœä¸€æ ·ã€‚ onloadå’Œonerrorçš„ä½ç½®æ— å…³ç´§è¦ï¼Œä¸ç”¨æ‹…å¿ƒå…ˆsendäº†,loadå’Œerrorä¸ä¼šè§¦å‘ã€‚å› ä¸ºloadå’Œerroräº‹ä»¶éƒ½å±äºå¼‚æ­¥ä»»åŠ¡(äº‹ä»¶)ï¼Œä»–ä»¬çš„å›è°ƒå‡½æ•°ä¸€å®šæ˜¯åœ¨æ‰€æœ‰åŒæ­¥ä»»åŠ¡å®Œæˆåå†è¢«è°ƒç”¨çš„ã€‚ æ€»ç»“ï¼š é€šè¿‡ä¸Šé¢å¯ä»¥å‘ç°ï¼Œjsä¸­çš„å¼‚æ­¥ä»»åŠ¡(äº‹ä»¶ã€ajaxã€setTimeout)ï¼Œæ˜¯éœ€è¦call stackã€æµè§ˆå™¨ä¸­çš„å¯¹åº”æ¨¡å—(DOM Bindingã€networkã€timer)ã€task queueä¸‰è€…é…åˆæ¥å®Œæˆå¼‚æ­¥ä»»åŠ¡ï¼› call stackè´Ÿè´£å‹å…¥å¾…æ‰§è¡Œçš„æ–¹æ³•/å‡½æ•°ï¼Œé‡åˆ°å¼‚æ­¥ä»»åŠ¡æ—¶ï¼Œä¼šå°†å¼‚æ­¥ä»»åŠ¡äº¤ç»™å¯¹åº”æ¨¡å—å¤„ç†ï¼› æµè§ˆå™¨å¯¹åº”æ¨¡å—è´Ÿè´£åˆ¤æ–­å¼‚æ­¥ä»»åŠ¡æ˜¯å¦æ»¡è¶³è§¦å‘æ¡ä»¶ï¼Œè‹¥æ»¡è¶³è§¦å‘æ¡ä»¶ï¼Œåˆ™å°†å¼‚æ­¥ä»»åŠ¡çš„å›è°ƒæ¨å…¥task queueä¸­ task queueè´Ÿè´£ä¿å­˜æ‰€æœ‰å·²ç»æ»¡è¶³è§¦å‘æ¡ä»¶å¯ä»¥å‹å…¥call stackä¸­æ‰§è¡Œçš„å¼‚æ­¥ä»»åŠ¡å›è°ƒã€‚ å½“call stackç©ºé—²æ—¶ï¼Œä¼šå°†task queueä¸­çš„ç¬¬ä¸€ä¸ªå›è°ƒå‹å…¥call stackä¸­å¹¶æ‰§è¡Œï¼Œå¹¶ä¸€ç›´å¾ªç¯è¿™ä¸€è¿‡ç¨‹ç›´åˆ°task queueä¸ºç©ºï¼›-&gt;event loop æ‰€æœ‰å¼‚æ­¥ä»»åŠ¡çš„å›è°ƒä¸€å®šæ˜¯åœ¨æ‰€æœ‰åŒæ­¥ä»»åŠ¡éƒ½æ‰§è¡Œå®Œäº†åå†è¢«è°ƒç”¨ setTimeout(fn,0)æ— è®ºå†™åœ¨å“ªï¼Œå®ƒçš„ä½œç”¨éƒ½æ˜¯åœ¨æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œåï¼Œå°½å¯èƒ½æ—©çš„æ‰§è¡Œfn å‚è€ƒé“¾æ¥ http://www.alloyteam.com/2015/10/turning-to-javascript-series-from-settimeout-said-the-event-loop-model/http://www.ruanyifeng.com/blog/2014/10/event-loop.htmlhttps://vimeo.com/96425312http://latentflip.com/loupe/]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>timer</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[AngularJs-todoMVC]]></title>
    <url>%2F2017%2F07%2F13%2FAngularJs-todoMVC%2F</url>
    <content type="text"><![CDATA[AngularJs-todoMVC æºç è§£é‡Š githubä¸Šçš„todoMVCä»“åº“æ˜¯ä¸€ä¸ªå¸®åŠ©ä½ é€‰æ‹©å‰ç«¯MVCæ¡†æ¶çš„é¡¹ç›®é¡¹ç›®ä¸­åŒ…å«äº†ç»å¤§å¤šæ•°å‰ç«¯MVCæ¡†æ¶å®ç°Todo applicationçš„èŒƒä¾‹ï¼Œè®©ä½ èƒ½æ¯”è¾ƒä¸åŒçš„æ¡†æ¶å®ç°åŒä¸€ä¸ªåº”ç”¨çš„å·®å¼‚ã€‚è¿›è€Œè®©ä½ åšå‡ºæœ€ä½³é€‰æ‹©ã€‚Todo applicationçš„å…·ä½“æ•ˆæœï¼Œå¯ä»¥çœ‹è¿™ä¸ªhttp://todomvc.com/examples/angularjs/#/å¯¹äºæ–°æ‰‹æ¥è¯´ï¼Œæ˜¯ä¸ªå¾ˆä¸é”™çš„å­¦ä¹ èŒƒä¾‹ã€‚æœ¬æ–‡é€‰å–çš„æ˜¯å…¶ä¸­çš„angularJsèŒƒä¾‹ï¼Œå¯¹å…¶åšäº†ç®€å•åˆ†æã€‚åˆ†ææºç å·²ç»ä¸Šä¼ è‡³githubï¼Œhttps://github.com/BryanAdamss/SourceSave/tree/master/TodoMVC/angularjsæºç ä¸‹è½½åï¼Œè¯·åœ¨æœåŠ¡å™¨ä¸­æ‰“å¼€ ç›®å½•ç»“æ„ä¸»è¦æ ¹æ®åŠŸèƒ½ä¸åŒï¼Œæ”¾åœ¨äº†ä¸åŒæ–‡ä»¶å¤¹ä¸­ angularjs/ js/ controllers/ todoCtrl.js-&gt;æœ€ä¸»è¦çš„ä¸€ä¸ªæ§åˆ¶å™¨ directives/ todoEscape.js-&gt;å®ç°æŒ‰ä¸‹escé”®ï¼Œæ¢å¤åˆ°åŸå…ˆç¼–è¾‘çŠ¶æ€çš„æŒ‡ä»¤ todoFocus.js-&gt;å†ç¼–è¾‘inputæ˜¾ç¤ºï¼Œèšç„¦çš„æŒ‡ä»¤ services/ todoStorage.js-&gt;å®ç°æœ¬åœ°localStorge app.js-&gt;å…¥å£æ–‡ä»¶ï¼ŒåŒ…å«äº†è·¯ç”±é…ç½® node_modules/ angular/ angular-resource/ angular-route/ todomvc-app-css/-&gt;é¡µé¢ä¸»è¦æ ·å¼æ–‡ä»¶ todomvc-common/-&gt;ä¸€äº›é€šç”¨çš„cssæ ·å¼å’Œjs helper index.html index.htmlç›¸å…³è¯´æ˜å…¨éƒ¨å†™åœ¨æ³¨é‡Šé‡Œäº† 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798&lt;!DOCTYPE html&gt;&lt;html lang="zh-CN"&gt;&lt;head&gt; &lt;meta charset="utf-8"&gt; &lt;meta name="renderer" content="webkit"&gt; &lt;meta name="keywords" content="æˆ‘æ˜¯å…³é”®å­—"&gt; &lt;meta name="description" content="æˆ‘æ˜¯ç½‘ç«™æè¿°"&gt; &lt;meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"&gt; &lt;meta content="telephone=no,email=no" name="format-detection" /&gt; &lt;meta name="full-screen" content="yes"&gt; &lt;meta name="x5-fullscreen" content="true"&gt; &lt;meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no,minimal-ui" /&gt; &lt;link rel="stylesheet" href="node_modules/todomvc-common/base.css"&gt; &lt;link rel="stylesheet" href="node_modules/todomvc-app-css/index.css"&gt; &lt;title&gt;Angular | TodoMVC&lt;/title&gt; &lt;style&gt; [ng-cloak] &#123; /*é˜²æ­¢é—ªå±*/ display: none; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body ng-app="todomvc"&gt; &lt;ng-view&gt;&lt;/ng-view&gt; &lt;script type="text/ng-template" id="todomvc-index.html"&gt; &lt;!-- æ¨¡æ¿ --&gt; &lt;section id="todoapp"&gt; &lt;header id="header"&gt; &lt;h1&gt;todos&lt;/h1&gt; &lt;!-- formæäº¤æ—¶ï¼Œè§¦å‘addTodo()äº‹ä»¶ --&gt; &lt;form id="todo-form" ng-submit="addTodo()"&gt; &lt;!-- æ–°todoçš„è¾“å…¥æ¡†ï¼Œå€¼ç»‘å®šåˆ°newTodoä¸Šï¼Œæ ¹æ®çŠ¶æ€savingæ¥ç¦ç”¨ --&gt; &lt;input id="new-todo" placeholder="What needs to be done?" ng-model="newTodo" ng-disabled="saving" autofocus&gt; &lt;/form&gt; &lt;/header&gt; &lt;!-- #mainæ ¹æ®todosçš„é•¿åº¦æ¥æ˜¾ç¤ºéšè— --&gt; &lt;section id="main" ng-show="todos.length" ng-cloak&gt; &lt;!-- #toggle-all å¸ƒå°”å€¼ç»‘å®šåˆ°allCheckedä¸Šï¼Œç‚¹å‡»æ—¶è§¦å‘markAll --&gt; &lt;input id="toggle-all" type="checkbox" ng-model="allChecked" ng-click="markAll(allChecked)"&gt; &lt;label for="toggle-all"&gt;Mark all as complete&lt;/label&gt; &lt;ul id="todo-list"&gt; &lt;!-- éå†æ¯ä¸ªtodoï¼Œå¹¶é€šè¿‡statusFilterè¿›è¡Œè¿‡æ»¤ï¼Œé€šè¿‡todo.completedã€editedTodoæ¥åˆ‡æ¢class --&gt; &lt;li ng-repeat="todo in todos | filter:statusFilter track by $index" ng-class="&#123;completed: todo.completed, editing: todo == editedTodo&#125;"&gt; &lt;div class="view"&gt; &lt;!-- todoå‰çš„å¤é€‰æ¡†ï¼Œå€¼ç»‘å®šåˆ°todo.completedï¼Œchangeæ—¶è§¦å‘toggleCompletedäº‹ä»¶ï¼Œå¹¶ä¼ å…¥å¯¹åº”todo --&gt; &lt;input class="toggle" type="checkbox" ng-model="todo.completed" ng-change="toggleCompleted(todo)"&gt; &lt;!-- å±•ç¤ºç”¨labelï¼ŒåŒå‡»æ—¶è§¦å‘editTodoï¼Œå¹¶ä¼ å…¥å¯¹åº”todo --&gt; &lt;label ng-dblclick="editTodo(todo)"&gt;&#123;&#123;todo.title&#125;&#125;&lt;/label&gt; &lt;!-- åˆ é™¤æŒ‰é’®ï¼Œç‚¹å‡»æ—¶ï¼Œç§»é™¤å¯¹åº”todo --&gt; &lt;button class="destroy" ng-click="removeTodo(todo)"&gt;&lt;/button&gt; &lt;/div&gt; &lt;!-- éšè—çš„å†ç¼–è¾‘è¡¨å•ï¼Œåœ¨è¡¨å•æäº¤æ—¶è§¦å‘saveEdits --&gt; &lt;form ng-submit="saveEdits(todo, 'submit')"&gt; &lt;!-- å†ç¼–è¾‘inputï¼Œå€¼ç»‘å®šåˆ°todo.titleå¹¶ä¸å»é™¤å‰åç©ºæ ¼ï¼›æŒ‰ä¸‹escæ—¶è§¦å‘reverEditsäº‹ä»¶ï¼Œæ¢å¤åˆ°ä¹‹å‰çŠ¶æ€ï¼›å¤±å»ç„¦ç‚¹æ—¶è‡ªåŠ¨æäº¤ï¼›å½“åŒå‡»å±•ç¤ºç”¨labelæ—¶ï¼Œtodoå’ŒeditedTodoç›¸ç­‰ï¼Œä¼šè§¦å‘todo-focusæŒ‡ä»¤ï¼Œæ˜¾ç¤ºå†ç¼–è¾‘input--&gt; &lt;input class="edit" ng-trim="false" ng-model="todo.title" todo-escape="revertEdits(todo)" ng-blur="saveEdits(todo, 'blur')" todo-focus="todo == editedTodo"&gt; &lt;/form&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/section&gt; &lt;footer id="footer" ng-show="todos.length" ng-cloak&gt; &lt;!-- #todo-count å±•ç¤ºå‰©ä½™å¾…åštodoæ•°é‡ --&gt; &lt;span id="todo-count"&gt;&lt;strong&gt;&#123;&#123;remainingCount&#125;&#125;&lt;/strong&gt; &lt;!-- å½“countä¸º1æ˜¾ç¤º'item left'ï¼Œå¦åˆ™æ˜¾ç¤º'items left' --&gt; &lt;ng-pluralize count="remainingCount" when="&#123; one: 'item left', other: 'items left' &#125;"&gt;&lt;/ng-pluralize&gt; &lt;/span&gt; &lt;ul id="filters"&gt; &lt;!-- è¿‡æ»¤çŠ¶æ€ï¼Œç‚¹å‡»æ—¶è§¦å‘$routeChangeSuccessäº‹ä»¶ï¼Œæ”¹å˜statusFilterï¼Œè¿›è€Œæ”¹å˜å±•ç¤ºçš„æ•°æ® --&gt; &lt;li&gt; &lt;a ng-class="&#123;selected: status == ''&#125; " href="#/"&gt;All&lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a ng-class="&#123;selected: status == 'active'&#125;" href="#/active"&gt;Active&lt;/a&gt; &lt;/li&gt; &lt;li&gt; &lt;a ng-class="&#123;selected: status == 'completed'&#125;" href="#/completed"&gt;Completed&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;!-- æ¸…é™¤æ‰€æœ‰å·²å®Œæˆtodoï¼Œç‚¹å‡»æ—¶è§¦å‘clearCompletedTodos --&gt; &lt;button id="clear-completed" ng-click="clearCompletedTodos()" ng-show="completedCount"&gt;Clear completed&lt;/button&gt; &lt;/footer&gt; &lt;/section&gt; &lt;/script&gt; &lt;!-- èµ„æºæ–‡ä»¶ --&gt; &lt;script src="node_modules/todomvc-common/base.js"&gt;&lt;/script&gt; &lt;script src="node_modules/angular/angular.js"&gt;&lt;/script&gt; &lt;script src="node_modules/angular-route/angular-route.js"&gt;&lt;/script&gt; &lt;script src="node_modules/angular-resource/angular-resource.js"&gt;&lt;/script&gt; &lt;!-- é€»è¾‘æ–‡ä»¶ --&gt; &lt;script src="js/app.js"&gt;&lt;/script&gt; &lt;script src="js/controllers/todoCtrl.js"&gt;&lt;/script&gt; &lt;script src="js/services/todoStorage.js"&gt;&lt;/script&gt; &lt;script src="js/directives/todoFocus.js"&gt;&lt;/script&gt; &lt;script src="js/directives/todoEscape.js"&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt; app.jsapp.jsæ˜¯å…¥å£æ–‡ä»¶ï¼Œä¸»è¦æ˜¯åˆ›å»ºäº†æ¨¡å—ï¼Œå¹¶é…ç½®äº†è·¯ç”±12345678910111213141516171819202122232425262728293031/*global angular *//** * The main TodoMVC app module * * @type &#123;angular.Module&#125; */angular.module('todomvc', ['ngRoute', 'ngResource']) .config(['$routeProvider', function($routeProvider) &#123; 'use strict'; var routeConfig = &#123; controller: 'TodoCtrl', templateUrl: 'todomvc-index.html', // æŒ‡å®šæ¨¡æ¿ resolve: &#123; store: function(todoStorage) &#123; // åœ¨è·³è½¬è·¯ç”±ä¹‹å‰è½½å…¥æ­£ç¡®çš„module // Get the correct module (API or localStorage). return todoStorage.then(function(module) &#123; module.get(); // Fetch the todo records in the background. return module; &#125;); &#125; &#125; &#125;; // è·¯ç”±è·³è½¬ $routeProvider .when('/', routeConfig) .when('/:status', routeConfig) .otherwise(&#123; redirectTo: '/' &#125;); &#125;]); todoStorage.jsè¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªæœåŠ¡ï¼Œä¸»è¦å®ç°äº†æ•°æ®åœ¨localStorgeä¸­çš„å­˜å‚¨å’Œè¯»å†™å…¶å®è¿™ä¸€å—æ²¡æ€ä¹ˆçœ‹æ‡‚ï¼Œä¸»è¦æ˜¯ä¸å¤ªç†è§£ngResourceæ¨¡å—çš„ä½œç”¨ï¼Œä¸è¿‡å¤§æ¦‚çŸ¥é“æ˜¯å­˜å‚¨å’Œè¯»å–æ•°æ®ç”¨çš„123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165/*global angular *//** * Services that persists and retrieves todos from localStorage or a backend API * if available. * * They both follow the same API, returning promises for all changes to the * model. */// è¿™ä¸€å—æ˜¯æ‡µé€¼çš„...å¤§æ¦‚å°±æ˜¯å°†æ•°æ®å­˜å‚¨åœ¨localStorageä¸­angular.module('todomvc') .factory('todoStorage', function($http, $injector) &#123; 'use strict'; // Detect if an API backend is present. If so, return the API module, else // hand off the localStorage adapter return $http.get('/api') .then(function() &#123; return $injector.get('api'); &#125;, function() &#123; return $injector.get('localStorage'); &#125;); &#125;).factory('api', function($resource) &#123; 'use strict'; var store = &#123; todos: [], api: $resource('/api/todos/:id', null, &#123; update: &#123; method: 'PUT' &#125; &#125;), clearCompleted: function() &#123; var originalTodos = store.todos.slice(0); var incompleteTodos = store.todos.filter(function(todo) &#123; return !todo.completed; &#125;); angular.copy(incompleteTodos, store.todos); return store.api.delete(function() &#123;&#125;, function error() &#123; angular.copy(originalTodos, store.todos); &#125;); &#125;, delete: function(todo) &#123; var originalTodos = store.todos.slice(0); store.todos.splice(store.todos.indexOf(todo), 1); return store.api.delete(&#123; id: todo.id &#125;, function() &#123;&#125;, function error() &#123; angular.copy(originalTodos, store.todos); &#125;); &#125;, get: function() &#123; return store.api.query(function(resp) &#123; angular.copy(resp, store.todos); &#125;); &#125;, insert: function(todo) &#123; var originalTodos = store.todos.slice(0); return store.api.save(todo, function success(resp) &#123; todo.id = resp.id; store.todos.push(todo); &#125;, function error() &#123; angular.copy(originalTodos, store.todos); &#125;) .$promise; &#125;, put: function(todo) &#123; return store.api.update(&#123; id: todo.id &#125;, todo) .$promise; &#125; &#125;; return store;&#125;).factory('localStorage', function($q) &#123; 'use strict'; var STORAGE_ID = 'todos-angularjs'; var store = &#123; todos: [], _getFromLocalStorage: function() &#123; return JSON.parse(localStorage.getItem(STORAGE_ID) || '[]'); &#125;, _saveToLocalStorage: function(todos) &#123; localStorage.setItem(STORAGE_ID, JSON.stringify(todos)); &#125;, clearCompleted: function() &#123; var deferred = $q.defer(); var incompleteTodos = store.todos.filter(function(todo) &#123; return !todo.completed; &#125;); angular.copy(incompleteTodos, store.todos); store._saveToLocalStorage(store.todos); deferred.resolve(store.todos); return deferred.promise; &#125;, delete: function(todo) &#123; var deferred = $q.defer(); store.todos.splice(store.todos.indexOf(todo), 1); store._saveToLocalStorage(store.todos); deferred.resolve(store.todos); return deferred.promise; &#125;, get: function() &#123; var deferred = $q.defer(); angular.copy(store._getFromLocalStorage(), store.todos); deferred.resolve(store.todos); return deferred.promise; &#125;, insert: function(todo) &#123; var deferred = $q.defer(); store.todos.push(todo); store._saveToLocalStorage(store.todos); deferred.resolve(store.todos); return deferred.promise; &#125;, put: function(todo, index) &#123; var deferred = $q.defer(); store.todos[index] = todo; store._saveToLocalStorage(store.todos); deferred.resolve(store.todos); return deferred.promise; &#125; &#125;; return store;&#125;); todoEscape.jsè¿™æ˜¯ä¸€ä¸ªæŒ‡ä»¤ï¼Œä¸»è¦å®ŒæˆæŒ‰ä¸‹escé”®ï¼Œæ¢å¤å†ç¼–è¾‘inputåˆ°åŸå…ˆçŠ¶æ€12345678910111213141516171819202122232425/*global angular *//** * Directive that executes an expression when the element it is applied to gets * an `escape` keydown event. */// escé”®ç»‘å®šäº‹ä»¶// å½“æŒ‰ä¸‹Escapeé”®æ—¶ï¼Œæ‰§è¡Œattrs.todoEscapeçš„è¡¨è¾¾å¼ã€‚angular.module('todomvc') .directive('todoEscape', function() &#123; 'use strict'; var ESCAPE_KEY = 27; return function(scope, elem, attrs) &#123; // ç›´æ¥è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå®é™…ä¸Šå°±æ˜¯linkå‡½æ•°ï¼›åœ¨linkå‡½æ•°ä¸­ç»‘å®šäº‹ä»¶ elem.bind('keydown', function(event) &#123; if (event.keyCode === ESCAPE_KEY) &#123; // æŒ‰ä¸‹escï¼Œè§¦å‘attrs.todoEscapeå¯¹åº”çš„äº‹ä»¶ scope.$apply(attrs.todoEscape); &#125; &#125;); scope.$on('$destroy', function() &#123; // é”€æ¯æ—¶ï¼Œè§£é™¤ç»‘å®š elem.unbind('keydown'); &#125;); &#125;; &#125;); todoFocus.jsè¿™ä¸ªæŒ‡ä»¤ä¸»è¦å®Œæˆå†ç¼–è¾‘inputçš„æ˜¾ç¤ºå’Œèšç„¦1234567891011121314151617181920/*global angular *//** * Directive that places focus on the element it is applied to when the * expression it binds to evaluates to true */angular.module('todomvc') .directive('todoFocus', function todoFocus($timeout) &#123; 'use strict'; return function(scope, elem, attrs) &#123; // åœ¨äºŒæ¬¡ç¼–è¾‘çš„inputä¸Šç»‘å®šäº‹ä»¶ scope.$watch(attrs.todoFocus, function(newVal, oldVal) &#123; // å½“åŒå‡»æ—¶ï¼ŒnewValä¸ºtrue if (newVal) &#123; $timeout(function() &#123; elem[0].focus(); &#125;, 0, false); &#125; &#125;); &#125;; &#125;); todoCtrl.jsè¿™æ˜¯é‡å¤´æ€§ï¼Œå…³é”®æ€§é€»è¾‘å…¨å†™åœ¨è¿™123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126/*global angular *//** * The main controller for the app. The controller: * - retrieves and persists the model via the todoStorage service * - exposes the model to the template and provides event handlers */angular.module('todomvc') .controller('TodoCtrl', function TodoCtrl($scope, $routeParams, $filter, store) &#123; 'use strict'; var todos = $scope.todos = store.todos; // ä»localStorgeä¸­å–å‡ºæ‰€æœ‰todo $scope.newTodo = ''; // ç”¨æ¥ä¿å­˜æ–°åˆ›å»ºçš„todo $scope.editedTodo = null; // ç”¨æ¥ä¿å­˜ç¼–è¾‘è¿‡çš„todo $scope.$watch('todos', function() &#123; // æ·±åº¦è§‚å¯Ÿtodosçš„å€¼ $scope.remainingCount = $filter('filter')(todos, &#123; completed: false &#125;).length; // æ›´æ–°æœªå®Œæˆçš„todoæ•°é‡ $scope.completedCount = todos.length - $scope.remainingCount; // æ›´æ–°å®Œæˆçš„todoæ•°é‡ $scope.allChecked = !$scope.remainingCount; // æ˜¯å¦å…¨éƒ¨å®Œæˆ &#125;, true); // Monitor the current route for changes and adjust the filter accordingly. $scope.$on('$routeChangeSuccess', function() &#123; // è§‚å¯Ÿè·¯ç”±è·³è½¬ï¼Œå¹¶æ›´æ–°ç”¨æ¥è¿‡æ»¤çš„statusFilter var status = $scope.status = $routeParams.status || ''; $scope.statusFilter = (status === 'active') ? &#123; completed: false &#125; : (status === 'completed') ? &#123; completed: true &#125; : &#123;&#125;; &#125;); $scope.addTodo = function() &#123; // è¾“å…¥æ¡†æäº¤æ—¶è§¦å‘ var newTodo = &#123; // åˆ›å»ºæ–°todo title: $scope.newTodo.trim(), //newTodoæ˜¯ç»‘å®šåœ¨inputè¾“å…¥æ¡†ä¸Š completed: false &#125;; if (!newTodo.title) &#123; // ç©ºå€¼ï¼Œåˆ™ä¸æäº¤ return; &#125; $scope.saving = true; // savingç”¨æ¥æ ‡è¯†inputçš„ç¦ç”¨çŠ¶æ€ï¼Œä¸ºtrueåˆ™ç¦ç”¨ store.insert(newTodo) // æ’å…¥æ–°todo .then(function success() &#123; // æˆåŠŸåˆ™é‡ç½®newTodo $scope.newTodo = ''; &#125;) .finally(function() &#123; $scope.saving = false; // æœ€åå–æ¶ˆinputçš„ç¦ç”¨çŠ¶æ€ &#125;); &#125;; $scope.editTodo = function(todo) &#123; // å·²æ·»åŠ çš„todoä¸ŠåŒå‡»æ—¶è§¦å‘ï¼Œä¼šå°†åŒå‡»çš„todoä¼ å…¥ $scope.editedTodo = todo; // ä¿å­˜æ­£åœ¨ç¼–è¾‘çš„todo // Clone the original todo to restore it on demand. $scope.originalTodo = angular.extend(&#123;&#125;, todo); // ä¿ç•™åŸå…ˆçš„todoï¼Œä»¥å¤‡ä¸æ—¶ä¹‹éœ€ &#125;; $scope.saveEdits = function(todo, event) &#123; // å†ç¼–è¾‘inputæäº¤æˆ–è€…bluræ—¶è§¦å‘ // Blur events are automatically triggered after the form submit event. // This does some unfortunate logic handling to prevent saving twice. if (event === 'blur' &amp;&amp; $scope.saveEvent === 'submit') &#123; // æäº¤æ—¶ï¼Œä¼šè‡ªåŠ¨è§¦å‘ä¸€æ¬¡blurï¼Œæ‰€ä»¥æ‰‹åŠ¨é˜»æ­¢ $scope.saveEvent = null; return; &#125; $scope.saveEvent = event; // ä¿å­˜äº‹ä»¶ç±»å‹(bluræˆ–submit) if ($scope.reverted) &#123; // å¦‚æœç¼–è¾‘åæŒ‰escï¼Œå–æ¶ˆäº†ç¼–è¾‘ï¼Œåˆ™ä¸ä¿å­˜ // Todo edits were reverted-- don't save. $scope.reverted = null; return; &#125; todo.title = todo.title.trim(); // ä¿å­˜æ–°ç¼–è¾‘title if (todo.title === $scope.originalTodo.title) &#123; // titleæœªå‘ç”Ÿæ”¹å˜ï¼Œåˆ™ä¸ä¿å­˜ $scope.editedTodo = null; return; &#125; store[todo.title ? 'put' : 'delete'](todo) .then(function success() &#123;&#125;, function error() &#123; // ä¿å­˜å‡ºé”™ï¼Œåˆ™æ¢å¤title todo.title = $scope.originalTodo.title; &#125;) .finally(function() &#123; // æœ€åï¼Œé‡ç½®editedTodo $scope.editedTodo = null; &#125;); &#125;; $scope.revertEdits = function(todo) &#123; // todoEscapeæ—¶è§¦å‘ï¼Œå°†å†ç¼–è¾‘inputæ¢å¤åˆ°ç¼–è¾‘å‰çš„çŠ¶æ€ï¼Œä¼šä¼ å…¥éœ€è¦æ¢å¤çš„todo todos[todos.indexOf(todo)] = $scope.originalTodo; $scope.editedTodo = null; $scope.originalTodo = null; $scope.reverted = true; &#125;; $scope.removeTodo = function(todo) &#123; // åˆ é™¤todo store.delete(todo); &#125;; $scope.saveTodo = function(todo) &#123; // ä¿å­˜todo store.put(todo); &#125;; $scope.toggleCompleted = function(todo, completed) &#123; // åˆ‡æ¢å®ŒæˆçŠ¶æ€ if (angular.isDefined(completed)) &#123; // å¦‚æœcompletedæ›¾ç»å®šä¹‰è¿‡ï¼Œåˆ™ç›´æ¥ä½¿ç”¨ todo.completed = completed; &#125; // æ›´æ–°localStorgeä¸Šçš„todoçš„complete store.put(todo, todos.indexOf(todo)) .then(function success() &#123;&#125;, function error() &#123; // ä¿å­˜å‡ºé”™ï¼Œåˆ™æ¢å¤ todo.completed = !todo.completed; &#125;); &#125;; $scope.clearCompletedTodos = function() &#123; // æ¸…é™¤æ‰€æœ‰å·²ç»å®Œæˆçš„todo store.clearCompleted(); &#125;; $scope.markAll = function(completed) &#123; // å°†æ‰€æœ‰todoç½®ä¸ºå·²å®Œæˆ todos.forEach(function(todo) &#123; if (todo.completed !== completed) &#123; $scope.toggleCompleted(todo, completed); &#125; &#125;); &#125;; &#125;);]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>Angular</tag>
        <tag>todoMVC</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Maintainable-Javascript]]></title>
    <url>%2F2017%2F06%2F30%2FMaintainable-Javascript%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸ºé˜…è¯»ã€Šç¼–å†™å¯ç»´æŠ¤çš„Javascriptã€‹çš„ç¬”è®°ï¼Œè®°å½•äº†ä¸€äº›ä¸ªäººè®¤ä¸ºé‡è¦çš„ç‚¹ï¼Œå¸¦æœ‰ä¸€å®šä¸ªäººç†è§£ï¼Œå¹¶æœªæ·±å…¥å±•å¼€ï¼Œå¦‚éœ€è¯¦ç»†äº†è§£å¯é˜…è¯»åŸä¹¦ç±ã€‚è¿™æœ¬ä¹¦ï¼Œæ˜¯ä»å¯ç»´æŠ¤æ€§çš„è§’åº¦å‡ºå‘ï¼Œä»‹ç»äº†å¦‚ä½•ç¼–å†™å¯ç»´æŠ¤æ€§çš„jsä»£ç ï¼Œè¯»å®Œï¼Œè¿˜æ˜¯æœ‰æ”¶è·çš„ï¼Œç‰¹åˆ«æ˜¯ç¬¬äºŒéƒ¨åˆ†çš„ç¼–ç¨‹å®è·µï¼Œå¾ˆåŸºç¡€ï¼Œä½†ä¹Ÿå¾ˆå®ç”¨ã€‚ç»¼åˆæ¥çœ‹ï¼Œè¿˜æ˜¯ä¸€æœ¬ä¸é”™çš„ä¹¦ç±ï¼Œå€¼å¾—ä¸€çœ‹ã€‚PS:æœ¬ä¹¦ä¸»è¦ä»å¯ç»´æŠ¤æ€§çš„è§’åº¦å‡ºå‘ï¼Œæœ‰äº›å†™æ³•å¹¶ä¸ä¸€å®šæ˜¯æœ€ä¼˜è§£ï¼Œå› äººè€Œå¼‚ï¼Œå–å…¶ç²¾åï¼Œå»å…¶ç³Ÿç²•ã€‚æœ¬äººgithubä¸Šæœ‰å¾ˆå¤šæœ¬äººå­¦ä¹ å‰ç«¯æ—¶ä¿å­˜çš„demoï¼Œéƒ½å¸¦æœ‰æ³¨é‡Šï¼Œé€‚åˆæ–°æ‰‹å…¥é—¨ã€‚å¦‚æœå¯¹å¤§å®¶æœ‰å¸®åŠ©ã€‚æœ›star~https://github.com/BryanAdamss/SourceSave ã€Šç¼–å†™å¯ç»´æŠ¤çš„Javascriptã€‹ç¬”è®°ç¼–ç¨‹é£æ ¼åŸºæœ¬æ ¼å¼åŒ– ä»£ç ç¼©è¿› ä½¿ç”¨4ç©ºæ ¼ä»£æ›¿tabï¼›ä¸åŒç¼–è¾‘å™¨å¯¹äºtabçš„è§£é‡Šä¸ä¸€æ ·ï¼Œæœ‰çš„æ˜¯2ç©ºæ ¼é•¿åº¦ï¼Œæœ‰çš„æ˜¯4ç©ºæ ¼é•¿åº¦ï¼› è¯­å¥ç»“å°¾ æ€»æ˜¯ä½¿ç”¨åˆ†å·;ç»“å°¾ è¡Œçš„é•¿åº¦ å•è¡Œä¸è¶…è¿‡80ä¸ªå­—ç¬¦ ç©ºè¡Œ ä½¿ç”¨ç©ºè¡Œåˆ†éš”è¯­ä¹‰ä¸åŒçš„ä»£ç æ®µ å‘½å é©¼å³°å‘½åæ³• å˜é‡ åè¯å¼€å¤´-&gt;countã€myName å‡½æ•° åŠ¨è¯å¼€å¤´-&gt;(canã€hasã€isã€getã€set)isEnabledã€getName æ„é€ å‡½æ•° é¦–å­—æ¯å¤§å†™123function Person(name)&#123; this.name=name;&#125; å¸¸é‡ å…¨å¤§å†™ï¼Œä¸‹åˆ’çº¿åŒºåˆ†12var MAX_COUNT=10, URL='https://github.com/BryanAdamss/SourceSave'; ç›´æ¥é‡ å­—ç¬¦ä¸²-&gt;å•åŒå¼•å·çš†å¯ï¼Œä¸è¿‡ä¸ªäººæ¨èç”¨å•å¼•å·ï¼Œå› ä¸ºåœ¨æ‹¼æ¥htmlå­—ç¬¦ä¸²æ—¶å¾ˆæ–¹ä¾¿) æ•°å­—-&gt;ä¸çœç•¥å°æ•°ç‚¹å‰åçš„æ•°å­— null-&gt;å½“åšå¯¹è±¡å ä½ç¬¦ä½¿ç”¨ undefined-&gt;å·²å£°æ˜ä½†æ²¡æœ‰èµ‹å€¼çš„å˜é‡ä¼šè·å¾—æ­¤å€¼ å¯¹è±¡ç›´æ¥é‡ 1234567// ä¸å¥½çš„å†™æ³•var book=new Object();book.title='Javascript';// å¥½çš„å†™æ³•var book=&#123; title:'Javascript'&#125;; æ•°ç»„ç›´æ¥é‡ 1234// ä¸å¥½çš„å†™æ³•var colors=new Array('red','green');// å¥½çš„å†™æ³•var colors=['red','green']; æ³¨é‡Š åªåœ¨éœ€è¦æ³¨é‡Šçš„æ—¶å€™æ‰æ·»åŠ æ³¨é‡Š-&gt;åªåœ¨éœ€è¦è®©ä»£ç å˜å¾—æ›´æ¸…æ™°çš„æ—¶å€™æ·»åŠ æ³¨é‡Š é€»è¾‘å¤æ‚éš¾äºç†è§£çš„ä»£ç  å¯èƒ½è¢«è¯¯è®¤ä¸ºé”™è¯¯çš„ä»£ç  è¯­å¥å’Œè¡¨è¾¾å¼ switchè¯­å¥ jsä¸­çš„switchä¸åŒäºå…¶ä»–è¯­è¨€ï¼Œswitchçš„æ¡ä»¶å’Œcaseä»å¥å¯ä»¥æ˜¯ä»»æ„ç±»å‹å€¼ï¼Œå…¶ä»–è¯­è¨€å¿…é¡»æ˜¯åŸå§‹å€¼æˆ–è€…å¸¸é‡ withè¯­å¥-&gt;ä¸è¦ä½¿ç”¨ å¾ªç¯ for-&gt;åœ¨åˆå§‹åŒ–ä¸­ç¼“å­˜éå†æ¬¡æ•° 123for(var i=0,len=arr.length;i&lt;len;i++)&#123; doSth();&#125; for-in-&gt;é…åˆhasOwnPropertyè¿‡æ»¤éå®ä¾‹å±æ€§/æ–¹æ³• 123456for(var prop in testObj)&#123; if(testObj.hasOwnProperty(prop))&#123; console.log('å±æ€§åä¸º:'+prop); console.log('å±æ€§åå¯¹åº”çš„å±æ€§å€¼ä¸º:'+testObj[prop]); &#125;&#125; forEach-&gt;é’ˆå¯¹æ•°ç»„ç”¨forEach æ€»ç»“:å¯¹è±¡(é™¤æ•°ç»„)ç”¨for-inï¼Œæ•°ç»„ç”¨forEachï¼Œå…¶ä»–ç”¨for å˜é‡ã€å‡½æ•°å’Œè¿ç®—ç¬¦ å˜é‡å£°æ˜ å•varå£°æ˜ 123var a=3, b=4, c=5; å°†å±€éƒ¨å˜é‡çš„å®šä¹‰åšä¸ºå‡½æ•°å†…ç¬¬ä¸€æ¡è¯­å¥ 1234567891011121314151617181920 function getName()&#123; var a=3, b=4, c=5; &#125; ``` - å‡½æ•°å£°æ˜ - å…ˆå£°æ˜å†ä½¿ç”¨ - å‡½æ•°å†…å£°æ˜å‡½æ•°æ—¶ï¼Œå¯å°†å‡½æ•°å£°æ˜æ”¾åœ¨å˜é‡ç”Ÿå‘½ä¹‹å ```javascript function getName()&#123; var a=3, b=4, c=5; function getOtherName()&#123; doSth(); &#125; getOtherName(); &#125; ç«‹å³è°ƒç”¨å‡½æ•° ä½¿ç”¨åœ†æ‹¬å·åŒ…è£¹123var a=(function()&#123; doSth();&#125;)(); ä¸¥æ ¼æ¨¡å¼-&gt;åªåœ¨å±€éƒ¨ä½¿ç”¨ ç›¸ç­‰-&gt;ä½¿ç”¨=== eval-&gt;é¿å…ä½¿ç”¨ åŸå§‹åŒ…è£…ç±»å‹-&gt;é¿å…ä½¿ç”¨åŸå§‹åŒ…è£…ç±»å‹æ„é€ å‡½æ•° ç¼–ç¨‹å®è·µUIå±‚çš„æ¾è€¦åˆ å°†javascriptä»cssä¸­æŠ½ç¦» ç¦ç”¨cssè¡¨è¾¾å¼1234/*ä¸å¥½çš„å†™æ³•*/.box&#123; width:expression(document.body.offsetWidth+"px");&#125; å°†cssä»javascriptä¸­æŠ½ç¦» ç”¨jsæ§åˆ¶æ ·å¼ç±»ï¼Œè€Œä¸æ˜¯ç›´æ¥æ“çºµæ ·å¼ å½“éœ€è¦æ§åˆ¶å…ƒç´ ä½ç½®æ—¶ï¼Œå¯ç›´æ¥ç”¨jsæ“çºµæ ·å¼(top,leftâ€¦) å°†javascriptä»HTMLä¸­æŠ½ç¦» ä¸è¦åœ¨htmlæ ‡ç­¾ä¸Šç”¨onclick=â€¦ï¼Œæ”¹ç”¨äº‹ä»¶addEventListener å°†HTMLä»javascriptä¸­æŠ½ç¦» ä½¿ç”¨å®¢æˆ·ç«¯æ¨¡æ¿å¼•æ“ï¼Œä¾‹å¦‚handlebars é¿å…ä½¿ç”¨å…¨å±€å˜é‡ å…¨å±€å˜é‡å¸¦æ¥çš„é—®é¢˜ å‘½åå†²çª ä»£ç è„†å¼±æ€§ éš¾ä»¥æµ‹è¯• æ„å¤–çš„å…¨å±€å˜é‡ æœªå£°æ˜ç›´æ¥èµ‹å€¼äº† 12345function ()&#123; var a=3;// å±€éƒ¨å˜é‡ var b;// å±€éƒ¨å˜é‡ c=3;// å…¨å±€å˜é‡&#125; å¦‚ä½•é¿å… æ€»æ˜¯ä½¿ç”¨varæ¥å£°æ˜å˜é‡ï¼Œå³æ—¶æ˜¯å£°æ˜å…¨å±€å˜é‡ å•å…¨å±€å˜é‡ åªå£°æ˜ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œæ‰€æœ‰åŠŸèƒ½å…¨æŒ‚è½½åˆ°è¿™ä¸ªå…¨å±€å˜é‡ä¸Š æ¨¡å— è§„èŒƒCommonJsã€AMDã€CMD å¯¹åº”å®ç°NodeJsã€RequireJsã€SeaJs é›¶å…¨å±€å˜é‡ ä½¿ç”¨ç«‹å³å‡½æ•°åŒ…è£¹123(function(win)&#123; // doSth&#125;)(window); äº‹ä»¶å¤„ç† ä¸å¥½çš„å†™æ³• 1234567function handleClick(event)&#123; var popup=document.getElementById('popup'); popup.style.left=event.clientX+'px'; popup.style.top=event.clientY+'px'; popup.className='reveal';&#125;ele.addEventListener('click',handleClick,false); äº‹ä»¶å¤„ç†è§„åˆ™1 éš”ç¦»åº”ç”¨é€»è¾‘-&gt;å°†åº”ç”¨(ä¸šåŠ¡)é€»è¾‘ä»äº‹ä»¶å¤„ç†ç¨‹åºä¸­æŠ½ç¦» 1234567891011121314var MyApp=&#123; handleClick:function(event)&#123; this.showPopup(event); &#125;, showPopup:function(event)&#123; var popup=document.getElementById('popup'); popup.style.left=event.clientX+'px'; popup.style.top=event.clientY+'px'; popup.className='reveal'; &#125;&#125;;ele.addEventListener('click',function(event)&#123; MyApp.handleClick(event);&#125;,false); ä¸è¦åˆ†å‘äº‹ä»¶å¯¹è±¡-&gt;åªä¼ éœ€è¦çš„ä¿¡æ¯ åº”ç”¨é€»è¾‘ä¸åº”å½“ä¾èµ–äºeventå¯¹è±¡æ¥æ­£ç¡®å®ŒæˆåŠŸèƒ½ å°†eventå¯¹è±¡åšä¸ºå‚æ•°å¹¶ä¸èƒ½å‘Šè¯‰ä½ eventçš„å“ªäº›å±æ€§æ˜¯æœ‰ç”¨çš„ æµ‹è¯•æ—¶ï¼Œéœ€è¦é‡å»ºeventå¯¹è±¡ æœ€ä½³å®è·µ è®©äº‹ä»¶å¤„ç†ç¨‹åºä½¿ç”¨eventå¯¹è±¡æ¥å¤„ç†äº‹ä»¶ï¼Œç„¶åæ‹¿åˆ°éœ€è¦çš„æ•°æ®ä¼ ç»™åº”ç”¨é€»è¾‘ 1234567891011121314var MyApp=&#123; handleClick:function(event)&#123; this.showPopup(event.clientX,event.clientY);// åªä¼ éœ€è¦çš„ä¿¡æ¯ &#125;, showPopup:function(x,y)&#123; var popup=document.getElementById('popup'); popup.style.left=x+'px'; popup.style.top=y+'px'; popup.className='reveal'; &#125;&#125;;ele.addEventListener('click',function(event)&#123; MyApp.handleClick(event);&#125;,false); è®©äº‹ä»¶å¤„ç†ç¨‹åºæˆä¸ºæ¥è§¦åˆ°eventå¯¹è±¡çš„å”¯ä¸€çš„å‡½æ•°ï¼Œäº‹ä»¶å¤„ç†ç¨‹åºåº”å½“åœ¨è¿›å…¥åº”ç”¨é€»è¾‘ä¹‹å‰é’ˆå¯¹eventå¯¹è±¡æ‰§è¡Œä»»ä½•å¿…è¦çš„æ“ä½œã€‚åŒ…æ‹¬é˜»æ­¢é»˜è®¤äº‹ä»¶å’Œå†’æ³¡ã€‚ 12345678910111213141516var MyApp=&#123; handleClick:function(event)&#123;// åœ¨äº‹ä»¶å¤„ç†ç¨‹åºä¸­é’ˆå¯¹eventè¿›è¡Œå¿…è¦çš„å¤„ç† event.preventDefault(); event.stopPropagation(); this.showPopup(event.clientX,event.clientY);// åªä¼ éœ€è¦çš„ä¿¡æ¯ &#125;, showPopup:function(x,y)&#123; var popup=document.getElementById('popup'); popup.style.left=x+'px'; popup.style.top=y+'px'; popup.className='reveal'; &#125;&#125;;ele.addEventListener('click',function(event)&#123; MyApp.handleClick(event);&#125;,false); é¿å…ç©ºæ¯”è¾ƒ æ£€æµ‹åŸå§‹å€¼çš„ç±»å‹ å­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”ã€undefined-&gt;typeof 1234typeof 'a';// 'string'typeof 3;// 'number'typeof true;// 'boolean'typeof undefined;// 'undefined' null-&gt;ä¸€èˆ¬ä¸ç”¨äºç±»å‹æ£€æµ‹ï¼Œé™¤énullæ˜¯ä¸€ç§å¯é¢„æœŸçš„é¡µé¢æ—¶å¯ç”¨===å’Œ!==æ¥åˆ¤æ–­æ˜¯å¦ä¸ºnullå€¼ 1234var ele=document.getElementById('my-div');if(ele!==null)&#123;// å¦‚æœDOMå…ƒç´ ä¸å­˜åœ¨ï¼Œåˆ™eleå°±ä¸ºnullï¼Œæ­¤æ—¶nullæ˜¯ä¸€ä¸ªå¯é¢„æœŸçš„å€¼ï¼Œæ‰€ä»¥å¯ä»¥===æˆ–!==æ¥åˆ¤æ–­ // doSth &#125; æ£€æµ‹å¼•ç”¨å€¼çš„ç±»å‹ ä½¿ç”¨value instanceof constructor 123456789if(value instance Data)&#123; // doSth&#125;if(value instance RegExp)&#123; // doSth&#125;if(value instance Object)&#123; // doSth &#125; ä½†å‡½æ•°ã€æ•°ç»„ä¸èƒ½ç”¨instanceofæ¥åˆ¤æ–­ï¼Œå› ä¸ºå­˜åœ¨è·¨å¸§é—®é¢˜(cross-frame) æ£€æµ‹å‡½æ•°(åˆ¤æ–­æŸä¸€å¼•ç”¨å€¼æ˜¯å¦æ˜¯å‡½æ•°(æ˜¯å¦æ˜¯å‡½æ•°ç±»å‹)) ä½¿ç”¨typeof 12function myFn()&#123;&#125;typeof myFn;// 'function' ä½¿ç”¨typeofæ£€æµ‹IE8åŠä»¥ä¸‹DOMå…ƒç´ çš„æ–¹æ³•æ—¶ï¼Œä¼šè¿”å›â€™objectâ€™;é€€è€Œæ±‚å…¶æ¬¡ä¼šä½¿ç”¨inæ¥åˆ¤æ–­ï¼›å› ä¸ºDOMæ˜ç¡®å®šä¹‰ï¼Œäº†è§£åˆ°å¯¹è±¡æˆå‘˜å¦‚æœå­˜åœ¨åˆ™æ„å‘³ç€å®ƒæ˜¯ä¸€ä¸ªæ–¹æ³• 123if('querySelectorAll' in document)&#123; var imgs=document.querySelectorAll('img');&#125; æ£€æµ‹æ•°ç»„(åˆ¤æ–­æŸä¸€å¼•ç”¨å€¼æ˜¯å¦æ˜¯æ•°ç»„(æ˜¯å¦æ˜¯æ•°ç»„ç±»å‹)) ä½¿ç”¨ES5çš„isArray ä¸æ”¯æŒçš„åˆ™ä½¿ç”¨Object.prototype.toString.call(value)1234567function isArray(value)&#123; if(typeof Array.isArray==='function')&#123; return Array.isArray(value); &#125;else&#123; return Object.prototype.toString.call(value)==='[object Array]'; &#125;&#125; æ£€æµ‹å±æ€§/æ–¹æ³•å­˜åœ¨æ€§ ä½¿ç”¨prop in obj æ£€æµ‹å±æ€§/æ–¹æ³•æ˜¯å¦ä¸ºå®ä¾‹å±æ€§-&gt;obj.hasOwnProperty(â€˜propâ€™) IE8åŠä»¥ä¸‹åˆ¤æ–­æ˜¯å¦ä¸ºå®ä¾‹å±æ€§-&gt;éœ€å…ˆåˆ¤æ–­hasOwnPropertyçš„å­˜åœ¨æ€§ æ€»ç»“ åˆ¤æ–­æ•°æ®ç±»å‹ åŸå§‹å€¼ å­—ç¬¦ä¸²ã€æ•°å­—ã€å¸ƒå°”ã€undefined-&gt;typeof å¦‚if(typeof &#39;test&#39;===&#39;string&#39;){...} null-&gt;åªæœ‰åœ¨nullæ˜¯ä¸€ä¸ªå¯é¢„æœŸçš„å€¼æ—¶ï¼Œæ‰ç”¨æ¥æ¯”è¾ƒï¼Œä½¿ç”¨===ï¼Œ!== å¼•ç”¨å€¼ è‡ªå®šä¹‰ã€éå‡½æ•°ã€éæ•°ç»„å¯¹è±¡-&gt;ä½¿ç”¨obj instanceof constructor å¦‚obj instanceof Data å‡½æ•°/æ–¹æ³• éDOMå¯¹è±¡çš„æ–¹æ³•/å‡½æ•°-&gt;typeof å¦‚typeof myFn===&#39;function&#39; DOMå¯¹è±¡çš„æ–¹æ³•-&gt;æ— æ³•ä½¿ç”¨typeofï¼Œåªèƒ½é€šè¿‡inåˆ¤æ–­å®ƒå­˜åœ¨ï¼Œç„¶åç›´æ¥ä½¿ç”¨ æ•°ç»„ æ”¯æŒisArray-&gt;Array.isArray(value) ä¸æ”¯æŒ-&gt;Object.prototype.toString.call(value)===&#39;[object Array]&#39; åˆ¤æ–­å±æ€§/æ–¹æ³•å­˜åœ¨æ€§ ä¸€èˆ¬å±æ€§/æ–¹æ³•-&gt;ç»Ÿä¸€ä½¿ç”¨in å®ä¾‹å±æ€§å­˜åœ¨æ€§-&gt;ç»Ÿä¸€ä½¿ç”¨hasOwnProperty IE8åŠä»¥ä¸‹åˆ¤æ–­å®ä¾‹å±æ€§å­˜åœ¨æ€§-&gt;å…ˆåˆ¤æ–­hasOwnPropertyçš„å­˜åœ¨æ€§ï¼Œå†è°ƒç”¨hasOwnProperty å°†é…ç½®æ•°æ®ä»ä»£ç ä¸­æŠ½ç¦» é…ç½®æ•°æ® URL å±•ç°ç»™ç”¨æˆ·çš„å­—ç¬¦ä¸² é‡å¤çš„å€¼ è®¾ç½®(æ¯é¡µçš„é…ç½®é¡¹) ä»»ä½•å¯èƒ½å‘ç”Ÿå˜æ›´çš„å€¼ æŠ½ç¦» å°†é…ç½®æ•°æ®æŠ½ç¦»æˆä¸€ä¸ªå¯¹è±¡ 1234var config=&#123; MSG_INVALID_VALUE:'ä¸åˆæ³•çš„å€¼', URL:'https://github.com/BryanAdamss/SourceSave'&#125;; å°†é…ç½®æ•°æ®æŠ½ç¦»æˆä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­ æŠ›å‡ºè‡ªå®šä¹‰é”™è¯¯ å¦‚æœæ²¡æœ‰é€šè¿‡try-catchè¯­å¥æ•è·ï¼ŒæŠ›å‡ºä»»ä½•å€¼éƒ½å°†å¼•å‘ä¸€ä¸ªé”™è¯¯ã€‚å¦‚ç›´æ¥throw &#39;message&#39;ï¼Œä¼šå¼•å‘ä¸€ä¸ªé”™è¯¯ ä½•æ—¶æŠ›å‡ºé”™è¯¯ æŠ›å‡ºé”™è¯¯æœ€ä½³çš„åœ°æ–¹æ˜¯åœ¨å·¥å…·å‡½æ•°ä¸­ï¼Œå¦‚addClass()å‡½æ•°ï¼Œå®ƒæ˜¯é€šç”¨è„šæœ¬çš„ä¸€éƒ¨åˆ†ï¼Œä¼šåœ¨å¾ˆå¤šåœ°æ–¹ä½¿ç”¨ã€‚-&gt;åœ¨javascriptç±»åº“ä¸­ä½¿ç”¨ é”™è¯¯ç±»å‹ Errorã€EvalErrorã€RangeErrorã€ReferenceErrorã€SyntaxErrorã€TypeErrorã€URIError ä¸æ˜¯ä½ çš„å¯¹è±¡ä¸è¦åŠ¨ ä¸è¦ä¿®æ”¹åŸç”Ÿå¯¹è±¡ä»¥åŠä¸€äº›ç±»åº“å¯¹è±¡ åŸåˆ™ï¼šå°†å·²ç»å­˜åœ¨çš„jså¯¹è±¡å½“åšå·¥å…·å‡½æ•°åº“é‚£æ ·ä½¿ç”¨ ä¸è¦†ç›–æ–¹æ³• ä¸è¦†ç›–åŸå¯¹è±¡çš„æ–¹æ³• ä¸æ–°å¢æ–¹æ³• ä¸åœ¨ä¸å±äºä½ çš„å¯¹è±¡ä¸Šæ·»åŠ æ–¹æ³• ä¸åˆ é™¤æ–¹æ³• ä¸è¦åˆ é™¤ä¸€ä¸ªä¸æ˜¯ä½ çš„å¯¹è±¡ä¸Šçš„æ–¹æ³• æ›´å¥½æ–¹æ³• ç»§æ‰¿åŸå¯¹è±¡ï¼Œåœ¨å…¶åŸºç¡€ä¸Šæ‰©å…… é˜»æ­¢ä¿®æ”¹(é”å®šåï¼Œå°†æ— æ³•è§£é”) é˜²æ­¢æ‰©å±•-&gt;æ— æ³•æ–°å¢å±æ€§å’Œæ–¹æ³•ï¼Œå¯åˆ é™¤ Object.preventExtension(obj); Object.isExtensible(); å¯†å°å¯¹è±¡-&gt;å·²å­˜åœ¨çš„å±æ€§ã€æ–¹æ³•æ— æ³•è¢«åˆ é™¤ï¼Œå¯ä¿®æ”¹ Object.seal(obj); Object.isSealed(); å†»ç»“å¯¹è±¡-&gt;é˜²æ­¢æ‰©å±•+å¯†å°ï¼Œæ— æ³•åˆ é™¤ï¼Œæ— æ³•ä¿®æ”¹ Object.freeze(obj); Object.isFrozen(); æµè§ˆå™¨å—…æ¢ UAæ£€æµ‹ ç¼ºç‚¹ UAå¯ä»¥è¢«ä¿®æ”¹ æµè§ˆå™¨ä¸ºäº†å…¼å®¹æ€§ï¼Œéƒ½ä¼šåŒ…å«å…¶ä»–æµè§ˆå™¨çš„UAå­—ç¬¦ä¸² ç‰¹æ€§æ£€æµ‹-&gt;æ ¹æ®åŠŸèƒ½(ç‰¹æ€§)æ¥æ£€æµ‹ ä¸è¦è¿›è¡Œç‰¹æ€§æ¨æ–­-&gt;ä¸è¦æ ¹æ®ä¸€ä¸ªç‰¹æ€§çš„æ˜¯å¦å­˜åœ¨å»æ¨æ–­å¦ä¸€ä¸ªç‰¹æ€§æ˜¯å¦å­˜åœ¨ ä¸è¦è¿›è¡Œæµè§ˆå™¨æ¨æ–­-&gt;ä¸è¦æ ¹æ®ä¸€ä¸ªç‰¹æ€§çš„æ˜¯å¦å­˜åœ¨å»æ¨æ–­æ˜¯æŸç§æµè§ˆå™¨ ä¼˜å…ˆçº§:ç‰¹æ€§æ£€æµ‹&gt;UAæ£€æµ‹ è‡ªåŠ¨åŒ–æ–‡ç« ç¬¬ä¸‰éƒ¨åˆ†ä»‹ç»çš„æ˜¯å‰ç«¯è‡ªåŠ¨åŒ–æ–¹é¢çš„çŸ¥è¯†ï¼Œä½†ç”¨çš„æ˜¯Ant(éœ€è¦JAVAç¯å¢ƒ)ï¼Œç”±äºç°åœ¨ç”¨gulpçš„æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥è¿™ä¸€å—å°±åªæ˜¯å¤§æ¦‚æ‰«äº†ä¸€ä¸‹ã€‚ æµç¨‹ æ„å»º-&gt;éªŒè¯-&gt;åˆå¹¶ã€åŠ å·¥-&gt;ç²¾ç®€ã€å‹ç¼©-&gt;æ–‡æ¡£åŒ–-&gt;è‡ªåŠ¨åŒ–æµ‹è¯•-&gt;é›†æˆ]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>js</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Angualr-guide]]></title>
    <url>%2F2017%2F06%2F07%2FAngualr-guide%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸ºè‡ªå·±å­¦ä¹ angularçš„ç¬”è®°ï¼Œå¸¦æœ‰ä¸ªäººç†è§£ã€‚å­¦ä¹ çš„ç‰ˆæœ¬ä¸º1.2.32å¯¹åº”çš„æºç åœ¨https://github.com/BryanAdamss/SourceSave/tree/master/AngularJsæœ¬ä»“åº“è¿˜åŒ…å«å¤§é‡æœ¬äººå‰ç«¯ç»ƒä¹ ç”¨çš„demoï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰å¸®åŠ©ã€‚æœ›star~ Angularå­¦ä¹ ç¬”è®°Angularé€‚ç”¨åœºæ™¯ é€‚åˆï¼šå¤§é‡CRUD(å¢åˆ æ”¹æŸ¥)æ“ä½œçš„åœºæ™¯ï¼Œå¦‚åå°ç®¡ç†ç³»ç»Ÿ ä¸é€‚åˆï¼šæ¸¸æˆã€å¤§é‡UIæ“ä½œçš„åœºæ™¯ DataBinding åŒå‘ï¼šviewã€modelä¹‹é—´ä¼šç›¸äº’åŒæ­¥æ•°æ® Controller åœ¨controllerä¸­åš è®¾ç½®$scopeçš„åˆå§‹çŠ¶æ€ ä¸º$scopeæ·»åŠ ä¸€äº›è¡Œä¸º ä¸è¦åœ¨controllerä¸­åš æ‰‹åŠ¨æ“ä½œDOMï¼šcontrollerä¸­åº”è¯¥ä»…åŒ…å«ä¸šåŠ¡é€»è¾‘ï¼›å¦‚æœåœ¨controllerä¸­æ·»åŠ è¡¨ç°ç›¸å…³é€»è¾‘ï¼Œä¼šä¸¥é‡å½±å“æµ‹è¯•ï¼›DOMæ“ä½œåº”è¯¥å°è£…åœ¨directivesä¸­ï¼›å¦å¤–AngularJsä¸­ä¹Ÿå°è£…äº†ä¸€äº›å¸¸ç”¨DOMæ“ä½œæŒ‡ä»¤ï¼Œå¦‚ng-showç­‰ã€‚ æ ¼å¼åŒ–è¾“å…¥ï¼š Use AngularJS form controls instead. è¿‡æ»¤è¾“å‡ºï¼š Use AngularJS filters instead. ä¼ é€’æ•°æ®æˆ–çŠ¶æ€ï¼š Use AngularJS services instead. ç®¡ç†å…¶ä»–ç»„ä»¶çš„å‘¨æœŸï¼šä¾‹å¦‚åœ¨controllerä¸­åˆ›å»ºservices Services ç‰¹ç‚¹ lazyå®ä¾‹åŒ–ï¼šåªæœ‰å½“æŸä¸ªservicesè¢«ä¾èµ–æ—¶ï¼Œå®ƒæ‰ä¼šè¢«å®ä¾‹åŒ– å•ä¾‹ï¼šæ¯ä¸ªä¾èµ–servicesçš„componentéƒ½ä¼šå¾—åˆ°ç”±service factoryäº§ç”Ÿçš„serviceå•å®ä¾‹çš„ä¸€ä¸ªå¼•ç”¨ï¼ˆserviceéƒ½æ˜¯å•ä¾‹çš„ï¼Œåªè¦åˆ›å»ºäº†ä¸€ä¸ªServiceï¼Œé‚£ä¹ˆç¨‹åºéƒ½åœ¨ä½¿ç”¨è¿™å”¯ä¸€çš„Service) ä»¥$å¼€å¤´çš„ï¼Œéƒ½æ˜¯å†…ç½®æœåŠ¡ï¼Œegï¼š$http serviceå¯ä»¥è¢«ç”¨æ¥ä¼ é€’æ•°æ®ã€å®ç°ä»£ç å¤ç”¨ åˆ›å»ºå¹¶ä½¿ç”¨ï¼šé€šè¿‡serviceå·¥å‚å‡½æ•°æ¥åˆ›å»ºï¼ˆfactoryå‡½æ•°ï¼‰123456789101112131415 angular.module('myServiceModule', []). controller('MyController', ['$scope', 'notify', function($scope, notifyInstance) &#123;//3.è¿™é‡Œnotyfyè¢«ä¾èµ–ï¼Œæ‰€ä»¥ç«‹é©¬è¢«å®ä¾‹åŒ–å¹¶å°†2å¤„çš„åŒ¿åå‡½æ•°èµ‹å€¼ç»™äº†notifyInstance $scope.callNotify = function(msg) &#123; notifyInstance (msg); &#125;; &#125;]).factory('notify', ['$window', function(win) &#123;// 1.è¿™é‡Œæ³¨å†Œäº†ä¸€ä¸ªnotifyçš„æœåŠ¡ï¼Œè€Œä¸”è¿˜ä¾èµ–å¦ä¸€ä¸ªå†…ç½®æœåŠ¡$winodwï¼Œæ³¨æ„è¿™é‡Œè¿˜åªæ˜¯æ³¨å†Œä¸€ä¸ªnotifyçš„æ„é€ å‡½æ•°ï¼Œå¹¶æ²¡æœ‰åˆ›å»ºnotifyçš„å®ä¾‹ var msgs = []; return function(msg) &#123;// 2.returné‡Œçš„æ˜¯å½“æœåŠ¡è¢«åŠ è½½(ä¾èµ–æ—¶)è¿”å›çš„å®ä¾‹å¯¹è±¡æˆ–å‡½æ•° msgs.push(msg); if (msgs.length === 3) &#123; win.alert(msgs.join('\n')); msgs = []; &#125; &#125;; &#125;]); Scope ç‰¹ç‚¹ å®ƒåªæ˜¯ä¸€ä¸ªæ™®é€šçš„jså¯¹è±¡ å®ƒæŒ‡å‘äº†åº”ç”¨çš„model å®ƒæ˜¯è¡¨è¾¾å¼çš„æ‰§è¡Œç¯å¢ƒcontext å®ƒæ‹¥æœ‰å’ŒDOMä¸€æ ·çš„æ ‘å½¢ç»“æ„ å®ƒèƒ½ç›‘è§†è¡¨è¾¾å¼ å®ƒèƒ½ä¼ æ’­äº‹ä»¶ å®ƒæä¾›äº†$watchæ¥è§‚å¯Ÿæ¨¡å‹çš„å˜åŒ– å®ƒæä¾›äº†$applyæ¥ä¼ æ’­æ¨¡å‹çš„å˜åŒ– å®ƒå¯ä»¥åµŒå¥—ä»¥é™åˆ¶å¯¹åº”ç”¨ç¨‹åºç»„ä»¶å±æ€§çš„è®¿é—®ï¼ŒåŒæ—¶æä¾›å¯¹å…±äº«æ¨¡å‹å±æ€§çš„è®¿é—®ã€‚ å®ƒæ˜¯controllerå’Œviewé—´çš„èƒ¶æ°´ å±‚æ¬¡ç»“æ„ï¼ˆç±»ä¼¼DOMçš„æ ‘å½¢ç»“æ„ï¼‰ æ¯ä¸ªangularAppéƒ½æœ‰ä¸€ä¸ªæ ¹scopeï¼Œ$rootScopeï¼Œ$rootScopeæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå­scope æŸ¥æ‰¾æŸå±æ€§æ—¶ï¼Œä¼šåƒjsä½œç”¨åŸŸä¸€æ ·ï¼Œé€å±‚å‘ä¸Šæ‰¾ angularJsä¼šåœ¨æ¯ä¸ªç»‘å®šäº†scopeå…ƒç´ çš„classä¸Šæ·»åŠ ng-scope directiveå¯ä»¥åˆ›å»ºscope è·å–DOMå…ƒç´ ä¸Šç»‘å®šçš„scope å¯ä»¥é€šè¿‡angular.element(domå…ƒç´ ).scope() åœ¨chromeä¸­ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ angular.element($0).scope()æˆ–è€…åœ¨é€‰ä¸­ä¸€ä¸ªdomå…ƒç´ åç›´æ¥åœ¨æ§åˆ¶å°ä¸­$scopeï¼Œå°±èƒ½å¾—åˆ°ç›¸åº”domä¸Šçš„$scope å¯ä»¥é€šè¿‡å®‰è£… AngularJS Batarangæ’ä»¶æ¥æŸ¥çœ‹ äº‹ä»¶ä¼ æ’­ $emit(eventName) å‘ä¸Šä¼ æ’­äº‹ä»¶ $broadcast(eventName) å‘ä¸‹ä¼ æ’­äº‹ä»¶ ç”Ÿå‘½å‘¨æœŸï¼š Creation-&gt; Watcher registration-&gt; Model mutation-&gt; Mutation observation-&gt; Scope destruction DependencyInjection(DI) ä½¿ç”¨ servicesã€directivesã€filterã€animationå¯ä»¥å°†â€servicesâ€ã€â€valueâ€å‹ç»„ä»¶ä½œä¸ºä¾èµ–æ³¨å…¥ 123456789angular.module('myModule', []).factory('serviceId', ['depService', function(depService) &#123; // ...&#125;]).directive('directiveName', ['depService', function(depService) &#123; // ...&#125;]).filter('filterName', ['depService', function(depService) &#123; // ...&#125;]); controllerå¯ä»¥å°†â€servicesâ€ã€â€valueâ€å‹ç»„ä»¶ä½œä¸ºä¾èµ–æ³¨å…¥ï¼Œä½†ä»–ä»¬è¿˜å¯ä»¥æ³¨å…¥ä¸€äº›ç‰¹æ®Šçš„ä¾èµ–å¦‚$scope 1234567someModule.controller('MyController', ['$scope', 'dep1', 'dep2', function($scope, dep1, dep2) &#123;...$scope.aMethod = function() &#123;...&#125;...&#125;]); ä¸ºmoduleæä¾›runã€configæ–¹æ³•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨DI configæ¥æ”¶ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°å¯ä»¥æ³¨å…¥â€providerâ€ã€â€constantâ€å‹ç»„ä»¶ï¼›ä¸å¯å°†â€servicesâ€ã€â€valueâ€å‹æ³¨å…¥åˆ°configä¸­ runæ¥æ”¶ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°å¯ä»¥æ³¨å…¥â€servicesâ€ã€â€valueâ€ä»¥åŠâ€constantâ€(å¸¸æ•°)å‹ç»„ä»¶ï¼›ä¸å¯å°†â€providersâ€å‹æ³¨å…¥åˆ°runä¸­12345angular.module('myModule', []).config(['depProvider', function(depProvider) &#123;// ...&#125;]).run(['depService', function(depService) &#123;// ...&#125;]); ä¾èµ–å£°æ˜ è¡Œå†…æ•°ç»„å£°æ˜(æ¨èã€æœ€ä¼˜) 123someModule.controller('MyController', ['$scope', 'greeter', function($scope, greeter) &#123;// ...&#125;]); ä½¿ç”¨$inject(å¯è®©controlleré€šè¿‡jså‹ç¼©) 12345var MyController = function($scope, greeter) &#123;// ...&#125;MyController.$inject = ['$scope', 'greeter'];someModule.controller('MyController', MyController); éšå¼å£°æ˜ä¾èµ–(å‹ç¼©æ—¶ï¼Œä¼šå‡ºé”™)-&gt;å°½é‡é¿å…ç”¨æ­¤æ–¹æ³• 123someModule.controller('MyController', function($scope, greeter) &#123;// ...&#125;); é€šè¿‡åœ¨ng-appæŒ‡ä»¤æ‰€åœ¨htmlå…ƒç´ ä¸Šæ·»åŠ  ng-strict-diæŒ‡ä»¤ï¼Œä»¥é™åˆ¶éšå¼å£°æ˜çš„ä½¿ç”¨(è‹¥ä½¿ç”¨éšå¼å£°æ˜ ï¼Œä¼šæŠ¥é”™) Templates angularJSä¸­çš„templateæ˜¯ç”±htmlä»¥åŠangularJså£°æ˜çš„å…ƒç´ åŠç‰¹æ€§ç»„æˆã€‚angularJsé€šè¿‡controllerç»„åˆmodelä¸­çš„ä¿¡æ¯å’Œæ¨¡æ¿ä»¥å‘ˆç°åŠ¨æ€çš„viewç»™ç”¨æˆ· templatesä¸­å¯ä»¥ä½¿ç”¨ directive {{}} filter form controller 1234567891011&lt;html ng-app&gt; &lt;!-- Body tag augmented with ngController directive --&gt; &lt;body ng-controller="MyController"&gt; &lt;input ng-model="foo" value="bar"&gt; &lt;!-- Button tag with ngClick directive, and string expression 'buttonText' wrapped in "&#123;&#123; &#125;&#125;" markup --&gt; &lt;button ng-click="changeFoo()"&gt;&#123;&#123;buttonText&#125;&#125;&lt;/button&gt; &lt;script src="angular.js"&gt;&lt;/script&gt; &lt;/body&gt;&lt;/html&gt; åœ¨å¤æ‚çš„appä¸­,å¯ä»¥å°†ä¸åŒçš„æ¨¡æ¿æ”¾åœ¨å•ç‹¬çš„htmlä¸­ï¼Œç„¶åé€šè¿‡ng-viewæ¥å¼•ç”¨ Expressions ä¸»è¦ç”¨åœ¨æ’å€¼ç»‘å®š(interpolation bindings)ä¸­ï¼Œä½†ä¹Ÿå¯ä»¥ç›´æ¥ç”¨åœ¨æŒ‡ä»¤ä¸­ï¼›å¦‚ng-click=â€functionExpression()â€ï¼›ä»¥ä¸‹éƒ½æ˜¯åˆæ³•çš„ 1+2 a+b user.name items[index] å’ŒJsçš„è¡¨è¾¾å¼çš„å¼‚åŒ contextï¼šjsä¸­çš„contextä¸€èˆ¬æ˜¯å…¨å±€å˜é‡windowï¼›angularä¸­è¡¨è¾¾å¼çš„contextåˆ™æ˜¯scope jsä¸­å°è¯•è®¡ç®—æœªå®šä¹‰çš„å±æ€§ï¼Œä¼šæŠ¥é”™ï¼›angularåˆ™ä¸ä¼šç›´æ¥æŠ¥é”™ï¼Œè€Œæ˜¯è½¬ä¸ºundefinedæˆ–null åœ¨angularè¡¨è¾¾å¼ä¸­å¯ä»¥ç”¨filteråœ¨å±•ç¤ºæ•°æ®å‰è¿›è¡Œæ•°æ®æ ¼å¼åŒ– åœ¨angularçš„è¡¨è¾¾å¼ä¸­æ²¡æœ‰æ¡ä»¶æ§åˆ¶ç›¸å…³è¯­å¥ï¼›å¦‚ifã€forç­‰ï¼Œä½†ä¸‰å…ƒæ“ä½œç¬¦ä¸­å¯ä»¥ç”¨ åœ¨angularçš„è¡¨è¾¾å¼ä¸­ä¸èƒ½æœ‰å‡½æ•°å£°æ˜ï¼ŒåŠæ—¶åœ¨ng-initæŒ‡ä»¤ä¸­ åœ¨angularçš„è¡¨è¾¾å¼ä¸­ä¸èƒ½åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ åœ¨angularçš„è¡¨è¾¾å¼ä¸­ä¸èƒ½é€šè¿‡newåˆ›å»ºå¯¹è±¡ åœ¨angularçš„è¡¨è¾¾å¼ä¸­ä¸èƒ½ä½¿ç”¨ä½è¿ç®—ã€voidã€é€—å·ç­‰æ“ä½œç¬¦ å¦‚æœæƒ³è§£æangularJsè¡¨è¾¾å¼ï¼Œä¸è¦ç”¨evalï¼Œä½¿ç”¨$eval æ€»ç»“ï¼šå¦‚æœæƒ³ä½¿ç”¨å¤æ‚jsä»£ç ï¼Œå¯ä»¥å°†å…¶å°è£…åœ¨controllerä¸­ï¼Œç„¶ååœ¨viewä¸­è°ƒç”¨ã€‚ä¸æ¨èç›´æ¥åœ¨è¡¨è¾¾å¼ä¸­ä¹¦å†™å¤§é‡ä»£ç ï¼› $event åœ¨æ‰§è¡Œng-clickã€ng-focusç­‰æŒ‡ä»¤æ—¶ï¼Œä¼šåœ¨è¡¨è¾¾å¼èŒƒå›´å†…å°†$eventæš´éœ²å‡ºæ¥ï¼Œ$eventæ˜¯ç±»ä¼¼jquery Eventçš„å¯¹è±¡ one-timeç»‘å®š(æ•°æ®åªç»‘å®šä¸€æ¬¡) ä¼˜åŠ¿ï¼šåªç»‘å®šä¸€æ¬¡ï¼Œå¯å‡å°‘ç›‘è§†æ¬¡æ•° ä½¿ç”¨ï¼šåœ¨å˜é‡å‰æ·»åŠ åŒå†’å·ï¼›ç±»ä¼¼{{::name}} ä½•æ—¶( å½“è¡¨è¾¾å¼è¢«è®¾å®šåï¼Œå°±ä¸ä¼šè¢«æ”¹å˜æ—¶ ) ç”¨åœ¨æ’å€¼æ–‡æœ¬å’Œç‰¹æ€§æ—¶ 1&lt;div name="attr: &#123;&#123;::color&#125;&#125;"&gt;text: &#123;&#123;::name | uppercase&#125;&#125;&lt;/div&gt; å½“ç”¨directiveåŒå‘ç»‘å®šæ•°æ®å¹¶ä¸”å‚æ•°ä¸ä¼šæ”¹å˜æ—¶ 1234567891011someModule.directive('someDirective', function() &#123; return &#123; scope: &#123; name: '=', color: '@' &#125;, template: '&#123;&#123;name&#125;&#125;: &#123;&#123;color&#125;&#125;' &#125;;&#125;);&lt;div some-directive name="::myName" color="My color is &#123;&#123;::myColor&#125;&#125;"&gt;&lt;/div&gt; æŒ‡ä»¤ä¸­åŒ…å«è¡¨è¾¾å¼æ—¶ 123&lt;ul&gt; &lt;li ng-repeat="item in ::items | orderBy:'name'"&gt;&#123;&#123;item.name&#125;&#125;;&lt;/li&gt;&lt;/ul&gt; Interpolation é’ˆå¯¹å¸ƒå°”attrï¼Œå¦‚disabledã€requiredã€selectedã€checkedã€readOnlyã€openï¼Œä¸è¦ä½¿ç”¨åŸç”Ÿçš„ï¼Œä½¿ç”¨ng-disabledã€ng-requiredâ€¦ ä½¿ç”¨ng-attr-xxxç»‘å®šä»»æ„ç‰¹æ€§ï¼Œå¦‚ng-attr-cxï¼›è‹¥ä¸ºé©¼å³°å½¢å¼ï¼Œåˆ™ç”¨ä¸‹åˆ’çº¿ä»£æ›¿ï¼Œå¦‚viewBoxï¼Œåˆ™ä½¿ç”¨ng-attr-view_box Filters åœ¨viewä¸­çš„è¯­æ³• æ­£å¸¸è¯­æ³• 1&#123;&#123; expression | filterName &#125;&#125; Filter Chain-&gt;ç”¨ä¸Šä¸€ä¸ªfilterçš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªfilterçš„è¾“å…¥ 1&#123;&#123; expression | filter1Name | filter2Name | ... &#125;&#125; å¸¦å‚æ•° 12&#123;&#123; expression | filterName:argument1:argument2:... &#125;&#125;å¦‚ &#123;&#123; 1234 | number:2 &#125;&#125; å½“filterç”¨åœ¨controllerã€servicesã€directivesä¸Šæ—¶ï¼Œéœ€é‡‡ç”¨Filterå½¢å¼ éœ€è¦åœ¨controllerä¸­ä½¿ç”¨numberè¿‡æ»¤å™¨æ—¶1234angular.module('numberFilterExample', []).controller('ExampleController', ['numberFilter', function(numFilter) &#123; // ....&#125;]); åˆ›å»ºè‡ªå®šä¹‰filter ä½¿ç”¨filterå‡½æ•°123456789101112angular.module('myReverseFilterApp', []).filter('reverse', function() &#123; return function(input) &#123;// return ä¸€ä¸ªå‡½æ•° input = input || ''; var out = ''; for (var i = 0; i &lt; input.length; i++) &#123; out = input.charAt(i) + out; &#125; return out; &#125;;&#125;)// htmlä¸­ç›´æ¥&#123;&#123; data | reverse&#125;&#125; å¸¸ç”¨filter dateæ—¥æœŸæ ¼å¼-&gt; {{ now | date:'yyyy-MM-dd hh:mm:ss a' }} currencyè´§å¸æ ¼å¼åŒ– fiterå¯¹æ•°ç»„ã€å­—ç¬¦ä¸²ã€å¯¹è±¡ç­‰è¿›è¡Œç­›é€‰æ˜¾ç¤º 1234567891011$scope.city = [&#123; id: "001", name: "ä¸Šæµ·" &#125;, &#123; id: "002", name: "åŒ—äº¬"&#125;];// view &#123;&#123;city&#125;&#125; &#123;&#123;city|filter:'ä¸Šæµ·'&#125;&#125;// é»˜è®¤ç­›é€‰å‡ºæ‰€æœ‰valueå€¼ä¸º'ä¸Šæµ·'çš„object &#123;&#123;city|filter:&#123;name:'åŒ—äº¬'&#125; &#125;&#125;// ç­›é€‰å‡ºnameä¸ºåŒ—äº¬çš„object orderByæ’åº {{city |orderBy:'id'}} é»˜è®¤æ­£åº {{city |orderBy:'-id'}} ååº json å°†å¯¹è±¡è§£ææˆjsonï¼Œä¸»è¦ç”¨æ¥è°ƒè¯• Forms angularJså¯¹è¡¨å•åŸŸåšäº†å¢å¼ºï¼Œæ·»åŠ äº†å¾ˆå¤šåŠŸèƒ½ ä½¿ç”¨ng-modelå°±å¯ä»¥å°†è¡¨å•çš„å€¼å’Œmodelè¿›è¡ŒåŒå‘ç»‘å®š ä½¿ç”¨novalidateå±è”½æµè§ˆå™¨åŸç”ŸéªŒè¯ angualrJsä¼šæ·»åŠ ä¸€äº›classç±»ï¼Œæ¥æ ‡è¯†éªŒè¯çš„çŠ¶æ€ï¼Œæ ¹æ®è¿™äº›éªŒè¯çŠ¶æ€classç±»ï¼Œæ¥å†™ä¸åŒçš„æ ·å¼ ng-validï¼šmodeléªŒè¯é€šè¿‡ ng-invalidï¼šmodelæœªéªŒè¯é€šè¿‡ ng-valid-[ruleName]ï¼šruleNameçš„éªŒè¯è§„åˆ™å·²é€šè¿‡ ng-invalid-[ruleName ]ï¼šruleNameçš„éªŒè¯è§„åˆ™æœªé€šè¿‡ ng-pristineï¼šè¿™ä¸ªè¡¨å•åŸŸè¿˜æ²¡æœ‰äº¤äº’è¿‡(æœªä¿®æ”¹è¿‡) ng-dirtyï¼šè¿™ä¸ªè¡¨å•åŸŸå·²ç»äº¤äº’è¿‡(ä¿®æ”¹è¿‡) ng-touchedï¼šè¿™ä¸ªè¡¨å•åŸŸ å¤±å»ç„¦ç‚¹ ng-untouchedï¼šè¿™ä¸ªè¡¨å•åŸŸæœªå¤±å»ç„¦ç‚¹ ng-pendingï¼šå¼‚æ­¥éªŒè¯è¿˜æœªå®Œæˆ å¯ä»¥æ ¹æ®è¡¨å•éªŒè¯çš„ä¸€äº›çŠ¶æ€ï¼Œæ¥è¾…åŠ©æ·»åŠ å¸®åŠ©ä¿¡æ¯ é€šè¿‡ng-model-optionsæ¥è®¾ç½®ä¸€äº›å±æ€§ ng-model-options=â€{ updateOn: â€˜blurâ€™ }â€ åœ¨bluræ—¶æ›´æ–°model å»¶æ—¶æ›´æ–°model ng-model-options=â€{ debounce: 500 }â€ ng-model-options=â€{ updateOn: â€˜default blurâ€™, debounce: { default: 500, blur: 0 } }â€ å¯é€šè¿‡ç¼–å†™directiveæ¥åˆ›å»ºè‡ªå·±çš„éªŒè¯è§„åˆ™ã€è¡¨å•åŸŸ å¯ä»¥ä¿®æ”¹å†…ç½®çš„éªŒè¯è§„åˆ™ ç›¸å…³çŠ¶æ€ å­—æ®µé”™è¯¯ä¿¡æ¯-&gt;formName.fieldName.$error-&gt;éªŒè¯é€šè¿‡çš„è§„åˆ™ä¼šæ˜¾ç¤ºfalseï¼Œæœªé€šè¿‡çš„æ˜¾ç¤ºtrue å­—æ®µæ— æ•ˆä¿¡æ¯-&gt;formName.fieldName.$invalid å­—æ®µæœ‰æ•ˆä¿¡æ¯-&gt;formName.fieldName.$valid å­—æ®µæ˜¯å¦æ›´æ”¹-&gt;formName.fieldName.$dirty å­—æ®µæ˜¯å¦æœªæ›´æ”¹-&gt;formName.fieldName.$pristine $scope.formName.$setPristine-&gt;å°†è¡¨å•æ¢å¤åˆ°æœ€åˆçŠ¶æ€ï¼Œclassã€$dirtyç­‰éƒ½è¢«æ¢å¤ Directives åŒ¹é… 12345678&lt;div ng-controller="Controller"&gt;&lt;!-- ä¸‹é¢è¿™å‡ ç§å½¢å¼ï¼Œéƒ½å°†inputå’Œmodelä¸­nameç»‘å®šèµ·æ¥äº†ï¼Œç»‘å®šè¿™ä¸ªæŒ‡ä»¤å°±åŒ¹é…ä¸Šäº† --&gt; Hello &lt;input ng-model='name'&gt; &lt;hr/&gt;&lt;!-- å»ºè®®å½¢å¼ --&gt; &lt;span ng-bind="name"&gt;&lt;/span&gt; &lt;br/&gt;&lt;!-- å»ºè®®å½¢å¼ --&gt; &lt;span ng:bind="name"&gt;&lt;/span&gt; &lt;br/&gt; &lt;span ng_bind="name"&gt;&lt;/span&gt; &lt;br/&gt; &lt;span data-ng-bind="name"&gt;&lt;/span&gt; &lt;br/&gt; &lt;span x-ng-bind="name"&gt;&lt;/span&gt; &lt;br/&gt;&lt;/div&gt; ng-attr-xxx-&gt;æ‰€æœ‰ng-attrå¼€å¤´çš„ç‰¹æ€§ï¼Œæœ€åéƒ½ä¼šè½¬åŒ–åˆ°åŸç”Ÿçš„ç‰¹æ€§ä¸Šï¼Œå»ºè®®ä¸è¦åœ¨åŸç”Ÿçš„ç‰¹æ€§ä¸Šç»‘å®šå€¼ï¼Œéƒ½ç”¨ng-attrå¼€å¤´(å› ä¸ºæŸäº›åŸç”Ÿç‰¹æ€§å’Œngé…åˆçš„ä¸å¥½) 123&lt;svg&gt; &lt;circle ng-attr-cx="&#123;&#123;cx&#125;&#125;"&gt;&lt;/circle&gt;&lt;!-- å°†&#123;&#123;cx&#125;&#125;ç»‘å®šåˆ°äº†åŸç”Ÿçš„cxä¸Š --&gt;&lt;/svg&gt; æŒ‡ä»¤ç±»å‹ Aï¼ˆattributeï¼‰ã€Eï¼ˆelementï¼‰ã€Mï¼ˆcommentï¼‰ã€Cï¼ˆclassï¼‰;Må’ŒCä¸å¸¸ç”¨ï¼Œå¦‚æœéœ€è¦å…¼å®¹IE8ï¼Œå»ºè®®å…¨éƒ¨ç”¨A 1234&lt;my-dir&gt;&lt;/my-dir&gt;&lt;span my-dir="exp"&gt;&lt;/span&gt;&lt;!-- directive: my-dir exp --&gt;&lt;span class="my-dir: exp;"&gt;&lt;/span&gt; æ³¨æ„ï¼šç”±äºå†å²åŸå› ï¼Œæµè§ˆå™¨åœ¨è§£æhtmlæ ‡ç­¾å’Œæ ‡ç­¾attributeæ—¶ï¼Œä¼šè‡ªåŠ¨å¿½ç•¥å¤§å°å†™ï¼Œç»Ÿä¸€ä½¿ç”¨å°å†™å½¢å¼ï¼›è¿™å°±å¯¼è‡´äº†ï¼Œç”¨é©¼å³°å½¢å¼å®šä¹‰çš„htmlæ ‡ç­¾ï¼ˆ&lt;myTag&gt;ï¼‰å’Œç‰¹æ€§ä¼šè¢«è½¬æ¢ä¸ºå…¨å°å†™ï¼ˆ&lt;mytag&gt;ï¼‰ï¼›é‚£ä¹ˆç”¨é©¼å³°å½¢å¼å®šä¹‰çš„æŒ‡ä»¤åœ¨åŒ¹é…Eå’ŒAæ—¶ï¼Œå°±æ‰¾ä¸åˆ°ï¼ˆæ— æ³•åŒ¹é…ï¼‰ï¼Œä¸ºäº†è§£å†³è¿™é—®é¢˜ï¼Œngä¼šåœ¨å®šä¹‰æ—¶ç”¨çš„é©¼å³°å½¢å¼directive(â€œmyTagâ€,xxx)è½¬æ¢æˆmy-tagï¼Œè¿™æ ·åœ¨htmlä¸­my-tagå½¢å¼çš„æ ‡ç­¾å’Œç‰¹æ€§å°±ä¼šè¢«åŒ¹é…åˆ°ã€‚å¦‚æœå®šä¹‰æ—¶æ²¡ç”¨é©¼å³°å½¢å¼(å…¨å°å†™)ï¼Œåˆ™ä¸ä¼šè½¬æ¢ï¼Œç›´æ¥åŒ¹é…ã€‚é©¼å³°å½¢å¼çš„æŒ‡ä»¤ååœ¨åŒ¹é…Må’ŒCæ—¶ä¸ä¼šå­˜åœ¨è½¬æ¢-&gt;æ€»ç»“:åœ¨å®šä¹‰æŒ‡ä»¤æ—¶å¦‚æœç”¨äº†é©¼å³°å½¢å¼åŒ¹é…EAï¼Œåˆ™åœ¨htmlä¸­ä½¿ç”¨æ—¶å°±è¦è½¬æ¢æˆçŸ­æ¨ªçº¿è¿æ¥çš„å½¢å¼å¦‚myTagè½¬æ¢æˆmy-tag-&gt;æœ€ä½³å®è·µï¼šngä¸­æŒ‡ä»¤è‹¥ç”¨é©¼å³°åˆ™htmlä¸­ç”¨çŸ­æ¨ªçº¿è¿æ¥ï¼› åˆ›å»ºæŒ‡ä»¤ module.directive(directiveName,fn); 12345678910angular.module('docsSimpleDirective', []).controller('Controller', ['$scope', function($scope) &#123; $scope.customer = &#123; name: 'Naomi', address: '1600 Amphitheatre' &#125;;&#125;]).directive('myCustomer', function() &#123; return &#123;// å°½é‡éƒ½è¿”å›ä¸€ä¸ªobjectï¼Œä¸è¦åªè¿”å›ä¸€ä¸ªå‡½æ•° template: 'Name: &#123;&#123;customer.name&#125;&#125; Address: &#123;&#123;customer.address&#125;&#125;' // é™¤éä½ çš„æ¨¡æ¿å¾ˆå°ï¼Œå¦åˆ™ä½¿ç”¨templateUrlæ¥å¼•å…¥å¤–éƒ¨å•ç‹¬çš„æ¨¡æ¿htmlæ–‡ä»¶ &#125;;&#125;); templateUrl-&gt;é™¤éä½ çš„æ¨¡æ¿å¾ˆå°ï¼Œå¦åˆ™ä½¿ç”¨templateUrlæ¥å¼•å…¥å¤–éƒ¨å•ç‹¬çš„æ¨¡æ¿htmlæ–‡ä»¶ å½“replaceä¸ºtrueæ—¶ï¼Œtplæ–‡ä»¶å†…å®¹å¿…é¡»è¢«åŒ…è£¹åœ¨ä¸€ä¸ªæ ‡ç­¾å†…ï¼Œä¹Ÿå³tplæ–‡ä»¶åªèƒ½æœ‰ä¸€ä¸ªæ ¹æ ‡ç­¾ï¼›å³ä¸èƒ½å­˜åœ¨æœ‰æ–‡æœ¬æœªè¢«æ ‡ç­¾åŒ…è£¹ï¼Œä¹Ÿä¸èƒ½å­˜åœ¨å¤šä¸ªæ ¹æ ‡ç­¾ï¼›å› ä¸ºæ›¿æ¢çš„æ—¶å€™ngæ‰¾ä¸åˆ°ä¸€ä¸ªå”¯ä¸€çš„èŠ‚ç‚¹åšä¸ºæ›¿æ¢èŠ‚ç‚¹ï¼Œæ‰€ä»¥å¿…é¡»å¾—æœ‰ä¸€ä¸ªæœ€å¤–å±‚çš„æ ¹èŠ‚ç‚¹ï¼›templateä¹Ÿå­˜åœ¨åŒæ ·æƒ…å†µ-&gt;æœ€ä½³å®è·µï¼Œä»»ä½•æƒ…å†µä¸‹ï¼Œéƒ½è®©æ¨¡æ¿æ–‡ä»¶åŒ…è£¹åœ¨ä¸€ä¸ªæ ¹æ ‡ç­¾ä¸­ï¼Œè¿™æ ·ä¹Ÿæ–¹ä¾¿æ–‡ä»¶çš„ç»„ç»‡ç®¡ç† å¯ä»¥åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨$scopeä¸­çš„å˜é‡ templateUrlä¸­å¯ä»¥æŒ‡å®štype=text/ng-templateçš„scriptä¸ºæ¨¡æ¿ï¼Œåªéœ€è¦åœ¨templateUrlä¸­å†™ä¸Šscriptæ¨¡æ¿çš„idï¼›æ³¨æ„ï¼šè¿™ä¸ªscriptæ¨¡æ¿å¿…é¡»åœ¨ng-appä¸­ï¼Œè€Œä¸”ï¼Œè‹¥replactä¸ºtrueï¼Œåˆ™ä¹Ÿéœ€è¦ä¸€ä¸ªæ ¹æ ‡ç­¾1234567891011angular.module('docsTemplateUrlDirective', []).controller('Controller', ['$scope', function($scope) &#123; $scope.customer = &#123; name: 'Naomi', address: '1600 Amphitheatre' &#125;;&#125;]).directive('myCustomer', function() &#123; return &#123; templateUrl: 'my-customer.html' &#125;;&#125;); restrict-&gt;è®¾ç½®æŒ‡ä»¤çš„åŒ¹é…æ¨¡å¼(AEMC)ï¼›é»˜è®¤æ˜¯AEï¼ˆåŒ¹é…attributeã€elementç±»å‹æŒ‡ä»¤)ï¼›Må’ŒCä¸å¸¸ç”¨ 123456789101112131415angular.module('docsRestrictDirective', []).controller('Controller', ['$scope', function($scope) &#123; $scope.customer = &#123; name: 'Naomi', address: '1600 Amphitheatre' &#125;;&#125;]).directive('myCustomer', function() &#123; return &#123; restrict: 'E', templateUrl: 'my-customer.html' &#125;;&#125;);// ä»€ä¹ˆæƒ…å†µä¸‹è¯¥ç”¨å…ƒç´ åï¼Œä»€ä¹ˆæƒ…å†µä¸‹è¯¥ç”¨å±æ€§åï¼Ÿ å½“åˆ›å»ºä¸€ä¸ªå«æœ‰è‡ªå·±æ¨¡æ¿çš„ç»„ä»¶çš„æ—¶å€™ï¼Œå»ºè®®ä½¿ç”¨å…ƒç´ åï¼Œå¸¸è§æƒ…å†µæ˜¯ï¼Œå½“ä½ æƒ³ä¸ºä½ çš„æ¨¡æ¿åˆ›å»ºä¸€ä¸ªDSLï¼ˆç‰¹å®šé¢†åŸŸè¯­è¨€ï¼‰çš„æ—¶å€™ã€‚å¦‚æœä»…ä»…æƒ³ä¸ºå·²æœ‰çš„å…ƒç´ æ·»åŠ åŠŸèƒ½ï¼Œå»ºè®®ä½¿ç”¨å±æ€§å.// å½“éœ€è¦åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„ç»„ä»¶æ—¶-&gt;åˆ›å»ºEå‹æŒ‡ä»¤// ä¸ºå·²æœ‰å…ƒç´ æ·»åŠ æ–°åŠŸèƒ½-&gt;åˆ›å»ºAå‹æŒ‡ä»¤ isolate scope å­˜åœ¨åŸå› ï¼šè‹¥æ— ç‹¬ç«‹ä½œç”¨åŸŸï¼Œåˆ™åœ¨ä¸€ä¸ªä½œç”¨åŸŸä¸‹ï¼Œå¤šä¸ªæŒ‡ä»¤æ— æ³•ç‹¬ç«‹æ‰§è¡Œï¼›ä½¿ç”¨ç‹¬ç«‹ä½œç”¨åŸŸï¼Œå¯ä»¥å°†æŒ‡ä»¤é™åˆ¶åœ¨ç‹¬ç«‹çš„ä½œç”¨åŸŸä¸‹æ‰§è¡Œï¼Œäº’ä¸å¹²æ‰° åˆ›å»ºï¼šåœ¨åˆ›å»ºdirectiveæ—¶æŒ‡å®šscopeå±æ€§ 1234567891011angular.module('docsIsolateScopeDirective', []).controller('Controller', ['$scope', function($scope) &#123; $scope.naomi = &#123; name: 'Naomi', address: '1600 Amphitheatre' &#125;; $scope.igor = &#123; name: 'Igor', address: '123 Somewhere' &#125;;&#125;]).directive('myCustomer', function() &#123; return &#123; restrict: 'E', scope: &#123; customerInfo: '=info' // å°†customerInfoç»‘å®šåˆ°æŒ‡ä»¤æ‰€åœ¨å…ƒç´ çš„infoç‰¹æ€§ä¸Šï¼Œå¦‚æœå¤–é¢çš„ç‰¹æ€§ä¹Ÿå«customerInfoï¼Œåˆ™å¯ä»¥ç›´æ¥ä½¿ç”¨ç¼©å†™å½¢å¼"=" &#125;, templateUrl: 'my-customer-iso.html' &#125;;&#125;); ç‹¬ç«‹ä½œç”¨åŸŸä¼šéš”ç¦»é™¤ä½ æ·»åŠ åˆ°scope: {} å¯¹è±¡ä¸­çš„æ•°æ®æ¨¡å‹ä¹‹å¤–çš„ä¸€åˆ‡ä¸œè¥¿ã€‚ å› ä¸ºå®ƒå¯ä»¥é˜»æ­¢é™¤ä½ ä¼ å…¥çš„æ•°æ®æ¨¡å‹ä¹‹å¤–çš„ä¸€åˆ‡ä¸œè¥¿æ”¹å˜ä½ å†…éƒ¨æ•°æ®æ¨¡å‹çš„çŠ¶æ€ã€‚ å¦‚æœè¦ä½¿ä½ çš„ç»„ä»¶åœ¨åº”ç”¨èŒƒå›´å†…å¯é‡ç”¨ï¼Œé‚£ä¹ˆä½¿ç”¨scopeé€‰é¡¹å»åˆ›å»ºä¸€ä¸ªç‹¬ç«‹ä½œç”¨åŸŸ1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162&lt;!DOCTYPE html&gt;&lt;html lang="en" ng-app="myApp"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;div ng-controller="myController"&gt; &#123;&#123;books&#125;&#125; &lt;div book-list book-a="books" book-b="books" book-c="&#123;&#123;title&#125;&#125;"&gt;&lt;/div&gt; &lt;/div&gt; &lt;script type="text/javascript" src="js/angularjs.js"&gt;&lt;/script&gt; &lt;script&gt; angular.module('myApp', []).directive("bookList", function() &#123; return &#123; restrict: "EAMC", template: '&lt;div&gt;&lt;h1&gt;&#123;&#123;title&#125;&#125;&lt;/h1&gt;&lt;ul&gt;&lt;li ng-repeat="book in books"&gt;&#123;&#123;book.name&#125;&#125;&lt;/li&gt;&lt;/ul&gt; &lt;/div&gt;', // bookListæŒ‡ä»¤ä¸­åŒ…å«ä¸€ä¸ªbooAddæŒ‡ä»¤ replace: true, // scope: false,// scopeä¸ºç‹¬ç«‹ä½œç”¨åŸŸï¼Œå½“ä¸ºfalseï¼Œè¡¨ç¤ºç›´æ¥ä½¿ç”¨çˆ¶çº§ä½œç”¨åŸŸï¼Œä¸ºtrueï¼Œè¡¨ç¤ºåˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸå¹¶ç»§æ‰¿è‡ªçˆ¶ä½œç”¨åŸŸï¼›å½“scopeä¸ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œåˆ™è¡¨ç¤ºåˆ›å»ºäº†ä¸€ä¸ªä¸ç»§æ‰¿çˆ¶ä½œç”¨åŸŸçš„ç»§æ‰¿é“¾çš„ç‹¬ç«‹ä½œç”¨åŸŸ(å°±æ˜¯å¯ä»¥è®¿é—®åˆ°çˆ¶ä½œç”¨åŸŸï¼Œä½†æ˜¯æ— æ³•è®¿é—®åˆ°çˆ¶ä½œç”¨åŸŸä¹‹ä¸Šçš„ä½œç”¨åŸŸ) scope: &#123; // &amp;attrè¡¨ç¤ºä½œç”¨åŸŸå°†çˆ¶ä½œç”¨åŸŸçš„å±æ€§åŒ…è£…æˆä¸€ä¸ªå‡½æ•°ï¼Œä»è€Œä»¥å‡½æ•°çš„å½¢å¼è¯»å†™çˆ¶ä½œç”¨åŸŸçš„å±æ€§ï¼›ä¸€èˆ¬ç”¨åœ¨æ‰§è¡Œçˆ¶ä½œç”¨åŸŸä¸Šçš„æŸä¸ªäº‹ä»¶å¤„ç†å‡½æ•°ï¼›è‹¥ä½œç”¨åŸŸå’Œçˆ¶ä½œç”¨åŸŸçš„å±æ€§åç§°ä¸€è¦ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ç®€å†™å½¢å¼&amp;,@å’Œ=åŒç† a: "&amp;bookA" // ä¼šæŸ¥æ‰¾å½“å‰æŒ‡ä»¤åŒ¹é…çš„å…ƒç´ ä¸Šçš„bookAç‰¹æ€§ï¼Œç„¶åå–å¾—å€¼booksï¼Œå¹¶å°†booksåšä¸ºaè°ƒç”¨çš„è¿”å›å€¼è¿›è¡Œè¿”å›ï¼› // =atträ¼šå°†ä½œç”¨åŸŸä¸Šçš„å±æ€§å’Œçˆ¶çº§çš„ä½œç”¨åŸŸä¸Šçš„å±æ€§è¿›è¡ŒåŒå‘ç»‘å®šï¼Œä»»ä½•ä¸€æ–¹çš„ä¿®æ”¹éƒ½ä¼šä¿®æ”¹å¦å¤–ä¸€æ–¹ // b: "=bookB" // ä¼šæŸ¥æ‰¾å½“å‰æŒ‡ä»¤åŒ¹é…çš„å…ƒç´ ä¸Šçš„bookBç‰¹æ€§ï¼Œä¼šå°†å…¶å€¼å’Œbè¿›è¡ŒåŒå‘ç»‘å®š // @atträ»£è¡¨åªèƒ½è¯»å–çˆ¶çº§ä½œç”¨åŸŸä¸Šçš„å€¼ï¼Œå•å‘çš„ï¼Œå¹¶åªèƒ½è¯»å–ç®€å•å€¼ï¼Œå¼•ç”¨å€¼ä¸è¡Œï¼Œå› ä¸ºä»–æœ€ç»ˆå¾—åˆ°çš„åªä¼šæ˜¯ç®€å•å€¼ï¼› // c: "@bookC" &#125;, controller: function($scope) &#123; $scope.books = $scope.a(); console.log($scope.a()); // $scope.books = $scope.b; // $scope.b.push(&#123; // name: "nodeJs" // &#125;); // console.log($scope.b); // $scope.title = $scope.c; // console.log($scope.c); &#125;, &#125; &#125;).controller('myController', ['$scope', function($scope) &#123; $scope.books = [&#123; name: "php" &#125;, &#123; name: "js" &#125;, &#123; name: "java" &#125;]; $scope.title = "ä¹¦ç±"; &#125;]); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; compile ä¸»è¦ç”¨åœ¨DOMæ¸²æŸ“ä¹‹å‰( linkä¹‹å‰) æ”¹å˜DOMç»“æ„ï¼Œå¹¶ä¸éœ€è¦$scopeå‚æ•°ã€‚å®ƒå¿…é¡»è¿”å›ä¸€ä¸ªlinkå‡½æ•°ï¼Œå› æ­¤å¦‚æœæŒ‡ä»¤ä¸­compileå’Œlinkéƒ½å†™äº†ï¼Œåˆ™linkä¼šè¢«è¦†ç›–-&gt;ç”¨çš„æ¯”è¾ƒå°‘123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566&lt;!DOCTYPE html&gt;&lt;html lang="en" ng-app="myApp"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;Document&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;div ng-controller="myController"&gt; &lt;div ng-repeat="user in users" my-tag my-tag2&gt;&lt;/div&gt; &lt;/div&gt; &lt;script type="text/javascript" src="js/angularjs.js"&gt;&lt;/script&gt; &lt;script&gt; angular.module('myApp', []).directive('myTag', function() &#123; return &#123; restrict: "EAMC", template: '&lt;div&gt;&#123;&#123;user.name&#125;&#125;&lt;/div&gt;', replace: true, compile: function(tElement, tAttrs, transclude) &#123; // ä¸»è¦ç”¨æ¥åœ¨å®é™…æ¸²æŸ“ä¹‹å‰ä¿®æ”¹DOMç»“æ„ï¼Œcompileå¿…é¡»è¿”å›ä¸€ä¸ªlinkå‡½æ•° // console.log(tElement); //è¿”å›åŒ¹é…çš„å½“å‰ç±»jQueryå¯¹è±¡ // console.log(tAttrs); // è¿”å›tElementä¸Šçš„æ‰€æœ‰attr // console.log(transclude); // å¦‚æœæŒ‡ä»¤ä¸­transclueä¸ºtrueï¼Œåˆ™å®ƒè¿”å›çš„å°±æ˜¯è¢«transcludeçš„åŸå§‹æ•°æ® console.log("myTag ç¼–è¯‘é˜¶æ®µ"); // åœ¨å®é™…æ¸²æŸ“å‰å˜æ›´DOMç»“æ„ tElement.append(angular.element("&lt;h1&gt;test&lt;/h1&gt;")); return &#123; // è‹¥åœ¨compileä¸­ç›´æ¥returnä¸€ä¸ªå‡½æ•°ï¼Œåˆ™è¿”å›çš„æ˜¯postLinkå‡½æ•° pre: function(scope, iElement, iAttrs, controller) &#123; // preLinkæ˜¯åœ¨compileé˜¶æ®µç»“æŸåï¼Œlinké˜¶æ®µä¹‹å‰è§¦å‘ console.log("myTag preLink"); &#125;, post: function(scope, iElement, iAttrs, controller) &#123; // postLinkæ˜¯æŒ‡ä»¤linkåè§¦å‘ console.log("myTag postLink"); &#125; &#125; &#125;, link: function(scope, iElement, iAttrs, controller) &#123; // ä¸»è¦åœ¨linkä¸­è¿›è¡Œç»‘å®šäº‹ä»¶å’Œæ“çºµDOMï¼›ä¸€èˆ¬å®šä¹‰äº†compileï¼Œå°±ä¸ä¼šå®šä¹‰linkäº†;æ­¤å¤„çš„linkå…¶å®å°±æ˜¯compileä¸­postLink console.log("å› ä¸ºä¸Šé¢æ‰§è¡Œäº†ï¼Œcompileï¼Œæ‰€ä»¥æˆ‘ä¸ä¼šå†è¢«æ‰§è¡Œäº†"); &#125; &#125; &#125;).directive('myTag2', function() &#123; return &#123; restrict: "EAMC", compile: function(tElement, tAttrs, transclude) &#123; console.log("myTag2 ç¼–è¯‘é˜¶æ®µ"); return &#123; pre: function() &#123; console.log("myTag2 preLink"); &#125;, post: function() &#123; console.log("myTag2 postLink"); &#125; &#125; &#125; &#125; &#125;).controller("myController", ["$scope", function($scope) &#123; $scope.users = [&#123; id: 10, name: "å¼ ä¸‰" &#125;, &#123; id: 20, name: "æå››" &#125;]; &#125;]); &lt;/script&gt;&lt;/body&gt; &lt;/html&gt; link ä¸»è¦åœ¨è¿™é‡Œæ¥æ“ä½œDOMå’Œæ·»åŠ äº‹ä»¶ scope-&gt;æŒ‡ä»¤æ‰€å¤„çš„ä½œç”¨åŸŸ(å¦‚æœæœ‰ç‹¬ç«‹ä½œç”¨åŸŸï¼Œåˆ™ä¸ºç‹¬ç«‹ä½œç”¨åŸŸï¼Œå¦åˆ™å€¼ä¸ºçˆ¶çº§çš„ä½œç”¨åŸŸ); element-&gt;æŒ‡ä»¤æ‰€åŒ¹é…çš„é‚£ä¸ªå…ƒç´  attrs-&gt;æŒ‡ä»¤åŒ¹é…å…ƒç´ çš„æ‰€æœ‰ç‰¹æ€§çš„é›†åˆ controller-&gt;æŒ‡ä»¤éœ€è¦ä¾èµ–çš„controllerå®ä¾‹123456789101112131415161718192021222324252627282930angular.module('docsTimeDirective', []).controller('Controller', ['$scope', function($scope) &#123; $scope.format = 'M/d/yy h:mm:ss a';&#125;]).directive('myCurrentTime', ['$interval', 'dateFilter', function($interval, dateFilter) &#123; function link(scope, element, attrs) &#123; var format, timeoutId; function updateTime() &#123; element.text(dateFilter(new Date(), format)); &#125; scope.$watch(attrs.myCurrentTime, function(value) &#123; format = value; updateTime(); &#125;); element.on('$destroy', function() &#123; $interval.cancel(timeoutId); &#125;); // start the UI update process; save the timeoutId for canceling timeoutId = $interval(function() &#123; updateTime(); // update DOM &#125;, 1000); &#125; return &#123; link: link &#125;;&#125;]); replace-&gt;æ˜¯å¦æ›¿æ¢åŒ¹é…çš„å…ƒç´  è‹¥ä¸ºtrueåˆ™åœ¨æ‰¾åˆ°åŒ¹é…çš„å…ƒç´ åï¼Œä¼šç”¨æŒ‡ä»¤ä¸­çš„templateå†…å®¹æ›¿æ¢åŒ¹é…çš„å†…å®¹(åŒ…æ‹¬è¢«åŒ¹é…çš„å…ƒç´ )ï¼›é»˜è®¤æƒ…å†µä¸‹ï¼ŒæŒ‡ä»¤ä¼šåœ¨æ‰¾åˆ°åŒ¹é…çš„å…ƒç´ æ—¶ï¼Œä¼šå°†åŒ¹é…å…ƒç´ çš„å†…å®¹æ›¿æ¢ä¸ºæŒ‡ä»¤ä¸­templateçš„å†…å®¹ï¼› ä¸€èˆ¬åœ¨åŒ¹é…Eæ—¶ï¼Œä¼šé€‰æ‹©å°†å…¶è®¾ç½®ä¸ºtrueï¼Œå› ä¸ºä¸€èˆ¬Eå‹æŒ‡ä»¤éƒ½æ˜¯åˆ›å»ºæ–°æ ‡ç­¾ï¼Œæ˜¯ä¸ç¬¦åˆè§„èŒƒçš„ï¼Œæ‰€ä»¥ä¼šé€‰æ‹©å°†å…¶æ›¿æ¢ transclude-&gt;ä¸»è¦ç”¨æ¥å¤„ç†æŒ‡ä»¤åµŒå¥— é»˜è®¤æƒ…å†µä¸‹ï¼ŒæŒ‡ä»¤ä¼šæ›¿æ¢åŒ¹é…å…ƒç´ å†…éƒ¨çš„å†…å®¹ï¼Œè¿™æ ·å°±æ— æ³•å®ç°æŒ‡ä»¤çš„ç›¸äº’åµŒå¥—ä½¿ç”¨(åŸæŒ‡ä»¤çš„å†…å®¹ä¼šè¢«æ–°æŒ‡ä»¤å…¨éƒ¨æ›¿æ¢æ‰)ï¼› å½“è®¾ç½®transcludeä¸ºtrueæ—¶ï¼Œåˆ™å¯ä»¥ä¿ç•™åŸå…ˆçš„æŒ‡ä»¤æ¨¡æ¿ä»¥åŠå¯¹åº”çš„ä½œç”¨åŸŸï¼›æ³¨æ„ï¼Œåœ¨æ–°æŒ‡ä»¤çš„æ¨¡æ¿ä¸­è¦ç”¨ng-transcludeä¿ç•™è€æŒ‡ä»¤çš„å†…å®¹ï¼› 123456789101112// jsangular.module('docsTransclusionDirective', []).controller('Controller', ['$scope', function($scope) &#123; $scope.name = 'Tobias';&#125;]).directive('myDialog', function() &#123; return &#123; restrict: 'E', transclude: true, scope: &#123;&#125;, templateUrl: 'my-dialog.html' &#125;;&#125;);// my-dialog.html&lt;h1&gt;æ–°å†…å®¹&lt;/h1&gt;&lt;div class="alert" ng-transclude&gt;&lt;/div&gt; &lt;!-- æŒ‡å®šng-transclude --&gt; ä»…å½“ä½ è¦åˆ›å»ºä¸€ä¸ªåŒ…è£¹ä»»æ„å†…å®¹çš„æŒ‡ä»¤çš„æ—¶å€™ä½¿ç”¨transclude: true åˆ›å»ºä¸€ä¸ªåŒ…è£¹ä»»æ„å†…å®¹çš„dialogBox 12345678910111213141516171819202122232425262728293031323334353637// jsangular.module('docsIsoFnBindExample', []).controller('Controller', ['$scope', '$timeout', function($scope, $timeout) &#123; $scope.name = 'Tobias'; $scope.message = ''; $scope.hideDialog = function(message) &#123; $scope.message = message; $scope.dialogIsHidden = true; $timeout(function() &#123; $scope.message = ''; $scope.dialogIsHidden = false; &#125;, 2000); &#125;;&#125;]).directive('myDialog', function() &#123; return &#123; restrict: 'E', transclude: true, scope: &#123; 'close': '&amp;onClose' // &amp;prop ç”¨æ¥ç»‘å®šä¸€ä¸ªå‡½æ•°åˆ°ç‹¬ç«‹ä½œç”¨åŸŸï¼Œå…è®¸ç‹¬ç«‹ä½œç”¨åŸŸè°ƒç”¨å®ƒï¼ŒåŒæ—¶ä¿ç•™äº†å‡½æ•°çš„åŸæ¥ä½œç”¨åŸŸï¼›å½“ä½ çš„æŒ‡ä»¤æƒ³è¦å¼€æ”¾ä¸€ä¸ªAPIå»ç»‘å®šç‰¹å®šçš„è¡Œä¸ºï¼Œåœ¨scopeé€‰é¡¹ä¸­ä½¿ç”¨&amp;propã€‚ &#125;, templateUrl: 'my-dialog-close.html' &#125;;&#125;);// html&lt;div ng-controller="Controller"&gt; &#123;&#123;message&#125;&#125; &lt;my-dialog ng-hide="dialogIsHidden" on-close="hideDialog(message)"&gt; Check out the contents, &#123;&#123;name&#125;&#125;! &lt;/my-dialog&gt;&lt;/div&gt;// my-dialog-close.html&lt;div class="alert"&gt; &lt;a href class="close" ng-click="close(&#123;message: 'closing for now'&#125;)"&gt;&amp;times;&lt;/a&gt; &lt;div ng-transclude&gt;&lt;/div&gt; &lt;!-- ä¿ç•™åŸå…ˆæŒ‡ä»¤å†…å®¹ --&gt;&lt;/div&gt; åˆ›å»ºæ·»åŠ äº‹ä»¶çš„æŒ‡ä»¤ 12345678910111213141516171819202122232425262728293031323334353637angular.module('dragModule', []).directive('myDraggable', ['$document', function($document) &#123; return &#123; link: function(scope, element, attr) &#123; // åœ¨linkä¸­ä¸ºæŒ‡ä»¤åŒ¹é…çš„å…ƒç´ elementç»‘å®šäº‹ä»¶ var startX = 0, startY = 0, x = 0, y = 0; element.css(&#123; position: 'relative', border: '1px solid red', backgroundColor: 'lightgrey', cursor: 'pointer' &#125;); element.on('mousedown', function(event) &#123; // Prevent default dragging of selected content event.preventDefault(); startX = event.pageX - x; startY = event.pageY - y; $document.on('mousemove', mousemove); $document.on('mouseup', mouseup); &#125;); function mousemove(event) &#123; y = event.pageY - startY; x = event.pageX - startX; element.css(&#123; top: y + 'px', left: x + 'px' &#125;); &#125; function mouseup() &#123; $document.off('mousemove', mousemove); $document.off('mouseup', mouseup); &#125; &#125; &#125;;&#125;]); controller-&gt;æŒ‡ä»¤ä¸­çš„controllerå±æ€§å¯ä»¥ç”¨æ¥å®ŒæˆæŒ‡ä»¤é—´çš„ç›¸äº’é€šä¿¡ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364// jsangular.module('docsTabsExample', []).directive('myTabs', function() &#123; return &#123; restrict: 'E', transclude: true, scope: &#123;&#125;, controller: ['$scope', function MyTabsController($scope) &#123; var panes = $scope.panes = []; $scope.select = function(pane) &#123; angular.forEach(panes, function(pane) &#123; pane.selected = false; &#125;); pane.selected = true; &#125;; this.addPane = function(pane) &#123;// è¿™ä¸ªæ–¹æ³•éœ€è¦æš´éœ²ç»™å…¶ä»–æŒ‡ä»¤ç”¨ if (panes.length === 0) &#123; $scope.select(pane); &#125; panes.push(pane); &#125;; &#125;], templateUrl: 'my-tabs.html' &#125;;&#125;).directive('myPane', function() &#123; return &#123; require: '^^myTabs', // ä¾èµ–ä¸€ä¸ªmyTabsæ§åˆ¶å™¨ï¼Œå¹¶åœ¨æŒ‡ä»¤çš„çˆ¶å…ƒç´ ä¸ŠæŸ¥æ‰¾è¿™ä¸ªæ§åˆ¶å™¨ restrict: 'E', transclude: true, scope: &#123; title: '@' // ç›¸å½“äº@title &#125;, link: function(scope, element, attrs, tabsCtrl) &#123; tabsCtrl.addPane(scope); &#125;, templateUrl: 'my-pane.html' &#125;;&#125;);// index.html&lt;my-tabs&gt; &lt;my-pane title="Hello"&gt; &lt;p&gt;Lorem ipsum dolor sit amet&lt;/p&gt; &lt;/my-pane&gt; &lt;my-pane title="World"&gt; &lt;em&gt;Mauris elementum elementum enim at suscipit.&lt;/em&gt; &lt;p&gt;&lt;a href ng-click="i = i + 1"&gt;counter: &#123;&#123;i || 0&#125;&#125;&lt;/a&gt;&lt;/p&gt; &lt;/my-pane&gt;&lt;/my-tabs&gt;// tabs&lt;div class="tabbable"&gt; &lt;ul class="nav nav-tabs"&gt; &lt;li ng-repeat="pane in panes" ng-class="&#123;active:pane.selected&#125;"&gt; &lt;a href="" ng-click="select(pane)"&gt;&#123;&#123;pane.title&#125;&#125;&lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;div class="tab-content" ng-transclude&gt;&lt;/div&gt;&lt;/div&gt;// panel&lt;div class="tab-pane" ng-show="selected"&gt; &lt;h4&gt;&#123;&#123;title&#125;&#125;&lt;/h4&gt; &lt;div ng-transclude&gt;&lt;/div&gt;&lt;/div&gt; å½“ä½ æƒ³æš´éœ²ä¸€ä¸ªAPIç»™å…¶å®ƒçš„æŒ‡ä»¤è°ƒç”¨é‚£å°±ç”¨controller,å¦åˆ™ç”¨linkã€‚ controllerAs-&gt;ç»™æŒ‡ä»¤ä¸­çš„controllerèµ·ä¸ªåˆ«åï¼Œå¹¶å¯åšcontrollerä¸­çš„ç¬¬å››ä¸ªå‚æ•°ä¼ å…¥ priority-&gt;è®¾ç½®æŒ‡ä»¤æ‰§è¡Œçš„ä¼˜å…ˆçº§é¡ºåº(æƒé‡)ï¼›å¤šä¸ªæŒ‡ä»¤æ—¶ï¼Œngå¿…é¡»çŸ¥é“å“ªä¸ªå…ˆæ‰§è¡Œï¼›é»˜è®¤ng-repeatä¼˜å…ˆçº§å¾ˆé«˜ï¼Œä¸º1000ï¼›-&gt;ä¸å¸¸ç”¨ terminal-&gt;æ˜¯å¦è®¾ç½®å½“å‰æŒ‡ä»¤çš„æƒé‡priority ä¸ºç»“æŸç•Œé™ï¼›è‹¥ä¸ºtrueï¼Œåˆ™èŠ‚ç‚¹ä¸Šå°äºå½“å‰æŒ‡ä»¤æƒé‡priorityçš„æŒ‡ä»¤ä¸ä¼šè¢«æ‰§è¡Œï¼Œç›¸åŒæƒé‡çš„ä¼šæ‰§è¡Œ require-&gt;å¯ä»¥å°†å…¶ä»–æŒ‡ä»¤ä¼ ç»™è‡ªå·±ï¼Œæœ‰ä»¥ä¸‹å€¼ directiveName-&gt;é»˜è®¤å€¼ï¼Œä¼šä»åŒä¸€ä¸ªå…ƒç´ ä¸ŠæŸ¥æ‰¾ ^directiveName-&gt;ä¼šåœ¨çˆ¶çº§ä¸ŠæŸ¥æ‰¾ ?directiveName-&gt;è¡¨ç¤ºæŒ‡ä»¤æ˜¯å¯é€‰çš„ï¼Œæ‰¾ä¸åˆ°ä¹Ÿä¸ä¼šæŠ›å‡ºå¼‚å¸¸ Animations å¯å‚è€ƒhttps://css-tricks.com/animations-the-angular-way/ æ— éœ€å¼•å…¥ä»»ä½•æ¨¡å—ï¼Œç›´æ¥åˆ©ç”¨åˆ‡æ¢classé…åˆcssçš„è¿‡æ¸¡ï¼Œæ¥å®ç°è¿‡æ¸¡åŠ¨ç”»-&gt;æ— æ³•åšåˆ°å…¨å…¼å®¹ï¼›-&gt;https://codepen.io/bdsimmons/pen/NqYjaV angualrä¸­å†…ç½®äº†$animateæœåŠ¡ï¼Œå¯ä»¥æä¾›ç®€å•çš„åŠ¨ç”»æ“ä½œï¼Œenterã€leaveâ€¦-&gt;æ ¸å¿ƒæ–¹æ³•ï¼ŒngAnimateæ¨¡å—ä¹Ÿä¾èµ–è¿™ä¸ªæ ¸å¿ƒæœåŠ¡ æ›´å¼ºå¤§çš„åŠ¨ç”»-&gt;å¼•å…¥ngAnimateæ¨¡å—ï¼›angualræ²¡æœ‰ç›´æ¥åŒ…å«åŠ¨ç”»æ¨¡å—(ngAnimate)ï¼Œéœ€è¦åœ¨å¼•å…¥angular.jsåå¼•å…¥angular-animate.js é‡ç‚¹ï¼šngAnimateåŠ¨ç”»çš„æ ¸å¿ƒéƒ½æ˜¯åŸºäºcssï¼Œé€šè¿‡å˜æ¢å…ƒç´ çš„classç±»é…åˆè¿‡æ¸¡å’Œanimationè¿›è€Œå®ç°åŠ¨ç”»ï¼ŒjsåŠ¨ç”»é™¤å¤– å¦‚ä½•ä½¿ç”¨ngAnimateæ¨¡å— æ•´ä¸ªappæ²¡æœ‰æ¨¡å—ï¼Œåˆ™å¯ä»¥ç›´æ¥æŒ‡å®šng-app=â€ngAnimateâ€æ¥ä»ngAnimateæ¨¡å—å¯åŠ¨appï¼Œä¹Ÿèƒ½æœ‰åŠ¨ç”»æ•ˆæœï¼›-&gt;ä¸æ¨è-&gt;http://www.runoob.com/try/try.php?filename=try_ng_animation å½“åšæ¨¡å—ä¾èµ–æ¥ä½¿ç”¨-&gt;var app=angular.module(â€œmyAppâ€,[â€œngAnimateâ€]); å½“å¼•å…¥ngAnimateæ¨¡å—åï¼Œå°±ä¼šè‡ªåŠ¨åœ¨ä¸€äº›æŒ‡ä»¤æ‰§è¡Œçš„ç‰¹æ®Šæ—¶æœºï¼Œä¸ºå…ƒç´ æ·»åŠ ä¸Šå¯¹åº”çš„classç±»ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªé…åˆcsså®ç°åŠ¨ç”» cssè¿‡æ¸¡åŠ¨ç”»-&gt;éœ€è¦è®¾ç½®åŠ¨ç”»çš„èµ·ç‚¹ã€ç»ˆç‚¹çš„åŠ¨ç”»å±æ€§å€¼ï¼›ä¾‹å¦‚åœ¨.ng-enterä¸Šè®¾ç½®è¿‡æ¸¡åŠ¨ç”»åˆå§‹å€¼ï¼Œåœ¨.ng-enter-activeä¸Šè®¾ç½®è¿‡æ¸¡åŠ¨ç”»ç»ˆç‚¹å€¼-&gt;https://codepen.io/bdsimmons/pen/OPmNxXs css3Animation-&gt;css3Animtionsï¼Œæ— éœ€åœ¨2ä¸ªclassä¸Šè®¾ç½®åŠ¨ç”»ï¼Œåªéœ€è¦åœ¨ä¸€ä¸ªclassä¸Šè®¾ç½®åŠ¨ç”»ï¼Œå¹¶ç»™å®šåŠ¨ç”»æ—¶é—´å³å¯ï¼Œæ‰€ä»¥å¦‚ä¸Šé¢çš„åªéœ€è¦åœ¨.ng-enterä¸Šè®¾ç½®ä¸€ä¸ªanimationåŠ¨ç”»å³å¯ï¼Œæ— éœ€åœ¨ng-enter-activeåœ¨è®¾ç½®åŠ¨ç”»-&gt;https://codepen.io/anon/pen/NjJLMZ JSåŠ¨ç”»-&gt;å½“å¼•å…¥ngAnimateæ¨¡å—å å°±è‡ªåŠ¨åœ¨appä¸Šæ·»åŠ äº†animationæ–¹æ³•ï¼Œapp.animation()ï¼›å¯ä»¥é€šè¿‡animationæ–¹æ³•ï¼Œå®ç°åŠ¨ç”»-&gt;https://codepen.io/bdsimmons/pen/YXLZEw Module åŸºæœ¬ç”¨æ³• åˆ›å»ºæ¨¡å—-&gt;ç”¨angular.module(â€œmoduleNameâ€,[â€œä¾èµ–çš„æ¨¡å—â€]); è·å–å·²æœ‰æ¨¡å—-&gt;ç”¨angular.module(â€œmoduleNameâ€);æ³¨æ„è·å–æ—¶ï¼Œæ²¡æœ‰åé¢çš„ä¾èµ–æ•°ç»„ è®©æ¨¡å—è¿ä½œèµ·æ¥ å£°æ˜ä¸€ä¸ªmodule,ç„¶ååœ¨ng-appä¸­å¼•ç”¨å®ƒï¼Œå³å¯è®©appä»moduleä¸­å¼€å§‹è¿è¡Œ æ¨¡å—åˆ’åˆ† æœåŠ¡æ¨¡å— æŒ‡ä»¤æ¨¡å— è¿‡æ»¤å™¨æ¨¡å— ä¸€ä¸ªåº”ç”¨çš„æ¨¡å—ï¼Œä¾èµ–äºä¸Šè¿°çš„ä¸‰ä¸ªæ¨¡å—ï¼Œè€Œä¸”åŒ…å«åº”ç”¨çš„åˆå§‹åŒ–åŠå¯åŠ¨ä»£ç 12345678910111213141516171819202122232425262728293031323334angular.module('xmpl.service', []) // æœåŠ¡ .value('greeter', &#123; salutation: 'Hello', localize: function(localization) &#123; this.salutation = localization.salutation; &#125;, greet: function(name) &#123; return this.salutation + ' ' + name + '!'; &#125; &#125;) .value('user', &#123; load: function(name) &#123; this.name = name; &#125; &#125;);angular.module('xmpl.directive', []); // directiveangular.module('xmpl.filter', []);// filterangular.module('xmpl', ['xmpl.service', 'xmpl.directive', 'xmpl.filter']) // xmplä¾èµ–serviceã€directiveã€filter .run(function(greeter, user) &#123; // åˆå§‹åŒ– // This is effectively part of the main method initialization code greeter.localize(&#123; salutation: 'Bonjour' &#125;); user.load('World'); &#125;) .controller('XmplController', function($scope, greeter, user)&#123; $scope.greeting = greeter.greet(user.name); &#125;); æ¨¡å—æ˜¯é…ç½®ä»£ç å—å’Œè¿è¡Œä»£ç å—çš„é›†åˆ é…ç½®ä»£ç å—config-&gt;åœ¨ provider æ³¨å†Œå’Œé…ç½®é˜¶æ®µæ‰§è¡Œï¼ˆæ³¨ï¼šprovider æ˜¯ ng æœåŠ¡çš„ä¸€ç§ï¼‰ã€‚åªæœ‰ provider å’Œ constant å¯ä»¥è¢«æ³¨å…¥é…ç½®ä»£ç å—ã€‚è¿™æ˜¯ä¸ºäº†é˜²æ­¢æœåŠ¡åœ¨å®Œå…¨é…ç½®å¥½ä¹‹å‰è¢«æ„å¤–åœ°åˆå§‹åŒ–ã€‚-&gt;configä¸ºé…ç½® æ‰§è¡Œä»£ç å—run-&gt;åœ¨ injector è¢«åˆ›å»ºåæ‰§è¡Œï¼Œè¢«ç”¨æ¥å¯åŠ¨æ•´ä¸ªåº”ç”¨ã€‚åªæœ‰æœåŠ¡çš„å®ä¾‹å¯¹è±¡ä»¥åŠ constant å¯ä»¥è¢«æ³¨å…¥åˆ°æ‰§è¡Œä»£ç å—ã€‚è¿™æ˜¯ä¸ºäº†é˜²æ­¢åœ¨åº”ç”¨æ‰§è¡ŒæœŸé—´ç³»ç»Ÿçš„æ›´è¿›ä¸€æ­¥çš„é…ç½®ã€‚-&gt;runä¸ºåˆå§‹åŒ– 123456789angular.module('myModule', []). config(function(injectables) &#123; // providerå‹æ³¨å…¥å™¨ // è¿™æ˜¯é…ç½®(config)ä»£ç å—çš„èŒƒä¾‹ï¼Œä½ å¯ä»¥æœ‰ä»»æ„å¤šä¸ªé…ç½®ä»£ç å— // é…ç½®å—ä¸­ä½ åªèƒ½æ³¨å…¥Providerç±»ï¼ˆæ³¨æ„ï¼šä¸æ˜¯ç”±Providerç±»ç”Ÿæˆçš„å®ä¾‹ï¼‰ä»¥åŠ`constant` &#125;). run(function(injectables) &#123; // instanceå‹æ³¨å…¥å™¨ // è¿™æ˜¯è¿è¡Œ(run)ä»£ç å—çš„èŒƒä¾‹ï¼Œä½ å¯ä»¥æœ‰ä»»æ„ä¸ªè¿è¡Œä»£ç å— // è¿è¡Œå—ä¸­ä½ åªèƒ½æ³¨å…¥Providerå®ä¾‹ï¼ˆæ³¨æ„ï¼šä¸æ˜¯Providerç±»ï¼‰ &#125;); é…ç½®ä»£ç å—çš„å¿«æ·æ–¹æ³• 123456789101112131415161718192021222324angular.module('myModule', []).value('a', 123).factory('a', function() &#123; return 123; &#125;).directive('directiveName', ...).filter('filterName', ...);// ç­‰åŒäºangular.module('myModule', []).config(function($provide, $compileProvider, $filterProvider) &#123; $provide.value('a', 123); $provide.factory('a', function() &#123; return 123; &#125;); $compileProvider.directive('directiveName', ...); $filterProvider.register('filterName', ...);&#125;);//.configç­‰åŒäºè®¾ç½®moduleå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°angular.module("myModule",[],["$provide","$compileProvider","$filterProvier",function(provide,compileProvier,filterProvider)&#123; provide.value('a', 123); provide.factory('a', function() &#123; return 123; &#125;); compileProvider.directive('directiveName', ...); filterProvider.register('filterName', ...); &#125;]); é…ç½®è¯­å¥çš„æ‰§è¡Œé¡ºåºå°±æ˜¯æ ¹æ®å®ƒä»¬æ³¨å†Œçš„é¡ºåºè€Œå®šçš„ã€‚å”¯ä¸€çš„ä¾‹å¤–æ˜¯ constant çš„å®šä¹‰ï¼Œå®ƒä¼šè¢«è°ƒæ•´åˆ°æ‰€æœ‰é…ç½®å—çš„æœ€å‰é¢æ‰§è¡Œã€‚ æ‰§è¡Œä»£ç å— æ‰§è¡Œä»£ç å—æ˜¯ ng ä¸­æœ€æ¥è¿‘ main å‡½æ•°çš„ä¸€ä¸ªä¸œè¥¿ã€‚æ‰§è¡Œä»£ç å—æ˜¯åº”ç”¨å¯åŠ¨æ—¶è¿è¡Œçš„ä»£ç ã€‚å®ƒåœ¨æ‰€æœ‰çš„æœåŠ¡è¢«é…ç½®å¥½ä»¥åŠ æ³¨å…¥å™¨(injector)è¢«åˆ›å»ºå¥½ä¹‹åæ‰§è¡Œã€‚é€šå¸¸ï¼Œæ‰§è¡Œä»£ç å—åŒ…å«çš„ä»£ç éƒ½å¾ˆéš¾è¿›è¡Œå•å…ƒæµ‹è¯•ï¼Œæ­£å› ä¸ºå¦‚æ­¤ï¼Œå®ƒé€šå¸¸åº”è¯¥è¢«ä¸¢åœ¨ä¸€ä¸ªå•ç‹¬çš„æ¨¡å—ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥åœ¨å•å…ƒæµ‹è¯•æ—¶å¿½ç•¥å®ƒã€‚ æ¨¡å—ä¾èµ– Aä¾èµ–Bï¼Œåˆ™Açš„é…ç½®é˜¶æ®µè¦åœ¨Bçš„é…ç½®é˜¶æ®µå®Œæˆåè¿›è¡Œï¼Œæ‰§è¡Œé˜¶æ®µåŒç†ï¼ŒAçš„æ‰§è¡Œè¦åœ¨Bçš„æ‰§è¡Œç»“æŸåã€‚ æ³¨æ„æ¯ä¸ªæ¨¡å—åªèƒ½è¢«åŠ è½½ä¸€æ¬¡ï¼Œå³ä½¿æœ‰å¤šä¸ªåˆ«çš„æ¨¡å—ä¾èµ–å®ƒã€‚ IEå…¼å®¹æ€§ 1.3åŠä»¥ä¸Šä¸å†æ”¯æŒIE8-&gt;æ‰€ä»¥å¦‚æœéœ€è¦æ”¯æŒIE8ï¼Œè¯·ä½¿ç”¨ng1.2.x-&gt;1.2çš„æœ€æ–°ç‰ˆæœ¬ä¸º1.2.32 IE7åŠä»¥ä¸‹ä¸æ”¯æŒJSON.stringify-&gt;ä½¿ç”¨json2.js 123&lt;!--[if lte IE 7]&gt; &lt;script src="/path/to/json2.js"&gt;&lt;/script&gt;&lt;![endif]--&gt; åœ¨æ ¹å…ƒç´ ä¸Šæ·»åŠ id=â€ng-appâ€å¹¶ç»“åˆng-app=â€xxModuleâ€æ¥å¯åŠ¨app 1234&lt;!doctype html&gt;&lt;html xmlns:ng="http://angularjs.org" id="ng-app" ng-app="optionalModuleName"&gt; ...&lt;/html&gt; ä¸è¦ä½¿ç”¨è‡ªå®šä¹‰èŠ‚ç‚¹ å¦‚ng:viewï¼Œç”¨attributeæ–¹å¼ä»£æ›¿å¦‚ng-view å¦‚æœä½ ç”±äºè¯­ä¹‰æˆ–è€…ç¬¬ä¸‰æ–¹çš„Angularç»„ä»¶éœ€è¦ä½¿ç”¨tagçš„æ–¹å¼çš„è¯,é‚£ä¹ˆä½ å¿…é¡»æŒ‰ç…§å¦‚ä¸‹æ­¥éª¤ make IE happy 1234567891011121314151617181920&lt;!doctype html&gt;&lt;html xmlns:ng="http://angularjs.org" id="ng-app" ng-app="optionalModuleName"&gt;&lt;head&gt;&lt;!--[if lte IE 8]&gt; &lt;script&gt; document.createElement('ng-include'); document.createElement('ng-pluralize'); document.createElement('ng-view'); // Optionally these for CSS document.createElement('ng:include'); document.createElement('ng:pluralize'); document.createElement('ng:view'); &lt;/script&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body&gt;...&lt;/body&gt;&lt;/html&gt; é‡è¦çš„éƒ¨åˆ†: xmlns:ng- å‘½åç©ºé—´ - ä½ éœ€è¦ä¸ºæ¯ä¸€ä¸ªå°†ä½¿ç”¨çš„è‡ªå®šä¹‰tagæ³¨å†Œä¸€ä¸ªå‘½åç©ºé—´(è¯‘è€…æ³¨:IEä½œä¸ºä¸¥æ ¼xmlæ¨¡å¼è§£æ). document.createElement(yourTagName) - è‡ªå®šä¹‰èŠ‚ç‚¹åˆ›å»º - ç”±äºè¿™åªæ˜¯è€ç‰ˆæœ¬çš„IE issuesï¼Œæ‰€ä»¥ä½ éœ€è¦æŒ‰æ¡ä»¶åŠ è½½è¿™äº›è„šæœ¬(IEä½ç‰ˆæœ¬ç‰¹æœ‰çš„æ¡ä»¶æ³¨é‡Š)ã€‚å¯¹äºæ¯ä¸€ä¸ªéœ€è¦ä½¿ç”¨çš„æ²¡æœ‰æ³¨å†Œå‘½åç©ºé—´ä»¥åŠéHTMLå®šä¹‰çš„tagä½ éœ€è¦åˆ©ç”¨å®ƒæ¥é¢„ç”³æ˜æ¥make IE happyã€‚ IEåœ¨å¤„ç†å…³äºéæ ‡å‡†HTML tag çš„é—®é¢˜ä¸»è¦ç”±ä¸¤ç±»ï¼Œæ¯ç§ç±»å‹åˆå…¶è‡ªå·±çš„ä¿®å¤æ–¹å¼. If the tag name starts with my: prefix then it is considered an XML namespace and must have corresponding namespace declaration on ä»¥my:ä¸ºå‰ç¼€çš„tag è€ƒè™‘åˆ°ä¸¥æ ¼çš„XMLå‘½åç©ºé—´ï¼Œä½ å¿…é¡»æœ‰ç›¸åº”çš„å‘½åç©ºé—´ç”³æ˜,å¦‚ã€‚ If the tag has no : but it is not a standard HTML tag, then it must be pre-created using document.createElement(â€˜my-tagâ€™) æ²¡æœ‰:çš„éæ ‡å‡†HTML tag, ä½ éœ€è¦ä½¿ç”¨document.createElement(&#39;my-tag&#39;)æ¥é¢„ç”³æ˜æ”¹èŠ‚ç‚¹(è¯‘è€…æ³¨:ie-shv)ã€‚ If you are planning on styling the custom tag with CSS selectors, then it must be pre-created using document.createElement(&#39;my-tag&#39;) regardless of XML namespace. å¦‚æœä½ å¸Œæœ›é‡‡ç”¨CSSé€‰æ‹©å™¨çš„æ–¹å¼ï¼Œé‚£ä¹ˆä½ éœ€è¦ä½¿ç”¨document.createElement(&#39;my-tag&#39;)é¢„ç”³æ˜ï¼Œå¿½ç•¥XMLå‘½åç©ºé—´ã€‚ ä½¿ç”¨ng-styleä»£æ›¿style=;åè€…åœ¨&lt;IE11çš„ç‰ˆæœ¬ä¸Šæ— æ³•è¿è¡Œ Angualrä¼šåœ¨æ‰§è¡Œçš„æŸäº›æ—¶é—´ç‚¹ä¸ºæ ‡ç­¾æ·»åŠ ä¸Šä¸€äº›æ ‡è¯†ç”¨çš„classç±» ng-scopeæ ·å¼ç±»ä¼šåœ¨åˆ›å»ºäº†æ–°ä½œç”¨åŸŸ(Scope)çš„HTMLå…ƒç´ ä¸Šç”Ÿæˆ ng-bindingæ ·å¼ç±»ä¼šåœ¨ng-bind æˆ– ç»‘å®šäº†ä»»ä½•æ•°æ®çš„å…ƒç´ ä¸Šç”Ÿæˆ ng-invalidã€ng-validæ ·å¼ç±»ä¼šåœ¨è¿›è¡Œäº†éªŒè¯æ“ä½œçš„æ‰€æœ‰inputç»„ä»¶å…ƒç´ ä¸Šç”Ÿæˆ ng-pristineã€ng-dirty angularçš„inputæŒ‡ä»¤ç»™æ‰€æœ‰æ–°çš„ã€è¿˜æ²¡æœ‰ä¸ç”¨æˆ·äº¤äº’çš„inputå…ƒç´ é™„åŠ ä¸Šng-pristineç±»ï¼Œå½“ç”¨æˆ·æœ‰ä»»ä½•è¾“å…¥æ—¶ï¼Œåˆ™é™„åŠ ä¸Š ng-dirty. å›½é™…åŒ–I18nå’Œæœ¬åœ°åŒ–L10n å¼•å…¥ç‰¹å®šçš„è¯­è¨€åŒ… 12345678&lt;html ng-app&gt;&lt;head&gt;â€¦. &lt;script src="angular.js"&gt;&lt;/script&gt; &lt;script src="i18n/angular-locale_zh-cn.js"&gt;&lt;/script&gt;â€¦.&lt;/head&gt;&lt;/html&gt; å¯åŠ¨å³bootstrap(è¿™é‡Œbootstrapå¹¶éæŒ‡uiåº“ï¼Œbootstrapæœ¬èº«å°±æœ‰å¯åŠ¨çš„æ„æ€) è‡ªåŠ¨å¯åŠ¨ åœ¨angularè¦æ§åˆ¶çš„èŒƒå›´æœ€å¤–å±‚å…ƒç´ ä¸Šæ·»åŠ ng-appæŒ‡ä»¤ è‹¥æœªæŒ‡å®šng-appçš„å…·ä½“å€¼ï¼Œä¼šä»é»˜è®¤æ¨¡å—å¼€å§‹å¯åŠ¨ï¼›è‹¥æŒ‡å®šäº†åˆ™ä»æŒ‡å®šæ¨¡å—ä¸Šå¯åŠ¨ è‹¥éœ€æ”¯æŒIE7ï¼Œåˆ™è¿˜ä¸Šåœ¨ng-appé™¤æ·»åŠ id=â€ng-appâ€ è‹¥éœ€æ”¯æŒè€å¼ng:é£æ ¼çš„æŒ‡ä»¤ï¼Œåˆ™è¿˜éœ€è¦åœ¨htmlä¸Šæ·»åŠ xmlå‘½åç©ºé—´ 1&lt;html xmlns:ng="http://angularjs.org"&gt; æ‰‹åŠ¨å¯åŠ¨ ä½¿ç”¨angular.bootstrap 1234567891011121314151617181920&lt;!doctype html&gt;&lt;html&gt;&lt;body&gt; &lt;div ng-controller="MyController"&gt; Hello &#123;&#123;greetMe&#125;&#125;! &lt;/div&gt; &lt;script src="http://code.angularjs.org/snapshot/angular.js"&gt;&lt;/script&gt; &lt;script&gt; angular.module('myApp', []) .controller('MyController', ['$scope', function ($scope) &#123; $scope.greetMe = 'World'; &#125;]); angular.element(document).ready(function() &#123; angular.bootstrap(document, ['myApp']); // æ‰‹åŠ¨å¯åŠ¨ &#125;); &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; bootstrapè¦åœ¨éœ€è¦çš„moduleåˆ›å»ºæˆ–åŠ è½½å®Œæˆåï¼Œæ‰èƒ½è°ƒç”¨ å½“æ‰‹åŠ¨å¯åŠ¨appæ—¶ï¼Œå°±ä¸åº”å½“åœ¨ç”¨ng-appæŒ‡ä»¤äº† å®‰å…¨æ€§ ä¸è¦æ··ç”¨å‰å°å’Œåå°çš„æ¨¡æ¿ ä¸è¦ä½¿ç”¨ç”¨æˆ·çš„è¾“å…¥åŠ¨æ€ç”Ÿæˆæ¨¡æ¿ Do not run user input through $scope.$eval è€ƒè™‘ä½¿ç”¨ngCSPæ¨¡å— Providers injectorå¯ä»¥åˆ›å»ºä¸¤ç§å¯¹è±¡ ä¸“æœ‰å¯¹è±¡-&gt;angularæ¡†æ¶æä¾›çš„ï¼Œå¦‚controllerã€filterã€directivesç­‰ æœåŠ¡-&gt;æœåŠ¡çš„APIç”±å¼€å‘äººå‘˜è‡ªå·±åˆ¶å®š-&gt;è¯´æ˜æœåŠ¡å¯ä»¥è‡ªå·±å®šåˆ¶ injectoréœ€è¦çŸ¥é“å¦‚ä½•åˆ›å»ºæœåŠ¡ï¼Œå®ƒéœ€è¦ä¸€ä¸ªâ€å›¾çº¸â€ å›¾çº¸providerã€factoryã€serviceã€valueã€constant æœ€åº•å±‚çš„å›¾çº¸æ˜¯providerï¼Œå…¶ä½™å››ç§å›¾çº¸éƒ½æ˜¯åŸºäºproviderçš„è¯­æ³•ç³–ï¼ˆåœ¨providerä¸Šåˆå°è£…äº†ä¸€å±‚ï¼‰ valueå›¾çº¸ ç”¨æ¥åˆ›å»ºå¯åœ¨è¿è¡Œé˜¶æ®µä½¿ç”¨çš„å¸¸é‡ 1234567891011var myApp = angular.module('myApp', []);myApp.value('clientId', 'a12345654321x');myApp.controller('DemoController', ['clientId', function DemoController(clientId) &#123; this.clientId = clientId;&#125;]);&lt;html ng-app="myApp"&gt; &lt;body ng-controller="DemoController as demo"&gt; Client ID: &#123;&#123;demo.clientId&#125;&#125;&lt;/body&gt;&lt;/html&gt; factoryå›¾çº¸ å¯ä»¥åˆ›å»ºä»»ä½•ç±»å‹çš„æœåŠ¡ factoryå›¾çº¸ç›¸è¾ƒvalueå›¾çº¸å¢åŠ äº†ä¸‹é¢åŠŸèƒ½ å¯ä»¥æœ‰ä¾èµ– æœåŠ¡åˆå§‹åŒ– å»¶è¿Ÿ/æƒ°æ€§åˆå§‹åŒ– factoryå›¾çº¸é€šè¿‡ä¸€ä¸ªæ‹¥æœ‰0ï½nä¸ªå‚æ•°(å‚æ•°è¡¨ç¤ºè¯¥æœåŠ¡å¯¹å…¶ä»–æœåŠ¡çš„ä¾èµ–)çš„å‡½æ•°æ¥åˆ›å»ºæœåŠ¡ï¼Œè€Œå‡½æ•°è¿”å›å€¼å°±æ˜¯factoryå›¾çº¸åˆ›å»ºçš„æœåŠ¡å®ä¾‹ã€‚ 123myApp.factory('clientId', function clientIdFactory() &#123; return 'a12345654321x';// è¿”å›çš„æ˜¯æœåŠ¡çš„å®ä¾‹ï¼Œä¸è¿‡è¿™é‡ŒclientIdæ˜¯ä¸€ä¸ªå¸¸é‡ï¼Œæ‰€ä»¥è¿˜æ˜¯ç”¨valueé è°±&#125;); æ›´é€‚åˆç”¨factoryçš„ä¾‹å­ï¼Œè®¡ç®—token 12345678910111213myApp.factory('apiToken', ['clientId', function apiTokenFactory(clientId) &#123;//å°†å·¥å‚æ–¹æ³•å‘½åä¸º"Factory"æ˜¯æœ€ä½³å®è·µï¼ˆæ¯”å¦‚ï¼ŒapiTokenFactoryï¼‰.è™½ç„¶è¿™ç§å‘½åæ–¹å¼ä¸æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œä½†æ˜¯å®ƒæœ‰åŠ©äºæµè§ˆä»£ç ä»“åº“æˆ–è€…åœ¨è°ƒè¯•å™¨é‡Œè·Ÿè¸ªè°ƒç”¨å †æ ˆã€‚ var encrypt = function(data1, data2) &#123; // NSA-proofåŠ å¯†ç®—æ³•ï¼š return (data1 + ':' + data2).toUpperCase(); &#125;; var secret = window.localStorage.getItem('myApp.secret'); var apiToken = encrypt(clientId, secret); return apiToken;&#125;]);``` serviceå›¾çº¸ å¿…é¡»è¿”å›å¼•ç”¨ç±»å‹ è‡ªå®šä¹‰ç±»å‹ï¼Œå¹¶æºå¸¦token 1234567891011function UnicornLauncher(apiToken) &#123; this.launchedCount = 0; this.launch() &#123; // å¸¦ä¸ŠapiTokenæ¥å‘èµ·è¿œç¨‹è°ƒç”¨ ... this.launchedCount++; &#125;&#125;myApp.factory('unicornLauncher', ["apiToken", function(apiToken) &#123;// ä½¿ç”¨factoryå›¾çº¸æ¥å®ç° return new UnicornLauncher(apiToken);&#125;]);myApp.service('unicornLauncher', ["apiToken", UnicornLauncher]);// ä½¿ç”¨servicesè¯­æ³•æ›´åŠ ç®€ä»‹ï¼Œåœ¨å†…éƒ¨è¿˜æ˜¯ä¼šåƒfactoryä¸€æ ·ï¼Œnew ä¸€ä¸‹ providerå›¾çº¸ æ³¨æ„å¿…é¡»å®ç°$getæ–¹æ³• å…¶å®ƒå›¾çº¸çš„åº•å±‚éƒ½æ˜¯é€šè¿‡providerå®ç°çš„ï¼Œå¦‚factory 123function factory(name, factoryFn) &#123; return provider(name, &#123; $get: factoryFn &#125;); &#125; å½“ä½ éœ€è¦ä¸ºåœ¨åº”ç”¨è¿è¡Œå‰å°±å¿…é¡»è®¾ç½®å¥½çš„å…¨å±€é…ç½®é¡¹æä¾›APIæ—¶ï¼Œä½ æ‰éœ€è¦ç”¨åˆ°providerå›¾çº¸ å‡è®¾æˆ‘ä»¬çš„unicornLauncheræœåŠ¡æ˜¯å¦‚æ­¤æ£’ï¼Œä»¥è‡³äºæœ‰å¥½å¤šåº”ç”¨éƒ½ç”¨åˆ°å®ƒã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå‘å°„å™¨å°†ç‹¬è§’å…½å‘å°„åˆ°å¤ªç©ºä¸­ä¸éœ€è¦ä»»ä½•ä¿æŠ¤å±éšœã€‚ä½†æ˜¯åœ¨æŸäº›æ˜Ÿçƒä¸Šï¼Œç”±äºå¤§æ°”å±‚éå¸¸åšï¼Œæˆ‘ä»¬åœ¨å°†ç‹¬è§’å…½é€å»åšæ˜Ÿé™…æ—…è¡Œå‰å¿…é¡»å°†å®ƒä»¬åŒ…è£¹åœ¨é“ç®”é‡Œï¼Œä¸ç„¶å®ƒä»¬åœ¨ç©¿è¶Šå¤§æ°”å±‚æ—¶å°±è¢«çƒ§æ¯äº†ã€‚åœ¨ä¸€äº›åº”ç”¨é‡Œï¼Œéœ€è¦è®¾ç½®å‘å°„å™¨åœ¨æ¯æ¬¡å‘å°„æ—¶éƒ½ä½¿ç”¨é“ç®”å±è”½ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æŒ‰éœ€é…ç½®è¿™ä¸€ç‚¹é‚£å°±å¤ªæ£’äº†ã€‚æˆ‘ä»¬å¯ä»¥åƒä¸‹é¢è¿™æ ·è®©å®ƒå˜å¾—å¯é…ç½® 12345678910111213myApp.provider('unicornLauncher', function UnicornLauncherProvider() &#123; var useTinfoilShielding = false; this.useTinfoilShielding = function(value) &#123; useTinfoilShielding = !!value; &#125;; this.$get = ["apiToken", function unicornLauncherFactory(apiToken) &#123; // è¿™é‡Œæˆ‘ä»¬å‡è®¾UnicornLauncherçš„æ„é€ å‡½æ•°ä¹Ÿè¢«æ”¹é€ å¾—æ”¯æŒuseTinfoilShieldingå‚æ•°äº† return new UnicornLauncher(apiToken, useTinfoilShielding); &#125;];&#125;);myApp.config(["unicornLauncherProvider", function(unicornLauncherProvider) &#123; unicornLauncherProvider.useTinfoilShielding(true);&#125;]); constantå›¾çº¸ ç”¨æ¥åˆ›å»ºå¯ä»¥åœ¨é…ç½®é˜¶æ®µä½¿ç”¨çš„å›¾çº¸ åœ¨angularå¼€å§‹åˆ›å»ºæœåŠ¡ä¹‹å‰ï¼Œangularä¼šé…ç½®å’Œå®ä¾‹åŒ–æ‰€æœ‰providerï¼Œæ­¤æ—¶æœåŠ¡è¿˜ä¸èƒ½ç”¨ï¼Œå› ä¸ºä»–ä»¬è¿˜æ²¡æœ‰è¢«åˆ›å»º(åªæ˜¯providerè¢«å®ä¾‹åŒ–äº†ï¼Œç”±provideråˆ›å»ºå¹¶è¿”å›çš„æœåŠ¡æ­¤æ—¶è¿˜æ²¡æœ‰è¢«åˆ›å»º)ï¼›ä¸€æ—¦é…ç½®é˜¶æ®µç»“æŸï¼Œä¸providerçš„äº¤äº’å°±è¢«ç¦æ­¢äº†ï¼Œè€Œåˆ›å»ºæœåŠ¡çš„è¿‡ç¨‹å¼€å§‹ï¼›-&gt;æ‰€ä»¥åœ¨é…ç½®é˜¶æ®µï¼Œæ²¡æœ‰æœåŠ¡å¯ç”¨ï¼Œè¿™å°±å¯¼è‡´äº†ä¸€äº›æ²¡æœ‰ä¾èµ–ç”¨valueå†™çš„å¸¸é‡ä¹Ÿæ— æ³•è¢«ä½¿ç”¨-&gt;ä½¿ç”¨constant å‡è®¾åœ¨é…ç½®é˜¶æ®µæä¾›äº†å‘å°„ç‹¬è§’å…½çš„æ˜Ÿçƒåç§°ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„unicornLauncheræœåŠ¡å°±èƒ½é€šè¿‡è¿™ä¸ªåå­—æ¥æ ‡è¯†ä¸€ä¸ªç‹¬è§’å…½ã€‚æ˜Ÿçƒåæ˜¯å„ä¸ªåº”ç”¨ç‰¹æœ‰çš„ï¼Œå¹¶ä¸”åœ¨åº”ç”¨è¿è¡Œæ—¶ä¹Ÿä¼šè¢«å„ä¸ªæ§åˆ¶å™¨ä½¿ç”¨ã€‚æˆ‘ä»¬å¯ä»¥åƒä¸‹é¢çš„ä»£ç é‚£æ ·æŠŠæ˜Ÿçƒåå®šä¹‰ä¸ºä¸€ä¸ªå¸¸é‡ 123456myApp.constant('planetName', 'Greasy Giant');myApp.config(['unicornLauncherProvider', 'planetName', function(unicornLauncherProvider, planetName) &#123;// åœ¨é…ç½®é˜¶æ®µï¼Œä½¿ç”¨constantï¼Œå› ä¸ºvalueæ— æ³•ä½¿ç”¨ unicornLauncherProvider.useTinfoilShielding(true); unicornLauncherProvider.stampText(planetName);&#125;]);``` valueå›¾çº¸ä¹Ÿå¯ä»¥åœ¨æ§åˆ¶å™¨ã€æ¨¡æ¿ã€æŒ‡ä»¤ä¸­ä½¿ç”¨ 1234567891011myApp.controller('DemoController', ["clientId", "planetName", function DemoController(clientId, planetName) &#123; this.clientId = clientId; this.planetName = planetName;&#125;]);&lt;html ng-app="myApp"&gt; &lt;body ng-controller="DemoController as demo"&gt; Client ID: &#123;&#123;demo.clientId&#125;&#125; &lt;br&gt; Planet Name: &#123;&#123;demo.planetName&#125;&#125; &lt;/body&gt;&lt;/html&gt; æ€»ç»“ injectorç”¨äº”ç§å›¾çº¸æ¥åˆ›å»ºæœåŠ¡å’Œä¸“æœ‰å¯¹è±¡ providerå›¾çº¸æ˜¯æœ€åº•å±‚çš„æ–¹æ³•ï¼Œå…¶ä»–çš„å›¾çº¸éƒ½æ˜¯åŸºäºå…¶ä¹‹ä¸Šçš„è¯­æ³•ç³– provideræ˜¯æœ€å¤æ‚çš„å›¾çº¸ç±»å‹ï¼Œé™¤éä½ æ­£åœ¨æ„å»ºéœ€è¦å…¨å±€é…ç½®çš„å¯å¤ç”¨ä»£ç ï¼Œå¦åˆ™ä¸è¦ä½¿ç”¨å®ƒ é™¤äº†æ§åˆ¶å™¨ï¼Œå…¶ä»–æ‰€æœ‰ä¸“ç”¨å¯¹è±¡éƒ½æ˜¯é€šè¿‡factoryå›¾çº¸æ¥å®šä¹‰çš„(factoryå®šä¹‰çš„ï¼Œéƒ½æ˜¯å•ä¾‹å¯¹è±¡ï¼Œè€Œcontrollerä¸æ˜¯å•ä¾‹çš„) factoryå’Œserviceæ˜¯æœ€å¸¸ç”¨çš„å›¾çº¸ã€‚å®ƒä»¬ä¹‹é—´çš„å”¯ä¸€åŒºåˆ«å°±æ˜¯serviceå›¾çº¸å­˜åœ¨ä¸€ä¸ªnewè¿‡ç¨‹ï¼Œæ‰€ä»¥æœ€å¥½è¿”å›ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œè€Œfactoryå¯ä»¥åˆ›å»ºä»»æ„ç±»å‹ constantç”¨åœ¨é…ç½®æ—¶ï¼Œvalueç”¨åœ¨è¿è¡Œæ—¶ 12* æœ‰ç›´æ¥ä½¿ç”¨newæ“ä½œç¬¦é¢„å…ˆåˆå§‹åŒ–çš„å¼€é”€ã€‚** åœ¨é…ç½®é˜¶æ®µï¼ŒæœåŠ¡å¯¹è±¡æ˜¯ä¸èƒ½è¢«è®¿é—®çš„ï¼Œä½†Providerå®ä¾‹æ˜¯å¯ä»¥è¢«è®¿é—®çš„ã€‚ï¼ˆå‚è§æˆ‘ä»¬ä¸Šé¢åˆ—ä¸¾çš„unicornLauncherProviderä¾‹å­ï¼‰ã€‚ HTML Compiler HTML compiler è®©å¼€å‘è€…å¯ä»¥æ•™æµè§ˆå™¨ä¸€äº›æ–°çš„è¯­æ³•æŠ€èƒ½ Compileræ˜¯ Angular æä¾›çš„ä¸€é¡¹æœåŠ¡ï¼Œç”¨æ¥éå†DOMèŠ‚ç‚¹ï¼ŒæŸ¥æ‰¾ç‰¹å®šçš„å±æ€§ã€‚ç¼–è¯‘è¿‡ç¨‹åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š ç¼–è¯‘compileï¼šéå†DOMèŠ‚ç‚¹ï¼Œæ”¶é›†æ‰€æœ‰çš„æŒ‡ä»¤ï¼Œè¿”å›ä¸€ä¸ªè¿æ¥å‡½æ•°ï¼ˆlink funcï¼‰ è¿æ¥linkï¼šå°†ä¸Šä¸€æ­¥æ”¶é›†åˆ°çš„æ¯ä¸ªæŒ‡ä»¤ä¸å…¶æ‰€åœ¨çš„ä½œç”¨åŸŸï¼ˆscopeï¼‰è¿æ¥ç”Ÿæˆä¸€ä¸ªå®æ—¶è§†å›¾ã€‚ä»»ä½•ä½œç”¨åŸŸä¸­çš„æ¨¡å‹æ”¹å˜éƒ½ä¼šå®æ—¶åœ¨è§†å›¾ä¸­åæ˜ å‡ºæ¥ï¼ŒåŒæ—¶ä»»ä½•ç”¨æˆ·ä¸è§†å›¾çš„äº¤äº’åˆ™ä¼šæ˜ å°„åˆ°ä½œç”¨åŸŸçš„æ¨¡å‹ä¸­ã€‚è¿™æ ·ï¼Œä½œç”¨åŸŸä¸­çš„æ•°æ®æ¨¡å‹å°±æˆäº†å”¯ä¸€çš„æ•°æ®æºã€‚ æŒ‡ä»¤directive åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°ç‰¹å®šçš„HTMLç»“æ„ï¼ˆä¹Ÿå°±æ˜¯æŒ‡ä»¤ï¼‰æ—¶ï¼ŒæŒ‡ä»¤æ‰€å£°æ˜çš„è¡Œä¸ºæ“ä½œä¼šè¢«è§¦å‘ æŒ‡ä»¤å…¶å®å°±æ˜¯åœ¨ç¼–è¯‘å™¨éå†DOMæ—¶ç¢°åˆ°å°±éœ€è¦æ‰§è¡Œçš„å‡½æ•°ã€‚ æŒ‡ä»¤æ˜¯å¦‚ä½•è¢«ç¼–è¯‘çš„ çŸ¥é“ Angular çš„ç¼–è¯‘æ˜¯åœ¨DOMèŠ‚ç‚¹ä¸Šå‘ç”Ÿè€Œéå­—ç¬¦ä¸²ä¸Šæ˜¯å¾ˆé‡è¦çš„ã€‚å¦‚æœä½ è‡ªå·±æ‰‹åŠ¨è°ƒç”¨ $compile æ—¶ï¼Œå¦‚æœä½ ä¼ ç»™å®ƒä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ˜¾ç„¶æ˜¯è¦æŠ¥é”™çš„ã€‚æ‰€ä»¥ï¼Œåœ¨ä½ ä¼ å€¼ç»™ $compile ä¹‹å‰ï¼Œç”¨ angular.element å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºDOMã€‚ ç¼–è¯‘æµç¨‹ $compile éå†DOMèŠ‚ç‚¹ï¼ŒåŒ¹é…æŒ‡ä»¤ã€‚ å¦‚æœç¼–è¯‘å™¨å‘ç°æŸä¸ªå…ƒç´ åŒ¹é…ä¸€ä¸ªæŒ‡ä»¤ï¼Œé‚£ä¹ˆè¿™ä¸ªæŒ‡ä»¤å°±è¢«æ·»åŠ åˆ°æŒ‡ä»¤åˆ—è¡¨ä¸­ï¼ˆè¯¥åˆ—è¡¨ä¸DOMå…ƒç´ å¯¹åº”ï¼‰ã€‚ä¸€ä¸ªå…ƒç´ å¯èƒ½åŒ¹é…åˆ°å¤šä¸ªæŒ‡ä»¤ï¼ˆè¯‘æ³¨ï¼šä¹Ÿå°±æ˜¯ä¸€ä¸ªå…ƒç´ é‡Œé¢å¯èƒ½æœ‰å¤šä¸ªæŒ‡ä»¤ï¼‰ã€‚ å½“æ‰€æœ‰æŒ‡ä»¤éƒ½åŒ¹é…åˆ°ç›¸åº”çš„å…ƒç´ æ—¶ï¼Œç¼–è¯‘å™¨æŒ‰ç…§æŒ‡ä»¤çš„ priority å±æ€§æ¥æ’åˆ—æŒ‡ä»¤çš„ç¼–è¯‘é¡ºåºã€‚ ç„¶åä¾æ¬¡æ‰§è¡Œæ¯ä¸ªæŒ‡ä»¤çš„ compile å‡½æ•°ã€‚æ¯ä¸ª compile å‡½æ•°æœ‰ä¸€æ¬¡æ›´æ”¹è¯¥æŒ‡ä»¤æ‰€å¯¹åº”çš„DOMæ¨¡æ¿çš„æœºä¼šã€‚ç„¶åï¼Œæ¯ä¸ª compile å‡½æ•°è¿”å›ä¸€ä¸ª link å‡½æ•°ã€‚è¿™äº›å‡½æ•°æ„æˆä¸€ä¸ªâ€œåˆå¹¶çš„â€è¿æ¥å‡½æ•°ï¼Œå®ƒä¼šè°ƒç”¨æ¯ä¸ªæŒ‡ä»¤è¿”å›çš„ link å‡½æ•°ã€‚ ä¹‹åï¼Œ$compile è°ƒç”¨ç¬¬äºŒæ­¥è¿”å›çš„è¿æ¥å‡½æ•°ï¼Œå°†æ¨¡æ¿å’Œå¯¹åº”çš„ä½œç”¨åŸŸè¿æ¥ã€‚è€Œè¿™åˆä¼šä¾æ¬¡è°ƒç”¨è¿æ¥å‡½æ•°ä¸­åŒ…å«çš„æ¯ä¸ªæŒ‡ä»¤å¯¹åº”çš„ link å‡½æ•°ï¼Œè¿›è€Œåœ¨å„ä¸ªDOMå…ƒç´ ä¸Šæ³¨å†Œç›‘å¬å™¨ä»¥åŠåœ¨ç›¸åº”çš„ scope ä¸­è®¾ç½®å¯¹åº”çš„ $watchsã€‚ ç”¨ä»£ç è¡¨ç¤ºå¤§æ¦‚æ˜¯ä¸‹é¢æµç¨‹ 1234567891011121314151617181920212223var $compile = ...; // å·²ç»å­˜åœ¨çš„ç¼–è¯‘å™¨var scope = ...;// ä½œç”¨åŸŸvar parent = ...; // DOM element where the compiled template can be appendedï¼Œè¦è¢«è¿½åŠ å†…å®¹çš„DOMå…ƒç´ var html = '&lt;div ng-bind="exp"&gt;&lt;/div&gt;';// æŒ‡ä»¤æ¨¡æ¿å­—ç¬¦ä¸²// Step 1: parse HTML into DOM elementï¼Œå°†htmlå­—ç¬¦ä¸²è§£æä¸ºDOMï¼Œå› ä¸ºå¦‚æœä¼ ç»™$compileå­—ç¬¦ä¸²ä¼šæŠ¥é”™var template = angular.element(html);// Step 2: compile the templateï¼Œéå†æ•´ä¸ªtemplateçš„DOMï¼Œæ‰¾åˆ°æ‰€æœ‰æŒ‡ä»¤ï¼Œå¹¶æŒ‰priorityæ’åºï¼Œå¹¶ä¾æ¬¡æ‰§è¡Œæ¯ä¸ªæŒ‡ä»¤é‡Œçš„compileå‡½æ•°ï¼Œæ¯ä¸ªcompileå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªlinkå‡½æ•°ï¼Œä»¥ä¾›ç¬¬ä¸‰éƒ¨ç”¨var linkFn = $compile(template);// Step 3: link the compiled template with the scope.ï¼Œ$compileä¼šä¾æ¬¡è°ƒç”¨ç¬¬äºŒæ­¥è¿”å›çš„linkå‡½æ•°ï¼Œå°†æ¨¡æ¿å’Œå¯¹åº”çš„ä½œç”¨åŸŸè¿æ¥ï¼Œä¼šä¾æ¬¡è°ƒç”¨è¿æ¥å‡½æ•°ä¸­åŒ…å«çš„æ¯ä¸ªæŒ‡ä»¤å¯¹åº”çš„ link å‡½æ•°ï¼Œè¿›è€Œåœ¨å„ä¸ªDOMå…ƒç´ ä¸Šæ³¨å†Œç›‘å¬å™¨ä»¥åŠåœ¨ç›¸åº”çš„ scope ä¸­è®¾ç½®å¯¹åº”çš„ $watchesvar element = linkFn(scope);// Step 4: Append to DOM (optional)ï¼Œå¯é€‰çš„å°†ä¸€åˆ‡å°±ç»ªçš„domè¿½åŠ åˆ°htmlä¸­parent.appendChild(element); æ€»ç»“ï¼šcompile(æ‰¾æŒ‡ä»¤ã€æ’åºã€ä¾æ¬¡æ‰§è¡ŒæŒ‡ä»¤ä¸­compileå‡½æ•°å¹¶è¿”å›linkå‡½æ•°)-&gt;æ‰§è¡Œæ¯ä¸ªæŒ‡ä»¤ä¸­çš„link(DOMå’Œä½œç”¨åŸŸè¿›è¡Œè¿æ¥ï¼Œè®¾ç½®äº‹ä»¶ç›‘å¬å¹¶æ·»åŠ $watch) ngModelæ¨¡å— å½“éœ€è¦å¯¹æ•°æ®è¿›è¡Œæ·±å±‚å¤„ç†æ—¶ï¼Œå¯ä»¥ç”¨ngModelæ¨¡å—-&gt;ä¸€èˆ¬æ˜¯æŒ‡ä»¤ï¼Œè¿™ä¸ªngModelå¯¹åº”çš„å°±æ˜¯æŒ‡ä»¤åŒ¹é…å…ƒç´ ä¸Šçš„ng-model ä¸»è¦å‚è€ƒhttp://docs.ngnice.com/guidehttps://code.angularjs.org/1.2.32/docs/guideå°çŒ«æ¯çš„angularè§†é¢‘æ•™ç¨‹å¤§æ¼ ç©·ç§‹çš„angularå®æˆ˜]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>Angular</tag>
        <tag>MVC</tag>
        <tag>framework</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Graphviz]]></title>
    <url>%2F2017%2F03%2F24%2FGraphviz%2F</url>
    <content type="text"><![CDATA[Graphvizçš„å®‰è£…ä»¥åŠåŸºæœ¬ä½¿ç”¨ä»‹ç»Graphvizå¯é€šè¿‡ä»£ç çš„æ–¹å¼ç”Ÿæˆå›¾å½¢ å®‰è£…winä¸‹ï¼Œå¯åœ¨å®˜ç½‘http://http://www.graphviz.org/Download_windows.phpä¸‹è½½ï¼Œå®‰è£…å¥½åï¼Œæ‰‹åŠ¨å°†binæ–‡ä»¶å¤¹æ·»åŠ åˆ°ç¯å¢ƒå˜é‡å³å¯ã€‚cmd ä¸‹é”®å…¥dot -version,èƒ½å‡ºç°Graphvizç›¸å…³ä¿¡æ¯ï¼Œåˆ™è¡¨ç¤ºå®‰è£…æˆåŠŸ ç”Ÿæˆå›¾ç‰‡12dot æºæ–‡ä»¶ -T å›¾ç‰‡æ ¼å¼ -o è¾“å‡ºæ–‡ä»¶dot input.dot -T png -o output.png å¯åˆ©ç”¨sublimeTextçš„ç¼–è¯‘ç³»ç»Ÿï¼Œå®ç°å›¾ç‰‡å®æ—¶é¢„è§ˆ å…·ä½“å¯å‚è€ƒè¿™ç¯‡æ–‡ç« https://zhuanlan.zhihu.com/p/22820399 æ–°å»º*.dotæ–‡ä»¶ï¼Œç„¶åç¼–å†™ç›¸åº”ä»£ç ï¼Œå†ç¼–è¯‘å°±èƒ½ç”Ÿæˆå›¾ åŸºæœ¬è¯­æ³•123å›¾ç±»å‹ å›¾å&#123; //å…¶ä»–&#125; æ— å‘å›¾1234567// æ— å‘å›¾ç”¨--è¡¨ç¤ºèŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»graph graphname &#123; a -- b--e; b -- c; b -- d; d -- a;&#125; æœ‰å‘å›¾123456// æœ‰å‘å›¾ç”¨a-&gt;bè¡¨ç¤ºä»aèŠ‚ç‚¹æŒ‡å‘bèŠ‚ç‚¹digraph graphname&#123; a-&gt;b b-&gt;c a-&gt;c&#125; å®šä¹‰ä¸€ç±»èŠ‚ç‚¹123456digraph graphname&#123; T [label=&quot;Teacher&quot;,fontcolor=&quot;red&quot;] //å®šä¹‰èŠ‚ç‚¹Tï¼Œå¹¶ç»™äºˆå±æ€§ P [label=&quot;Pupil&quot;] //å®šä¹‰èŠ‚ç‚¹Pï¼Œå¹¶ç»™äºˆå±æ€§ T-&gt;P [label=&quot;Instructions&quot;, fontcolor=darkgreen] //å®šä¹‰è¾¹T-&gt;Pï¼Œå¹¶ç»™äºˆå±æ€§ &#125; è®¾ç½®å±æ€§(æ ·å¼)12345678910111213141516171819202122232425262728293031323334353637graph G &#123; // è®¾ç½®å½“å‰å›¾å’Œå­å›¾çš„å±æ€§ fontname=&quot;Microsoft JhengHei&quot;; fontsize=20; label=&quot;å›¾&quot;; fontcolor=blue; //è®¾ç½®å½“å‰å¤§æ‹¬å·èŒƒå›´å†…æ‰€æœ‰èŠ‚ç‚¹å’Œè¾¹çš„å±æ€§ï¼ŒåŒ…å«å­å›¾é‡Œé¢èŠ‚ç‚¹å’Œè¾¹ï¼Œç±»cssä¸­æ ‡ç­¾é€‰æ‹©å™¨ node[fontname=&quot;Microsoft JhengHei&quot;,fontsize=16]; edge[fontname=&quot;Microsoft JhengHei&quot;,fontsize=16]; // å¯é’ˆå¯¹æŸä¸€ç±»èŠ‚ç‚¹è®¾ç½®å±æ€§ï¼Œç±»cssä¸­classé€‰æ‹©å™¨ &quot;é»‘æµ·&quot;[fontcolor=&quot;pink&quot;,style =&quot;filled&quot;,fillcolor = &quot;black&quot;]; &quot;é»‘æµ·&quot; -- &quot;äºšé€Ÿæµ·&quot;; &quot;é»‘æµ·&quot; -- &quot;åšæ–¯æ™®é²æ–¯æµ·å³¡&quot;; &quot;è¾¾è¾¾å°¼å°”æµ·å³¡&quot; -- &quot;çˆ±ç´æµ·&quot;; // å­å›¾ï¼Œç”¨subgraphå£°æ˜ï¼Œå¹¶å›¾åå­—å‰ç¼€å¿…é¡»æ˜¯cluster_å¦åˆ™è¯†åˆ«å¤±è´¥ï¼›å­å›¾å’Œçˆ¶å›¾çš„ç±»å‹å¿…é¡»ä¸€è‡´ï¼Œçˆ¶å›¾æ˜¯æ— å‘åˆ™å­å›¾ä¹Ÿå¿…é¡»æ˜¯æ— å‘ï¼Œä¸èƒ½æ˜¯æœ‰å‘ subgraph cluster_T &#123; // è®¾ç½®å­å›¾çš„labelå±æ€§ï¼Œå®ƒçš„é¢œè‰²ç»§æ‰¿çˆ¶å›¾çš„fontcolor=blue label=&quot;é»‘æµ·æµ·å³¡&quot;; &quot;è¾¾è¾¾å°¼å°”æµ·å³¡&quot; -- &quot;é©¬å°”é©¬æ‹‰æµ·&quot; -- &quot;åšæ–¯æ™®é²æ–¯æµ·å³¡&quot;; &#125; subgraph cluster_M &#123; label=&quot;é»‘æµ·æµ·å³¡&quot;; // ä¸€å¯¹å¤šï¼Œç©ºæ ¼åˆ†éš” &quot;ä¸­éƒ¨åœ°ä¸­æµ·&quot; -- &#123; &quot;çˆ±ç´æµ·&quot; &quot;çˆ±å¥¥å°¼äºšæµ·&quot; &quot;è¥¿è¥¿é‡Œæµ·å³¡&quot; &#125;; // ä¸€å¯¹å¤šï¼Œå¹¶è®¾ç½®æ¯å¯¹éƒ½æœ‰ä¸€ä¸ªlabelæ ‡ç­¾è¯´æ˜ï¼Œå¹¶æŠŠå­—ä½“é¢œè‰²è®¾ç½®ä¸ºredï¼Œçº¿æ¡é¢œè‰²è®¾ç½®ä¸ºyellow &quot;è¥¿éƒ¨åœ°ä¸­æµ·&quot; -- &#123; &quot;è¥¿è¥¿é‡Œæµ·å³¡&quot; &quot;ç¬¬å‹’å°¼å®‰æµ·&quot; &quot;åˆ©å¤é‡Œäºšæµ·&quot; &quot;ä¼Šæ¯”åˆ©æµ·&quot; &quot;é˜¿å°”æ²ƒå…°æµ·&quot; &#125;[label=&quot;æ ‡ç­¾è¯´æ˜&quot;,fontcolor=&quot;red&quot;,color=&quot;yellow&quot;]; &quot;çˆ±å¥¥å°¼äºšæµ·&quot; -- &quot;äºšå¾—é‡Œäºšæµ·&quot;; &quot;é˜¿å°”æ²ƒå…°æµ·&quot; -- &quot;ç›´å¸ƒç½—é™€æµ·å³¡&quot;; &#125;&#125; æœ€ç»ˆç”Ÿæˆçš„ ä¸­æ–‡ä¹±ç ä¿è¯.dotæ–‡ä»¶æ˜¯ä»¥UTF-8ç¼–ç é€šè¿‡è®¾ç½®fontnameä¸ºä¸­æ–‡å­—ä½“æ¥è§£å†³ å‚è€ƒé“¾æ¥ https://zhuanlan.zhihu.com/p/21993254https://zhuanlan.zhihu.com/p/22820399http://blog.csdn.net/xiajian2010/article/details/23748557http://www.tuicool.com/articles/vy2Ajyu]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>Graphviz</tag>
        <tag>ç»˜å›¾</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[mock-js]]></title>
    <url>%2F2017%2F03%2F24%2Fmock-js%2F</url>
    <content type="text"><![CDATA[Mock.jsçš„åŸºæœ¬ç”¨æ³•å¦‚ä½•ä½¿ç”¨123456789101112131415161718192021&lt;script type="text/javascript" src="js/jquery-2.2.4.min.js"&gt;&lt;/script&gt;&lt;!-- å¼•å…¥Mock.js --&gt;&lt;script type="text/javascript" src="js/mock-min.js"&gt;&lt;/script&gt;&lt;script&gt; // æ ¹æ®æ•°æ®æ¨¡æ¿ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®ã€‚ Mock.mock('http://test.cn', &#123; "userName": "@cname", "sex|1": ["ç”·", "å¥³"], "avator": Mock.Random.image('100x100', '#894FC4', '#FFF', 'png', 'å¤´åƒ') &#125;); // æ¨¡æ‹Ÿè¯·æ±‚ $.ajax(&#123; url: 'http://test.cn', dataType: 'json' &#125;).done(function(data, status, xhr) &#123; // è¯·æ±‚æˆåŠŸï¼Œdo something console.log(data); &#125;);&lt;/script&gt; è¯­æ³•è§„èŒƒ æ•°æ®æ¨¡æ¿å®šä¹‰è§„èŒƒï¼ˆData Template Definitionï¼ŒDTDï¼‰ æ•°æ®å ä½ç¬¦å®šä¹‰è§„èŒƒï¼ˆData Placeholder Definitionï¼ŒDPDï¼‰ æ•°æ®æ¨¡æ¿å®šä¹‰è¯­æ³•1234&apos;name|rule&apos;:valuename:å±æ€§årule:ç”Ÿæˆè§„åˆ™vale:å±æ€§å€¼ æ³¨æ„ å±æ€§å(name)å’Œç”Ÿæˆè§„åˆ™(value)ä¹‹é—´è¦ç”¨|åˆ†éš” ç”Ÿæˆè§„åˆ™(rule)ä¸æ˜¯å¿…é¡»çš„ æœ€ç»ˆç”Ÿæˆå€¼çš„ç±»å‹å’Œåˆå§‹å€¼ç”±å±æ€§å€¼(value)ç¡®å®š å±æ€§å€¼(value)ä¸­å¯ä»¥åŒ…å«æ•°æ®å ä½ç¬¦(@å ä½ç¬¦) ç”Ÿæˆè§„åˆ™æœ‰7ç§æ ¼å¼ â€˜name|min-maxâ€™: value â€˜name|countâ€™: value â€˜name|min-max.dmin-dmaxâ€™: value â€˜name|min-max.dcountâ€™: value â€˜name|count.dmin-dmaxâ€™: value â€˜name|count.dcountâ€™: value â€˜name|+stepâ€™: value ç”Ÿæˆè§„åˆ™çš„å…·ä½“å«ä¹‰è¿˜è¦é…åˆå±æ€§å€¼(value)çš„ç±»å‹æ¥ç¡®å®š è§„åˆ™ å±æ€§å€¼(value)æ˜¯String â€˜name |min-maxâ€™:stringValue é€šè¿‡é‡å¤stringValueï¼Œç”Ÿæˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚é‡å¤æ¬¡æ•°åœ¨[min,max]åŒºé—´å–å€¼(æ¬¡æ•°å¤§äºç­‰äºminï¼Œå°äºç­‰äºmax) â€˜name |countâ€™:stringValue é€šè¿‡é‡å¤stringValueå­—ç¬¦ä¸²countæ¬¡ï¼Œç”Ÿæˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ å±æ€§å€¼(value)æ˜¯Number â€˜name|+1â€™: numberValue å±æ€§å€¼è‡ªåŠ¨åŠ  1ï¼Œåˆå§‹å€¼ä¸ºnumberValueã€‚ â€˜name|min-maxâ€™:numberValue ç”Ÿæˆä¸€ä¸ª[min,max]ä¹‹é—´çš„æ•´æ•°ï¼Œæ­¤æ—¶å±æ€§å€¼numberValueåªæ˜¯ç”¨æ¥ç¡®å®šç±»å‹ã€‚ â€˜name|min-max.dmin-dmaxâ€™: numberValue ç”Ÿæˆä¸€ä¸ªæ•´æ•°éƒ¨åˆ†åœ¨[min,max]é—´å–å€¼,å°æ•°ä¿ç•™çš„ä½æ•°åœ¨[dmin,dmax]é—´å–å€¼çš„æµ®ç‚¹æ•°ã€‚åŒç†æ­¤æ—¶å±æ€§å€¼(value)ä¹Ÿåªæ˜¯ç”¨æ¥ç¡®å®šæœ€ç»ˆè¿”å›çš„æ•°æ®çš„ç±»å‹ã€‚ å±æ€§å€¼æ˜¯Boolean â€˜name|1â€™: booleanValue éšæœºç”Ÿæˆä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå€¼ä¸º booleanValue çš„æ¦‚ç‡æ˜¯ 1/2ï¼Œå€¼ä¸º !booleanValue çš„æ¦‚ç‡åŒæ ·æ˜¯ 1/2ã€‚ â€˜name|min-maxâ€™: booleanValue éšæœºç”Ÿæˆä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå€¼ä¸º booleanValue çš„æ¦‚ç‡æ˜¯ min / (min + max)ï¼Œå€¼ä¸º !booleanValue çš„æ¦‚ç‡æ˜¯ max / (min + max)ã€‚æ­¤å¤„å±æ€§å€¼å¿…é¡»æ˜¯Booleanç±»å‹ï¼Œè‹¥ä¸ºNumber,åˆ™æ„ä¹‰ä¸åŒï¼Œè§2 â€œtest|1-2â€:true ç”Ÿæˆä¸€ä¸ªå¸ƒå°”å€¼ï¼Œä¸ºtrueçš„æ¦‚ç‡ä¸º1/3ï¼Œä¸ºfalseæ¦‚ç‡ä¸º2/3 å±æ€§å€¼æ˜¯å¯¹è±¡ Object â€˜name|countâ€™: object è¿”å›çš„å¯¹è±¡åªåŒ…å«ä»å±æ€§å€¼objectä¸­éšæœºé€‰å–çš„countä¸ªå±æ€§ã€‚ â€˜name|min-maxâ€™: object è¿”å›çš„å¯¹è±¡åªåŒ…å«ä»å±æ€§å€¼objectä¸­éšæœºé€‰å–çš„minåˆ°maxä¸ªå±æ€§ã€‚ å±æ€§å€¼æ˜¯æ•°ç»„ Array â€˜name|1â€™: array ä»å±æ€§å€¼ array ä¸­éšæœºé€‰å– 1 ä¸ªå…ƒç´ ï¼Œä½œä¸ºæœ€ç»ˆå€¼ã€‚ â€˜name|+1â€™: array ä»å±æ€§å€¼ array ä¸­é¡ºåºé€‰å– 1 ä¸ªå…ƒç´ ï¼Œä½œä¸ºæœ€ç»ˆå€¼ã€‚ â€˜name|min-maxâ€™: array é€šè¿‡é‡å¤å±æ€§å€¼arrayçš„å€¼ç”Ÿæˆä¸€ä¸ªæ–°æ•°ç»„ï¼Œé‡å¤æ¬¡æ•°å¤§äºç­‰äº minï¼Œå°äºç­‰äº maxã€‚ â€˜name|countâ€™: array é€šè¿‡é‡å¤å±æ€§å€¼arrayçš„å€¼ç”Ÿæˆä¸€ä¸ªæ–°æ•°ç»„ï¼Œé‡å¤æ¬¡æ•°ä¸º countã€‚ å±æ€§å€¼æ˜¯å‡½æ•° Function â€˜nameâ€™: function æ‰§è¡Œå‡½æ•° functionï¼Œå–å…¶è¿”å›å€¼ä½œä¸ºæœ€ç»ˆçš„å±æ€§å€¼ï¼Œå‡½æ•°çš„ä¸Šä¸‹æ–‡ä¸ºå±æ€§ â€˜nameâ€™ æ‰€åœ¨çš„å¯¹è±¡ã€‚ å±æ€§å€¼æ˜¯æ­£åˆ™è¡¨è¾¾å¼ RegExp â€˜nameâ€™: regexp æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼ regexp åå‘ç”Ÿæˆå¯ä»¥åŒ¹é…å®ƒçš„å­—ç¬¦ä¸²ã€‚ç”¨äºç”Ÿæˆè‡ªå®šä¹‰æ ¼å¼çš„å­—ç¬¦ä¸²ã€‚ æ•°æ®å ä½ç¬¦å®šä¹‰è¯­æ³•Mockä¸­çš„å ä½ç¬¦å’ŒSassä¸­çš„placeholderå¾ˆåƒã€‚å¯ä»¥ç›´æ¥ç”¨åœ¨æ•°æ®æ¨¡æ¿çš„å±æ€§å€¼ä¸­ã€‚Mockä¸­æä¾›äº†å¾ˆå¤šé¢„å…ˆå®šä¹‰çš„å ä½ç¬¦ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å ä½ç¬¦ã€‚ åŸºæœ¬è°ƒç”¨æ ¼å¼1234@å ä½ç¬¦@å ä½ç¬¦(å‚æ•° [, å‚æ•°])æˆ–è€…Mock.Random.å ä½ç¬¦(å‚æ•° [, å‚æ•°]) æ³¨æ„ï¼š ç”¨@æ¥æ ‡è¯†å…¶åçš„å­—ç¬¦ä¸²æ˜¯å ä½ç¬¦ã€‚ å ä½ç¬¦å¼•ç”¨çš„æ˜¯Mock.Randomä¸­çš„æ–¹æ³•ã€‚ é€šè¿‡ Mock.Random.extend() æ¥æ‰©å±•è‡ªå®šä¹‰å ä½ç¬¦ã€‚ å ä½ç¬¦ä¹Ÿå¯ä»¥å¼•ç”¨æ•°æ®æ¨¡æ¿ä¸­çš„å±æ€§ã€‚ å ä½ç¬¦ä¼šä¼˜å…ˆå¼•ç”¨æ•°æ®æ¨¡æ¿ä¸­çš„å±æ€§ã€‚ å ä½ç¬¦æ”¯æŒç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„ã€‚ é¢„å®šä¹‰çš„å ä½ç¬¦ Basic æä¾›ä¸€äº›åŸºç¡€å ä½ç¬¦ï¼Œå¦‚å¸ƒå°”å€¼ã€æ•´æ•°ã€è‡ªç„¶æ•°ã€å­—ç¬¦ä¸²ç­‰ Date æä¾›æ—¥æœŸç›¸å…³çš„å ä½ç¬¦ Image æä¾›å›¾ç‰‡ç›¸å…³çš„å ä½ç¬¦ Color æä¾›è‰²å€¼ç›¸å…³çš„å ä½ç¬¦ Text æä¾›æ–‡æœ¬ç›¸å…³çš„å ä½ç¬¦ Name æä¾›è‹±æ–‡ã€ä¸­æ–‡åç§°ç›¸å…³çš„å ä½ç¬¦ Web æä¾›äº†urlã€IPã€protocolç­‰ç›¸å…³çš„å ä½ç¬¦ Address æä¾›çœä»½ã€åŸå¸‚ç­‰åœ°åŸŸç›¸å…³ä¿¡æ¯çš„å ä½ç¬¦ Helper æä¾›ä¸€äº›å¸¸ç”¨å·¥å…·å¦‚å­—æ¯è½¬æ¢å¤§å°å†™ç­‰ç›¸å…³å ä½ç¬¦ Miscellaneous æä¾›äº†guidã€èº«ä»½è¯ã€è‡ªå¢ç­‰ç›¸å…³å ä½ç¬¦å· è‡ªå®šä¹‰æ‰©å±•ç¬¦1234567891011121314Mock.Random.extend(&#123; constellation: function(date) &#123; var constellations = ['ç™½ç¾Šåº§', 'é‡‘ç‰›åº§', 'åŒå­åº§', 'å·¨èŸ¹åº§', 'ç‹®å­åº§', 'å¤„å¥³åº§', 'å¤©ç§¤åº§', 'å¤©èåº§', 'å°„æ‰‹åº§', 'æ‘©ç¾¯åº§', 'æ°´ç“¶åº§', 'åŒé±¼åº§'] return this.pick(constellations) &#125;&#125;)Mock.Random.constellation()// =&gt; "æ°´ç“¶åº§"Mock.mock('@CONSTELLATION')// =&gt; "å¤©èåº§"Mock.mock(&#123; constellation: '@CONSTELLATION'&#125;)// =&gt; &#123; constellation: "å°„æ‰‹åº§" &#125; æ›´å¤šAPIè¯·å‚è€ƒ https://github.com/nuysoft/Mock/wiki&#39; æ›´å¤šå®ä¾‹è¯·å‚è€ƒ http://mockjs.com/examples.html å¯ä»¥ä¸€è¾¹çœ‹APIã€ä¸€è¾¹çœ‹å®ä¾‹ï¼Œå¾ˆå®¹æ˜“å°±èƒ½ä¸Šæ‰‹]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>mock</tag>
        <tag>æ¨¡æ‹Ÿæ•°æ®</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Markdown-Learning]]></title>
    <url>%2F2017%2F03%2F23%2FMarkdown-Learning%2F</url>
    <content type="text"><![CDATA[Markdown-Github Flavored Markdownå¸¸ç”¨æ“ä½œMarkdownæ‹¥æœ‰å¤šç§è¯­æ³•é£æ ¼ æ ‡å‡†é£æ ¼-ä¸æ”¯æŒè¡¨æ ¼ æ‰©å±•é£æ ¼-æ”¯æŒè¡¨æ ¼ githubé£æ ¼-Github Flavored Markdownå®ƒåœ¨æ ‡å‡†é£æ ¼ä¸Šåšäº†å¾ˆå¤šæ”¹è¿›ï¼Œå¦‚å¯¹è¡¨æ ¼çš„æ”¯æŒï¼Œé’ˆå¯¹ä¸åŒç¼–ç¨‹è¯­è¨€å®ç°ä»£ç é«˜äº®ç­‰ å› ä¸ºç»å¸¸ä½¿ç”¨githubï¼Œæ‰€ä»¥é€‰æ‹©äº†Github Flavored Markdowné£æ ¼ã€‚ Hexoæ­å»ºçš„åšå®¢ä¹Ÿæ˜¯ä½¿ç”¨githubé£æ ¼æ¥è§£æmarkdownçš„ã€‚ winä¸Šæ”¯æŒGithub Flavored Markdowné£æ ¼çš„ç¼–è¾‘å™¨æˆ‘å¸¸ç”¨çš„æœ‰:markdown pad2å’Œtyporaã€‚typoraæœ€è®©æˆ‘å¿ƒåŠ¨çš„æ˜¯æ”¯æŒå¿«æ·é”®åˆ›å»ºè¡¨æ ¼ï¼Œéå¸¸çš„æ–¹ä¾¿ã€‚ æ ‡é¢˜12345# ä¸€çº§æ ‡é¢˜## äºŒçº§æ ‡é¢˜ï¼ŒäºŒçº§æ ‡é¢˜è‡ªå¸¦ä¸‹åˆ’çº¿### ä¸‰çº§æ ‡é¢˜...###### å…­çº§æ ‡é¢˜ ç²—ä½“æ–œä½“1234**ä¸¤ä¸ªæ˜Ÿå·ä¸ºç²—ä½“***ä¸€ä¸ªæ˜Ÿå·ä¸ºæ–œä½“***ç²—ä¸­å¸¦ _æ–œ_***å†…éƒ¨æ¢è¡Œç”¨&lt;br&gt;,ç¬¬äºŒè¡Œ* å¼•ç”¨1&gt; è¿™æ ·å¼•ç”¨ æ— åºåˆ—è¡¨12345- æ— åº - æˆ‘å‰é¢æœ‰2ä¸ªç©ºæ ¼ï¼Œæˆ‘èƒ½ç¼©è¿› - æ— åº- æ— åº- æ— åº æœ‰åºåˆ—è¡¨12341. ç¬¬ä¸€è¡Œ 1. æˆ‘å‰é¢æœ‰2ä¸ªç©ºæ ¼2. ç¬¬äºŒè¡Œ3. ç¬¬ä¸‰è¡Œ ä»»åŠ¡åˆ—è¡¨123- [x] æˆ‘ä»£è¡¨é€‰ä¸­- [ ] æˆ‘æ²¡é€‰ä¸­- [ ] æˆ‘æ²¡é€‰ä¸­ å›¾ç‰‡ä¸é“¾æ¥12[é“¾æ¥å](é“¾æ¥åœ°å€)![å›¾ç‰‡alt](å›¾ç‰‡åœ°å€) ä»£ç æ®µ1ä½¿ç”¨`åŒ…è£¹çš„åŒºåŸŸä¼šå½¢æˆä»£ç æ®µ,åŒºæ®µå†…çš„ &amp;ã€&lt; å’Œ &gt; éƒ½ä¼šè¢«è‡ªåŠ¨çš„è½¬æ¢æˆHTMLå®ä½“ï¼Œä¸€èˆ¬ç”¨åœ¨è¡Œå†… ä»£ç å—1ä½¿ç”¨ä¸‰ä¸ª`ä¼šäº§ç”Ÿæ ¼å¼åŒ–å¥½çš„ä»£ç å—,è€Œ &amp;ã€&lt; å’Œ &gt; ä¹Ÿä¸€æ ·ä¼šè‡ªåŠ¨è½¬æˆHTMLå®ä½“ï¼Œä¸€èˆ¬ç”¨äºä¸€å¤§æ®µä»£ç  ä»£ç å—é«˜äº®123function show()&#123; console.log("æˆ‘æ˜¯å¸¦è¯­æ³•é«˜äº®çš„ä»£ç å—ï¼Œåœ¨ä¸‰ä¸ª`åæ·»åŠ ä¸Šè¯­è¨€ç±»å‹å³å¯é«˜äº®");&#125; è¡¨æ ¼12345| Tables | Are | Cool || ------------- |:-------------:| -----:|| col 3 is | right-aligned | $1600 || col 2 is | centered | $12 || zebra stripes | are neat | $1 | Markdownä¸­è¡¨æ ¼ç”Ÿæˆè¾ƒä¸ºéº»çƒ¦ï¼Œå»ºè®®ä½¿ç”¨ç¼–è¾‘å™¨å¿«é€Ÿç”Ÿæˆ,å¦‚typoraä¸­ä½¿ç”¨ctrl+t åˆ†å‰²çº¿1***æˆ–--- ä¼šäº§ç”Ÿåˆ†å‰²çº¿ è¿˜æœ‰å¾ˆå¤šä¸œè¥¿å› ä¸ºæ²¡ç”¨åˆ°ï¼Œæ‰€ä»¥ä¸åšä»‹ç»ã€‚æ›´å¤šçš„å¯ä»¥å‚è€ƒè¿™ https://help.github.com/categories/writing-on-github/]]></content>
      <categories>
        <category>å…¶ä»–</category>
      </categories>
      <tags>
        <tag>Markdown</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Handlebars-guide]]></title>
    <url>%2F2017%2F03%2F17%2FHandlebars-guide%2F</url>
    <content type="text"><![CDATA[#HandleBarså¤‡å¿˜ è¡¨è¾¾å¼{{xxx}} {{{xxxx}}}å› ä¸ºåŒå¤§æ‹¬å·é»˜è®¤ä¼šè¿›è¡ŒHTMLè½¬ä¹‰,å°†&lt;è½¬æ¢ä¸º&amp;lt;,é€šè¿‡ä¸‰æ‹¬å·å¯ä»¥é¿å… Helperé»˜è®¤Helper{{#if a}}å¦‚æœaä¸ºçœŸæ‰§è¡Œè¿™ä¸ª{{/if}} {{#else}}å¦åˆ™æ‰§è¡Œè¿™ä¸ª{{/else}} {{#unless a}}å½“aä¸ºå‡çš„æ—¶å€™æ‰§è¡Œè¿™ä¸ª{{/unless}} {{#each obj}}éå†objçš„æ¯ä¸ªå±æ€§{{/each}} #eachå†…å¯ä»¥ç”¨{{@index}}è·å–å½“å‰éå†çš„ç´¢å¼•å€¼ï¼Œç”¨{{@key}}è·å–å½“å‰å±æ€§çš„å±æ€§åï¼Œç”¨{{this}}å¯ä»¥è·å½“å‰å±æ€§çš„å€¼ å¦‚ä½•è·å–çˆ¶å¯¹è±¡ å¯ä»¥é€šè¿‡{{../çˆ¶å¯¹è±¡æŸå±æ€§}}æ¥è·å–çˆ¶å¯¹è±¡çš„æŸä¸ªå±æ€§ï¼Œ{{@../index}}è·å–çˆ¶å¯¹è±¡å½“å‰çš„æ‰€å¼•å€¼ {{#with obj}}xxx{{/with}}ç±»ä¼¼jsä¸­withï¼Œå¯æ”¹å˜ä½œä½œç”¨åŸŸï¼Œåœ¨eachä¸­ä¹Ÿå¯é€šè¿‡#with çˆ¶å¯¹è±¡å æ¥è®¿é—®çˆ¶å¯¹è±¡ {{lookup xxx}}ä¸€èˆ¬ç”¨æ¥æŒ‰ç…§ç´¢å¼•æ¥æ‰¾å…„å¼Ÿå˜é‡å¯¹åº”çš„å€¼{{lookup ../çˆ¶å¯¹è±¡æŸå±æ€§ @index}}ï¼ŒæŸ¥æ‰¾çˆ¶å¯¹è±¡åœ¨å½“å‰ç´¢å¼•ä¸‹å€¼ è‡ªå®šä¹‰Helperè¡Œçº§Helperè¯­æ³•{{helperName [æ™®é€šå€¼å‚æ•°][hashå€¼å‚æ•°]}} {{customHelper "My Text" class="my-class" visible=true counter=4}} Handlebars.registerHelper(&apos;customHelper&apos;, function() { console.log(arguments[0]);//==&gt;&quot;My Text&quot; console.log(arguments[1].hash);//==&gt;{class:&quot;my-class&quot;,visible:true,conter:4} }); å—çº§Helperè¯­æ³•{{#helperName context [æ™®é€šå€¼å‚æ•°][hashå€¼å‚æ•°]}}xxxxxxxxx{{/helperName}} {{#customHelper nav "normalValue" class="my-class" visible=true counter=4}} {{if name}} aaaaaa {{else}} bbbbbbb {{/if}} {{/customHelper}} Handlebars.registerHelper(&apos;customHelper&apos;, function(context,options) { console.log(arguments[0]);//==&gt;context console.log(arguments[1]);//==&gt;normalValue console.log(arguments[2]);//==&gt;options //è¯´æ˜åœ¨registerHelperå†…éƒ¨,ç¬¬äºŒä¸ªå‚æ•°åŒ¿åå‡½æ•°,åªä¼šå­˜åœ¨3ä¸ªå®å‚ï¼Œç¬¬ä¸€ä¸ªä¸ºå½“å‰ä½¿ç”¨çš„ä¸Šä¸‹æ–‡ï¼Œç¬¬äºŒä¸ªå¦‚æœæœ‰åˆ™ä¸ºä¸€ä¸ªæ™®é€šå€¼å‚æ•°ï¼Œå¦å¤–ä¸€ä¸ªå°±æ˜¯å°è£…äº†å‡½æ•°ç›¸å…³ä¿¡æ¯çš„optionså¯¹è±¡ï¼Œå®ƒæœ‰hash(å°è£…å¥½ä¸€ä¸ªæˆ–å¤šä¸ªé”®å€¼å¯¹å‚æ•°)ã€fn(ä¼ å…¥ä¸€ä¸ªä¸Šä¸‹æ–‡ï¼Œå¹¶åœ¨æ­¤ä¸Šä¸‹æ–‡ä¸­æ‰§è¡ŒcustomHelperæ¨¡æ¿ä¸­çš„{{#if}}åˆ°{{else}}ä¸­çš„æ¨¡æ¿)ã€inverse(åŒfnç›¸åæ‰§è¡Œ{{else}}åˆ°{{/if}}ä¹‹é—´çš„)ã€nameã€dataç­‰å±æ€§ã€‚ }); å‚è€ƒ:http://cnodejs.org/topic/56a2e8b1cd415452622eed2dhttp://www.cnblogs.com/iyangyuan/archive/2013/12/12/3471227.html]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>Handlebars</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[break-wordã€word-wrapã€white-space]]></title>
    <url>%2F2017%2F03%2F10%2Fbreak-word-word-wrap-white-space%2F</url>
    <content type="text"><![CDATA[white-spacewhite-spaceçš„å®šä¹‰æ˜¯ç”¨æ¥è®¾ç½®å¦‚ä½•å¤„ç†å…ƒç´ ä¸­çš„ç©ºç™½ã€‚è¿™é‡Œçš„ç©ºç™½æŒ‡çš„æ˜¯ç©ºæ ¼ã€tabåˆ¶è¡¨ç¬¦ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œhtmlä¸­è¿ç»­å‡ºç°çš„å¤šä¸ªç©ºæ ¼ä¼šè¢«åˆå¹¶æˆä¸€ä¸ªç©ºæ ¼ï¼ŒTabä¹Ÿä¼šè¢«æ›¿æ¢æˆä¸€ä¸ªç©ºæ ¼ã€‚å›è½¦æ¢è¡Œ(bræ¢è¡Œä¸åœ¨å†…)ä¼šè¢«å¿½ç•¥å¹¶å°†å…¶æ›¿æ¢æˆä¸€ä¸ªç©ºæ ¼ã€‚å½“åœ¨å®¹å™¨å‰©ä½™ç©ºé—´ä¸è¶³ä»¥å®¹çº³ä¸€ä¸ªå•è¯æ—¶ï¼Œæµè§ˆå™¨ä¼šåœ¨å•è¯ç»“æŸå¤„è‡ªåŠ¨æ¢è¡Œã€‚(é»˜è®¤æƒ…å†µä¸‹ï¼Œæ˜¯æ— æ³•åœ¨ä¸€ä¸ªå•è¯å†…è¿›è¡Œè‡ªåŠ¨æ¢è¡Œçš„ï¼Œåªèƒ½åœ¨ç»“å°¾å¤„æ¢è¡Œã€‚) å€¼ æ˜¯å¦åˆå¹¶ç©ºç™½ç¬¦(ç©ºæ ¼ã€tab) æ˜¯å¦å¿½ç•¥å›è½¦æ¢è¡Œ æ˜¯å¦å…è®¸è‡ªåŠ¨æ¢è¡Œ normal åˆå¹¶ å¿½ç•¥ å…è®¸ nowrap åˆå¹¶ å¿½ç•¥ ä¸å…è®¸ pre ä¿ç•™ ä¿ç•™ ä¸å…è®¸ pre-wrap ä¿ç•™ ä¿ç•™ å…è®¸ pre-line åˆå¹¶ ä¿ç•™ å…è®¸ word-wrapword-wrapçš„å®šä¹‰æ˜¯ç”¨æ¥è¯´æ˜å½“ä¸€ä¸ªä¸èƒ½è¢«åˆ†å¼€çš„å­—ç¬¦ä¸²å¤ªé•¿è€Œä¸èƒ½å¡«å……å…¶åŒ…è£¹ç›’æ—¶ï¼Œä¸ºé˜²æ­¢å…¶æº¢å‡ºï¼Œæµè§ˆå™¨æ˜¯å¦å…è®¸è¿™æ ·çš„å•è¯ä¸­æ–­æ¢è¡Œã€‚æ—¢æŒ‡æ˜æ˜¯å¦å…è®¸æµè§ˆå™¨åœ¨å•è¯å†…è¿›è¡Œè‡ªåŠ¨æ¢è¡Œ å€¼ è§£é‡Š normal åœ¨å•è¯ç»“æŸå¤„æ¢è¡Œ break-word å¦‚æœè¡Œå†…æ²¡æœ‰å¤šä½™ç©ºé—´å®¹çº³è¯¥å•è¯åˆ°è¡Œå°¾ï¼Œåˆ™ä¼šå¼ºåˆ¶å°†å•è¯æˆªæ–­ï¼Œåœ¨å•è¯å†…è¿›è¡Œæ¢è¡Œ word-breakword-breakæŒ‡å®šäº†æ€æ ·åœ¨å•è¯å†…æ–­è¡Œ å€¼ è§£é‡Š normal é»˜è®¤æ¢è¡Œè§„åˆ™ break-all å¯¹äºnon-CJK (ä¸­æ–‡/æ—¥æ–‡/éŸ©æ–‡) æ–‡æœ¬ï¼Œå¯åœ¨ä»»æ„å­—ç¬¦é—´æ–­è¡Œã€‚ keep-all CJK æ–‡æœ¬ä¸æ–­è¡Œã€‚ Non-CJK æ–‡æœ¬è¡¨ç°åŒ normalã€‚ åœ¨white-spaceã€word-wrapã€word-breakéƒ½ä¸ºnormalå€¼æ—¶ï¼Œæ—¢é»˜è®¤æƒ…å†µä¸‹æ—¶ã€‚ä¸€è¡Œçš„å‰©ä½™ç©ºé—´ä¸è¶³ä»¥å®¹çº³ä¸€ä¸ªå•è¯æ—¶ï¼Œæµè§ˆå™¨ä¼šå°†è¿™ä¸ªå•è¯æŒªåˆ°ä¸‹ä¸€è¡Œæ˜¾ç¤ºã€‚æŒªåå¦‚æœè¿™ä¸ªå•è¯æ¯”å®¹å™¨è¿˜é•¿ï¼Œåˆ™è¿™ä¸ªå•è¯ä¼šç›´æ¥æº¢å‡ºï¼Œå› ä¸ºé»˜è®¤æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨æ˜¯æ— æ³•åœ¨å•è¯å†…è¿›è¡Œæ¢è¡Œçš„ã€‚ä¸­æ–‡ä¼šä¸€è¡Œç©ºé—´ä¸è¶³ä»¥å®¹çº³ä¸€ä¸ªå­—æ—¶ï¼Œåœ¨å­—åè¿›è¡Œæ¢è¡Œ æ­¤æ—¶å¦‚æœè®¾ç½®word-wrap:break-wordï¼Œåˆ™ä¼šå°†è¿™ä¸ªé•¿å•è¯è¿›è¡Œæˆªæ–­ï¼Œä»æˆªæ–­å¤„è¿›è¡Œæ¢è¡Œã€‚ å¯ä»¥å‘ç°ç¬¬ä¸€è¡Œä»ç„¶æœ‰ä¸€ç‚¹ç©ºé—´æ²¡æœ‰åˆ©ç”¨ï¼Œæ­¤æ—¶å°±éœ€è¦ç”¨åˆ°word-break:break-all; å¯ä»¥è¯´word-break:break-allæ˜¯word-wrap:break-wordçš„å‡çº§ç‰ˆæœ¬ï¼Œå®ƒä¸ä¼šåœ¨å‰©ä½™ç©ºé—´ä¸å¤Ÿçš„æ—¶å€™å°†é•¿å•è¯æŒªåˆ°ä¸‹ä¸€è¡Œï¼Œå®ƒå°†å•è¯æ”¾åœ¨åŸä½ï¼Œå¹¶åœ¨å®¹å™¨è¾¹ç•Œå¤„ç›´æ¥å°†è¿™ä¸ªé•¿å•è¯è¿›è¡Œæˆªæ–­ï¼Œç„¶åæ¢è¡Œã€‚ å°†è¿™ä¸‰ä¸ªå±æ€§ï¼Œç»„åˆä½¿ç”¨ä¼šæ€ä¹ˆæ · å½“è®¾ç½®äº†white-space:nowrap;æ—¶ï¼Œword-wrap:break-word;å’Œword-break:break-all;éƒ½å°†å¤±æ•ˆã€‚æ–‡æœ¬å°†ä¼šå¼ºåˆ¶åœ¨ä¸€è¡Œå†…æ˜¾ç¤º å½“åŒæ—¶è®¾ç½®word-wrap:break-word;å’Œword-break:break-allæ—¶ï¼Œword-break:break-allçš„æ•ˆæœä¼šç”Ÿæ•ˆ word-spacingè§„å®šè‹±æ–‡å•è¯ä¹‹é—´çš„é—´è· letter-spacingè§„å®šè‹±æ–‡å­—ç¬¦ä¹‹é—´çš„é—´è· æ€»ç»“: é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ä¸€è¡Œçš„å‰©ä½™ç©ºé—´ä¸è¶³ä»¥å®¹çº³æŸä¸€å•è¯æ—¶ï¼Œæµè§ˆå™¨ä¼šå°†æ­¤å•è¯æ•´ä½“æŒªåˆ°ä¸‹ä¸€è¡Œæ˜¾ç¤ºã€‚æ­¤æ—¶ï¼Œè‹¥è¿™ä¸ªå•è¯è¶…é•¿(é•¿åº¦è¶…å‡ºå®¹å™¨çš„å®½åº¦)ï¼Œåˆ™æ­¤å•è¯ä¼šç›´æ¥æº¢å‡º(æ­¤æ—¶ä¸Šä¸€è¡Œä¼šç•™ä¸‹ä¸€æ®µç©ºç™½)ã€‚ word-wrap:æŒ‡æ˜æ˜¯å¦å…è®¸åœ¨é•¿å•è¯ä¸­æ¢è¡Œï¼Œå½“è®¾ç½®å…¶å±æ€§ä¸ºbreak-wordï¼Œåˆ™ä¼šæŠŠè¶…è¿‡å®¹å™¨é•¿åº¦çš„å•è¯è¿›è¡Œæˆªæ–­ï¼Œå¹¶æ¢è¡Œ(ä¸Šä¸€è¡Œç•™ä¸‹çš„ç©ºç™½å¹¶ä¸ä¼šè¢«æ¸…é™¤) word-break:å½“å…¶è®¾ç½®break-allæ—¶ï¼Œå®ƒæ˜¯word-wrap:break-wordçš„å‡çº§ç‰ˆï¼Œå®ƒèƒ½è§£å†³ä¸Šä¸€è¡Œç•™ç™½é—®é¢˜ã€‚å®ƒä¼šè®©å•è¯å…ˆåœ¨å½“å‰è¡Œæ˜¾ç¤ºï¼Œå½“å•è¯æŸä¸ªå­—ç¬¦åˆ°è¾¾å®¹å™¨è¾¹ç•Œæ—¶ï¼Œä¼šç›´æ¥åœ¨æ­¤å­—ç¬¦å‡ºè¿›è¡Œæˆªæ–­ï¼Œå¹¶æ¢è¡Œã€‚è¿™æ ·å°±æœ€å¤§é™åº¦çš„åˆ©ç”¨äº†ç©ºé—´ã€‚ white-space:æŒ‡å®šå¤„ç†ç©ºç™½ç¬¦çš„æ–¹å¼ï¼Œæ¯”è¾ƒæœ‰ç”¨çš„å±æ€§ä¸ºnowrapï¼Œè®¾ç½®æ–‡æœ¬ä¸æ¢è¡Œã€‚ä¸€èˆ¬é…åˆå…¶å®ƒcsså®ç°æ–‡æœ¬è¿‡é•¿çœç•¥å· word-spacing:è§„å®šè‹±æ–‡å•è¯ä¹‹é—´çš„é—´è· letter-spacing:è§„å®šè‹±æ–‡å•è¯å­—ç¬¦ä¹‹é—´çš„é—´è· å›¾ç‰‡å¼•ç”¨åœ¨è‡ªhttp://www.cnblogs.com/2050/archive/2012/08/10/2632256.html]]></content>
      <categories>
        <category>å‰ç«¯</category>
      </categories>
      <tags>
        <tag>css</tag>
      </tags>
  </entry>
</search>
