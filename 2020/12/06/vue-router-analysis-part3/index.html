<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="vue,vue-router,Ê∫êÁ†ÅËß£Êûê," />








  <link rel="shortcut icon" type="image/x-icon" href="/Avatar.png?v=5.1.0" />






<meta name="description" content="vue-router Ê∫êÁ†ÅËß£Êûê | 6k Â≠ó | Â§öÂõæÈ¢ÑË≠¶ - „Äê‰∏ã„Äë ÂêÑ‰ΩçÂ•ΩÔºåÊàëÊòØÂÖâËæâ üòé Êú¨ÁØáÊòØvue-routerÊ∫êÁ†ÅËß£ÊûêÁöÑ‰∏ãÁØáÔºåÂç≥Êî∂Â∞æÁØá Êú¨ÁØá‰∏ªË¶Å‰ªãÁªç‰∫Ü‰∏ãÈù¢Âá†ÁÇπ ‰ªãÁªç‰∫Üvue-routerÊòØÂ¶Ç‰ΩïÂ§ÑÁêÜÊªöÂä®ÁöÑ view„ÄÅlinkÁªÑ‰ª∂ÈÉΩÊÄé‰πàÂÆûÁé∞ÁöÑÔºü Ë∑ØÁî±ÂèòÂåñÂèàÊòØÊÄé‰πàËß¶ÂèëÈáçÊñ∞Ê∏≤ÊüìÁöÑÁ≠âÁ≠â   Âè¶Â§ñËøòÊòØË¶ÅËØ¥‰∏Ä‰∏ã Á¨¨‰∏ÄÊ¨°ÂÅöÊ∫êÁ†ÅËß£ÊûêÔºåËÇØÂÆöÊúâÂæàÂ§öÈîôËØØÊàñÁêÜËß£‰∏çÂà∞‰ΩçÁöÑÂú∞ÊñπÔºåÊ¨¢ËøéÊåáÊ≠£ ü§û   È°πÁõÆÂú∞ÂùÄ htt">
<meta name="keywords" content="vue,vue-router,Ê∫êÁ†ÅËß£Êûê">
<meta property="og:type" content="article">
<meta property="og:title" content="vue-router-analysis-part3">
<meta property="og:url" content="http://yoursite.com/2020/12/06/vue-router-analysis-part3/index.html">
<meta property="og:site_name" content="BryanAdamssÁöÑÂçöÂÆ¢">
<meta property="og:description" content="vue-router Ê∫êÁ†ÅËß£Êûê | 6k Â≠ó | Â§öÂõæÈ¢ÑË≠¶ - „Äê‰∏ã„Äë ÂêÑ‰ΩçÂ•ΩÔºåÊàëÊòØÂÖâËæâ üòé Êú¨ÁØáÊòØvue-routerÊ∫êÁ†ÅËß£ÊûêÁöÑ‰∏ãÁØáÔºåÂç≥Êî∂Â∞æÁØá Êú¨ÁØá‰∏ªË¶Å‰ªãÁªç‰∫Ü‰∏ãÈù¢Âá†ÁÇπ ‰ªãÁªç‰∫Üvue-routerÊòØÂ¶Ç‰ΩïÂ§ÑÁêÜÊªöÂä®ÁöÑ view„ÄÅlinkÁªÑ‰ª∂ÈÉΩÊÄé‰πàÂÆûÁé∞ÁöÑÔºü Ë∑ØÁî±ÂèòÂåñÂèàÊòØÊÄé‰πàËß¶ÂèëÈáçÊñ∞Ê∏≤ÊüìÁöÑÁ≠âÁ≠â   Âè¶Â§ñËøòÊòØË¶ÅËØ¥‰∏Ä‰∏ã Á¨¨‰∏ÄÊ¨°ÂÅöÊ∫êÁ†ÅËß£ÊûêÔºåËÇØÂÆöÊúâÂæàÂ§öÈîôËØØÊàñÁêÜËß£‰∏çÂà∞‰ΩçÁöÑÂú∞ÊñπÔºåÊ¨¢ËøéÊåáÊ≠£ ü§û   È°πÁõÆÂú∞ÂùÄ htt">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/917b376a388f43faa6c8f8d81f730bcb~tplv-k3u1fbpfcp-watermark.image">
<meta property="og:updated_time" content="2020-12-06T04:24:44.886Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="vue-router-analysis-part3">
<meta name="twitter:description" content="vue-router Ê∫êÁ†ÅËß£Êûê | 6k Â≠ó | Â§öÂõæÈ¢ÑË≠¶ - „Äê‰∏ã„Äë ÂêÑ‰ΩçÂ•ΩÔºåÊàëÊòØÂÖâËæâ üòé Êú¨ÁØáÊòØvue-routerÊ∫êÁ†ÅËß£ÊûêÁöÑ‰∏ãÁØáÔºåÂç≥Êî∂Â∞æÁØá Êú¨ÁØá‰∏ªË¶Å‰ªãÁªç‰∫Ü‰∏ãÈù¢Âá†ÁÇπ ‰ªãÁªç‰∫Üvue-routerÊòØÂ¶Ç‰ΩïÂ§ÑÁêÜÊªöÂä®ÁöÑ view„ÄÅlinkÁªÑ‰ª∂ÈÉΩÊÄé‰πàÂÆûÁé∞ÁöÑÔºü Ë∑ØÁî±ÂèòÂåñÂèàÊòØÊÄé‰πàËß¶ÂèëÈáçÊñ∞Ê∏≤ÊüìÁöÑÁ≠âÁ≠â   Âè¶Â§ñËøòÊòØË¶ÅËØ¥‰∏Ä‰∏ã Á¨¨‰∏ÄÊ¨°ÂÅöÊ∫êÁ†ÅËß£ÊûêÔºåËÇØÂÆöÊúâÂæàÂ§öÈîôËØØÊàñÁêÜËß£‰∏çÂà∞‰ΩçÁöÑÂú∞ÊñπÔºåÊ¨¢ËøéÊåáÊ≠£ ü§û   È°πÁõÆÂú∞ÂùÄ htt">
<meta name="twitter:image" content="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/917b376a388f43faa6c8f8d81f730bcb~tplv-k3u1fbpfcp-watermark.image">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Âçö‰∏ª'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2020/12/06/vue-router-analysis-part3/"/>





  <title> vue-router-analysis-part3 | BryanAdamssÁöÑÂçöÂÆ¢ </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">BryanAdamssÁöÑÂçöÂÆ¢</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">‰∏Ä‰∏™‰º™ÂâçÁ´Ø</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            È¶ñÈ°µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            ÂàÜÁ±ª
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            ÂΩíÊ°£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Ê†áÁ≠æ
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            ÊêúÁ¥¢
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="ÊêúÁ¥¢..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/12/06/vue-router-analysis-part3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="BryanAdamss">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/Avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BryanAdamssÁöÑÂçöÂÆ¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                vue-router-analysis-part3
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">ÂèëË°®‰∫é</span>
              
              <time title="ÂàõÂª∫‰∫é" itemprop="dateCreated datePublished" datetime="2020-12-06T12:13:35+08:00">
                2020-12-06 12:13:35
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">ÂàÜÁ±ª‰∫é</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/FrontEnd/" itemprop="url" rel="index">
                    <span itemprop="name">ÂâçÁ´Ø</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="vue-router-Ê∫êÁ†ÅËß£Êûê-6k-Â≠ó-Â§öÂõæÈ¢ÑË≠¶-„Äê‰∏ã„Äë"><a href="#vue-router-Ê∫êÁ†ÅËß£Êûê-6k-Â≠ó-Â§öÂõæÈ¢ÑË≠¶-„Äê‰∏ã„Äë" class="headerlink" title="vue-router Ê∫êÁ†ÅËß£Êûê | 6k Â≠ó | Â§öÂõæÈ¢ÑË≠¶ - „Äê‰∏ã„Äë"></a>vue-router Ê∫êÁ†ÅËß£Êûê | 6k Â≠ó | Â§öÂõæÈ¢ÑË≠¶ - „Äê‰∏ã„Äë</h1><ul>
<li>ÂêÑ‰ΩçÂ•ΩÔºåÊàëÊòØÂÖâËæâ üòé</li>
<li>Êú¨ÁØáÊòØ<code>vue-router</code>Ê∫êÁ†ÅËß£ÊûêÁöÑ‰∏ãÁØáÔºåÂç≥Êî∂Â∞æÁØá</li>
<li>Êú¨ÁØá‰∏ªË¶Å‰ªãÁªç‰∫Ü‰∏ãÈù¢Âá†ÁÇπ<ul>
<li>‰ªãÁªç‰∫Ü<code>vue-router</code>ÊòØÂ¶Ç‰ΩïÂ§ÑÁêÜÊªöÂä®ÁöÑ</li>
<li><code>view„ÄÅlink</code>ÁªÑ‰ª∂ÈÉΩÊÄé‰πàÂÆûÁé∞ÁöÑÔºü</li>
<li>Ë∑ØÁî±ÂèòÂåñÂèàÊòØÊÄé‰πàËß¶ÂèëÈáçÊñ∞Ê∏≤ÊüìÁöÑÁ≠âÁ≠â</li>
</ul>
</li>
<li>Âè¶Â§ñËøòÊòØË¶ÅËØ¥‰∏Ä‰∏ã<ul>
<li>Á¨¨‰∏ÄÊ¨°ÂÅöÊ∫êÁ†ÅËß£ÊûêÔºåËÇØÂÆöÊúâÂæàÂ§öÈîôËØØÊàñÁêÜËß£‰∏çÂà∞‰ΩçÁöÑÂú∞ÊñπÔºåÊ¨¢ËøéÊåáÊ≠£ ü§û</li>
</ul>
</li>
<li>È°πÁõÆÂú∞ÂùÄ<ul>
<li><code>https://github.com/BryanAdamss/vue-router-for-analysis</code></li>
<li>Â¶ÇÊûúËßâÂæóÂØπ‰Ω†ÊúâÂ∏ÆÂä©ÔºåËÆ∞ÂæóÁªôÊàë‰∏Ä‰∏™<code>star</code>‚ú®</li>
</ul>
</li>
<li>uml ÂõæÊ∫êÊñá‰ª∂<ul>
<li><code>https://github.com/BryanAdamss/vue-router-for-analysis/blob/dev/vue-router.EAP</code></li>
</ul>
</li>
<li>ÂÖ≥ËÅîÊñáÁ´†ÈìæÊé•<ul>
<li><a href="https://juejin.cn/post/6880529850159874062" target="_blank" rel="noopener">vue-router Ê∫êÁ†ÅËß£Êûê | 1.3w Â≠ó | Â§öÂõæÈ¢ÑË≠¶ - „Äê‰∏ä„Äë</a></li>
<li><a href="https://juejin.cn/post/6901047675227996167" target="_blank" rel="noopener">vue-router Ê∫êÁ†ÅËß£Êûê | 1.5w Â≠ó | Â§öÂõæÈ¢ÑË≠¶ - „Äê‰∏≠„Äë</a></li>
<li><a href="https://juejin.cn/post/6902992939115855880" target="_blank" rel="noopener">vue-router Ê∫êÁ†ÅËß£Êûê | 6k Â≠ó - „Äê‰∏ã„Äë</a></li>
</ul>
</li>
</ul>
<h2 id="ÊªöÂä®Â§ÑÁêÜ"><a href="#ÊªöÂä®Â§ÑÁêÜ" class="headerlink" title="ÊªöÂä®Â§ÑÁêÜ"></a>ÊªöÂä®Â§ÑÁêÜ</h2><ul>
<li>Êàë‰ª¨Áü•ÈÅì<code>vue-router</code>ÂèØ‰ª•Â§ÑÁêÜ‰∏Ä‰∫õÊªöÂä®Ë°å‰∏∫Ôºå‰æãÂ¶ÇËÆ∞ÂΩïÈ°µÈù¢ÊªöÂä®‰ΩçÁΩÆÔºåÁÑ∂ÂêéÂú®ÂàáÊç¢Ë∑ØÁî±Êó∂ÊªöÂà∞È°∂ÈÉ®Êàñ‰øùÊåÅÂéüÂÖà‰ΩçÁΩÆÔºõ<ul>
<li><a href="https://router.vuejs.org/zh/guide/advanced/scroll-behavior.html#ÊªöÂä®Ë°å‰∏∫" target="_blank" rel="noopener">https://router.vuejs.org/zh/guide/advanced/scroll-behavior.html#ÊªöÂä®Ë°å‰∏∫</a></li>
</ul>
</li>
<li>ÂÆÉ‰∏ªË¶ÅÊé•Êî∂‰∏Ä‰∏™<code>scrollBehavior</code>ÂèÇÊï∞Ôºå<code>scrollBehavior</code>Êúâ‰ª•‰∏ãÁé©Ê≥ï</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">      routes: [...],</span><br><span class="line">      scrollBehavior (to, <span class="keyword">from</span>, savedPosition) &#123;</span><br><span class="line">        <span class="comment">// return ÊúüÊúõÊªöÂä®Âà∞Âì™‰∏™ÁöÑ‰ΩçÁΩÆ</span></span><br><span class="line">      &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ÊªöÂä®Âà∞ÊåáÂÆöÂùêÊ†á</span></span><br><span class="line">scrollBehavior (to, <span class="keyword">from</span>, savedPosition) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; x: <span class="number">0</span>, y: <span class="number">0</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ÊªöÂä®Âà∞ÊåáÂÆöÈ°µÈù¢ÈîöÁÇπ</span></span><br><span class="line">scrollBehavior (to, <span class="keyword">from</span>, savedPosition) &#123;</span><br><span class="line">  <span class="keyword">if</span> (to.hash) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      selector: to.hash</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// v2.8.0+ ÂºÇÊ≠•ÊªöÂä®</span></span><br><span class="line">scrollBehavior (to, <span class="keyword">from</span>, savedPosition) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">          resolve(&#123; x: <span class="number">0</span>, y: <span class="number">0</span> &#125;)</span><br><span class="line">        &#125;, <span class="number">500</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Êó¢ÊîØÊåÅÊªöÂä®Âà∞ÊåáÂÆö‰ΩçÁΩÆÔºå‰πüÂèØ‰ª•ÊªöÂä®È°µÈù¢Êüê‰∏™È°µÈù¢ÈîöÁÇπ‰ΩçÁΩÆÂíåÂºÇÊ≠•ÊªöÂä®</li>
<li>ÈÇ£ÂÆÉÊòØÂ¶Ç‰ΩïÂÅöÂà∞Âë¢?ÂÖ∑‰ΩìÁöÑÈÄªËæëÂèàÊòØÊÄéÊ†∑ÁöÑÂë¢Ôºü</li>
<li>Êàë‰ª¨ÂâçÈù¢ÈÉΩÁü•ÈÅì<code>HTML5History</code>Âú®ÂàùÂßãÂåñÊó∂Âíå<code>HashHistory</code>Âú®<code>setupListener</code>Êó∂ÈÉΩ‰ºöË∞ÉÁî®<code>setupScroll</code>ÂáΩÊï∞ÔºåÂàùÂßãÂåñÊªöÂä®Áõ∏ÂÖ≥ÁöÑÈÄªËæë</li>
<li>Âπ∂Âú®<code>popstate</code>Êàñ<code>hashchange</code>‰∫ã‰ª∂Ëß¶ÂèëË∑ØÁî±Ë∑≥ËΩ¨Êó∂ÔºåË∞ÉÁî®<code>handleScroll</code>Â§ÑÁêÜÊªöÂä®Ë°å‰∏∫</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/history/hash.js</span></span><br><span class="line"></span><br><span class="line">¬†setupListeners¬†()¬†&#123;</span><br><span class="line">¬†¬†¬†¬†<span class="keyword">const</span>¬†router¬†=¬†<span class="keyword">this</span>.router</span><br><span class="line">¬†¬†¬†¬†<span class="keyword">const</span>¬†expectScroll¬†=¬†router.options.scrollBehavior</span><br><span class="line">¬†¬†¬†¬†<span class="keyword">const</span>¬†supportsScroll¬†=¬†supportsPushState¬†&amp;&amp;¬†expectScroll</span><br><span class="line"></span><br><span class="line">¬†¬†¬†¬†<span class="comment">//¬†Ëã•ÊîØÊåÅscroll,ÂàùÂßãÂåñscrollÁõ∏ÂÖ≥ÈÄªËæë</span></span><br><span class="line">¬†¬†¬†¬†<span class="keyword">if</span>¬†(supportsScroll)¬†&#123;</span><br><span class="line">¬†¬†¬†¬†¬†¬†setupScroll()</span><br><span class="line">¬†¬†¬†¬†&#125;</span><br><span class="line">¬†¬†¬†¬†<span class="comment">//¬†Ê∑ªÂä†‰∫ã‰ª∂ÁõëÂê¨</span></span><br><span class="line">¬†¬†¬†¬†<span class="built_in">window</span>.addEventListener(</span><br><span class="line">¬†¬†¬†¬†¬†¬†supportsPushState¬†?¬†<span class="string">'popstate'</span>¬†:¬†<span class="string">'hashchange'</span>,¬†<span class="comment">//¬†‰ºòÂÖà‰ΩøÁî®popstate</span></span><br><span class="line">¬†¬†¬†¬†¬†¬†()¬†=&gt;¬†&#123;</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†<span class="keyword">const</span>¬†current¬†=¬†<span class="keyword">this</span>.current</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†<span class="keyword">if</span>¬†(!ensureSlash())¬†&#123;</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†<span class="keyword">return</span></span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†&#125;</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†<span class="keyword">this</span>.transitionTo(getHash(),¬†<span class="function"><span class="params">route</span>¬†=&gt;</span>¬†&#123;</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†<span class="keyword">if</span>¬†(supportsScroll)¬†&#123;</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†handleScroll(<span class="keyword">this</span>.router,¬†<span class="comment">/*¬†to*/</span>route,¬†<span class="comment">/*¬†from*/</span>current,¬†<span class="literal">true</span>)</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†&#125;</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†<span class="comment">//¬†‰∏çÊîØÊåÅpushStateÔºåÁõ¥Êé•ÊõøÊç¢ËÆ∞ÂΩï</span></span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†<span class="keyword">if</span>¬†(!supportsPushState)¬†&#123;</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†replaceHash(route.fullPath)</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†&#125;</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†&#125;)</span><br><span class="line">¬†¬†¬†¬†¬†¬†&#125;</span><br><span class="line">¬†¬†¬†¬†)</span><br><span class="line">¬†¬†&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Êàë‰ª¨ÂÖàÁúãÊªöÂä®ÁöÑÂàùÂßãÂåñ</li>
</ul>
<h3 id="setupScroll"><a href="#setupScroll" class="headerlink" title="setupScroll"></a>setupScroll</h3><ul>
<li>‰ª£Á†Å‰Ωç‰∫é<code>src/util/scroll.js</code></li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//¬†ÂàùÂßãÂåñÊªöÂä®Áõ∏ÂÖ≥ÈÄªËæë</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">setupScroll</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">//¬†Fix¬†for¬†#1585¬†for¬†Firefox</span></span><br><span class="line">  <span class="comment">//¬†Fix¬†for¬†#2195¬†Add¬†optional¬†third¬†attribute¬†to¬†workaround¬†a¬†bug¬†in¬†safari¬†https://bugs.webkit.org/show_bug.cgi?id=182678</span></span><br><span class="line">  <span class="comment">//¬†Fix¬†for¬†#2774¬†Support¬†for¬†apps¬†loaded¬†from¬†Windows¬†file¬†shares¬†not¬†mapped¬†to¬†network¬†drives:¬†replaced¬†location.origin¬†with</span></span><br><span class="line">  <span class="comment">//¬†window.location.protocol¬†+¬†'//'¬†+¬†window.location.host</span></span><br><span class="line">  <span class="comment">//¬†location.host¬†contains¬†the¬†port¬†and¬†location.hostname¬†doesn't</span></span><br><span class="line">  <span class="keyword">const</span> protocolAndPath = <span class="built_in">window</span>.location.protocol + <span class="string">'//'</span> + <span class="built_in">window</span>.location.host</span><br><span class="line">  <span class="keyword">const</span> absolutePath = <span class="built_in">window</span>.location.href.replace(protocolAndPath, <span class="string">''</span>) <span class="comment">//¬†preserve¬†existing¬†history¬†state¬†as¬†it¬†could¬†be¬†overriden¬†by¬†the¬†user //¬†Êã∑Ë¥ù‰∏Ä‰ªΩstateÔºåÈò≤Ê≠¢Áî®Êà∑Ë¶ÜÁõñ</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> stateCopy = extend(&#123;&#125;, <span class="built_in">window</span>.history.state)</span><br><span class="line">  stateCopy.key = getStateKey() <span class="comment">//¬†ËØ≠Ê≥ïÂÆö‰πâ:history.replaceState(stateObj,¬†title[,¬†url]);</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">window</span>.history.replaceState(stateCopy, <span class="string">''</span>, absolutePath) <span class="comment">//¬†ÁõëÂê¨popstate(Âè™ËÉΩÈÄöËøáÊµèËßàÂô®ÁöÑ¬†ÂâçËøõ/ÂêéÈÄÄ¬†ÊåâÈíÆËß¶Âèë)Ôºå‰øùÂ≠òÊªöÂä®‰ΩçÁΩÆÔºåÊõ¥Êñ∞stateKey</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">window</span>.addEventListener(<span class="string">'popstate'</span>, <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    saveScrollPosition()</span><br><span class="line">    <span class="keyword">if</span> (e.state &amp;&amp; e.state.key) &#123;</span><br><span class="line">      setStateKey(e.state.key)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ÂèØ‰ª•ÁúãÂà∞ÂÖ∂Âà©Áî®<code>History API</code>ÁöÑÊù•ÂÆåÊàê‰ΩçÁΩÆÁöÑ‰øùÂ≠ò<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/History/replaceState" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/API/History/replaceState</a></li>
</ul>
</li>
<li>Âú®<code>popstate</code>Êó∂ËÆ∞ÂΩïÊªöÂä®‰ΩçÁΩÆÂπ∂Êõ¥Êñ∞Áä∂ÊÄÅ<code>obj</code>ÁöÑ<code>key</code></li>
<li>Ëøô‰∏™<code>key</code>ÊòØÁî®Êù•Âú®<code>state</code>‰∏≠Ê†áËØÜÊØè‰∏™Ë∑ØÁî±Áî®ÁöÑ</li>
<li>ÂèØ‰ª•Áúã‰∏ã<code>key</code>ÁöÑÂ≠òÂèñ</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/util/state-key.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//¬†use¬†User¬†Timing¬†api¬†(if¬†present)¬†for¬†more¬†accurate¬†key¬†precision</span></span><br><span class="line"><span class="keyword">const</span> Time =</span><br><span class="line">  inBrowser &amp;&amp; <span class="built_in">window</span>.performance &amp;&amp; <span class="built_in">window</span>.performance.now</span><br><span class="line">    ? <span class="built_in">window</span>.performance</span><br><span class="line">    : <span class="built_in">Date</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//¬†ÁîüÊàêÂîØ‰∏ÄkeyÔºåÁî®Êù•Âú®state‰∏≠Ê†áËØÜÊØè‰∏™Ë∑ØÁî±</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">genStateKey</span>(<span class="params"></span>): <span class="title">string</span> </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> Time.now().toFixed(<span class="number">3</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> _key: <span class="built_in">string</span> = genStateKey()</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">getStateKey</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> _key</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">setStateKey</span>(<span class="params">key: <span class="built_in">string</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (_key = key)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ÂèØ‰ª•ÁúãÂà∞Â£∞Êòé‰∫Ü‰∏Ä‰∏™<code>_key</code>ÔºåÂÖ∂ÊòØ‰∏Ä‰∏™‰∏â‰ΩçÁöÑÊó∂Èó¥Êà≥ÔºåÊõ¥Êñ∞ÂíåËØªÂèñÈÉΩÊòØÊìç‰ΩúËøô‰∏Ä‰∏™<code>_key</code></li>
<li><code>setupScroll</code>Êó∂ÔºåÈ¶ñÂÖàÊã∑Ë¥ù‰∫ÜÂΩìÂâçÁöÑ<code>state</code>ÔºåÂπ∂‰∏∫ÂÖ∂ÁîüÊàê‰∏Ä‰∏™ÂîØ‰∏Ä<code>key</code></li>
<li>ÈÄöËøá<code>replaceState</code>Â∞ÜÊ∑ªÂä†‰∫Ü<code>key</code>ÁöÑ<code>state</code>‰øùÂ≠òÂà∞ÂΩìÂâçË∑ØÁî±ÁöÑ<code>absolutePath</code>‰∏ä</li>
<li>ÁÑ∂ÂêéÁõëÂê¨<code>popstate</code>‰∫ã‰ª∂ÔºåÂÖ∂Âè™ËÉΩÈÄöËøáÊµèËßàÂô®ÁöÑ   ÂâçËøõ/ÂêéÈÄÄ   ÊåâÈíÆËß¶Âèë</li>
<li>Ëß¶ÂèëÂêé‰ºö‰øùÂ≠òÂΩìÂâç‰ΩçÁΩÆÔºåÂπ∂Êõ¥Êñ∞<code>_key</code></li>
<li>ËøôÊ†∑Â∞±ÂèØ‰ª•Âú®Ë∑ØÁî±ÂèëÁîüÂèòÂåñËß¶Âèë<code>popstate</code>Êó∂Ôºå‰øùÂ≠òÂΩìÂâç‰ΩçÁΩÆÂπ∂ËÆæÁΩÆÂîØ‰∏Ä<code>_key</code></li>
<li>Áúã‰∏ãÂÖ∂ÊòØÂ¶Ç‰ΩïÂ≠òÂèñ‰ΩçÁΩÆ‰ø°ÊÅØÁöÑ</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/util/scroll.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> positionStore = <span class="built_in">Object</span>.create(<span class="literal">null</span>) <span class="comment">//¬†‰øùÂ≠òÈ°µÈù¢ÊªöÂä®‰ΩçÁΩÆ</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">saveScrollPosition</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> key = getStateKey()</span><br><span class="line">  <span class="keyword">if</span> (key) &#123;</span><br><span class="line">    positionStore[key] = &#123;</span><br><span class="line">      x: <span class="built_in">window</span>.pageXOffset,</span><br><span class="line">      y: <span class="built_in">window</span>.pageYOffset,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ÂÖ∂Âà©Áî®<code>positionStore</code>ÂØπË±°ÈÖçÂêàÂîØ‰∏ÄÁöÑ<code>_key</code>Êù•Â≠òÂèñ‰ΩçÁΩÆ</li>
<li>Âú®<code>handleScroll</code>Êó∂Â∞±ÂèØ‰ª•ÈÄöËøá<code>_key</code>ÂèñÂá∫‰πãÂâç‰øùÂ≠òÁöÑ‰ΩçÁΩÆ</li>
</ul>
<h3 id="handleScroll"><a href="#handleScroll" class="headerlink" title="handleScroll"></a>handleScroll</h3><ul>
<li>Â§ÑÁêÜÊªöÂä®ÁöÑ‰ª£Á†Å‰Ωç‰∫é<code>src/util/scroll.js</code></li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">export</span>¬†<span class="function"><span class="keyword">function</span>¬†<span class="title">handleScroll</span>¬†(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">¬†¬†router:¬†Router,</span></span></span><br><span class="line"><span class="function"><span class="params">¬†¬†to:¬†Route,</span></span></span><br><span class="line"><span class="function"><span class="params">¬†¬†<span class="keyword">from</span>:¬†Route,</span></span></span><br><span class="line"><span class="function"><span class="params">¬†¬†isPop:¬†<span class="built_in">boolean</span><span class="comment">//¬†ÊòØÂê¶popstateÔºåÂè™ÊúâÊµèËßàÂô®ÁöÑ¬†ÂâçËøõ/ÂêéÈÄÄ¬†ÊåâÈíÆÊâç‰ºöËß¶ÂèëÔºå‰πüÂè™ÊúâpopstateÊó∂ÔºåÊâç‰ºö‰øùÂ≠òÊªöÂä®‰ΩçÁΩÆ</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span>)¬†</span>&#123;</span><br><span class="line"></span><br><span class="line">¬†¬†<span class="keyword">if</span>¬†(!router.app)¬†&#123;</span><br><span class="line">¬†¬†¬†¬†<span class="keyword">return</span></span><br><span class="line">¬†¬†&#125;</span><br><span class="line">¬†¬†<span class="keyword">const</span>¬†behavior¬†=¬†router.options.scrollBehavior</span><br><span class="line">¬†¬†<span class="keyword">if</span>¬†(!behavior)¬†&#123;</span><br><span class="line">¬†¬†¬†¬†<span class="keyword">return</span></span><br><span class="line">¬†¬†&#125;</span><br><span class="line">¬†¬†<span class="keyword">if</span>¬†(process.env.NODE_ENV¬†!==¬†<span class="string">'production'</span>)¬†&#123;</span><br><span class="line">¬†¬†¬†¬†assert(<span class="keyword">typeof</span>¬†behavior¬†===¬†<span class="string">'function'</span>,¬†<span class="string">`scrollBehavior¬†must¬†be¬†a¬†function`</span>)</span><br><span class="line">¬†¬†&#125;</span><br><span class="line"></span><br><span class="line">¬†¬†<span class="comment">//¬†wait¬†until¬†re-render¬†finishes¬†before¬†scrolling</span></span><br><span class="line">¬†¬†<span class="comment">//¬†ÈáçÊñ∞Ê∏≤ÊüìÁªìÊùüÔºåÂÜçÂ§ÑÁêÜÊªöÂä®</span></span><br><span class="line">¬†¬†router.app.$nextTick(<span class="function"><span class="params">()</span>¬†=&gt;</span>¬†&#123;</span><br><span class="line">¬†¬†¬†¬†<span class="keyword">const</span>¬†position¬†=¬†getScrollPosition()¬†<span class="comment">//¬†Ëé∑Âèñ‰πãÂâç‰øùÂ≠òÁöÑÊªöÂä®‰ΩçÁΩÆ</span></span><br><span class="line"></span><br><span class="line">¬†¬†¬†¬†<span class="comment">//¬†https://router.vuejs.org/zh/guide/advanced/scroll-behavior.html#%E6%BB%9A%E5%8A%A8%E8%A1%8C%E4%B8%BA</span></span><br><span class="line">¬†¬†¬†¬†<span class="keyword">const</span>¬†shouldScroll¬†=¬†behavior.call(</span><br><span class="line">¬†¬†¬†¬†¬†¬†router,</span><br><span class="line">¬†¬†¬†¬†¬†¬†to,</span><br><span class="line">¬†¬†¬†¬†¬†¬†<span class="keyword">from</span>,</span><br><span class="line">¬†¬†¬†¬†¬†¬†isPop¬†?¬†position¬†:¬†<span class="literal">null</span>¬†<span class="comment">//¬†Á¨¨‰∏â‰∏™ÂèÇÊï∞¬†savedPosition¬†ÂΩì‰∏î‰ªÖÂΩì¬†popstate¬†ÂØºËà™¬†(ÈÄöËøáÊµèËßàÂô®ÁöÑ¬†ÂâçËøõ/ÂêéÈÄÄ¬†ÊåâÈíÆËß¶Âèë)¬†Êó∂ÊâçÂèØÁî®„ÄÇ,ÊâÄ‰ª•ÊòØpopstateÊó∂ÔºåÊâçÊúâsavedPosition</span></span><br><span class="line">¬†¬†¬†¬†)</span><br><span class="line">¬†¬†¬†¬†<span class="comment">//¬†ËøîÂõû‰∏Ä‰∏™falsyÂÄºÊó∂Ôºå‰ª£Ë°®‰∏çÈúÄË¶ÅÊªöÂä®</span></span><br><span class="line">¬†¬†¬†¬†<span class="keyword">if</span>¬†(!shouldScroll)¬†&#123;</span><br><span class="line">¬†¬†¬†¬†¬†¬†<span class="keyword">return</span></span><br><span class="line">¬†¬†¬†¬†&#125;</span><br><span class="line"></span><br><span class="line">¬†¬†¬†¬†<span class="comment">//¬†v.2.8.0ÊîØÊåÅÂºÇÊ≠•ÊªöÂä®</span></span><br><span class="line">¬†¬†¬†¬†<span class="comment">//¬†https://router.vuejs.org/zh/guide/advanced/scroll-behavior.html#%E5%BC%82%E6%AD%A5%E6%BB%9A%E5%8A%A8</span></span><br><span class="line">¬†¬†¬†¬†<span class="keyword">if</span>¬†(<span class="keyword">typeof</span>¬†shouldScroll.then¬†===¬†<span class="string">'function'</span>)¬†&#123;</span><br><span class="line">¬†¬†¬†¬†¬†¬†shouldScroll</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†.then(<span class="function"><span class="params">shouldScroll</span>¬†=&gt;</span>¬†&#123;</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†scrollToPosition((shouldScroll:¬†<span class="built_in">any</span>),¬†position)</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†&#125;)</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†.catch(<span class="function"><span class="params">err</span>¬†=&gt;</span>¬†&#123;</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†<span class="keyword">if</span>¬†(process.env.NODE_ENV¬†!==¬†<span class="string">'production'</span>)¬†&#123;</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†assert(<span class="literal">false</span>,¬†err.toString())</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†&#125;</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†&#125;)</span><br><span class="line">¬†¬†¬†¬†&#125;¬†<span class="keyword">else</span>¬†&#123;</span><br><span class="line">¬†¬†¬†¬†¬†¬†scrollToPosition(shouldScroll,¬†position)</span><br><span class="line">¬†¬†¬†¬†&#125;</span><br><span class="line">¬†¬†&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Âú®<code>$nextTick</code>‰∏≠Ë∞ÉÁî®<code>getScrollPosition</code>Ëé∑Âèñ‰πãÂâç‰øùÂ≠òÂ•ΩÁöÑ‰ΩçÁΩÆ</li>
<li>ÂÜçË∞ÉÁî®Êàë‰ª¨‰º†ÂÖ•ÁöÑ<code>scrollBehavior</code>Êü•ÁúãÂÖ∂ËøîÂõûÂÄºÊù•Á°ÆÂÆöÊòØÂê¶ÈúÄË¶ÅËøõË°åÊªöÂä®</li>
<li>ËøòÂà§Êñ≠‰∫Ü‰∏ÄÊ≥¢ÊòØÂê¶ÊòØÂºÇÊ≠•ÊªöÂä®</li>
<li>Ëã•ÊòØÔºåÂàôÁ≠âÂæÖÂÖ∂<code>resolved</code>ÂÜçË∞ÉÁî®<code>scrollToPosition</code></li>
<li>Âê¶ÂàôÁõ¥Êé•Ë∞ÉÁî®<code>scrollToPosition</code></li>
<li><code>getScrollPosition</code>„ÄÅ<code>scrollToPosition</code>‰ª£Á†ÅÂ¶Ç‰∏ã</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/util/scroll.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//¬†Ëé∑Âèñ‰øùÂ≠òÁöÑÊªöÂä®‰ΩçÁΩÆ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getScrollPosition</span>(<span class="params"></span>): ?<span class="title">Object</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> key = getStateKey() <span class="comment">//¬†ÂèñÂîØ‰∏Äkey</span></span><br><span class="line">  <span class="keyword">if</span> (key) &#123;</span><br><span class="line">    <span class="keyword">return</span> positionStore[key] <span class="comment">//¬†Âèñ‰ΩçÁΩÆ</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//¬†ÊªöÂä®Âà∞ÊåáÂÆö‰ΩçÁΩÆÔºåÊîØÊåÅÊªöÂä®Âà∞ÁâπÂÆöÂÖÉÁ¥†</span></span><br><span class="line"><span class="comment">//¬†https://router.vuejs.org/zh/guide/advanced/scroll-behavior.html#%E6%BB%9A%E5%8A%A8%E8%A1%8C%E4%B8%BA</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">scrollToPosition</span>(<span class="params">shouldScroll, position</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> isObject = <span class="keyword">typeof</span> shouldScroll === <span class="string">'object'</span> <span class="comment">//¬†ÊªöÂä®Âà∞ÁâπÂÆödom</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (isObject &amp;&amp; <span class="keyword">typeof</span> shouldScroll.selector === <span class="string">'string'</span>) &#123;</span><br><span class="line">    <span class="comment">//¬†getElementById¬†would¬†still¬†fail¬†if¬†the¬†selector¬†contains¬†a¬†more¬†complicated¬†query¬†like¬†#main[data-attr]</span></span><br><span class="line">    <span class="comment">//¬†but¬†at¬†the¬†same¬†time,¬†it¬†doesn't¬†make¬†much¬†sense¬†to¬†select¬†an¬†element¬†with¬†an¬†id¬†and¬†an¬†extra¬†selector</span></span><br><span class="line">    <span class="keyword">const</span> el = hashStartsWithNumberRE.test(shouldScroll.selector) <span class="comment">//¬†$flow-disable-line</span></span><br><span class="line">      ? <span class="built_in">document</span>.getElementById(shouldScroll.selector.slice(<span class="number">1</span>)) <span class="comment">//¬†$flow-disable-line</span></span><br><span class="line">      : <span class="built_in">document</span>.querySelector(shouldScroll.selector)</span><br><span class="line">    <span class="keyword">if</span> (el) &#123;</span><br><span class="line">      <span class="keyword">let</span> offset =</span><br><span class="line">        shouldScroll.offset &amp;&amp; <span class="keyword">typeof</span> shouldScroll.offset === <span class="string">'object'</span></span><br><span class="line">          ? shouldScroll.offset</span><br><span class="line">          : &#123;&#125;</span><br><span class="line">      offset = normalizeOffset(offset)</span><br><span class="line">      position = getElementPosition(el, offset)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isValidPosition(shouldScroll)) &#123;</span><br><span class="line">      position = normalizePosition(shouldScroll)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isObject &amp;&amp; isValidPosition(shouldScroll)) &#123;</span><br><span class="line">    <span class="comment">//¬†Áõ¥Êé•ÊªöÂä®Âà∞ÊåáÂÆö‰ΩçÁΩÆ</span></span><br><span class="line">    position = normalizePosition(shouldScroll)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (position) &#123;</span><br><span class="line">    <span class="built_in">window</span>.scrollTo(position.x, position.y)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Ëé∑ÂèñÊªöÂä®‰ΩçÁΩÆÔºåÊòØÂà©Áî®<code>_key</code>‰ªé<code>positionStore</code>‰∏äËØªÂèñ‰πãÂâç‰øùÂ≠òÁöÑ‰ΩçÁΩÆ‰ø°ÊÅØ</li>
<li><code>scrollToPosition</code>ÁöÑÈÄªËæëÂæàÊ∏ÖÊô∞ÔºåÂÖ∂Â§ÑÁêÜ‰∫ÜÊªöÂä®Âà∞ÊåáÂÆö<code>dom</code>ÂíåÁõ¥Êé•ÊªöÂä®Âà∞ÁâπÂÆö‰ΩçÁΩÆÁöÑÂú∫ÊôØ</li>
</ul>
<h3 id="Â∞èÁªì"><a href="#Â∞èÁªì" class="headerlink" title="Â∞èÁªì"></a>Â∞èÁªì</h3><ul>
<li><code>vue-router</code>Â§ÑÁêÜÊªöÂä®‰∏ªË¶ÅÂà©Áî®‰∫Ü<code>History API</code>ÂèØ‰ª•‰øùÂ≠òÁä∂ÊÄÅÁöÑÁâπÊÄßÂÆûÁé∞</li>
<li>Âú®Ë∑ØÁî±ËøõÂÖ•Ââç‰øùÂ≠òÊªöÂä®‰ΩçÁΩÆÔºåÂπ∂Âú®‰∏ãÊ¨°Ë∑ØÁî±ÂèòÂåñÊó∂ÔºåÂ∞ùËØïÂèñÂõû‰πãÂâç‰ΩçÁΩÆÔºåÂú®<code>$nextTick</code>‰∏≠ÁúüÊ≠£ÁöÑÂ§ÑÁêÜÊªöÂä®</li>
<li>ÂÖ∂ÊîØÊåÅÊªöÂä®Âà∞ÊåáÂÆö‰ΩçÁΩÆ„ÄÅÊåáÂÆö DOM„ÄÅÂºÇÊ≠•ÊªöÂä®Á≠âÂú∫ÊôØ</li>
</ul>
<h2 id="view-ÁªÑ‰ª∂"><a href="#view-ÁªÑ‰ª∂" class="headerlink" title="view ÁªÑ‰ª∂"></a>view ÁªÑ‰ª∂</h2><ul>
<li><code>vue-router</code>ÂÜÖÁΩÆ‰∫Ü<code>router-view</code>„ÄÅ<code>router-link</code>‰∏§‰∏™ÁªÑ‰ª∂</li>
<li>ÂâçËÄÖË¥üË¥£Âú®ÂåπÈÖçÂà∞Ë∑ØÁî±ËÆ∞ÂΩïÂêéÂ∞ÜÂØπÂ∫îË∑ØÁî±ÁªÑ‰ª∂Ê∏≤ÊüìÂá∫Êù•</li>
<li>ÂêéËÄÖÊîØÊåÅÁî®Êà∑Âú®ÂÖ∑ÊúâË∑ØÁî±ÂäüËÉΩÁöÑÂ∫îÁî®‰∏≠ (ÁÇπÂáª) ÂØºËà™</li>
<li>Êàë‰ª¨ÂÖàÊù•Áúã<code>router-view</code>ÁªÑ‰ª∂</li>
</ul>
<h3 id="router-view"><a href="#router-view" class="headerlink" title="router-view"></a>router-view</h3><ul>
<li><code>router-view</code>ÁöÑ‰∏ªË¶ÅËÅåË¥£Â∞±ÊòØÂ∞ÜË∑ØÁî±ÁªÑ‰ª∂Ê∏≤ÊüìÂá∫Êù•</li>
<li>ÂÆö‰πâ‰Ωç‰∫é<code>src/components/view.js</code></li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/components/view.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">'RouterView'</span>,</span><br><span class="line">  <span class="function"><span class="keyword">function</span><span class="title">al</span>: <span class="title">true</span>, //¬†ÂáΩÊï∞ÂºèÁªÑ‰ª∂ÔºåÊ≤°Êúâ<span class="title">this</span>Ôºõ<span class="title">https</span>://<span class="title">cn</span>.<span class="title">vuejs</span>.<span class="title">org</span>/<span class="title">v2</span>/<span class="title">guide</span>/<span class="title">render</span>-<span class="function"><span class="keyword">function</span>.<span class="title">html</span>#ÂáΩÊï∞ÂºèÁªÑ‰ª∂</span></span></span><br><span class="line"><span class="function"><span class="function">  <span class="title">props</span>: </span>&#123;</span></span><br><span class="line"><span class="function">    <span class="title">name</span>: </span>&#123;</span><br><span class="line">      <span class="keyword">type</span>: <span class="built_in">String</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="string">'default'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;, <span class="comment">//¬†_‰∏∫hÂç≥createElementÔºå‰ΩÜrouter-viewÊ≤°Êúâ‰ΩøÁî®Ëá™Ë∫´ÁöÑhÔºåËÄåÊòØ‰ΩøÁî®‰∫ÜÁà∂ËäÇÁÇπÁöÑh</span></span><br><span class="line">  render(<span class="comment">/*¬†h*/</span> _, <span class="comment">/*¬†context*/</span> &#123; props, children, parent, data &#125;) &#123;</span><br><span class="line">    <span class="comment">//¬†used¬†by¬†devtools¬†to¬†display¬†a¬†router-view¬†badge</span></span><br><span class="line">    data.routerView = <span class="literal">true</span> <span class="comment">//¬†Ê†áËØÜÂΩìÂâçÁªÑ‰ª∂‰∏∫router-view //¬†directly¬†use¬†parent¬†context's¬†createElement()¬†function //¬†so¬†that¬†components¬†rendered¬†by¬†router-view¬†can¬†resolve¬†named¬†slots</span></span><br><span class="line">    <span class="keyword">const</span> h = parent.$createElement <span class="comment">//¬†‰ΩøÁî®Áà∂ËäÇÁÇπÁöÑÊ∏≤ÊüìÂáΩÊï∞</span></span><br><span class="line">    <span class="keyword">const</span> name = props.name <span class="comment">//¬†ÂëΩÂêçËßÜÂõæ</span></span><br><span class="line">    <span class="keyword">const</span> route = parent.$route <span class="comment">//¬†‰æùËµñÁà∂ËäÇÁÇπÁöÑ$routeÔºåËÄåÂú®install.js‰∏≠Êàë‰ª¨Áü•ÈÅì,ÊâÄÊúâÁªÑ‰ª∂ËÆøÈóÆÂà∞ÁöÑ$routeÂÖ∂ÂÆûÈÉΩÊòØ_routerRoot._routeÔºåÂç≥VueÊ†πÂÆû‰æã‰∏äÁöÑ_routeÔºõÂΩìË∑ØÁî±Ë¢´Á°ÆËÆ§ÂêéÔºåË∞ÉÁî®updateRouteÊó∂Ôºå‰ºöÊõ¥Êñ∞_routerRoot._routeÔºåËøõËÄåÂØºËá¥router-viewÁªÑ‰ª∂ÈáçÊñ∞Ê∏≤Êüì //¬†ÁºìÂ≠ò</span></span><br><span class="line">    <span class="keyword">const</span> cache = parent._routerViewCache || (parent._routerViewCache = &#123;&#125;) <span class="comment">//¬†determine¬†current¬†view¬†depth,¬†also¬†check¬†to¬†see¬†if¬†the¬†tree //¬†has¬†been¬†toggled¬†inactive¬†but¬†kept-alive.</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> depth = <span class="number">0</span> <span class="comment">//¬†ÂΩìÂâçrouter-viewÂµåÂ•óÊ∑±Â∫¶</span></span><br><span class="line">    <span class="keyword">let</span> inactive = <span class="literal">false</span> <span class="comment">//¬†ÊòØÂê¶Ë¢´keep-aliveÂåÖË£πÂπ∂Â§Ñ‰∫éÈùûÊøÄÊ¥ªÁä∂ÊÄÅ //¬†Âêë‰∏äÊü•ÊâæÔºåËÆ°ÁÆódepth„ÄÅinactive //¬†ÂΩìparentÊåáÂêëVueÊ†πÂÆû‰æãÁªìÊùüÂæ™ÁéØ</span></span><br><span class="line">    <span class="keyword">while</span> (parent &amp;&amp; parent._routerRoot !== parent) &#123;</span><br><span class="line">      <span class="keyword">const</span> vnodeData = parent.$vnode ? parent.$vnode.data : &#123;&#125;</span><br><span class="line">      <span class="keyword">if</span> (vnodeData.routerView) &#123;</span><br><span class="line">        depth++</span><br><span class="line">      &#125; <span class="comment">//¬†Â§ÑÁêÜkeep-alive //¬†keep-aliveÁªÑ‰ª∂‰ºöÊ∑ªÂä†keepAlive=trueÊ†áËØÜ //¬†https://github.com/vuejs/vue/blob/52719ccab8fccffbdf497b96d3731dc86f04c1ce/src/core/components/keep-alive.js#L120</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (vnodeData.keepAlive &amp;&amp; parent._directInactive &amp;&amp; parent._inactive) &#123;</span><br><span class="line">        inactive = <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">      parent = parent.$parent</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    data.routerViewDepth = depth <span class="comment">//¬†render¬†previous¬†view¬†if¬†the¬†tree¬†is¬†inactive¬†and¬†kept-alive //¬†Â¶ÇÊûúÂΩìÂâçÁªÑ‰ª∂Ê†ëË¢´keep-aliveÂåÖË£πÔºå‰∏îÂ§Ñ‰∫éÈùûÊøÄÊ¥ªÁä∂ÊÄÅÔºåÂàôÊ∏≤Êüì‰πãÂâç‰øùÂ≠òÁöÑËßÜÂõæ</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (inactive) &#123;</span><br><span class="line">      <span class="keyword">const</span> cachedData = cache[name]</span><br><span class="line">      <span class="keyword">const</span> cachedComponent = cachedData &amp;&amp; cachedData.component <span class="comment">//¬†ÊâæÂà∞ÁºìÂ≠òÁöÑÁªÑ‰ª∂</span></span><br><span class="line">      <span class="keyword">if</span> (cachedComponent) &#123;</span><br><span class="line">        <span class="comment">//¬†#2301</span></span><br><span class="line">        <span class="comment">//¬†pass¬†props</span></span><br><span class="line">        <span class="comment">//¬†‰º†ÈÄíÁºìÂ≠òÁöÑprops</span></span><br><span class="line">        <span class="keyword">if</span> (cachedData.configProps) &#123;</span><br><span class="line">          fillPropsinData(</span><br><span class="line">            cachedComponent,</span><br><span class="line">            data,</span><br><span class="line">            cachedData.route,</span><br><span class="line">            cachedData.configProps</span><br><span class="line">          )</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> h(cachedComponent, data, children)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//¬†Êú™ÊâæÂà∞ÁºìÂ≠òÁöÑÁªÑ‰ª∂</span></span><br><span class="line">        <span class="comment">//¬†render¬†previous¬†empty¬†view</span></span><br><span class="line">        <span class="keyword">return</span> h()</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="comment">//¬†ÈÄöËøádepthËé∑ÂèñÂåπÈÖçÁöÑroute¬†record //¬†Áî±‰∫éformatMatchÊòØÈÄöËøáunshiftÊ∑ªÂä†Áà∂route¬†recordÁöÑ //¬†ÊâÄ‰ª•route.matched[depth]Ê≠£Â•ΩËÉΩÂèñÂà∞ÂåπÈÖçÁöÑroute¬†record</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> matched = route.matched[depth]</span><br><span class="line">    <span class="keyword">const</span> component = matched &amp;&amp; matched.components[name] <span class="comment">//¬†ÂèñÂá∫Ë∑ØÁî±ÁªÑ‰ª∂ //¬†render¬†empty¬†node¬†if¬†no¬†matched¬†route¬†or¬†no¬†config¬†component //¬†Êâæ‰∏çÂà∞ÔºåÊ∏≤ÊüìÁ©∫ÁªÑ‰ª∂</span></span><br><span class="line">    <span class="keyword">if</span> (!matched || !component) &#123;</span><br><span class="line">      cache[name] = <span class="literal">null</span></span><br><span class="line">      <span class="keyword">return</span> h()</span><br><span class="line">    &#125; <span class="comment">//¬†cache¬†component //¬†ÁºìÂ≠òÁªÑ‰ª∂</span></span><br><span class="line"></span><br><span class="line">    cache[name] = &#123; component &#125; <span class="comment">//¬†attach¬†instance¬†registration¬†hook //¬†this¬†will¬†be¬†called¬†in¬†the¬†instance's¬†injected¬†lifecycle¬†hooks //¬†‰∏∫Ë∑ØÁî±ËÆ∞ÂΩïÁªëÂÆöË∑ØÁî±ÁªÑ‰ª∂ÔºåÂú®ÊâÄÊúâÁªÑ‰ª∂ÁöÑbeforeCreate„ÄÅdestoryed¬†hook‰∏≠Ë∞ÉÁî®ÔºåËßÅinstall.js‰∏≠ÁöÑregisterInstanceÊñπÊ≥ï //¬†Ê≠§ÊñπÊ≥ïÂè™Âú®router-view‰∏äÂÆö‰πâ‰∫Ü //¬†vmÔºåvalÈÉΩ‰∏∫Ë∑ØÁî±ÁªÑ‰ª∂ÂÆû‰æã //¬†Â¶Ç‰∏ã //¬†matched.instances:&#123; //¬†¬†¬†default:VueComp, //¬†¬†¬†hd:VueComp2, //¬†¬†¬†bd:VueComp3 //¬†&#125;</span></span><br><span class="line"></span><br><span class="line">    data.registerRouteInstance = <span class="function">(<span class="params">vm, val</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">//¬†val¬†could¬†be¬†undefined¬†for¬†unregistration</span></span><br><span class="line">      <span class="keyword">const</span> current = matched.instances[name]</span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        (val &amp;&amp; current !== vm) || <span class="comment">//¬†ÁªëÂÆö</span></span><br><span class="line">        (!val &amp;&amp; current === vm)</span><br><span class="line">      ) &#123;</span><br><span class="line">        <span class="comment">//¬†Ëã•val‰∏çÂ≠òÂú®ÔºåÂàôÂèØËßÜ‰∏∫Ëß£Áªë</span></span><br><span class="line">        matched.instances[name] = val</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="comment">//¬†also¬†register¬†instance¬†in¬†prepatch¬†hook //¬†in¬†case¬†the¬†same¬†component¬†instance¬†is¬†reused¬†across¬†different¬†routes //¬†ÂΩìÁõ∏ÂêåÁªÑ‰ª∂Âú®‰∏çÂêåË∑ØÁî±Èó¥Â§çÁî®Êó∂Ôºå‰πüÈúÄË¶Å‰∏∫router-viewÁªëÂÆöË∑ØÁî±ÁªÑ‰ª∂</span></span><br><span class="line">    ;<span class="function">(<span class="params">data.hook || (<span class="params">data.hook = &#123;&#125;</span>)</span>).<span class="params">prepatch</span> = (<span class="params">_, vnode</span>) =&gt;</span> &#123;</span><br><span class="line">      matched.instances[name] = vnode.componentInstance</span><br><span class="line">    &#125; <span class="comment">//¬†register¬†instance¬†in¬†init¬†hook //¬†in¬†case¬†kept-alive¬†component¬†be¬†actived¬†when¬†routes¬†changed //¬†keep-aliveÁªÑ‰ª∂Ë¢´ÊøÄÊ¥ªÊó∂ÔºåÈúÄË¶Å‰∏∫router-viewÊ≥®ÂÜåË∑ØÁî±ÁªÑ‰ª∂</span></span><br><span class="line"></span><br><span class="line">    data.hook.init = <span class="function">(<span class="params">vnode</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (</span><br><span class="line">        vnode.data.keepAlive &amp;&amp;</span><br><span class="line">        vnode.componentInstance &amp;&amp;</span><br><span class="line">        vnode.componentInstance !== matched.instances[name]</span><br><span class="line">      ) &#123;</span><br><span class="line">        matched.instances[name] = vnode.componentInstance</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="comment">//¬†route¬†recordËÆæÁΩÆ‰∫ÜË∑ØÁî±‰º†ÂèÇÔºõÂä®ÊÄÅË∑ØÁî±‰º†ÂèÇÔºõhttps://router.vuejs.org/zh/guide/essentials/passing-props.</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> configProps = matched.props &amp;&amp; matched.props[name] <span class="comment">//¬†save¬†route¬†and¬†configProps¬†in¬†cachce //¬†Â¶ÇÊûúËÆæÁΩÆ‰∫ÜË∑ØÁî±‰º†ÂèÇÔºåÂàôÁºìÂ≠òËµ∑Êù•ÔºåÂπ∂Â∞ÜÂ°´ÂÖÖprops</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (configProps) &#123;</span><br><span class="line">      extend(cache[name], &#123;</span><br><span class="line">        route,</span><br><span class="line">        configProps,</span><br><span class="line">      &#125;)</span><br><span class="line">      fillPropsinData(component, data, route, configProps)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> h(component, data, children)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ÂÖ∂Ë¢´ÂÆö‰πâÊàê‰∏Ä‰∏™ÂáΩÊï∞ÂºèÁªÑ‰ª∂ÔºåËøô‰ª£Ë°®ÂÆÉÊ≤°ÊúâÁä∂ÊÄÅÂíåÂÆû‰æã(this ‰∏ä‰∏ãÊñá)ÔºåÂè™Êé•Êî∂‰∫Ü<code>name</code>Êù•ÂÅöÂëΩÂêçËßÜÂõæ</li>
<li>Êàë‰ª¨ÈáçÁÇπÁúã‰∏ã<code>render</code>ÊñπÊ≥ï</li>
<li>Áî±‰∫éÂÖ∂ÊòØ‰∏Ä‰∏™ÂáΩÊï∞ÂºèÁªÑ‰ª∂ÔºåÊâÄ‰ª•ÂæàÂ§öÊìç‰ΩúÊòØÂÄüÂä©Áà∂ËäÇÁÇπÊù•ÂÆåÊàêÁöÑ<ul>
<li>‰∏∫‰∫ÜÊîØÊåÅËß£ÊûêÂëΩÂêçÊèíÊßΩÔºåÂÖ∂Ê≤°Êúâ‰ΩøÁî®Ëá™Â∑±ÁöÑ<code>createElement</code>ÊñπÊ≥ïÔºåËÄåÊòØ‰ΩøÁî®Áà∂ËäÇÁÇπÁöÑ<code>createElement</code>ÊñπÊ≥ï</li>
<li>Áî±‰∫éÊ≤°Êúâ this ‰∏ä‰∏ãÊñáÔºåÊó†Ê≥ïÈÄöËøá<code>this.$route</code>Ëé∑ÂæóÂΩìÂâçË∑ØÁî±ÂØπË±°ÔºåÂπ≤ËÑÜÂ∞±Áõ¥Êé•‰ΩøÁî®Áà∂ËäÇÁÇπÁöÑ<code>$route</code></li>
</ul>
</li>
<li>ÂèØ‰ª•ÁúãÂà∞Ê∑ªÂä†‰∫Ü‰∏Ä‰∏™Ê†áÂøóÈáè<code>routerView</code>Ôºå‰∏ªË¶ÅÁî®Êù•Âú®<code>vue-devtools</code>‰∏≠Ê†áËØÜ<code>view</code>ÁªÑ‰ª∂ÂíåÂú®Êü•ÊâæÊ∑±Â∫¶Êó∂Áî®</li>
<li>ÁÑ∂ÂêéÂ£∞Êòé‰∫Ü‰∏Ä‰∏™ÁºìÂ≠òÂØπË±°<code>_routerViewCache</code>Âπ∂ËµãÂÄºÁªô<code>cache</code>ÂèòÈáèÔºåÁî®Êù•Âú®<code>keep-alive</code>ÊøÄÊ¥ªÊó∂Âø´ÈÄüÂèñÂá∫Ë¢´ÁºìÂ≠òÁöÑË∑ØÁî±ÁªÑ‰ª∂</li>
<li>ÂºÄÂßã‰ªéÂΩìÂâçËäÇÁÇπÂæÄ‰∏äÊü•Êâæ<code>VueÊ†πÂÆû‰æã</code>ÔºåÂú®Êü•ÊâæÁöÑËøáÁ®ã‰∏≠ËÆ°ÁÆóÂá∫<code>view</code>ÁªÑ‰ª∂ÁöÑÊ∑±Â∫¶‰ª•ÂèäÊòØÂê¶Ë¢´<code>kepp-alive</code>ÂåÖË£πÂπ∂Â§Ñ‰∫é<code>inative</code>Áä∂ÊÄÅ</li>
<li><code>depth</code>‰∏ªË¶ÅÁî®Êù•Ëé∑ÂèñÂΩìÂâç<code>view</code>ÂØπÂ∫îÁöÑË∑ØÁî±ËÆ∞ÂΩï<ul>
<li>ÂâçÈù¢ËØ¥ËøáÔºå<code>vue-router</code>ÊòØÊîØÊåÅÂµåÂ•óË∑ØÁî±ÁöÑÔºåÂØπÂ∫îÁöÑ<code>view</code>‰πüÊòØÂèØ‰ª•ÂµåÂ•óÁöÑ</li>
<li>ËÄå‰∏îÂú®ÂåπÈÖçË∑ØÁî±ËÆ∞ÂΩïÊó∂ÔºåÊúâ‰∏ãÈù¢ÁöÑÈÄªËæëÔºå<code>ÂΩì‰∏Ä‰∏™Ë∑ØÁî±ËÆ∞ÂΩïÂåπÈÖç‰∫ÜÔºåÂ¶ÇÊûúÂÖ∂ËøòÊúâÁà∂Ë∑ØÁî±ËÆ∞ÂΩïÔºåÂàôÁà∂Ë∑ØÁî±ËÆ∞ÂΩïËÇØÂÆö‰πüÊòØÂåπÈÖçÁöÑ</code>ÔºåÂÖ∂‰ºö‰∏ÄÁõ¥Âêë‰∏äÊü•ÊâæÔºåÊâæÂà∞‰∏Ä‰∏™Áà∂ËÆ∞ÂΩïÔºåÂ∞±ÈÄöËøá<code>unshift</code>Â°ûÂÖ•<code>route.matched</code>Êï∞ÁªÑ‰∏≠ÁöÑÔºåÊâÄ‰ª•Áà∂ËÆ∞ÂΩïËÇØÂÆöÂú®ÂâçÔºåÂ≠êËÆ∞ÂΩïÂú®ÂêéÔºåÂΩìÂâçÁ≤æÂáÜÂåπÈÖçÁöÑËÆ∞ÂΩïÂú®ÊúÄÂêé<ul>
<li>ËßÅ<code>src/util/route.js formatMatchÊñπÊ≥ï</code></li>
</ul>
</li>
<li><code>depth</code>ÁöÑËÆ°ÁÆóÂú®ÈÅáÂà∞<code>Áà∂view</code>ÁªÑ‰ª∂Êó∂ÔºåËá™Â¢û 1ÔºåÈÄöËøá‰∏çÊñ≠Âêë‰∏äÊü•ÊâæÔºå‰∏çÊñ≠Ëá™Â¢û<code>depth</code>ÔºåÁõ¥Âà∞ÊâæÂà∞<code>VueÊ†πÂÆû‰æã</code>ÊâçÂÅúÊ≠¢</li>
<li>ÂÅúÊ≠¢Êó∂<code>route.matched[depth]</code>ÂÄºÂ∞±ÊòØÂΩìÂâç<code>view</code>ÂØπÂ∫îÁöÑË∑ØÁî±ËÆ∞ÂΩï</li>
<li>Êúâ‰∫ÜË∑ØÁî±ËÆ∞ÂΩïÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•‰ªé‰∏äÂèñÂá∫ÂØπÂ∫îÁöÑË∑ØÁî±ÁªÑ‰ª∂ÂÆû‰æãÔºåÁÑ∂ÂêéÊ∏≤ÊüìÂç≥ÂèØ<ul>
<li>ÂÖ≥‰∫éË∑ØÁî±ËÆ∞ÂΩïÂíåË∑ØÁî±ÁªÑ‰ª∂ÂÆû‰æãÊòØÂ¶Ç‰ΩïÁªëÂÆöÁöÑÔºåÊàë‰ª¨‰∏ãÈù¢‰ºöËÆ≤</li>
</ul>
</li>
</ul>
</li>
<li>Êàë‰ª¨ÂÖàÁúã<code>Èùûinactive</code>Áä∂ÊÄÅÊòØÂ¶Ç‰ΩïÊ∏≤ÊüìË∑ØÁî±ÁªÑ‰ª∂ÂÆû‰æãÁöÑ<ul>
<li>ÈÄöËøá<code>route.matched[depth]</code>ÂèñÂá∫ÂΩìÂâç<code>view</code>ÂåπÈÖçÁöÑË∑ØÁî±ËÆ∞ÂΩï</li>
<li>ÁÑ∂ÂêéÂÜçÂèñÂá∫ÂØπÂ∫îÁöÑË∑ØÁî±ÁªÑ‰ª∂ÂÆû‰æã</li>
<li>Â¶ÇÊûúË∑ØÁî±ËÆ∞ÂΩïÂíåË∑ØÁî±ÁªÑ‰ª∂ÂÆû‰æãÊúâ‰∏Ä‰∏™‰∏çÂ≠òÂú®ÔºåÂàôÊ∏≤ÊüìÁ©∫ÁªìÁÇπÔºåÂπ∂ÈáçÁΩÆ<code>cache[name]</code>ÂÄº</li>
<li>Â¶ÇÊûúÈÉΩËÉΩÊâæÂà∞ÔºåÂàôÂÖàÊääÁªÑ‰ª∂ÂÆû‰æãÁºìÂ≠ò‰∏ãÊù•<ul>
<li>Â¶ÇÊûúÊúâÈÖçÁΩÆÂä®ÊÄÅË∑ØÁî±ÂèÇÊï∞ÔºåÂàôÊääË∑ØÁî±ÂèÇÊï∞ÁºìÂ≠òÂà∞Ë∑ØÁî±ÁªÑ‰ª∂ÂÆû‰æã‰∏äÔºåÂπ∂Ë∞ÉÁî®<code>fillPropsinData</code>Â°´ÂÖÖ<code>props</code></li>
</ul>
</li>
<li>Ë∞ÉÁî®<code>h</code>Ê∏≤ÊüìÂØπÂ∫îÁöÑË∑ØÁî±ÁªÑ‰ª∂ÂÆû‰æãÂç≥ÂèØ</li>
</ul>
</li>
<li>ÂΩìÁªÑ‰ª∂Â§Ñ‰∫é<code>inactive</code>Áä∂ÊÄÅÊó∂ÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•‰ªé<code>cache</code>‰∏≠ÂèñÂá∫‰πãÂâçÁºìÂ≠òÁöÑË∑ØÁî±ÁªÑ‰ª∂ÂÆû‰æãÂíåË∑ØÁî±ÂèÇÊï∞ÔºåÁÑ∂ÂêéÊ∏≤ÊüìÂ∞±ÂèØ‰ª•‰∫Ü</li>
<li>‰∏ªÊµÅÁ®ãÂ¶Ç‰∏äÔºå‰ΩÜËøòÊúâ‰∏Ä‰∏™ÈáçË¶ÅÁöÑÁÇπÊ≤°Êèê<ul>
<li>Ë∑ØÁî±ËÆ∞ÂΩïÂíåË∑ØÁî±ÁªÑ‰ª∂ÂÆû‰æãÊòØÂ¶Ç‰ΩïÁªëÂÆöÁöÑÔºü</li>
<li>Áõ∏‰ø°‰Ω†Â∑≤ÁªèÊ≥®ÊÑèÂà∞<code>data.registerRouteInstance</code>ÊñπÊ≥ïÔºåÊ≤°ÈîôÔºå‰ªñÂ∞±ÊòØÁî®Êù•‰∏∫Ë∑ØÁî±ËÆ∞ÂΩïÁªëÂÆöË∑ØÁî±ÁªÑ‰ª∂ÂÆû‰æãÁöÑ</li>
</ul>
</li>
</ul>
<h3 id="registerInstance"><a href="#registerInstance" class="headerlink" title="registerInstance"></a>registerInstance</h3><ul>
<li>Êàë‰ª¨ÂÖàÁúã‰∏ãË∞ÉÁî®ÁöÑÂú∞Êñπ</li>
<li>‰∏ªË¶ÅÂú®<code>src/install.js</code>ÁöÑÂÖ®Â±ÄÊ∑∑ÂÖ•‰∏≠</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">install</span>(<span class="params">Vue</span>)</span>&#123;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment">//¬†Ê≥®ÂÜåÂÖ®Â±ÄÊ∑∑ÂÖ•</span></span><br><span class="line">¬†¬†Vue.mixin(&#123;</span><br><span class="line">¬†¬†¬†¬†beforeCreate¬†()¬†&#123;</span><br><span class="line">        ...¬†</span><br><span class="line"></span><br><span class="line">¬†¬†¬†¬†¬†¬†<span class="comment">//¬†‰∏∫router-viewÁªÑ‰ª∂ÂÖ≥ËÅîË∑ØÁî±ÁªÑ‰ª∂</span></span><br><span class="line">¬†¬†¬†¬†¬†¬†registerInstance(<span class="keyword">this</span>,¬†<span class="keyword">this</span>)</span><br><span class="line">¬†¬†¬†¬†&#125;,</span><br><span class="line">¬†¬†¬†¬†destroyed¬†()¬†&#123;</span><br><span class="line">¬†¬†¬†¬†¬†¬†<span class="comment">//¬†destroyed¬†hookËß¶ÂèëÊó∂ÔºåÂèñÊ∂àrouter-viewÂíåË∑ØÁî±ÁªÑ‰ª∂ÁöÑÂÖ≥ËÅî</span></span><br><span class="line">¬†¬†¬†¬†¬†¬†registerInstance(<span class="keyword">this</span>)</span><br><span class="line">¬†¬†¬†¬†&#125;</span><br><span class="line">¬†¬†&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ÂèØ‰ª•ÁúãÂà∞ÂÖ∂Âú®ÂÖ®Â±ÄÊ∑∑ÂÖ•ÁöÑ<code>beforeCreate</code>„ÄÅ<code>destroyed</code>Èí©Â≠ê‰∏≠ÈÉΩÊúâË¢´Ë∞ÉÁî®</li>
<li>ÂâçËÄÖ‰º†ÂÖ•‰∫Ü‰∏§‰∏™ vm ÂÆû‰æãÔºåÂêéËÄÖÂè™‰º†ÂÖ•‰∫Ü‰∏Ä‰∏™ vm ÂÆû‰æã</li>
<li>Êàë‰ª¨Áúã‰∏ãÂÆûÁé∞Ôºå‰ª£Á†Å‰πü‰Ωç‰∫é<code>src/install.js</code>‰∏≠</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//¬†‰∏∫Ë∑ØÁî±ËÆ∞ÂΩï„ÄÅrouter-viewÂÖ≥ËÅîË∑ØÁî±ÁªÑ‰ª∂</span></span><br><span class="line"><span class="keyword">const</span> registerInstance = <span class="function">(<span class="params">vm, callVal</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> i = vm.$options._parentVnode <span class="comment">//¬†Ë∞ÉÁî®vm.$options._parentVnode.data.registerRouteInstanceÊñπÊ≥ï //¬†ËÄåËøô‰∏™ÊñπÊ≥ïÂè™Âú®router-viewÁªÑ‰ª∂‰∏≠Â≠òÂú®Ôºårouter-viewÁªÑ‰ª∂ÂÆö‰πâÂú®(../components/view.js¬†@71Ë°å) //¬†ÊâÄ‰ª•ÔºåÂ¶ÇÊûúvmÁöÑÁà∂ËäÇÁÇπ‰∏∫router-viewÔºåÂàô‰∏∫router-viewÂÖ≥ËÅîÂΩìÂâçvmÔºåÂç≥Â∞ÜÂΩìÂâçvmÂÅö‰∏∫router-viewÁöÑË∑ØÁî±ÁªÑ‰ª∂</span></span><br><span class="line">  <span class="keyword">if</span> (isDef(i) &amp;&amp; isDef((i = i.data)) &amp;&amp; isDef((i = i.registerRouteInstance))) &#123;</span><br><span class="line">    i(vm, callVal)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ÂèØ‰ª•ÁúãÂà∞ÂÖ∂Êé•Êî∂‰∏Ä‰∏™<code>vmÂÆû‰æã</code>Âíå<code>callVal</code>ÂÅö‰∏∫ÂÖ•ÂèÇ</li>
<li>ÁÑ∂ÂêéÂèñ‰∫Ü<code>vm</code>ÁöÑÁà∂ËäÇÁÇπÂÅö‰∏∫ i ÁöÑÂàùÂÄº</li>
<li>Êé•ÁùÄ‰∏ÄÊ≠•‰∏ÄÊ≠•Áªô<code>iËµãÂÄº</code>ÔºåÂêåÊó∂Âà§Êñ≠<code>i</code>ÊòØÂê¶ÂÆö‰πâ</li>
<li>Âà∞ÊúÄÂêéÔºå<code>i</code>ÁöÑÂÄº‰∏∫<code>vm.$options._parentVnode.data.registerRouteInstance</code></li>
<li>ÁÑ∂ÂêéÂ∞Ü‰∏§‰∏™ÂÖ•ÂèÇ‰º†ÂÖ•<code>i</code>‰∏≠Ë∞ÉÁî®</li>
<li><strong>Ê≥®ÊÑèÔºåËøôÊó∂ÁöÑ i ÊòØ vm Áà∂ËäÇÁÇπ‰∏äÁöÑÊñπÊ≥ïÔºåÂπ∂‰∏çÊòØ vm ‰∏äÁöÑÊñπÊ≥ï</strong></li>
<li>Êàë‰ª¨ÂÖ®Â±ÄÊ£ÄÁ¥¢‰∏ã<code>registerRouteInstance</code>ÂÖ≥ÈîÆÂ≠óÔºåÂèëÁé∞ÂÖ∂Âè™Ë¢´ÂÆö‰πâÂú®‰∫Ü<code>view.js</code>‰∏≠Ôºå‰πüÂ∞±ÊòØ<code>router-view</code>ÁªÑ‰ª∂‰∏≠<ul>
<li>ÁªìÂêà‰∏äÈù¢‰∏ÄÊù°Ôºåi Âç≥<code>registerRouteInstance</code>ÊòØ<code>vmÁà∂ËäÇÁÇπ</code>‰∏äÁöÑÊñπÊ≥ïÔºåËÄåÂè™Êúâ<code>router-view</code>ÁªÑ‰ª∂ÂÆö‰πâ‰∫Ü<code>registerRouteInstance</code></li>
<li>ÊâÄ‰ª•ÔºåÂè™ÊúâÂΩì<code>vm</code>ÊòØ<code>router-view</code>ÁöÑÂ≠êËäÇÁÇπÊó∂Ôºå<code>registerRouteInstance</code>ÊñπÊ≥ïÊâç‰ºöË¢´Ë∞ÉÁî®</li>
<li><code>i(vm, callVal)</code>ÂèØ‰ª•Ë°®Ëææ‰∏∫<code>vm._parentVnode.registerRouteInstance(vm,vm)</code></li>
</ul>
</li>
<li>Áúã‰∏ã<code>registerRouteInstance</code>ÁöÑÂÆûÁé∞</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/components/view.js</span></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"><span class="comment">//¬†‰∏∫Ë∑ØÁî±ËÆ∞ÂΩïÁªëÂÆöË∑ØÁî±ÁªÑ‰ª∂ÔºåÂú®ÊâÄÊúâÁªÑ‰ª∂ÁöÑbeforeCreate„ÄÅdestoryed¬†hook‰∏≠Ë∞ÉÁî®ÔºåËßÅinstall.js‰∏≠ÁöÑregisterInstanceÊñπÊ≥ï</span></span><br><span class="line">¬†¬†¬†¬†<span class="comment">//¬†Ê≠§ÊñπÊ≥ïÂè™Âú®router-view‰∏äÂÆö‰πâ‰∫Ü</span></span><br><span class="line">¬†¬†¬†¬†<span class="comment">//¬†vmÔºåvalÈÉΩ‰∏∫Ë∑ØÁî±ÁªÑ‰ª∂ÂÆû‰æã</span></span><br><span class="line">¬†¬†¬†¬†<span class="comment">//¬†Â¶Ç‰∏ã</span></span><br><span class="line">¬†¬†¬†¬†<span class="comment">//¬†matched.instances:&#123;</span></span><br><span class="line">¬†¬†¬†¬†<span class="comment">//¬†¬†¬†default:VueComp,</span></span><br><span class="line">¬†¬†¬†¬†<span class="comment">//¬†¬†¬†hd:VueComp2,</span></span><br><span class="line">¬†¬†¬†¬†<span class="comment">//¬†¬†¬†bd:VueComp3</span></span><br><span class="line">¬†¬†¬†¬†<span class="comment">//¬†&#125;</span></span><br><span class="line">¬†¬†¬†¬†data.registerRouteInstance¬†=¬†<span class="function">(<span class="params">vm,¬†val</span>)¬†=&gt;</span>¬†&#123;</span><br><span class="line">¬†¬†¬†¬†¬†¬†<span class="comment">//¬†val¬†could¬†be¬†undefined¬†for¬†unregistration</span></span><br><span class="line">¬†¬†¬†¬†¬†¬†<span class="keyword">const</span>¬†current¬†=¬†matched.instances[name]</span><br><span class="line">¬†¬†¬†¬†¬†¬†<span class="keyword">if</span>¬†(</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†(val¬†&amp;&amp;¬†current¬†!==¬†vm)¬†||¬†<span class="comment">//¬†ÁªëÂÆö</span></span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†(!val¬†&amp;&amp;¬†current¬†===¬†vm)¬†<span class="comment">//¬†Ëã•val‰∏çÂ≠òÂú®ÔºåÂàôÂèØËßÜ‰∏∫Ëß£Áªë</span></span><br><span class="line">¬†¬†¬†¬†¬†¬†)¬†&#123;</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†matched.instances[name]¬†=¬†val</span><br><span class="line">¬†¬†¬†¬†¬†¬†&#125;</span><br><span class="line">¬†¬†¬†¬†&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>matched</code>‰øùÂ≠òÁöÑÊòØÂΩìÂâçÂåπÈÖçÂà∞ÁöÑË∑ØÁî±ËÆ∞ÂΩïÔºå<code>name</code>ÊòØÂëΩÂêçËßÜÂõæÂêç</li>
<li>Â¶ÇÊûú<code>val</code>Â≠òÂú®ÔºåÂπ∂‰∏îÂΩìÂâçË∑ØÁî±ÁªÑ‰ª∂Âíå‰º†ÂÖ•ÁöÑ‰∏çÂêåÔºåÈáçÊñ∞ËµãÂÄº</li>
<li>Â¶ÇÊûú<code>val</code>‰∏çÂ≠òÂú®Ôºå‰∏îÂΩìÂâçË∑ØÁî±ÁªÑ‰ª∂Âíå‰º†ÂÖ•ÁöÑÁõ∏ÂêåÔºå‰πüÈáçÊñ∞ËµãÂÄºÔºå‰ΩÜÊòØÊ≠§Êó∂ val ‰∏∫<code>undefined</code>ÔºåÁõ∏ÂΩì‰∫éËß£Áªë</li>
<li>ÂèØ‰ª•ÁúãÂà∞ÂèÇÊï∞Êï∞Èáè‰∏çÂêåÔºå‰∏Ä‰∏™ÂáΩÊï∞ÂÆûÁé∞‰∫ÜÁªëÂÆöÂíåËß£ÁªëÁöÑÂèåÈáçÊìç‰Ωú</li>
<li>ÈÄöËøáËøô‰∏™ÊñπÊ≥ïÂ∞±ÂÆåÊàê‰∫ÜË∑ØÁî±ËÆ∞ÂΩïÂíåË∑ØÁî±ÁªÑ‰ª∂ÂÆû‰æãÁöÑÁªëÂÆö‰∏éËß£ÁªëÊìç‰Ωú</li>
<li>ËøôÊ†∑Â∞±ÂèØ‰ª•Âú®<code>view</code>ÁªÑ‰ª∂<code>render</code>Êó∂ÔºåÈÄöËøá<code>route.matched[depth].components[name]</code>ÂèñÂà∞Ë∑ØÁî±ÁªÑ‰ª∂ËøõË°åÊ∏≤Êüì</li>
<li>ËøòÊúâ‰∫õÂú∫ÊôØ‰πüÈúÄË¶ÅËøõË°åÁªëÂÆö<ul>
<li>ÂΩìÁõ∏ÂêåÁªÑ‰ª∂Âú®‰∏çÂêåË∑ØÁî±Èó¥Â§çÁî®Êó∂ÔºåÈúÄË¶Å‰∏∫Ë∑ØÁî±ËÆ∞ÂΩïÁªëÂÆöË∑ØÁî±ÁªÑ‰ª∂</li>
<li><code>keep-alive</code>ÁªÑ‰ª∂Ë¢´ÊøÄÊ¥ªÊó∂ÔºåÈúÄË¶Å‰∏∫Ë∑ØÁî±ËÆ∞ÂΩïÁªëÂÆöË∑ØÁî±ÁªÑ‰ª∂</li>
</ul>
</li>
</ul>
<h4 id="Â∞èÁªì-1"><a href="#Â∞èÁªì-1" class="headerlink" title="Â∞èÁªì"></a>Â∞èÁªì</h4><ul>
<li><code>router-view</code>ÊòØ‰∏Ä‰∏™ÂáΩÊï∞ÂºèÁªÑ‰ª∂ÔºåÊúâÊó∂ÈúÄË¶ÅÂÄüÂä©Áà∂ËäÇÁÇπÁöÑËÉΩÂäõÔºå‰æãÂ¶Ç‰ΩøÁî®Áà∂ËäÇÁÇπÁöÑÊ∏≤ÊüìÂáΩÊï∞Êù•Ëß£ÊûêÂëΩÂêçÊèíÊßΩ</li>
<li>ÈÄöËøá<code>routerView</code>Êù•Ê†áËØÜ<code>view</code>ÁªÑ‰ª∂ÔºåÊñπ‰æø<code>vue-devtools</code>ËØÜÂà´Âá∫<code>view</code>ÁªÑ‰ª∂ÂíåÁ°ÆÂÆö<code>view</code>ÁªÑ‰ª∂Ê∑±Â∫¶</li>
<li>ÈÄöËøáÂêë‰∏äÊü•ÊâæÔºåÁ°ÆÂÆöÂΩìÂâç<code>view</code>ÁöÑÊ∑±Â∫¶<code>depth</code>ÔºåÈÄöËøá<code>depth</code>ÂèñÂà∞ÂØπÂ∫îÁöÑË∑ØÁî±ËÆ∞ÂΩï</li>
<li>ÂÜçÂèñÂá∫ÈÄöËøá<code>registerInstance</code>ÁªëÂÆöÁöÑË∑ØÁî±ÁªÑ‰ª∂ÂÆû‰æã</li>
<li>Â¶ÇÊûúÊúâÂä®ÊÄÅË∑ØÁî±ÂèÇÊï∞ÔºåÂàôÂÖàÂ°´ÂÖÖ<code>props</code>ÁÑ∂ÂêéÂÜçÊ∏≤Êüì</li>
<li>Â¶ÇÊûú<code>view</code>Ë¢´<code>keep-alive</code>ÂåÖË£πÂπ∂‰∏îÂ§Ñ‰∫é<code>inactive</code>Áä∂ÊÄÅÔºåÂàô‰ªéÁºìÂ≠ò‰∏≠ÂèñÂá∫Ë∑ØÁî±ÁªÑ‰ª∂ÂÆû‰æãÂπ∂Ê∏≤Êüì</li>
</ul>
<h3 id="Â¶Ç‰ΩïËß¶ÂèëÈáçÊñ∞Ê∏≤Êüì"><a href="#Â¶Ç‰ΩïËß¶ÂèëÈáçÊñ∞Ê∏≤Êüì" class="headerlink" title="Â¶Ç‰ΩïËß¶ÂèëÈáçÊñ∞Ê∏≤Êüì"></a>Â¶Ç‰ΩïËß¶ÂèëÈáçÊñ∞Ê∏≤Êüì</h3><ul>
<li>Âú®ÂØºËà™Ëß£ÊûêÁöÑÁ´†ËäÇÔºåÊàë‰ª¨ÊèêËøáÔºåÂØºËà™Ëß£ÊûêÊàêÂäüÂêé</li>
<li>‰ºöË∞ÉÁî®<code>updateRoute</code>ÊñπÊ≥ïÔºåÈáçÊñ∞‰∏∫ÂÖ®Â±ÄÁöÑ<code>_routerRoot._route</code>Âç≥<code>$route</code>ËµãÂÄº</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/history/base.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//¬†Êõ¥Êñ∞Ë∑ØÁî±ÔºåËß¶ÂèëafterEachÈí©Â≠ê</span></span><br><span class="line">¬†¬†updateRoute¬†(route:¬†Route)¬†&#123;</span><br><span class="line">¬†¬†¬†¬†<span class="keyword">const</span>¬†prev¬†=¬†<span class="keyword">this</span>.current</span><br><span class="line">¬†¬†¬†¬†<span class="keyword">this</span>.current¬†=¬†route<span class="comment">//¬†Êõ¥Êñ∞current</span></span><br><span class="line"></span><br><span class="line">¬†¬†¬†¬†<span class="keyword">this</span>.cb¬†&amp;&amp;¬†<span class="keyword">this</span>.cb(route)¬†<span class="comment">//¬†Ë∞ÉÁî®updateRouteÂõûË∞ÉÔºåÂõûË∞É‰∏≠‰ºöÈáçÊñ∞‰∏∫_routerRoot._routeËµãÂÄºÔºåËøõËÄåËß¶Âèërouter-viewÁöÑÈáçÊñ∞Ê∏≤Êüì</span></span><br><span class="line">    ...</span><br><span class="line">¬†¬†&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Âú®<code>view</code>ÁªÑ‰ª∂‰∏≠Ôºå‰ºö‰ΩøÁî®<code>$parent.$route</code>Âç≥ÂÖ®Â±ÄÁöÑ<code>_routerRoot._route</code></li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// src/components/view.js</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">¬†¬†render¬†(<span class="comment">/*¬†h*/</span>_,¬†<span class="comment">/*¬†context*/</span>&#123;¬†props,¬†children,¬†parent,¬†data¬†&#125;)¬†&#123;</span><br><span class="line">      ...</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span>¬†route¬†=¬†parent.$route¬†<span class="comment">//¬†‰æùËµñÁà∂ËäÇÁÇπÁöÑ$routeÔºåËÄåÂú®install.js‰∏≠Êàë‰ª¨Áü•ÈÅì,ÊâÄÊúâÁªÑ‰ª∂ËÆøÈóÆÂà∞ÁöÑ$routeÂÖ∂ÂÆûÈÉΩÊòØ_routerRoot._routeÔºåÂç≥VueÊ†πÂÆû‰æã‰∏äÁöÑ_routeÔºõÂΩìË∑ØÁî±Ë¢´Á°ÆËÆ§ÂêéÔºåË∞ÉÁî®updateRouteÊó∂Ôºå‰ºöÊõ¥Êñ∞_routerRoot._routeÔºåËøõËÄåÂØºËá¥router-viewÁªÑ‰ª∂ÈáçÊñ∞Ê∏≤Êüì</span></span><br><span class="line"></span><br><span class="line">      ...</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ËÄåÂú®<code>install.js</code>ÁöÑÂÖ®Â±ÄÊ∑∑ÂÖ•‰∏≠ÔºåÂ∞Ü<code>_route</code>ÂÆö‰πâ‰∏∫ÂìçÂ∫îÂºèÁöÑÔºå‰æùËµñ‰∫Ü<code>_route</code>ÁöÑÂú∞ÊñπÔºåÂú®<code>_route</code>ÂèëÁîüÂèòÂåñÊó∂ÔºåÈÉΩ‰ºöÈáçÊñ∞Ê∏≤Êüì</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/install.js</span></span><br><span class="line"></span><br><span class="line">¬†¬†<span class="comment">//¬†Ê≥®ÂÜåÂÖ®Â±ÄÊ∑∑ÂÖ•</span></span><br><span class="line">¬†¬†Vue.mixin(&#123;</span><br><span class="line">¬†¬†¬†¬†beforeCreate¬†()¬†&#123;</span><br><span class="line">¬†¬†¬†¬†     ...</span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†<span class="comment">//¬†ÂìçÂ∫îÂºèÂÆö‰πâ_routeÂ±ûÊÄßÔºå‰øùËØÅ_routeÂèëÁîüÂèòÂåñÊó∂ÔºåÁªÑ‰ª∂(router-view)‰ºöÈáçÊñ∞Ê∏≤Êüì</span></span><br><span class="line">¬†¬†¬†¬†¬†¬†¬†¬†Vue.util.defineReactive(<span class="keyword">this</span>,¬†<span class="string">'_route'</span>,¬†<span class="keyword">this</span>._router.history.current)</span><br><span class="line">¬†¬†¬†¬†¬†¬†&#125;</span><br><span class="line">¬†¬†&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>ËøôÊ†∑Â∞±ÂÆåÊàê‰∫ÜÊ∏≤ÊüìÁöÑÈó≠ÁéØ,<code>view</code>‰æùËµñ<code>$route</code>,ÂØºËà™Ëß£ÊûêÊàêÂäüÊõ¥Êñ∞<code>$route</code>ÔºåËß¶Âèë<code>view</code>Ê∏≤Êüì</li>
<li>ÁúãÂÆå‰∫Ü<code>view</code>ÁªÑ‰ª∂ÔºåÊàë‰ª¨Êù•Áúã‰∏ãÂè¶Â§ñ‰∏Ä‰∏™ÁªÑ‰ª∂<code>router-link</code></li>
</ul>
<h2 id="link-ÁªÑ‰ª∂"><a href="#link-ÁªÑ‰ª∂" class="headerlink" title="link ÁªÑ‰ª∂"></a>link ÁªÑ‰ª∂</h2><ul>
<li><code>router-link</code>ÁªÑ‰ª∂Ë¢´ÂÆö‰πâÂú®<code>src/components/link.js</code>‰∏≠</li>
<li>‰∏ªË¶ÅÁî®Êù•ÊîØÊåÅÁî®Êà∑Âú®ÂÖ∑ÊúâË∑ØÁî±ÂäüËÉΩÁöÑÂ∫îÁî®‰∏≠ (ÁÇπÂáª) ÂØºËà™</li>
</ul>
<h3 id="router-link"><a href="#router-link" class="headerlink" title="router-link"></a>router-link</h3><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*¬†@flow¬†*/</span></span><br><span class="line"><span class="keyword">import</span> &#123; createRoute, isSameRoute, isIncludedRoute &#125; <span class="keyword">from</span> <span class="string">'../util/route'</span></span><br><span class="line"><span class="keyword">import</span> &#123; extend &#125; <span class="keyword">from</span> <span class="string">'../util/misc'</span></span><br><span class="line"><span class="keyword">import</span> &#123; normalizeLocation &#125; <span class="keyword">from</span> <span class="string">'../util/location'</span></span><br><span class="line"><span class="keyword">import</span> &#123; warn &#125; <span class="keyword">from</span> <span class="string">'../util/warn'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//¬†work¬†around¬†weird¬†flow¬†bug</span></span><br><span class="line"><span class="keyword">const</span> toTypes: <span class="built_in">Array</span>&lt;<span class="built_in">Function</span>&gt; = [<span class="built_in">String</span>, <span class="built_in">Object</span>]</span><br><span class="line"><span class="keyword">const</span> eventTypes: <span class="built_in">Array</span>&lt;<span class="built_in">Function</span>&gt; = [<span class="built_in">String</span>, <span class="built_in">Array</span>]</span><br><span class="line"><span class="keyword">const</span> noop = <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  name: <span class="string">'RouterLink'</span>,</span><br><span class="line">  props: &#123;</span><br><span class="line">    to: &#123;</span><br><span class="line">      <span class="keyword">type</span>: toTypes, <span class="comment">//¬†string¬†|¬†Location</span></span><br><span class="line">      required: <span class="literal">true</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    tag: &#123;</span><br><span class="line">      <span class="keyword">type</span>: <span class="built_in">String</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="string">'a'</span>, <span class="comment">//¬†ÈªòËÆ§aÊ†áÁ≠æ</span></span><br><span class="line">    &#125;,</span><br><span class="line">    exact: <span class="built_in">Boolean</span>, <span class="comment">//¬†ÊòØÂê¶Á≤æÁ°ÆÂåπÈÖç</span></span><br><span class="line">    append: <span class="built_in">Boolean</span>, <span class="comment">//¬†ÊòØÂê¶ËøΩÂä†</span></span><br><span class="line">    replace: <span class="built_in">Boolean</span>, <span class="comment">//¬†‰∏∫trueÔºåË∞ÉÁî®router.replaceÂê¶ÂàôË∞ÉÁî®router.push</span></span><br><span class="line">    activeClass: <span class="built_in">String</span>, <span class="comment">//¬†ÊøÄÊ¥ªÁöÑÁ±ªÂêç</span></span><br><span class="line">    exactActiveClass: <span class="built_in">String</span>, <span class="comment">//¬†Á≤æÁ°ÆÂåπÈÖçÁöÑÁ±ªÂêç</span></span><br><span class="line">    ariaCurrentValue: &#123;</span><br><span class="line">      <span class="comment">//¬†Êó†ÈöúÁ¢çÂåñ</span></span><br><span class="line">      <span class="keyword">type</span>: <span class="built_in">String</span>,</span><br><span class="line">      <span class="keyword">default</span>: <span class="string">'page'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    event: &#123;</span><br><span class="line">      <span class="keyword">type</span>: eventTypes, <span class="comment">//¬†Ëß¶ÂèëÂØºËà™ÁöÑ‰∫ã‰ª∂</span></span><br><span class="line">      <span class="keyword">default</span>: <span class="string">'click'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  render(h: <span class="built_in">Function</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> router = <span class="keyword">this</span>.$router</span><br><span class="line">    <span class="keyword">const</span> current = <span class="keyword">this</span>.$route</span><br><span class="line">    <span class="keyword">const</span> &#123; location, route, href &#125; = router.resolve(</span><br><span class="line">      <span class="keyword">this</span>.to,</span><br><span class="line">      current,</span><br><span class="line">      <span class="keyword">this</span>.append</span><br><span class="line">    ) <span class="comment">//¬†Ëß£ÊûêÁõÆÊ†á‰ΩçÁΩÆ</span></span><br><span class="line">    <span class="keyword">const</span> classes = &#123;&#125;</span><br><span class="line">    <span class="keyword">const</span> globalActiveClass = router.options.linkActiveClass</span><br><span class="line">    <span class="keyword">const</span> globalExactActiveClass = router.options.linkExactActiveClass <span class="comment">//¬†Support¬†global¬†empty¬†active¬†class</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> activeClassFallback =</span><br><span class="line">      globalActiveClass == <span class="literal">null</span> ? <span class="string">'router-link-active'</span> : globalActiveClass</span><br><span class="line">    <span class="keyword">const</span> exactActiveClassFallback =</span><br><span class="line">      globalExactActiveClass == <span class="literal">null</span></span><br><span class="line">        ? <span class="string">'router-link-exact-active'</span></span><br><span class="line">        : globalExactActiveClass</span><br><span class="line">    <span class="keyword">const</span> activeClass =</span><br><span class="line">      <span class="keyword">this</span>.activeClass == <span class="literal">null</span> ? activeClassFallback : <span class="keyword">this</span>.activeClass</span><br><span class="line">    <span class="keyword">const</span> exactActiveClass =</span><br><span class="line">      <span class="keyword">this</span>.exactActiveClass == <span class="literal">null</span></span><br><span class="line">        ? exactActiveClassFallback</span><br><span class="line">        : <span class="keyword">this</span>.exactActiveClass <span class="comment">//¬†ÁõÆÊ†árouteÔºåÁî®Êù•ÊØîËæÉÊòØÂê¶ÂíåÂΩìÂâçrouteÊòØÁõ∏Âêåroute</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> compareTarget = route.redirectedFrom</span><br><span class="line">      ? createRoute(<span class="literal">null</span>, normalizeLocation(route.redirectedFrom), <span class="literal">null</span>, router)</span><br><span class="line">      : route</span><br><span class="line">    classes[exactActiveClass] = isSameRoute(current, compareTarget)</span><br><span class="line">    classes[activeClass] = <span class="keyword">this</span>.exact</span><br><span class="line">      ? classes[exactActiveClass]</span><br><span class="line">      : isIncludedRoute(current, compareTarget) <span class="comment">//¬†ÈùûÁ≤æÂáÜÂåπÈÖçÊó∂ÔºåÂà§Êñ≠ÁõÆÊ†ároute¬†pathÊòØÂê¶ÂåÖÂê´ÂΩìÂâçroute¬†path</span></span><br><span class="line">    <span class="keyword">const</span> ariaCurrentValue = classes[exactActiveClass]</span><br><span class="line">      ? <span class="keyword">this</span>.ariaCurrentValue</span><br><span class="line">      : <span class="literal">null</span> <span class="comment">//¬†‰∫ã‰ª∂Â§ÑÁêÜ</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> handler = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (guardEvent(e)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.replace) &#123;</span><br><span class="line">          router.replace(location, noop)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          router.push(location, noop)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> on = &#123; click: guardEvent &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(<span class="keyword">this</span>.event)) &#123;</span><br><span class="line">      <span class="keyword">this</span>.event.forEach(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        on[e] = handler</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      on[<span class="keyword">this</span>.event] = handler</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> data: <span class="built_in">any</span> = &#123; <span class="keyword">class</span>: classes &#125; <span class="comment">//¬†ËØªÂèñ‰ΩúÁî®ÂüüÊèíÊßΩ</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> scopedSlot =</span><br><span class="line">      !<span class="keyword">this</span>.$scopedSlots.$hasNormal &amp;&amp;</span><br><span class="line">      <span class="keyword">this</span>.$scopedSlots.default &amp;&amp;</span><br><span class="line">      <span class="keyword">this</span>.$scopedSlots.default(&#123;</span><br><span class="line">        href,</span><br><span class="line">        route,</span><br><span class="line">        navigate: handler,</span><br><span class="line">        isActive: classes[activeClass],</span><br><span class="line">        isExactActive: classes[exactActiveClass],</span><br><span class="line">      &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (scopedSlot) &#123;</span><br><span class="line">      <span class="comment">//¬†‰ΩúÁî®ÂüüÊèíÊßΩ‰ªÖÊúâ‰∏Ä‰∏™Â≠êÂÖÉÁ¥†</span></span><br><span class="line">      <span class="keyword">if</span> (scopedSlot.length === <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> scopedSlot[<span class="number">0</span>]</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (scopedSlot.length &gt; <span class="number">1</span> || !scopedSlot.length) &#123;</span><br><span class="line">        <span class="comment">//¬†‰ΩúÁî®ÂüüÊèíÊßΩÊèê‰æõÂ§ö‰∏™Âêé‰ª£ÊàñÊú™Êèê‰æõÂêéÔºåÁªô‰∫àÊèêÁ§∫</span></span><br><span class="line">        <span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</span><br><span class="line">          warn(</span><br><span class="line">            <span class="literal">false</span>,</span><br><span class="line">            <span class="string">`RouterLink¬†with¬†to="<span class="subst">$&#123;this.to&#125;</span>"¬†is¬†trying¬†to¬†use¬†a¬†scoped¬†slot¬†but¬†it¬†didn't¬†provide¬†exactly¬†one¬†child.¬†Wrapping¬†the¬†content¬†with¬†a¬†span¬†element.`</span></span><br><span class="line">          )</span><br><span class="line">        &#125; <span class="comment">//¬†ÊúâÂ§ö‰∏™Âêé‰ª£Êó∂ÔºåÂú®Â§ñÂ±ÇÁî®‰∏Ä‰∏™spanÂåÖË£π</span></span><br><span class="line">        <span class="keyword">return</span> scopedSlot.length === <span class="number">0</span> ? h() : h(<span class="string">'span'</span>, &#123;&#125;, scopedSlot)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="comment">//¬†tag‰∏∫a</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.tag === <span class="string">'a'</span>) &#123;</span><br><span class="line">      data.on = on</span><br><span class="line">      data.attrs = &#123; href, <span class="string">'aria-current'</span>: ariaCurrentValue &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">//¬†tag‰∏ç‰∏∫aÔºåÂàôÊâæÂêé‰ª£È¶ñ‰∏™aÁªëÂÆö‰∫ã‰ª∂</span></span><br><span class="line">      <span class="comment">//¬†find¬†the¬†first¬†&lt;a&gt;¬†child¬†and¬†apply¬†listener¬†and¬†href</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> a = findAnchor(<span class="keyword">this</span>.$slots.default)</span><br><span class="line">      <span class="keyword">if</span> (a) &#123;</span><br><span class="line">        <span class="comment">//¬†in¬†case¬†the¬†&lt;a&gt;¬†is¬†a¬†static¬†node</span></span><br><span class="line">        a.isStatic = <span class="literal">false</span></span><br><span class="line">        <span class="keyword">const</span> aData = (a.data = extend(&#123;&#125;, a.data))</span><br><span class="line">        aData.on = aData.on || &#123;&#125; <span class="comment">//¬†transform¬†existing¬†events¬†in¬†both¬†objects¬†into¬†arrays¬†so¬†we¬†can¬†push¬†later //¬†a‰∏äÂèØËÉΩËøòÁªëÂÆöÊúâÂÖ∂‰ªñ‰∫ã‰ª∂ÔºåÈúÄË¶ÅÂÖºÂÆπ</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> event <span class="keyword">in</span> aData.on) &#123;</span><br><span class="line">          <span class="keyword">const</span> handler = aData.on[event]</span><br><span class="line">          <span class="keyword">if</span> (event <span class="keyword">in</span> on) &#123;</span><br><span class="line">            aData.on[event] = <span class="built_in">Array</span>.isArray(handler) ? handler : [handler]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="comment">//¬†append¬†new¬†listeners¬†for¬†router-link //¬†ÁªëÂÆöÂÖ∂‰ªñ‰∫ã‰ª∂Â§ÑÁêÜÂô®</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> event <span class="keyword">in</span> on) &#123;</span><br><span class="line">          <span class="keyword">if</span> (event <span class="keyword">in</span> aData.on) &#123;</span><br><span class="line">            <span class="comment">//¬†on[event]¬†is¬†always¬†a¬†function</span></span><br><span class="line">            aData.on[event].push(on[event])</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            aData.on[event] = handler</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> aAttrs = (a.data.attrs = extend(&#123;&#125;, a.data.attrs))</span><br><span class="line">        aAttrs.href = href</span><br><span class="line">        aAttrs[<span class="string">'aria-current'</span>] = ariaCurrentValue</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//¬†doesn't¬†have¬†&lt;a&gt;¬†child,¬†apply¬†listener¬†to¬†self</span></span><br><span class="line">        <span class="comment">//¬†Ê≤°ÊâæÂà∞ÔºåÂàôÁªôÂΩìÂâçÂÖÉÁ¥†ÁªëÂÆö‰∫ã‰ª∂</span></span><br><span class="line">        data.on = on</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> h(<span class="keyword">this</span>.tag, data, <span class="keyword">this</span>.$slots.default)</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//¬†ÁâπÊÆäÂú∫ÊôØÔºåÁÇπÂáª‰∏çÂÅöË∑≥ËΩ¨ÂìçÂ∫î</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">guardEvent</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//¬†don't¬†redirect¬†with¬†control¬†keys</span></span><br><span class="line">  <span class="keyword">if</span> (e.metaKey || e.altKey || e.ctrlKey || e.shiftKey) <span class="keyword">return</span> <span class="comment">//¬†don't¬†redirect¬†when¬†preventDefault¬†called</span></span><br><span class="line">  <span class="keyword">if</span> (e.defaultPrevented) <span class="keyword">return</span> <span class="comment">//¬†don't¬†redirect¬†on¬†right¬†click</span></span><br><span class="line">  <span class="keyword">if</span> (e.button !== <span class="literal">undefined</span> &amp;&amp; e.button !== <span class="number">0</span>) <span class="keyword">return</span> <span class="comment">//¬†don't¬†redirect¬†if¬†`target="_blank"`</span></span><br><span class="line">  <span class="keyword">if</span> (e.currentTarget &amp;&amp; e.currentTarget.getAttribute) &#123;</span><br><span class="line">    <span class="keyword">const</span> target = e.currentTarget.getAttribute(<span class="string">'target'</span>)</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/\b_blank\b/i</span>.test(target)) <span class="keyword">return</span></span><br><span class="line">  &#125; <span class="comment">//¬†this¬†may¬†be¬†a¬†Weex¬†event¬†which¬†doesn't¬†have¬†this¬†method</span></span><br><span class="line">  <span class="keyword">if</span> (e.preventDefault) &#123;</span><br><span class="line">    e.preventDefault()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//¬†ÈÄíÂΩíÊü•ÊâæÂêé‰ª£aÊ†áÁ≠æ</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">findAnchor</span>(<span class="params">children</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (children) &#123;</span><br><span class="line">    <span class="keyword">let</span> child</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; children.length; i++) &#123;</span><br><span class="line">      child = children[i]</span><br><span class="line">      <span class="keyword">if</span> (child.tag === <span class="string">'a'</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> child</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (child.children &amp;&amp; (child = findAnchor(child.children))) &#123;</span><br><span class="line">        <span class="keyword">return</span> child</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>ÂÖ∂ÂÆûÁé∞Â∞±ÊòØ‰∏Ä‰∏™ÊôÆÈÄöÁöÑÁªÑ‰ª∂ÔºåÂÆûÁé∞‰∫ÜÁÇπÂáªÊó∂Ë∑≥ËΩ¨Âà∞<code>to</code>ÂØπÂ∫îÁöÑË∑ØÁî±ÂäüËÉΩ</li>
<li>Áî±‰∫éÊîØÊåÅÁÇπÂáªÊó∂ÈúÄË¶ÅÊ†áËØÜÊ†∑ÂºèÁ±ª„ÄÅÁ≤æÂáÜÂåπÈÖç<code>exact</code>Âú∫ÊôØÔºåÊâÄ‰ª•ÈÄöËøá<code>sameRoute</code>„ÄÅ<code>isIncludedRoute</code>Êù•ÂÆûÁé∞Ê†∑ÂºèÁ±ªÁöÑÊ†áËØÜÂíåÁ≤æÂáÜÂåπÈÖçÊ†áËØÜ</li>
<li>Âú®ÁÇπÂáªÊó∂ÔºåÂ±èËîΩ‰∫ÜÈÉ®ÂàÜÁâπÊÆäÂú∫ÊôØÔºåÂ¶ÇÁÇπÂáªÊó∂ÂêåÊó∂Êåâ‰∏ã<code>ctrl</code>„ÄÅ<code>alt</code>„ÄÅ<code>shift</code>Á≠â<code>control keys</code>Êó∂Ôºå‰∏çÂÅöË∑≥ËΩ¨</li>
<li>ÁúãÂÆåÁªÑ‰ª∂ÂêéÔºåÊàë‰ª¨ÂÜçÊù•ÁúãÁúã<code>router</code>ËøòÁªôÊàë‰ª¨Êèê‰æõÂì™‰∫õÂÆû‰æãÊñπÊ≥ï</li>
</ul>
<h2 id="ÂÆû‰æãÂ±ûÊÄß„ÄÅÊñπÊ≥ï"><a href="#ÂÆû‰æãÂ±ûÊÄß„ÄÅÊñπÊ≥ï" class="headerlink" title="ÂÆû‰æãÂ±ûÊÄß„ÄÅÊñπÊ≥ï"></a>ÂÆû‰æãÂ±ûÊÄß„ÄÅÊñπÊ≥ï</h2><ul>
<li><code>router</code>ÂØπÂ§ñÊö¥Èú≤‰∫ÜÂæàÂ§öÂ±ûÊÄßÂíåÊñπÊ≥ï</li>
<li>Ëøô‰∫õÂ±ûÊÄßÂíåÊñπÊ≥ïÂú®ÂâçÈù¢ÁöÑÊ∫êÁ†ÅÈÉ®ÂàÜ‰πüÈÉΩÊúâÁî®Ëøá</li>
</ul>
<h3 id="ÂÆû‰æãÂ±ûÊÄß"><a href="#ÂÆû‰æãÂ±ûÊÄß" class="headerlink" title="ÂÆû‰æãÂ±ûÊÄß"></a>ÂÆû‰æãÂ±ûÊÄß</h3><ul>
<li><code>router.app</code><ul>
<li>ÈÖçÁΩÆ‰∫Ü  router  ÁöÑ Vue Ê†πÂÆû‰æã</li>
</ul>
</li>
<li><code>router.mode</code><ul>
<li>Ë∑ØÁî±‰ΩøÁî®ÁöÑÊ®°Âºè</li>
</ul>
</li>
<li><code>router.currentRoute</code><ul>
<li>ÂΩìÂâçË∑ØÁî±ÂØπË±°ÔºåÁ≠âÂêå‰∫é<code>this.$route</code></li>
</ul>
</li>
</ul>
<h3 id="ÂÆû‰æãÊñπÊ≥ï"><a href="#ÂÆû‰æãÊñπÊ≥ï" class="headerlink" title="ÂÆû‰æãÊñπÊ≥ï"></a>ÂÆû‰æãÊñπÊ≥ï</h3><ul>
<li>Áî®Ê≥®ÂÜåÂÖ®Â±ÄÂØºËà™ÂÆàÂç´<ul>
<li><code>router.beforeEach</code></li>
<li><code>router.beforeResolve</code></li>
<li><code>router.afterEach</code></li>
</ul>
</li>
<li>ÁºñÁ®ãÂºèÂØºËà™Áõ∏ÂÖ≥<ul>
<li><code>router.push</code></li>
<li><code>router.replace</code></li>
<li><code>router.go</code></li>
<li><code>router.back</code></li>
<li><code>router.forward</code></li>
</ul>
</li>
<li>ÊúçÂä°Á´ØÊ∏≤ÊüìÁõ∏ÂÖ≥<ul>
<li><code>router.getMatchedComponents</code><ul>
<li>ËøîÂõûÁõÆÊ†á‰ΩçÁΩÆÊàñÊòØÂΩìÂâçË∑ØÁî±ÂåπÈÖçÁöÑÁªÑ‰ª∂Êï∞ÁªÑ (ÊòØÊï∞ÁªÑÁöÑÂÆö‰πâ/ÊûÑÈÄ†Á±ªÔºå‰∏çÊòØÂÆû‰æã)</li>
</ul>
</li>
<li><code>router.onReady</code><ul>
<li>ËØ•ÊñπÊ≥ïÊää‰∏Ä‰∏™ÂõûË∞ÉÊéíÈòüÔºåÂú®Ë∑ØÁî±ÂÆåÊàêÂàùÂßãÂØºËà™Êó∂Ë∞ÉÁî®ÔºåËøôÊÑèÂë≥ÁùÄÂÆÉÂèØ‰ª•Ëß£ÊûêÊâÄÊúâÁöÑÂºÇÊ≠•ËøõÂÖ•Èí©Â≠êÂíåË∑ØÁî±ÂàùÂßãÂåñÁõ∏ÂÖ≥ËÅîÁöÑÂºÇÊ≠•ÁªÑ‰ª∂</li>
</ul>
</li>
<li><code>router.onError</code><ul>
<li>Ê≥®ÂÜå‰∏Ä‰∏™ÂõûË∞ÉÔºåËØ•ÂõûË∞É‰ºöÂú®Ë∑ØÁî±ÂØºËà™ËøáÁ®ã‰∏≠Âá∫ÈîôÊó∂Ë¢´Ë∞ÉÁî®</li>
</ul>
</li>
</ul>
</li>
<li>Âä®ÊÄÅË∑ØÁî±<ul>
<li><code>router.addRoutes</code><ul>
<li>Âä®ÊÄÅÊ∑ªÂä†Ë∑ØÁî±ËßÑÂàô</li>
</ul>
</li>
</ul>
</li>
<li>Ëß£Êûê<ul>
<li><code>router.resolve</code> - ‰º†ÂÖ•‰∏Ä‰∏™ÂØπË±°ÔºåÂ∞ùËØïËß£ÊûêÂπ∂ËøîÂõû‰∏Ä‰∏™ÁõÆÊ†á‰ΩçÁΩÆ</li>
</ul>
</li>
</ul>
<h2 id="ÊÄªÁªì"><a href="#ÊÄªÁªì" class="headerlink" title="ÊÄªÁªì"></a>ÊÄªÁªì</h2><ul>
<li>Ëá≥Ê≠§ÔºåÊàë‰ª¨ÂÆåÊàê‰∫Ü<code>vue-router@2</code>ÁöÑÊâÄÊúâÊ∫êÁ†ÅÂàÜÊûê üéâ</li>
<li>Â¶ÇÊûúÊÇ®ËßâÂæóËøòÂèØ‰ª•ÔºåËÆ∞ÂæóÂ∏ÆÊàëÁÇπ‰∏™Ëµû üëç</li>
</ul>
<h2 id="ÂèÇËÄÉ"><a href="#ÂèÇËÄÉ" class="headerlink" title="ÂèÇËÄÉ"></a>ÂèÇËÄÉ</h2><ul>
<li><a href="https://github.com/dwqs/blog/issues/53" target="_blank" rel="noopener">https://github.com/dwqs/blog/issues/53</a></li>
<li><a href="https://github.com/dwqs/blog/issues/54" target="_blank" rel="noopener">https://github.com/dwqs/blog/issues/54</a></li>
<li><a href="https://github.com/dwqs/blog/issues/55" target="_blank" rel="noopener">https://github.com/dwqs/blog/issues/55</a></li>
<li><a href="https://github.com/vuejs/vue-router/issues/2184#issuecomment-393484643" target="_blank" rel="noopener">https://github.com/vuejs/vue-router/issues/2184#issuecomment-393484643</a></li>
<li><a href="https://juejin.im/post/5e456513f265da573c0c6d4b" target="_blank" rel="noopener">https://juejin.im/post/5e456513f265da573c0c6d4b</a></li>
<li><a href="https://juejin.im/post/584040e1ac502e006cbedb23" target="_blank" rel="noopener">https://juejin.im/post/584040e1ac502e006cbedb23</a></li>
<li><a href="https://juejin.im/post/5df0ada0f265da33d56d1a2f" target="_blank" rel="noopener">https://juejin.im/post/5df0ada0f265da33d56d1a2f</a></li>
<li><a href="https://juejin.im/post/5dbed0bef265da4cff701f68" target="_blank" rel="noopener">https://juejin.im/post/5dbed0bef265da4cff701f68</a></li>
<li><a href="https://www.jianshu.com/p/29e8214d0bee" target="_blank" rel="noopener">https://www.jianshu.com/p/29e8214d0bee</a></li>
<li><a href="https://ustbhuangyi.github.io/vue-analysis/v2/vue-router/" target="_blank" rel="noopener">https://ustbhuangyi.github.io/vue-analysis/v2/vue-router/</a></li>
<li><a href="https://blog.liuyunzhuge.com/2020/04/08/vue-routerÊ∫êÁ†ÅÔºöcreate-matcher/" target="_blank" rel="noopener">https://blog.liuyunzhuge.com/2020/04/08/vue-router Ê∫êÁ†ÅÔºöcreate-matcher/</a></li>
</ul>
<h2 id="PS"><a href="#PS" class="headerlink" title="PS"></a>PS</h2><ul>
<li>ÂêéÈù¢Ëøò‰ºö‰ªãÁªçÂÖ∂‰ΩôÈÉ®ÂàÜÔºåÂ¶ÇÊûúËßâÂæóËøòË°åÔºåÂèØ‰ª•Áªô‰∏™ËµûÂì¶ ‚ú®</li>
<li>‰∏™‰∫∫<code>github</code>Ôºå‰πüÊÄªÁªì‰∫Ü‰∏Ä‰∫õ‰∏úË•øÔºåÊ¨¢Ëøé star</li>
<li>Âü∫‰∫é canvas ÁöÑÁªòÂõæÊùø<a href="https://github.com/BryanAdamss/drawing-board" target="_blank" rel="noopener">drawing-board</a></li>
<li>ÂâçÁ´ØÂÖ•Èó® demo„ÄÅÊúÄ‰Ω≥ÂÆûË∑µÈõÜÂêà <a href="https://github.com/BryanAdamss/fe-awesome-demos" target="_blank" rel="noopener">fe-awesome-demos</a></li>
<li>‰∏Ä‰∏™Ëá™Âä®ÁîüÊàêÂà´ÂêçÁöÑ<code>vue-cli-plugin</code><a href="https://www.npmjs.com/package/vue-cli-plugin-auto-alias" target="_blank" rel="noopener">https://www.npmjs.com/package/vue-cli-plugin-auto-alias</a></li>
</ul>
<h2 id="npm-ÂåÖ"><a href="#npm-ÂåÖ" class="headerlink" title="npm ÂåÖ"></a>npm ÂåÖ</h2><ul>
<li><a href="https://www.npmjs.com/package/vue-cli-plugin-auto-alias" target="_blank" rel="noopener">vue-cli-plugin-auto-alias</a></li>
<li><a href="https://www.npmjs.com/package/@bryanadamss/drawing-board" target="_blank" rel="noopener">@bryanadamss/drawing-board</a></li>
<li><a href="https://www.npmjs.com/package/@bryanadamss/num2chn" target="_blank" rel="noopener">@bryanadamss/num2chn</a></li>
<li><a href="https://www.npmjs.com/package/ant-color-converter" target="_blank" rel="noopener">ant-color-converter</a></li>
</ul>
<h2 id="‰∫§ÊµÅ"><a href="#‰∫§ÊµÅ" class="headerlink" title="‰∫§ÊµÅ"></a>‰∫§ÊµÅ</h2><ul>
<li>Â¶ÇÊûúÊúâÈóÆÈ¢òÔºåÂèØ‰ª•Âä†ÂæÆ‰ø°‰∫§ÊµÅÔºåÂÖ±ÂêåÊàêÈïøÔºåÂÖ±ÂêåËøõÊ≠•~</li>
<li><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/917b376a388f43faa6c8f8d81f730bcb~tplv-k3u1fbpfcp-watermark.image" alt=""></li>
</ul>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/vue/" rel="tag"># vue</a>
          
            <a href="/tags/vue-router/" rel="tag"># vue-router</a>
          
            <a href="/tags/Ê∫êÁ†ÅËß£Êûê/" rel="tag"># Ê∫êÁ†ÅËß£Êûê</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/12/01/x5-video-summary/" rel="next" title="x5-video-summary">
                <i class="fa fa-chevron-left"></i> x5-video-summary
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            ÊñáÁ´†ÁõÆÂΩï
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Á´ôÁÇπÊ¶ÇËßà
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/Avatar.png"
               alt="BryanAdamss" />
          <p class="site-author-name" itemprop="name">BryanAdamss</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">64</span>
                <span class="site-state-item-name">Êó•Âøó</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">ÂàÜÁ±ª</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">91</span>
                <span class="site-state-item-name">Ê†áÁ≠æ</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/BryanAdamss" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#vue-router-Ê∫êÁ†ÅËß£Êûê-6k-Â≠ó-Â§öÂõæÈ¢ÑË≠¶-„Äê‰∏ã„Äë"><span class="nav-number">1.</span> <span class="nav-text">vue-router Ê∫êÁ†ÅËß£Êûê | 6k Â≠ó | Â§öÂõæÈ¢ÑË≠¶ - „Äê‰∏ã„Äë</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ÊªöÂä®Â§ÑÁêÜ"><span class="nav-number">1.1.</span> <span class="nav-text">ÊªöÂä®Â§ÑÁêÜ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#setupScroll"><span class="nav-number">1.1.1.</span> <span class="nav-text">setupScroll</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#handleScroll"><span class="nav-number">1.1.2.</span> <span class="nav-text">handleScroll</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Â∞èÁªì"><span class="nav-number">1.1.3.</span> <span class="nav-text">Â∞èÁªì</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#view-ÁªÑ‰ª∂"><span class="nav-number">1.2.</span> <span class="nav-text">view ÁªÑ‰ª∂</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#router-view"><span class="nav-number">1.2.1.</span> <span class="nav-text">router-view</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#registerInstance"><span class="nav-number">1.2.2.</span> <span class="nav-text">registerInstance</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Â∞èÁªì-1"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">Â∞èÁªì</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Â¶Ç‰ΩïËß¶ÂèëÈáçÊñ∞Ê∏≤Êüì"><span class="nav-number">1.2.3.</span> <span class="nav-text">Â¶Ç‰ΩïËß¶ÂèëÈáçÊñ∞Ê∏≤Êüì</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#link-ÁªÑ‰ª∂"><span class="nav-number">1.3.</span> <span class="nav-text">link ÁªÑ‰ª∂</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#router-link"><span class="nav-number">1.3.1.</span> <span class="nav-text">router-link</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ÂÆû‰æãÂ±ûÊÄß„ÄÅÊñπÊ≥ï"><span class="nav-number">1.4.</span> <span class="nav-text">ÂÆû‰æãÂ±ûÊÄß„ÄÅÊñπÊ≥ï</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ÂÆû‰æãÂ±ûÊÄß"><span class="nav-number">1.4.1.</span> <span class="nav-text">ÂÆû‰æãÂ±ûÊÄß</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ÂÆû‰æãÊñπÊ≥ï"><span class="nav-number">1.4.2.</span> <span class="nav-text">ÂÆû‰æãÊñπÊ≥ï</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ÊÄªÁªì"><span class="nav-number">1.5.</span> <span class="nav-text">ÊÄªÁªì</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ÂèÇËÄÉ"><span class="nav-number">1.6.</span> <span class="nav-text">ÂèÇËÄÉ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PS"><span class="nav-number">1.7.</span> <span class="nav-text">PS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#npm-ÂåÖ"><span class="nav-number">1.8.</span> <span class="nav-text">npm ÂåÖ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#‰∫§ÊµÅ"><span class="nav-number">1.9.</span> <span class="nav-text">‰∫§ÊµÅ</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">BryanAdamss</span>
</div>


<div class="powered-by">
  Áî± <a class="theme-link" href="https://hexo.io">Hexo</a> Âº∫ÂäõÈ©±Âä®
</div>

<div class="theme-info">
  ‰∏ªÈ¢ò -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="local-search-pop-overlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

  


  

</body>
</html>
